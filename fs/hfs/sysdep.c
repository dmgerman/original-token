multiline_comment|/*&n; * linux/fs/hfs/sysdep.c&n; *&n; * Copyright (C) 1996  Paul H. Hargrove&n; * This file may be distributed under the terms of the GNU Public License.&n; *&n; * This file contains the code to do various system dependent things.&n; *&n; * &quot;XXX&quot; in a comment is a note to myself to consider changing something.&n; *&n; * In function preconditions the term &quot;valid&quot; applied to a pointer to&n; * a structure means that the pointer is non-NULL and the structure it&n; * points to has all fields initialized to consistent values.&n; */
macro_line|#include &quot;hfs.h&quot;
macro_line|#include &lt;linux/hfs_fs_sb.h&gt;
macro_line|#include &lt;linux/hfs_fs_i.h&gt;
macro_line|#include &lt;linux/hfs_fs.h&gt;
multiline_comment|/*&n; * hfs_buffer_get()&n; *&n; * Return a buffer for the &squot;block&squot;th block of the media.&n; * If (&squot;read&squot;==0) then the buffer is not read from disk.&n; */
DECL|function|hfs_buffer_get
id|hfs_buffer
id|hfs_buffer_get
c_func
(paren
id|hfs_sysmdb
id|sys_mdb
comma
r_int
id|block
comma
r_int
id|read
)paren
(brace
id|hfs_buffer
id|tmp
op_assign
id|HFS_BAD_BUFFER
suffix:semicolon
r_if
c_cond
(paren
id|read
)paren
(brace
id|tmp
op_assign
id|bread
c_func
(paren
id|sys_mdb-&gt;s_dev
comma
id|block
comma
id|HFS_SECTOR_SIZE
)paren
suffix:semicolon
)brace
r_else
(brace
id|tmp
op_assign
id|getblk
c_func
(paren
id|sys_mdb-&gt;s_dev
comma
id|block
comma
id|HFS_SECTOR_SIZE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tmp
)paren
(brace
id|mark_buffer_uptodate
c_func
(paren
id|tmp
comma
l_int|1
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
op_logical_neg
id|tmp
)paren
(brace
id|hfs_error
c_func
(paren
l_string|&quot;hfs_fs: unable to read block 0x%08x from dev %s&bslash;n&quot;
comma
id|block
comma
id|hfs_mdb_name
c_func
(paren
id|sys_mdb
)paren
)paren
suffix:semicolon
)brace
r_return
id|tmp
suffix:semicolon
)brace
multiline_comment|/* catalog.c needs a re-write. as a kludge, we throw away all of &n; * the dcache if we need more entries. */
DECL|function|hfs_prune_entry
r_int
id|hfs_prune_entry
c_func
(paren
r_struct
id|hfs_cat_entry
op_star
id|entry
)paren
(brace
id|shrink_dcache_sb
c_func
(paren
id|entry-&gt;mdb-&gt;sys_mdb
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
eof
