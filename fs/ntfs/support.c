multiline_comment|/*&n; *  support.c&n; *  Specific support functions&n; *&n; *  Copyright (C) 1997 Martin von L&#xfffd;wis&n; *  Copyright (C) 1997 R&#xfffd;gis Duchesne&n; *&n; */
macro_line|#ifdef HAVE_CONFIG_H
macro_line|#include &quot;config.h&quot;
macro_line|#endif
macro_line|#include &quot;ntfstypes.h&quot;
macro_line|#include &quot;struct.h&quot;
macro_line|#include &quot;support.h&quot;
macro_line|#include &lt;stdarg.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;linux/locks.h&gt;
macro_line|#include &lt;linux/nls.h&gt;
macro_line|#include &quot;util.h&quot;
macro_line|#include &quot;inode.h&quot;
macro_line|#include &quot;macros.h&quot;
DECL|variable|print_buf
r_static
r_char
id|print_buf
(braket
l_int|1024
)braket
suffix:semicolon
macro_line|#ifdef DEBUG
macro_line|#include &quot;sysctl.h&quot;
macro_line|#include &lt;linux/kernel.h&gt;
multiline_comment|/* Debugging output */
DECL|function|ntfs_debug
r_void
id|ntfs_debug
c_func
(paren
r_int
id|mask
comma
r_const
r_char
op_star
id|fmt
comma
dot
dot
dot
)paren
(brace
id|va_list
id|ap
suffix:semicolon
multiline_comment|/* Filter it with the debugging level required */
r_if
c_cond
(paren
id|ntdebug
op_amp
id|mask
)paren
(brace
id|va_start
c_func
(paren
id|ap
comma
id|fmt
)paren
suffix:semicolon
id|strcpy
c_func
(paren
id|print_buf
comma
id|KERN_DEBUG
)paren
suffix:semicolon
id|vsprintf
c_func
(paren
id|print_buf
op_plus
l_int|3
comma
id|fmt
comma
id|ap
)paren
suffix:semicolon
id|printk
c_func
(paren
id|print_buf
)paren
suffix:semicolon
id|va_end
c_func
(paren
id|ap
)paren
suffix:semicolon
)brace
)brace
macro_line|#ifndef ntfs_malloc
multiline_comment|/* Verbose kmalloc */
DECL|function|ntfs_malloc
r_void
op_star
id|ntfs_malloc
c_func
(paren
r_int
id|size
)paren
(brace
r_void
op_star
id|ret
suffix:semicolon
id|ret
op_assign
id|kmalloc
c_func
(paren
id|size
comma
id|GFP_KERNEL
)paren
suffix:semicolon
id|ntfs_debug
c_func
(paren
id|DEBUG_MALLOC
comma
l_string|&quot;Allocating %x at %p&bslash;n&quot;
comma
id|size
comma
id|ret
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
macro_line|#endif
macro_line|#ifndef ntfs_free
multiline_comment|/* Verbose kfree() */
DECL|function|ntfs_free
r_void
id|ntfs_free
c_func
(paren
r_void
op_star
id|block
)paren
(brace
id|ntfs_debug
c_func
(paren
id|DEBUG_MALLOC
comma
l_string|&quot;Freeing memory at %p&bslash;n&quot;
comma
id|block
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|block
)paren
suffix:semicolon
)brace
macro_line|#endif
macro_line|#else
DECL|function|ntfs_debug
r_void
id|ntfs_debug
c_func
(paren
r_int
id|mask
comma
r_const
r_char
op_star
id|fmt
comma
dot
dot
dot
)paren
(brace
)brace
macro_line|#ifndef ntfs_malloc
DECL|function|ntfs_malloc
r_void
op_star
id|ntfs_malloc
c_func
(paren
r_int
id|size
)paren
(brace
r_return
id|kmalloc
c_func
(paren
id|size
comma
id|GFP_KERNEL
)paren
suffix:semicolon
)brace
macro_line|#endif
macro_line|#ifndef ntfs_free
DECL|function|ntfs_free
r_void
id|ntfs_free
c_func
(paren
r_void
op_star
id|block
)paren
(brace
id|kfree
c_func
(paren
id|block
)paren
suffix:semicolon
)brace
macro_line|#endif
macro_line|#endif /* DEBUG */
DECL|function|ntfs_bzero
r_void
id|ntfs_bzero
c_func
(paren
r_void
op_star
id|s
comma
r_int
id|n
)paren
(brace
id|memset
c_func
(paren
id|s
comma
l_int|0
comma
id|n
)paren
suffix:semicolon
)brace
multiline_comment|/* These functions deliberately return no value. It is dest, anyway,&n;   and not used anywhere in the NTFS code.  */
DECL|function|ntfs_memcpy
r_void
id|ntfs_memcpy
c_func
(paren
r_void
op_star
id|dest
comma
r_const
r_void
op_star
id|src
comma
id|ntfs_size_t
id|n
)paren
(brace
id|memcpy
c_func
(paren
id|dest
comma
id|src
comma
id|n
)paren
suffix:semicolon
)brace
DECL|function|ntfs_memmove
r_void
id|ntfs_memmove
c_func
(paren
r_void
op_star
id|dest
comma
r_const
r_void
op_star
id|src
comma
id|ntfs_size_t
id|n
)paren
(brace
id|memmove
c_func
(paren
id|dest
comma
id|src
comma
id|n
)paren
suffix:semicolon
)brace
multiline_comment|/* Warn that an error occured. */
DECL|function|ntfs_error
r_void
id|ntfs_error
c_func
(paren
r_const
r_char
op_star
id|fmt
comma
dot
dot
dot
)paren
(brace
id|va_list
id|ap
suffix:semicolon
id|va_start
c_func
(paren
id|ap
comma
id|fmt
)paren
suffix:semicolon
id|strcpy
c_func
(paren
id|print_buf
comma
id|KERN_ERR
)paren
suffix:semicolon
id|vsprintf
c_func
(paren
id|print_buf
op_plus
l_int|3
comma
id|fmt
comma
id|ap
)paren
suffix:semicolon
id|printk
c_func
(paren
id|print_buf
)paren
suffix:semicolon
id|va_end
c_func
(paren
id|ap
)paren
suffix:semicolon
)brace
DECL|function|ntfs_read_mft_record
r_int
id|ntfs_read_mft_record
c_func
(paren
id|ntfs_volume
op_star
id|vol
comma
r_int
id|mftno
comma
r_char
op_star
id|buf
)paren
(brace
r_int
id|error
suffix:semicolon
id|ntfs_io
id|io
suffix:semicolon
id|ntfs_debug
c_func
(paren
id|DEBUG_OTHER
comma
l_string|&quot;read_mft_record %x&bslash;n&quot;
comma
id|mftno
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mftno
op_eq
id|FILE_MFT
)paren
(brace
id|ntfs_memcpy
c_func
(paren
id|buf
comma
id|vol-&gt;mft
comma
id|vol-&gt;mft_recordsize
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|vol-&gt;mft_ino
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;ntfs:something is terribly wrong here&bslash;n&quot;
)paren
suffix:semicolon
r_return
id|ENODATA
suffix:semicolon
)brace
id|io.fn_put
op_assign
id|ntfs_put
suffix:semicolon
id|io.fn_get
op_assign
l_int|0
suffix:semicolon
id|io.param
op_assign
id|buf
suffix:semicolon
id|io.size
op_assign
id|vol-&gt;mft_recordsize
suffix:semicolon
id|error
op_assign
id|ntfs_read_attr
c_func
(paren
id|vol-&gt;mft_ino
comma
id|vol-&gt;at_data
comma
l_int|NULL
comma
id|mftno
op_star
id|vol-&gt;mft_recordsize
comma
op_amp
id|io
)paren
suffix:semicolon
r_if
c_cond
(paren
id|error
op_logical_or
(paren
id|io.size
op_ne
id|vol-&gt;mft_recordsize
)paren
)paren
(brace
id|ntfs_debug
c_func
(paren
id|DEBUG_OTHER
comma
l_string|&quot;read_mft_record: read %x failed (%d,%d,%d)&bslash;n&quot;
comma
id|mftno
comma
id|error
comma
id|io.size
comma
id|vol-&gt;mft_recordsize
)paren
suffix:semicolon
r_return
id|error
ques
c_cond
id|error
suffix:colon
id|ENODATA
suffix:semicolon
)brace
id|ntfs_debug
c_func
(paren
id|DEBUG_OTHER
comma
l_string|&quot;read_mft_record: finished read %x&bslash;n&quot;
comma
id|mftno
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ntfs_check_mft_record
c_func
(paren
id|vol
comma
id|buf
)paren
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;Invalid MFT record for %x&bslash;n&quot;
comma
id|mftno
)paren
suffix:semicolon
r_return
id|EINVAL
suffix:semicolon
)brace
id|ntfs_debug
c_func
(paren
id|DEBUG_OTHER
comma
l_string|&quot;read_mft_record: Done %x&bslash;n&quot;
comma
id|mftno
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|ntfs_getput_clusters
r_int
id|ntfs_getput_clusters
c_func
(paren
id|ntfs_volume
op_star
id|vol
comma
r_int
id|cluster
comma
id|ntfs_size_t
id|start_offs
comma
id|ntfs_io
op_star
id|buf
)paren
(brace
r_struct
id|super_block
op_star
id|sb
op_assign
id|NTFS_SB
c_func
(paren
id|vol
)paren
suffix:semicolon
r_struct
id|buffer_head
op_star
id|bh
suffix:semicolon
id|ntfs_size_t
id|to_copy
suffix:semicolon
r_int
id|length
op_assign
id|buf-&gt;size
suffix:semicolon
r_if
c_cond
(paren
id|buf-&gt;do_read
)paren
(brace
id|ntfs_debug
c_func
(paren
id|DEBUG_OTHER
comma
l_string|&quot;get_clusters %d %d %d&bslash;n&quot;
comma
id|cluster
comma
id|start_offs
comma
id|length
)paren
suffix:semicolon
)brace
r_else
id|ntfs_debug
c_func
(paren
id|DEBUG_OTHER
comma
l_string|&quot;put_clusters %d %d %d&bslash;n&quot;
comma
id|cluster
comma
id|start_offs
comma
id|length
)paren
suffix:semicolon
r_while
c_loop
(paren
id|length
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|bh
op_assign
id|bread
c_func
(paren
id|sb-&gt;s_dev
comma
id|cluster
comma
id|vol-&gt;clustersize
)paren
)paren
)paren
(brace
id|ntfs_debug
c_func
(paren
id|DEBUG_OTHER
comma
l_string|&quot;%s failed&bslash;n&quot;
comma
id|buf-&gt;do_read
ques
c_cond
l_string|&quot;Reading&quot;
suffix:colon
l_string|&quot;Writing&quot;
)paren
suffix:semicolon
r_return
id|EIO
suffix:semicolon
)brace
id|to_copy
op_assign
id|min
c_func
(paren
id|vol-&gt;clustersize
op_minus
id|start_offs
comma
id|length
)paren
suffix:semicolon
id|lock_buffer
c_func
(paren
id|bh
)paren
suffix:semicolon
r_if
c_cond
(paren
id|buf-&gt;do_read
)paren
(brace
id|buf
op_member_access_from_pointer
id|fn_put
c_func
(paren
id|buf
comma
id|bh-&gt;b_data
op_plus
id|start_offs
comma
id|to_copy
)paren
suffix:semicolon
)brace
r_else
(brace
id|buf
op_member_access_from_pointer
id|fn_get
c_func
(paren
id|bh-&gt;b_data
op_plus
id|start_offs
comma
id|buf
comma
id|to_copy
)paren
suffix:semicolon
id|mark_buffer_dirty
c_func
(paren
id|bh
)paren
suffix:semicolon
)brace
id|unlock_buffer
c_func
(paren
id|bh
)paren
suffix:semicolon
id|length
op_sub_assign
id|to_copy
suffix:semicolon
id|start_offs
op_assign
l_int|0
suffix:semicolon
id|cluster
op_increment
suffix:semicolon
id|brelse
c_func
(paren
id|bh
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|ntfs_now
id|ntfs_time64_t
id|ntfs_now
c_func
(paren
r_void
)paren
(brace
r_return
id|ntfs_unixutc2ntutc
c_func
(paren
id|CURRENT_TIME
)paren
suffix:semicolon
)brace
multiline_comment|/* when printing unicode characters base64, use this table.&n;   It is not strictly base64, but the Linux vfat encoding.&n;   base64 has the disadvantage of using the slash.&n;*/
DECL|variable|uni2esc
r_static
r_char
id|uni2esc
(braket
l_int|64
)braket
op_assign
l_string|&quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz+-&quot;
suffix:semicolon
r_static
r_int
r_char
DECL|function|esc2uni
id|esc2uni
c_func
(paren
r_char
id|c
)paren
(brace
r_if
c_cond
(paren
id|c
OL
l_char|&squot;0&squot;
)paren
(brace
r_return
l_int|255
suffix:semicolon
)brace
r_if
c_cond
(paren
id|c
op_le
l_char|&squot;9&squot;
)paren
(brace
r_return
id|c
op_minus
l_char|&squot;0&squot;
suffix:semicolon
)brace
r_if
c_cond
(paren
id|c
OL
l_char|&squot;A&squot;
)paren
(brace
r_return
l_int|255
suffix:semicolon
)brace
r_if
c_cond
(paren
id|c
op_le
l_char|&squot;Z&squot;
)paren
(brace
r_return
id|c
op_minus
l_char|&squot;A&squot;
op_plus
l_int|10
suffix:semicolon
)brace
r_if
c_cond
(paren
id|c
OL
l_char|&squot;a&squot;
)paren
(brace
r_return
l_int|255
suffix:semicolon
)brace
r_if
c_cond
(paren
id|c
op_le
l_char|&squot;z&squot;
)paren
(brace
r_return
id|c
op_minus
l_char|&squot;a&squot;
op_plus
l_int|36
suffix:semicolon
)brace
r_if
c_cond
(paren
id|c
op_eq
l_char|&squot;+&squot;
)paren
(brace
r_return
l_int|62
suffix:semicolon
)brace
r_if
c_cond
(paren
id|c
op_eq
l_char|&squot;-&squot;
)paren
(brace
r_return
l_int|63
suffix:semicolon
)brace
r_return
l_int|255
suffix:semicolon
)brace
DECL|function|ntfs_dupuni2map
r_int
id|ntfs_dupuni2map
c_func
(paren
id|ntfs_volume
op_star
id|vol
comma
id|ntfs_u16
op_star
id|in
comma
r_int
id|in_len
comma
r_char
op_star
op_star
id|out
comma
r_int
op_star
id|out_len
)paren
(brace
r_int
id|i
comma
id|o
comma
id|val
comma
id|chl
comma
id|chi
suffix:semicolon
r_char
op_star
id|result
comma
op_star
id|buf
comma
id|charbuf
(braket
id|NLS_MAX_CHARSET_SIZE
)braket
suffix:semicolon
r_struct
id|nls_table
op_star
id|nls
op_assign
id|vol-&gt;nls_map
suffix:semicolon
id|result
op_assign
id|ntfs_malloc
c_func
(paren
id|in_len
op_plus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|result
)paren
(brace
r_return
id|ENOMEM
suffix:semicolon
)brace
op_star
id|out_len
op_assign
id|in_len
suffix:semicolon
id|result
(braket
id|in_len
)braket
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
id|o
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|in_len
suffix:semicolon
id|i
op_increment
)paren
(brace
r_int
id|cl
comma
id|ch
suffix:semicolon
multiline_comment|/* FIXME: byte order? */
id|cl
op_assign
id|in
(braket
id|i
)braket
op_amp
l_int|0xFF
suffix:semicolon
id|ch
op_assign
(paren
id|in
(braket
id|i
)braket
op_rshift
l_int|8
)paren
op_amp
l_int|0xFF
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|nls
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|ch
)paren
(brace
id|result
(braket
id|o
op_increment
)braket
op_assign
id|cl
suffix:semicolon
r_continue
suffix:semicolon
)brace
)brace
r_else
(brace
multiline_comment|/* FIXME: byte order? */
m_wchar_t
id|uni
op_assign
id|in
(braket
id|i
)braket
suffix:semicolon
r_if
c_cond
(paren
(paren
id|chl
op_assign
id|nls
op_member_access_from_pointer
id|uni2char
c_func
(paren
id|uni
comma
id|charbuf
comma
id|NLS_MAX_CHARSET_SIZE
)paren
)paren
OG
l_int|0
)paren
(brace
multiline_comment|/* adjust result buffer */
r_if
c_cond
(paren
id|chl
OG
l_int|1
)paren
(brace
id|buf
op_assign
id|ntfs_malloc
c_func
(paren
op_star
id|out_len
op_plus
id|chl
op_minus
l_int|1
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|buf
comma
id|result
comma
id|o
)paren
suffix:semicolon
id|ntfs_free
c_func
(paren
id|result
)paren
suffix:semicolon
id|result
op_assign
id|buf
suffix:semicolon
op_star
id|out_len
op_add_assign
(paren
id|chl
op_minus
l_int|1
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|chi
op_assign
l_int|0
suffix:semicolon
id|chi
OL
id|chl
suffix:semicolon
id|chi
op_increment
)paren
id|result
(braket
id|o
op_increment
)braket
op_assign
id|charbuf
(braket
id|chi
)braket
suffix:semicolon
)brace
r_else
id|result
(braket
id|o
op_increment
)braket
op_assign
l_char|&squot;?&squot;
suffix:semicolon
r_continue
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|vol-&gt;nct
op_amp
id|nct_uni_xlate
)paren
)paren
(brace
r_goto
id|inval
suffix:semicolon
)brace
multiline_comment|/* realloc */
id|buf
op_assign
id|ntfs_malloc
c_func
(paren
op_star
id|out_len
op_plus
l_int|3
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|buf
)paren
(brace
id|ntfs_free
c_func
(paren
id|result
)paren
suffix:semicolon
r_return
id|ENOMEM
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|buf
comma
id|result
comma
id|o
)paren
suffix:semicolon
id|ntfs_free
c_func
(paren
id|result
)paren
suffix:semicolon
id|result
op_assign
id|buf
suffix:semicolon
op_star
id|out_len
op_add_assign
l_int|3
suffix:semicolon
id|result
(braket
id|o
op_increment
)braket
op_assign
l_char|&squot;:&squot;
suffix:semicolon
r_if
c_cond
(paren
id|vol-&gt;nct
op_amp
id|nct_uni_xlate_vfat
)paren
(brace
id|val
op_assign
(paren
id|cl
op_lshift
l_int|8
)paren
op_plus
id|ch
suffix:semicolon
id|result
(braket
id|o
op_plus
l_int|2
)braket
op_assign
id|uni2esc
(braket
id|val
op_amp
l_int|0x3f
)braket
suffix:semicolon
id|val
op_rshift_assign
l_int|6
suffix:semicolon
id|result
(braket
id|o
op_plus
l_int|1
)braket
op_assign
id|uni2esc
(braket
id|val
op_amp
l_int|0x3f
)braket
suffix:semicolon
id|val
op_rshift_assign
l_int|6
suffix:semicolon
id|result
(braket
id|o
)braket
op_assign
id|uni2esc
(braket
id|val
op_amp
l_int|0x3f
)braket
suffix:semicolon
id|o
op_add_assign
l_int|3
suffix:semicolon
)brace
r_else
(brace
id|val
op_assign
(paren
id|ch
op_lshift
l_int|8
)paren
op_plus
id|cl
suffix:semicolon
id|result
(braket
id|o
op_increment
)braket
op_assign
id|uni2esc
(braket
id|val
op_amp
l_int|0x3f
)braket
suffix:semicolon
id|val
op_rshift_assign
l_int|6
suffix:semicolon
id|result
(braket
id|o
op_increment
)braket
op_assign
id|uni2esc
(braket
id|val
op_amp
l_int|0x3f
)braket
suffix:semicolon
id|val
op_rshift_assign
l_int|6
suffix:semicolon
id|result
(braket
id|o
op_increment
)braket
op_assign
id|uni2esc
(braket
id|val
op_amp
l_int|0x3f
)braket
suffix:semicolon
)brace
)brace
op_star
id|out
op_assign
id|result
suffix:semicolon
r_return
l_int|0
suffix:semicolon
id|inval
suffix:colon
id|ntfs_free
c_func
(paren
id|result
)paren
suffix:semicolon
op_star
id|out
op_assign
l_int|0
suffix:semicolon
r_return
id|EILSEQ
suffix:semicolon
)brace
DECL|function|ntfs_dupmap2uni
r_int
id|ntfs_dupmap2uni
c_func
(paren
id|ntfs_volume
op_star
id|vol
comma
r_char
op_star
id|in
comma
r_int
id|in_len
comma
id|ntfs_u16
op_star
op_star
id|out
comma
r_int
op_star
id|out_len
)paren
(brace
r_int
id|i
comma
id|o
suffix:semicolon
id|ntfs_u16
op_star
id|result
suffix:semicolon
r_struct
id|nls_table
op_star
id|nls
op_assign
id|vol-&gt;nls_map
suffix:semicolon
op_star
id|out
op_assign
id|result
op_assign
id|ntfs_malloc
c_func
(paren
l_int|2
op_star
id|in_len
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|result
)paren
(brace
r_return
id|ENOMEM
suffix:semicolon
)brace
op_star
id|out_len
op_assign
id|in_len
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
id|o
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|in_len
suffix:semicolon
id|i
op_increment
comma
id|o
op_increment
)paren
(brace
m_wchar_t
id|uni
suffix:semicolon
r_if
c_cond
(paren
id|in
(braket
id|i
)braket
op_ne
l_char|&squot;:&squot;
op_logical_or
(paren
id|vol-&gt;nct
op_amp
id|nct_uni_xlate
)paren
op_eq
l_int|0
)paren
(brace
r_int
id|charlen
suffix:semicolon
multiline_comment|/* FIXME: is this error handling ok? */
id|charlen
op_assign
id|nls
op_member_access_from_pointer
id|char2uni
c_func
(paren
op_amp
id|in
(braket
id|i
)braket
comma
id|in_len
op_minus
id|i
comma
op_amp
id|uni
)paren
suffix:semicolon
r_if
c_cond
(paren
id|charlen
OL
l_int|0
)paren
r_return
id|charlen
suffix:semicolon
op_star
id|out_len
op_sub_assign
(paren
id|charlen
op_minus
l_int|1
)paren
suffix:semicolon
id|i
op_add_assign
(paren
id|charlen
op_minus
l_int|1
)paren
suffix:semicolon
)brace
r_else
(brace
r_int
r_char
id|c1
comma
id|c2
comma
id|c3
suffix:semicolon
op_star
id|out_len
op_sub_assign
l_int|3
suffix:semicolon
id|c1
op_assign
id|esc2uni
c_func
(paren
id|in
(braket
op_increment
id|i
)braket
)paren
suffix:semicolon
id|c2
op_assign
id|esc2uni
c_func
(paren
id|in
(braket
op_increment
id|i
)braket
)paren
suffix:semicolon
id|c3
op_assign
id|esc2uni
c_func
(paren
id|in
(braket
op_increment
id|i
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|c1
op_eq
l_int|255
op_logical_or
id|c2
op_eq
l_int|255
op_logical_or
id|c3
op_eq
l_int|255
)paren
(brace
id|uni
op_assign
l_int|0
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|vol-&gt;nct
op_amp
id|nct_uni_xlate_vfat
)paren
(brace
id|uni
op_assign
(paren
(paren
(paren
id|c2
op_amp
l_int|0x3
)paren
op_lshift
l_int|6
)paren
op_plus
id|c3
)paren
op_lshift
l_int|8
op_or
(paren
(paren
id|c1
op_lshift
l_int|4
)paren
op_plus
(paren
id|c2
op_rshift
l_int|2
)paren
)paren
suffix:semicolon
)brace
r_else
(brace
id|uni
op_assign
(paren
(paren
id|c3
op_lshift
l_int|4
)paren
op_plus
(paren
id|c2
op_rshift
l_int|2
)paren
)paren
op_lshift
l_int|8
op_or
(paren
(paren
(paren
id|c2
op_amp
l_int|0x3
)paren
op_lshift
l_int|6
)paren
op_plus
id|c1
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/* FIXME: byte order? */
id|result
(braket
id|o
)braket
op_assign
id|uni
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|result
(braket
id|o
)braket
)paren
(brace
id|ntfs_free
c_func
(paren
id|result
)paren
suffix:semicolon
r_return
id|EILSEQ
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * Local variables:&n; * c-file-style: &quot;linux&quot;&n; * End:&n; */
eof
