multiline_comment|/*&n; *  linux/fs/hpfs/map.c&n; *&n; *  Mikulas Patocka (mikulas@artax.karlin.mff.cuni.cz), 1998-1999&n; *&n; *  mapping structures to memory with some minimal checks&n; */
macro_line|#include &quot;hpfs_fn.h&quot;
DECL|function|hpfs_map_dnode_bitmap
r_int
op_star
id|hpfs_map_dnode_bitmap
c_func
(paren
r_struct
id|super_block
op_star
id|s
comma
r_struct
id|quad_buffer_head
op_star
id|qbh
)paren
(brace
r_return
id|hpfs_map_4sectors
c_func
(paren
id|s
comma
id|s-&gt;s_hpfs_dmap
comma
id|qbh
comma
l_int|0
)paren
suffix:semicolon
)brace
DECL|function|hpfs_map_bitmap
r_int
r_int
op_star
id|hpfs_map_bitmap
c_func
(paren
r_struct
id|super_block
op_star
id|s
comma
r_int
id|bmp_block
comma
r_struct
id|quad_buffer_head
op_star
id|qbh
comma
r_char
op_star
id|id
)paren
(brace
id|secno
id|sec
suffix:semicolon
r_if
c_cond
(paren
id|s-&gt;s_hpfs_chk
)paren
r_if
c_cond
(paren
id|bmp_block
op_star
l_int|16384
OG
id|s-&gt;s_hpfs_fs_size
)paren
(brace
id|hpfs_error
c_func
(paren
id|s
comma
l_string|&quot;hpfs_map_bitmap called with bad parameter: %08x at %s&quot;
comma
id|bmp_block
comma
id|id
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
id|sec
op_assign
id|s-&gt;s_hpfs_bmp_dir
(braket
id|bmp_block
)braket
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|sec
op_logical_or
id|sec
OG
id|s-&gt;s_hpfs_fs_size
op_minus
l_int|4
)paren
(brace
id|hpfs_error
c_func
(paren
id|s
comma
l_string|&quot;invalid bitmap block pointer %08x -&gt; %08x at %s&quot;
comma
id|bmp_block
comma
id|sec
comma
id|id
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
r_return
id|hpfs_map_4sectors
c_func
(paren
id|s
comma
id|sec
comma
id|qbh
comma
l_int|4
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Load first code page into kernel memory, return pointer to 256-byte array,&n; * first 128 bytes are uppercasing table for chars 128-255, next 128 bytes are&n; * lowercasing table&n; */
DECL|function|hpfs_load_code_page
r_char
op_star
id|hpfs_load_code_page
c_func
(paren
r_struct
id|super_block
op_star
id|s
comma
id|secno
id|cps
)paren
(brace
r_struct
id|buffer_head
op_star
id|bh
suffix:semicolon
id|secno
id|cpds
suffix:semicolon
r_int
id|cpi
suffix:semicolon
r_int
r_char
op_star
id|ptr
suffix:semicolon
r_int
r_char
op_star
id|cp_table
suffix:semicolon
r_int
id|i
suffix:semicolon
r_struct
id|code_page_data
op_star
id|cpd
suffix:semicolon
r_struct
id|code_page_directory
op_star
id|cp
op_assign
id|hpfs_map_sector
c_func
(paren
id|s
comma
id|cps
comma
op_amp
id|bh
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|cp
)paren
r_return
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
id|cp-&gt;magic
op_ne
id|CP_DIR_MAGIC
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;HPFS: Code page directory magic doesn&squot;t match (magic = %08x)&bslash;n&quot;
comma
id|cp-&gt;magic
)paren
suffix:semicolon
id|brelse
c_func
(paren
id|bh
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|cp-&gt;n_code_pages
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;HPFS: n_code_pages == 0&bslash;n&quot;
)paren
suffix:semicolon
id|brelse
c_func
(paren
id|bh
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
id|cpds
op_assign
id|cp-&gt;array
(braket
l_int|0
)braket
dot
id|code_page_data
suffix:semicolon
id|cpi
op_assign
id|cp-&gt;array
(braket
l_int|0
)braket
dot
id|index
suffix:semicolon
id|brelse
c_func
(paren
id|bh
)paren
suffix:semicolon
r_if
c_cond
(paren
id|cpi
op_ge
l_int|3
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;HPFS: Code page index out of array&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|cpd
op_assign
id|hpfs_map_sector
c_func
(paren
id|s
comma
id|cpds
comma
op_amp
id|bh
comma
l_int|0
)paren
)paren
)paren
r_return
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
(paren
r_int
)paren
id|cpd-&gt;offs
(braket
id|cpi
)braket
OG
l_int|0x178
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;HPFS: Code page index out of sector&bslash;n&quot;
)paren
suffix:semicolon
id|brelse
c_func
(paren
id|bh
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
id|ptr
op_assign
(paren
r_char
op_star
)paren
id|cpd
op_plus
id|cpd-&gt;offs
(braket
id|cpi
)braket
op_plus
l_int|6
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|cp_table
op_assign
id|kmalloc
c_func
(paren
l_int|256
comma
id|GFP_KERNEL
)paren
)paren
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;HPFS: out of memory for code page table&bslash;n&quot;
)paren
suffix:semicolon
id|brelse
c_func
(paren
id|bh
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|cp_table
comma
id|ptr
comma
l_int|128
)paren
suffix:semicolon
id|brelse
c_func
(paren
id|bh
)paren
suffix:semicolon
multiline_comment|/* Try to build lowercasing table from uppercasing one */
r_for
c_loop
(paren
id|i
op_assign
l_int|128
suffix:semicolon
id|i
OL
l_int|256
suffix:semicolon
id|i
op_increment
)paren
id|cp_table
(braket
id|i
)braket
op_assign
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|128
suffix:semicolon
id|i
OL
l_int|256
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|cp_table
(braket
id|i
op_minus
l_int|128
)braket
op_ne
id|i
op_logical_and
id|cp_table
(braket
id|i
op_minus
l_int|128
)braket
op_ge
l_int|128
)paren
id|cp_table
(braket
id|cp_table
(braket
id|i
op_minus
l_int|128
)braket
)braket
op_assign
id|i
suffix:semicolon
r_return
id|cp_table
suffix:semicolon
)brace
DECL|function|hpfs_load_bitmap_directory
id|secno
op_star
id|hpfs_load_bitmap_directory
c_func
(paren
r_struct
id|super_block
op_star
id|s
comma
id|secno
id|bmp
)paren
(brace
r_struct
id|buffer_head
op_star
id|bh
suffix:semicolon
r_int
id|n
op_assign
(paren
id|s-&gt;s_hpfs_fs_size
op_plus
l_int|0x200000
op_minus
l_int|1
)paren
op_rshift
l_int|21
suffix:semicolon
r_int
id|i
suffix:semicolon
id|secno
op_star
id|b
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|b
op_assign
id|kmalloc
c_func
(paren
id|n
op_star
l_int|512
comma
id|GFP_KERNEL
)paren
)paren
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;HPFS: can&squot;t allocate memory for bitmap directory&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|n
suffix:semicolon
id|i
op_increment
)paren
(brace
id|secno
op_star
id|d
op_assign
id|hpfs_map_sector
c_func
(paren
id|s
comma
id|bmp
op_plus
id|i
comma
op_amp
id|bh
comma
id|n
op_minus
id|i
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|d
)paren
(brace
id|kfree
c_func
(paren
id|b
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
id|memcpy
c_func
(paren
(paren
r_char
op_star
)paren
id|b
op_plus
l_int|512
op_star
id|i
comma
id|d
comma
l_int|512
)paren
suffix:semicolon
id|brelse
c_func
(paren
id|bh
)paren
suffix:semicolon
)brace
r_return
id|b
suffix:semicolon
)brace
multiline_comment|/*&n; * Load fnode to memory&n; */
DECL|function|hpfs_map_fnode
r_struct
id|fnode
op_star
id|hpfs_map_fnode
c_func
(paren
r_struct
id|super_block
op_star
id|s
comma
id|ino_t
id|ino
comma
r_struct
id|buffer_head
op_star
op_star
id|bhp
)paren
(brace
r_struct
id|fnode
op_star
id|fnode
suffix:semicolon
r_if
c_cond
(paren
id|s-&gt;s_hpfs_chk
)paren
r_if
c_cond
(paren
id|hpfs_chk_sectors
c_func
(paren
id|s
comma
id|ino
comma
l_int|1
comma
l_string|&quot;fnode&quot;
)paren
)paren
(brace
r_return
l_int|NULL
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|fnode
op_assign
id|hpfs_map_sector
c_func
(paren
id|s
comma
id|ino
comma
id|bhp
comma
id|FNODE_RD_AHEAD
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
id|s-&gt;s_hpfs_chk
)paren
(brace
r_struct
id|extended_attribute
op_star
id|ea
suffix:semicolon
r_struct
id|extended_attribute
op_star
id|ea_end
suffix:semicolon
r_if
c_cond
(paren
id|fnode-&gt;magic
op_ne
id|FNODE_MAGIC
)paren
(brace
id|hpfs_error
c_func
(paren
id|s
comma
l_string|&quot;bad magic on fnode %08x&quot;
comma
id|ino
)paren
suffix:semicolon
r_goto
id|bail
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|fnode-&gt;dirflag
)paren
(brace
r_if
c_cond
(paren
(paren
r_int
)paren
id|fnode-&gt;btree.n_used_nodes
op_plus
(paren
r_int
)paren
id|fnode-&gt;btree.n_free_nodes
op_ne
(paren
id|fnode-&gt;btree.internal
ques
c_cond
l_int|12
suffix:colon
l_int|8
)paren
)paren
(brace
id|hpfs_error
c_func
(paren
id|s
comma
l_string|&quot;bad number of nodes in fnode %08x&quot;
comma
id|ino
)paren
suffix:semicolon
r_goto
id|bail
suffix:semicolon
)brace
r_if
c_cond
(paren
id|fnode-&gt;btree.first_free
op_ne
l_int|8
op_plus
id|fnode-&gt;btree.n_used_nodes
op_star
(paren
id|fnode-&gt;btree.internal
ques
c_cond
l_int|8
suffix:colon
l_int|12
)paren
)paren
(brace
id|hpfs_error
c_func
(paren
id|s
comma
l_string|&quot;bad first_free pointer in fnode %08x&quot;
comma
id|ino
)paren
suffix:semicolon
r_goto
id|bail
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|fnode-&gt;ea_size_s
op_logical_and
(paren
(paren
r_int
r_int
)paren
id|fnode-&gt;ea_offs
template_param
l_int|0x200
)paren
)paren
(brace
id|hpfs_error
c_func
(paren
id|s
comma
l_string|&quot;bad EA info in fnode %08x: ea_offs == %04x ea_size_s == %04x&quot;
comma
id|ino
comma
id|fnode-&gt;ea_offs
comma
id|fnode-&gt;ea_size_s
)paren
suffix:semicolon
r_goto
id|bail
suffix:semicolon
)brace
id|ea
op_assign
id|fnode_ea
c_func
(paren
id|fnode
)paren
suffix:semicolon
id|ea_end
op_assign
id|fnode_end_ea
c_func
(paren
id|fnode
)paren
suffix:semicolon
r_while
c_loop
(paren
id|ea
op_ne
id|ea_end
)paren
(brace
r_if
c_cond
(paren
id|ea
OG
id|ea_end
)paren
(brace
id|hpfs_error
c_func
(paren
id|s
comma
l_string|&quot;bad EA in fnode %08x&quot;
comma
id|ino
)paren
suffix:semicolon
r_goto
id|bail
suffix:semicolon
)brace
id|ea
op_assign
id|next_ea
c_func
(paren
id|ea
)paren
suffix:semicolon
)brace
)brace
)brace
r_return
id|fnode
suffix:semicolon
id|bail
suffix:colon
id|brelse
c_func
(paren
op_star
id|bhp
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
DECL|function|hpfs_map_anode
r_struct
id|anode
op_star
id|hpfs_map_anode
c_func
(paren
r_struct
id|super_block
op_star
id|s
comma
id|anode_secno
id|ano
comma
r_struct
id|buffer_head
op_star
op_star
id|bhp
)paren
(brace
r_struct
id|anode
op_star
id|anode
suffix:semicolon
r_if
c_cond
(paren
id|s-&gt;s_hpfs_chk
)paren
r_if
c_cond
(paren
id|hpfs_chk_sectors
c_func
(paren
id|s
comma
id|ano
comma
l_int|1
comma
l_string|&quot;anode&quot;
)paren
)paren
r_return
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
(paren
id|anode
op_assign
id|hpfs_map_sector
c_func
(paren
id|s
comma
id|ano
comma
id|bhp
comma
id|ANODE_RD_AHEAD
)paren
)paren
)paren
r_if
c_cond
(paren
id|s-&gt;s_hpfs_chk
)paren
(brace
r_if
c_cond
(paren
id|anode-&gt;magic
op_ne
id|ANODE_MAGIC
op_logical_or
id|anode-&gt;self
op_ne
id|ano
)paren
(brace
id|hpfs_error
c_func
(paren
id|s
comma
l_string|&quot;bad magic on anode %08x&quot;
comma
id|ano
)paren
suffix:semicolon
r_goto
id|bail
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
r_int
)paren
id|anode-&gt;btree.n_used_nodes
op_plus
(paren
r_int
)paren
id|anode-&gt;btree.n_free_nodes
op_ne
(paren
id|anode-&gt;btree.internal
ques
c_cond
l_int|60
suffix:colon
l_int|40
)paren
)paren
(brace
id|hpfs_error
c_func
(paren
id|s
comma
l_string|&quot;bad number of nodes in anode %08x&quot;
comma
id|ano
)paren
suffix:semicolon
r_goto
id|bail
suffix:semicolon
)brace
r_if
c_cond
(paren
id|anode-&gt;btree.first_free
op_ne
l_int|8
op_plus
id|anode-&gt;btree.n_used_nodes
op_star
(paren
id|anode-&gt;btree.internal
ques
c_cond
l_int|8
suffix:colon
l_int|12
)paren
)paren
(brace
id|hpfs_error
c_func
(paren
id|s
comma
l_string|&quot;bad first_free pointer in anode %08x&quot;
comma
id|ano
)paren
suffix:semicolon
r_goto
id|bail
suffix:semicolon
)brace
)brace
r_return
id|anode
suffix:semicolon
id|bail
suffix:colon
id|brelse
c_func
(paren
op_star
id|bhp
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
multiline_comment|/*&n; * Load dnode to memory and do some checks&n; */
DECL|function|hpfs_map_dnode
r_struct
id|dnode
op_star
id|hpfs_map_dnode
c_func
(paren
r_struct
id|super_block
op_star
id|s
comma
r_int
id|secno
comma
r_struct
id|quad_buffer_head
op_star
id|qbh
)paren
(brace
r_struct
id|dnode
op_star
id|dnode
suffix:semicolon
r_if
c_cond
(paren
id|s-&gt;s_hpfs_chk
)paren
(brace
r_if
c_cond
(paren
id|hpfs_chk_sectors
c_func
(paren
id|s
comma
id|secno
comma
l_int|4
comma
l_string|&quot;dnode&quot;
)paren
)paren
r_return
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
id|secno
op_amp
l_int|3
)paren
(brace
id|hpfs_error
c_func
(paren
id|s
comma
l_string|&quot;dnode %08x not byte-aligned&quot;
comma
id|secno
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
(paren
id|dnode
op_assign
id|hpfs_map_4sectors
c_func
(paren
id|s
comma
id|secno
comma
id|qbh
comma
id|DNODE_RD_AHEAD
)paren
)paren
)paren
r_if
c_cond
(paren
id|s-&gt;s_hpfs_chk
)paren
(brace
r_int
id|p
comma
id|pp
op_assign
l_int|0
suffix:semicolon
r_int
r_char
op_star
id|d
op_assign
(paren
r_char
op_star
)paren
id|dnode
suffix:semicolon
r_int
id|b
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|dnode-&gt;magic
op_ne
id|DNODE_MAGIC
)paren
(brace
id|hpfs_error
c_func
(paren
id|s
comma
l_string|&quot;bad magic on dnode %08x&quot;
comma
id|secno
)paren
suffix:semicolon
r_goto
id|bail
suffix:semicolon
)brace
r_if
c_cond
(paren
id|dnode-&gt;self
op_ne
id|secno
)paren
id|hpfs_error
c_func
(paren
id|s
comma
l_string|&quot;bad self pointer on dnode %08x self = %08x&quot;
comma
id|secno
comma
id|dnode-&gt;self
)paren
suffix:semicolon
multiline_comment|/* Check dirents - bad dirents would cause infinite&n;&t;&t;&t;   loops or shooting to memory */
r_if
c_cond
(paren
id|dnode-&gt;first_free
OG
l_int|2048
multiline_comment|/* || dnode-&gt;first_free &lt; 84*/
)paren
(brace
id|hpfs_error
c_func
(paren
id|s
comma
l_string|&quot;dnode %08x has first_free == %08x&quot;
comma
id|secno
comma
id|dnode-&gt;first_free
)paren
suffix:semicolon
r_goto
id|bail
suffix:semicolon
)brace
r_for
c_loop
(paren
id|p
op_assign
l_int|20
suffix:semicolon
id|p
OL
id|dnode-&gt;first_free
suffix:semicolon
id|p
op_add_assign
id|d
(braket
id|p
)braket
op_plus
(paren
id|d
(braket
id|p
op_plus
l_int|1
)braket
op_lshift
l_int|8
)paren
)paren
(brace
r_struct
id|hpfs_dirent
op_star
id|de
op_assign
(paren
r_struct
id|hpfs_dirent
op_star
)paren
(paren
(paren
r_char
op_star
)paren
id|dnode
op_plus
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
id|de-&gt;length
OG
l_int|292
op_logical_or
(paren
id|de-&gt;length
OL
l_int|32
)paren
op_logical_or
(paren
id|de-&gt;length
op_amp
l_int|3
)paren
)paren
(brace
id|hpfs_error
c_func
(paren
id|s
comma
l_string|&quot;bad dirent size in dnode %08x, dirent %03x, last %03x&quot;
comma
id|secno
comma
id|p
comma
id|pp
)paren
suffix:semicolon
r_goto
id|bail
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
(paren
l_int|31
op_plus
id|de-&gt;namelen
op_plus
id|de-&gt;down
op_star
l_int|4
op_plus
l_int|3
)paren
op_amp
op_complement
l_int|3
)paren
op_ne
id|de-&gt;length
)paren
(brace
id|hpfs_error
c_func
(paren
id|s
comma
l_string|&quot;namelen does not match dirent size in dnode %08x, dirent %03x, last %03x&quot;
comma
id|secno
comma
id|p
comma
id|pp
)paren
suffix:semicolon
r_goto
id|bail
suffix:semicolon
)brace
r_if
c_cond
(paren
id|s-&gt;s_hpfs_chk
op_ge
l_int|2
)paren
id|b
op_or_assign
l_int|1
op_lshift
id|de-&gt;down
suffix:semicolon
r_if
c_cond
(paren
id|de-&gt;down
)paren
r_if
c_cond
(paren
id|de_down_pointer
c_func
(paren
id|de
)paren
OL
l_int|0x10
)paren
(brace
id|hpfs_error
c_func
(paren
id|s
comma
l_string|&quot;bad down pointer in dnode %08x, dirent %03x, last %03x&quot;
comma
id|secno
comma
id|p
comma
id|pp
)paren
suffix:semicolon
r_goto
id|bail
suffix:semicolon
)brace
id|pp
op_assign
id|p
suffix:semicolon
)brace
r_if
c_cond
(paren
id|p
op_ne
id|dnode-&gt;first_free
)paren
(brace
id|hpfs_error
c_func
(paren
id|s
comma
l_string|&quot;size on last dirent does not match first_free; dnode %08x&quot;
comma
id|secno
)paren
suffix:semicolon
r_goto
id|bail
suffix:semicolon
)brace
r_if
c_cond
(paren
id|d
(braket
id|pp
op_plus
l_int|30
)braket
op_ne
l_int|1
op_logical_or
id|d
(braket
id|pp
op_plus
l_int|31
)braket
op_ne
l_int|255
)paren
(brace
id|hpfs_error
c_func
(paren
id|s
comma
l_string|&quot;dnode %08x does not end with &bslash;&bslash;377 entry&quot;
comma
id|secno
)paren
suffix:semicolon
r_goto
id|bail
suffix:semicolon
)brace
r_if
c_cond
(paren
id|b
op_eq
l_int|3
)paren
id|printk
c_func
(paren
l_string|&quot;HPFS: warning: unbalanced dnode tree, dnode %08x; see hpfs.txt 4 more info&bslash;n&quot;
comma
id|secno
)paren
suffix:semicolon
)brace
r_return
id|dnode
suffix:semicolon
id|bail
suffix:colon
id|hpfs_brelse4
c_func
(paren
id|qbh
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
DECL|function|hpfs_fnode_dno
id|dnode_secno
id|hpfs_fnode_dno
c_func
(paren
r_struct
id|super_block
op_star
id|s
comma
id|ino_t
id|ino
)paren
(brace
r_struct
id|buffer_head
op_star
id|bh
suffix:semicolon
r_struct
id|fnode
op_star
id|fnode
suffix:semicolon
id|dnode_secno
id|dno
suffix:semicolon
id|fnode
op_assign
id|hpfs_map_fnode
c_func
(paren
id|s
comma
id|ino
comma
op_amp
id|bh
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|fnode
)paren
r_return
l_int|0
suffix:semicolon
id|dno
op_assign
id|fnode-&gt;u.external
(braket
l_int|0
)braket
dot
id|disk_secno
suffix:semicolon
id|brelse
c_func
(paren
id|bh
)paren
suffix:semicolon
r_return
id|dno
suffix:semicolon
)brace
eof
