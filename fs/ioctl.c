multiline_comment|/*&n; *  linux/fs/ioctl.c&n; *&n; *  (C) 1991  Linus Torvalds&n; */
macro_line|#include &lt;string.h&gt;
macro_line|#include &lt;errno.h&gt;
macro_line|#include &lt;sys/stat.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
r_extern
r_int
id|tty_ioctl
c_func
(paren
r_int
id|dev
comma
r_int
id|cmd
comma
r_int
id|arg
)paren
suffix:semicolon
DECL|typedef|ioctl_ptr
r_typedef
r_int
(paren
op_star
id|ioctl_ptr
)paren
(paren
r_int
id|dev
comma
r_int
id|cmd
comma
r_int
id|arg
)paren
suffix:semicolon
DECL|macro|NRDEVS
mdefine_line|#define NRDEVS ((sizeof (ioctl_table))/(sizeof (ioctl_ptr)))
DECL|variable|ioctl_table
r_static
id|ioctl_ptr
id|ioctl_table
(braket
)braket
op_assign
initialization_block
suffix:semicolon
multiline_comment|/* named pipes */
DECL|function|sys_ioctl
r_int
id|sys_ioctl
c_func
(paren
r_int
r_int
id|fd
comma
r_int
r_int
id|cmd
comma
r_int
r_int
id|arg
)paren
(brace
r_struct
id|file
op_star
id|filp
suffix:semicolon
r_int
id|dev
comma
id|mode
suffix:semicolon
r_if
c_cond
(paren
id|fd
op_ge
id|NR_OPEN
op_logical_or
op_logical_neg
(paren
id|filp
op_assign
id|current-&gt;filp
(braket
id|fd
)braket
)paren
)paren
r_return
op_minus
id|EBADF
suffix:semicolon
id|mode
op_assign
id|filp-&gt;f_inode-&gt;i_mode
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|S_ISCHR
c_func
(paren
id|mode
)paren
op_logical_and
op_logical_neg
id|S_ISBLK
c_func
(paren
id|mode
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|dev
op_assign
id|filp-&gt;f_inode-&gt;i_zone
(braket
l_int|0
)braket
suffix:semicolon
r_if
c_cond
(paren
id|MAJOR
c_func
(paren
id|dev
)paren
op_ge
id|NRDEVS
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ioctl_table
(braket
id|MAJOR
c_func
(paren
id|dev
)paren
)braket
)paren
r_return
op_minus
id|ENOTTY
suffix:semicolon
r_return
id|ioctl_table
(braket
id|MAJOR
c_func
(paren
id|dev
)paren
)braket
(paren
id|dev
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
)brace
eof
