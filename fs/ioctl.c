multiline_comment|/*&n; *  linux/fs/ioctl.c&n; *&n; *  (C) 1991  Linus Torvalds&n; */
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;errno.h&gt;
macro_line|#include &lt;sys/stat.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
DECL|function|sys_ioctl
r_int
id|sys_ioctl
c_func
(paren
r_int
r_int
id|fd
comma
r_int
r_int
id|cmd
comma
r_int
r_int
id|arg
)paren
(brace
r_struct
id|file
op_star
id|filp
suffix:semicolon
r_if
c_cond
(paren
id|fd
op_ge
id|NR_OPEN
op_logical_or
op_logical_neg
(paren
id|filp
op_assign
id|current-&gt;filp
(braket
id|fd
)braket
)paren
)paren
r_return
op_minus
id|EBADF
suffix:semicolon
r_if
c_cond
(paren
id|filp-&gt;f_op
op_logical_and
id|filp-&gt;f_op-&gt;ioctl
)paren
r_return
id|filp-&gt;f_op
op_member_access_from_pointer
id|ioctl
c_func
(paren
id|filp-&gt;f_inode
comma
id|filp
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
eof
