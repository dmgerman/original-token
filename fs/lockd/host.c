multiline_comment|/*&n; * linux/fs/lockd/host.c&n; *&n; * Management for NLM peer hosts. The nlm_host struct is shared&n; * between client and server implementation. The only reason to&n; * do so is to reduce code bloat.&n; *&n; * Copyright (C) 1996, Olaf Kirch &lt;okir@monad.swb.de&gt;&n; */
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/malloc.h&gt;
macro_line|#include &lt;linux/in.h&gt;
macro_line|#include &lt;linux/sunrpc/clnt.h&gt;
macro_line|#include &lt;linux/sunrpc/svc.h&gt;
macro_line|#include &lt;linux/lockd/lockd.h&gt;
macro_line|#include &lt;linux/lockd/sm_inter.h&gt;
DECL|macro|NLMDBG_FACILITY
mdefine_line|#define NLMDBG_FACILITY&t;&t;NLMDBG_HOSTCACHE
DECL|macro|NLM_HOST_MAX
mdefine_line|#define NLM_HOST_MAX&t;&t;64
DECL|macro|NLM_HOST_NRHASH
mdefine_line|#define NLM_HOST_NRHASH&t;&t;32
DECL|macro|NLM_ADDRHASH
mdefine_line|#define NLM_ADDRHASH(addr)&t;(ntohl(addr) &amp; (NLM_HOST_NRHASH-1))
DECL|macro|NLM_PTRHASH
mdefine_line|#define NLM_PTRHASH(ptr)&t;((((u32)(unsigned long) ptr) / 32) &amp; (NLM_HOST_NRHASH-1))
DECL|macro|NLM_HOST_REBIND
mdefine_line|#define NLM_HOST_REBIND&t;&t;(60 * HZ)
DECL|macro|NLM_HOST_EXPIRE
mdefine_line|#define NLM_HOST_EXPIRE&t;&t;((nrhosts &gt; NLM_HOST_MAX)? 300 * HZ : 120 * HZ)
DECL|macro|NLM_HOST_COLLECT
mdefine_line|#define NLM_HOST_COLLECT&t;((nrhosts &gt; NLM_HOST_MAX)? 120 * HZ :  60 * HZ)
DECL|macro|NLM_HOST_ADDR
mdefine_line|#define NLM_HOST_ADDR(sv)&t;(&amp;(sv)-&gt;s_nlmclnt-&gt;cl_xprt-&gt;addr)
DECL|variable|nlm_hosts
r_static
r_struct
id|nlm_host
op_star
id|nlm_hosts
(braket
id|NLM_HOST_NRHASH
)braket
suffix:semicolon
DECL|variable|next_gc
r_static
r_int
r_int
id|next_gc
suffix:semicolon
DECL|variable|nrhosts
r_static
r_int
id|nrhosts
suffix:semicolon
r_static
id|DECLARE_MUTEX
c_func
(paren
id|nlm_host_sema
)paren
suffix:semicolon
r_static
r_void
id|nlm_gc_hosts
c_func
(paren
r_void
)paren
suffix:semicolon
multiline_comment|/*&n; * Find an NLM server handle in the cache. If there is none, create it.&n; */
r_struct
id|nlm_host
op_star
DECL|function|nlmclnt_lookup_host
id|nlmclnt_lookup_host
c_func
(paren
r_struct
id|sockaddr_in
op_star
id|sin
comma
r_int
id|proto
comma
r_int
id|version
)paren
(brace
r_return
id|nlm_lookup_host
c_func
(paren
l_int|NULL
comma
id|sin
comma
id|proto
comma
id|version
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Find an NLM client handle in the cache. If there is none, create it.&n; */
r_struct
id|nlm_host
op_star
DECL|function|nlmsvc_lookup_host
id|nlmsvc_lookup_host
c_func
(paren
r_struct
id|svc_rqst
op_star
id|rqstp
)paren
(brace
r_return
id|nlm_lookup_host
c_func
(paren
id|rqstp-&gt;rq_client
comma
op_amp
id|rqstp-&gt;rq_addr
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Match the given host against client/address&n; */
r_static
r_inline
r_int
DECL|function|nlm_match_host
id|nlm_match_host
c_func
(paren
r_struct
id|nlm_host
op_star
id|host
comma
r_struct
id|svc_client
op_star
id|clnt
comma
r_struct
id|sockaddr_in
op_star
id|sin
)paren
(brace
r_if
c_cond
(paren
id|clnt
)paren
r_return
id|host-&gt;h_exportent
op_eq
id|clnt
suffix:semicolon
r_return
id|nlm_cmp_addr
c_func
(paren
op_amp
id|host-&gt;h_addr
comma
id|sin
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Common host lookup routine for server &amp; client&n; */
r_struct
id|nlm_host
op_star
DECL|function|nlm_lookup_host
id|nlm_lookup_host
c_func
(paren
r_struct
id|svc_client
op_star
id|clnt
comma
r_struct
id|sockaddr_in
op_star
id|sin
comma
r_int
id|proto
comma
r_int
id|version
)paren
(brace
r_struct
id|nlm_host
op_star
id|host
comma
op_star
op_star
id|hp
suffix:semicolon
id|u32
id|addr
suffix:semicolon
r_int
id|hash
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|clnt
op_logical_and
op_logical_neg
id|sin
)paren
(brace
id|printk
c_func
(paren
id|KERN_NOTICE
l_string|&quot;lockd: no clnt or addr in lookup_host!&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
id|dprintk
c_func
(paren
l_string|&quot;lockd: nlm_lookup_host(%08x, p=%d, v=%d)&bslash;n&quot;
comma
(paren
r_int
)paren
(paren
id|sin
ques
c_cond
id|ntohl
c_func
(paren
id|sin-&gt;sin_addr.s_addr
)paren
suffix:colon
l_int|0
)paren
comma
id|proto
comma
id|version
)paren
suffix:semicolon
r_if
c_cond
(paren
id|clnt
)paren
id|hash
op_assign
id|NLM_PTRHASH
c_func
(paren
id|clnt
)paren
suffix:semicolon
r_else
id|hash
op_assign
id|NLM_ADDRHASH
c_func
(paren
id|sin-&gt;sin_addr.s_addr
)paren
suffix:semicolon
multiline_comment|/* Lock hash table */
id|down
c_func
(paren
op_amp
id|nlm_host_sema
)paren
suffix:semicolon
r_if
c_cond
(paren
id|time_after_eq
c_func
(paren
id|jiffies
comma
id|next_gc
)paren
)paren
id|nlm_gc_hosts
c_func
(paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|hp
op_assign
op_amp
id|nlm_hosts
(braket
id|hash
)braket
suffix:semicolon
(paren
id|host
op_assign
op_star
id|hp
)paren
suffix:semicolon
id|hp
op_assign
op_amp
id|host-&gt;h_next
)paren
(brace
r_if
c_cond
(paren
id|host-&gt;h_version
op_ne
id|version
op_logical_or
id|host-&gt;h_proto
op_ne
id|proto
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|nlm_match_host
c_func
(paren
id|host
comma
id|clnt
comma
id|sin
)paren
)paren
(brace
r_if
c_cond
(paren
id|hp
op_ne
id|nlm_hosts
op_plus
id|hash
)paren
(brace
op_star
id|hp
op_assign
id|host-&gt;h_next
suffix:semicolon
id|host-&gt;h_next
op_assign
id|nlm_hosts
(braket
id|hash
)braket
suffix:semicolon
id|nlm_hosts
(braket
id|hash
)braket
op_assign
id|host
suffix:semicolon
)brace
id|nlm_get_host
c_func
(paren
id|host
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|nlm_host_sema
)paren
suffix:semicolon
r_return
id|host
suffix:semicolon
)brace
)brace
multiline_comment|/* special hack for nlmsvc_invalidate_client */
r_if
c_cond
(paren
id|sin
op_eq
l_int|NULL
)paren
r_goto
id|nohost
suffix:semicolon
multiline_comment|/* Ooops, no host found, create it */
id|dprintk
c_func
(paren
l_string|&quot;lockd: creating host entry&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|host
op_assign
(paren
r_struct
id|nlm_host
op_star
)paren
id|kmalloc
c_func
(paren
r_sizeof
(paren
op_star
id|host
)paren
comma
id|GFP_KERNEL
)paren
)paren
)paren
r_goto
id|nohost
suffix:semicolon
id|memset
c_func
(paren
id|host
comma
l_int|0
comma
r_sizeof
(paren
op_star
id|host
)paren
)paren
suffix:semicolon
id|addr
op_assign
id|sin-&gt;sin_addr.s_addr
suffix:semicolon
id|sprintf
c_func
(paren
id|host-&gt;h_name
comma
l_string|&quot;%d.%d.%d.%d&quot;
comma
(paren
r_int
r_char
)paren
(paren
id|ntohl
c_func
(paren
id|addr
)paren
op_rshift
l_int|24
)paren
comma
(paren
r_int
r_char
)paren
(paren
id|ntohl
c_func
(paren
id|addr
)paren
op_rshift
l_int|16
)paren
comma
(paren
r_int
r_char
)paren
(paren
id|ntohl
c_func
(paren
id|addr
)paren
op_rshift
l_int|8
)paren
comma
(paren
r_int
r_char
)paren
(paren
id|ntohl
c_func
(paren
id|addr
)paren
op_rshift
l_int|0
)paren
)paren
suffix:semicolon
id|host-&gt;h_addr
op_assign
op_star
id|sin
suffix:semicolon
id|host-&gt;h_addr.sin_port
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* ouch! */
id|host-&gt;h_version
op_assign
id|version
suffix:semicolon
id|host-&gt;h_proto
op_assign
id|proto
suffix:semicolon
id|host-&gt;h_authflavor
op_assign
id|RPC_AUTH_UNIX
suffix:semicolon
id|host-&gt;h_rpcclnt
op_assign
l_int|NULL
suffix:semicolon
id|init_MUTEX
c_func
(paren
op_amp
id|host-&gt;h_sema
)paren
suffix:semicolon
id|host-&gt;h_nextrebind
op_assign
id|jiffies
op_plus
id|NLM_HOST_REBIND
suffix:semicolon
id|host-&gt;h_expires
op_assign
id|jiffies
op_plus
id|NLM_HOST_EXPIRE
suffix:semicolon
id|host-&gt;h_count
op_assign
l_int|1
suffix:semicolon
id|init_waitqueue_head
c_func
(paren
op_amp
id|host-&gt;h_gracewait
)paren
suffix:semicolon
id|host-&gt;h_state
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* pseudo NSM state */
id|host-&gt;h_nsmstate
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* real NSM state */
id|host-&gt;h_exportent
op_assign
id|clnt
suffix:semicolon
id|host-&gt;h_next
op_assign
id|nlm_hosts
(braket
id|hash
)braket
suffix:semicolon
id|nlm_hosts
(braket
id|hash
)braket
op_assign
id|host
suffix:semicolon
r_if
c_cond
(paren
op_increment
id|nrhosts
OG
id|NLM_HOST_MAX
)paren
id|next_gc
op_assign
l_int|0
suffix:semicolon
id|nohost
suffix:colon
id|up
c_func
(paren
op_amp
id|nlm_host_sema
)paren
suffix:semicolon
r_return
id|host
suffix:semicolon
)brace
multiline_comment|/*&n; * Create the NLM RPC client for an NLM peer&n; */
r_struct
id|rpc_clnt
op_star
DECL|function|nlm_bind_host
id|nlm_bind_host
c_func
(paren
r_struct
id|nlm_host
op_star
id|host
)paren
(brace
r_struct
id|rpc_clnt
op_star
id|clnt
suffix:semicolon
r_struct
id|rpc_xprt
op_star
id|xprt
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;lockd: nlm_bind_host(%08x)&bslash;n&quot;
comma
(paren
r_int
)paren
id|ntohl
c_func
(paren
id|host-&gt;h_addr.sin_addr.s_addr
)paren
)paren
suffix:semicolon
multiline_comment|/* Lock host handle */
id|down
c_func
(paren
op_amp
id|host-&gt;h_sema
)paren
suffix:semicolon
multiline_comment|/* If we&squot;ve already created an RPC client, check whether&n;&t; * RPC rebind is required&n;&t; * Note: why keep rebinding if we&squot;re on a tcp connection?&n;&t; */
r_if
c_cond
(paren
(paren
id|clnt
op_assign
id|host-&gt;h_rpcclnt
)paren
op_ne
l_int|NULL
)paren
(brace
id|xprt
op_assign
id|clnt-&gt;cl_xprt
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|xprt-&gt;stream
op_logical_and
id|time_after_eq
c_func
(paren
id|jiffies
comma
id|host-&gt;h_nextrebind
)paren
)paren
(brace
id|clnt-&gt;cl_port
op_assign
l_int|0
suffix:semicolon
id|host-&gt;h_nextrebind
op_assign
id|jiffies
op_plus
id|NLM_HOST_REBIND
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;lockd: next rebind in %ld jiffies&bslash;n&quot;
comma
id|host-&gt;h_nextrebind
op_minus
id|jiffies
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
id|uid_t
id|saved_fsuid
op_assign
id|current-&gt;fsuid
suffix:semicolon
id|kernel_cap_t
id|saved_cap
op_assign
id|current-&gt;cap_effective
suffix:semicolon
multiline_comment|/* Create RPC socket as root user so we get a priv port */
id|current-&gt;fsuid
op_assign
l_int|0
suffix:semicolon
id|cap_raise
(paren
id|current-&gt;cap_effective
comma
id|CAP_NET_BIND_SERVICE
)paren
suffix:semicolon
id|xprt
op_assign
id|xprt_create_proto
c_func
(paren
id|host-&gt;h_proto
comma
op_amp
id|host-&gt;h_addr
comma
l_int|NULL
)paren
suffix:semicolon
id|current-&gt;fsuid
op_assign
id|saved_fsuid
suffix:semicolon
id|current-&gt;cap_effective
op_assign
id|saved_cap
suffix:semicolon
r_if
c_cond
(paren
id|xprt
op_eq
l_int|NULL
)paren
r_goto
id|forgetit
suffix:semicolon
id|xprt_set_timeout
c_func
(paren
op_amp
id|xprt-&gt;timeout
comma
l_int|5
comma
id|nlmsvc_timeout
)paren
suffix:semicolon
id|clnt
op_assign
id|rpc_create_client
c_func
(paren
id|xprt
comma
id|host-&gt;h_name
comma
op_amp
id|nlm_program
comma
id|host-&gt;h_version
comma
id|host-&gt;h_authflavor
)paren
suffix:semicolon
r_if
c_cond
(paren
id|clnt
op_eq
l_int|NULL
)paren
(brace
id|xprt_destroy
c_func
(paren
id|xprt
)paren
suffix:semicolon
r_goto
id|forgetit
suffix:semicolon
)brace
id|clnt-&gt;cl_autobind
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* turn on pmap queries */
id|xprt-&gt;nocong
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* No congestion control for NLM */
id|host-&gt;h_rpcclnt
op_assign
id|clnt
suffix:semicolon
)brace
id|up
c_func
(paren
op_amp
id|host-&gt;h_sema
)paren
suffix:semicolon
r_return
id|clnt
suffix:semicolon
id|forgetit
suffix:colon
id|printk
c_func
(paren
l_string|&quot;lockd: couldn&squot;t create RPC handle for %s&bslash;n&quot;
comma
id|host-&gt;h_name
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|host-&gt;h_sema
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
multiline_comment|/*&n; * Force a portmap lookup of the remote lockd port&n; */
r_void
DECL|function|nlm_rebind_host
id|nlm_rebind_host
c_func
(paren
r_struct
id|nlm_host
op_star
id|host
)paren
(brace
id|dprintk
c_func
(paren
l_string|&quot;lockd: rebind host %s&bslash;n&quot;
comma
id|host-&gt;h_name
)paren
suffix:semicolon
r_if
c_cond
(paren
id|host-&gt;h_rpcclnt
op_logical_and
id|time_after_eq
c_func
(paren
id|jiffies
comma
id|host-&gt;h_nextrebind
)paren
)paren
(brace
id|host-&gt;h_rpcclnt-&gt;cl_port
op_assign
l_int|0
suffix:semicolon
id|host-&gt;h_nextrebind
op_assign
id|jiffies
op_plus
id|NLM_HOST_REBIND
suffix:semicolon
)brace
)brace
multiline_comment|/*&n; * Increment NLM host count&n; */
DECL|function|nlm_get_host
r_struct
id|nlm_host
op_star
id|nlm_get_host
c_func
(paren
r_struct
id|nlm_host
op_star
id|host
)paren
(brace
r_if
c_cond
(paren
id|host
)paren
(brace
id|dprintk
c_func
(paren
l_string|&quot;lockd: get host %s&bslash;n&quot;
comma
id|host-&gt;h_name
)paren
suffix:semicolon
id|host-&gt;h_count
op_increment
suffix:semicolon
id|host-&gt;h_expires
op_assign
id|jiffies
op_plus
id|NLM_HOST_EXPIRE
suffix:semicolon
)brace
r_return
id|host
suffix:semicolon
)brace
multiline_comment|/*&n; * Release NLM host after use&n; */
DECL|function|nlm_release_host
r_void
id|nlm_release_host
c_func
(paren
r_struct
id|nlm_host
op_star
id|host
)paren
(brace
r_if
c_cond
(paren
id|host
op_logical_and
id|host-&gt;h_count
)paren
(brace
id|dprintk
c_func
(paren
l_string|&quot;lockd: release host %s&bslash;n&quot;
comma
id|host-&gt;h_name
)paren
suffix:semicolon
id|host-&gt;h_count
op_decrement
suffix:semicolon
)brace
)brace
multiline_comment|/*&n; * Shut down the hosts module.&n; * Note that this routine is called only at server shutdown time.&n; */
r_void
DECL|function|nlm_shutdown_hosts
id|nlm_shutdown_hosts
c_func
(paren
r_void
)paren
(brace
r_struct
id|nlm_host
op_star
id|host
suffix:semicolon
r_int
id|i
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;lockd: shutting down host module&bslash;n&quot;
)paren
suffix:semicolon
id|down
c_func
(paren
op_amp
id|nlm_host_sema
)paren
suffix:semicolon
multiline_comment|/* First, make all hosts eligible for gc */
id|dprintk
c_func
(paren
l_string|&quot;lockd: nuking all hosts...&bslash;n&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|NLM_HOST_NRHASH
suffix:semicolon
id|i
op_increment
)paren
(brace
r_for
c_loop
(paren
id|host
op_assign
id|nlm_hosts
(braket
id|i
)braket
suffix:semicolon
id|host
suffix:semicolon
id|host
op_assign
id|host-&gt;h_next
)paren
id|host-&gt;h_expires
op_assign
l_int|0
suffix:semicolon
)brace
multiline_comment|/* Then, perform a garbage collection pass */
id|nlm_gc_hosts
c_func
(paren
)paren
suffix:semicolon
id|up
c_func
(paren
op_amp
id|nlm_host_sema
)paren
suffix:semicolon
multiline_comment|/* complain if any hosts are left */
r_if
c_cond
(paren
id|nrhosts
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;lockd: couldn&squot;t shutdown host module!&bslash;n&quot;
)paren
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;lockd: %d hosts left:&bslash;n&quot;
comma
id|nrhosts
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|NLM_HOST_NRHASH
suffix:semicolon
id|i
op_increment
)paren
(brace
r_for
c_loop
(paren
id|host
op_assign
id|nlm_hosts
(braket
id|i
)braket
suffix:semicolon
id|host
suffix:semicolon
id|host
op_assign
id|host-&gt;h_next
)paren
(brace
id|dprintk
c_func
(paren
l_string|&quot;       %s (cnt %d use %d exp %ld)&bslash;n&quot;
comma
id|host-&gt;h_name
comma
id|host-&gt;h_count
comma
id|host-&gt;h_inuse
comma
id|host-&gt;h_expires
)paren
suffix:semicolon
)brace
)brace
)brace
)brace
multiline_comment|/*&n; * Garbage collect any unused NLM hosts.&n; * This GC combines reference counting for async operations with&n; * mark &amp; sweep for resources held by remote clients.&n; */
r_static
r_void
DECL|function|nlm_gc_hosts
id|nlm_gc_hosts
c_func
(paren
r_void
)paren
(brace
r_struct
id|nlm_host
op_star
op_star
id|q
comma
op_star
id|host
suffix:semicolon
r_struct
id|rpc_clnt
op_star
id|clnt
suffix:semicolon
r_int
id|i
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;lockd: host garbage collection&bslash;n&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|NLM_HOST_NRHASH
suffix:semicolon
id|i
op_increment
)paren
(brace
r_for
c_loop
(paren
id|host
op_assign
id|nlm_hosts
(braket
id|i
)braket
suffix:semicolon
id|host
suffix:semicolon
id|host
op_assign
id|host-&gt;h_next
)paren
id|host-&gt;h_inuse
op_assign
l_int|0
suffix:semicolon
)brace
multiline_comment|/* Mark all hosts that hold locks, blocks or shares */
id|nlmsvc_mark_resources
c_func
(paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|NLM_HOST_NRHASH
suffix:semicolon
id|i
op_increment
)paren
(brace
id|q
op_assign
op_amp
id|nlm_hosts
(braket
id|i
)braket
suffix:semicolon
r_while
c_loop
(paren
(paren
id|host
op_assign
op_star
id|q
)paren
op_ne
l_int|NULL
)paren
(brace
r_if
c_cond
(paren
id|host-&gt;h_count
op_logical_or
id|host-&gt;h_inuse
op_logical_or
id|time_before
c_func
(paren
id|jiffies
comma
id|host-&gt;h_expires
)paren
)paren
(brace
id|q
op_assign
op_amp
id|host-&gt;h_next
suffix:semicolon
r_continue
suffix:semicolon
)brace
id|dprintk
c_func
(paren
l_string|&quot;lockd: delete host %s&bslash;n&quot;
comma
id|host-&gt;h_name
)paren
suffix:semicolon
op_star
id|q
op_assign
id|host-&gt;h_next
suffix:semicolon
r_if
c_cond
(paren
id|host-&gt;h_monitored
)paren
id|nsm_unmonitor
c_func
(paren
id|host
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|clnt
op_assign
id|host-&gt;h_rpcclnt
)paren
op_ne
l_int|NULL
)paren
(brace
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|clnt-&gt;cl_users
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;lockd: active RPC handle&bslash;n&quot;
)paren
suffix:semicolon
id|clnt-&gt;cl_dead
op_assign
l_int|1
suffix:semicolon
)brace
r_else
(brace
id|rpc_destroy_client
c_func
(paren
id|host-&gt;h_rpcclnt
)paren
suffix:semicolon
)brace
)brace
id|kfree
c_func
(paren
id|host
)paren
suffix:semicolon
id|nrhosts
op_decrement
suffix:semicolon
)brace
)brace
id|next_gc
op_assign
id|jiffies
op_plus
id|NLM_HOST_COLLECT
suffix:semicolon
)brace
eof
