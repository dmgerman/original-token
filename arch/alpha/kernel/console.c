multiline_comment|/*&n; *&t;linux/arch/alpha/kernel/console.c&n; *&n; * Architecture-specific specific support for VGA device on &n; * non-0 I/O hose&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/pci.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/tty.h&gt;
macro_line|#include &lt;linux/console.h&gt;
macro_line|#include &lt;asm/vga.h&gt;
macro_line|#include &lt;asm/machvec.h&gt;
macro_line|#ifdef CONFIG_VGA_HOSE
multiline_comment|/*&n; * Externally-visible vga hose bases&n; */
DECL|variable|__vga_hose_io_base
r_int
r_int
id|__vga_hose_io_base
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* base for default hose */
DECL|variable|__vga_hose_mem_base
r_int
r_int
id|__vga_hose_mem_base
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* base for default hose */
r_static
r_struct
id|pci_controler
op_star
id|__init
DECL|function|default_vga_hose_select
id|default_vga_hose_select
c_func
(paren
r_struct
id|pci_controler
op_star
id|h1
comma
r_struct
id|pci_controler
op_star
id|h2
)paren
(brace
r_if
c_cond
(paren
id|h2-&gt;index
OL
id|h1-&gt;index
)paren
r_return
id|h2
suffix:semicolon
r_return
id|h1
suffix:semicolon
)brace
r_void
id|__init
DECL|function|set_vga_hose
id|set_vga_hose
c_func
(paren
r_struct
id|pci_controler
op_star
id|hose
)paren
(brace
r_if
c_cond
(paren
id|hose
)paren
(brace
id|__vga_hose_io_base
op_assign
id|hose-&gt;io_space-&gt;start
suffix:semicolon
id|__vga_hose_mem_base
op_assign
id|hose-&gt;mem_space-&gt;start
suffix:semicolon
)brace
)brace
r_void
id|__init
DECL|function|locate_and_init_vga
id|locate_and_init_vga
c_func
(paren
r_void
op_star
(paren
op_star
id|sel_func
)paren
(paren
r_void
op_star
comma
r_void
op_star
)paren
)paren
(brace
r_struct
id|pci_controler
op_star
id|hose
op_assign
l_int|NULL
suffix:semicolon
r_struct
id|pci_dev
op_star
id|dev
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|sel_func
)paren
id|sel_func
op_assign
(paren
r_void
op_star
)paren
id|default_vga_hose_select
suffix:semicolon
r_for
c_loop
(paren
id|dev
op_assign
l_int|NULL
suffix:semicolon
(paren
id|dev
op_assign
id|pci_find_class
c_func
(paren
id|PCI_CLASS_DISPLAY_VGA
op_lshift
l_int|8
comma
id|dev
)paren
)paren
suffix:semicolon
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|hose
)paren
id|hose
op_assign
id|dev-&gt;sysdata
suffix:semicolon
r_else
id|hose
op_assign
id|sel_func
c_func
(paren
id|hose
comma
id|dev-&gt;sysdata
)paren
suffix:semicolon
)brace
multiline_comment|/* Did we already inititialize the correct one? */
r_if
c_cond
(paren
id|conswitchp
op_eq
op_amp
id|vga_con
op_logical_and
id|__vga_hose_io_base
op_eq
id|hose-&gt;io_space-&gt;start
op_logical_and
id|__vga_hose_mem_base
op_eq
id|hose-&gt;mem_space-&gt;start
)paren
r_return
suffix:semicolon
multiline_comment|/* Set the VGA hose and init the new console */
id|set_vga_hose
c_func
(paren
id|hose
)paren
suffix:semicolon
id|take_over_console
c_func
(paren
op_amp
id|vga_con
comma
l_int|0
comma
id|MAX_NR_CONSOLES
op_minus
l_int|1
comma
l_int|1
)paren
suffix:semicolon
)brace
macro_line|#endif
eof
