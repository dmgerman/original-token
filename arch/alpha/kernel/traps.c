multiline_comment|/*&n; * kernel/traps.c&n; *&n; * (C) Copyright 1994 Linus Torvalds&n; */
multiline_comment|/*&n; * This file initializes the trap entry points&n; */
macro_line|#include &lt;linux/sched.h&gt;
DECL|function|die_if_kernel
r_void
id|die_if_kernel
c_func
(paren
r_char
op_star
id|str
comma
r_struct
id|pt_regs
op_star
id|regs
comma
r_int
id|err
)paren
(brace
r_int
r_int
id|i
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s %ld&bslash;n&quot;
comma
id|str
comma
id|err
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;PC = %016lx PS = %04lx&bslash;n&quot;
comma
id|regs-&gt;pc
comma
id|regs-&gt;ps
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|5000000000
suffix:semicolon
id|i
op_increment
)paren
multiline_comment|/* pause */
suffix:semicolon
id|halt
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|function|do_entArith
id|asmlinkage
r_void
id|do_entArith
c_func
(paren
r_int
r_int
id|summary
comma
r_int
r_int
id|write_mask
comma
r_int
r_int
id|a2
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;Arithmetic trap: %02lx %016lx&bslash;n&quot;
comma
id|summary
comma
id|write_mask
)paren
suffix:semicolon
id|die_if_kernel
c_func
(paren
l_string|&quot;Arithmetic fault&quot;
comma
id|regs
comma
l_int|0
)paren
suffix:semicolon
)brace
DECL|function|do_entIF
id|asmlinkage
r_void
id|do_entIF
c_func
(paren
r_int
r_int
id|type
comma
r_int
r_int
id|a1
comma
r_int
r_int
id|a2
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|die_if_kernel
c_func
(paren
l_string|&quot;Instruction fault&quot;
comma
id|regs
comma
id|type
)paren
suffix:semicolon
)brace
DECL|function|do_entUna
id|asmlinkage
r_void
id|do_entUna
c_func
(paren
r_int
r_int
id|va
comma
r_int
r_int
id|opcode
comma
r_int
r_int
id|reg
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;Unaligned trap: %016lx %ld %ld&bslash;n&quot;
comma
id|va
comma
id|opcode
comma
id|reg
)paren
suffix:semicolon
id|die_if_kernel
c_func
(paren
l_string|&quot;Unaligned&quot;
comma
id|regs
comma
l_int|0
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * DEC means people to use the &quot;retsys&quot; instruction for return from&n; * a system call, but they are clearly misguided about this. We use&n; * &quot;rti&quot; in all cases, and fill in the stack with the return values.&n; * That should make signal handling etc much cleaner.&n; *&n; * Even more horribly, DEC doesn&squot;t allow system calls from kernel mode.&n; * &quot;Security&quot; features letting the user do something the kernel can&squot;t&n; * are a thinko. DEC palcode is strange. The PAL-code designers probably&n; * got terminally tainted by VMS at some point.&n; */
DECL|function|do_entSys
id|asmlinkage
r_void
id|do_entSys
c_func
(paren
r_int
r_int
id|sysnr
comma
r_int
r_int
id|arg1
comma
r_int
r_int
id|arg2
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;System call %ld(%ld,%ld)&bslash;n&quot;
comma
id|sysnr
comma
id|arg1
comma
id|arg2
)paren
suffix:semicolon
id|die_if_kernel
c_func
(paren
l_string|&quot;Syscall&quot;
comma
id|regs
comma
l_int|0
)paren
suffix:semicolon
)brace
r_extern
id|asmlinkage
r_void
id|entMM
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
id|asmlinkage
r_void
id|entIF
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
id|asmlinkage
r_void
id|entArith
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
id|asmlinkage
r_void
id|entUna
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
id|asmlinkage
r_void
id|entSys
c_func
(paren
r_void
)paren
suffix:semicolon
DECL|function|trap_init
r_void
id|trap_init
c_func
(paren
r_void
)paren
(brace
r_int
r_int
id|gptr
suffix:semicolon
multiline_comment|/*&n;&t; * Tell PAL-code what global pointer we want in the kernel..&n;&t; */
id|__asm__
c_func
(paren
l_string|&quot;br %0,___tmp&bslash;n&quot;
l_string|&quot;___tmp:&bslash;tldgp %0,0(%0)&quot;
suffix:colon
l_string|&quot;=r&quot;
(paren
id|gptr
)paren
)paren
suffix:semicolon
id|wrkgp
c_func
(paren
id|gptr
)paren
suffix:semicolon
id|wrent
c_func
(paren
id|entArith
comma
l_int|1
)paren
suffix:semicolon
id|wrent
c_func
(paren
id|entMM
comma
l_int|2
)paren
suffix:semicolon
id|wrent
c_func
(paren
id|entIF
comma
l_int|3
)paren
suffix:semicolon
id|wrent
c_func
(paren
id|entUna
comma
l_int|4
)paren
suffix:semicolon
id|wrent
c_func
(paren
id|entSys
comma
l_int|5
)paren
suffix:semicolon
)brace
eof
