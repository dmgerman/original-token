multiline_comment|/* $Id: r4k_tlb_debug.c,v 1.2 2000/01/17 23:32:46 ralf Exp $&n; *&n; * This file is subject to the terms and conditions of the GNU General Public&n; * License.  See the file &quot;COPYING&quot; in the main directory of this archive&n; * for more details.&n; *&n; * Copyright (C) 1999 Ralf Baechle&n; * Copyright (C) 1999 Silicon Graphics, Inc.&n; *&n; * TLB debugging routines.  These perform horribly slow but can easily be&n; * modified for debugging purposes.&n; */
macro_line|#include &lt;linux/linkage.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;asm/page.h&gt;
macro_line|#include &lt;asm/pgtable.h&gt;
macro_line|#include &lt;asm/ptrace.h&gt;
macro_line|#include &lt;asm/system.h&gt;
id|asmlinkage
r_void
id|do_page_fault
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
comma
r_int
r_int
id|write
comma
r_int
r_int
id|address
)paren
suffix:semicolon
DECL|function|tlb_refill_debug
id|asmlinkage
r_void
id|tlb_refill_debug
c_func
(paren
r_struct
id|pt_regs
id|regs
)paren
(brace
id|show_regs
c_func
(paren
op_amp
id|regs
)paren
suffix:semicolon
id|panic
c_func
(paren
id|__FUNCTION__
l_string|&quot; called.  This Does Not Happen (TM).&quot;
)paren
suffix:semicolon
)brace
DECL|function|xtlb_refill_debug
id|asmlinkage
r_void
id|xtlb_refill_debug
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_int
r_int
id|addr
suffix:semicolon
id|pgd_t
op_star
id|pgd
suffix:semicolon
id|pmd_t
op_star
id|pmd
suffix:semicolon
id|pte_t
op_star
id|pte
suffix:semicolon
id|addr
op_assign
id|regs-&gt;cp0_badvaddr
op_amp
op_complement
(paren
(paren
id|PAGE_SIZE
op_lshift
l_int|1
)paren
op_minus
l_int|1
)paren
suffix:semicolon
id|pgd
op_assign
id|pgd_offset
c_func
(paren
id|current-&gt;active_mm
comma
id|addr
)paren
suffix:semicolon
id|pmd
op_assign
id|pmd_offset
c_func
(paren
id|pgd
comma
id|addr
)paren
suffix:semicolon
id|pte
op_assign
id|pte_offset
c_func
(paren
id|pmd
comma
id|addr
)paren
suffix:semicolon
id|set_entrylo0
c_func
(paren
id|pte_val
c_func
(paren
id|pte
(braket
l_int|0
)braket
)paren
op_rshift
l_int|6
)paren
suffix:semicolon
id|set_entrylo1
c_func
(paren
id|pte_val
c_func
(paren
id|pte
(braket
l_int|1
)braket
)paren
op_rshift
l_int|6
)paren
suffix:semicolon
id|__asm__
id|__volatile__
c_func
(paren
l_string|&quot;nop;nop;nop&quot;
)paren
suffix:semicolon
id|tlb_write_random
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|function|xtlb_mod_debug
id|asmlinkage
r_void
id|xtlb_mod_debug
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_int
r_int
id|addr
suffix:semicolon
id|addr
op_assign
id|regs-&gt;cp0_badvaddr
suffix:semicolon
id|do_page_fault
c_func
(paren
id|regs
comma
l_int|1
comma
id|addr
)paren
suffix:semicolon
)brace
DECL|function|xtlb_tlbl_debug
id|asmlinkage
r_void
id|xtlb_tlbl_debug
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_int
r_int
id|addr
suffix:semicolon
id|addr
op_assign
id|regs-&gt;cp0_badvaddr
suffix:semicolon
id|do_page_fault
c_func
(paren
id|regs
comma
l_int|0
comma
id|addr
)paren
suffix:semicolon
)brace
DECL|function|xtlb_tlbs_debug
id|asmlinkage
r_void
id|xtlb_tlbs_debug
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_int
r_int
id|addr
suffix:semicolon
id|addr
op_assign
id|regs-&gt;cp0_badvaddr
suffix:semicolon
id|do_page_fault
c_func
(paren
id|regs
comma
l_int|1
comma
id|addr
)paren
suffix:semicolon
)brace
eof
