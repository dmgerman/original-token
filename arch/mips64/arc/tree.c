multiline_comment|/* $Id: tree.c,v 1.3 1999/09/27 16:01:37 ralf Exp $&n; *&n; * This file is subject to the terms and conditions of the GNU General Public&n; * License.  See the file &quot;COPYING&quot; in the main directory of this archive&n; * for more details.&n; *&n; * PROM component device tree code.&n; *&n; * Copyright (C) 1996 David S. Miller (dm@engr.sgi.com)&n; * Copyright (C) 1999 Ralf Baechle (ralf@gnu.org)&n; * Copyright (C) 1999 Silicon Graphics, Inc.&n; */
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;asm/arc/types.h&gt;
macro_line|#include &lt;asm/sgialib.h&gt;
DECL|macro|DEBUG_PROM_TREE
macro_line|#undef DEBUG_PROM_TREE
id|pcomponent
op_star
id|__init
DECL|function|ArcGetPeer
id|ArcGetPeer
c_func
(paren
id|pcomponent
op_star
id|Current
)paren
(brace
r_if
c_cond
(paren
id|Current
op_eq
id|PROM_NULL_COMPONENT
)paren
r_return
id|PROM_NULL_COMPONENT
suffix:semicolon
r_return
(paren
id|pcomponent
op_star
)paren
id|ARC_CALL1
c_func
(paren
id|next_component
comma
id|Current
)paren
suffix:semicolon
)brace
id|pcomponent
op_star
id|__init
DECL|function|ArcGetChild
id|ArcGetChild
c_func
(paren
id|pcomponent
op_star
id|Current
)paren
(brace
r_return
(paren
id|pcomponent
op_star
)paren
id|ARC_CALL1
c_func
(paren
id|child_component
comma
id|Current
)paren
suffix:semicolon
)brace
id|pcomponent
op_star
id|__init
DECL|function|ArcGetParent
id|ArcGetParent
c_func
(paren
id|pcomponent
op_star
id|Current
)paren
(brace
r_if
c_cond
(paren
id|Current
op_eq
id|PROM_NULL_COMPONENT
)paren
r_return
id|PROM_NULL_COMPONENT
suffix:semicolon
r_return
(paren
id|pcomponent
op_star
)paren
id|ARC_CALL1
c_func
(paren
id|parent_component
comma
id|Current
)paren
suffix:semicolon
)brace
id|LONG
id|__init
DECL|function|ArcGetConfigurationData
id|ArcGetConfigurationData
c_func
(paren
id|VOID
op_star
id|Buffer
comma
id|pcomponent
op_star
id|Current
)paren
(brace
r_return
id|ARC_CALL2
c_func
(paren
id|component_data
comma
id|Buffer
comma
id|Current
)paren
suffix:semicolon
)brace
id|pcomponent
op_star
id|__init
DECL|function|ArcAddChild
id|ArcAddChild
c_func
(paren
id|pcomponent
op_star
id|Current
comma
id|pcomponent
op_star
id|Template
comma
id|VOID
op_star
id|ConfigurationData
)paren
(brace
r_return
(paren
id|pcomponent
op_star
)paren
id|ARC_CALL3
c_func
(paren
id|child_add
comma
id|Current
comma
id|Template
comma
id|ConfigurationData
)paren
suffix:semicolon
)brace
id|LONG
id|__init
DECL|function|ArcDeleteComponent
id|ArcDeleteComponent
c_func
(paren
id|pcomponent
op_star
id|ComponentToDelete
)paren
(brace
r_return
id|ARC_CALL1
c_func
(paren
id|comp_del
comma
id|ComponentToDelete
)paren
suffix:semicolon
)brace
id|pcomponent
op_star
id|__init
DECL|function|ArcGetComponent
id|ArcGetComponent
c_func
(paren
id|CHAR
op_star
id|Path
)paren
(brace
r_return
(paren
id|pcomponent
op_star
)paren
id|ARC_CALL1
c_func
(paren
id|component_by_path
comma
id|Path
)paren
suffix:semicolon
)brace
macro_line|#ifdef DEBUG_PROM_TREE
DECL|variable|classes
r_static
r_char
op_star
id|classes
(braket
)braket
op_assign
(brace
l_string|&quot;system&quot;
comma
l_string|&quot;processor&quot;
comma
l_string|&quot;cache&quot;
comma
l_string|&quot;adapter&quot;
comma
l_string|&quot;controller&quot;
comma
l_string|&quot;peripheral&quot;
comma
l_string|&quot;memory&quot;
)brace
suffix:semicolon
DECL|variable|types
r_static
r_char
op_star
id|types
(braket
)braket
op_assign
(brace
l_string|&quot;arc&quot;
comma
l_string|&quot;cpu&quot;
comma
l_string|&quot;fpu&quot;
comma
l_string|&quot;picache&quot;
comma
l_string|&quot;pdcache&quot;
comma
l_string|&quot;sicache&quot;
comma
l_string|&quot;sdcache&quot;
comma
l_string|&quot;sccache&quot;
comma
l_string|&quot;memdev&quot;
comma
l_string|&quot;eisa adapter&quot;
comma
l_string|&quot;tc adapter&quot;
comma
l_string|&quot;scsi adapter&quot;
comma
l_string|&quot;dti adapter&quot;
comma
l_string|&quot;multi-func adapter&quot;
comma
l_string|&quot;disk controller&quot;
comma
l_string|&quot;tp controller&quot;
comma
l_string|&quot;cdrom controller&quot;
comma
l_string|&quot;worm controller&quot;
comma
l_string|&quot;serial controller&quot;
comma
l_string|&quot;net controller&quot;
comma
l_string|&quot;display controller&quot;
comma
l_string|&quot;parallel controller&quot;
comma
l_string|&quot;pointer controller&quot;
comma
l_string|&quot;keyboard controller&quot;
comma
l_string|&quot;audio controller&quot;
comma
l_string|&quot;misc controller&quot;
comma
l_string|&quot;disk peripheral&quot;
comma
l_string|&quot;floppy peripheral&quot;
comma
l_string|&quot;tp peripheral&quot;
comma
l_string|&quot;modem peripheral&quot;
comma
l_string|&quot;monitor peripheral&quot;
comma
l_string|&quot;printer peripheral&quot;
comma
l_string|&quot;pointer peripheral&quot;
comma
l_string|&quot;keyboard peripheral&quot;
comma
l_string|&quot;terminal peripheral&quot;
comma
l_string|&quot;line peripheral&quot;
comma
l_string|&quot;net peripheral&quot;
comma
l_string|&quot;misc peripheral&quot;
comma
l_string|&quot;anonymous&quot;
)brace
suffix:semicolon
DECL|variable|iflags
r_static
r_char
op_star
id|iflags
(braket
)braket
op_assign
(brace
l_string|&quot;bogus&quot;
comma
l_string|&quot;read only&quot;
comma
l_string|&quot;removable&quot;
comma
l_string|&quot;console in&quot;
comma
l_string|&quot;console out&quot;
comma
l_string|&quot;input&quot;
comma
l_string|&quot;output&quot;
)brace
suffix:semicolon
r_static
r_void
id|__init
DECL|function|dump_component
id|dump_component
c_func
(paren
id|pcomponent
op_star
id|p
)paren
(brace
id|prom_printf
c_func
(paren
l_string|&quot;[%p]:class&lt;%s&gt;type&lt;%s&gt;flags&lt;%s&gt;ver&lt;%d&gt;rev&lt;%d&gt;&quot;
comma
id|p
comma
id|classes
(braket
id|p
op_member_access_from_pointer
r_class
)braket
comma
id|types
(braket
id|p-&gt;type
)braket
comma
id|iflags
(braket
id|p-&gt;iflags
)braket
comma
id|p-&gt;vers
comma
id|p-&gt;rev
)paren
suffix:semicolon
id|prom_printf
c_func
(paren
l_string|&quot;key&lt;%08lx&gt;&bslash;n&bslash;tamask&lt;%08lx&gt;cdsize&lt;%d&gt;ilen&lt;%d&gt;iname&lt;%s&gt;&bslash;n&quot;
comma
id|p-&gt;key
comma
id|p-&gt;amask
comma
(paren
r_int
)paren
id|p-&gt;cdsize
comma
(paren
r_int
)paren
id|p-&gt;ilen
comma
id|p-&gt;iname
)paren
suffix:semicolon
)brace
r_static
r_void
id|__init
DECL|function|traverse
id|traverse
c_func
(paren
id|pcomponent
op_star
id|p
comma
r_int
id|op
)paren
(brace
id|dump_component
c_func
(paren
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ArcGetChild
c_func
(paren
id|p
)paren
)paren
(brace
id|traverse
c_func
(paren
id|ArcGetChild
c_func
(paren
id|p
)paren
comma
l_int|1
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ArcGetPeer
c_func
(paren
id|p
)paren
op_logical_and
id|op
)paren
(brace
id|traverse
c_func
(paren
id|ArcGetPeer
c_func
(paren
id|p
)paren
comma
l_int|1
)paren
suffix:semicolon
)brace
)brace
r_void
id|__init
DECL|function|prom_testtree
id|prom_testtree
c_func
(paren
r_void
)paren
(brace
id|pcomponent
op_star
id|p
suffix:semicolon
id|p
op_assign
id|ArcGetChild
c_func
(paren
id|PROM_NULL_COMPONENT
)paren
suffix:semicolon
id|dump_component
c_func
(paren
id|p
)paren
suffix:semicolon
id|p
op_assign
id|ArcGetChild
c_func
(paren
id|p
)paren
suffix:semicolon
r_while
c_loop
(paren
id|p
)paren
(brace
id|dump_component
c_func
(paren
id|p
)paren
suffix:semicolon
id|p
op_assign
id|ArcGetPeer
c_func
(paren
id|p
)paren
suffix:semicolon
)brace
id|prom_printf
c_func
(paren
l_string|&quot;press a key&bslash;n&quot;
)paren
suffix:semicolon
id|prom_getchar
c_func
(paren
)paren
suffix:semicolon
)brace
macro_line|#endif /* DEBUG_PROM_TREE  */
eof
