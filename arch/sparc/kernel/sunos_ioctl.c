multiline_comment|/* $Id: sunos_ioctl.c,v 1.18 1996/04/04 12:41:38 davem Exp $&n; * sunos_ioctl.c: The Linux Operating system: SunOS ioctl compatibility.&n; * &n; * Copyright (C) 1995 Miguel de Icaza (miguel@nuclecu.unam.mx)&n; * Copyright (C) 1995 David S. Miller (davem@caip.rutgers.edu)&n; */
macro_line|#include &lt;asm/segment.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/errno.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/termios.h&gt;
macro_line|#include &lt;linux/ioctl.h&gt;
macro_line|#include &lt;linux/route.h&gt;
macro_line|#include &lt;linux/sockios.h&gt;
macro_line|#include &lt;linux/if.h&gt;
macro_line|#include &lt;linux/netdevice.h&gt;
macro_line|#include &lt;linux/if_arp.h&gt;
macro_line|#include &lt;linux/fs.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;asm/kbio.h&gt;
macro_line|#if 0
r_extern
r_char
id|sunkbd_type
suffix:semicolon
r_extern
r_char
id|sunkbd_layout
suffix:semicolon
macro_line|#endif
r_extern
id|asmlinkage
r_int
id|sys_ioctl
c_func
(paren
r_int
r_int
comma
r_int
r_int
comma
r_int
r_int
)paren
suffix:semicolon
r_extern
id|asmlinkage
r_int
id|sys_setsid
c_func
(paren
r_void
)paren
suffix:semicolon
DECL|function|sunos_ioctl
id|asmlinkage
r_int
id|sunos_ioctl
(paren
r_int
id|fd
comma
r_int
r_int
id|cmd
comma
r_int
r_int
id|arg
)paren
(brace
r_struct
id|file
op_star
id|filp
suffix:semicolon
r_int
id|foo
suffix:semicolon
r_if
c_cond
(paren
id|fd
op_ge
id|NR_OPEN
op_logical_or
op_logical_neg
(paren
id|filp
op_assign
id|current-&gt;files-&gt;fd
(braket
id|fd
)braket
)paren
)paren
r_return
op_minus
id|EBADF
suffix:semicolon
multiline_comment|/* First handle an easy compat. case for tty ldisc. */
r_if
c_cond
(paren
id|cmd
op_eq
id|TIOCSETD
)paren
(brace
r_int
op_star
id|p
comma
id|ntty
op_assign
id|N_TTY
comma
id|old_fs
suffix:semicolon
id|p
op_assign
(paren
r_int
op_star
)paren
id|arg
suffix:semicolon
id|foo
op_assign
id|verify_area
c_func
(paren
id|VERIFY_WRITE
comma
id|p
comma
r_sizeof
(paren
r_int
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|foo
)paren
(brace
r_return
id|foo
suffix:semicolon
)brace
r_if
c_cond
(paren
op_star
id|p
op_eq
l_int|2
)paren
(brace
id|old_fs
op_assign
id|get_fs
c_func
(paren
)paren
suffix:semicolon
id|set_fs
c_func
(paren
id|KERNEL_DS
)paren
suffix:semicolon
id|foo
op_assign
id|sys_ioctl
c_func
(paren
id|fd
comma
id|cmd
comma
(paren
r_int
)paren
op_amp
id|ntty
)paren
suffix:semicolon
id|set_fs
c_func
(paren
id|old_fs
)paren
suffix:semicolon
r_return
(paren
id|foo
op_eq
op_minus
id|EINVAL
ques
c_cond
op_minus
id|EOPNOTSUPP
suffix:colon
id|foo
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/* Binary compatability is good American knowhow fuckin&squot; up. */
r_if
c_cond
(paren
id|cmd
op_eq
id|TIOCNOTTY
)paren
(brace
r_return
id|sys_setsid
c_func
(paren
)paren
suffix:semicolon
)brace
multiline_comment|/* SunOS networking ioctls. */
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|_IOW
c_func
(paren
l_char|&squot;r&squot;
comma
l_int|10
comma
r_struct
id|rtentry
)paren
suffix:colon
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|SIOCADDRT
comma
id|arg
)paren
suffix:semicolon
r_case
id|_IOW
c_func
(paren
l_char|&squot;r&squot;
comma
l_int|11
comma
r_struct
id|rtentry
)paren
suffix:colon
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|SIOCDELRT
comma
id|arg
)paren
suffix:semicolon
r_case
id|_IOW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|12
comma
r_struct
id|ifreq
)paren
suffix:colon
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|SIOCSIFADDR
comma
id|arg
)paren
suffix:semicolon
r_case
id|_IORW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|13
comma
r_struct
id|ifreq
)paren
suffix:colon
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|SIOCGIFADDR
comma
id|arg
)paren
suffix:semicolon
r_case
id|_IOW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|14
comma
r_struct
id|ifreq
)paren
suffix:colon
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|SIOCSIFDSTADDR
comma
id|arg
)paren
suffix:semicolon
r_case
id|_IORW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|15
comma
r_struct
id|ifreq
)paren
suffix:colon
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|SIOCGIFDSTADDR
comma
id|arg
)paren
suffix:semicolon
r_case
id|_IOW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|16
comma
r_struct
id|ifreq
)paren
suffix:colon
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|SIOCSIFFLAGS
comma
id|arg
)paren
suffix:semicolon
r_case
id|_IORW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|17
comma
r_struct
id|ifreq
)paren
suffix:colon
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|SIOCGIFFLAGS
comma
id|arg
)paren
suffix:semicolon
r_case
id|_IOW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|18
comma
r_struct
id|ifreq
)paren
suffix:colon
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|SIOCSIFMEM
comma
id|arg
)paren
suffix:semicolon
r_case
id|_IORW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|19
comma
r_struct
id|ifreq
)paren
suffix:colon
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|SIOCGIFMEM
comma
id|arg
)paren
suffix:semicolon
r_case
id|_IORW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|20
comma
r_struct
id|ifconf
)paren
suffix:colon
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|SIOCGIFCONF
comma
id|arg
)paren
suffix:semicolon
r_case
id|_IOW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|21
comma
r_struct
id|ifreq
)paren
suffix:colon
multiline_comment|/* SIOCSIFMTU */
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|SIOCSIFMTU
comma
id|arg
)paren
suffix:semicolon
r_case
id|_IORW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|22
comma
r_struct
id|ifreq
)paren
suffix:colon
multiline_comment|/* SIOCGIFMTU */
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|SIOCGIFMTU
comma
id|arg
)paren
suffix:semicolon
r_case
id|_IORW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|23
comma
r_struct
id|ifreq
)paren
suffix:colon
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|SIOCGIFBRDADDR
comma
id|arg
)paren
suffix:semicolon
r_case
id|_IOW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|24
comma
r_struct
id|ifreq
)paren
suffix:colon
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|SIOCGIFBRDADDR
comma
id|arg
)paren
suffix:semicolon
r_case
id|_IORW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|25
comma
r_struct
id|ifreq
)paren
suffix:colon
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|SIOCGIFNETMASK
comma
id|arg
)paren
suffix:semicolon
r_case
id|_IOW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|26
comma
r_struct
id|ifreq
)paren
suffix:colon
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|SIOCSIFNETMASK
comma
id|arg
)paren
suffix:semicolon
r_case
id|_IORW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|27
comma
r_struct
id|ifreq
)paren
suffix:colon
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|SIOCGIFMETRIC
comma
id|arg
)paren
suffix:semicolon
r_case
id|_IOW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|28
comma
r_struct
id|ifreq
)paren
suffix:colon
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|SIOCSIFMETRIC
comma
id|arg
)paren
suffix:semicolon
r_case
id|_IOW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|30
comma
r_struct
id|arpreq
)paren
suffix:colon
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|SIOCSARP
comma
id|arg
)paren
suffix:semicolon
r_case
id|_IOW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|31
comma
r_struct
id|arpreq
)paren
suffix:colon
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|SIOCGARP
comma
id|arg
)paren
suffix:semicolon
r_case
id|_IOW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|32
comma
r_struct
id|arpreq
)paren
suffix:colon
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|SIOCGARP
comma
id|arg
)paren
suffix:semicolon
r_case
id|_IOW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|40
comma
r_struct
id|ifreq
)paren
suffix:colon
multiline_comment|/* SIOCUPPER */
r_case
id|_IOW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|41
comma
r_struct
id|ifreq
)paren
suffix:colon
multiline_comment|/* SIOCLOWER */
r_case
id|_IOW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|44
comma
r_struct
id|ifreq
)paren
suffix:colon
multiline_comment|/* SIOCSETSYNC */
r_case
id|_IOW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|45
comma
r_struct
id|ifreq
)paren
suffix:colon
multiline_comment|/* SIOCGETSYNC */
r_case
id|_IOW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|46
comma
r_struct
id|ifreq
)paren
suffix:colon
multiline_comment|/* SIOCSSDSTATS */
r_case
id|_IOW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|47
comma
r_struct
id|ifreq
)paren
suffix:colon
multiline_comment|/* SIOCSSESTATS */
r_case
id|_IOW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|48
comma
r_struct
id|ifreq
)paren
suffix:colon
multiline_comment|/* SIOCSPROMISC */
r_return
op_minus
id|EOPNOTSUPP
suffix:semicolon
r_case
id|_IOW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|49
comma
r_struct
id|ifreq
)paren
suffix:colon
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|SIOCADDMULTI
comma
id|arg
)paren
suffix:semicolon
r_case
id|_IOW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|50
comma
r_struct
id|ifreq
)paren
suffix:colon
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|SIOCDELMULTI
comma
id|arg
)paren
suffix:semicolon
multiline_comment|/* FDDI interface ioctls, unsupported. */
r_case
id|_IOW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|51
comma
r_struct
id|ifreq
)paren
suffix:colon
multiline_comment|/* SIOCFDRESET */
r_case
id|_IOW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|52
comma
r_struct
id|ifreq
)paren
suffix:colon
multiline_comment|/* SIOCFDSLEEP */
r_case
id|_IOW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|53
comma
r_struct
id|ifreq
)paren
suffix:colon
multiline_comment|/* SIOCSTRTFMWAR */
r_case
id|_IOW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|54
comma
r_struct
id|ifreq
)paren
suffix:colon
multiline_comment|/* SIOCLDNSTRTFW */
r_case
id|_IOW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|55
comma
r_struct
id|ifreq
)paren
suffix:colon
multiline_comment|/* SIOCGETFDSTAT */
r_case
id|_IOW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|56
comma
r_struct
id|ifreq
)paren
suffix:colon
multiline_comment|/* SIOCFDNMIINT */
r_case
id|_IOW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|57
comma
r_struct
id|ifreq
)paren
suffix:colon
multiline_comment|/* SIOCFDEXUSER */
r_case
id|_IOW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|58
comma
r_struct
id|ifreq
)paren
suffix:colon
multiline_comment|/* SIOCFDGNETMAP */
r_case
id|_IOW
c_func
(paren
l_char|&squot;i&squot;
comma
l_int|59
comma
r_struct
id|ifreq
)paren
suffix:colon
multiline_comment|/* SIOCFDGIOCTL */
id|printk
c_func
(paren
l_string|&quot;FDDI ioctl, returning EOPNOTSUPP&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EOPNOTSUPP
suffix:semicolon
r_case
id|_IOW
c_func
(paren
l_char|&squot;t&squot;
comma
l_int|125
comma
r_int
)paren
suffix:colon
multiline_comment|/* More stupid tty sunos ioctls, just&n;&t;&t; * say it worked.&n;&t;&t; */
r_return
l_int|0
suffix:semicolon
multiline_comment|/* Non posix grp */
r_case
id|_IOR
c_func
(paren
l_char|&squot;t&squot;
comma
l_int|119
comma
r_int
)paren
suffix:colon
r_return
op_minus
id|EIO
suffix:semicolon
)brace
macro_line|#if 0
r_if
c_cond
(paren
id|cmd
op_amp
l_int|0xff00
op_eq
(paren
l_char|&squot;k&squot;
op_lshift
l_int|8
)paren
)paren
(brace
id|printk
(paren
l_string|&quot;[[KBIO: %8.8x&bslash;n&quot;
comma
(paren
r_int
r_int
)paren
id|cmd
)paren
suffix:semicolon
)brace
macro_line|#endif
id|foo
op_assign
id|sys_ioctl
c_func
(paren
id|fd
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
multiline_comment|/* so stupid... */
r_return
(paren
id|foo
op_eq
op_minus
id|EINVAL
ques
c_cond
op_minus
id|EOPNOTSUPP
suffix:colon
id|foo
)paren
suffix:semicolon
)brace
eof
