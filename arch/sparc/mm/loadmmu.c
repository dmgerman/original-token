multiline_comment|/* $Id: loadmmu.c,v 1.42 1996/12/03 08:44:47 jj Exp $&n; * loadmmu.c:  This code loads up all the mm function pointers once the&n; *             machine type has been determined.  It also sets the static&n; *             mmu values such as PAGE_NONE, etc.&n; *&n; * Copyright (C) 1995 David S. Miller (davem@caip.rutgers.edu)&n; */
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;asm/system.h&gt;
macro_line|#include &lt;asm/page.h&gt;
macro_line|#include &lt;asm/pgtable.h&gt;
macro_line|#include &lt;asm/a.out.h&gt;
DECL|variable|page_offset
r_int
r_int
id|page_offset
op_assign
l_int|0xf0000000
suffix:semicolon
DECL|variable|stack_top
r_int
r_int
id|stack_top
op_assign
l_int|0xf0000000
op_minus
id|PAGE_SIZE
suffix:semicolon
DECL|variable|ctx_list_pool
r_struct
id|ctx_list
op_star
id|ctx_list_pool
suffix:semicolon
DECL|variable|ctx_free
r_struct
id|ctx_list
id|ctx_free
suffix:semicolon
DECL|variable|ctx_used
r_struct
id|ctx_list
id|ctx_used
suffix:semicolon
DECL|variable|alloc_kernel_stack
r_int
r_int
(paren
op_star
id|alloc_kernel_stack
)paren
(paren
r_struct
id|task_struct
op_star
id|tsk
)paren
suffix:semicolon
DECL|variable|free_kernel_stack
r_void
(paren
op_star
id|free_kernel_stack
)paren
(paren
r_int
r_int
id|stack
)paren
suffix:semicolon
DECL|variable|alloc_task_struct
r_struct
id|task_struct
op_star
(paren
op_star
id|alloc_task_struct
)paren
(paren
r_void
)paren
suffix:semicolon
DECL|variable|free_task_struct
r_void
(paren
op_star
id|free_task_struct
)paren
(paren
r_struct
id|task_struct
op_star
id|tsk
)paren
suffix:semicolon
DECL|variable|quick_kernel_fault
r_void
(paren
op_star
id|quick_kernel_fault
)paren
(paren
r_int
r_int
)paren
suffix:semicolon
DECL|variable|mmu_exit_hook
r_void
(paren
op_star
id|mmu_exit_hook
)paren
(paren
r_void
)paren
suffix:semicolon
DECL|variable|mmu_flush_hook
r_void
(paren
op_star
id|mmu_flush_hook
)paren
(paren
r_void
)paren
suffix:semicolon
multiline_comment|/* translate between physical and virtual addresses */
DECL|variable|mmu_v2p
r_int
r_int
(paren
op_star
id|mmu_v2p
)paren
(paren
r_int
r_int
)paren
suffix:semicolon
DECL|variable|mmu_p2v
r_int
r_int
(paren
op_star
id|mmu_p2v
)paren
(paren
r_int
r_int
)paren
suffix:semicolon
DECL|variable|mmu_lockarea
r_char
op_star
(paren
op_star
id|mmu_lockarea
)paren
(paren
r_char
op_star
comma
r_int
r_int
)paren
suffix:semicolon
DECL|variable|mmu_unlockarea
r_void
(paren
op_star
id|mmu_unlockarea
)paren
(paren
r_char
op_star
comma
r_int
r_int
)paren
suffix:semicolon
DECL|variable|mmu_get_scsi_one
r_char
op_star
(paren
op_star
id|mmu_get_scsi_one
)paren
(paren
r_char
op_star
comma
r_int
r_int
comma
r_struct
id|linux_sbus
op_star
id|sbus
)paren
suffix:semicolon
DECL|variable|mmu_get_scsi_sgl
r_void
(paren
op_star
id|mmu_get_scsi_sgl
)paren
(paren
r_struct
id|mmu_sglist
op_star
comma
r_int
comma
r_struct
id|linux_sbus
op_star
id|sbus
)paren
suffix:semicolon
DECL|variable|mmu_release_scsi_one
r_void
(paren
op_star
id|mmu_release_scsi_one
)paren
(paren
r_char
op_star
comma
r_int
r_int
comma
r_struct
id|linux_sbus
op_star
id|sbus
)paren
suffix:semicolon
DECL|variable|mmu_release_scsi_sgl
r_void
(paren
op_star
id|mmu_release_scsi_sgl
)paren
(paren
r_struct
id|mmu_sglist
op_star
comma
r_int
comma
r_struct
id|linux_sbus
op_star
id|sbus
)paren
suffix:semicolon
DECL|variable|mmu_map_dma_area
r_void
(paren
op_star
id|mmu_map_dma_area
)paren
(paren
r_int
r_int
id|addr
comma
r_int
id|len
)paren
suffix:semicolon
DECL|variable|update_mmu_cache
r_void
(paren
op_star
id|update_mmu_cache
)paren
(paren
r_struct
id|vm_area_struct
op_star
id|vma
comma
r_int
r_int
id|address
comma
id|pte_t
id|pte
)paren
suffix:semicolon
macro_line|#ifdef __SMP__
DECL|variable|local_flush_cache_all
r_void
(paren
op_star
id|local_flush_cache_all
)paren
(paren
r_void
)paren
suffix:semicolon
DECL|variable|local_flush_cache_mm
r_void
(paren
op_star
id|local_flush_cache_mm
)paren
(paren
r_struct
id|mm_struct
op_star
)paren
suffix:semicolon
DECL|variable|local_flush_cache_range
r_void
(paren
op_star
id|local_flush_cache_range
)paren
(paren
r_struct
id|mm_struct
op_star
comma
r_int
r_int
id|start
comma
r_int
r_int
id|end
)paren
suffix:semicolon
DECL|variable|local_flush_cache_page
r_void
(paren
op_star
id|local_flush_cache_page
)paren
(paren
r_struct
id|vm_area_struct
op_star
comma
r_int
r_int
id|address
)paren
suffix:semicolon
DECL|variable|local_flush_tlb_all
r_void
(paren
op_star
id|local_flush_tlb_all
)paren
(paren
r_void
)paren
suffix:semicolon
DECL|variable|local_flush_tlb_mm
r_void
(paren
op_star
id|local_flush_tlb_mm
)paren
(paren
r_struct
id|mm_struct
op_star
)paren
suffix:semicolon
DECL|variable|local_flush_tlb_range
r_void
(paren
op_star
id|local_flush_tlb_range
)paren
(paren
r_struct
id|mm_struct
op_star
comma
r_int
r_int
id|start
comma
r_int
r_int
id|end
)paren
suffix:semicolon
DECL|variable|local_flush_tlb_page
r_void
(paren
op_star
id|local_flush_tlb_page
)paren
(paren
r_struct
id|vm_area_struct
op_star
comma
r_int
r_int
id|address
)paren
suffix:semicolon
DECL|variable|local_flush_page_to_ram
r_void
(paren
op_star
id|local_flush_page_to_ram
)paren
(paren
r_int
r_int
id|address
)paren
suffix:semicolon
DECL|variable|local_flush_sig_insns
r_void
(paren
op_star
id|local_flush_sig_insns
)paren
(paren
r_struct
id|mm_struct
op_star
id|mm
comma
r_int
r_int
id|insn_addr
)paren
suffix:semicolon
macro_line|#endif
DECL|variable|flush_cache_all
r_void
(paren
op_star
id|flush_cache_all
)paren
(paren
r_void
)paren
suffix:semicolon
DECL|variable|flush_cache_mm
r_void
(paren
op_star
id|flush_cache_mm
)paren
(paren
r_struct
id|mm_struct
op_star
)paren
suffix:semicolon
DECL|variable|flush_cache_range
r_void
(paren
op_star
id|flush_cache_range
)paren
(paren
r_struct
id|mm_struct
op_star
comma
r_int
r_int
id|start
comma
r_int
r_int
id|end
)paren
suffix:semicolon
DECL|variable|flush_cache_page
r_void
(paren
op_star
id|flush_cache_page
)paren
(paren
r_struct
id|vm_area_struct
op_star
comma
r_int
r_int
id|address
)paren
suffix:semicolon
DECL|variable|flush_tlb_all
r_void
(paren
op_star
id|flush_tlb_all
)paren
(paren
r_void
)paren
suffix:semicolon
DECL|variable|flush_tlb_mm
r_void
(paren
op_star
id|flush_tlb_mm
)paren
(paren
r_struct
id|mm_struct
op_star
)paren
suffix:semicolon
DECL|variable|flush_tlb_range
r_void
(paren
op_star
id|flush_tlb_range
)paren
(paren
r_struct
id|mm_struct
op_star
comma
r_int
r_int
id|start
comma
r_int
r_int
id|end
)paren
suffix:semicolon
DECL|variable|flush_tlb_page
r_void
(paren
op_star
id|flush_tlb_page
)paren
(paren
r_struct
id|vm_area_struct
op_star
comma
r_int
r_int
id|address
)paren
suffix:semicolon
DECL|variable|flush_page_to_ram
r_void
(paren
op_star
id|flush_page_to_ram
)paren
(paren
r_int
r_int
id|page
)paren
suffix:semicolon
DECL|variable|flush_sig_insns
r_void
(paren
op_star
id|flush_sig_insns
)paren
(paren
r_struct
id|mm_struct
op_star
id|mm
comma
r_int
r_int
id|insn_addr
)paren
suffix:semicolon
DECL|variable|set_pte
r_void
(paren
op_star
id|set_pte
)paren
(paren
id|pte_t
op_star
id|pteptr
comma
id|pte_t
id|pteval
)paren
suffix:semicolon
DECL|variable|pmd_shift
DECL|variable|pmd_size
DECL|variable|pmd_mask
r_int
r_int
id|pmd_shift
comma
id|pmd_size
comma
id|pmd_mask
suffix:semicolon
DECL|variable|pmd_align
r_int
r_int
(paren
op_star
id|pmd_align
)paren
(paren
r_int
r_int
)paren
suffix:semicolon
DECL|variable|pgdir_shift
DECL|variable|pgdir_size
DECL|variable|pgdir_mask
r_int
r_int
id|pgdir_shift
comma
id|pgdir_size
comma
id|pgdir_mask
suffix:semicolon
DECL|variable|pgdir_align
r_int
r_int
(paren
op_star
id|pgdir_align
)paren
(paren
r_int
r_int
)paren
suffix:semicolon
DECL|variable|ptrs_per_pte
DECL|variable|ptrs_per_pmd
DECL|variable|ptrs_per_pgd
r_int
r_int
id|ptrs_per_pte
comma
id|ptrs_per_pmd
comma
id|ptrs_per_pgd
suffix:semicolon
DECL|variable|pg_iobits
r_int
r_int
id|pg_iobits
suffix:semicolon
DECL|variable|page_none
DECL|variable|page_shared
DECL|variable|page_copy
DECL|variable|page_readonly
DECL|variable|page_kernel
id|pgprot_t
id|page_none
comma
id|page_shared
comma
id|page_copy
comma
id|page_readonly
comma
id|page_kernel
suffix:semicolon
DECL|variable|pte_page
r_int
r_int
(paren
op_star
id|pte_page
)paren
(paren
id|pte_t
)paren
suffix:semicolon
DECL|variable|pmd_page
r_int
r_int
(paren
op_star
id|pmd_page
)paren
(paren
id|pmd_t
)paren
suffix:semicolon
DECL|variable|pgd_page
r_int
r_int
(paren
op_star
id|pgd_page
)paren
(paren
id|pgd_t
)paren
suffix:semicolon
DECL|variable|sparc_update_rootmmu_dir
r_void
(paren
op_star
id|sparc_update_rootmmu_dir
)paren
(paren
r_struct
id|task_struct
op_star
comma
id|pgd_t
op_star
id|pgdir
)paren
suffix:semicolon
DECL|variable|vmalloc_start
r_int
r_int
(paren
op_star
(paren
id|vmalloc_start
)paren
)paren
(paren
r_void
)paren
suffix:semicolon
DECL|variable|switch_to_context
r_void
(paren
op_star
id|switch_to_context
)paren
(paren
r_struct
id|task_struct
op_star
id|tsk
)paren
suffix:semicolon
DECL|variable|pte_none
r_int
(paren
op_star
id|pte_none
)paren
(paren
id|pte_t
)paren
suffix:semicolon
DECL|variable|pte_present
r_int
(paren
op_star
id|pte_present
)paren
(paren
id|pte_t
)paren
suffix:semicolon
DECL|variable|pte_clear
r_void
(paren
op_star
id|pte_clear
)paren
(paren
id|pte_t
op_star
)paren
suffix:semicolon
DECL|variable|pmd_none
r_int
(paren
op_star
id|pmd_none
)paren
(paren
id|pmd_t
)paren
suffix:semicolon
DECL|variable|pmd_bad
r_int
(paren
op_star
id|pmd_bad
)paren
(paren
id|pmd_t
)paren
suffix:semicolon
DECL|variable|pmd_present
r_int
(paren
op_star
id|pmd_present
)paren
(paren
id|pmd_t
)paren
suffix:semicolon
DECL|variable|pmd_clear
r_void
(paren
op_star
id|pmd_clear
)paren
(paren
id|pmd_t
op_star
)paren
suffix:semicolon
DECL|variable|pgd_none
r_int
(paren
op_star
id|pgd_none
)paren
(paren
id|pgd_t
)paren
suffix:semicolon
DECL|variable|pgd_bad
r_int
(paren
op_star
id|pgd_bad
)paren
(paren
id|pgd_t
)paren
suffix:semicolon
DECL|variable|pgd_present
r_int
(paren
op_star
id|pgd_present
)paren
(paren
id|pgd_t
)paren
suffix:semicolon
DECL|variable|pgd_clear
r_void
(paren
op_star
id|pgd_clear
)paren
(paren
id|pgd_t
op_star
)paren
suffix:semicolon
DECL|variable|mk_pte
id|pte_t
(paren
op_star
id|mk_pte
)paren
(paren
r_int
r_int
comma
id|pgprot_t
)paren
suffix:semicolon
DECL|variable|mk_pte_phys
id|pte_t
(paren
op_star
id|mk_pte_phys
)paren
(paren
r_int
r_int
comma
id|pgprot_t
)paren
suffix:semicolon
DECL|variable|mk_pte_io
id|pte_t
(paren
op_star
id|mk_pte_io
)paren
(paren
r_int
r_int
comma
id|pgprot_t
comma
r_int
)paren
suffix:semicolon
DECL|variable|pgd_set
r_void
(paren
op_star
id|pgd_set
)paren
(paren
id|pgd_t
op_star
comma
id|pmd_t
op_star
)paren
suffix:semicolon
DECL|variable|pte_modify
id|pte_t
(paren
op_star
id|pte_modify
)paren
(paren
id|pte_t
comma
id|pgprot_t
)paren
suffix:semicolon
DECL|variable|pgd_offset
id|pgd_t
op_star
(paren
op_star
id|pgd_offset
)paren
(paren
r_struct
id|mm_struct
op_star
comma
r_int
r_int
)paren
suffix:semicolon
DECL|variable|pmd_offset
id|pmd_t
op_star
(paren
op_star
id|pmd_offset
)paren
(paren
id|pgd_t
op_star
comma
r_int
r_int
)paren
suffix:semicolon
DECL|variable|pte_offset
id|pte_t
op_star
(paren
op_star
id|pte_offset
)paren
(paren
id|pmd_t
op_star
comma
r_int
r_int
)paren
suffix:semicolon
DECL|variable|pte_free_kernel
r_void
(paren
op_star
id|pte_free_kernel
)paren
(paren
id|pte_t
op_star
)paren
suffix:semicolon
DECL|variable|pte_alloc_kernel
id|pte_t
op_star
(paren
op_star
id|pte_alloc_kernel
)paren
(paren
id|pmd_t
op_star
comma
r_int
r_int
)paren
suffix:semicolon
DECL|variable|pmd_free_kernel
r_void
(paren
op_star
id|pmd_free_kernel
)paren
(paren
id|pmd_t
op_star
)paren
suffix:semicolon
DECL|variable|pmd_alloc_kernel
id|pmd_t
op_star
(paren
op_star
id|pmd_alloc_kernel
)paren
(paren
id|pgd_t
op_star
comma
r_int
r_int
)paren
suffix:semicolon
DECL|variable|pte_free
r_void
(paren
op_star
id|pte_free
)paren
(paren
id|pte_t
op_star
)paren
suffix:semicolon
DECL|variable|pte_alloc
id|pte_t
op_star
(paren
op_star
id|pte_alloc
)paren
(paren
id|pmd_t
op_star
comma
r_int
r_int
)paren
suffix:semicolon
DECL|variable|pmd_free
r_void
(paren
op_star
id|pmd_free
)paren
(paren
id|pmd_t
op_star
)paren
suffix:semicolon
DECL|variable|pmd_alloc
id|pmd_t
op_star
(paren
op_star
id|pmd_alloc
)paren
(paren
id|pgd_t
op_star
comma
r_int
r_int
)paren
suffix:semicolon
DECL|variable|pgd_free
r_void
(paren
op_star
id|pgd_free
)paren
(paren
id|pgd_t
op_star
)paren
suffix:semicolon
DECL|variable|pgd_alloc
id|pgd_t
op_star
(paren
op_star
id|pgd_alloc
)paren
(paren
r_void
)paren
suffix:semicolon
DECL|variable|pgd_flush
r_void
(paren
op_star
id|pgd_flush
)paren
(paren
id|pgd_t
op_star
)paren
suffix:semicolon
DECL|variable|pte_write
r_int
(paren
op_star
id|pte_write
)paren
(paren
id|pte_t
)paren
suffix:semicolon
DECL|variable|pte_dirty
r_int
(paren
op_star
id|pte_dirty
)paren
(paren
id|pte_t
)paren
suffix:semicolon
DECL|variable|pte_young
r_int
(paren
op_star
id|pte_young
)paren
(paren
id|pte_t
)paren
suffix:semicolon
DECL|variable|pte_wrprotect
id|pte_t
(paren
op_star
id|pte_wrprotect
)paren
(paren
id|pte_t
)paren
suffix:semicolon
DECL|variable|pte_mkclean
id|pte_t
(paren
op_star
id|pte_mkclean
)paren
(paren
id|pte_t
)paren
suffix:semicolon
DECL|variable|pte_mkold
id|pte_t
(paren
op_star
id|pte_mkold
)paren
(paren
id|pte_t
)paren
suffix:semicolon
DECL|variable|pte_mkwrite
id|pte_t
(paren
op_star
id|pte_mkwrite
)paren
(paren
id|pte_t
)paren
suffix:semicolon
DECL|variable|pte_mkdirty
id|pte_t
(paren
op_star
id|pte_mkdirty
)paren
(paren
id|pte_t
)paren
suffix:semicolon
DECL|variable|pte_mkyoung
id|pte_t
(paren
op_star
id|pte_mkyoung
)paren
(paren
id|pte_t
)paren
suffix:semicolon
DECL|variable|mmu_info
r_char
op_star
(paren
op_star
id|mmu_info
)paren
(paren
r_void
)paren
suffix:semicolon
r_extern
r_void
id|ld_mmu_sun4c
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_void
id|ld_mmu_srmmu
c_func
(paren
r_void
)paren
suffix:semicolon
DECL|function|__initfunc
id|__initfunc
c_func
(paren
r_void
id|load_mmu
c_func
(paren
r_void
)paren
)paren
(brace
r_switch
c_cond
(paren
id|sparc_cpu_model
)paren
(brace
r_case
id|sun4c
suffix:colon
id|ld_mmu_sun4c
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|sun4m
suffix:colon
r_case
id|sun4d
suffix:colon
id|ld_mmu_srmmu
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|printk
c_func
(paren
l_string|&quot;load_mmu:MMU support not available for this architecture&bslash;n&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;load_mmu:sparc_cpu_model = %d&bslash;n&quot;
comma
(paren
r_int
)paren
id|sparc_cpu_model
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;load_mmu:Halting...&bslash;n&quot;
)paren
suffix:semicolon
id|panic
c_func
(paren
l_string|&quot;load_mmu()&quot;
)paren
suffix:semicolon
)brace
)brace
eof
