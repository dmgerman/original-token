macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/apm_bios.h&gt;
macro_line|#include &lt;asm/io.h&gt;
DECL|struct|dmi_header
r_struct
id|dmi_header
(brace
DECL|member|type
id|u8
id|type
suffix:semicolon
DECL|member|length
id|u8
id|length
suffix:semicolon
DECL|member|handle
id|u16
id|handle
suffix:semicolon
)brace
suffix:semicolon
DECL|function|dmi_string
r_static
r_char
op_star
id|__init
id|dmi_string
c_func
(paren
r_struct
id|dmi_header
op_star
id|dm
comma
id|u8
id|s
)paren
(brace
id|u8
op_star
id|bp
op_assign
(paren
id|u8
op_star
)paren
id|dm
suffix:semicolon
id|bp
op_add_assign
id|dm-&gt;length
suffix:semicolon
id|s
op_decrement
suffix:semicolon
r_while
c_loop
(paren
id|s
OG
l_int|0
)paren
(brace
id|bp
op_add_assign
id|strlen
c_func
(paren
id|bp
)paren
suffix:semicolon
id|bp
op_increment
suffix:semicolon
id|s
op_decrement
suffix:semicolon
)brace
r_return
id|bp
suffix:semicolon
)brace
DECL|function|dmi_table
r_static
r_int
id|__init
id|dmi_table
c_func
(paren
id|u32
id|base
comma
r_int
id|len
comma
r_int
id|num
comma
r_void
(paren
op_star
id|decode
)paren
(paren
r_struct
id|dmi_header
op_star
)paren
)paren
(brace
id|u8
op_star
id|buf
suffix:semicolon
r_struct
id|dmi_header
op_star
id|dm
suffix:semicolon
id|u8
op_star
id|data
suffix:semicolon
r_int
id|i
op_assign
l_int|1
suffix:semicolon
r_int
id|last
op_assign
l_int|0
suffix:semicolon
id|buf
op_assign
id|ioremap
c_func
(paren
id|base
comma
id|len
)paren
suffix:semicolon
r_if
c_cond
(paren
id|buf
op_eq
l_int|NULL
)paren
(brace
r_return
op_minus
l_int|1
suffix:semicolon
)brace
id|data
op_assign
id|buf
suffix:semicolon
r_while
c_loop
(paren
id|i
OL
id|num
op_logical_and
(paren
id|data
op_minus
id|buf
)paren
OL
id|len
)paren
(brace
id|dm
op_assign
(paren
r_struct
id|dmi_header
op_star
)paren
id|data
suffix:semicolon
r_if
c_cond
(paren
id|dm-&gt;type
OL
id|last
)paren
(brace
r_break
suffix:semicolon
)brace
id|last
op_assign
id|dm-&gt;type
suffix:semicolon
id|decode
c_func
(paren
id|dm
)paren
suffix:semicolon
id|data
op_add_assign
id|dm-&gt;length
suffix:semicolon
r_while
c_loop
(paren
op_star
id|data
op_logical_or
id|data
(braket
l_int|1
)braket
)paren
(brace
id|data
op_increment
suffix:semicolon
)brace
id|data
op_add_assign
l_int|2
suffix:semicolon
id|i
op_increment
suffix:semicolon
)brace
id|iounmap
c_func
(paren
id|buf
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dmi_iterate
r_int
id|__init
id|dmi_iterate
c_func
(paren
r_void
(paren
op_star
id|decode
)paren
(paren
r_struct
id|dmi_header
op_star
)paren
)paren
(brace
r_int
r_char
id|buf
(braket
l_int|20
)braket
suffix:semicolon
r_int
id|fp
op_assign
l_int|0xE0000L
suffix:semicolon
id|fp
op_sub_assign
l_int|16
suffix:semicolon
r_while
c_loop
(paren
id|fp
OL
l_int|0xFFFFF
)paren
(brace
id|fp
op_add_assign
l_int|16
suffix:semicolon
id|isa_memcpy_fromio
c_func
(paren
id|buf
comma
id|fp
comma
l_int|20
)paren
suffix:semicolon
r_if
c_cond
(paren
id|memcmp
c_func
(paren
id|buf
comma
l_string|&quot;_DMI_&quot;
comma
l_int|5
)paren
op_eq
l_int|0
)paren
(brace
id|u16
id|num
op_assign
id|buf
(braket
l_int|13
)braket
op_lshift
l_int|8
op_or
id|buf
(braket
l_int|12
)braket
suffix:semicolon
id|u16
id|len
op_assign
id|buf
(braket
l_int|7
)braket
op_lshift
l_int|8
op_or
id|buf
(braket
l_int|6
)braket
suffix:semicolon
id|u32
id|base
op_assign
id|buf
(braket
l_int|11
)braket
op_lshift
l_int|24
op_or
id|buf
(braket
l_int|10
)braket
op_lshift
l_int|16
op_or
id|buf
(braket
l_int|9
)braket
op_lshift
l_int|8
op_or
id|buf
(braket
l_int|8
)braket
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;DMI %d.%d present.&bslash;n&quot;
comma
id|buf
(braket
l_int|14
)braket
op_rshift
l_int|4
comma
id|buf
(braket
l_int|14
)braket
op_amp
l_int|0x0F
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;%d structures occupying %d bytes.&bslash;n&quot;
comma
id|buf
(braket
l_int|13
)braket
op_lshift
l_int|8
op_or
id|buf
(braket
l_int|12
)braket
comma
id|buf
(braket
l_int|7
)braket
op_lshift
l_int|8
op_or
id|buf
(braket
l_int|6
)braket
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;DMI table at 0x%08X.&bslash;n&quot;
comma
id|buf
(braket
l_int|11
)braket
op_lshift
l_int|24
op_or
id|buf
(braket
l_int|10
)braket
op_lshift
l_int|16
op_or
id|buf
(braket
l_int|9
)braket
op_lshift
l_int|8
op_or
id|buf
(braket
l_int|8
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dmi_table
c_func
(paren
id|base
comma
id|len
comma
id|num
comma
id|decode
)paren
op_eq
l_int|0
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
)brace
)brace
r_return
op_minus
l_int|1
suffix:semicolon
)brace
multiline_comment|/*&n; *&t;Process a DMI table entry. Right now all we care about are the BIOS&n; *&t;and machine entries. For 2.4 we should pull the smbus controller info&n; *&t;out of here.&n; */
DECL|function|dmi_decode
r_static
r_void
id|__init
id|dmi_decode
c_func
(paren
r_struct
id|dmi_header
op_star
id|dm
)paren
(brace
id|u8
op_star
id|data
op_assign
(paren
id|u8
op_star
)paren
id|dm
suffix:semicolon
r_char
op_star
id|p
suffix:semicolon
r_switch
c_cond
(paren
id|dm-&gt;type
)paren
(brace
r_case
l_int|0
suffix:colon
id|p
op_assign
id|dmi_string
c_func
(paren
id|dm
comma
id|data
(braket
l_int|4
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
op_logical_and
op_star
id|p
op_ne
l_char|&squot; &squot;
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;BIOS Vendor: %s&bslash;n&quot;
comma
id|p
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;BIOS Version: %s&bslash;n&quot;
comma
id|dmi_string
c_func
(paren
id|dm
comma
id|data
(braket
l_int|5
)braket
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;BIOS Release: %s&bslash;n&quot;
comma
id|dmi_string
c_func
(paren
id|dm
comma
id|data
(braket
l_int|8
)braket
)paren
)paren
suffix:semicolon
)brace
multiline_comment|/*&n;&t;&t;&t; *  Check for clue free BIOS implementations who use&n;&t;&t;&t; *  the following QA technique&n;&t;&t;&t; *&n;&t;&t;&t; *      [ Write BIOS Code ]&lt;------&n;&t;&t;&t; *               |                ^&n;&t;&t;&t; *      &lt; Does it Compile &gt;----N--&n;&t;&t;&t; *               |Y               ^&n;&t;&t;&t; *&t;&lt; Does it Boot Win98 &gt;-N--&n;&t;&t;&t; *               |Y&n;&t;&t;&t; *           [Ship It]&n;&t;&t;&t; *&n;&t;&t;&t; *&t;Phoenix A04  08/24/2000 is known bad (Dell Inspiron 5000e)&n;&t;&t;&t; *&t;Phoenix A07  09/29/2000 is known good (Dell Inspiron 5000)&n;&t;&t;&t; */
r_if
c_cond
(paren
id|strcmp
c_func
(paren
id|dmi_string
c_func
(paren
id|dm
comma
id|data
(braket
l_int|4
)braket
)paren
comma
l_string|&quot;Phoenix Technologies LTD&quot;
)paren
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|strcmp
c_func
(paren
id|dmi_string
c_func
(paren
id|dm
comma
id|data
(braket
l_int|5
)braket
)paren
comma
l_string|&quot;A04&quot;
)paren
op_eq
l_int|0
op_logical_and
id|strcmp
c_func
(paren
id|dmi_string
c_func
(paren
id|dm
comma
id|data
(braket
l_int|8
)braket
)paren
comma
l_string|&quot;08/24/2000&quot;
)paren
op_eq
l_int|0
)paren
(brace
id|apm_info.get_power_status_broken
op_assign
l_int|1
suffix:semicolon
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;BIOS strings suggest APM bugs, disabling power status reporting.&bslash;n&quot;
)paren
suffix:semicolon
)brace
)brace
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|p
op_assign
id|dmi_string
c_func
(paren
id|dm
comma
id|data
(braket
l_int|4
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
op_logical_and
op_star
id|p
op_ne
l_char|&squot; &squot;
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;System Vendor: %s.&bslash;n&quot;
comma
id|p
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;Product Name: %s.&bslash;n&quot;
comma
id|dmi_string
c_func
(paren
id|dm
comma
id|data
(braket
l_int|5
)braket
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;Version %s.&bslash;n&quot;
comma
id|dmi_string
c_func
(paren
id|dm
comma
id|data
(braket
l_int|6
)braket
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;Serial Number %s.&bslash;n&quot;
comma
id|dmi_string
c_func
(paren
id|dm
comma
id|data
(braket
l_int|7
)braket
)paren
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|p
op_assign
id|dmi_string
c_func
(paren
id|dm
comma
id|data
(braket
l_int|4
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
op_logical_and
op_star
id|p
op_ne
l_char|&squot; &squot;
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;Board Vendor: %s.&bslash;n&quot;
comma
id|p
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;Board Name: %s.&bslash;n&quot;
comma
id|dmi_string
c_func
(paren
id|dm
comma
id|data
(braket
l_int|5
)braket
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;Board Version: %s.&bslash;n&quot;
comma
id|dmi_string
c_func
(paren
id|dm
comma
id|data
(braket
l_int|6
)braket
)paren
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|p
op_assign
id|dmi_string
c_func
(paren
id|dm
comma
id|data
(braket
l_int|8
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
op_logical_and
op_star
id|p
op_ne
l_char|&squot; &squot;
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;Asset Tag: %s.&bslash;n&quot;
comma
id|p
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
)brace
)brace
DECL|function|dmi_scan_machine
r_static
r_int
id|__init
id|dmi_scan_machine
c_func
(paren
r_void
)paren
(brace
r_return
id|dmi_iterate
c_func
(paren
id|dmi_decode
)paren
suffix:semicolon
)brace
DECL|variable|dmi_scan_machine
id|module_init
c_func
(paren
id|dmi_scan_machine
)paren
suffix:semicolon
eof
