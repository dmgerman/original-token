multiline_comment|/*&n; * arch/arm/mm/mm-sa1100.c&n; *&n; * Extra MM routines for the SA1100 architecture&n; *&n; * Copyright (C) 1998-1999 Russell King&n; * Copyright (C) 1999 Hugo Fiennes&n; *&n; * 1999/12/04 Nicolas Pitre &lt;nico@cam.org&gt;&n; *&t;Converted memory definition for struct meminfo initialisations.&n; *&t;Memory is listed physically now.&n; *&n; * 2000/04/07 Nicolas Pitre &lt;nico@cam.org&gt;&n; *&t;Reworked for real-time selection of memory definitions&n; *&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;asm/pgtable.h&gt;
macro_line|#include &lt;asm/page.h&gt;
macro_line|#include &quot;map.h&quot;
DECL|macro|SIZE
mdefine_line|#define SIZE(x) (sizeof(x) / sizeof(x[0]))
DECL|macro|SA1100_STD_IO_MAPPING
mdefine_line|#define SA1100_STD_IO_MAPPING &bslash;&n; /* virtual     physical    length      domain     r  w  c  b */ &bslash;&n;  { 0xe0000000, 0x20000000, 0x04000000, DOMAIN_IO, 1, 1, 0, 0 }, /* PCMCIA0 IO */ &bslash;&n;  { 0xe4000000, 0x30000000, 0x04000000, DOMAIN_IO, 1, 1, 0, 0 }, /* PCMCIA1 IO */ &bslash;&n;  { 0xe8000000, 0x28000000, 0x04000000, DOMAIN_IO, 1, 1, 0, 0 }, /* PCMCIA0 attr */ &bslash;&n;  { 0xec000000, 0x38000000, 0x04000000, DOMAIN_IO, 1, 1, 0, 0 }, /* PCMCIA1 attr */ &bslash;&n;  { 0xf0000000, 0x2c000000, 0x04000000, DOMAIN_IO, 1, 1, 0, 0 }, /* PCMCIA0 mem */ &bslash;&n;  { 0xf4000000, 0x3c000000, 0x04000000, DOMAIN_IO, 1, 1, 0, 0 }, /* PCMCIA1 mem */ &bslash;&n;  { 0xf8000000, 0x80000000, 0x02000000, DOMAIN_IO, 0, 1, 0, 0 }, /* PCM */ &bslash;&n;  { 0xfa000000, 0x90000000, 0x02000000, DOMAIN_IO, 0, 1, 0, 0 }, /* SCM */ &bslash;&n;  { 0xfc000000, 0xa0000000, 0x02000000, DOMAIN_IO, 0, 1, 0, 0 }, /* MER */ &bslash;&n;  { 0xfe000000, 0xb0000000, 0x02000000, DOMAIN_IO, 0, 1, 0, 0 }  /* LCD + DMA */
DECL|variable|__initdata
r_static
r_struct
id|map_desc
id|assabet_io_desc
(braket
)braket
id|__initdata
op_assign
(brace
macro_line|#ifdef CONFIG_SA1100_ASSABET
(brace
l_int|0xd0000000
comma
l_int|0x00000000
comma
l_int|0x02000000
comma
id|DOMAIN_IO
comma
l_int|1
comma
l_int|1
comma
l_int|0
comma
l_int|0
)brace
comma
multiline_comment|/* Flash bank 0 */
(brace
l_int|0xdc000000
comma
l_int|0x12000000
comma
l_int|0x00100000
comma
id|DOMAIN_IO
comma
l_int|1
comma
l_int|1
comma
l_int|0
comma
l_int|0
)brace
comma
multiline_comment|/* Board Control Register */
id|SA1100_STD_IO_MAPPING
macro_line|#endif
)brace
suffix:semicolon
DECL|variable|__initdata
r_static
r_struct
id|map_desc
id|bitsy_io_desc
(braket
)braket
id|__initdata
op_assign
(brace
macro_line|#ifdef CONFIG_SA1100_BITSY
(brace
l_int|0xd0000000
comma
l_int|0x00000000
comma
l_int|0x02000000
comma
id|DOMAIN_IO
comma
l_int|1
comma
l_int|1
comma
l_int|0
comma
l_int|0
)brace
comma
multiline_comment|/* Flash bank 0 */
id|SA1100_STD_IO_MAPPING
macro_line|#endif
)brace
suffix:semicolon
DECL|variable|__initdata
r_static
r_struct
id|map_desc
id|empeg_io_desc
(braket
)braket
id|__initdata
op_assign
(brace
macro_line|#ifdef CONFIG_SA1100_EMPEG
(brace
id|EMPEG_FLASHBASE
comma
l_int|0x00000000
comma
l_int|0x00200000
comma
id|DOMAIN_IO
comma
l_int|1
comma
l_int|1
comma
l_int|0
comma
l_int|0
)brace
comma
multiline_comment|/* Flash */
id|SA1100_STD_IO_MAPPING
macro_line|#endif
)brace
suffix:semicolon
DECL|variable|__initdata
r_static
r_struct
id|map_desc
id|graphicsclient_io_desc
(braket
)braket
id|__initdata
op_assign
(brace
macro_line|#ifdef CONFIG_SA1100_GRAPHICSCLIENT
(brace
l_int|0xd0000000
comma
l_int|0x08000000
comma
l_int|0x00800000
comma
id|DOMAIN_IO
comma
l_int|1
comma
l_int|1
comma
l_int|0
comma
l_int|0
)brace
comma
multiline_comment|/* Flash bank 1 */
(brace
l_int|0xd0800000
comma
l_int|0x18000000
comma
l_int|0x00800000
comma
id|DOMAIN_IO
comma
l_int|1
comma
l_int|1
comma
l_int|0
comma
l_int|0
)brace
comma
multiline_comment|/* Flash bank 3 */
(brace
l_int|0xdc000000
comma
l_int|0x10000000
comma
l_int|0x00400000
comma
id|DOMAIN_IO
comma
l_int|0
comma
l_int|1
comma
l_int|0
comma
l_int|0
)brace
comma
multiline_comment|/* CPLD */
id|SA1100_STD_IO_MAPPING
macro_line|#endif
)brace
suffix:semicolon
DECL|variable|__initdata
r_static
r_struct
id|map_desc
id|thinclient_io_desc
(braket
)braket
id|__initdata
op_assign
(brace
macro_line|#ifdef CONFIG_SA1100_THINCLIENT
macro_line|#if 0
(brace
l_int|0xd0000000
comma
l_int|0x00000000
comma
l_int|0x01000000
comma
id|DOMAIN_IO
comma
l_int|1
comma
l_int|1
comma
l_int|0
comma
l_int|0
)brace
comma
multiline_comment|/* Flash bank 0 when JP1 2-4 */
macro_line|#else
(brace
l_int|0xd0000000
comma
l_int|0x08000000
comma
l_int|0x01000000
comma
id|DOMAIN_IO
comma
l_int|1
comma
l_int|1
comma
l_int|0
comma
l_int|0
)brace
comma
multiline_comment|/* Flash bank 1 when JP1 3-4 */
macro_line|#endif
(brace
l_int|0xdc000000
comma
l_int|0x10000000
comma
l_int|0x00400000
comma
id|DOMAIN_IO
comma
l_int|0
comma
l_int|1
comma
l_int|0
comma
l_int|0
)brace
comma
multiline_comment|/* CPLD */
id|SA1100_STD_IO_MAPPING
macro_line|#endif
)brace
suffix:semicolon
DECL|variable|__initdata
r_static
r_struct
id|map_desc
id|tifon_io_desc
(braket
)braket
id|__initdata
op_assign
(brace
macro_line|#ifdef CONFIG_SA1100_TIFON
(brace
l_int|0xd0000000
comma
l_int|0x00000000
comma
l_int|0x00800000
comma
id|DOMAIN_IO
comma
l_int|1
comma
l_int|1
comma
l_int|0
comma
l_int|0
)brace
comma
multiline_comment|/* Flash bank 1 */
(brace
l_int|0xd0800000
comma
l_int|0x08000000
comma
l_int|0x00800000
comma
id|DOMAIN_IO
comma
l_int|1
comma
l_int|1
comma
l_int|0
comma
l_int|0
)brace
comma
multiline_comment|/* Flash bank 2 */
id|SA1100_STD_IO_MAPPING
macro_line|#endif
)brace
suffix:semicolon
DECL|variable|__initdata
r_static
r_struct
id|map_desc
id|victor_io_desc
(braket
)braket
id|__initdata
op_assign
(brace
macro_line|#ifdef CONFIG_SA1100_VICTOR
(brace
l_int|0xd0000000
comma
l_int|0x00000000
comma
l_int|0x00200000
comma
id|DOMAIN_IO
comma
l_int|1
comma
l_int|1
comma
l_int|0
comma
l_int|0
)brace
comma
multiline_comment|/* Flash */
id|SA1100_STD_IO_MAPPING
macro_line|#endif
)brace
suffix:semicolon
DECL|variable|__initdata
r_static
r_struct
id|map_desc
id|default_io_desc
(braket
)braket
id|__initdata
op_assign
(brace
id|SA1100_STD_IO_MAPPING
)brace
suffix:semicolon
multiline_comment|/*&n; * Here it would be wiser to simply assign a pointer to the appropriate &n; * list, but io_desc is already declared as an array in &quot;map.h&quot;.&n; */
DECL|variable|__initdata
r_struct
id|map_desc
id|io_desc
(braket
l_int|20
)braket
id|__initdata
op_assign
(brace
)brace
suffix:semicolon
DECL|variable|io_desc_size
r_int
r_int
id|io_desc_size
suffix:semicolon
DECL|function|select_sa1100_io_desc
r_void
id|__init
id|select_sa1100_io_desc
c_func
(paren
r_void
)paren
(brace
r_if
c_cond
(paren
id|machine_is_assabet
c_func
(paren
)paren
)paren
(brace
id|memcpy
c_func
(paren
id|io_desc
comma
id|assabet_io_desc
comma
r_sizeof
(paren
id|assabet_io_desc
)paren
)paren
suffix:semicolon
id|io_desc_size
op_assign
id|SIZE
c_func
(paren
id|assabet_io_desc
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|machine_is_bitsy
c_func
(paren
)paren
)paren
(brace
id|memcpy
c_func
(paren
id|io_desc
comma
id|bitsy_io_desc
comma
r_sizeof
(paren
id|bitsy_io_desc
)paren
)paren
suffix:semicolon
id|io_desc_size
op_assign
id|SIZE
c_func
(paren
id|bitsy_io_desc
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|machine_is_empeg
c_func
(paren
)paren
)paren
(brace
id|memcpy
c_func
(paren
id|io_desc
comma
id|empeg_io_desc
comma
r_sizeof
(paren
id|empeg_io_desc
)paren
)paren
suffix:semicolon
id|io_desc_size
op_assign
id|SIZE
c_func
(paren
id|empeg_io_desc
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|machine_is_graphicsclient
c_func
(paren
)paren
)paren
(brace
id|memcpy
c_func
(paren
id|io_desc
comma
id|graphicsclient_io_desc
comma
r_sizeof
(paren
id|graphicsclient_io_desc
)paren
)paren
suffix:semicolon
id|io_desc_size
op_assign
id|SIZE
c_func
(paren
id|graphicsclient_io_desc
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|machine_is_thinclient
c_func
(paren
)paren
)paren
(brace
id|memcpy
c_func
(paren
id|io_desc
comma
id|thinclient_io_desc
comma
r_sizeof
(paren
id|thinclient_io_desc
)paren
)paren
suffix:semicolon
id|io_desc_size
op_assign
id|SIZE
c_func
(paren
id|thinclient_io_desc
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|machine_is_tifon
c_func
(paren
)paren
)paren
(brace
id|memcpy
c_func
(paren
id|io_desc
comma
id|tifon_io_desc
comma
r_sizeof
(paren
id|tifon_io_desc
)paren
)paren
suffix:semicolon
id|io_desc_size
op_assign
id|SIZE
c_func
(paren
id|tifon_io_desc
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|machine_is_victor
c_func
(paren
)paren
)paren
(brace
id|memcpy
c_func
(paren
id|io_desc
comma
id|victor_io_desc
comma
r_sizeof
(paren
id|victor_io_desc
)paren
)paren
suffix:semicolon
id|io_desc_size
op_assign
id|SIZE
c_func
(paren
id|victor_io_desc
)paren
suffix:semicolon
)brace
r_else
(brace
id|memcpy
c_func
(paren
id|io_desc
comma
id|default_io_desc
comma
r_sizeof
(paren
id|default_io_desc
)paren
)paren
suffix:semicolon
id|io_desc_size
op_assign
id|SIZE
c_func
(paren
id|default_io_desc
)paren
suffix:semicolon
)brace
)brace
eof
