multiline_comment|/*&n; * arch/arm/kernel/dma-ebsa285.c&n; *&n; * Copyright (C) 1998 Phil Blundell&n; *&n; * DMA functions specific to EBSA-285/CATS architectures&n; *&n; * Changelog:&n; *  09-Nov-1998&t;RMK&t;Split out ISA DMA functions to dma-isa.c&n; *  17-Mar-1999&t;RMK&t;Allow any EBSA285-like architecture to have&n; *&t;&t;&t;ISA DMA controllers.&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/malloc.h&gt;
macro_line|#include &lt;linux/mman.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;asm/page.h&gt;
macro_line|#include &lt;asm/dma.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;asm/hardware.h&gt;
macro_line|#include &quot;dma.h&quot;
macro_line|#include &quot;dma-isa.h&quot;
macro_line|#ifdef CONFIG_ISA_DMA
DECL|variable|has_isa_dma
r_static
r_int
id|has_isa_dma
suffix:semicolon
macro_line|#else
DECL|macro|has_isa_dma
mdefine_line|#define has_isa_dma 0
macro_line|#endif
DECL|function|arch_request_dma
r_int
id|arch_request_dma
c_func
(paren
id|dmach_t
id|channel
comma
id|dma_t
op_star
id|dma
comma
r_const
r_char
op_star
id|dev_name
)paren
(brace
r_switch
c_cond
(paren
id|channel
)paren
(brace
r_case
id|_DC21285_DMA
c_func
(paren
l_int|0
)paren
suffix:colon
r_case
id|_DC21285_DMA
c_func
(paren
l_int|1
)paren
suffix:colon
multiline_comment|/* 21285 internal channels */
r_return
l_int|0
suffix:semicolon
r_case
id|_ISA_DMA
c_func
(paren
l_int|0
)paren
dot
dot
dot
id|_ISA_DMA
c_func
(paren
l_int|7
)paren
suffix:colon
r_if
c_cond
(paren
id|has_isa_dma
)paren
r_return
id|isa_request_dma
c_func
(paren
id|channel
op_minus
id|_ISA_DMA
c_func
(paren
l_int|0
)paren
comma
id|dma
comma
id|dev_name
)paren
suffix:semicolon
)brace
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
DECL|function|arch_free_dma
r_void
id|arch_free_dma
c_func
(paren
id|dmach_t
id|channel
comma
id|dma_t
op_star
id|dma
)paren
(brace
multiline_comment|/* nothing to do */
)brace
DECL|function|arch_get_dma_residue
r_int
id|arch_get_dma_residue
c_func
(paren
id|dmach_t
id|channel
comma
id|dma_t
op_star
id|dma
)paren
(brace
r_int
id|residue
op_assign
l_int|0
suffix:semicolon
r_switch
c_cond
(paren
id|channel
)paren
(brace
r_case
id|_DC21285_DMA
c_func
(paren
l_int|0
)paren
suffix:colon
r_case
id|_DC21285_DMA
c_func
(paren
l_int|1
)paren
suffix:colon
r_break
suffix:semicolon
r_case
id|_ISA_DMA
c_func
(paren
l_int|0
)paren
dot
dot
dot
id|_ISA_DMA
c_func
(paren
l_int|7
)paren
suffix:colon
r_if
c_cond
(paren
id|has_isa_dma
)paren
id|residue
op_assign
id|isa_get_dma_residue
c_func
(paren
id|channel
op_minus
id|_ISA_DMA
c_func
(paren
l_int|0
)paren
comma
id|dma
)paren
suffix:semicolon
)brace
r_return
id|residue
suffix:semicolon
)brace
DECL|function|arch_enable_dma
r_void
id|arch_enable_dma
c_func
(paren
id|dmach_t
id|channel
comma
id|dma_t
op_star
id|dma
)paren
(brace
r_switch
c_cond
(paren
id|channel
)paren
(brace
r_case
id|_DC21285_DMA
c_func
(paren
l_int|0
)paren
suffix:colon
r_case
id|_DC21285_DMA
c_func
(paren
l_int|1
)paren
suffix:colon
multiline_comment|/*&n;&t;&t; * Not yet implemented&n;&t;&t; */
r_break
suffix:semicolon
r_case
id|_ISA_DMA
c_func
(paren
l_int|0
)paren
dot
dot
dot
id|_ISA_DMA
c_func
(paren
l_int|7
)paren
suffix:colon
r_if
c_cond
(paren
id|has_isa_dma
)paren
id|isa_enable_dma
c_func
(paren
id|channel
op_minus
id|_ISA_DMA
c_func
(paren
l_int|0
)paren
comma
id|dma
)paren
suffix:semicolon
)brace
)brace
DECL|function|arch_disable_dma
r_void
id|arch_disable_dma
c_func
(paren
id|dmach_t
id|channel
comma
id|dma_t
op_star
id|dma
)paren
(brace
r_switch
c_cond
(paren
id|channel
)paren
(brace
r_case
id|_DC21285_DMA
c_func
(paren
l_int|0
)paren
suffix:colon
r_case
id|_DC21285_DMA
c_func
(paren
l_int|1
)paren
suffix:colon
multiline_comment|/*&n;&t;&t; * Not yet implemented&n;&t;&t; */
r_break
suffix:semicolon
r_case
id|_ISA_DMA
c_func
(paren
l_int|0
)paren
dot
dot
dot
id|_ISA_DMA
c_func
(paren
l_int|7
)paren
suffix:colon
r_if
c_cond
(paren
id|has_isa_dma
)paren
id|isa_disable_dma
c_func
(paren
id|channel
op_minus
id|_ISA_DMA
c_func
(paren
l_int|0
)paren
comma
id|dma
)paren
suffix:semicolon
)brace
)brace
DECL|function|arch_set_dma_speed
r_int
id|arch_set_dma_speed
c_func
(paren
id|dmach_t
id|channel
comma
id|dma_t
op_star
id|dma
comma
r_int
id|cycle_ns
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|arch_dma_init
r_void
id|__init
id|arch_dma_init
c_func
(paren
id|dma_t
op_star
id|dma
)paren
(brace
macro_line|#ifdef CONFIG_ISA_DMA
id|has_isa_dma
op_assign
id|isa_init_dma
c_func
(paren
)paren
suffix:semicolon
macro_line|#endif
)brace
eof
