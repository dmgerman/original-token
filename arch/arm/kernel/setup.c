multiline_comment|/*&n; *  linux/arch/arm/kernel/setup.c&n; *&n; *  Copyright (C) 1995-1999 Russell King&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/stddef.h&gt;
macro_line|#include &lt;linux/tty.h&gt;
macro_line|#include &lt;linux/ioport.h&gt;
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/utsname.h&gt;
macro_line|#include &lt;linux/blk.h&gt;
macro_line|#include &lt;linux/console.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/bootmem.h&gt;
macro_line|#include &lt;asm/elf.h&gt;
macro_line|#include &lt;asm/hardware.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;asm/procinfo.h&gt;
macro_line|#include &lt;asm/setup.h&gt;
macro_line|#include &lt;asm/system.h&gt;
macro_line|#ifndef MEM_SIZE
DECL|macro|MEM_SIZE
mdefine_line|#define MEM_SIZE&t;(16*1024*1024)
macro_line|#endif
macro_line|#ifndef CONFIG_CMDLINE
DECL|macro|CONFIG_CMDLINE
mdefine_line|#define CONFIG_CMDLINE &quot;&quot;
macro_line|#endif
r_extern
r_void
id|reboot_setup
c_func
(paren
r_char
op_star
id|str
)paren
suffix:semicolon
r_extern
r_void
id|disable_hlt
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|root_mountflags
suffix:semicolon
r_extern
r_int
id|_stext
comma
id|_text
comma
id|_etext
comma
id|_edata
comma
id|_end
suffix:semicolon
DECL|variable|processor_id
r_int
r_int
id|processor_id
suffix:semicolon
DECL|variable|__machine_arch_type
r_int
r_int
id|__machine_arch_type
suffix:semicolon
DECL|variable|vram_size
r_int
r_int
id|vram_size
suffix:semicolon
DECL|variable|system_rev
r_int
r_int
id|system_rev
suffix:semicolon
DECL|variable|system_serial_low
r_int
r_int
id|system_serial_low
suffix:semicolon
DECL|variable|system_serial_high
r_int
r_int
id|system_serial_high
suffix:semicolon
DECL|variable|elf_hwcap
r_int
r_int
id|elf_hwcap
suffix:semicolon
macro_line|#ifdef CONFIG_ARCH_ACORN
DECL|variable|memc_ctrl_reg
r_int
r_int
id|memc_ctrl_reg
suffix:semicolon
DECL|variable|number_mfm_drives
r_int
r_int
id|number_mfm_drives
suffix:semicolon
macro_line|#endif
DECL|variable|meminfo
r_struct
id|meminfo
id|meminfo
suffix:semicolon
DECL|struct|machine_desc
r_struct
id|machine_desc
(brace
DECL|member|name
r_const
r_char
op_star
id|name
suffix:semicolon
multiline_comment|/* architecture name&t;*/
DECL|member|param_offset
r_int
r_int
id|param_offset
suffix:semicolon
multiline_comment|/* parameter page&t;*/
DECL|member|video_start
r_int
r_int
id|video_start
suffix:semicolon
multiline_comment|/* start of video RAM&t;*/
DECL|member|video_end
r_int
r_int
id|video_end
suffix:semicolon
multiline_comment|/* end of video RAM&t;*/
DECL|member|reserve_lp0
r_int
r_int
id|reserve_lp0
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/* never has lp0&t;*/
DECL|member|reserve_lp1
r_int
r_int
id|reserve_lp1
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/* never has lp1&t;*/
DECL|member|reserve_lp2
r_int
r_int
id|reserve_lp2
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/* never has lp2&t;*/
DECL|member|broken_hlt
r_int
r_int
id|broken_hlt
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/* hlt is broken&t;*/
DECL|member|soft_reboot
r_int
r_int
id|soft_reboot
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/* soft reboot&t;&t;*/
DECL|member|fixup
r_void
(paren
op_star
id|fixup
)paren
(paren
r_struct
id|machine_desc
op_star
comma
r_struct
id|param_struct
op_star
comma
r_char
op_star
op_star
)paren
suffix:semicolon
)brace
suffix:semicolon
macro_line|#ifdef MULTI_CPU
DECL|variable|processor
r_struct
id|processor
id|processor
suffix:semicolon
macro_line|#endif
DECL|struct|drive_info_struct
DECL|member|dummy
DECL|variable|drive_info
r_struct
id|drive_info_struct
(brace
r_char
id|dummy
(braket
l_int|32
)braket
suffix:semicolon
)brace
id|drive_info
suffix:semicolon
DECL|variable|screen_info
r_struct
id|screen_info
id|screen_info
op_assign
(brace
id|orig_video_lines
suffix:colon
l_int|30
comma
id|orig_video_cols
suffix:colon
l_int|80
comma
id|orig_video_mode
suffix:colon
l_int|0
comma
id|orig_video_ega_bx
suffix:colon
l_int|0
comma
id|orig_video_isVGA
suffix:colon
l_int|1
comma
id|orig_video_points
suffix:colon
l_int|8
)brace
suffix:semicolon
DECL|variable|aux_device_present
r_int
r_char
id|aux_device_present
suffix:semicolon
DECL|variable|elf_platform
r_char
id|elf_platform
(braket
id|ELF_PLATFORM_SIZE
)braket
suffix:semicolon
DECL|variable|saved_command_line
r_char
id|saved_command_line
(braket
id|COMMAND_LINE_SIZE
)braket
suffix:semicolon
DECL|variable|proc_info
r_static
r_struct
id|proc_info_item
id|proc_info
suffix:semicolon
DECL|variable|machine_name
r_static
r_const
r_char
op_star
id|machine_name
suffix:semicolon
DECL|variable|command_line
r_static
r_char
id|command_line
(braket
id|COMMAND_LINE_SIZE
)braket
op_assign
(brace
l_int|0
comma
)brace
suffix:semicolon
DECL|variable|__initdata
r_static
r_char
id|default_command_line
(braket
id|COMMAND_LINE_SIZE
)braket
id|__initdata
op_assign
id|CONFIG_CMDLINE
suffix:semicolon
DECL|member|c
DECL|member|l
DECL|variable|__initdata
r_static
r_union
(brace
r_char
id|c
(braket
l_int|4
)braket
suffix:semicolon
r_int
r_int
id|l
suffix:semicolon
)brace
id|endian_test
id|__initdata
op_assign
(brace
(brace
l_char|&squot;l&squot;
comma
l_char|&squot;?&squot;
comma
l_char|&squot;?&squot;
comma
l_char|&squot;b&squot;
)brace
)brace
suffix:semicolon
DECL|macro|ENDIANNESS
mdefine_line|#define ENDIANNESS ((char)endian_test.l)
multiline_comment|/*&n; * Standard memory resources&n; */
DECL|variable|mem_res
r_static
r_struct
id|resource
id|mem_res
(braket
)braket
op_assign
(brace
(brace
l_string|&quot;Video RAM&quot;
comma
l_int|0
comma
l_int|0
comma
id|IORESOURCE_MEM
)brace
comma
(brace
l_string|&quot;Kernel code&quot;
comma
l_int|0
comma
l_int|0
comma
id|IORESOURCE_MEM
)brace
comma
(brace
l_string|&quot;Kernel data&quot;
comma
l_int|0
comma
l_int|0
comma
id|IORESOURCE_MEM
)brace
)brace
suffix:semicolon
DECL|macro|video_ram
mdefine_line|#define video_ram   mem_res[0]
DECL|macro|kernel_code
mdefine_line|#define kernel_code mem_res[1]
DECL|macro|kernel_data
mdefine_line|#define kernel_data mem_res[2]
DECL|variable|io_res
r_static
r_struct
id|resource
id|io_res
(braket
)braket
op_assign
(brace
(brace
l_string|&quot;reserved&quot;
comma
l_int|0x3bc
comma
l_int|0x3be
comma
id|IORESOURCE_IO
op_or
id|IORESOURCE_BUSY
)brace
comma
(brace
l_string|&quot;reserved&quot;
comma
l_int|0x378
comma
l_int|0x37f
comma
id|IORESOURCE_IO
op_or
id|IORESOURCE_BUSY
)brace
comma
(brace
l_string|&quot;reserved&quot;
comma
l_int|0x278
comma
l_int|0x27f
comma
id|IORESOURCE_IO
op_or
id|IORESOURCE_BUSY
)brace
)brace
suffix:semicolon
DECL|macro|lp0
mdefine_line|#define lp0 io_res[0]
DECL|macro|lp1
mdefine_line|#define lp1 io_res[1]
DECL|macro|lp2
mdefine_line|#define lp2 io_res[2]
DECL|function|setup_processor
r_static
r_void
id|__init
id|setup_processor
c_func
(paren
r_void
)paren
(brace
r_extern
r_struct
id|proc_info_list
id|__proc_info_begin
comma
id|__proc_info_end
suffix:semicolon
r_struct
id|proc_info_list
op_star
id|list
suffix:semicolon
multiline_comment|/*&n;&t; * locate processor in the list of supported processor&n;&t; * types.  The linker builds this table for us from the&n;&t; * entries in arch/arm/mm/proc-*.S&n;&t; */
r_for
c_loop
(paren
id|list
op_assign
op_amp
id|__proc_info_begin
suffix:semicolon
id|list
OL
op_amp
id|__proc_info_end
suffix:semicolon
id|list
op_increment
)paren
r_if
c_cond
(paren
(paren
id|processor_id
op_amp
id|list-&gt;cpu_mask
)paren
op_eq
id|list-&gt;cpu_val
)paren
r_break
suffix:semicolon
multiline_comment|/*&n;&t; * If processor type is unrecognised, then we&n;&t; * can do nothing...&n;&t; */
r_if
c_cond
(paren
id|list
op_ge
op_amp
id|__proc_info_end
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;CPU configuration botched (ID %08x), unable &quot;
l_string|&quot;to continue.&bslash;n&quot;
comma
id|processor_id
)paren
suffix:semicolon
r_while
c_loop
(paren
l_int|1
)paren
suffix:semicolon
)brace
id|proc_info
op_assign
op_star
id|list-&gt;info
suffix:semicolon
macro_line|#ifdef MULTI_CPU
id|processor
op_assign
op_star
id|list-&gt;proc
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;Processor: %s %s revision %d&bslash;n&quot;
comma
id|proc_info.manufacturer
comma
id|proc_info.cpu_name
comma
(paren
r_int
)paren
id|processor_id
op_amp
l_int|15
)paren
suffix:semicolon
macro_line|#endif
id|sprintf
c_func
(paren
id|system_utsname.machine
comma
l_string|&quot;%s%c&quot;
comma
id|list-&gt;arch_name
comma
id|ENDIANNESS
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|elf_platform
comma
l_string|&quot;%s%c&quot;
comma
id|list-&gt;elf_name
comma
id|ENDIANNESS
)paren
suffix:semicolon
id|elf_hwcap
op_assign
id|list-&gt;elf_hwcap
suffix:semicolon
id|cpu_proc_init
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|function|memparse
r_static
r_int
r_int
id|__init
id|memparse
c_func
(paren
r_char
op_star
id|ptr
comma
r_char
op_star
op_star
id|retptr
)paren
(brace
r_int
r_int
id|ret
op_assign
id|simple_strtoul
c_func
(paren
id|ptr
comma
id|retptr
comma
l_int|0
)paren
suffix:semicolon
r_switch
c_cond
(paren
op_star
op_star
id|retptr
)paren
(brace
r_case
l_char|&squot;M&squot;
suffix:colon
r_case
l_char|&squot;m&squot;
suffix:colon
id|ret
op_lshift_assign
l_int|10
suffix:semicolon
r_case
l_char|&squot;K&squot;
suffix:colon
r_case
l_char|&squot;k&squot;
suffix:colon
id|ret
op_lshift_assign
l_int|10
suffix:semicolon
(paren
op_star
id|retptr
)paren
op_increment
suffix:semicolon
r_default
suffix:colon
r_break
suffix:semicolon
)brace
r_return
id|ret
suffix:semicolon
)brace
multiline_comment|/*&n; * Initial parsing of the command line.  We need to pick out the&n; * memory size.  We look for mem=size@start, where start and size&n; * are &quot;size[KkMm]&quot;&n; */
r_static
r_void
id|__init
DECL|function|parse_cmdline
id|parse_cmdline
c_func
(paren
r_char
op_star
op_star
id|cmdline_p
comma
r_char
op_star
id|from
)paren
(brace
r_char
id|c
op_assign
l_char|&squot; &squot;
comma
op_star
id|to
op_assign
id|command_line
suffix:semicolon
r_int
id|usermem
op_assign
l_int|0
comma
id|len
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
suffix:semicolon
)paren
(brace
r_if
c_cond
(paren
id|c
op_eq
l_char|&squot; &squot;
op_logical_and
op_logical_neg
id|memcmp
c_func
(paren
id|from
comma
l_string|&quot;mem=&quot;
comma
l_int|4
)paren
)paren
(brace
r_int
r_int
id|size
comma
id|start
suffix:semicolon
r_if
c_cond
(paren
id|to
op_ne
id|command_line
)paren
id|to
op_sub_assign
l_int|1
suffix:semicolon
multiline_comment|/* If the user specifies memory size, we&n;&t;&t;&t; * blow away any automatically generated&n;&t;&t;&t; * size.&n;&t;&t;&t; */
r_if
c_cond
(paren
id|usermem
op_eq
l_int|0
)paren
(brace
id|usermem
op_assign
l_int|1
suffix:semicolon
id|meminfo.nr_banks
op_assign
l_int|0
suffix:semicolon
)brace
id|start
op_assign
id|PHYS_OFFSET
suffix:semicolon
id|size
op_assign
id|memparse
c_func
(paren
id|from
op_plus
l_int|4
comma
op_amp
id|from
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|from
op_eq
l_char|&squot;@&squot;
)paren
id|start
op_assign
id|memparse
c_func
(paren
id|from
op_plus
l_int|1
comma
op_amp
id|from
)paren
suffix:semicolon
id|meminfo.bank
(braket
id|meminfo.nr_banks
)braket
dot
id|start
op_assign
id|start
suffix:semicolon
id|meminfo.bank
(braket
id|meminfo.nr_banks
)braket
dot
id|size
op_assign
id|size
suffix:semicolon
id|meminfo.nr_banks
op_add_assign
l_int|1
suffix:semicolon
)brace
id|c
op_assign
op_star
id|from
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|c
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|COMMAND_LINE_SIZE
op_le
op_increment
id|len
)paren
r_break
suffix:semicolon
op_star
id|to
op_increment
op_assign
id|c
suffix:semicolon
)brace
op_star
id|to
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
op_star
id|cmdline_p
op_assign
id|command_line
suffix:semicolon
)brace
r_static
r_void
id|__init
DECL|function|setup_ramdisk
id|setup_ramdisk
c_func
(paren
r_int
id|doload
comma
r_int
id|prompt
comma
r_int
id|image_start
comma
r_int
r_int
id|rd_sz
)paren
(brace
macro_line|#ifdef CONFIG_BLK_DEV_RAM
r_extern
r_int
id|rd_doload
comma
id|rd_prompt
comma
id|rd_image_start
comma
id|rd_size
suffix:semicolon
id|rd_image_start
op_assign
id|image_start
suffix:semicolon
id|rd_prompt
op_assign
id|prompt
suffix:semicolon
id|rd_doload
op_assign
id|doload
suffix:semicolon
r_if
c_cond
(paren
id|rd_sz
)paren
id|rd_size
op_assign
id|rd_sz
suffix:semicolon
macro_line|#endif
)brace
multiline_comment|/*&n; * initial ram disk&n; */
DECL|function|setup_initrd
r_static
r_void
id|__init
id|setup_initrd
c_func
(paren
r_int
r_int
id|start
comma
r_int
r_int
id|size
)paren
(brace
macro_line|#ifdef CONFIG_BLK_DEV_INITRD
r_if
c_cond
(paren
id|start
op_eq
l_int|0
)paren
id|size
op_assign
l_int|0
suffix:semicolon
id|initrd_start
op_assign
id|start
suffix:semicolon
id|initrd_end
op_assign
id|start
op_plus
id|size
suffix:semicolon
macro_line|#endif
)brace
DECL|macro|O_PFN_DOWN
mdefine_line|#define O_PFN_DOWN(x)&t;((x) &gt;&gt; PAGE_SHIFT)
DECL|macro|V_PFN_DOWN
mdefine_line|#define V_PFN_DOWN(x)&t;O_PFN_DOWN(__pa(x))
DECL|macro|O_PFN_UP
mdefine_line|#define O_PFN_UP(x)&t;(PAGE_ALIGN(x) &gt;&gt; PAGE_SHIFT)
DECL|macro|V_PFN_UP
mdefine_line|#define V_PFN_UP(x)&t;O_PFN_UP(__pa(x))
DECL|macro|PFN_SIZE
mdefine_line|#define PFN_SIZE(x)&t;((x) &gt;&gt; PAGE_SHIFT)
DECL|macro|PFN_RANGE
mdefine_line|#define PFN_RANGE(s,e)&t;PFN_SIZE(PAGE_ALIGN((unsigned long)(e)) - &bslash;&n;&t;&t;&t;&t;(((unsigned long)(s)) &amp; PAGE_MASK))
multiline_comment|/*&n; * FIXME: These can be removed when Ingo&squot;s cleanup patch goes in&n; */
DECL|macro|free_bootmem
mdefine_line|#define free_bootmem(s,sz)&t;free_bootmem((s)&lt;&lt;PAGE_SHIFT, (sz)&lt;&lt;PAGE_SHIFT)
DECL|macro|reserve_bootmem
mdefine_line|#define reserve_bootmem(s,sz)&t;reserve_bootmem((s)&lt;&lt;PAGE_SHIFT, (sz)&lt;&lt;PAGE_SHIFT)
DECL|function|find_bootmap_pfn
r_static
r_int
r_int
id|__init
id|find_bootmap_pfn
c_func
(paren
r_int
r_int
id|bootmap_pages
)paren
(brace
r_int
r_int
id|start_pfn
comma
id|bank
comma
id|bootmap_pfn
suffix:semicolon
id|start_pfn
op_assign
id|V_PFN_UP
c_func
(paren
op_amp
id|_end
)paren
suffix:semicolon
id|bootmap_pfn
op_assign
l_int|0
suffix:semicolon
multiline_comment|/*&n;&t; * FIXME: We really want to avoid allocating the bootmap&n;&t; * over the top of the initrd.&n;&t; */
macro_line|#ifdef CONFIG_BLK_DEV_INITRD
r_if
c_cond
(paren
id|initrd_start
)paren
(brace
r_if
c_cond
(paren
id|__pa
c_func
(paren
id|initrd_end
)paren
OG
id|meminfo.end
)paren
(brace
id|printk
(paren
l_string|&quot;initrd extends beyond end of memory &quot;
l_string|&quot;(0x%08lx &gt; 0x%08lx) - disabling initrd&bslash;n&quot;
comma
id|__pa
c_func
(paren
id|initrd_end
)paren
comma
id|meminfo.end
)paren
suffix:semicolon
id|initrd_start
op_assign
l_int|0
suffix:semicolon
id|initrd_end
op_assign
l_int|0
suffix:semicolon
)brace
)brace
macro_line|#endif
r_for
c_loop
(paren
id|bank
op_assign
l_int|0
suffix:semicolon
id|bank
OL
id|meminfo.nr_banks
suffix:semicolon
id|bank
op_increment
)paren
(brace
r_int
r_int
id|start
comma
id|end
suffix:semicolon
r_if
c_cond
(paren
id|meminfo.bank
(braket
id|bank
)braket
dot
id|size
op_eq
l_int|0
)paren
r_continue
suffix:semicolon
id|start
op_assign
id|O_PFN_UP
c_func
(paren
id|meminfo.bank
(braket
id|bank
)braket
dot
id|start
)paren
suffix:semicolon
id|end
op_assign
id|O_PFN_DOWN
c_func
(paren
id|meminfo.bank
(braket
id|bank
)braket
dot
id|size
op_plus
id|meminfo.bank
(braket
id|bank
)braket
dot
id|start
)paren
suffix:semicolon
r_if
c_cond
(paren
id|end
OL
id|start_pfn
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|start
OL
id|start_pfn
)paren
id|start
op_assign
id|start_pfn
suffix:semicolon
r_if
c_cond
(paren
id|end
op_le
id|start
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|end
op_minus
id|start
op_ge
id|bootmap_pages
)paren
(brace
id|bootmap_pfn
op_assign
id|start
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|bootmap_pfn
op_eq
l_int|0
)paren
id|BUG
c_func
(paren
)paren
suffix:semicolon
r_return
id|bootmap_pfn
suffix:semicolon
)brace
multiline_comment|/*&n; * Initialise the bootmem allocator.&n; */
DECL|function|setup_bootmem
r_static
r_void
id|__init
id|setup_bootmem
c_func
(paren
r_void
)paren
(brace
r_int
r_int
id|end_pfn
comma
id|start_pfn
comma
id|bootmap_pages
comma
id|bootmap_pfn
suffix:semicolon
r_int
r_int
id|i
suffix:semicolon
multiline_comment|/*&n;&t; * Calculate the  physical address of the top of memory.&n;&t; */
id|meminfo.end
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|meminfo.nr_banks
suffix:semicolon
id|i
op_increment
)paren
(brace
r_int
r_int
id|end
suffix:semicolon
r_if
c_cond
(paren
id|meminfo.bank
(braket
id|i
)braket
dot
id|size
op_ne
l_int|0
)paren
(brace
id|end
op_assign
id|meminfo.bank
(braket
id|i
)braket
dot
id|start
op_plus
id|meminfo.bank
(braket
id|i
)braket
dot
id|size
suffix:semicolon
r_if
c_cond
(paren
id|meminfo.end
OL
id|end
)paren
id|meminfo.end
op_assign
id|end
suffix:semicolon
)brace
)brace
id|start_pfn
op_assign
id|O_PFN_UP
c_func
(paren
id|PHYS_OFFSET
)paren
suffix:semicolon
id|end_pfn
op_assign
id|O_PFN_DOWN
c_func
(paren
id|meminfo.end
)paren
suffix:semicolon
id|bootmap_pages
op_assign
id|bootmem_bootmap_pages
c_func
(paren
id|end_pfn
op_minus
id|start_pfn
)paren
suffix:semicolon
id|bootmap_pfn
op_assign
id|find_bootmap_pfn
c_func
(paren
id|bootmap_pages
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Initialise the boot-time allocator&n;&t; */
id|init_bootmem_start
c_func
(paren
id|bootmap_pfn
comma
id|start_pfn
comma
id|end_pfn
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Register all available RAM with the bootmem allocator.&n;&t; */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|meminfo.nr_banks
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|meminfo.bank
(braket
id|i
)braket
dot
id|size
)paren
id|free_bootmem
c_func
(paren
id|O_PFN_UP
c_func
(paren
id|meminfo.bank
(braket
id|i
)braket
dot
id|start
)paren
comma
id|PFN_SIZE
c_func
(paren
id|meminfo.bank
(braket
id|i
)braket
dot
id|size
)paren
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Register the reserved regions with bootmem&n;&t; */
id|reserve_bootmem
c_func
(paren
id|bootmap_pfn
comma
id|bootmap_pages
)paren
suffix:semicolon
id|reserve_bootmem
c_func
(paren
id|V_PFN_DOWN
c_func
(paren
op_amp
id|_stext
)paren
comma
id|PFN_RANGE
c_func
(paren
op_amp
id|_stext
comma
op_amp
id|_end
)paren
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_CPU_32
multiline_comment|/*&n;&t; * Reserve the page tables.  These are already in use.&n;&t; */
id|reserve_bootmem
c_func
(paren
id|V_PFN_DOWN
c_func
(paren
id|swapper_pg_dir
)paren
comma
id|PFN_SIZE
c_func
(paren
id|PTRS_PER_PGD
op_star
r_sizeof
(paren
r_void
op_star
)paren
)paren
)paren
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_BLK_DEV_INITRD
r_if
c_cond
(paren
id|initrd_start
)paren
id|reserve_bootmem
c_func
(paren
id|V_PFN_DOWN
c_func
(paren
id|initrd_start
)paren
comma
id|PFN_RANGE
c_func
(paren
id|initrd_start
comma
id|initrd_end
)paren
)paren
suffix:semicolon
macro_line|#endif
)brace
DECL|function|request_standard_resources
r_static
r_void
id|__init
id|request_standard_resources
c_func
(paren
r_struct
id|machine_desc
op_star
id|mdesc
)paren
(brace
r_struct
id|resource
op_star
id|res
suffix:semicolon
r_int
id|i
suffix:semicolon
id|kernel_code.start
op_assign
id|__virt_to_bus
c_func
(paren
id|init_mm.start_code
)paren
suffix:semicolon
id|kernel_code.end
op_assign
id|__virt_to_bus
c_func
(paren
id|init_mm.end_code
op_minus
l_int|1
)paren
suffix:semicolon
id|kernel_data.start
op_assign
id|__virt_to_bus
c_func
(paren
id|init_mm.end_code
)paren
suffix:semicolon
id|kernel_data.end
op_assign
id|__virt_to_bus
c_func
(paren
id|init_mm.brk
op_minus
l_int|1
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|meminfo.nr_banks
suffix:semicolon
id|i
op_increment
)paren
(brace
r_int
r_int
id|virt_start
comma
id|virt_end
suffix:semicolon
r_if
c_cond
(paren
id|meminfo.bank
(braket
id|i
)braket
dot
id|size
op_eq
l_int|0
)paren
r_continue
suffix:semicolon
id|virt_start
op_assign
id|__phys_to_virt
c_func
(paren
id|meminfo.bank
(braket
id|i
)braket
dot
id|start
)paren
suffix:semicolon
id|virt_end
op_assign
id|virt_start
op_plus
id|meminfo.bank
(braket
id|i
)braket
dot
id|size
op_minus
l_int|1
suffix:semicolon
id|res
op_assign
id|alloc_bootmem_low
c_func
(paren
r_sizeof
(paren
op_star
id|res
)paren
)paren
suffix:semicolon
id|res-&gt;name
op_assign
l_string|&quot;System RAM&quot;
suffix:semicolon
id|res-&gt;start
op_assign
id|__virt_to_bus
c_func
(paren
id|virt_start
)paren
suffix:semicolon
id|res-&gt;end
op_assign
id|__virt_to_bus
c_func
(paren
id|virt_end
)paren
suffix:semicolon
id|res-&gt;flags
op_assign
id|IORESOURCE_MEM
op_or
id|IORESOURCE_BUSY
suffix:semicolon
id|request_resource
c_func
(paren
op_amp
id|iomem_resource
comma
id|res
)paren
suffix:semicolon
r_if
c_cond
(paren
id|kernel_code.start
op_ge
id|res-&gt;start
op_logical_and
id|kernel_code.end
op_le
id|res-&gt;end
)paren
id|request_resource
c_func
(paren
id|res
comma
op_amp
id|kernel_code
)paren
suffix:semicolon
r_if
c_cond
(paren
id|kernel_data.start
op_ge
id|res-&gt;start
op_logical_and
id|kernel_data.end
op_le
id|res-&gt;end
)paren
id|request_resource
c_func
(paren
id|res
comma
op_amp
id|kernel_data
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|mdesc-&gt;video_start
)paren
(brace
id|video_ram.start
op_assign
id|mdesc-&gt;video_start
suffix:semicolon
id|video_ram.end
op_assign
id|mdesc-&gt;video_end
suffix:semicolon
id|request_resource
c_func
(paren
op_amp
id|iomem_resource
comma
op_amp
id|video_ram
)paren
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * Some machines don&squot;t have the possibility of ever&n;&t; * possessing lp0, lp1 or lp2&n;&t; */
r_if
c_cond
(paren
id|mdesc-&gt;reserve_lp0
)paren
id|request_resource
c_func
(paren
op_amp
id|ioport_resource
comma
op_amp
id|lp0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mdesc-&gt;reserve_lp1
)paren
id|request_resource
c_func
(paren
op_amp
id|ioport_resource
comma
op_amp
id|lp1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mdesc-&gt;reserve_lp2
)paren
id|request_resource
c_func
(paren
op_amp
id|ioport_resource
comma
op_amp
id|lp2
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Architecture specific fixups.  This is where any&n; * parameters in the params struct are fixed up, or&n; * any additional architecture specific information&n; * is pulled from the params struct.&n; */
r_static
r_void
id|__init
DECL|function|fixup_acorn
id|fixup_acorn
c_func
(paren
r_struct
id|machine_desc
op_star
id|desc
comma
r_struct
id|param_struct
op_star
id|params
comma
r_char
op_star
op_star
id|cmdline
)paren
(brace
macro_line|#ifdef CONFIG_ARCH_ACORN
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
id|machine_is_riscpc
c_func
(paren
)paren
)paren
(brace
multiline_comment|/*&n;&t;&t; * RiscPC can&squot;t handle half-word loads and stores&n;&t;&t; */
id|elf_hwcap
op_and_assign
op_complement
id|HWCAP_HALF
suffix:semicolon
r_switch
c_cond
(paren
id|params-&gt;u1.s.pages_in_vram
)paren
(brace
r_case
l_int|512
suffix:colon
id|vram_size
op_add_assign
id|PAGE_SIZE
op_star
l_int|256
suffix:semicolon
r_case
l_int|256
suffix:colon
id|vram_size
op_add_assign
id|PAGE_SIZE
op_star
l_int|256
suffix:semicolon
r_default
suffix:colon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|vram_size
)paren
(brace
id|desc-&gt;video_start
op_assign
l_int|0x02000000
suffix:semicolon
id|desc-&gt;video_end
op_assign
l_int|0x02000000
op_plus
id|vram_size
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|4
suffix:semicolon
id|i
op_increment
)paren
(brace
id|meminfo.bank
(braket
id|i
)braket
dot
id|start
op_assign
id|PHYS_OFFSET
op_plus
(paren
id|i
op_lshift
l_int|26
)paren
suffix:semicolon
id|meminfo.bank
(braket
id|i
)braket
dot
id|size
op_assign
id|params-&gt;u1.s.pages_in_bank
(braket
id|i
)braket
op_star
id|params-&gt;u1.s.page_size
suffix:semicolon
)brace
id|meminfo.nr_banks
op_assign
l_int|4
suffix:semicolon
)brace
id|memc_ctrl_reg
op_assign
id|params-&gt;u1.s.memc_control_reg
suffix:semicolon
id|number_mfm_drives
op_assign
(paren
id|params-&gt;u1.s.adfsdrives
op_rshift
l_int|3
)paren
op_amp
l_int|3
suffix:semicolon
macro_line|#endif
)brace
r_static
r_void
id|__init
DECL|function|fixup_ebsa285
id|fixup_ebsa285
c_func
(paren
r_struct
id|machine_desc
op_star
id|desc
comma
r_struct
id|param_struct
op_star
id|params
comma
r_char
op_star
op_star
id|cmdline
)paren
(brace
id|ORIG_X
op_assign
id|params-&gt;u1.s.video_x
suffix:semicolon
id|ORIG_Y
op_assign
id|params-&gt;u1.s.video_y
suffix:semicolon
id|ORIG_VIDEO_COLS
op_assign
id|params-&gt;u1.s.video_num_cols
suffix:semicolon
id|ORIG_VIDEO_LINES
op_assign
id|params-&gt;u1.s.video_num_rows
suffix:semicolon
)brace
multiline_comment|/*&n; * Older NeTTroms either do not provide a parameters&n; * page, or they don&squot;t supply correct information in&n; * the parameter page.&n; */
r_static
r_void
id|__init
DECL|function|fixup_netwinder
id|fixup_netwinder
c_func
(paren
r_struct
id|machine_desc
op_star
id|desc
comma
r_struct
id|param_struct
op_star
id|params
comma
r_char
op_star
op_star
id|cmdline
)paren
(brace
r_if
c_cond
(paren
id|params-&gt;u1.s.nr_pages
op_ne
l_int|0x2000
op_logical_and
id|params-&gt;u1.s.nr_pages
op_ne
l_int|0x4000
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;Warning: bad NeTTrom parameters &quot;
l_string|&quot;detected, using defaults&bslash;n&quot;
)paren
suffix:semicolon
id|params-&gt;u1.s.nr_pages
op_assign
l_int|0x2000
suffix:semicolon
multiline_comment|/* 32MB */
id|params-&gt;u1.s.ramdisk_size
op_assign
l_int|0
suffix:semicolon
id|params-&gt;u1.s.flags
op_assign
id|FLAG_READONLY
suffix:semicolon
id|params-&gt;u1.s.initrd_start
op_assign
l_int|0
suffix:semicolon
id|params-&gt;u1.s.initrd_size
op_assign
l_int|0
suffix:semicolon
id|params-&gt;u1.s.rd_start
op_assign
l_int|0
suffix:semicolon
)brace
)brace
multiline_comment|/*&n; * CATS uses soft-reboot by default, since&n; * hard reboots fail on early boards.&n; */
r_static
r_void
id|__init
DECL|function|fixup_cats
id|fixup_cats
c_func
(paren
r_struct
id|machine_desc
op_star
id|desc
comma
r_struct
id|param_struct
op_star
id|params
comma
r_char
op_star
op_star
id|cmdline
)paren
(brace
id|ORIG_VIDEO_LINES
op_assign
l_int|25
suffix:semicolon
id|ORIG_VIDEO_POINTS
op_assign
l_int|16
suffix:semicolon
id|ORIG_Y
op_assign
l_int|24
suffix:semicolon
)brace
r_static
r_void
id|__init
DECL|function|fixup_coebsa285
id|fixup_coebsa285
c_func
(paren
r_struct
id|machine_desc
op_star
id|desc
comma
r_struct
id|param_struct
op_star
id|params
comma
r_char
op_star
op_star
id|cmdline
)paren
(brace
macro_line|#if 0
r_extern
r_int
r_int
id|boot_memory_end
suffix:semicolon
r_extern
r_char
id|boot_command_line
(braket
)braket
suffix:semicolon
id|meminfo.nr_banks
op_assign
l_int|1
suffix:semicolon
id|meminfo.bank
(braket
l_int|0
)braket
dot
id|start
op_assign
id|PHYS_OFFSET
suffix:semicolon
id|meminfo.bank
(braket
l_int|0
)braket
dot
id|size
op_assign
id|boot_memory_end
suffix:semicolon
op_star
id|cmdline
op_assign
id|boot_command_line
suffix:semicolon
macro_line|#endif
)brace
r_static
r_void
id|__init
DECL|function|fixup_sa1100
id|fixup_sa1100
c_func
(paren
r_struct
id|machine_desc
op_star
id|desc
comma
r_struct
id|param_struct
op_star
id|params
comma
r_char
op_star
op_star
id|cmdline
)paren
(brace
macro_line|#ifdef CONFIG_ARCH_SA1100
r_int
id|i
suffix:semicolon
r_extern
r_struct
id|mem_desc
(brace
r_int
r_int
id|phys_start
suffix:semicolon
r_int
r_int
id|length
suffix:semicolon
)brace
id|mem_desc
(braket
)braket
suffix:semicolon
r_extern
r_int
r_int
id|mem_desc_size
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|mem_desc_size
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|i
op_ge
id|NR_BANKS
)paren
(brace
id|printk
c_func
(paren
id|__FUNCTION__
l_string|&quot;: mem_desc too large for meminfo structure&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|meminfo.bank
(braket
id|i
)braket
dot
id|start
op_assign
id|mem_desc
(braket
id|i
)braket
dot
id|phys_start
suffix:semicolon
id|meminfo.bank
(braket
id|i
)braket
dot
id|size
op_assign
id|mem_desc
(braket
id|i
)braket
dot
id|length
suffix:semicolon
)brace
id|meminfo.nr_banks
op_assign
id|i
suffix:semicolon
macro_line|#if defined(CONFIG_SA1100_BRUTUS)
id|ROOT_DEV
op_assign
id|MKDEV
c_func
(paren
id|RAMDISK_MAJOR
comma
l_int|0
)paren
suffix:semicolon
id|setup_ramdisk
c_func
(paren
l_int|1
comma
l_int|0
comma
l_int|0
comma
l_int|8192
)paren
suffix:semicolon
id|setup_initrd
c_func
(paren
id|__phys_to_virt
c_func
(paren
l_int|0xd8000000
)paren
comma
l_int|0x00400000
)paren
suffix:semicolon
macro_line|#elif defined(CONFIG_SA1100_EMPEG)
id|ROOT_DEV
op_assign
id|MKDEV
c_func
(paren
l_int|3
comma
l_int|1
)paren
suffix:semicolon
multiline_comment|/* /dev/hda1 */
id|setup_ramdisk
c_func
(paren
l_int|1
comma
l_int|0
comma
l_int|0
comma
l_int|4096
)paren
suffix:semicolon
id|setup_initrd
c_func
(paren
l_int|0xd0000000
op_plus
(paren
(paren
l_int|1024
op_minus
l_int|320
)paren
op_star
l_int|1024
)paren
comma
(paren
l_int|320
op_star
l_int|1024
)paren
)paren
suffix:semicolon
macro_line|#elif defined(CONFIG_SA1100_TIFON)
id|ROOT_DEV
op_assign
id|MKDEV
c_func
(paren
id|UNNAMED_MAJOR
comma
l_int|0
)paren
suffix:semicolon
id|setup_ramdisk
c_func
(paren
l_int|1
comma
l_int|0
comma
l_int|0
comma
l_int|4096
)paren
suffix:semicolon
id|setup_initrd
c_func
(paren
l_int|0xd0000000
op_plus
l_int|0x1100004
comma
l_int|0x140000
)paren
suffix:semicolon
macro_line|#elif defined(CONFIG_SA1100_VICTOR)
id|ROOT_DEV
op_assign
id|MKDEV
c_func
(paren
l_int|60
comma
l_int|2
)paren
suffix:semicolon
multiline_comment|/* Get command line parameters passed from the loader (if any) */
r_if
c_cond
(paren
op_star
(paren
(paren
r_char
op_star
)paren
l_int|0xc0000000
)paren
)paren
(brace
id|strcpy
c_func
(paren
id|default_command_line
comma
(paren
(paren
r_char
op_star
)paren
l_int|0xc0000000
)paren
)paren
suffix:semicolon
)brace
multiline_comment|/* power off if any problem */
id|strcat
c_func
(paren
id|default_command_line
comma
l_string|&quot; panic=1&quot;
)paren
suffix:semicolon
macro_line|#elif defined(CONFIG_SA1100_LART)
id|ROOT_DEV
op_assign
id|MKDEV
c_func
(paren
id|RAMDISK_MAJOR
comma
l_int|0
)paren
suffix:semicolon
id|setup_ramdisk
c_func
(paren
l_int|1
comma
l_int|0
comma
l_int|0
comma
l_int|8192
)paren
suffix:semicolon
id|setup_initrd
c_func
(paren
l_int|0xc0400000
comma
l_int|0x00400000
)paren
suffix:semicolon
macro_line|#endif
macro_line|#endif
)brace
DECL|macro|NO_PARAMS
mdefine_line|#define NO_PARAMS&t;0
DECL|macro|NO_VIDEO
mdefine_line|#define NO_VIDEO&t;0, 0
multiline_comment|/*&n; * This is the list of all architectures supported by&n; * this kernel.  This should be integrated with the list&n; * in head-armv.S.&n; */
DECL|variable|__initdata
r_static
r_struct
id|machine_desc
id|machine_desc
(braket
)braket
id|__initdata
op_assign
(brace
(brace
l_string|&quot;EBSA110&quot;
comma
multiline_comment|/* RMK&t;&t;&t;*/
l_int|0x00000400
comma
id|NO_VIDEO
comma
l_int|1
comma
l_int|0
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|NULL
)brace
comma
(brace
l_string|&quot;Acorn-RiscPC&quot;
comma
multiline_comment|/* RMK&t;&t;&t;*/
l_int|0x10000100
comma
id|NO_VIDEO
comma
l_int|1
comma
l_int|1
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
id|fixup_acorn
)brace
comma
(brace
l_string|&quot;unknown&quot;
comma
id|NO_PARAMS
comma
id|NO_VIDEO
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|NULL
)brace
comma
(brace
l_string|&quot;FTV/PCI&quot;
comma
multiline_comment|/* Philip Blundell&t;*/
id|NO_PARAMS
comma
id|NO_VIDEO
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|NULL
)brace
comma
(brace
l_string|&quot;EBSA285&quot;
comma
multiline_comment|/* RMK&t;&t;&t;*/
l_int|0x00000100
comma
l_int|0x000a0000
comma
l_int|0x000bffff
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
id|fixup_ebsa285
)brace
comma
(brace
l_string|&quot;Rebel-NetWinder&quot;
comma
multiline_comment|/* RMK&t;&t;&t;*/
l_int|0x00000100
comma
l_int|0x000a0000
comma
l_int|0x000bffff
comma
l_int|1
comma
l_int|0
comma
l_int|1
comma
l_int|0
comma
l_int|0
comma
id|fixup_netwinder
)brace
comma
(brace
l_string|&quot;Chalice-CATS&quot;
comma
multiline_comment|/* Philip Blundell&t;*/
id|NO_PARAMS
comma
l_int|0x000a0000
comma
l_int|0x000bffff
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|1
comma
id|fixup_cats
)brace
comma
(brace
l_string|&quot;unknown-TBOX&quot;
comma
multiline_comment|/* Philip Blundell&t;*/
id|NO_PARAMS
comma
id|NO_VIDEO
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|NULL
)brace
comma
(brace
l_string|&quot;co-EBSA285&quot;
comma
multiline_comment|/* Mark van Doesburg&t;*/
id|NO_PARAMS
comma
id|NO_VIDEO
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
id|fixup_coebsa285
)brace
comma
(brace
l_string|&quot;CL-PS7110&quot;
comma
multiline_comment|/* Werner Almesberger&t;*/
id|NO_PARAMS
comma
id|NO_VIDEO
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|NULL
)brace
comma
(brace
l_string|&quot;Acorn-Archimedes&quot;
comma
multiline_comment|/* RMK/DAG&t;&t;*/
l_int|0x0207c000
comma
id|NO_VIDEO
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
id|fixup_acorn
)brace
comma
(brace
l_string|&quot;Acorn-A5000&quot;
comma
multiline_comment|/* RMK/PB&t;&t;*/
l_int|0x0207c000
comma
id|NO_VIDEO
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
id|fixup_acorn
)brace
comma
(brace
l_string|&quot;Etoile&quot;
comma
multiline_comment|/* Alex de Vries&t;*/
id|NO_PARAMS
comma
id|NO_VIDEO
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|NULL
)brace
comma
(brace
l_string|&quot;LaCie_NAS&quot;
comma
multiline_comment|/* Benjamin Herrenschmidt */
id|NO_PARAMS
comma
id|NO_VIDEO
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|NULL
)brace
comma
(brace
l_string|&quot;CL-PS7500&quot;
comma
multiline_comment|/* Philip Blundell&t;*/
id|NO_PARAMS
comma
id|NO_VIDEO
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|NULL
)brace
comma
(brace
l_string|&quot;Shark&quot;
comma
multiline_comment|/* Alexander Schulz&t;*/
id|NO_PARAMS
comma
multiline_comment|/* do you really mean 0x200000? */
l_int|0x06000000
comma
l_int|0x06000000
op_plus
l_int|0x00200000
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|NULL
)brace
comma
(brace
l_string|&quot;SA1100-based&quot;
comma
multiline_comment|/* Nicolas Pitre&t;*/
id|NO_PARAMS
comma
id|NO_VIDEO
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
id|fixup_sa1100
)brace
)brace
suffix:semicolon
DECL|function|setup_arch
r_void
id|__init
id|setup_arch
c_func
(paren
r_char
op_star
op_star
id|cmdline_p
)paren
(brace
r_struct
id|param_struct
op_star
id|params
op_assign
l_int|NULL
suffix:semicolon
r_struct
id|machine_desc
op_star
id|mdesc
suffix:semicolon
r_char
op_star
id|from
op_assign
id|default_command_line
suffix:semicolon
macro_line|#if defined(CONFIG_ARCH_ARC)
id|__machine_arch_type
op_assign
id|MACH_TYPE_ARCHIMEDES
suffix:semicolon
macro_line|#elif defined(CONFIG_ARCH_A5K)
id|__machine_arch_type
op_assign
id|MACH_TYPE_A5K
suffix:semicolon
macro_line|#endif
id|setup_processor
c_func
(paren
)paren
suffix:semicolon
id|ROOT_DEV
op_assign
id|MKDEV
c_func
(paren
l_int|0
comma
l_int|255
)paren
suffix:semicolon
id|mdesc
op_assign
id|machine_desc
op_plus
id|machine_arch_type
suffix:semicolon
id|machine_name
op_assign
id|mdesc-&gt;name
suffix:semicolon
r_if
c_cond
(paren
id|mdesc-&gt;broken_hlt
)paren
id|disable_hlt
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mdesc-&gt;soft_reboot
)paren
id|reboot_setup
c_func
(paren
l_string|&quot;s&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mdesc-&gt;param_offset
)paren
id|params
op_assign
id|phys_to_virt
c_func
(paren
id|mdesc-&gt;param_offset
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mdesc-&gt;fixup
)paren
id|mdesc
op_member_access_from_pointer
id|fixup
c_func
(paren
id|mdesc
comma
id|params
comma
op_amp
id|from
)paren
suffix:semicolon
r_if
c_cond
(paren
id|params
op_logical_and
id|params-&gt;u1.s.page_size
op_ne
id|PAGE_SIZE
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;Warning: bad configuration page, &quot;
l_string|&quot;trying to continue&bslash;n&quot;
)paren
suffix:semicolon
id|params
op_assign
l_int|NULL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|params
)paren
(brace
id|ROOT_DEV
op_assign
id|to_kdev_t
c_func
(paren
id|params-&gt;u1.s.rootdev
)paren
suffix:semicolon
id|system_rev
op_assign
id|params-&gt;u1.s.system_rev
suffix:semicolon
id|system_serial_low
op_assign
id|params-&gt;u1.s.system_serial_low
suffix:semicolon
id|system_serial_high
op_assign
id|params-&gt;u1.s.system_serial_high
suffix:semicolon
id|setup_ramdisk
c_func
(paren
(paren
id|params-&gt;u1.s.flags
op_amp
id|FLAG_RDLOAD
)paren
op_eq
l_int|0
comma
(paren
id|params-&gt;u1.s.flags
op_amp
id|FLAG_RDPROMPT
)paren
op_eq
l_int|0
comma
id|params-&gt;u1.s.rd_start
comma
id|params-&gt;u1.s.ramdisk_size
)paren
suffix:semicolon
id|setup_initrd
c_func
(paren
id|params-&gt;u1.s.initrd_start
comma
id|params-&gt;u1.s.initrd_size
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|params-&gt;u1.s.flags
op_amp
id|FLAG_READONLY
)paren
)paren
id|root_mountflags
op_and_assign
op_complement
id|MS_RDONLY
suffix:semicolon
id|from
op_assign
id|params-&gt;commandline
suffix:semicolon
)brace
r_if
c_cond
(paren
id|meminfo.nr_banks
op_eq
l_int|0
)paren
(brace
id|meminfo.nr_banks
op_assign
l_int|1
suffix:semicolon
id|meminfo.bank
(braket
l_int|0
)braket
dot
id|start
op_assign
id|PHYS_OFFSET
suffix:semicolon
r_if
c_cond
(paren
id|params
)paren
id|meminfo.bank
(braket
l_int|0
)braket
dot
id|size
op_assign
id|params-&gt;u1.s.nr_pages
op_lshift
id|PAGE_SHIFT
suffix:semicolon
r_else
id|meminfo.bank
(braket
l_int|0
)braket
dot
id|size
op_assign
id|MEM_SIZE
suffix:semicolon
)brace
id|init_mm.start_code
op_assign
(paren
r_int
r_int
)paren
op_amp
id|_text
suffix:semicolon
id|init_mm.end_code
op_assign
(paren
r_int
r_int
)paren
op_amp
id|_etext
suffix:semicolon
id|init_mm.end_data
op_assign
(paren
r_int
r_int
)paren
op_amp
id|_edata
suffix:semicolon
id|init_mm.brk
op_assign
(paren
r_int
r_int
)paren
op_amp
id|_end
suffix:semicolon
id|memcpy
c_func
(paren
id|saved_command_line
comma
id|from
comma
id|COMMAND_LINE_SIZE
)paren
suffix:semicolon
id|saved_command_line
(braket
id|COMMAND_LINE_SIZE
op_minus
l_int|1
)braket
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
id|parse_cmdline
c_func
(paren
id|cmdline_p
comma
id|from
)paren
suffix:semicolon
id|setup_bootmem
c_func
(paren
)paren
suffix:semicolon
id|request_standard_resources
c_func
(paren
id|mdesc
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_VT
macro_line|#if defined(CONFIG_VGA_CONSOLE)
id|conswitchp
op_assign
op_amp
id|vga_con
suffix:semicolon
macro_line|#elif defined(CONFIG_DUMMY_CONSOLE)
id|conswitchp
op_assign
op_amp
id|dummy_con
suffix:semicolon
macro_line|#endif
macro_line|#endif
)brace
DECL|function|get_cpuinfo
r_int
id|get_cpuinfo
c_func
(paren
r_char
op_star
id|buffer
)paren
(brace
r_char
op_star
id|p
op_assign
id|buffer
suffix:semicolon
id|p
op_add_assign
id|sprintf
c_func
(paren
id|p
comma
l_string|&quot;Processor&bslash;t: %s %s rev %d (%s)&bslash;n&quot;
comma
id|proc_info.manufacturer
comma
id|proc_info.cpu_name
comma
(paren
r_int
)paren
id|processor_id
op_amp
l_int|15
comma
id|elf_platform
)paren
suffix:semicolon
id|p
op_add_assign
id|sprintf
c_func
(paren
id|p
comma
l_string|&quot;BogoMIPS&bslash;t: %lu.%02lu&bslash;n&quot;
comma
(paren
id|loops_per_sec
op_plus
l_int|2500
)paren
op_div
l_int|500000
comma
(paren
(paren
id|loops_per_sec
op_plus
l_int|2500
)paren
op_div
l_int|5000
)paren
op_mod
l_int|100
)paren
suffix:semicolon
id|p
op_add_assign
id|sprintf
c_func
(paren
id|p
comma
l_string|&quot;Hardware&bslash;t: %s&bslash;n&quot;
comma
id|machine_name
)paren
suffix:semicolon
id|p
op_add_assign
id|sprintf
c_func
(paren
id|p
comma
l_string|&quot;Revision&bslash;t: %04x&bslash;n&quot;
comma
id|system_rev
)paren
suffix:semicolon
id|p
op_add_assign
id|sprintf
c_func
(paren
id|p
comma
l_string|&quot;Serial&bslash;t&bslash;t: %08x%08x&bslash;n&quot;
comma
id|system_serial_high
comma
id|system_serial_low
)paren
suffix:semicolon
r_return
id|p
op_minus
id|buffer
suffix:semicolon
)brace
eof
