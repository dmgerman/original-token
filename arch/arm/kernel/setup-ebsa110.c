multiline_comment|/*&n; *  linux/arch/arm/kernel/setup-sa.c&n; *&n; *  Copyright (C) 1995, 1996 Russell King&n; */
multiline_comment|/*&n; * This file obtains various parameters about the system that the kernel&n; * is running on.&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/errno.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/stddef.h&gt;
macro_line|#include &lt;linux/unistd.h&gt;
macro_line|#include &lt;linux/ptrace.h&gt;
macro_line|#include &lt;linux/malloc.h&gt;
macro_line|#include &lt;linux/ldt.h&gt;
macro_line|#include &lt;linux/user.h&gt;
macro_line|#include &lt;linux/a.out.h&gt;
macro_line|#include &lt;linux/tty.h&gt;
macro_line|#include &lt;linux/ioport.h&gt;
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/major.h&gt;
macro_line|#include &lt;linux/utsname.h&gt;
macro_line|#include &lt;asm/segment.h&gt;
macro_line|#include &lt;asm/system.h&gt;
macro_line|#include &lt;asm/hardware.h&gt;
macro_line|#include &lt;asm/pgtable.h&gt;
macro_line|#ifndef CONFIG_CMDLINE
DECL|macro|CONFIG_CMDLINE
mdefine_line|#define CONFIG_CMDLINE&t;&quot;root=nfs rw console=ttyS1,38400n8&quot;
macro_line|#endif
DECL|macro|MEM_SIZE
mdefine_line|#define MEM_SIZE&t;(16*1024*1024)
DECL|macro|COMMAND_LINE_SIZE
mdefine_line|#define COMMAND_LINE_SIZE 256
DECL|variable|aux_device_present
r_int
r_char
id|aux_device_present
suffix:semicolon
DECL|variable|arm_id
r_int
r_int
id|arm_id
suffix:semicolon
r_extern
r_int
id|root_mountflags
suffix:semicolon
r_extern
r_int
id|_etext
comma
id|_edata
comma
id|_end
suffix:semicolon
macro_line|#ifdef CONFIG_BLK_DEV_RAM
r_extern
r_int
id|rd_doload
suffix:semicolon
multiline_comment|/* 1 = load ramdisk, 0 = don&squot;t load */
r_extern
r_int
id|rd_prompt
suffix:semicolon
multiline_comment|/* 1 = prompt for ramdisk, 0 = don&squot;t prompt */
r_extern
r_int
id|rd_image_start
suffix:semicolon
multiline_comment|/* starting block # of image */
DECL|function|setup_ramdisk
r_static
r_inline
r_void
id|setup_ramdisk
(paren
r_void
)paren
(brace
id|rd_image_start
op_assign
l_int|0
suffix:semicolon
id|rd_prompt
op_assign
l_int|1
suffix:semicolon
id|rd_doload
op_assign
l_int|1
suffix:semicolon
)brace
macro_line|#else
DECL|macro|setup_ramdisk
mdefine_line|#define setup_ramdisk()&t;
macro_line|#endif
DECL|variable|default_command_line
r_static
r_char
id|default_command_line
(braket
)braket
op_assign
id|CONFIG_CMDLINE
suffix:semicolon
DECL|variable|command_line
r_static
r_char
id|command_line
(braket
id|COMMAND_LINE_SIZE
)braket
op_assign
(brace
l_int|0
comma
)brace
suffix:semicolon
DECL|variable|saved_command_line
r_char
id|saved_command_line
(braket
id|COMMAND_LINE_SIZE
)braket
suffix:semicolon
DECL|variable|processor
r_struct
id|processor
id|processor
suffix:semicolon
r_extern
r_const
r_struct
id|processor
id|sa110_processor_functions
suffix:semicolon
DECL|function|setup_arch
r_void
id|setup_arch
c_func
(paren
r_char
op_star
op_star
id|cmdline_p
comma
r_int
r_int
op_star
id|memory_start_p
comma
r_int
r_int
op_star
id|memory_end_p
)paren
(brace
r_int
r_int
id|memory_start
comma
id|memory_end
suffix:semicolon
r_char
id|c
op_assign
l_char|&squot; &squot;
comma
op_star
id|to
op_assign
id|command_line
comma
op_star
id|from
suffix:semicolon
r_int
id|len
op_assign
l_int|0
suffix:semicolon
id|memory_start
op_assign
(paren
r_int
r_int
)paren
op_amp
id|_end
suffix:semicolon
id|memory_end
op_assign
l_int|0xc0000000
op_plus
id|MEM_SIZE
suffix:semicolon
id|from
op_assign
id|default_command_line
suffix:semicolon
id|processor
op_assign
id|sa110_processor_functions
suffix:semicolon
id|processor._proc_init
(paren
)paren
suffix:semicolon
id|ROOT_DEV
op_assign
l_int|0x00ff
suffix:semicolon
id|setup_ramdisk
c_func
(paren
)paren
suffix:semicolon
id|init_task.mm-&gt;start_code
op_assign
id|TASK_SIZE
suffix:semicolon
id|init_task.mm-&gt;end_code
op_assign
id|TASK_SIZE
op_plus
(paren
r_int
r_int
)paren
op_amp
id|_etext
suffix:semicolon
id|init_task.mm-&gt;end_data
op_assign
id|TASK_SIZE
op_plus
(paren
r_int
r_int
)paren
op_amp
id|_edata
suffix:semicolon
id|init_task.mm-&gt;brk
op_assign
id|TASK_SIZE
op_plus
(paren
r_int
r_int
)paren
op_amp
id|_end
suffix:semicolon
multiline_comment|/* Save unparsed command line copy for /proc/cmdline */
id|memcpy
c_func
(paren
id|saved_command_line
comma
id|from
comma
id|COMMAND_LINE_SIZE
)paren
suffix:semicolon
id|saved_command_line
(braket
id|COMMAND_LINE_SIZE
op_minus
l_int|1
)braket
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
suffix:semicolon
)paren
(brace
r_if
c_cond
(paren
id|c
op_eq
l_char|&squot; &squot;
op_logical_and
id|from
(braket
l_int|0
)braket
op_eq
l_char|&squot;m&squot;
op_logical_and
id|from
(braket
l_int|1
)braket
op_eq
l_char|&squot;e&squot;
op_logical_and
id|from
(braket
l_int|2
)braket
op_eq
l_char|&squot;m&squot;
op_logical_and
id|from
(braket
l_int|3
)braket
op_eq
l_char|&squot;=&squot;
)paren
(brace
id|memory_end
op_assign
id|simple_strtoul
c_func
(paren
id|from
op_plus
l_int|4
comma
op_amp
id|from
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|from
op_eq
l_char|&squot;K&squot;
op_logical_or
op_star
id|from
op_eq
l_char|&squot;k&squot;
)paren
(brace
id|memory_end
op_assign
id|memory_end
op_lshift
l_int|10
suffix:semicolon
id|from
op_increment
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_star
id|from
op_eq
l_char|&squot;M&squot;
op_logical_or
op_star
id|from
op_eq
l_char|&squot;m&squot;
)paren
(brace
id|memory_end
op_assign
id|memory_end
op_lshift
l_int|20
suffix:semicolon
id|from
op_increment
suffix:semicolon
)brace
id|memory_end
op_assign
id|memory_end
op_plus
id|PAGE_OFFSET
suffix:semicolon
)brace
id|c
op_assign
op_star
id|from
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|c
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|COMMAND_LINE_SIZE
op_le
op_increment
id|len
)paren
r_break
suffix:semicolon
op_star
id|to
op_increment
op_assign
id|c
suffix:semicolon
)brace
op_star
id|to
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
op_star
id|cmdline_p
op_assign
id|command_line
suffix:semicolon
op_star
id|memory_start_p
op_assign
id|memory_start
suffix:semicolon
op_star
id|memory_end_p
op_assign
id|memory_end
suffix:semicolon
id|strcpy
(paren
id|system_utsname.machine
comma
l_string|&quot;sa110&quot;
)paren
suffix:semicolon
)brace
DECL|function|get_cpuinfo
r_int
id|get_cpuinfo
c_func
(paren
r_char
op_star
id|buffer
)paren
(brace
r_int
id|len
suffix:semicolon
id|len
op_assign
id|sprintf
(paren
id|buffer
comma
l_string|&quot;CPU:&bslash;n&quot;
l_string|&quot;Type&bslash;t&bslash;t: %s&bslash;n&quot;
l_string|&quot;Revision&bslash;t: %d&bslash;n&quot;
l_string|&quot;Manufacturer&bslash;t: %s&bslash;n&quot;
l_string|&quot;32bit modes&bslash;t: %s&bslash;n&quot;
l_string|&quot;BogoMips&bslash;t: %lu.%02lu&bslash;n&quot;
comma
l_string|&quot;sa110&quot;
comma
(paren
r_int
)paren
id|arm_id
op_amp
l_int|15
comma
l_string|&quot;DEC&quot;
comma
l_string|&quot;yes&quot;
comma
(paren
id|loops_per_sec
op_plus
l_int|2500
)paren
op_div
l_int|500000
comma
(paren
(paren
id|loops_per_sec
op_plus
l_int|2500
)paren
op_div
l_int|5000
)paren
op_mod
l_int|100
)paren
suffix:semicolon
r_return
id|len
suffix:semicolon
)brace
eof
