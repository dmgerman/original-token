multiline_comment|/* $Id: math.c,v 1.11 1999/12/20 05:02:25 davem Exp $&n; * arch/sparc64/math-emu/math.c&n; *&n; * Copyright (C) 1997,1999 Jakub Jelinek (jj@ultra.linux.cz)&n; * Copyright (C) 1999 David S. Miller (davem@redhat.com)&n; *&n; * Emulation routines originate from soft-fp package, which is part&n; * of glibc and has appropriate copyrights in it.&n; */
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;asm/fpumacro.h&gt;
macro_line|#include &lt;asm/ptrace.h&gt;
macro_line|#include &lt;asm/uaccess.h&gt;
macro_line|#include &quot;sfp-util.h&quot;
macro_line|#include &lt;math-emu/soft-fp.h&gt;
macro_line|#include &lt;math-emu/single.h&gt;
macro_line|#include &lt;math-emu/double.h&gt;
macro_line|#include &lt;math-emu/quad.h&gt;
multiline_comment|/* QUAD - ftt == 3 */
DECL|macro|FMOVQ
mdefine_line|#define FMOVQ&t;0x003
DECL|macro|FNEGQ
mdefine_line|#define FNEGQ&t;0x007
DECL|macro|FABSQ
mdefine_line|#define FABSQ&t;0x00b
DECL|macro|FSQRTQ
mdefine_line|#define FSQRTQ&t;0x02b
DECL|macro|FADDQ
mdefine_line|#define FADDQ&t;0x043
DECL|macro|FSUBQ
mdefine_line|#define FSUBQ&t;0x047
DECL|macro|FMULQ
mdefine_line|#define FMULQ&t;0x04b
DECL|macro|FDIVQ
mdefine_line|#define FDIVQ&t;0x04f
DECL|macro|FDMULQ
mdefine_line|#define FDMULQ&t;0x06e
DECL|macro|FQTOX
mdefine_line|#define FQTOX&t;0x083
DECL|macro|FXTOQ
mdefine_line|#define FXTOQ&t;0x08c
DECL|macro|FQTOS
mdefine_line|#define FQTOS&t;0x0c7
DECL|macro|FQTOD
mdefine_line|#define FQTOD&t;0x0cb
DECL|macro|FITOQ
mdefine_line|#define FITOQ&t;0x0cc
DECL|macro|FSTOQ
mdefine_line|#define FSTOQ&t;0x0cd
DECL|macro|FDTOQ
mdefine_line|#define FDTOQ&t;0x0ce
DECL|macro|FQTOI
mdefine_line|#define FQTOI&t;0x0d3
multiline_comment|/* SUBNORMAL - ftt == 2 */
DECL|macro|FSQRTS
mdefine_line|#define FSQRTS&t;0x029
DECL|macro|FSQRTD
mdefine_line|#define FSQRTD&t;0x02a
DECL|macro|FADDS
mdefine_line|#define FADDS&t;0x041
DECL|macro|FADDD
mdefine_line|#define FADDD&t;0x042
DECL|macro|FSUBS
mdefine_line|#define FSUBS&t;0x045
DECL|macro|FSUBD
mdefine_line|#define FSUBD&t;0x046
DECL|macro|FMULS
mdefine_line|#define FMULS&t;0x049
DECL|macro|FMULD
mdefine_line|#define FMULD&t;0x04a
DECL|macro|FDIVS
mdefine_line|#define FDIVS&t;0x04d
DECL|macro|FDIVD
mdefine_line|#define FDIVD&t;0x04e
DECL|macro|FSMULD
mdefine_line|#define FSMULD&t;0x069
DECL|macro|FSTOX
mdefine_line|#define FSTOX&t;0x081
DECL|macro|FDTOX
mdefine_line|#define FDTOX&t;0x082
DECL|macro|FDTOS
mdefine_line|#define FDTOS&t;0x0c6
DECL|macro|FSTOD
mdefine_line|#define FSTOD&t;0x0c9
DECL|macro|FSTOI
mdefine_line|#define FSTOI&t;0x0d1
DECL|macro|FDTOI
mdefine_line|#define FDTOI&t;0x0d2
multiline_comment|/* FPOP2 */
DECL|macro|FCMPQ
mdefine_line|#define FCMPQ&t;0x053
DECL|macro|FCMPEQ
mdefine_line|#define FCMPEQ&t;0x057
DECL|macro|FMOVQ0
mdefine_line|#define FMOVQ0&t;0x003
DECL|macro|FMOVQ1
mdefine_line|#define FMOVQ1&t;0x043
DECL|macro|FMOVQ2
mdefine_line|#define FMOVQ2&t;0x083
DECL|macro|FMOVQ3
mdefine_line|#define FMOVQ3&t;0x0c3
DECL|macro|FMOVQI
mdefine_line|#define FMOVQI&t;0x103
DECL|macro|FMOVQX
mdefine_line|#define FMOVQX&t;0x183
DECL|macro|FMOVQZ
mdefine_line|#define FMOVQZ&t;0x027
DECL|macro|FMOVQLE
mdefine_line|#define FMOVQLE&t;0x047
DECL|macro|FMOVQLZ
mdefine_line|#define FMOVQLZ 0x067
DECL|macro|FMOVQNZ
mdefine_line|#define FMOVQNZ&t;0x0a7
DECL|macro|FMOVQGZ
mdefine_line|#define FMOVQGZ&t;0x0c7
DECL|macro|FMOVQGE
mdefine_line|#define FMOVQGE 0x0e7
DECL|macro|FSR_TEM_SHIFT
mdefine_line|#define FSR_TEM_SHIFT&t;23UL
DECL|macro|FSR_TEM_MASK
mdefine_line|#define FSR_TEM_MASK&t;(0x1fUL &lt;&lt; FSR_TEM_SHIFT)
DECL|macro|FSR_AEXC_SHIFT
mdefine_line|#define FSR_AEXC_SHIFT&t;5UL
DECL|macro|FSR_AEXC_MASK
mdefine_line|#define FSR_AEXC_MASK&t;(0x1fUL &lt;&lt; FSR_AEXC_SHIFT)
DECL|macro|FSR_CEXC_SHIFT
mdefine_line|#define FSR_CEXC_SHIFT&t;0UL
DECL|macro|FSR_CEXC_MASK
mdefine_line|#define FSR_CEXC_MASK&t;(0x1fUL &lt;&lt; FSR_CEXC_SHIFT)
multiline_comment|/* All routines returning an exception to raise should detect&n; * such exceptions _before_ rounding to be consistant with&n; * the behavior of the hardware in the implemented cases&n; * (and thus with the recommendations in the V9 architecture&n; * manual).&n; *&n; * We return 0 if a SIGFPE should be sent, 1 otherwise.&n; */
DECL|function|record_exception
r_static
r_inline
r_int
id|record_exception
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
comma
r_int
id|eflag
)paren
(brace
id|u64
id|fsr
op_assign
id|current-&gt;thread.xfsr
(braket
l_int|0
)braket
suffix:semicolon
r_int
id|would_trap
suffix:semicolon
multiline_comment|/* Determine if this exception would have generated a trap. */
id|would_trap
op_assign
(paren
id|fsr
op_amp
(paren
(paren
r_int
)paren
id|eflag
op_lshift
id|FSR_TEM_SHIFT
)paren
)paren
op_ne
l_int|0UL
suffix:semicolon
multiline_comment|/* If trapping, we only want to signal one bit. */
r_if
c_cond
(paren
id|would_trap
op_ne
l_int|0
)paren
(brace
id|eflag
op_and_assign
(paren
(paren
id|fsr
op_amp
id|FSR_TEM_MASK
)paren
op_rshift
id|FSR_TEM_SHIFT
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|eflag
op_amp
(paren
id|eflag
op_minus
l_int|1
)paren
)paren
op_ne
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|eflag
op_amp
id|FP_EX_INVALID
)paren
(brace
id|eflag
op_assign
id|FP_EX_INVALID
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|eflag
op_amp
id|FP_EX_OVERFLOW
)paren
(brace
id|eflag
op_assign
id|FP_EX_OVERFLOW
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|eflag
op_amp
id|FP_EX_UNDERFLOW
)paren
(brace
id|eflag
op_assign
id|FP_EX_UNDERFLOW
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|eflag
op_amp
id|FP_EX_DIVZERO
)paren
(brace
id|eflag
op_assign
id|FP_EX_DIVZERO
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|eflag
op_amp
id|FP_EX_INEXACT
)paren
(brace
id|eflag
op_assign
id|FP_EX_INEXACT
suffix:semicolon
)brace
)brace
)brace
multiline_comment|/* Set CEXC, here is the rule:&n;&t; *&n;&t; *    In general all FPU ops will set one and only one&n;&t; *    bit in the CEXC field, this is always the case&n;&t; *    when the IEEE exception trap is enabled in TEM.&n;&t; */
id|fsr
op_and_assign
op_complement
(paren
id|FSR_CEXC_MASK
)paren
suffix:semicolon
id|fsr
op_or_assign
(paren
(paren
r_int
)paren
id|eflag
op_lshift
id|FSR_CEXC_SHIFT
)paren
suffix:semicolon
multiline_comment|/* Set the AEXC field, rule is:&n;&t; *&n;&t; *    If a trap would not be generated, the&n;&t; *    CEXC just generated is OR&squot;d into the&n;&t; *    existing value of AEXC.&n;&t; */
r_if
c_cond
(paren
id|would_trap
op_eq
l_int|0
)paren
(brace
id|fsr
op_or_assign
(paren
(paren
r_int
)paren
id|eflag
op_lshift
id|FSR_AEXC_SHIFT
)paren
suffix:semicolon
)brace
multiline_comment|/* If trapping, indicate fault trap type IEEE. */
r_if
c_cond
(paren
id|would_trap
op_ne
l_int|0
)paren
(brace
id|fsr
op_or_assign
(paren
l_int|1UL
op_lshift
l_int|14
)paren
suffix:semicolon
)brace
id|current-&gt;thread.xfsr
(braket
l_int|0
)braket
op_assign
id|fsr
suffix:semicolon
multiline_comment|/* If we will not trap, advance the program counter over&n;&t; * the instruction being handled.&n;&t; */
r_if
c_cond
(paren
id|would_trap
op_eq
l_int|0
)paren
(brace
id|regs-&gt;tpc
op_assign
id|regs-&gt;tnpc
suffix:semicolon
id|regs-&gt;tnpc
op_add_assign
l_int|4
suffix:semicolon
)brace
r_return
(paren
id|would_trap
ques
c_cond
l_int|0
suffix:colon
l_int|1
)paren
suffix:semicolon
)brace
r_typedef
r_union
(brace
DECL|member|s
id|u32
id|s
suffix:semicolon
DECL|member|d
id|u64
id|d
suffix:semicolon
DECL|member|q
id|u64
id|q
(braket
l_int|2
)braket
suffix:semicolon
DECL|typedef|argp
)brace
op_star
id|argp
suffix:semicolon
DECL|function|do_mathemu
r_int
id|do_mathemu
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
comma
r_struct
id|fpustate
op_star
id|f
)paren
(brace
r_int
r_int
id|pc
op_assign
id|regs-&gt;tpc
suffix:semicolon
r_int
r_int
id|tstate
op_assign
id|regs-&gt;tstate
suffix:semicolon
id|u32
id|insn
op_assign
l_int|0
suffix:semicolon
r_int
id|type
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* ftt tells which ftt it may happen in, r is rd, b is rs2 and a is rs1. The *u arg tells&n;&t;   whether the argument should be packed/unpacked (0 - do not unpack/pack, 1 - unpack/pack)&n;&t;   non-u args tells the size of the argument (0 - no argument, 1 - single, 2 - double, 3 - quad */
DECL|macro|TYPE
mdefine_line|#define TYPE(ftt, r, ru, b, bu, a, au) type = (au &lt;&lt; 2) | (a &lt;&lt; 0) | (bu &lt;&lt; 5) | (b &lt;&lt; 3) | (ru &lt;&lt; 8) | (r &lt;&lt; 6) | (ftt &lt;&lt; 9)
r_int
id|freg
suffix:semicolon
r_static
id|u64
id|zero
(braket
l_int|2
)braket
op_assign
(brace
l_int|0L
comma
l_int|0L
)brace
suffix:semicolon
r_int
id|flags
suffix:semicolon
id|FP_DECL_EX
suffix:semicolon
id|FP_DECL_S
c_func
(paren
id|SA
)paren
suffix:semicolon
id|FP_DECL_S
c_func
(paren
id|SB
)paren
suffix:semicolon
id|FP_DECL_S
c_func
(paren
id|SR
)paren
suffix:semicolon
id|FP_DECL_D
c_func
(paren
id|DA
)paren
suffix:semicolon
id|FP_DECL_D
c_func
(paren
id|DB
)paren
suffix:semicolon
id|FP_DECL_D
c_func
(paren
id|DR
)paren
suffix:semicolon
id|FP_DECL_Q
c_func
(paren
id|QA
)paren
suffix:semicolon
id|FP_DECL_Q
c_func
(paren
id|QB
)paren
suffix:semicolon
id|FP_DECL_Q
c_func
(paren
id|QR
)paren
suffix:semicolon
r_int
id|IR
suffix:semicolon
r_int
id|XR
comma
id|xfsr
suffix:semicolon
r_if
c_cond
(paren
id|tstate
op_amp
id|TSTATE_PRIV
)paren
(brace
id|die_if_kernel
c_func
(paren
l_string|&quot;FPQuad from kernel&quot;
comma
id|regs
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|current-&gt;thread.flags
op_amp
id|SPARC_FLAG_32BIT
)paren
(brace
id|pc
op_assign
(paren
id|u32
)paren
id|pc
suffix:semicolon
)brace
r_if
c_cond
(paren
id|get_user
c_func
(paren
id|insn
comma
(paren
id|u32
op_star
)paren
id|pc
)paren
op_ne
op_minus
id|EFAULT
)paren
(brace
r_if
c_cond
(paren
(paren
id|insn
op_amp
l_int|0xc1f80000
)paren
op_eq
l_int|0x81a00000
)paren
multiline_comment|/* FPOP1 */
(brace
r_switch
c_cond
(paren
(paren
id|insn
op_rshift
l_int|5
)paren
op_amp
l_int|0x1ff
)paren
(brace
multiline_comment|/* QUAD - ftt == 3 */
r_case
id|FMOVQ
suffix:colon
r_case
id|FNEGQ
suffix:colon
r_case
id|FABSQ
suffix:colon
id|TYPE
c_func
(paren
l_int|3
comma
l_int|3
comma
l_int|0
comma
l_int|3
comma
l_int|0
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FSQRTQ
suffix:colon
id|TYPE
c_func
(paren
l_int|3
comma
l_int|3
comma
l_int|1
comma
l_int|3
comma
l_int|1
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FADDQ
suffix:colon
r_case
id|FSUBQ
suffix:colon
r_case
id|FMULQ
suffix:colon
r_case
id|FDIVQ
suffix:colon
id|TYPE
c_func
(paren
l_int|3
comma
l_int|3
comma
l_int|1
comma
l_int|3
comma
l_int|1
comma
l_int|3
comma
l_int|1
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FDMULQ
suffix:colon
id|TYPE
c_func
(paren
l_int|3
comma
l_int|3
comma
l_int|1
comma
l_int|2
comma
l_int|1
comma
l_int|2
comma
l_int|1
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FQTOX
suffix:colon
id|TYPE
c_func
(paren
l_int|3
comma
l_int|2
comma
l_int|0
comma
l_int|3
comma
l_int|1
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FXTOQ
suffix:colon
id|TYPE
c_func
(paren
l_int|3
comma
l_int|3
comma
l_int|1
comma
l_int|2
comma
l_int|0
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FQTOS
suffix:colon
id|TYPE
c_func
(paren
l_int|3
comma
l_int|1
comma
l_int|1
comma
l_int|3
comma
l_int|1
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FQTOD
suffix:colon
id|TYPE
c_func
(paren
l_int|3
comma
l_int|2
comma
l_int|1
comma
l_int|3
comma
l_int|1
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FITOQ
suffix:colon
id|TYPE
c_func
(paren
l_int|3
comma
l_int|3
comma
l_int|1
comma
l_int|1
comma
l_int|0
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FSTOQ
suffix:colon
id|TYPE
c_func
(paren
l_int|3
comma
l_int|3
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FDTOQ
suffix:colon
id|TYPE
c_func
(paren
l_int|3
comma
l_int|3
comma
l_int|1
comma
l_int|2
comma
l_int|1
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FQTOI
suffix:colon
id|TYPE
c_func
(paren
l_int|3
comma
l_int|1
comma
l_int|0
comma
l_int|3
comma
l_int|1
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* SUBNORMAL - ftt == 2 */
r_case
id|FSQRTS
suffix:colon
id|TYPE
c_func
(paren
l_int|2
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FSQRTD
suffix:colon
id|TYPE
c_func
(paren
l_int|2
comma
l_int|2
comma
l_int|1
comma
l_int|2
comma
l_int|1
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FADDD
suffix:colon
r_case
id|FSUBD
suffix:colon
r_case
id|FMULD
suffix:colon
r_case
id|FDIVD
suffix:colon
id|TYPE
c_func
(paren
l_int|2
comma
l_int|2
comma
l_int|1
comma
l_int|2
comma
l_int|1
comma
l_int|2
comma
l_int|1
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FADDS
suffix:colon
r_case
id|FSUBS
suffix:colon
r_case
id|FMULS
suffix:colon
r_case
id|FDIVS
suffix:colon
id|TYPE
c_func
(paren
l_int|2
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FSMULD
suffix:colon
id|TYPE
c_func
(paren
l_int|2
comma
l_int|2
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FSTOX
suffix:colon
id|TYPE
c_func
(paren
l_int|2
comma
l_int|2
comma
l_int|0
comma
l_int|1
comma
l_int|1
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FDTOX
suffix:colon
id|TYPE
c_func
(paren
l_int|2
comma
l_int|2
comma
l_int|0
comma
l_int|2
comma
l_int|1
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FDTOS
suffix:colon
id|TYPE
c_func
(paren
l_int|2
comma
l_int|1
comma
l_int|1
comma
l_int|2
comma
l_int|1
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FSTOD
suffix:colon
id|TYPE
c_func
(paren
l_int|2
comma
l_int|2
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FSTOI
suffix:colon
id|TYPE
c_func
(paren
l_int|2
comma
l_int|1
comma
l_int|0
comma
l_int|1
comma
l_int|1
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FDTOI
suffix:colon
id|TYPE
c_func
(paren
l_int|2
comma
l_int|1
comma
l_int|0
comma
l_int|2
comma
l_int|1
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
(paren
id|insn
op_amp
l_int|0xc1f80000
)paren
op_eq
l_int|0x81a80000
)paren
multiline_comment|/* FPOP2 */
(brace
id|IR
op_assign
l_int|2
suffix:semicolon
r_switch
c_cond
(paren
(paren
id|insn
op_rshift
l_int|5
)paren
op_amp
l_int|0x1ff
)paren
(brace
r_case
id|FCMPQ
suffix:colon
id|TYPE
c_func
(paren
l_int|3
comma
l_int|0
comma
l_int|0
comma
l_int|3
comma
l_int|1
comma
l_int|3
comma
l_int|1
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FCMPEQ
suffix:colon
id|TYPE
c_func
(paren
l_int|3
comma
l_int|0
comma
l_int|0
comma
l_int|3
comma
l_int|1
comma
l_int|3
comma
l_int|1
)paren
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* Now the conditional fmovq support */
r_case
id|FMOVQ0
suffix:colon
r_case
id|FMOVQ1
suffix:colon
r_case
id|FMOVQ2
suffix:colon
r_case
id|FMOVQ3
suffix:colon
multiline_comment|/* fmovq %fccX, %fY, %fZ */
r_if
c_cond
(paren
op_logical_neg
(paren
(paren
id|insn
op_rshift
l_int|11
)paren
op_amp
l_int|3
)paren
)paren
id|XR
op_assign
id|current-&gt;thread.xfsr
(braket
l_int|0
)braket
op_rshift
l_int|10
suffix:semicolon
r_else
id|XR
op_assign
id|current-&gt;thread.xfsr
(braket
l_int|0
)braket
op_rshift
(paren
l_int|30
op_plus
(paren
(paren
id|insn
op_rshift
l_int|10
)paren
op_amp
l_int|0x6
)paren
)paren
suffix:semicolon
id|XR
op_and_assign
l_int|3
suffix:semicolon
id|IR
op_assign
l_int|0
suffix:semicolon
r_switch
c_cond
(paren
(paren
id|insn
op_rshift
l_int|14
)paren
op_amp
l_int|0x7
)paren
(brace
multiline_comment|/* case 0: IR = 0; break; */
multiline_comment|/* Never */
r_case
l_int|1
suffix:colon
r_if
c_cond
(paren
id|XR
)paren
id|IR
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* Not Equal */
r_case
l_int|2
suffix:colon
r_if
c_cond
(paren
id|XR
op_eq
l_int|1
op_logical_or
id|XR
op_eq
l_int|2
)paren
id|IR
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* Less or Greater */
r_case
l_int|3
suffix:colon
r_if
c_cond
(paren
id|XR
op_amp
l_int|1
)paren
id|IR
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* Unordered or Less */
r_case
l_int|4
suffix:colon
r_if
c_cond
(paren
id|XR
op_eq
l_int|1
)paren
id|IR
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* Less */
r_case
l_int|5
suffix:colon
r_if
c_cond
(paren
id|XR
op_amp
l_int|2
)paren
id|IR
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* Unordered or Greater */
r_case
l_int|6
suffix:colon
r_if
c_cond
(paren
id|XR
op_eq
l_int|2
)paren
id|IR
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* Greater */
r_case
l_int|7
suffix:colon
r_if
c_cond
(paren
id|XR
op_eq
l_int|3
)paren
id|IR
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* Unordered */
)brace
r_if
c_cond
(paren
(paren
id|insn
op_rshift
l_int|14
)paren
op_amp
l_int|8
)paren
id|IR
op_xor_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FMOVQI
suffix:colon
r_case
id|FMOVQX
suffix:colon
multiline_comment|/* fmovq %[ix]cc, %fY, %fZ */
id|XR
op_assign
id|regs-&gt;tstate
op_rshift
l_int|32
suffix:semicolon
r_if
c_cond
(paren
(paren
id|insn
op_rshift
l_int|5
)paren
op_amp
l_int|0x80
)paren
id|XR
op_rshift_assign
l_int|4
suffix:semicolon
id|XR
op_and_assign
l_int|0xf
suffix:semicolon
id|IR
op_assign
l_int|0
suffix:semicolon
id|freg
op_assign
(paren
(paren
id|XR
op_rshift
l_int|2
)paren
op_xor
id|XR
)paren
op_amp
l_int|2
suffix:semicolon
r_switch
c_cond
(paren
(paren
id|insn
op_rshift
l_int|14
)paren
op_amp
l_int|0x7
)paren
(brace
multiline_comment|/* case 0: IR = 0; break; */
multiline_comment|/* Never */
r_case
l_int|1
suffix:colon
r_if
c_cond
(paren
id|XR
op_amp
l_int|4
)paren
id|IR
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* Equal */
r_case
l_int|2
suffix:colon
r_if
c_cond
(paren
(paren
id|XR
op_amp
l_int|4
)paren
op_logical_or
id|freg
)paren
id|IR
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* Less or Equal */
r_case
l_int|3
suffix:colon
r_if
c_cond
(paren
id|freg
)paren
id|IR
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* Less */
r_case
l_int|4
suffix:colon
r_if
c_cond
(paren
id|XR
op_amp
l_int|5
)paren
id|IR
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* Less or Equal Unsigned */
r_case
l_int|5
suffix:colon
r_if
c_cond
(paren
id|XR
op_amp
l_int|1
)paren
id|IR
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* Carry Set */
r_case
l_int|6
suffix:colon
r_if
c_cond
(paren
id|XR
op_amp
l_int|8
)paren
id|IR
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* Negative */
r_case
l_int|7
suffix:colon
r_if
c_cond
(paren
id|XR
op_amp
l_int|2
)paren
id|IR
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* Overflow Set */
)brace
r_if
c_cond
(paren
(paren
id|insn
op_rshift
l_int|14
)paren
op_amp
l_int|8
)paren
id|IR
op_xor_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FMOVQZ
suffix:colon
r_case
id|FMOVQLE
suffix:colon
r_case
id|FMOVQLZ
suffix:colon
r_case
id|FMOVQNZ
suffix:colon
r_case
id|FMOVQGZ
suffix:colon
r_case
id|FMOVQGE
suffix:colon
id|freg
op_assign
(paren
id|insn
op_rshift
l_int|14
)paren
op_amp
l_int|0x1f
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|freg
)paren
id|XR
op_assign
l_int|0
suffix:semicolon
r_else
r_if
c_cond
(paren
id|freg
OL
l_int|16
)paren
id|XR
op_assign
id|regs-&gt;u_regs
(braket
id|freg
)braket
suffix:semicolon
r_else
r_if
c_cond
(paren
id|current-&gt;thread.flags
op_amp
id|SPARC_FLAG_32BIT
)paren
(brace
r_struct
id|reg_window32
op_star
id|win32
suffix:semicolon
id|flushw_user
(paren
)paren
suffix:semicolon
id|win32
op_assign
(paren
r_struct
id|reg_window32
op_star
)paren
(paren
(paren
r_int
r_int
)paren
(paren
(paren
id|u32
)paren
id|regs-&gt;u_regs
(braket
id|UREG_FP
)braket
)paren
)paren
suffix:semicolon
id|get_user
c_func
(paren
id|XR
comma
op_amp
id|win32-&gt;locals
(braket
id|freg
op_minus
l_int|16
)braket
)paren
suffix:semicolon
)brace
r_else
(brace
r_struct
id|reg_window
op_star
id|win
suffix:semicolon
id|flushw_user
(paren
)paren
suffix:semicolon
id|win
op_assign
(paren
r_struct
id|reg_window
op_star
)paren
(paren
id|regs-&gt;u_regs
(braket
id|UREG_FP
)braket
op_plus
id|STACK_BIAS
)paren
suffix:semicolon
id|get_user
c_func
(paren
id|XR
comma
op_amp
id|win-&gt;locals
(braket
id|freg
op_minus
l_int|16
)braket
)paren
suffix:semicolon
)brace
id|IR
op_assign
l_int|0
suffix:semicolon
r_switch
c_cond
(paren
(paren
id|insn
op_rshift
l_int|10
)paren
op_amp
l_int|3
)paren
(brace
r_case
l_int|1
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|XR
)paren
id|IR
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* Register Zero */
r_case
l_int|2
suffix:colon
r_if
c_cond
(paren
id|XR
op_le
l_int|0
)paren
id|IR
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* Register Less Than or Equal to Zero */
r_case
l_int|3
suffix:colon
r_if
c_cond
(paren
id|XR
OL
l_int|0
)paren
id|IR
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* Register Less Than Zero */
)brace
r_if
c_cond
(paren
(paren
id|insn
op_rshift
l_int|10
)paren
op_amp
l_int|4
)paren
id|IR
op_xor_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|IR
op_eq
l_int|0
)paren
(brace
multiline_comment|/* The fmov test was false. Do a nop instead */
id|current-&gt;thread.xfsr
(braket
l_int|0
)braket
op_and_assign
op_complement
(paren
id|FSR_CEXC_MASK
)paren
suffix:semicolon
id|regs-&gt;tpc
op_assign
id|regs-&gt;tnpc
suffix:semicolon
id|regs-&gt;tnpc
op_add_assign
l_int|4
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|IR
op_eq
l_int|1
)paren
(brace
multiline_comment|/* Change the instruction into plain fmovq */
id|insn
op_assign
(paren
id|insn
op_amp
l_int|0x3e00001f
)paren
op_or
l_int|0x81a00060
suffix:semicolon
id|TYPE
c_func
(paren
l_int|3
comma
l_int|3
comma
l_int|0
comma
l_int|3
comma
l_int|0
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
)brace
)brace
)brace
r_if
c_cond
(paren
id|type
)paren
(brace
id|argp
id|rs1
op_assign
l_int|NULL
comma
id|rs2
op_assign
l_int|NULL
comma
id|rd
op_assign
l_int|NULL
suffix:semicolon
id|freg
op_assign
(paren
id|current-&gt;thread.xfsr
(braket
l_int|0
)braket
op_rshift
l_int|14
)paren
op_amp
l_int|0xf
suffix:semicolon
r_if
c_cond
(paren
id|freg
op_ne
(paren
id|type
op_rshift
l_int|9
)paren
)paren
r_goto
id|err
suffix:semicolon
id|current-&gt;thread.xfsr
(braket
l_int|0
)braket
op_and_assign
op_complement
l_int|0x1c000
suffix:semicolon
id|freg
op_assign
(paren
(paren
id|insn
op_rshift
l_int|14
)paren
op_amp
l_int|0x1f
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|type
op_amp
l_int|0x3
)paren
(brace
r_case
l_int|3
suffix:colon
r_if
c_cond
(paren
id|freg
op_amp
l_int|2
)paren
(brace
id|current-&gt;thread.xfsr
(braket
l_int|0
)braket
op_or_assign
(paren
l_int|6
op_lshift
l_int|14
)paren
multiline_comment|/* invalid_fp_register */
suffix:semicolon
r_goto
id|err
suffix:semicolon
)brace
r_case
l_int|2
suffix:colon
id|freg
op_assign
(paren
(paren
id|freg
op_amp
l_int|1
)paren
op_lshift
l_int|5
)paren
op_or
(paren
id|freg
op_amp
l_int|0x1e
)paren
suffix:semicolon
r_case
l_int|1
suffix:colon
id|rs1
op_assign
(paren
id|argp
)paren
op_amp
id|f-&gt;regs
(braket
id|freg
)braket
suffix:semicolon
id|flags
op_assign
(paren
id|freg
OL
l_int|32
)paren
ques
c_cond
id|FPRS_DL
suffix:colon
id|FPRS_DU
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|current-&gt;thread.fpsaved
(braket
l_int|0
)braket
op_amp
id|flags
)paren
)paren
id|rs1
op_assign
(paren
id|argp
)paren
op_amp
id|zero
suffix:semicolon
r_break
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|type
op_amp
l_int|0x7
)paren
(brace
r_case
l_int|7
suffix:colon
id|FP_UNPACK_QP
(paren
id|QA
comma
id|rs1
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|6
suffix:colon
id|FP_UNPACK_DP
(paren
id|DA
comma
id|rs1
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
id|FP_UNPACK_SP
(paren
id|SA
comma
id|rs1
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|freg
op_assign
(paren
id|insn
op_amp
l_int|0x1f
)paren
suffix:semicolon
r_switch
c_cond
(paren
(paren
id|type
op_rshift
l_int|3
)paren
op_amp
l_int|0x3
)paren
(brace
r_case
l_int|3
suffix:colon
r_if
c_cond
(paren
id|freg
op_amp
l_int|2
)paren
(brace
id|current-&gt;thread.xfsr
(braket
l_int|0
)braket
op_or_assign
(paren
l_int|6
op_lshift
l_int|14
)paren
multiline_comment|/* invalid_fp_register */
suffix:semicolon
r_goto
id|err
suffix:semicolon
)brace
r_case
l_int|2
suffix:colon
id|freg
op_assign
(paren
(paren
id|freg
op_amp
l_int|1
)paren
op_lshift
l_int|5
)paren
op_or
(paren
id|freg
op_amp
l_int|0x1e
)paren
suffix:semicolon
r_case
l_int|1
suffix:colon
id|rs2
op_assign
(paren
id|argp
)paren
op_amp
id|f-&gt;regs
(braket
id|freg
)braket
suffix:semicolon
id|flags
op_assign
(paren
id|freg
OL
l_int|32
)paren
ques
c_cond
id|FPRS_DL
suffix:colon
id|FPRS_DU
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|current-&gt;thread.fpsaved
(braket
l_int|0
)braket
op_amp
id|flags
)paren
)paren
id|rs2
op_assign
(paren
id|argp
)paren
op_amp
id|zero
suffix:semicolon
r_break
suffix:semicolon
)brace
r_switch
c_cond
(paren
(paren
id|type
op_rshift
l_int|3
)paren
op_amp
l_int|0x7
)paren
(brace
r_case
l_int|7
suffix:colon
id|FP_UNPACK_QP
(paren
id|QB
comma
id|rs2
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|6
suffix:colon
id|FP_UNPACK_DP
(paren
id|DB
comma
id|rs2
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
id|FP_UNPACK_SP
(paren
id|SB
comma
id|rs2
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|freg
op_assign
(paren
(paren
id|insn
op_rshift
l_int|25
)paren
op_amp
l_int|0x1f
)paren
suffix:semicolon
r_switch
c_cond
(paren
(paren
id|type
op_rshift
l_int|6
)paren
op_amp
l_int|0x3
)paren
(brace
r_case
l_int|3
suffix:colon
r_if
c_cond
(paren
id|freg
op_amp
l_int|2
)paren
(brace
id|current-&gt;thread.xfsr
(braket
l_int|0
)braket
op_or_assign
(paren
l_int|6
op_lshift
l_int|14
)paren
multiline_comment|/* invalid_fp_register */
suffix:semicolon
r_goto
id|err
suffix:semicolon
)brace
r_case
l_int|2
suffix:colon
id|freg
op_assign
(paren
(paren
id|freg
op_amp
l_int|1
)paren
op_lshift
l_int|5
)paren
op_or
(paren
id|freg
op_amp
l_int|0x1e
)paren
suffix:semicolon
r_case
l_int|1
suffix:colon
id|rd
op_assign
(paren
id|argp
)paren
op_amp
id|f-&gt;regs
(braket
id|freg
)braket
suffix:semicolon
id|flags
op_assign
(paren
id|freg
OL
l_int|32
)paren
ques
c_cond
id|FPRS_DL
suffix:colon
id|FPRS_DU
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|current-&gt;thread.fpsaved
(braket
l_int|0
)braket
op_amp
id|FPRS_FEF
)paren
)paren
(brace
id|current-&gt;thread.fpsaved
(braket
l_int|0
)braket
op_assign
id|FPRS_FEF
suffix:semicolon
id|current-&gt;thread.gsr
(braket
l_int|0
)braket
op_assign
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|current-&gt;thread.fpsaved
(braket
l_int|0
)braket
op_amp
id|flags
)paren
)paren
(brace
r_if
c_cond
(paren
id|freg
OL
l_int|32
)paren
id|memset
c_func
(paren
id|f-&gt;regs
comma
l_int|0
comma
l_int|32
op_star
r_sizeof
(paren
id|u32
)paren
)paren
suffix:semicolon
r_else
id|memset
c_func
(paren
id|f-&gt;regs
op_plus
l_int|32
comma
l_int|0
comma
l_int|32
op_star
r_sizeof
(paren
id|u32
)paren
)paren
suffix:semicolon
)brace
id|current-&gt;thread.fpsaved
(braket
l_int|0
)braket
op_or_assign
id|flags
suffix:semicolon
r_break
suffix:semicolon
)brace
r_switch
c_cond
(paren
(paren
id|insn
op_rshift
l_int|5
)paren
op_amp
l_int|0x1ff
)paren
(brace
multiline_comment|/* + */
r_case
id|FADDS
suffix:colon
id|FP_ADD_S
(paren
id|SR
comma
id|SA
comma
id|SB
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FADDD
suffix:colon
id|FP_ADD_D
(paren
id|DR
comma
id|DA
comma
id|DB
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FADDQ
suffix:colon
id|FP_ADD_Q
(paren
id|QR
comma
id|QA
comma
id|QB
)paren
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* - */
r_case
id|FSUBS
suffix:colon
id|FP_SUB_S
(paren
id|SR
comma
id|SA
comma
id|SB
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FSUBD
suffix:colon
id|FP_SUB_D
(paren
id|DR
comma
id|DA
comma
id|DB
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FSUBQ
suffix:colon
id|FP_SUB_Q
(paren
id|QR
comma
id|QA
comma
id|QB
)paren
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* * */
r_case
id|FMULS
suffix:colon
id|FP_MUL_S
(paren
id|SR
comma
id|SA
comma
id|SB
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FSMULD
suffix:colon
id|FP_CONV
(paren
id|D
comma
id|S
comma
l_int|1
comma
l_int|1
comma
id|DA
comma
id|SA
)paren
suffix:semicolon
id|FP_CONV
(paren
id|D
comma
id|S
comma
l_int|1
comma
l_int|1
comma
id|DB
comma
id|SB
)paren
suffix:semicolon
r_case
id|FMULD
suffix:colon
id|FP_MUL_D
(paren
id|DR
comma
id|DA
comma
id|DB
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FDMULQ
suffix:colon
id|FP_CONV
(paren
id|Q
comma
id|D
comma
l_int|2
comma
l_int|1
comma
id|QA
comma
id|DA
)paren
suffix:semicolon
id|FP_CONV
(paren
id|Q
comma
id|D
comma
l_int|2
comma
l_int|1
comma
id|QB
comma
id|DB
)paren
suffix:semicolon
r_case
id|FMULQ
suffix:colon
id|FP_MUL_Q
(paren
id|QR
comma
id|QA
comma
id|QB
)paren
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* / */
r_case
id|FDIVS
suffix:colon
id|FP_DIV_S
(paren
id|SR
comma
id|SA
comma
id|SB
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FDIVD
suffix:colon
id|FP_DIV_D
(paren
id|DR
comma
id|DA
comma
id|DB
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FDIVQ
suffix:colon
id|FP_DIV_Q
(paren
id|QR
comma
id|QA
comma
id|QB
)paren
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* sqrt */
r_case
id|FSQRTS
suffix:colon
id|FP_SQRT_S
(paren
id|SR
comma
id|SB
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FSQRTD
suffix:colon
id|FP_SQRT_D
(paren
id|DR
comma
id|DB
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FSQRTQ
suffix:colon
id|FP_SQRT_Q
(paren
id|QR
comma
id|QB
)paren
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* mov */
r_case
id|FMOVQ
suffix:colon
id|rd-&gt;q
(braket
l_int|0
)braket
op_assign
id|rs2-&gt;q
(braket
l_int|0
)braket
suffix:semicolon
id|rd-&gt;q
(braket
l_int|1
)braket
op_assign
id|rs2-&gt;q
(braket
l_int|1
)braket
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FABSQ
suffix:colon
id|rd-&gt;q
(braket
l_int|0
)braket
op_assign
id|rs2-&gt;q
(braket
l_int|0
)braket
op_amp
l_int|0x7fffffffffffffffUL
suffix:semicolon
id|rd-&gt;q
(braket
l_int|1
)braket
op_assign
id|rs2-&gt;q
(braket
l_int|1
)braket
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FNEGQ
suffix:colon
id|rd-&gt;q
(braket
l_int|0
)braket
op_assign
id|rs2-&gt;q
(braket
l_int|0
)braket
op_xor
l_int|0x8000000000000000UL
suffix:semicolon
id|rd-&gt;q
(braket
l_int|1
)braket
op_assign
id|rs2-&gt;q
(braket
l_int|1
)braket
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* float to int */
r_case
id|FSTOI
suffix:colon
id|FP_TO_INT_S
(paren
id|IR
comma
id|SB
comma
l_int|32
comma
l_int|1
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FDTOI
suffix:colon
id|FP_TO_INT_D
(paren
id|IR
comma
id|DB
comma
l_int|32
comma
l_int|1
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FQTOI
suffix:colon
id|FP_TO_INT_Q
(paren
id|IR
comma
id|QB
comma
l_int|32
comma
l_int|1
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FSTOX
suffix:colon
id|FP_TO_INT_S
(paren
id|XR
comma
id|SB
comma
l_int|64
comma
l_int|1
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FDTOX
suffix:colon
id|FP_TO_INT_D
(paren
id|XR
comma
id|DB
comma
l_int|64
comma
l_int|1
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FQTOX
suffix:colon
id|FP_TO_INT_Q
(paren
id|XR
comma
id|QB
comma
l_int|64
comma
l_int|1
)paren
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* int to float */
r_case
id|FITOQ
suffix:colon
id|IR
op_assign
id|rs2-&gt;s
suffix:semicolon
id|FP_FROM_INT_Q
(paren
id|QR
comma
id|IR
comma
l_int|32
comma
r_int
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FXTOQ
suffix:colon
id|XR
op_assign
id|rs2-&gt;d
suffix:semicolon
id|FP_FROM_INT_Q
(paren
id|QR
comma
id|XR
comma
l_int|64
comma
r_int
)paren
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* float to float */
r_case
id|FSTOD
suffix:colon
id|FP_CONV
(paren
id|D
comma
id|S
comma
l_int|1
comma
l_int|1
comma
id|DR
comma
id|SB
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FSTOQ
suffix:colon
id|FP_CONV
(paren
id|Q
comma
id|S
comma
l_int|2
comma
l_int|1
comma
id|QR
comma
id|SB
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FDTOQ
suffix:colon
id|FP_CONV
(paren
id|Q
comma
id|D
comma
l_int|2
comma
l_int|1
comma
id|QR
comma
id|DB
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FDTOS
suffix:colon
id|FP_CONV
(paren
id|S
comma
id|D
comma
l_int|1
comma
l_int|1
comma
id|SR
comma
id|DB
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FQTOS
suffix:colon
id|FP_CONV
(paren
id|S
comma
id|Q
comma
l_int|1
comma
l_int|2
comma
id|SR
comma
id|QB
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FQTOD
suffix:colon
id|FP_CONV
(paren
id|D
comma
id|Q
comma
l_int|1
comma
l_int|2
comma
id|DR
comma
id|QB
)paren
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* comparison */
r_case
id|FCMPQ
suffix:colon
r_case
id|FCMPEQ
suffix:colon
id|FP_CMP_Q
c_func
(paren
id|XR
comma
id|QB
comma
id|QA
comma
l_int|3
)paren
suffix:semicolon
r_if
c_cond
(paren
id|XR
op_eq
l_int|3
op_logical_and
(paren
(paren
(paren
id|insn
op_rshift
l_int|5
)paren
op_amp
l_int|0x1ff
)paren
op_eq
id|FCMPEQ
op_logical_or
id|FP_ISSIGNAN_Q
c_func
(paren
id|QA
)paren
op_logical_or
id|FP_ISSIGNAN_Q
c_func
(paren
id|QB
)paren
)paren
)paren
id|FP_SET_EXCEPTION
(paren
id|FP_EX_INVALID
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|FP_INHIBIT_RESULTS
)paren
(brace
r_switch
c_cond
(paren
(paren
id|type
op_rshift
l_int|6
)paren
op_amp
l_int|0x7
)paren
(brace
r_case
l_int|0
suffix:colon
id|xfsr
op_assign
id|current-&gt;thread.xfsr
(braket
l_int|0
)braket
suffix:semicolon
r_if
c_cond
(paren
id|XR
op_eq
op_minus
l_int|1
)paren
id|XR
op_assign
l_int|2
suffix:semicolon
r_switch
c_cond
(paren
id|freg
op_amp
l_int|3
)paren
(brace
multiline_comment|/* fcc0, 1, 2, 3 */
r_case
l_int|0
suffix:colon
id|xfsr
op_and_assign
op_complement
l_int|0xc00
suffix:semicolon
id|xfsr
op_or_assign
(paren
id|XR
op_lshift
l_int|10
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|xfsr
op_and_assign
op_complement
l_int|0x300000000UL
suffix:semicolon
id|xfsr
op_or_assign
(paren
id|XR
op_lshift
l_int|32
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|xfsr
op_and_assign
op_complement
l_int|0xc00000000UL
suffix:semicolon
id|xfsr
op_or_assign
(paren
id|XR
op_lshift
l_int|34
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|xfsr
op_and_assign
op_complement
l_int|0x3000000000UL
suffix:semicolon
id|xfsr
op_or_assign
(paren
id|XR
op_lshift
l_int|36
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|current-&gt;thread.xfsr
(braket
l_int|0
)braket
op_assign
id|xfsr
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|rd-&gt;s
op_assign
id|IR
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|rd-&gt;d
op_assign
id|XR
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
id|FP_PACK_SP
(paren
id|rd
comma
id|SR
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|6
suffix:colon
id|FP_PACK_DP
(paren
id|rd
comma
id|DR
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|7
suffix:colon
id|FP_PACK_QP
(paren
id|rd
comma
id|QR
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|_fex
op_ne
l_int|0
)paren
(brace
r_return
id|record_exception
c_func
(paren
id|regs
comma
id|_fex
)paren
suffix:semicolon
)brace
multiline_comment|/* Success and no exceptions detected. */
id|current-&gt;thread.xfsr
(braket
l_int|0
)braket
op_and_assign
op_complement
(paren
id|FSR_CEXC_MASK
)paren
suffix:semicolon
id|regs-&gt;tpc
op_assign
id|regs-&gt;tnpc
suffix:semicolon
id|regs-&gt;tnpc
op_add_assign
l_int|4
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
id|err
suffix:colon
r_return
l_int|0
suffix:semicolon
)brace
eof
