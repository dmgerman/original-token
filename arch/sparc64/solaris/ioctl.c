multiline_comment|/* $Id: ioctl.c,v 1.16 2000/11/18 02:10:59 davem Exp $&n; * ioctl.c: Solaris ioctl emulation.&n; *&n; * Copyright (C) 1997 Jakub Jelinek (jj@sunsite.mff.cuni.cz)&n; * Copyright (C) 1997,1998 Patrik Rak (prak3264@ss1000.ms.mff.cuni.cz)&n; *&n; * Streams &amp; timod emulation based on code&n; * Copyright (C) 1995, 1996 Mike Jagdis (jaggy@purplet.demon.co.uk)&n; *&n; * 1999-08-19 Implemented solaris &squot;m&squot; (mag tape) and&n; *            &squot;O&squot; (openprom) ioctls, by Jason Rappleye&n; *             (rappleye@ccr.buffalo.edu)&n; */
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/smp.h&gt;
macro_line|#include &lt;linux/smp_lock.h&gt;
macro_line|#include &lt;linux/ioctl.h&gt;
macro_line|#include &lt;linux/fs.h&gt;
macro_line|#include &lt;linux/file.h&gt;
macro_line|#include &lt;linux/netdevice.h&gt;
macro_line|#include &lt;linux/mtio.h&gt;
macro_line|#include &lt;linux/time.h&gt;
macro_line|#include &lt;asm/uaccess.h&gt;
macro_line|#include &lt;asm/termios.h&gt;
macro_line|#include &lt;asm/openpromio.h&gt;
macro_line|#include &quot;conv.h&quot;
macro_line|#include &quot;socksys.h&quot;
r_extern
id|asmlinkage
r_int
id|sys_ioctl
c_func
(paren
r_int
r_int
id|fd
comma
r_int
r_int
id|cmd
comma
r_int
r_int
id|arg
)paren
suffix:semicolon
r_extern
id|asmlinkage
r_int
id|sys32_ioctl
c_func
(paren
r_int
r_int
id|fd
comma
r_int
r_int
id|cmd
comma
id|u32
id|arg
)paren
suffix:semicolon
id|asmlinkage
r_int
id|solaris_ioctl
c_func
(paren
r_int
r_int
id|fd
comma
r_int
r_int
id|cmd
comma
id|u32
id|arg
)paren
suffix:semicolon
r_extern
r_int
id|timod_putmsg
c_func
(paren
r_int
r_int
id|fd
comma
r_char
op_star
id|ctl_buf
comma
r_int
id|ctl_len
comma
r_char
op_star
id|data_buf
comma
r_int
id|data_len
comma
r_int
id|flags
)paren
suffix:semicolon
r_extern
r_int
id|timod_getmsg
c_func
(paren
r_int
r_int
id|fd
comma
r_char
op_star
id|ctl_buf
comma
r_int
id|ctl_maxlen
comma
r_int
op_star
id|ctl_len
comma
r_char
op_star
id|data_buf
comma
r_int
id|data_maxlen
comma
r_int
op_star
id|data_len
comma
r_int
op_star
id|flags
)paren
suffix:semicolon
multiline_comment|/* termio* stuff {{{ */
DECL|struct|solaris_termios
r_struct
id|solaris_termios
(brace
DECL|member|c_iflag
id|u32
id|c_iflag
suffix:semicolon
DECL|member|c_oflag
id|u32
id|c_oflag
suffix:semicolon
DECL|member|c_cflag
id|u32
id|c_cflag
suffix:semicolon
DECL|member|c_lflag
id|u32
id|c_lflag
suffix:semicolon
DECL|member|c_cc
id|u8
id|c_cc
(braket
l_int|19
)braket
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|solaris_termio
r_struct
id|solaris_termio
(brace
DECL|member|c_iflag
id|u16
id|c_iflag
suffix:semicolon
DECL|member|c_oflag
id|u16
id|c_oflag
suffix:semicolon
DECL|member|c_cflag
id|u16
id|c_cflag
suffix:semicolon
DECL|member|c_lflag
id|u16
id|c_lflag
suffix:semicolon
DECL|member|c_line
id|s8
id|c_line
suffix:semicolon
DECL|member|c_cc
id|u8
id|c_cc
(braket
l_int|8
)braket
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|solaris_termiox
r_struct
id|solaris_termiox
(brace
DECL|member|x_hflag
id|u16
id|x_hflag
suffix:semicolon
DECL|member|x_cflag
id|u16
id|x_cflag
suffix:semicolon
DECL|member|x_rflag
id|u16
id|x_rflag
(braket
l_int|5
)braket
suffix:semicolon
DECL|member|x_sflag
id|u16
id|x_sflag
suffix:semicolon
)brace
suffix:semicolon
DECL|function|solaris_to_linux_cflag
r_static
id|u32
id|solaris_to_linux_cflag
c_func
(paren
id|u32
id|cflag
)paren
(brace
id|cflag
op_and_assign
l_int|0x7fdff000
suffix:semicolon
r_if
c_cond
(paren
id|cflag
op_amp
l_int|0x200000
)paren
(brace
r_int
id|baud
op_assign
id|cflag
op_amp
l_int|0xf
suffix:semicolon
id|cflag
op_and_assign
op_complement
l_int|0x20000f
suffix:semicolon
r_switch
c_cond
(paren
id|baud
)paren
(brace
r_case
l_int|0
suffix:colon
id|baud
op_assign
id|B57600
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|baud
op_assign
id|B76800
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|baud
op_assign
id|B115200
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|baud
op_assign
id|B153600
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
id|baud
op_assign
id|B230400
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
id|baud
op_assign
id|B307200
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|6
suffix:colon
id|baud
op_assign
id|B460800
suffix:semicolon
r_break
suffix:semicolon
)brace
id|cflag
op_or_assign
id|CBAUDEX
op_or
id|baud
suffix:semicolon
)brace
r_return
id|cflag
suffix:semicolon
)brace
DECL|function|linux_to_solaris_cflag
r_static
id|u32
id|linux_to_solaris_cflag
c_func
(paren
id|u32
id|cflag
)paren
(brace
id|cflag
op_and_assign
op_complement
(paren
id|CMSPAR
op_or
id|CIBAUD
)paren
suffix:semicolon
r_if
c_cond
(paren
id|cflag
op_amp
id|CBAUDEX
)paren
(brace
r_int
id|baud
op_assign
id|cflag
op_amp
id|CBAUD
suffix:semicolon
id|cflag
op_and_assign
op_complement
id|CBAUD
suffix:semicolon
r_switch
c_cond
(paren
id|baud
)paren
(brace
r_case
id|B57600
suffix:colon
id|baud
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
id|B76800
suffix:colon
id|baud
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
id|B115200
suffix:colon
id|baud
op_assign
l_int|2
suffix:semicolon
r_break
suffix:semicolon
r_case
id|B153600
suffix:colon
id|baud
op_assign
l_int|3
suffix:semicolon
r_break
suffix:semicolon
r_case
id|B230400
suffix:colon
id|baud
op_assign
l_int|4
suffix:semicolon
r_break
suffix:semicolon
r_case
id|B307200
suffix:colon
id|baud
op_assign
l_int|5
suffix:semicolon
r_break
suffix:semicolon
r_case
id|B460800
suffix:colon
id|baud
op_assign
l_int|6
suffix:semicolon
r_break
suffix:semicolon
r_case
id|B614400
suffix:colon
id|baud
op_assign
l_int|7
suffix:semicolon
r_break
suffix:semicolon
r_case
id|B921600
suffix:colon
id|baud
op_assign
l_int|8
suffix:semicolon
r_break
suffix:semicolon
macro_line|#if 0&t;&t;
r_case
id|B1843200
suffix:colon
id|baud
op_assign
l_int|9
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
)brace
id|cflag
op_or_assign
l_int|0x200000
op_or
id|baud
suffix:semicolon
)brace
r_return
id|cflag
suffix:semicolon
)brace
DECL|function|linux_to_solaris_termio
r_static
r_inline
r_int
id|linux_to_solaris_termio
c_func
(paren
r_int
r_int
id|fd
comma
r_int
r_int
id|cmd
comma
id|u32
id|arg
)paren
(brace
r_int
id|ret
suffix:semicolon
id|ret
op_assign
id|sys_ioctl
c_func
(paren
id|fd
comma
id|cmd
comma
id|A
c_func
(paren
id|arg
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ret
)paren
(brace
id|u32
id|cflag
suffix:semicolon
r_if
c_cond
(paren
id|__get_user
(paren
id|cflag
comma
op_amp
(paren
(paren
r_struct
id|solaris_termio
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|c_cflag
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|cflag
op_assign
id|linux_to_solaris_cflag
c_func
(paren
id|cflag
)paren
suffix:semicolon
r_if
c_cond
(paren
id|__put_user
(paren
id|cflag
comma
op_amp
(paren
(paren
r_struct
id|solaris_termio
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|c_cflag
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
r_return
id|ret
suffix:semicolon
)brace
DECL|function|solaris_to_linux_termio
r_static
r_int
id|solaris_to_linux_termio
c_func
(paren
r_int
r_int
id|fd
comma
r_int
r_int
id|cmd
comma
id|u32
id|arg
)paren
(brace
r_int
id|ret
suffix:semicolon
r_struct
id|solaris_termio
id|s
suffix:semicolon
id|mm_segment_t
id|old_fs
op_assign
id|get_fs
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
(paren
op_amp
id|s
comma
(paren
r_struct
id|solaris_termio
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
comma
r_sizeof
(paren
r_struct
id|solaris_termio
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|s.c_cflag
op_assign
id|solaris_to_linux_cflag
c_func
(paren
id|s.c_cflag
)paren
suffix:semicolon
id|set_fs
c_func
(paren
id|KERNEL_DS
)paren
suffix:semicolon
id|ret
op_assign
id|sys_ioctl
c_func
(paren
id|fd
comma
id|cmd
comma
(paren
r_int
r_int
)paren
op_amp
id|s
)paren
suffix:semicolon
id|set_fs
c_func
(paren
id|old_fs
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|linux_to_solaris_termios
r_static
r_inline
r_int
id|linux_to_solaris_termios
c_func
(paren
r_int
r_int
id|fd
comma
r_int
r_int
id|cmd
comma
id|u32
id|arg
)paren
(brace
r_int
id|ret
suffix:semicolon
r_struct
id|solaris_termios
id|s
suffix:semicolon
id|mm_segment_t
id|old_fs
op_assign
id|get_fs
c_func
(paren
)paren
suffix:semicolon
id|set_fs
c_func
(paren
id|KERNEL_DS
)paren
suffix:semicolon
id|ret
op_assign
id|sys_ioctl
c_func
(paren
id|fd
comma
id|cmd
comma
(paren
r_int
r_int
)paren
op_amp
id|s
)paren
suffix:semicolon
id|set_fs
c_func
(paren
id|old_fs
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ret
)paren
(brace
r_if
c_cond
(paren
id|put_user
(paren
id|s.c_iflag
comma
op_amp
(paren
(paren
r_struct
id|solaris_termios
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|c_iflag
)paren
op_logical_or
id|__put_user
(paren
id|s.c_oflag
comma
op_amp
(paren
(paren
r_struct
id|solaris_termios
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|c_oflag
)paren
op_logical_or
id|__put_user
(paren
id|linux_to_solaris_cflag
c_func
(paren
id|s.c_cflag
)paren
comma
op_amp
(paren
(paren
r_struct
id|solaris_termios
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|c_cflag
)paren
op_logical_or
id|__put_user
(paren
id|s.c_lflag
comma
op_amp
(paren
(paren
r_struct
id|solaris_termios
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|c_lflag
)paren
op_logical_or
id|__copy_to_user
(paren
(paren
(paren
r_struct
id|solaris_termios
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|c_cc
comma
id|s.c_cc
comma
l_int|16
)paren
op_logical_or
id|__clear_user
(paren
(paren
(paren
r_struct
id|solaris_termios
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|c_cc
op_plus
l_int|16
comma
l_int|2
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
r_return
id|ret
suffix:semicolon
)brace
DECL|function|solaris_to_linux_termios
r_static
r_int
id|solaris_to_linux_termios
c_func
(paren
r_int
r_int
id|fd
comma
r_int
r_int
id|cmd
comma
id|u32
id|arg
)paren
(brace
r_int
id|ret
suffix:semicolon
r_struct
id|solaris_termios
id|s
suffix:semicolon
id|mm_segment_t
id|old_fs
op_assign
id|get_fs
c_func
(paren
)paren
suffix:semicolon
id|set_fs
c_func
(paren
id|KERNEL_DS
)paren
suffix:semicolon
id|ret
op_assign
id|sys_ioctl
c_func
(paren
id|fd
comma
id|TCGETS
comma
(paren
r_int
r_int
)paren
op_amp
id|s
)paren
suffix:semicolon
id|set_fs
c_func
(paren
id|old_fs
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
r_return
id|ret
suffix:semicolon
r_if
c_cond
(paren
id|put_user
(paren
id|s.c_iflag
comma
op_amp
(paren
(paren
r_struct
id|solaris_termios
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|c_iflag
)paren
op_logical_or
id|__put_user
(paren
id|s.c_oflag
comma
op_amp
(paren
(paren
r_struct
id|solaris_termios
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|c_oflag
)paren
op_logical_or
id|__put_user
(paren
id|s.c_cflag
comma
op_amp
(paren
(paren
r_struct
id|solaris_termios
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|c_cflag
)paren
op_logical_or
id|__put_user
(paren
id|s.c_lflag
comma
op_amp
(paren
(paren
r_struct
id|solaris_termios
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|c_lflag
)paren
op_logical_or
id|__copy_from_user
(paren
id|s.c_cc
comma
(paren
(paren
r_struct
id|solaris_termios
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|c_cc
comma
l_int|16
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|s.c_cflag
op_assign
id|solaris_to_linux_cflag
c_func
(paren
id|s.c_cflag
)paren
suffix:semicolon
id|set_fs
c_func
(paren
id|KERNEL_DS
)paren
suffix:semicolon
id|ret
op_assign
id|sys_ioctl
c_func
(paren
id|fd
comma
id|cmd
comma
(paren
r_int
r_int
)paren
op_amp
id|s
)paren
suffix:semicolon
id|set_fs
c_func
(paren
id|old_fs
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|solaris_T
r_static
r_inline
r_int
id|solaris_T
c_func
(paren
r_int
r_int
id|fd
comma
r_int
r_int
id|cmd
comma
id|u32
id|arg
)paren
(brace
r_switch
c_cond
(paren
id|cmd
op_amp
l_int|0xff
)paren
(brace
r_case
l_int|1
suffix:colon
multiline_comment|/* TCGETA */
r_return
id|linux_to_solaris_termio
c_func
(paren
id|fd
comma
id|TCGETA
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|2
suffix:colon
multiline_comment|/* TCSETA */
r_return
id|solaris_to_linux_termio
c_func
(paren
id|fd
comma
id|TCSETA
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|3
suffix:colon
multiline_comment|/* TCSETAW */
r_return
id|solaris_to_linux_termio
c_func
(paren
id|fd
comma
id|TCSETAW
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|4
suffix:colon
multiline_comment|/* TCSETAF */
r_return
id|solaris_to_linux_termio
c_func
(paren
id|fd
comma
id|TCSETAF
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|5
suffix:colon
multiline_comment|/* TCSBRK */
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|TCSBRK
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|6
suffix:colon
multiline_comment|/* TCXONC */
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|TCXONC
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|7
suffix:colon
multiline_comment|/* TCFLSH */
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|TCFLSH
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|13
suffix:colon
multiline_comment|/* TCGETS */
r_return
id|linux_to_solaris_termios
c_func
(paren
id|fd
comma
id|TCGETS
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|14
suffix:colon
multiline_comment|/* TCSETS */
r_return
id|solaris_to_linux_termios
c_func
(paren
id|fd
comma
id|TCSETS
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|15
suffix:colon
multiline_comment|/* TCSETSW */
r_return
id|solaris_to_linux_termios
c_func
(paren
id|fd
comma
id|TCSETSW
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|16
suffix:colon
multiline_comment|/* TCSETSF */
r_return
id|solaris_to_linux_termios
c_func
(paren
id|fd
comma
id|TCSETSF
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|103
suffix:colon
multiline_comment|/* TIOCSWINSZ */
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|TIOCSWINSZ
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|104
suffix:colon
multiline_comment|/* TIOCGWINSZ */
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|TIOCGWINSZ
comma
id|arg
)paren
suffix:semicolon
)brace
r_return
op_minus
id|ENOSYS
suffix:semicolon
)brace
DECL|function|solaris_t
r_static
r_inline
r_int
id|solaris_t
c_func
(paren
r_int
r_int
id|fd
comma
r_int
r_int
id|cmd
comma
id|u32
id|arg
)paren
(brace
r_switch
c_cond
(paren
id|cmd
op_amp
l_int|0xff
)paren
(brace
r_case
l_int|20
suffix:colon
multiline_comment|/* TIOCGPGRP */
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|TIOCGPGRP
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|21
suffix:colon
multiline_comment|/* TIOCSPGRP */
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|TIOCSPGRP
comma
id|arg
)paren
suffix:semicolon
)brace
r_return
op_minus
id|ENOSYS
suffix:semicolon
)brace
multiline_comment|/* }}} */
multiline_comment|/* A pseudo STREAMS support {{{ */
DECL|struct|strioctl
r_struct
id|strioctl
(brace
DECL|member|cmd
DECL|member|timeout
DECL|member|len
r_int
id|cmd
comma
id|timeout
comma
id|len
suffix:semicolon
DECL|member|data
id|u32
id|data
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|solaris_si_sockparams
r_struct
id|solaris_si_sockparams
(brace
DECL|member|sp_family
r_int
id|sp_family
suffix:semicolon
DECL|member|sp_type
r_int
id|sp_type
suffix:semicolon
DECL|member|sp_protocol
r_int
id|sp_protocol
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|solaris_o_si_udata
r_struct
id|solaris_o_si_udata
(brace
DECL|member|tidusize
r_int
id|tidusize
suffix:semicolon
DECL|member|addrsize
r_int
id|addrsize
suffix:semicolon
DECL|member|optsize
r_int
id|optsize
suffix:semicolon
DECL|member|etsdusize
r_int
id|etsdusize
suffix:semicolon
DECL|member|servtype
r_int
id|servtype
suffix:semicolon
DECL|member|so_state
r_int
id|so_state
suffix:semicolon
DECL|member|so_options
r_int
id|so_options
suffix:semicolon
DECL|member|tsdusize
r_int
id|tsdusize
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|solaris_si_udata
r_struct
id|solaris_si_udata
(brace
DECL|member|tidusize
r_int
id|tidusize
suffix:semicolon
DECL|member|addrsize
r_int
id|addrsize
suffix:semicolon
DECL|member|optsize
r_int
id|optsize
suffix:semicolon
DECL|member|etsdusize
r_int
id|etsdusize
suffix:semicolon
DECL|member|servtype
r_int
id|servtype
suffix:semicolon
DECL|member|so_state
r_int
id|so_state
suffix:semicolon
DECL|member|so_options
r_int
id|so_options
suffix:semicolon
DECL|member|tsdusize
r_int
id|tsdusize
suffix:semicolon
DECL|member|sockparams
r_struct
id|solaris_si_sockparams
id|sockparams
suffix:semicolon
)brace
suffix:semicolon
DECL|macro|SOLARIS_MODULE_TIMOD
mdefine_line|#define SOLARIS_MODULE_TIMOD    0
DECL|macro|SOLARIS_MODULE_SOCKMOD
mdefine_line|#define SOLARIS_MODULE_SOCKMOD  1
DECL|macro|SOLARIS_MODULE_MAX
mdefine_line|#define SOLARIS_MODULE_MAX      2
DECL|struct|module_info
r_static
r_struct
id|module_info
(brace
DECL|member|name
r_const
r_char
op_star
id|name
suffix:semicolon
multiline_comment|/* can be expanded further if needed */
DECL|variable|module_table
)brace
id|module_table
(braket
id|SOLARIS_MODULE_MAX
op_plus
l_int|1
)braket
op_assign
(brace
multiline_comment|/* the ordering here must match the module numbers above! */
(brace
l_string|&quot;timod&quot;
)brace
comma
(brace
l_string|&quot;sockmod&quot;
)brace
comma
(brace
l_int|NULL
)brace
)brace
suffix:semicolon
DECL|function|solaris_sockmod
r_static
r_inline
r_int
id|solaris_sockmod
c_func
(paren
r_int
r_int
id|fd
comma
r_int
r_int
id|cmd
comma
id|u32
id|arg
)paren
(brace
r_struct
id|inode
op_star
id|ino
suffix:semicolon
multiline_comment|/* I wonder which of these tests are superfluous... --patrik */
r_if
c_cond
(paren
op_logical_neg
id|current-&gt;files-&gt;fd
(braket
id|fd
)braket
op_logical_or
op_logical_neg
id|current-&gt;files-&gt;fd
(braket
id|fd
)braket
op_member_access_from_pointer
id|f_dentry
op_logical_or
op_logical_neg
(paren
id|ino
op_assign
id|current-&gt;files-&gt;fd
(braket
id|fd
)braket
op_member_access_from_pointer
id|f_dentry-&gt;d_inode
)paren
op_logical_or
op_logical_neg
id|ino-&gt;i_sock
)paren
r_return
id|TBADF
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
op_amp
l_int|0xff
)paren
(brace
r_case
l_int|109
suffix:colon
multiline_comment|/* SI_SOCKPARAMS */
(brace
r_struct
id|solaris_si_sockparams
id|si
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
(paren
op_amp
id|si
comma
(paren
r_struct
id|solaris_si_sockparams
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
comma
r_sizeof
(paren
id|si
)paren
)paren
)paren
r_return
(paren
id|EFAULT
op_lshift
l_int|8
)paren
op_or
id|TSYSERR
suffix:semicolon
multiline_comment|/* Should we modify socket ino-&gt;socket_i.ops and type? */
r_return
l_int|0
suffix:semicolon
)brace
r_case
l_int|110
suffix:colon
multiline_comment|/* SI_GETUDATA */
(brace
r_int
id|etsdusize
comma
id|servtype
suffix:semicolon
r_switch
c_cond
(paren
id|ino-&gt;u.socket_i.type
)paren
(brace
r_case
id|SOCK_STREAM
suffix:colon
id|etsdusize
op_assign
l_int|1
suffix:semicolon
id|servtype
op_assign
l_int|2
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|etsdusize
op_assign
op_minus
l_int|2
suffix:semicolon
id|servtype
op_assign
l_int|3
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|put_user
c_func
(paren
l_int|16384
comma
op_amp
(paren
(paren
r_struct
id|solaris_si_udata
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|tidusize
)paren
op_logical_or
id|__put_user
c_func
(paren
r_sizeof
(paren
r_struct
id|sockaddr
)paren
comma
op_amp
(paren
(paren
r_struct
id|solaris_si_udata
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|addrsize
)paren
op_logical_or
id|__put_user
c_func
(paren
op_minus
l_int|1
comma
op_amp
(paren
(paren
r_struct
id|solaris_si_udata
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|optsize
)paren
op_logical_or
id|__put_user
c_func
(paren
id|etsdusize
comma
op_amp
(paren
(paren
r_struct
id|solaris_si_udata
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|etsdusize
)paren
op_logical_or
id|__put_user
c_func
(paren
id|servtype
comma
op_amp
(paren
(paren
r_struct
id|solaris_si_udata
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|servtype
)paren
op_logical_or
id|__put_user
c_func
(paren
l_int|0
comma
op_amp
(paren
(paren
r_struct
id|solaris_si_udata
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|so_state
)paren
op_logical_or
id|__put_user
c_func
(paren
l_int|0
comma
op_amp
(paren
(paren
r_struct
id|solaris_si_udata
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|so_options
)paren
op_logical_or
id|__put_user
c_func
(paren
l_int|16384
comma
op_amp
(paren
(paren
r_struct
id|solaris_si_udata
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|tsdusize
)paren
op_logical_or
id|__put_user
c_func
(paren
id|ino-&gt;u.socket_i.ops-&gt;family
comma
op_amp
(paren
(paren
r_struct
id|solaris_si_udata
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|sockparams.sp_family
)paren
op_logical_or
id|__put_user
c_func
(paren
id|ino-&gt;u.socket_i.type
comma
op_amp
(paren
(paren
r_struct
id|solaris_si_udata
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|sockparams.sp_type
)paren
op_logical_or
id|__put_user
c_func
(paren
id|ino-&gt;u.socket_i.ops-&gt;family
comma
op_amp
(paren
(paren
r_struct
id|solaris_si_udata
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|sockparams.sp_protocol
)paren
)paren
r_return
(paren
id|EFAULT
op_lshift
l_int|8
)paren
op_or
id|TSYSERR
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_case
l_int|101
suffix:colon
multiline_comment|/* O_SI_GETUDATA */
(brace
r_int
id|etsdusize
comma
id|servtype
suffix:semicolon
r_switch
c_cond
(paren
id|ino-&gt;u.socket_i.type
)paren
(brace
r_case
id|SOCK_STREAM
suffix:colon
id|etsdusize
op_assign
l_int|1
suffix:semicolon
id|servtype
op_assign
l_int|2
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|etsdusize
op_assign
op_minus
l_int|2
suffix:semicolon
id|servtype
op_assign
l_int|3
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|put_user
c_func
(paren
l_int|16384
comma
op_amp
(paren
(paren
r_struct
id|solaris_o_si_udata
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|tidusize
)paren
op_logical_or
id|__put_user
c_func
(paren
r_sizeof
(paren
r_struct
id|sockaddr
)paren
comma
op_amp
(paren
(paren
r_struct
id|solaris_o_si_udata
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|addrsize
)paren
op_logical_or
id|__put_user
c_func
(paren
op_minus
l_int|1
comma
op_amp
(paren
(paren
r_struct
id|solaris_o_si_udata
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|optsize
)paren
op_logical_or
id|__put_user
c_func
(paren
id|etsdusize
comma
op_amp
(paren
(paren
r_struct
id|solaris_o_si_udata
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|etsdusize
)paren
op_logical_or
id|__put_user
c_func
(paren
id|servtype
comma
op_amp
(paren
(paren
r_struct
id|solaris_o_si_udata
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|servtype
)paren
op_logical_or
id|__put_user
c_func
(paren
l_int|0
comma
op_amp
(paren
(paren
r_struct
id|solaris_o_si_udata
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|so_state
)paren
op_logical_or
id|__put_user
c_func
(paren
l_int|0
comma
op_amp
(paren
(paren
r_struct
id|solaris_o_si_udata
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|so_options
)paren
op_logical_or
id|__put_user
c_func
(paren
l_int|16384
comma
op_amp
(paren
(paren
r_struct
id|solaris_o_si_udata
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|tsdusize
)paren
)paren
r_return
(paren
id|EFAULT
op_lshift
l_int|8
)paren
op_or
id|TSYSERR
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_case
l_int|102
suffix:colon
multiline_comment|/* SI_SHUTDOWN */
r_case
l_int|103
suffix:colon
multiline_comment|/* SI_LISTEN */
r_case
l_int|104
suffix:colon
multiline_comment|/* SI_SETMYNAME */
r_case
l_int|105
suffix:colon
multiline_comment|/* SI_SETPEERNAME */
r_case
l_int|106
suffix:colon
multiline_comment|/* SI_GETINTRANSIT */
r_case
l_int|107
suffix:colon
multiline_comment|/* SI_TCL_LINK */
r_case
l_int|108
suffix:colon
multiline_comment|/* SI_TCL_UNLINK */
)brace
r_return
id|TNOTSUPPORT
suffix:semicolon
)brace
DECL|function|solaris_timod
r_static
r_inline
r_int
id|solaris_timod
c_func
(paren
r_int
r_int
id|fd
comma
r_int
r_int
id|cmd
comma
id|u32
id|arg
comma
r_int
id|len
comma
r_int
op_star
id|len_p
)paren
(brace
r_int
id|ret
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
op_amp
l_int|0xff
)paren
(brace
r_case
l_int|141
suffix:colon
multiline_comment|/* TI_OPTMGMT */
(brace
r_int
id|i
suffix:semicolon
id|u32
id|prim
suffix:semicolon
id|SOLD
c_func
(paren
l_string|&quot;TI_OPMGMT entry&quot;
)paren
suffix:semicolon
id|ret
op_assign
id|timod_putmsg
c_func
(paren
id|fd
comma
(paren
r_char
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
comma
id|len
comma
l_int|NULL
comma
op_minus
l_int|1
comma
l_int|0
)paren
suffix:semicolon
id|SOLD
c_func
(paren
l_string|&quot;timod_putmsg() returned&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
r_return
(paren
op_minus
id|ret
op_lshift
l_int|8
)paren
op_or
id|TSYSERR
suffix:semicolon
id|i
op_assign
id|MSG_HIPRI
suffix:semicolon
id|SOLD
c_func
(paren
l_string|&quot;calling timod_getmsg()&quot;
)paren
suffix:semicolon
id|ret
op_assign
id|timod_getmsg
c_func
(paren
id|fd
comma
(paren
r_char
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
comma
id|len
comma
id|len_p
comma
l_int|NULL
comma
op_minus
l_int|1
comma
l_int|NULL
comma
op_amp
id|i
)paren
suffix:semicolon
id|SOLD
c_func
(paren
l_string|&quot;timod_getmsg() returned&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
r_return
(paren
op_minus
id|ret
op_lshift
l_int|8
)paren
op_or
id|TSYSERR
suffix:semicolon
id|SOLD
c_func
(paren
l_string|&quot;ret ok&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|get_user
c_func
(paren
id|prim
comma
(paren
id|u32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
)paren
r_return
(paren
id|EFAULT
op_lshift
l_int|8
)paren
op_or
id|TSYSERR
suffix:semicolon
id|SOLD
c_func
(paren
l_string|&quot;got prim&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|prim
op_eq
id|T_ERROR_ACK
)paren
(brace
id|u32
id|tmp
comma
id|tmp2
suffix:semicolon
id|SOLD
c_func
(paren
l_string|&quot;prim is T_ERROR_ACK&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|get_user
c_func
(paren
id|tmp
comma
(paren
id|u32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
op_plus
l_int|3
)paren
op_logical_or
id|get_user
c_func
(paren
id|tmp2
comma
(paren
id|u32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
op_plus
l_int|2
)paren
)paren
r_return
(paren
id|EFAULT
op_lshift
l_int|8
)paren
op_or
id|TSYSERR
suffix:semicolon
r_return
(paren
id|tmp2
op_lshift
l_int|8
)paren
op_or
id|tmp
suffix:semicolon
)brace
id|SOLD
c_func
(paren
l_string|&quot;TI_OPMGMT return 0&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_case
l_int|142
suffix:colon
multiline_comment|/* TI_BIND */
(brace
r_int
id|i
suffix:semicolon
id|u32
id|prim
suffix:semicolon
id|SOLD
c_func
(paren
l_string|&quot;TI_BIND entry&quot;
)paren
suffix:semicolon
id|ret
op_assign
id|timod_putmsg
c_func
(paren
id|fd
comma
(paren
r_char
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
comma
id|len
comma
l_int|NULL
comma
op_minus
l_int|1
comma
l_int|0
)paren
suffix:semicolon
id|SOLD
c_func
(paren
l_string|&quot;timod_putmsg() returned&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
r_return
(paren
op_minus
id|ret
op_lshift
l_int|8
)paren
op_or
id|TSYSERR
suffix:semicolon
id|len
op_assign
l_int|1024
suffix:semicolon
multiline_comment|/* Solaris allows arbitrary return size */
id|i
op_assign
id|MSG_HIPRI
suffix:semicolon
id|SOLD
c_func
(paren
l_string|&quot;calling timod_getmsg()&quot;
)paren
suffix:semicolon
id|ret
op_assign
id|timod_getmsg
c_func
(paren
id|fd
comma
(paren
r_char
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
comma
id|len
comma
id|len_p
comma
l_int|NULL
comma
op_minus
l_int|1
comma
l_int|NULL
comma
op_amp
id|i
)paren
suffix:semicolon
id|SOLD
c_func
(paren
l_string|&quot;timod_getmsg() returned&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
r_return
(paren
op_minus
id|ret
op_lshift
l_int|8
)paren
op_or
id|TSYSERR
suffix:semicolon
id|SOLD
c_func
(paren
l_string|&quot;ret ok&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|get_user
c_func
(paren
id|prim
comma
(paren
id|u32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
)paren
r_return
(paren
id|EFAULT
op_lshift
l_int|8
)paren
op_or
id|TSYSERR
suffix:semicolon
id|SOLD
c_func
(paren
l_string|&quot;got prim&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|prim
op_eq
id|T_ERROR_ACK
)paren
(brace
id|u32
id|tmp
comma
id|tmp2
suffix:semicolon
id|SOLD
c_func
(paren
l_string|&quot;prim is T_ERROR_ACK&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|get_user
c_func
(paren
id|tmp
comma
(paren
id|u32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
op_plus
l_int|3
)paren
op_logical_or
id|get_user
c_func
(paren
id|tmp2
comma
(paren
id|u32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
op_plus
l_int|2
)paren
)paren
r_return
(paren
id|EFAULT
op_lshift
l_int|8
)paren
op_or
id|TSYSERR
suffix:semicolon
r_return
(paren
id|tmp2
op_lshift
l_int|8
)paren
op_or
id|tmp
suffix:semicolon
)brace
id|SOLD
c_func
(paren
l_string|&quot;no ERROR_ACK requested&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|prim
op_ne
id|T_OK_ACK
)paren
r_return
id|TBADSEQ
suffix:semicolon
id|SOLD
c_func
(paren
l_string|&quot;OK_ACK requested&quot;
)paren
suffix:semicolon
id|i
op_assign
id|MSG_HIPRI
suffix:semicolon
id|SOLD
c_func
(paren
l_string|&quot;calling timod_getmsg()&quot;
)paren
suffix:semicolon
id|ret
op_assign
id|timod_getmsg
c_func
(paren
id|fd
comma
(paren
r_char
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
comma
id|len
comma
id|len_p
comma
l_int|NULL
comma
op_minus
l_int|1
comma
l_int|NULL
comma
op_amp
id|i
)paren
suffix:semicolon
id|SOLD
c_func
(paren
l_string|&quot;timod_getmsg() returned&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
r_return
(paren
op_minus
id|ret
op_lshift
l_int|8
)paren
op_or
id|TSYSERR
suffix:semicolon
id|SOLD
c_func
(paren
l_string|&quot;TI_BIND return ok&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_case
l_int|140
suffix:colon
multiline_comment|/* TI_GETINFO */
r_case
l_int|143
suffix:colon
multiline_comment|/* TI_UNBIND */
r_case
l_int|144
suffix:colon
multiline_comment|/* TI_GETMYNAME */
r_case
l_int|145
suffix:colon
multiline_comment|/* TI_GETPEERNAME */
r_case
l_int|146
suffix:colon
multiline_comment|/* TI_SETMYNAME */
r_case
l_int|147
suffix:colon
multiline_comment|/* TI_SETPEERNAME */
)brace
r_return
id|TNOTSUPPORT
suffix:semicolon
)brace
DECL|function|solaris_S
r_static
r_inline
r_int
id|solaris_S
c_func
(paren
r_struct
id|file
op_star
id|filp
comma
r_int
r_int
id|fd
comma
r_int
r_int
id|cmd
comma
id|u32
id|arg
)paren
(brace
r_char
op_star
id|p
suffix:semicolon
r_int
id|ret
suffix:semicolon
id|mm_segment_t
id|old_fs
suffix:semicolon
r_struct
id|strioctl
id|si
suffix:semicolon
r_struct
id|inode
op_star
id|ino
suffix:semicolon
r_struct
id|sol_socket_struct
op_star
id|sock
suffix:semicolon
r_struct
id|module_info
op_star
id|mi
suffix:semicolon
id|ino
op_assign
id|filp-&gt;f_dentry-&gt;d_inode
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ino-&gt;i_sock
)paren
r_return
op_minus
id|EBADF
suffix:semicolon
id|sock
op_assign
id|filp-&gt;private_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|sock
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;solaris_S: NULL private_data&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EBADF
suffix:semicolon
)brace
r_if
c_cond
(paren
id|sock-&gt;magic
op_ne
id|SOLARIS_SOCKET_MAGIC
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;solaris_S: invalid magic&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EBADF
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|cmd
op_amp
l_int|0xff
)paren
(brace
r_case
l_int|1
suffix:colon
multiline_comment|/* I_NREAD */
r_return
op_minus
id|ENOSYS
suffix:semicolon
r_case
l_int|2
suffix:colon
multiline_comment|/* I_PUSH */
(brace
id|p
op_assign
id|getname
(paren
(paren
r_char
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|IS_ERR
(paren
id|p
)paren
)paren
r_return
id|PTR_ERR
c_func
(paren
id|p
)paren
suffix:semicolon
id|ret
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_for
c_loop
(paren
id|mi
op_assign
id|module_table
suffix:semicolon
id|mi-&gt;name
suffix:semicolon
id|mi
op_increment
)paren
(brace
r_if
c_cond
(paren
id|strcmp
c_func
(paren
id|mi-&gt;name
comma
id|p
)paren
op_eq
l_int|0
)paren
(brace
id|sol_module
id|m
suffix:semicolon
r_if
c_cond
(paren
id|sock-&gt;modcount
op_ge
id|MAX_NR_STREAM_MODULES
)paren
(brace
id|ret
op_assign
op_minus
id|ENXIO
suffix:semicolon
r_break
suffix:semicolon
)brace
id|m
op_assign
(paren
id|sol_module
)paren
(paren
id|mi
op_minus
id|module_table
)paren
suffix:semicolon
id|sock-&gt;module
(braket
id|sock-&gt;modcount
op_increment
)braket
op_assign
id|m
suffix:semicolon
id|ret
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
id|putname
(paren
id|p
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
r_case
l_int|3
suffix:colon
multiline_comment|/* I_POP */
r_if
c_cond
(paren
id|sock-&gt;modcount
op_le
l_int|0
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|sock-&gt;modcount
op_decrement
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
l_int|4
suffix:colon
multiline_comment|/* I_LOOK */
(brace
r_const
r_char
op_star
id|p
suffix:semicolon
r_if
c_cond
(paren
id|sock-&gt;modcount
op_le
l_int|0
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|p
op_assign
id|module_table
(braket
(paren
r_int
)paren
id|sock-&gt;module
(braket
id|sock-&gt;modcount
)braket
)braket
dot
id|name
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
(paren
(paren
r_char
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
comma
id|p
comma
id|strlen
c_func
(paren
id|p
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_case
l_int|5
suffix:colon
multiline_comment|/* I_FLUSH */
r_return
l_int|0
suffix:semicolon
r_case
l_int|8
suffix:colon
multiline_comment|/* I_STR */
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|si
comma
(paren
r_struct
id|strioctl
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
comma
r_sizeof
(paren
r_struct
id|strioctl
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
multiline_comment|/* We ignore what module is actually at the top of stack. */
r_switch
c_cond
(paren
(paren
id|si.cmd
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
)paren
(brace
r_case
l_char|&squot;I&squot;
suffix:colon
r_return
id|solaris_sockmod
c_func
(paren
id|fd
comma
id|si.cmd
comma
id|si.data
)paren
suffix:semicolon
r_case
l_char|&squot;T&squot;
suffix:colon
r_return
id|solaris_timod
c_func
(paren
id|fd
comma
id|si.cmd
comma
id|si.data
comma
id|si.len
comma
op_amp
(paren
(paren
r_struct
id|strioctl
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|len
)paren
suffix:semicolon
r_default
suffix:colon
r_return
id|solaris_ioctl
c_func
(paren
id|fd
comma
id|si.cmd
comma
id|si.data
)paren
suffix:semicolon
)brace
r_case
l_int|9
suffix:colon
multiline_comment|/* I_SETSIG */
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|FIOSETOWN
comma
id|current-&gt;pid
)paren
suffix:semicolon
r_case
l_int|10
suffix:colon
multiline_comment|/* I_GETSIG */
id|old_fs
op_assign
id|get_fs
c_func
(paren
)paren
suffix:semicolon
id|set_fs
c_func
(paren
id|KERNEL_DS
)paren
suffix:semicolon
id|sys_ioctl
c_func
(paren
id|fd
comma
id|FIOGETOWN
comma
(paren
r_int
r_int
)paren
op_amp
id|ret
)paren
suffix:semicolon
id|set_fs
c_func
(paren
id|old_fs
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
op_eq
id|current-&gt;pid
)paren
r_return
l_int|0x3ff
suffix:semicolon
r_else
r_return
op_minus
id|EINVAL
suffix:semicolon
r_case
l_int|11
suffix:colon
multiline_comment|/* I_FIND */
(brace
r_int
id|i
suffix:semicolon
id|p
op_assign
id|getname
(paren
(paren
r_char
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|IS_ERR
(paren
id|p
)paren
)paren
r_return
id|PTR_ERR
c_func
(paren
id|p
)paren
suffix:semicolon
id|ret
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|sock-&gt;modcount
suffix:semicolon
id|i
op_increment
)paren
(brace
r_int
id|m
op_assign
id|sock-&gt;module
(braket
id|i
)braket
suffix:semicolon
r_if
c_cond
(paren
id|strcmp
c_func
(paren
id|module_table
(braket
id|m
)braket
dot
id|name
comma
id|p
)paren
op_eq
l_int|0
)paren
(brace
id|ret
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
id|putname
(paren
id|p
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
r_case
l_int|19
suffix:colon
multiline_comment|/* I_SWROPT */
r_case
l_int|32
suffix:colon
multiline_comment|/* I_SETCLTIME */
r_return
l_int|0
suffix:semicolon
multiline_comment|/* Lie */
)brace
r_return
op_minus
id|ENOSYS
suffix:semicolon
)brace
DECL|function|solaris_s
r_static
r_inline
r_int
id|solaris_s
c_func
(paren
r_int
r_int
id|fd
comma
r_int
r_int
id|cmd
comma
id|u32
id|arg
)paren
(brace
r_switch
c_cond
(paren
id|cmd
op_amp
l_int|0xff
)paren
(brace
r_case
l_int|0
suffix:colon
multiline_comment|/* SIOCSHIWAT */
r_case
l_int|2
suffix:colon
multiline_comment|/* SIOCSLOWAT */
r_return
l_int|0
suffix:semicolon
multiline_comment|/* We don&squot;t support them */
r_case
l_int|1
suffix:colon
multiline_comment|/* SIOCGHIWAT */
r_case
l_int|3
suffix:colon
multiline_comment|/* SIOCGLOWAT */
r_if
c_cond
(paren
id|put_user
(paren
l_int|0
comma
(paren
id|u32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
multiline_comment|/* Lie */
r_case
l_int|7
suffix:colon
multiline_comment|/* SIOCATMARK */
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|SIOCATMARK
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|8
suffix:colon
multiline_comment|/* SIOCSPGRP */
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|SIOCSPGRP
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|9
suffix:colon
multiline_comment|/* SIOCGPGRP */
r_return
id|sys_ioctl
c_func
(paren
id|fd
comma
id|SIOCGPGRP
comma
id|arg
)paren
suffix:semicolon
)brace
r_return
op_minus
id|ENOSYS
suffix:semicolon
)brace
DECL|function|solaris_r
r_static
r_inline
r_int
id|solaris_r
c_func
(paren
r_int
r_int
id|fd
comma
r_int
r_int
id|cmd
comma
id|u32
id|arg
)paren
(brace
r_switch
c_cond
(paren
id|cmd
op_amp
l_int|0xff
)paren
(brace
r_case
l_int|10
suffix:colon
multiline_comment|/* SIOCADDRT */
r_return
id|sys32_ioctl
c_func
(paren
id|fd
comma
id|SIOCADDRT
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|11
suffix:colon
multiline_comment|/* SIOCDELRT */
r_return
id|sys32_ioctl
c_func
(paren
id|fd
comma
id|SIOCDELRT
comma
id|arg
)paren
suffix:semicolon
)brace
r_return
op_minus
id|ENOSYS
suffix:semicolon
)brace
DECL|function|solaris_i
r_static
r_inline
r_int
id|solaris_i
c_func
(paren
r_int
r_int
id|fd
comma
r_int
r_int
id|cmd
comma
id|u32
id|arg
)paren
(brace
r_switch
c_cond
(paren
id|cmd
op_amp
l_int|0xff
)paren
(brace
r_case
l_int|12
suffix:colon
multiline_comment|/* SIOCSIFADDR */
r_return
id|sys32_ioctl
c_func
(paren
id|fd
comma
id|SIOCSIFADDR
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|13
suffix:colon
multiline_comment|/* SIOCGIFADDR */
r_return
id|sys32_ioctl
c_func
(paren
id|fd
comma
id|SIOCGIFADDR
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|14
suffix:colon
multiline_comment|/* SIOCSIFDSTADDR */
r_return
id|sys32_ioctl
c_func
(paren
id|fd
comma
id|SIOCSIFDSTADDR
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|15
suffix:colon
multiline_comment|/* SIOCGIFDSTADDR */
r_return
id|sys32_ioctl
c_func
(paren
id|fd
comma
id|SIOCGIFDSTADDR
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|16
suffix:colon
multiline_comment|/* SIOCSIFFLAGS */
r_return
id|sys32_ioctl
c_func
(paren
id|fd
comma
id|SIOCSIFFLAGS
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|17
suffix:colon
multiline_comment|/* SIOCGIFFLAGS */
r_return
id|sys32_ioctl
c_func
(paren
id|fd
comma
id|SIOCGIFFLAGS
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|18
suffix:colon
multiline_comment|/* SIOCSIFMEM */
r_return
id|sys32_ioctl
c_func
(paren
id|fd
comma
id|SIOCSIFMEM
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|19
suffix:colon
multiline_comment|/* SIOCGIFMEM */
r_return
id|sys32_ioctl
c_func
(paren
id|fd
comma
id|SIOCGIFMEM
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|20
suffix:colon
multiline_comment|/* SIOCGIFCONF */
r_return
id|sys32_ioctl
c_func
(paren
id|fd
comma
id|SIOCGIFCONF
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|21
suffix:colon
multiline_comment|/* SIOCSIFMTU */
r_return
id|sys32_ioctl
c_func
(paren
id|fd
comma
id|SIOCSIFMTU
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|22
suffix:colon
multiline_comment|/* SIOCGIFMTU */
r_return
id|sys32_ioctl
c_func
(paren
id|fd
comma
id|SIOCGIFMTU
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|23
suffix:colon
multiline_comment|/* SIOCGIFBRDADDR */
r_return
id|sys32_ioctl
c_func
(paren
id|fd
comma
id|SIOCGIFBRDADDR
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|24
suffix:colon
multiline_comment|/* SIOCSIFBRDADDR */
r_return
id|sys32_ioctl
c_func
(paren
id|fd
comma
id|SIOCSIFBRDADDR
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|25
suffix:colon
multiline_comment|/* SIOCGIFNETMASK */
r_return
id|sys32_ioctl
c_func
(paren
id|fd
comma
id|SIOCGIFNETMASK
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|26
suffix:colon
multiline_comment|/* SIOCSIFNETMASK */
r_return
id|sys32_ioctl
c_func
(paren
id|fd
comma
id|SIOCSIFNETMASK
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|27
suffix:colon
multiline_comment|/* SIOCGIFMETRIC */
r_return
id|sys32_ioctl
c_func
(paren
id|fd
comma
id|SIOCGIFMETRIC
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|28
suffix:colon
multiline_comment|/* SIOCSIFMETRIC */
r_return
id|sys32_ioctl
c_func
(paren
id|fd
comma
id|SIOCSIFMETRIC
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|30
suffix:colon
multiline_comment|/* SIOCSARP */
r_return
id|sys32_ioctl
c_func
(paren
id|fd
comma
id|SIOCSARP
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|31
suffix:colon
multiline_comment|/* SIOCGARP */
r_return
id|sys32_ioctl
c_func
(paren
id|fd
comma
id|SIOCGARP
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|32
suffix:colon
multiline_comment|/* SIOCDARP */
r_return
id|sys32_ioctl
c_func
(paren
id|fd
comma
id|SIOCDARP
comma
id|arg
)paren
suffix:semicolon
r_case
l_int|52
suffix:colon
multiline_comment|/* SIOCGETNAME */
r_case
l_int|53
suffix:colon
multiline_comment|/* SIOCGETPEER */
(brace
r_struct
id|sockaddr
id|uaddr
suffix:semicolon
r_int
id|uaddr_len
op_assign
r_sizeof
(paren
r_struct
id|sockaddr
)paren
comma
id|ret
suffix:semicolon
r_int
id|args
(braket
l_int|3
)braket
suffix:semicolon
id|mm_segment_t
id|old_fs
op_assign
id|get_fs
c_func
(paren
)paren
suffix:semicolon
r_int
(paren
op_star
id|sys_socketcall
)paren
(paren
r_int
comma
r_int
r_int
op_star
)paren
op_assign
(paren
r_int
(paren
op_star
)paren
(paren
r_int
comma
r_int
r_int
op_star
)paren
)paren
id|SYS
c_func
(paren
id|socketcall
)paren
suffix:semicolon
id|args
(braket
l_int|0
)braket
op_assign
id|fd
suffix:semicolon
id|args
(braket
l_int|1
)braket
op_assign
(paren
r_int
)paren
op_amp
id|uaddr
suffix:semicolon
id|args
(braket
l_int|2
)braket
op_assign
(paren
r_int
)paren
op_amp
id|uaddr_len
suffix:semicolon
id|set_fs
c_func
(paren
id|KERNEL_DS
)paren
suffix:semicolon
id|ret
op_assign
id|sys_socketcall
c_func
(paren
(paren
(paren
id|cmd
op_amp
l_int|0xff
)paren
op_eq
l_int|52
)paren
ques
c_cond
id|SYS_GETSOCKNAME
suffix:colon
id|SYS_GETPEERNAME
comma
id|args
)paren
suffix:semicolon
id|set_fs
c_func
(paren
id|old_fs
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
op_ge
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
(paren
r_char
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
comma
op_amp
id|uaddr
comma
id|uaddr_len
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
r_return
id|ret
suffix:semicolon
)brace
macro_line|#if 0&t;&t;
r_case
l_int|86
suffix:colon
multiline_comment|/* SIOCSOCKSYS */
r_return
id|socksys_syscall
c_func
(paren
id|fd
comma
id|arg
)paren
suffix:semicolon
macro_line|#endif&t;&t;
r_case
l_int|87
suffix:colon
multiline_comment|/* SIOCGIFNUM */
(brace
r_struct
id|net_device
op_star
id|d
suffix:semicolon
r_int
id|i
op_assign
l_int|0
suffix:semicolon
id|read_lock_bh
c_func
(paren
op_amp
id|dev_base_lock
)paren
suffix:semicolon
r_for
c_loop
(paren
id|d
op_assign
id|dev_base
suffix:semicolon
id|d
suffix:semicolon
id|d
op_assign
id|d-&gt;next
)paren
id|i
op_increment
suffix:semicolon
id|read_unlock_bh
c_func
(paren
op_amp
id|dev_base_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|put_user
(paren
id|i
comma
(paren
r_int
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
)brace
r_return
op_minus
id|ENOSYS
suffix:semicolon
)brace
DECL|function|solaris_m
r_static
r_int
id|solaris_m
c_func
(paren
r_int
r_int
id|fd
comma
r_int
r_int
id|cmd
comma
id|u32
id|arg
)paren
(brace
r_int
id|ret
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
op_amp
l_int|0xff
)paren
(brace
r_case
l_int|1
suffix:colon
multiline_comment|/* MTIOCTOP */
id|ret
op_assign
id|sys_ioctl
c_func
(paren
id|fd
comma
id|MTIOCTOP
comma
(paren
r_int
r_int
)paren
op_amp
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
multiline_comment|/* MTIOCGET */
id|ret
op_assign
id|sys_ioctl
c_func
(paren
id|fd
comma
id|MTIOCGET
comma
(paren
r_int
r_int
)paren
op_amp
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
multiline_comment|/* MTIOCGETDRIVETYPE */
r_case
l_int|4
suffix:colon
multiline_comment|/* MTIOCPERSISTENT */
r_case
l_int|5
suffix:colon
multiline_comment|/* MTIOCPERSISTENTSTATUS */
r_case
l_int|6
suffix:colon
multiline_comment|/* MTIOCLRERR */
r_case
l_int|7
suffix:colon
multiline_comment|/* MTIOCGUARANTEEDORDER */
r_case
l_int|8
suffix:colon
multiline_comment|/* MTIOCRESERVE */
r_case
l_int|9
suffix:colon
multiline_comment|/* MTIOCRELEASE */
r_case
l_int|10
suffix:colon
multiline_comment|/* MTIOCFORCERESERVE */
r_case
l_int|13
suffix:colon
multiline_comment|/* MTIOCSTATE */
r_case
l_int|14
suffix:colon
multiline_comment|/* MTIOCREADIGNOREILI */
r_case
l_int|15
suffix:colon
multiline_comment|/* MTIOCREADIGNOREEOFS */
r_case
l_int|16
suffix:colon
multiline_comment|/* MTIOCSHORTFMK */
r_default
suffix:colon
id|ret
op_assign
op_minus
id|ENOSYS
suffix:semicolon
multiline_comment|/* linux doesn&squot;t support these */
r_break
suffix:semicolon
)brace
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|solaris_O
r_static
r_int
id|solaris_O
c_func
(paren
r_int
r_int
id|fd
comma
r_int
r_int
id|cmd
comma
id|u32
id|arg
)paren
(brace
r_int
id|ret
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
op_amp
l_int|0xff
)paren
(brace
r_case
l_int|1
suffix:colon
multiline_comment|/* OPROMGETOPT */
id|ret
op_assign
id|sys_ioctl
c_func
(paren
id|fd
comma
id|OPROMGETOPT
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
multiline_comment|/* OPROMSETOPT */
id|ret
op_assign
id|sys_ioctl
c_func
(paren
id|fd
comma
id|OPROMSETOPT
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
multiline_comment|/* OPROMNXTOPT */
id|ret
op_assign
id|sys_ioctl
c_func
(paren
id|fd
comma
id|OPROMNXTOPT
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
multiline_comment|/* OPROMSETOPT2 */
id|ret
op_assign
id|sys_ioctl
c_func
(paren
id|fd
comma
id|OPROMSETOPT2
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
multiline_comment|/* OPROMNEXT */
id|ret
op_assign
id|sys_ioctl
c_func
(paren
id|fd
comma
id|OPROMNEXT
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|6
suffix:colon
multiline_comment|/* OPROMCHILD */
id|ret
op_assign
id|sys_ioctl
c_func
(paren
id|fd
comma
id|OPROMCHILD
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|7
suffix:colon
multiline_comment|/* OPROMGETPROP */
id|ret
op_assign
id|sys_ioctl
c_func
(paren
id|fd
comma
id|OPROMGETPROP
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|8
suffix:colon
multiline_comment|/* OPROMNXTPROP */
id|ret
op_assign
id|sys_ioctl
c_func
(paren
id|fd
comma
id|OPROMNXTPROP
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|9
suffix:colon
multiline_comment|/* OPROMU2P */
id|ret
op_assign
id|sys_ioctl
c_func
(paren
id|fd
comma
id|OPROMU2P
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|10
suffix:colon
multiline_comment|/* OPROMGETCONS */
id|ret
op_assign
id|sys_ioctl
c_func
(paren
id|fd
comma
id|OPROMGETCONS
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|11
suffix:colon
multiline_comment|/* OPROMGETFBNAME */
id|ret
op_assign
id|sys_ioctl
c_func
(paren
id|fd
comma
id|OPROMGETFBNAME
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|12
suffix:colon
multiline_comment|/* OPROMGETBOOTARGS */
id|ret
op_assign
id|sys_ioctl
c_func
(paren
id|fd
comma
id|OPROMGETBOOTARGS
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|13
suffix:colon
multiline_comment|/* OPROMGETVERSION */
r_case
l_int|14
suffix:colon
multiline_comment|/* OPROMPATH2DRV */
r_case
l_int|15
suffix:colon
multiline_comment|/* OPROMDEV2PROMNAME */
r_case
l_int|16
suffix:colon
multiline_comment|/* OPROMPROM2DEVNAME */
r_case
l_int|17
suffix:colon
multiline_comment|/* OPROMGETPROPLEN */
r_default
suffix:colon
id|ret
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_break
suffix:semicolon
)brace
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
multiline_comment|/* }}} */
DECL|function|solaris_ioctl
id|asmlinkage
r_int
id|solaris_ioctl
c_func
(paren
r_int
r_int
id|fd
comma
r_int
r_int
id|cmd
comma
id|u32
id|arg
)paren
(brace
r_struct
id|file
op_star
id|filp
suffix:semicolon
r_int
id|error
op_assign
op_minus
id|EBADF
suffix:semicolon
id|filp
op_assign
id|fget
c_func
(paren
id|fd
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|filp
)paren
r_goto
id|out
suffix:semicolon
id|lock_kernel
c_func
(paren
)paren
suffix:semicolon
id|error
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_switch
c_cond
(paren
(paren
id|cmd
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
)paren
(brace
r_case
l_char|&squot;S&squot;
suffix:colon
id|error
op_assign
id|solaris_S
c_func
(paren
id|filp
comma
id|fd
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_char|&squot;T&squot;
suffix:colon
id|error
op_assign
id|solaris_T
c_func
(paren
id|fd
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_char|&squot;i&squot;
suffix:colon
id|error
op_assign
id|solaris_i
c_func
(paren
id|fd
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_char|&squot;r&squot;
suffix:colon
id|error
op_assign
id|solaris_r
c_func
(paren
id|fd
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_char|&squot;s&squot;
suffix:colon
id|error
op_assign
id|solaris_s
c_func
(paren
id|fd
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_char|&squot;t&squot;
suffix:colon
id|error
op_assign
id|solaris_t
c_func
(paren
id|fd
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_char|&squot;f&squot;
suffix:colon
id|error
op_assign
id|sys_ioctl
c_func
(paren
id|fd
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_char|&squot;m&squot;
suffix:colon
id|error
op_assign
id|solaris_m
c_func
(paren
id|fd
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_char|&squot;O&squot;
suffix:colon
id|error
op_assign
id|solaris_O
c_func
(paren
id|fd
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|error
op_assign
op_minus
id|ENOSYS
suffix:semicolon
r_break
suffix:semicolon
)brace
id|unlock_kernel
c_func
(paren
)paren
suffix:semicolon
id|fput
c_func
(paren
id|filp
)paren
suffix:semicolon
id|out
suffix:colon
r_if
c_cond
(paren
id|error
op_eq
op_minus
id|ENOSYS
)paren
(brace
r_int
r_char
id|c
op_assign
id|cmd
op_rshift
l_int|8
suffix:semicolon
r_if
c_cond
(paren
id|c
template_param
l_int|126
)paren
id|c
op_assign
l_char|&squot;.&squot;
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;solaris_ioctl: Unknown cmd fd(%d) cmd(%08x &squot;%c&squot;) arg(%08x)&bslash;n&quot;
comma
(paren
r_int
)paren
id|fd
comma
(paren
r_int
r_int
)paren
id|cmd
comma
id|c
comma
(paren
r_int
r_int
)paren
id|arg
)paren
suffix:semicolon
id|error
op_assign
op_minus
id|EINVAL
suffix:semicolon
)brace
r_return
id|error
suffix:semicolon
)brace
eof
