multiline_comment|/* $Id: traps.c,v 1.68 2000/11/22 06:50:37 davem Exp $&n; * arch/sparc64/kernel/traps.c&n; *&n; * Copyright (C) 1995,1997 David S. Miller (davem@caip.rutgers.edu)&n; * Copyright (C) 1997,1999,2000 Jakub Jelinek (jakub@redhat.com)&n; */
multiline_comment|/*&n; * I like traps on v9, :))))&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/sched.h&gt;  /* for jiffies */
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/signal.h&gt;
macro_line|#include &lt;linux/smp.h&gt;
macro_line|#include &lt;linux/smp_lock.h&gt;
macro_line|#include &lt;asm/delay.h&gt;
macro_line|#include &lt;asm/system.h&gt;
macro_line|#include &lt;asm/ptrace.h&gt;
macro_line|#include &lt;asm/oplib.h&gt;
macro_line|#include &lt;asm/page.h&gt;
macro_line|#include &lt;asm/pgtable.h&gt;
macro_line|#include &lt;asm/unistd.h&gt;
macro_line|#include &lt;asm/uaccess.h&gt;
macro_line|#include &lt;asm/fpumacro.h&gt;
macro_line|#include &lt;asm/lsu.h&gt;
macro_line|#include &lt;asm/psrcompat.h&gt;
macro_line|#ifdef CONFIG_KMOD
macro_line|#include &lt;linux/kmod.h&gt;
macro_line|#endif
multiline_comment|/* #define SYSCALL_TRACING */
multiline_comment|/* #define VERBOSE_SYSCALL_TRACING */
multiline_comment|/* #define DEBUG_FPU */
macro_line|#ifdef SYSCALL_TRACING
macro_line|#ifdef VERBOSE_SYSCALL_TRACING
DECL|struct|sdesc
r_struct
id|sdesc
(brace
DECL|member|scall_num
r_int
id|scall_num
suffix:semicolon
DECL|member|name
r_char
op_star
id|name
suffix:semicolon
DECL|member|num_args
r_int
id|num_args
suffix:semicolon
DECL|member|arg_is_string
r_char
id|arg_is_string
(braket
l_int|6
)braket
suffix:semicolon
DECL|variable|sdesc_entries
)brace
id|sdesc_entries
(braket
)braket
op_assign
(brace
(brace
l_int|0
comma
l_string|&quot;setup&quot;
comma
l_int|0
comma
)brace
comma
(brace
l_int|1
comma
l_string|&quot;exit&quot;
comma
l_int|1
comma
(brace
l_int|0
comma
)brace
)brace
comma
(brace
l_int|2
comma
l_string|&quot;fork&quot;
comma
l_int|0
comma
)brace
comma
(brace
l_int|3
comma
l_string|&quot;read&quot;
comma
l_int|3
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|4
comma
l_string|&quot;write&quot;
comma
l_int|3
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|5
comma
l_string|&quot;open&quot;
comma
l_int|3
comma
(brace
l_int|1
comma
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|6
comma
l_string|&quot;close&quot;
comma
l_int|1
comma
(brace
l_int|0
comma
)brace
)brace
comma
(brace
l_int|7
comma
l_string|&quot;wait4&quot;
comma
l_int|4
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|8
comma
l_string|&quot;creat&quot;
comma
l_int|2
comma
(brace
l_int|1
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|9
comma
l_string|&quot;link&quot;
comma
l_int|2
comma
(brace
l_int|1
comma
l_int|1
comma
)brace
)brace
comma
(brace
l_int|10
comma
l_string|&quot;unlink&quot;
comma
l_int|1
comma
(brace
l_int|1
comma
)brace
)brace
comma
(brace
l_int|11
comma
l_string|&quot;execv&quot;
comma
l_int|2
comma
(brace
l_int|1
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|12
comma
l_string|&quot;chdir&quot;
comma
l_int|1
comma
(brace
l_int|1
comma
)brace
)brace
comma
(brace
l_int|15
comma
l_string|&quot;chmod&quot;
comma
l_int|2
comma
(brace
l_int|1
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|16
comma
l_string|&quot;chown&quot;
comma
l_int|3
comma
(brace
l_int|1
comma
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|17
comma
l_string|&quot;brk&quot;
comma
l_int|1
comma
(brace
l_int|0
comma
)brace
)brace
comma
(brace
l_int|19
comma
l_string|&quot;lseek&quot;
comma
l_int|3
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|27
comma
l_string|&quot;alarm&quot;
comma
l_int|1
comma
(brace
l_int|0
comma
)brace
)brace
comma
(brace
l_int|29
comma
l_string|&quot;pause&quot;
comma
l_int|0
comma
)brace
comma
(brace
l_int|33
comma
l_string|&quot;access&quot;
comma
l_int|2
comma
(brace
l_int|1
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|36
comma
l_string|&quot;sync&quot;
comma
l_int|0
comma
)brace
comma
(brace
l_int|37
comma
l_string|&quot;kill&quot;
comma
l_int|2
comma
(brace
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|38
comma
l_string|&quot;stat&quot;
comma
l_int|2
comma
(brace
l_int|1
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|40
comma
l_string|&quot;lstat&quot;
comma
l_int|2
comma
(brace
l_int|1
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|41
comma
l_string|&quot;dup&quot;
comma
l_int|1
comma
(brace
l_int|0
comma
)brace
)brace
comma
(brace
l_int|42
comma
l_string|&quot;pipd&quot;
comma
l_int|0
comma
)brace
comma
(brace
l_int|54
comma
l_string|&quot;ioctl&quot;
comma
l_int|3
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|57
comma
l_string|&quot;symlink&quot;
comma
l_int|2
comma
(brace
l_int|1
comma
l_int|1
comma
)brace
)brace
comma
(brace
l_int|58
comma
l_string|&quot;readlink&quot;
comma
l_int|3
comma
(brace
l_int|1
comma
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|59
comma
l_string|&quot;execve&quot;
comma
l_int|3
comma
(brace
l_int|1
comma
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|60
comma
l_string|&quot;umask&quot;
comma
l_int|1
comma
(brace
l_int|0
comma
)brace
)brace
comma
(brace
l_int|62
comma
l_string|&quot;fstat&quot;
comma
l_int|2
comma
(brace
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|64
comma
l_string|&quot;getpagesize&quot;
comma
l_int|0
comma
)brace
comma
(brace
l_int|71
comma
l_string|&quot;mmap&quot;
comma
l_int|6
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|73
comma
l_string|&quot;munmap&quot;
comma
l_int|2
comma
(brace
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|74
comma
l_string|&quot;mprotect&quot;
comma
l_int|3
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|83
comma
l_string|&quot;setitimer&quot;
comma
l_int|3
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|90
comma
l_string|&quot;dup2&quot;
comma
l_int|2
comma
(brace
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|92
comma
l_string|&quot;fcntl&quot;
comma
l_int|3
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|93
comma
l_string|&quot;select&quot;
comma
l_int|5
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|97
comma
l_string|&quot;socket&quot;
comma
l_int|3
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|98
comma
l_string|&quot;connect&quot;
comma
l_int|3
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|99
comma
l_string|&quot;accept&quot;
comma
l_int|3
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|101
comma
l_string|&quot;send&quot;
comma
l_int|4
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|102
comma
l_string|&quot;recv&quot;
comma
l_int|4
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|104
comma
l_string|&quot;bind&quot;
comma
l_int|3
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|105
comma
l_string|&quot;setsockopt&quot;
comma
l_int|5
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|106
comma
l_string|&quot;listen&quot;
comma
l_int|2
comma
(brace
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|120
comma
l_string|&quot;readv&quot;
comma
l_int|3
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|121
comma
l_string|&quot;writev&quot;
comma
l_int|3
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|123
comma
l_string|&quot;fchown&quot;
comma
l_int|3
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|124
comma
l_string|&quot;fchmod&quot;
comma
l_int|2
comma
(brace
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|128
comma
l_string|&quot;rename&quot;
comma
l_int|2
comma
(brace
l_int|1
comma
l_int|1
comma
)brace
)brace
comma
(brace
l_int|129
comma
l_string|&quot;truncate&quot;
comma
l_int|2
comma
(brace
l_int|1
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|130
comma
l_string|&quot;ftruncate&quot;
comma
l_int|2
comma
(brace
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|131
comma
l_string|&quot;flock&quot;
comma
l_int|2
comma
(brace
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|136
comma
l_string|&quot;mkdir&quot;
comma
l_int|2
comma
(brace
l_int|1
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|137
comma
l_string|&quot;rmdir&quot;
comma
l_int|1
comma
(brace
l_int|1
comma
)brace
)brace
comma
(brace
l_int|146
comma
l_string|&quot;killpg&quot;
comma
l_int|1
comma
(brace
l_int|0
comma
)brace
)brace
comma
(brace
l_int|157
comma
l_string|&quot;statfs&quot;
comma
l_int|2
comma
(brace
l_int|1
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|158
comma
l_string|&quot;fstatfs&quot;
comma
l_int|2
comma
(brace
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|159
comma
l_string|&quot;umount&quot;
comma
l_int|1
comma
(brace
l_int|1
comma
)brace
)brace
comma
(brace
l_int|167
comma
l_string|&quot;mount&quot;
comma
l_int|5
comma
(brace
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|174
comma
l_string|&quot;getdents&quot;
comma
l_int|3
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|176
comma
l_string|&quot;fchdir&quot;
comma
l_int|2
comma
(brace
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|198
comma
l_string|&quot;sigaction&quot;
comma
l_int|3
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|201
comma
l_string|&quot;sigsuspend&quot;
comma
l_int|1
comma
(brace
l_int|0
comma
)brace
)brace
comma
(brace
l_int|206
comma
l_string|&quot;socketcall&quot;
comma
l_int|2
comma
(brace
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|216
comma
l_string|&quot;sigreturn&quot;
comma
l_int|0
comma
)brace
comma
(brace
l_int|230
comma
l_string|&quot;newselect&quot;
comma
l_int|5
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|236
comma
l_string|&quot;llseek&quot;
comma
l_int|5
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
)brace
)brace
comma
(brace
l_int|251
comma
l_string|&quot;sysctl&quot;
comma
l_int|1
comma
(brace
l_int|0
comma
)brace
)brace
comma
)brace
suffix:semicolon
DECL|macro|NUM_SDESC_ENTRIES
mdefine_line|#define NUM_SDESC_ENTRIES (sizeof(sdesc_entries) / sizeof(sdesc_entries[0]))
macro_line|#endif
macro_line|#ifdef VERBOSE_SYSCALL_TRACING
DECL|variable|scall_strbuf
r_static
r_char
id|scall_strbuf
(braket
l_int|512
)braket
suffix:semicolon
macro_line|#endif
DECL|function|syscall_trace_entry
r_void
id|syscall_trace_entry
c_func
(paren
r_int
r_int
id|g1
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
macro_line|#ifdef VERBOSE_SYSCALL_TRACING
r_struct
id|sdesc
op_star
id|sdp
suffix:semicolon
r_int
id|i
suffix:semicolon
macro_line|#endif
macro_line|#if 0
r_if
c_cond
(paren
op_logical_neg
id|current-&gt;pid
)paren
r_return
suffix:semicolon
macro_line|#endif&t;
id|printk
c_func
(paren
l_string|&quot;SYS[%s:%d]: PC(%016lx) &lt;%3d&gt; &quot;
comma
id|current-&gt;comm
comma
id|current-&gt;pid
comma
id|regs-&gt;tpc
comma
(paren
r_int
)paren
id|g1
)paren
suffix:semicolon
macro_line|#ifdef VERBOSE_SYSCALL_TRACING
id|sdp
op_assign
l_int|NULL
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|NUM_SDESC_ENTRIES
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|sdesc_entries
(braket
id|i
)braket
dot
id|scall_num
op_eq
id|g1
)paren
(brace
id|sdp
op_assign
op_amp
id|sdesc_entries
(braket
id|i
)braket
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|sdp
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s(&quot;
comma
id|sdp-&gt;name
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|sdp-&gt;num_args
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|i
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;,&quot;
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|sdp-&gt;arg_is_string
(braket
id|i
)braket
)paren
(brace
r_if
c_cond
(paren
id|current-&gt;thread.flags
op_amp
id|SPARC_FLAG_32BIT
)paren
id|printk
c_func
(paren
l_string|&quot;%08x&quot;
comma
(paren
r_int
r_int
)paren
id|regs-&gt;u_regs
(braket
id|UREG_I0
op_plus
id|i
)braket
)paren
suffix:semicolon
r_else
id|printk
c_func
(paren
l_string|&quot;%016lx&quot;
comma
id|regs-&gt;u_regs
(braket
id|UREG_I0
op_plus
id|i
)braket
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|current-&gt;thread.flags
op_amp
id|SPARC_FLAG_32BIT
)paren
id|strncpy_from_user
c_func
(paren
id|scall_strbuf
comma
(paren
r_char
op_star
)paren
(paren
id|regs-&gt;u_regs
(braket
id|UREG_I0
op_plus
id|i
)braket
op_amp
l_int|0xffffffff
)paren
comma
l_int|512
)paren
suffix:semicolon
r_else
id|strncpy_from_user
c_func
(paren
id|scall_strbuf
comma
(paren
r_char
op_star
)paren
id|regs-&gt;u_regs
(braket
id|UREG_I0
op_plus
id|i
)braket
comma
l_int|512
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&quot;
comma
id|scall_strbuf
)paren
suffix:semicolon
)brace
)brace
id|printk
c_func
(paren
l_string|&quot;) &quot;
)paren
suffix:semicolon
)brace
macro_line|#endif
)brace
DECL|function|syscall_trace_exit
r_int
r_int
id|syscall_trace_exit
c_func
(paren
r_int
r_int
id|retval
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
macro_line|#if 0
r_if
c_cond
(paren
id|current-&gt;pid
)paren
macro_line|#endif
id|printk
c_func
(paren
l_string|&quot;ret[%016lx]&bslash;n&quot;
comma
id|retval
)paren
suffix:semicolon
r_return
id|retval
suffix:semicolon
)brace
macro_line|#endif /* SYSCALL_TRACING */
macro_line|#if 1
DECL|function|rtrap_check
r_void
id|rtrap_check
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_register
r_int
r_int
id|pgd_phys
id|asm
c_func
(paren
l_string|&quot;o1&quot;
)paren
suffix:semicolon
r_register
r_int
r_int
id|pgd_cache
id|asm
c_func
(paren
l_string|&quot;o2&quot;
)paren
suffix:semicolon
r_register
r_int
r_int
id|g1_or_g3
id|asm
c_func
(paren
l_string|&quot;o3&quot;
)paren
suffix:semicolon
r_register
r_int
r_int
id|g2
id|asm
c_func
(paren
l_string|&quot;o4&quot;
)paren
suffix:semicolon
r_int
r_int
id|ctx
suffix:semicolon
macro_line|#if 0
r_do
(brace
r_int
r_int
id|test
suffix:semicolon
id|__asm__
id|__volatile__
c_func
(paren
l_string|&quot;rdpr&t;%%pstate, %0&quot;
suffix:colon
l_string|&quot;=r&quot;
(paren
id|test
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|test
op_amp
id|PSTATE_MG
)paren
op_ne
l_int|0
op_logical_or
(paren
id|test
op_amp
id|PSTATE_IE
)paren
op_eq
l_int|0
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;rtrap_check: Bogus pstate[%016lx]&bslash;n&quot;
comma
id|test
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
)brace
r_while
c_loop
(paren
l_int|0
)paren
(brace
suffix:semicolon
)brace
macro_line|#endif
id|__asm__
id|__volatile__
c_func
(paren
"&quot;"
id|rdpr
op_mod
op_mod
id|pstate
comma
op_mod
op_mod
id|o5
id|wrpr
op_mod
op_mod
id|o5
comma
op_mod
l_int|4
comma
op_mod
op_mod
id|pstate
op_logical_or
op_mod
op_mod
id|g1
comma
op_mod
op_mod
id|g3
comma
op_mod
l_int|2
id|mov
op_mod
op_mod
id|g2
comma
op_mod
l_int|3
id|mov
op_mod
op_mod
id|g7
comma
op_mod
l_int|0
id|mov
op_mod
l_int|5
comma
op_mod
l_int|1
id|ldxa
(braket
op_mod
l_int|1
)braket
op_mod
l_int|6
comma
op_mod
l_int|1
id|wrpr
op_mod
op_mod
id|o5
comma
l_int|0x0
comma
op_mod
op_mod
id|pstate
"&quot;"
suffix:colon
l_string|&quot;=r&quot;
(paren
id|pgd_phys
)paren
comma
l_string|&quot;=r&quot;
(paren
id|pgd_cache
)paren
comma
l_string|&quot;=r&quot;
(paren
id|g1_or_g3
)paren
comma
l_string|&quot;=r&quot;
(paren
id|g2
)paren
suffix:colon
l_string|&quot;i&quot;
(paren
id|PSTATE_IE
op_or
id|PSTATE_MG
)paren
comma
l_string|&quot;i&quot;
(paren
id|TSB_REG
)paren
comma
l_string|&quot;i&quot;
(paren
id|ASI_DMMU
)paren
suffix:colon
l_string|&quot;o5&quot;
)paren
suffix:semicolon
id|ctx
op_assign
id|spitfire_get_secondary_context
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|pgd_phys
op_ne
id|__pa
c_func
(paren
id|current-&gt;mm-&gt;pgd
)paren
)paren
op_logical_or
(paren
(paren
id|pgd_cache
op_ne
l_int|0
)paren
op_logical_and
(paren
id|pgd_cache
op_ne
id|pgd_val
c_func
(paren
id|current-&gt;mm-&gt;pgd
(braket
l_int|0
)braket
)paren
op_lshift
l_int|11UL
)paren
)paren
op_logical_or
(paren
id|g1_or_g3
op_ne
(paren
l_int|0xfffffffe00000000UL
op_or
l_int|0x0000000000000018UL
)paren
)paren
op_logical_or
DECL|macro|KERN_HIGHBITS
mdefine_line|#define KERN_HIGHBITS&t;&t;((_PAGE_VALID | _PAGE_SZ4MB) ^ 0xfffff80000000000)
DECL|macro|KERN_LOWBITS
mdefine_line|#define KERN_LOWBITS&t;&t;(_PAGE_CP | _PAGE_CV | _PAGE_P | _PAGE_W)
(paren
id|g2
op_ne
(paren
id|KERN_HIGHBITS
op_or
id|KERN_LOWBITS
)paren
)paren
op_logical_or
DECL|macro|KERN_HIGHBITS
macro_line|#undef KERN_HIGHBITS
DECL|macro|KERN_LOWBITS
macro_line|#undef KERN_LOWBITS
(paren
(paren
id|ctx
op_ne
(paren
id|current-&gt;mm-&gt;context
op_amp
l_int|0x3ff
)paren
)paren
op_logical_or
(paren
id|ctx
op_eq
l_int|0
)paren
op_logical_or
(paren
id|CTX_HWBITS
c_func
(paren
id|current-&gt;mm-&gt;context
)paren
op_ne
id|ctx
)paren
)paren
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;SHIT[%s:%d]: &quot;
l_string|&quot;(PP[%016lx] CACH[%016lx] CTX[%lx] g1g3[%016lx] g2[%016lx]) &quot;
comma
id|current-&gt;comm
comma
id|current-&gt;pid
comma
id|pgd_phys
comma
id|pgd_cache
comma
id|ctx
comma
id|g1_or_g3
comma
id|g2
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;SHIT[%s:%d]: &quot;
l_string|&quot;[PP[%016lx] CACH[%016lx] CTX[%lx]] PC[%016lx:%016lx]&bslash;n&quot;
comma
id|current-&gt;comm
comma
id|current-&gt;pid
comma
id|__pa
c_func
(paren
id|current-&gt;mm-&gt;pgd
)paren
comma
id|pgd_val
c_func
(paren
id|current-&gt;mm-&gt;pgd
(braket
l_int|0
)braket
)paren
comma
id|current-&gt;mm-&gt;context
op_amp
l_int|0x3ff
comma
id|regs-&gt;tpc
comma
id|regs-&gt;tnpc
)paren
suffix:semicolon
id|show_regs
c_func
(paren
id|regs
)paren
suffix:semicolon
macro_line|#if 1
id|__sti
c_func
(paren
)paren
suffix:semicolon
r_while
c_loop
(paren
l_int|1
)paren
(brace
id|barrier
c_func
(paren
)paren
suffix:semicolon
)brace
macro_line|#endif
)brace
)brace
macro_line|#endif
DECL|function|bad_trap
r_void
id|bad_trap
(paren
r_struct
id|pt_regs
op_star
id|regs
comma
r_int
id|lvl
)paren
(brace
id|siginfo_t
id|info
suffix:semicolon
r_if
c_cond
(paren
id|lvl
OL
l_int|0x100
)paren
(brace
r_char
id|buffer
(braket
l_int|24
)braket
suffix:semicolon
id|sprintf
(paren
id|buffer
comma
l_string|&quot;Bad hw trap %lx at tl0&bslash;n&quot;
comma
id|lvl
)paren
suffix:semicolon
id|die_if_kernel
(paren
id|buffer
comma
id|regs
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|regs-&gt;tstate
op_amp
id|TSTATE_PRIV
)paren
id|die_if_kernel
(paren
l_string|&quot;Kernel bad trap&quot;
comma
id|regs
)paren
suffix:semicolon
id|info.si_signo
op_assign
id|SIGILL
suffix:semicolon
id|info.si_errno
op_assign
l_int|0
suffix:semicolon
id|info.si_code
op_assign
id|ILL_ILLTRP
suffix:semicolon
id|info.si_addr
op_assign
(paren
r_void
op_star
)paren
id|regs-&gt;tpc
suffix:semicolon
id|info.si_trapno
op_assign
id|lvl
op_minus
l_int|0x100
suffix:semicolon
id|force_sig_info
c_func
(paren
id|SIGILL
comma
op_amp
id|info
comma
id|current
)paren
suffix:semicolon
)brace
DECL|function|bad_trap_tl1
r_void
id|bad_trap_tl1
(paren
r_struct
id|pt_regs
op_star
id|regs
comma
r_int
id|lvl
)paren
(brace
r_char
id|buffer
(braket
l_int|24
)braket
suffix:semicolon
id|sprintf
(paren
id|buffer
comma
l_string|&quot;Bad trap %lx at tl&gt;0&quot;
comma
id|lvl
)paren
suffix:semicolon
id|die_if_kernel
(paren
id|buffer
comma
id|regs
)paren
suffix:semicolon
)brace
DECL|function|instruction_access_exception
r_void
id|instruction_access_exception
(paren
r_struct
id|pt_regs
op_star
id|regs
comma
r_int
r_int
id|sfsr
comma
r_int
r_int
id|sfar
)paren
(brace
id|siginfo_t
id|info
suffix:semicolon
r_if
c_cond
(paren
id|regs-&gt;tstate
op_amp
id|TSTATE_PRIV
)paren
(brace
macro_line|#if 1
id|printk
c_func
(paren
l_string|&quot;instruction_access_exception: Shit SFSR[%016lx] SFAR[%016lx], going.&bslash;n&quot;
comma
id|sfsr
comma
id|sfar
)paren
suffix:semicolon
macro_line|#endif
id|die_if_kernel
c_func
(paren
l_string|&quot;Iax&quot;
comma
id|regs
)paren
suffix:semicolon
)brace
id|info.si_signo
op_assign
id|SIGSEGV
suffix:semicolon
id|info.si_errno
op_assign
l_int|0
suffix:semicolon
id|info.si_code
op_assign
id|SEGV_MAPERR
suffix:semicolon
id|info.si_addr
op_assign
(paren
r_void
op_star
)paren
id|regs-&gt;tpc
suffix:semicolon
id|info.si_trapno
op_assign
l_int|0
suffix:semicolon
id|force_sig_info
c_func
(paren
id|SIGSEGV
comma
op_amp
id|info
comma
id|current
)paren
suffix:semicolon
)brace
DECL|function|data_access_exception
r_void
id|data_access_exception
(paren
r_struct
id|pt_regs
op_star
id|regs
comma
r_int
r_int
id|sfsr
comma
r_int
r_int
id|sfar
)paren
(brace
id|siginfo_t
id|info
suffix:semicolon
r_if
c_cond
(paren
id|regs-&gt;tstate
op_amp
id|TSTATE_PRIV
)paren
(brace
multiline_comment|/* Test if this comes from uaccess places. */
r_int
r_int
id|fixup
comma
id|g2
suffix:semicolon
id|g2
op_assign
id|regs-&gt;u_regs
(braket
id|UREG_G2
)braket
suffix:semicolon
r_if
c_cond
(paren
(paren
id|fixup
op_assign
id|search_exception_table
(paren
id|regs-&gt;tpc
comma
op_amp
id|g2
)paren
)paren
)paren
(brace
multiline_comment|/* Ouch, somebody is trying ugly VM hole tricks on us... */
macro_line|#ifdef DEBUG_EXCEPTIONS
id|printk
c_func
(paren
l_string|&quot;Exception: PC&lt;%016lx&gt; faddr&lt;UNKNOWN&gt;&bslash;n&quot;
comma
id|regs-&gt;tpc
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;EX_TABLE: insn&lt;%016lx&gt; fixup&lt;%016lx&gt; &quot;
l_string|&quot;g2&lt;%016lx&gt;&bslash;n&quot;
comma
id|regs-&gt;tpc
comma
id|fixup
comma
id|g2
)paren
suffix:semicolon
macro_line|#endif
id|regs-&gt;tpc
op_assign
id|fixup
suffix:semicolon
id|regs-&gt;tnpc
op_assign
id|regs-&gt;tpc
op_plus
l_int|4
suffix:semicolon
id|regs-&gt;u_regs
(braket
id|UREG_G2
)braket
op_assign
id|g2
suffix:semicolon
r_return
suffix:semicolon
)brace
multiline_comment|/* Shit... */
macro_line|#if 1
id|printk
c_func
(paren
l_string|&quot;data_access_exception: Shit SFSR[%016lx] SFAR[%016lx], going.&bslash;n&quot;
comma
id|sfsr
comma
id|sfar
)paren
suffix:semicolon
macro_line|#endif
id|die_if_kernel
c_func
(paren
l_string|&quot;Dax&quot;
comma
id|regs
)paren
suffix:semicolon
)brace
macro_line|#if 0
r_else
id|rtrap_check
c_func
(paren
id|regs
)paren
suffix:semicolon
macro_line|#endif
id|info.si_signo
op_assign
id|SIGSEGV
suffix:semicolon
id|info.si_errno
op_assign
l_int|0
suffix:semicolon
id|info.si_code
op_assign
id|SEGV_MAPERR
suffix:semicolon
id|info.si_addr
op_assign
(paren
r_void
op_star
)paren
id|sfar
suffix:semicolon
id|info.si_trapno
op_assign
l_int|0
suffix:semicolon
id|force_sig_info
c_func
(paren
id|SIGSEGV
comma
op_amp
id|info
comma
id|current
)paren
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_PCI
multiline_comment|/* This is really pathetic... */
multiline_comment|/* #define DEBUG_PCI_POKES */
r_extern
r_volatile
r_int
id|pci_poke_in_progress
suffix:semicolon
r_extern
r_volatile
r_int
id|pci_poke_faulted
suffix:semicolon
macro_line|#endif
multiline_comment|/* When access exceptions happen, we must do this. */
DECL|function|clean_and_reenable_l1_caches
r_static
id|__inline__
r_void
id|clean_and_reenable_l1_caches
c_func
(paren
r_void
)paren
(brace
r_int
r_int
id|va
suffix:semicolon
multiline_comment|/* Clean &squot;em. */
r_for
c_loop
(paren
id|va
op_assign
l_int|0
suffix:semicolon
id|va
OL
(paren
id|PAGE_SIZE
op_lshift
l_int|1
)paren
suffix:semicolon
id|va
op_add_assign
l_int|32
)paren
(brace
id|spitfire_put_icache_tag
c_func
(paren
id|va
comma
l_int|0x0
)paren
suffix:semicolon
id|spitfire_put_dcache_tag
c_func
(paren
id|va
comma
l_int|0x0
)paren
suffix:semicolon
)brace
multiline_comment|/* Re-enable. */
id|__asm__
id|__volatile__
c_func
(paren
l_string|&quot;flush %%g6&bslash;n&bslash;t&quot;
l_string|&quot;membar #Sync&bslash;n&bslash;t&quot;
l_string|&quot;stxa %0, [%%g0] %1&bslash;n&bslash;t&quot;
l_string|&quot;membar #Sync&quot;
suffix:colon
multiline_comment|/* no outputs */
suffix:colon
l_string|&quot;r&quot;
(paren
id|LSU_CONTROL_IC
op_or
id|LSU_CONTROL_DC
op_or
id|LSU_CONTROL_IM
op_or
id|LSU_CONTROL_DM
)paren
comma
l_string|&quot;i&quot;
(paren
id|ASI_LSU_CONTROL
)paren
suffix:colon
l_string|&quot;memory&quot;
)paren
suffix:semicolon
)brace
DECL|function|do_iae
r_void
id|do_iae
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|siginfo_t
id|info
suffix:semicolon
id|clean_and_reenable_l1_caches
c_func
(paren
)paren
suffix:semicolon
id|info.si_signo
op_assign
id|SIGBUS
suffix:semicolon
id|info.si_errno
op_assign
l_int|0
suffix:semicolon
id|info.si_code
op_assign
id|BUS_OBJERR
suffix:semicolon
id|info.si_addr
op_assign
(paren
r_void
op_star
)paren
l_int|0
suffix:semicolon
id|info.si_trapno
op_assign
l_int|0
suffix:semicolon
id|force_sig_info
c_func
(paren
id|SIGBUS
comma
op_amp
id|info
comma
id|current
)paren
suffix:semicolon
)brace
DECL|function|do_dae
r_void
id|do_dae
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
macro_line|#ifdef CONFIG_PCI
r_if
c_cond
(paren
id|pci_poke_in_progress
)paren
(brace
macro_line|#ifdef DEBUG_PCI_POKES
id|prom_printf
c_func
(paren
l_string|&quot; (POKE tpc[%016lx] tnpc[%016lx] &quot;
comma
id|regs-&gt;tpc
comma
id|regs-&gt;tnpc
)paren
suffix:semicolon
macro_line|#endif
id|pci_poke_faulted
op_assign
l_int|1
suffix:semicolon
id|regs-&gt;tnpc
op_assign
id|regs-&gt;tpc
op_plus
l_int|4
suffix:semicolon
macro_line|#ifdef DEBUG_PCI_POKES
id|prom_printf
c_func
(paren
l_string|&quot;PCI) &quot;
)paren
suffix:semicolon
multiline_comment|/* prom_halt(); */
macro_line|#endif
id|clean_and_reenable_l1_caches
c_func
(paren
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
macro_line|#endif
id|do_iae
c_func
(paren
id|regs
)paren
suffix:semicolon
)brace
DECL|variable|ecc_syndrome_table
r_static
r_char
id|ecc_syndrome_table
(braket
)braket
op_assign
(brace
l_int|0x4c
comma
l_int|0x40
comma
l_int|0x41
comma
l_int|0x48
comma
l_int|0x42
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x49
comma
l_int|0x43
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x49
comma
l_int|0x48
comma
l_int|0x49
comma
l_int|0x49
comma
l_int|0x4a
comma
l_int|0x44
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x20
comma
l_int|0x48
comma
l_int|0x39
comma
l_int|0x4b
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x25
comma
l_int|0x31
comma
l_int|0x48
comma
l_int|0x28
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x2c
comma
l_int|0x45
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x21
comma
l_int|0x48
comma
l_int|0x3d
comma
l_int|0x04
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x4b
comma
l_int|0x35
comma
l_int|0x48
comma
l_int|0x2d
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x29
comma
l_int|0x48
comma
l_int|0x00
comma
l_int|0x01
comma
l_int|0x48
comma
l_int|0x0a
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x4b
comma
l_int|0x0f
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x4b
comma
l_int|0x48
comma
l_int|0x49
comma
l_int|0x49
comma
l_int|0x48
comma
l_int|0x46
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x2a
comma
l_int|0x48
comma
l_int|0x3b
comma
l_int|0x27
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x4b
comma
l_int|0x33
comma
l_int|0x48
comma
l_int|0x22
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x2e
comma
l_int|0x48
comma
l_int|0x19
comma
l_int|0x1d
comma
l_int|0x48
comma
l_int|0x1b
comma
l_int|0x4a
comma
l_int|0x48
comma
l_int|0x4b
comma
l_int|0x1f
comma
l_int|0x48
comma
l_int|0x4a
comma
l_int|0x4b
comma
l_int|0x48
comma
l_int|0x4b
comma
l_int|0x4b
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x4b
comma
l_int|0x24
comma
l_int|0x48
comma
l_int|0x07
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x36
comma
l_int|0x4b
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x3e
comma
l_int|0x48
comma
l_int|0x30
comma
l_int|0x38
comma
l_int|0x48
comma
l_int|0x49
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x4b
comma
l_int|0x48
comma
l_int|0x4b
comma
l_int|0x16
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x12
comma
l_int|0x4b
comma
l_int|0x48
comma
l_int|0x49
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x4b
comma
l_int|0x47
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x2f
comma
l_int|0x48
comma
l_int|0x3f
comma
l_int|0x4b
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x06
comma
l_int|0x37
comma
l_int|0x48
comma
l_int|0x23
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x2b
comma
l_int|0x48
comma
l_int|0x05
comma
l_int|0x4b
comma
l_int|0x48
comma
l_int|0x4b
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x32
comma
l_int|0x26
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x3a
comma
l_int|0x48
comma
l_int|0x34
comma
l_int|0x3c
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x11
comma
l_int|0x15
comma
l_int|0x48
comma
l_int|0x13
comma
l_int|0x4a
comma
l_int|0x48
comma
l_int|0x4b
comma
l_int|0x17
comma
l_int|0x48
comma
l_int|0x4a
comma
l_int|0x4b
comma
l_int|0x48
comma
l_int|0x4b
comma
l_int|0x4b
comma
l_int|0x48
comma
l_int|0x49
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x4b
comma
l_int|0x48
comma
l_int|0x4b
comma
l_int|0x1e
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x1a
comma
l_int|0x4b
comma
l_int|0x48
comma
l_int|0x49
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x4b
comma
l_int|0x48
comma
l_int|0x08
comma
l_int|0x0d
comma
l_int|0x48
comma
l_int|0x02
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x49
comma
l_int|0x03
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x49
comma
l_int|0x48
comma
l_int|0x4b
comma
l_int|0x4b
comma
l_int|0x48
comma
l_int|0x49
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x49
comma
l_int|0x48
comma
l_int|0x4b
comma
l_int|0x10
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x14
comma
l_int|0x4b
comma
l_int|0x48
comma
l_int|0x4b
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x4b
comma
l_int|0x49
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x49
comma
l_int|0x48
comma
l_int|0x4b
comma
l_int|0x18
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x1c
comma
l_int|0x4b
comma
l_int|0x48
comma
l_int|0x4b
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x4b
comma
l_int|0x4a
comma
l_int|0x0c
comma
l_int|0x09
comma
l_int|0x48
comma
l_int|0x0e
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x4b
comma
l_int|0x0b
comma
l_int|0x48
comma
l_int|0x48
comma
l_int|0x4b
comma
l_int|0x48
comma
l_int|0x4b
comma
l_int|0x4b
comma
l_int|0x4a
)brace
suffix:semicolon
multiline_comment|/* cee_trap in entry.S encodes AFSR/UDBH/UDBL error status&n; * in the following format.  The AFAR is left as is, with&n; * reserved bits cleared, and is a raw 40-bit physical&n; * address.&n; */
DECL|macro|CE_STATUS_UDBH_UE
mdefine_line|#define CE_STATUS_UDBH_UE&t;&t;(1UL &lt;&lt; (43 + 9))
DECL|macro|CE_STATUS_UDBH_CE
mdefine_line|#define CE_STATUS_UDBH_CE&t;&t;(1UL &lt;&lt; (43 + 8))
DECL|macro|CE_STATUS_UDBH_ESYNDR
mdefine_line|#define CE_STATUS_UDBH_ESYNDR&t;&t;(0xffUL &lt;&lt; 43)
DECL|macro|CE_STATUS_UDBH_SHIFT
mdefine_line|#define CE_STATUS_UDBH_SHIFT&t;&t;43
DECL|macro|CE_STATUS_UDBL_UE
mdefine_line|#define CE_STATUS_UDBL_UE&t;&t;(1UL &lt;&lt; (33 + 9))
DECL|macro|CE_STATUS_UDBL_CE
mdefine_line|#define CE_STATUS_UDBL_CE&t;&t;(1UL &lt;&lt; (33 + 8))
DECL|macro|CE_STATUS_UDBL_ESYNDR
mdefine_line|#define CE_STATUS_UDBL_ESYNDR&t;&t;(0xffUL &lt;&lt; 33)
DECL|macro|CE_STATUS_UDBL_SHIFT
mdefine_line|#define CE_STATUS_UDBL_SHIFT&t;&t;33
DECL|macro|CE_STATUS_AFSR_MASK
mdefine_line|#define CE_STATUS_AFSR_MASK&t;&t;(0x1ffffffffUL)
DECL|macro|CE_STATUS_AFSR_ME
mdefine_line|#define CE_STATUS_AFSR_ME&t;&t;(1UL &lt;&lt; 32)
DECL|macro|CE_STATUS_AFSR_PRIV
mdefine_line|#define CE_STATUS_AFSR_PRIV&t;&t;(1UL &lt;&lt; 31)
DECL|macro|CE_STATUS_AFSR_ISAP
mdefine_line|#define CE_STATUS_AFSR_ISAP&t;&t;(1UL &lt;&lt; 30)
DECL|macro|CE_STATUS_AFSR_ETP
mdefine_line|#define CE_STATUS_AFSR_ETP&t;&t;(1UL &lt;&lt; 29)
DECL|macro|CE_STATUS_AFSR_IVUE
mdefine_line|#define CE_STATUS_AFSR_IVUE&t;&t;(1UL &lt;&lt; 28)
DECL|macro|CE_STATUS_AFSR_TO
mdefine_line|#define CE_STATUS_AFSR_TO&t;&t;(1UL &lt;&lt; 27)
DECL|macro|CE_STATUS_AFSR_BERR
mdefine_line|#define CE_STATUS_AFSR_BERR&t;&t;(1UL &lt;&lt; 26)
DECL|macro|CE_STATUS_AFSR_LDP
mdefine_line|#define CE_STATUS_AFSR_LDP&t;&t;(1UL &lt;&lt; 25)
DECL|macro|CE_STATUS_AFSR_CP
mdefine_line|#define CE_STATUS_AFSR_CP&t;&t;(1UL &lt;&lt; 24)
DECL|macro|CE_STATUS_AFSR_WP
mdefine_line|#define CE_STATUS_AFSR_WP&t;&t;(1UL &lt;&lt; 23)
DECL|macro|CE_STATUS_AFSR_EDP
mdefine_line|#define CE_STATUS_AFSR_EDP&t;&t;(1UL &lt;&lt; 22)
DECL|macro|CE_STATUS_AFSR_UE
mdefine_line|#define CE_STATUS_AFSR_UE&t;&t;(1UL &lt;&lt; 21)
DECL|macro|CE_STATUS_AFSR_CE
mdefine_line|#define CE_STATUS_AFSR_CE&t;&t;(1UL &lt;&lt; 20)
DECL|macro|CE_STATUS_AFSR_ETS
mdefine_line|#define CE_STATUS_AFSR_ETS&t;&t;(0xfUL &lt;&lt; 16)
DECL|macro|CE_STATUS_AFSR_ETS_SHIFT
mdefine_line|#define CE_STATUS_AFSR_ETS_SHIFT&t;16
DECL|macro|CE_STATUS_AFSR_PSYND
mdefine_line|#define CE_STATUS_AFSR_PSYND&t;&t;(0xffffUL &lt;&lt; 0)
DECL|macro|CE_STATUS_AFSR_PSYND_SHIFT
mdefine_line|#define CE_STATUS_AFSR_PSYND_SHIFT&t;0
multiline_comment|/* Layout of Ecache TAG Parity Syndrome of AFSR */
DECL|macro|AFSR_ETSYNDROME_7_0
mdefine_line|#define AFSR_ETSYNDROME_7_0&t;&t;0x1UL /* E$-tag bus bits  &lt;7:0&gt; */
DECL|macro|AFSR_ETSYNDROME_15_8
mdefine_line|#define AFSR_ETSYNDROME_15_8&t;&t;0x2UL /* E$-tag bus bits &lt;15:8&gt; */
DECL|macro|AFSR_ETSYNDROME_21_16
mdefine_line|#define AFSR_ETSYNDROME_21_16&t;&t;0x4UL /* E$-tag bus bits &lt;21:16&gt; */
DECL|macro|AFSR_ETSYNDROME_24_22
mdefine_line|#define AFSR_ETSYNDROME_24_22&t;&t;0x8UL /* E$-tag bus bits &lt;24:22&gt; */
DECL|variable|syndrome_unknown
r_static
r_char
op_star
id|syndrome_unknown
op_assign
l_string|&quot;&lt;Unknown&gt;&quot;
suffix:semicolon
DECL|function|cee_log
id|asmlinkage
r_void
id|cee_log
c_func
(paren
r_int
r_int
id|ce_status
comma
r_int
r_int
id|afar
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_char
id|memmod_str
(braket
l_int|64
)braket
suffix:semicolon
r_char
op_star
id|p
suffix:semicolon
r_int
r_int
id|scode
comma
id|udb_reg
suffix:semicolon
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;CPU[%d]: Correctable ECC Error &quot;
l_string|&quot;AFSR[%lx] AFAR[%016lx] UDBL[%lx] UDBH[%lx]&bslash;n&quot;
comma
id|smp_processor_id
c_func
(paren
)paren
comma
(paren
id|ce_status
op_amp
id|CE_STATUS_AFSR_MASK
)paren
comma
id|afar
comma
(paren
(paren
id|ce_status
op_rshift
id|CE_STATUS_UDBL_SHIFT
)paren
op_amp
l_int|0x3ffUL
)paren
comma
(paren
(paren
id|ce_status
op_rshift
id|CE_STATUS_UDBH_SHIFT
)paren
op_amp
l_int|0x3ffUL
)paren
)paren
suffix:semicolon
id|udb_reg
op_assign
(paren
(paren
id|ce_status
op_rshift
id|CE_STATUS_UDBL_SHIFT
)paren
op_amp
l_int|0x3ffUL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|udb_reg
op_amp
(paren
l_int|1
op_lshift
l_int|8
)paren
)paren
(brace
id|scode
op_assign
id|ecc_syndrome_table
(braket
id|udb_reg
op_amp
l_int|0xff
)braket
suffix:semicolon
r_if
c_cond
(paren
id|prom_getunumber
c_func
(paren
id|scode
comma
id|afar
comma
id|memmod_str
comma
r_sizeof
(paren
id|memmod_str
)paren
)paren
op_eq
op_minus
l_int|1
)paren
id|p
op_assign
id|syndrome_unknown
suffix:semicolon
r_else
id|p
op_assign
id|memmod_str
suffix:semicolon
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;CPU[%d]: UDBL Syndrome[%x] &quot;
l_string|&quot;Memory Module &bslash;&quot;%s&bslash;&quot;&bslash;n&quot;
comma
id|smp_processor_id
c_func
(paren
)paren
comma
id|scode
comma
id|p
)paren
suffix:semicolon
)brace
id|udb_reg
op_assign
(paren
(paren
id|ce_status
op_rshift
id|CE_STATUS_UDBH_SHIFT
)paren
op_amp
l_int|0x3ffUL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|udb_reg
op_amp
(paren
l_int|1
op_lshift
l_int|8
)paren
)paren
(brace
id|scode
op_assign
id|ecc_syndrome_table
(braket
id|udb_reg
op_amp
l_int|0xff
)braket
suffix:semicolon
r_if
c_cond
(paren
id|prom_getunumber
c_func
(paren
id|scode
comma
id|afar
comma
id|memmod_str
comma
r_sizeof
(paren
id|memmod_str
)paren
)paren
op_eq
op_minus
l_int|1
)paren
id|p
op_assign
id|syndrome_unknown
suffix:semicolon
r_else
id|p
op_assign
id|memmod_str
suffix:semicolon
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;CPU[%d]: UDBH Syndrome[%x] &quot;
l_string|&quot;Memory Module &bslash;&quot;%s&bslash;&quot;&bslash;n&quot;
comma
id|smp_processor_id
c_func
(paren
)paren
comma
id|scode
comma
id|p
)paren
suffix:semicolon
)brace
)brace
DECL|function|do_fpe_common
r_void
id|do_fpe_common
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_if
c_cond
(paren
id|regs-&gt;tstate
op_amp
id|TSTATE_PRIV
)paren
(brace
id|regs-&gt;tpc
op_assign
id|regs-&gt;tnpc
suffix:semicolon
id|regs-&gt;tnpc
op_add_assign
l_int|4
suffix:semicolon
)brace
r_else
(brace
r_int
r_int
id|fsr
op_assign
id|current-&gt;thread.xfsr
(braket
l_int|0
)braket
suffix:semicolon
id|siginfo_t
id|info
suffix:semicolon
id|info.si_signo
op_assign
id|SIGFPE
suffix:semicolon
id|info.si_errno
op_assign
l_int|0
suffix:semicolon
id|info.si_addr
op_assign
(paren
r_void
op_star
)paren
id|regs-&gt;tpc
suffix:semicolon
id|info.si_trapno
op_assign
l_int|0
suffix:semicolon
id|info.si_code
op_assign
id|__SI_FAULT
suffix:semicolon
r_if
c_cond
(paren
(paren
id|fsr
op_amp
l_int|0x1c000
)paren
op_eq
(paren
l_int|1
op_lshift
l_int|14
)paren
)paren
(brace
r_if
c_cond
(paren
id|fsr
op_amp
l_int|0x10
)paren
id|info.si_code
op_assign
id|FPE_FLTINV
suffix:semicolon
r_else
r_if
c_cond
(paren
id|fsr
op_amp
l_int|0x08
)paren
id|info.si_code
op_assign
id|FPE_FLTOVF
suffix:semicolon
r_else
r_if
c_cond
(paren
id|fsr
op_amp
l_int|0x04
)paren
id|info.si_code
op_assign
id|FPE_FLTUND
suffix:semicolon
r_else
r_if
c_cond
(paren
id|fsr
op_amp
l_int|0x02
)paren
id|info.si_code
op_assign
id|FPE_FLTDIV
suffix:semicolon
r_else
r_if
c_cond
(paren
id|fsr
op_amp
l_int|0x01
)paren
id|info.si_code
op_assign
id|FPE_FLTRES
suffix:semicolon
)brace
id|force_sig_info
c_func
(paren
id|SIGFPE
comma
op_amp
id|info
comma
id|current
)paren
suffix:semicolon
)brace
)brace
DECL|function|do_fpieee
r_void
id|do_fpieee
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
macro_line|#ifdef DEBUG_FPU
id|printk
c_func
(paren
l_string|&quot;fpieee %016lx&bslash;n&quot;
comma
id|current-&gt;thread.xfsr
(braket
l_int|0
)braket
)paren
suffix:semicolon
macro_line|#endif
id|do_fpe_common
c_func
(paren
id|regs
)paren
suffix:semicolon
)brace
r_extern
r_int
id|do_mathemu
c_func
(paren
r_struct
id|pt_regs
op_star
comma
r_struct
id|fpustate
op_star
)paren
suffix:semicolon
DECL|function|do_fpother
r_void
id|do_fpother
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_struct
id|fpustate
op_star
id|f
op_assign
id|FPUSTATE
suffix:semicolon
r_int
id|ret
op_assign
l_int|0
suffix:semicolon
r_switch
c_cond
(paren
(paren
id|current-&gt;thread.xfsr
(braket
l_int|0
)braket
op_amp
l_int|0x1c000
)paren
)paren
(brace
r_case
(paren
l_int|2
op_lshift
l_int|14
)paren
suffix:colon
multiline_comment|/* unfinished_FPop */
r_case
(paren
l_int|3
op_lshift
l_int|14
)paren
suffix:colon
multiline_comment|/* unimplemented_FPop */
id|ret
op_assign
id|do_mathemu
c_func
(paren
id|regs
comma
id|f
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ret
)paren
r_return
suffix:semicolon
macro_line|#ifdef DEBUG_FPU
id|printk
c_func
(paren
l_string|&quot;fpother %016lx&bslash;n&quot;
comma
id|current-&gt;thread.xfsr
(braket
l_int|0
)braket
)paren
suffix:semicolon
macro_line|#endif
id|do_fpe_common
c_func
(paren
id|regs
)paren
suffix:semicolon
)brace
DECL|function|do_tof
r_void
id|do_tof
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|siginfo_t
id|info
suffix:semicolon
r_if
c_cond
(paren
id|regs-&gt;tstate
op_amp
id|TSTATE_PRIV
)paren
(brace
id|die_if_kernel
c_func
(paren
l_string|&quot;Penguin overflow trap from kernel mode&quot;
comma
id|regs
)paren
suffix:semicolon
)brace
id|info.si_signo
op_assign
id|SIGEMT
suffix:semicolon
id|info.si_errno
op_assign
l_int|0
suffix:semicolon
id|info.si_code
op_assign
id|EMT_TAGOVF
suffix:semicolon
id|info.si_addr
op_assign
(paren
r_void
op_star
)paren
id|regs-&gt;tpc
suffix:semicolon
id|info.si_trapno
op_assign
l_int|0
suffix:semicolon
id|force_sig_info
c_func
(paren
id|SIGEMT
comma
op_amp
id|info
comma
id|current
)paren
suffix:semicolon
)brace
DECL|function|do_div0
r_void
id|do_div0
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|siginfo_t
id|info
suffix:semicolon
id|info.si_signo
op_assign
id|SIGFPE
suffix:semicolon
id|info.si_errno
op_assign
l_int|0
suffix:semicolon
id|info.si_code
op_assign
id|FPE_INTDIV
suffix:semicolon
id|info.si_addr
op_assign
(paren
r_void
op_star
)paren
id|regs-&gt;tpc
suffix:semicolon
id|info.si_trapno
op_assign
l_int|0
suffix:semicolon
id|force_sig_info
c_func
(paren
id|SIGFPE
comma
op_amp
id|info
comma
id|current
)paren
suffix:semicolon
)brace
DECL|function|instruction_dump
r_void
id|instruction_dump
(paren
r_int
r_int
op_star
id|pc
)paren
(brace
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
(paren
r_int
r_int
)paren
id|pc
)paren
op_amp
l_int|3
)paren
)paren
(brace
r_return
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;Instruction DUMP:&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
op_minus
l_int|3
suffix:semicolon
id|i
OL
l_int|6
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%c%08x%c&quot;
comma
id|i
ques
c_cond
l_char|&squot; &squot;
suffix:colon
l_char|&squot;&lt;&squot;
comma
id|pc
(braket
id|i
)braket
comma
id|i
ques
c_cond
l_char|&squot; &squot;
suffix:colon
l_char|&squot;&gt;&squot;
)paren
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
DECL|function|user_instruction_dump
r_void
id|user_instruction_dump
(paren
r_int
r_int
op_star
id|pc
)paren
(brace
r_int
id|i
suffix:semicolon
r_int
r_int
id|buf
(braket
l_int|9
)braket
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
(paren
r_int
r_int
)paren
id|pc
)paren
op_amp
l_int|3
)paren
)paren
(brace
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
id|buf
comma
id|pc
op_minus
l_int|3
comma
r_sizeof
(paren
id|buf
)paren
)paren
)paren
(brace
r_return
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;Instruction DUMP:&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|9
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%c%08x%c&quot;
comma
id|i
op_eq
l_int|3
ques
c_cond
l_char|&squot; &squot;
suffix:colon
l_char|&squot;&lt;&squot;
comma
id|buf
(braket
id|i
)braket
comma
id|i
op_eq
l_int|3
ques
c_cond
l_char|&squot; &squot;
suffix:colon
l_char|&squot;&gt;&squot;
)paren
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
DECL|function|die_if_kernel
r_void
id|die_if_kernel
c_func
(paren
r_char
op_star
id|str
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_extern
r_void
id|__show_regs
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
suffix:semicolon
r_extern
r_void
id|smp_report_regs
c_func
(paren
r_void
)paren
suffix:semicolon
r_int
id|count
op_assign
l_int|0
suffix:semicolon
r_struct
id|reg_window
op_star
id|lastrw
suffix:semicolon
multiline_comment|/* Amuse the user. */
id|printk
c_func
(paren
l_string|&quot;              &bslash;&bslash;|/ ____ &bslash;&bslash;|/&bslash;n&quot;
l_string|&quot;              &bslash;&quot;@&squot;/ .. &bslash;&bslash;`@&bslash;&quot;&bslash;n&quot;
l_string|&quot;              /_| &bslash;&bslash;__/ |_&bslash;&bslash;&bslash;n&quot;
l_string|&quot;                 &bslash;&bslash;__U_/&bslash;n&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s(%d): %s&bslash;n&quot;
comma
id|current-&gt;comm
comma
id|current-&gt;pid
comma
id|str
)paren
suffix:semicolon
id|__asm__
id|__volatile__
c_func
(paren
l_string|&quot;flushw&quot;
)paren
suffix:semicolon
id|__show_regs
c_func
(paren
id|regs
)paren
suffix:semicolon
r_if
c_cond
(paren
id|regs-&gt;tstate
op_amp
id|TSTATE_PRIV
)paren
(brace
r_struct
id|reg_window
op_star
id|rw
op_assign
(paren
r_struct
id|reg_window
op_star
)paren
(paren
id|regs-&gt;u_regs
(braket
id|UREG_FP
)braket
op_plus
id|STACK_BIAS
)paren
suffix:semicolon
multiline_comment|/* Stop the back trace when we hit userland or we&n;&t;&t; * find some badly aligned kernel stack.&n;&t;&t; */
id|lastrw
op_assign
(paren
r_struct
id|reg_window
op_star
)paren
id|current
suffix:semicolon
r_while
c_loop
(paren
id|rw
op_logical_and
id|count
op_increment
OL
l_int|30
op_logical_and
id|rw
op_ge
id|lastrw
op_logical_and
(paren
r_char
op_star
)paren
id|rw
OL
(paren
(paren
r_char
op_star
)paren
id|current
)paren
op_plus
r_sizeof
(paren
r_union
id|task_union
)paren
op_logical_and
op_logical_neg
(paren
(paren
(paren
r_int
r_int
)paren
id|rw
)paren
op_amp
l_int|0x7
)paren
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;Caller[%016lx]&bslash;n&quot;
comma
id|rw-&gt;ins
(braket
l_int|7
)braket
)paren
suffix:semicolon
id|lastrw
op_assign
id|rw
suffix:semicolon
id|rw
op_assign
(paren
r_struct
id|reg_window
op_star
)paren
(paren
id|rw-&gt;ins
(braket
l_int|6
)braket
op_plus
id|STACK_BIAS
)paren
suffix:semicolon
)brace
id|instruction_dump
(paren
(paren
r_int
r_int
op_star
)paren
id|regs-&gt;tpc
)paren
suffix:semicolon
)brace
r_else
id|user_instruction_dump
(paren
(paren
r_int
r_int
op_star
)paren
id|regs-&gt;tpc
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_SMP
id|smp_report_regs
c_func
(paren
)paren
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
id|regs-&gt;tstate
op_amp
id|TSTATE_PRIV
)paren
(brace
id|do_exit
c_func
(paren
id|SIGKILL
)paren
suffix:semicolon
)brace
id|do_exit
c_func
(paren
id|SIGSEGV
)paren
suffix:semicolon
)brace
r_extern
r_int
id|handle_popc
c_func
(paren
id|u32
id|insn
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
suffix:semicolon
r_extern
r_int
id|handle_ldf_stq
c_func
(paren
id|u32
id|insn
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
suffix:semicolon
DECL|function|do_illegal_instruction
r_void
id|do_illegal_instruction
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_int
r_int
id|pc
op_assign
id|regs-&gt;tpc
suffix:semicolon
r_int
r_int
id|tstate
op_assign
id|regs-&gt;tstate
suffix:semicolon
id|u32
id|insn
suffix:semicolon
id|siginfo_t
id|info
suffix:semicolon
r_if
c_cond
(paren
id|tstate
op_amp
id|TSTATE_PRIV
)paren
(brace
id|die_if_kernel
c_func
(paren
l_string|&quot;Kernel illegal instruction&quot;
comma
id|regs
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|current-&gt;thread.flags
op_amp
id|SPARC_FLAG_32BIT
)paren
(brace
id|pc
op_assign
(paren
id|u32
)paren
id|pc
suffix:semicolon
)brace
r_if
c_cond
(paren
id|get_user
c_func
(paren
id|insn
comma
(paren
id|u32
op_star
)paren
id|pc
)paren
op_ne
op_minus
id|EFAULT
)paren
(brace
r_if
c_cond
(paren
(paren
id|insn
op_amp
l_int|0xc1ffc000
)paren
op_eq
l_int|0x81700000
)paren
multiline_comment|/* POPC */
(brace
r_if
c_cond
(paren
id|handle_popc
c_func
(paren
id|insn
comma
id|regs
)paren
)paren
r_return
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
id|insn
op_amp
l_int|0xc1580000
)paren
op_eq
l_int|0xc1100000
)paren
multiline_comment|/* LDQ/STQ */
(brace
r_if
c_cond
(paren
id|handle_ldf_stq
c_func
(paren
id|insn
comma
id|regs
)paren
)paren
r_return
suffix:semicolon
)brace
)brace
id|info.si_signo
op_assign
id|SIGILL
suffix:semicolon
id|info.si_errno
op_assign
l_int|0
suffix:semicolon
id|info.si_code
op_assign
id|ILL_ILLOPC
suffix:semicolon
id|info.si_addr
op_assign
(paren
r_void
op_star
)paren
id|pc
suffix:semicolon
id|info.si_trapno
op_assign
l_int|0
suffix:semicolon
id|force_sig_info
c_func
(paren
id|SIGILL
comma
op_amp
id|info
comma
id|current
)paren
suffix:semicolon
)brace
DECL|function|mem_address_unaligned
r_void
id|mem_address_unaligned
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
comma
r_int
r_int
id|sfar
comma
r_int
r_int
id|sfsr
)paren
(brace
id|siginfo_t
id|info
suffix:semicolon
r_if
c_cond
(paren
id|regs-&gt;tstate
op_amp
id|TSTATE_PRIV
)paren
(brace
r_extern
r_void
id|kernel_unaligned_trap
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
comma
r_int
r_int
id|insn
comma
r_int
r_int
id|sfar
comma
r_int
r_int
id|sfsr
)paren
suffix:semicolon
r_return
id|kernel_unaligned_trap
c_func
(paren
id|regs
comma
op_star
(paren
(paren
r_int
r_int
op_star
)paren
id|regs-&gt;tpc
)paren
comma
id|sfar
comma
id|sfsr
)paren
suffix:semicolon
)brace
id|info.si_signo
op_assign
id|SIGBUS
suffix:semicolon
id|info.si_errno
op_assign
l_int|0
suffix:semicolon
id|info.si_code
op_assign
id|BUS_ADRALN
suffix:semicolon
id|info.si_addr
op_assign
(paren
r_void
op_star
)paren
id|sfar
suffix:semicolon
id|info.si_trapno
op_assign
l_int|0
suffix:semicolon
id|force_sig_info
c_func
(paren
id|SIGBUS
comma
op_amp
id|info
comma
id|current
)paren
suffix:semicolon
)brace
DECL|function|do_privop
r_void
id|do_privop
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|siginfo_t
id|info
suffix:semicolon
id|info.si_signo
op_assign
id|SIGILL
suffix:semicolon
id|info.si_errno
op_assign
l_int|0
suffix:semicolon
id|info.si_code
op_assign
id|ILL_PRVOPC
suffix:semicolon
id|info.si_addr
op_assign
(paren
r_void
op_star
)paren
id|regs-&gt;tpc
suffix:semicolon
id|info.si_trapno
op_assign
l_int|0
suffix:semicolon
id|force_sig_info
c_func
(paren
id|SIGILL
comma
op_amp
id|info
comma
id|current
)paren
suffix:semicolon
)brace
DECL|function|do_privact
r_void
id|do_privact
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|do_privop
c_func
(paren
id|regs
)paren
suffix:semicolon
)brace
multiline_comment|/* Trap level 1 stuff or other traps we should never see... */
DECL|function|do_cee
r_void
id|do_cee
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|die_if_kernel
c_func
(paren
l_string|&quot;TL0: Cache Error Exception&quot;
comma
id|regs
)paren
suffix:semicolon
)brace
DECL|function|do_cee_tl1
r_void
id|do_cee_tl1
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|die_if_kernel
c_func
(paren
l_string|&quot;TL1: Cache Error Exception&quot;
comma
id|regs
)paren
suffix:semicolon
)brace
DECL|function|do_dae_tl1
r_void
id|do_dae_tl1
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|die_if_kernel
c_func
(paren
l_string|&quot;TL1: Data Access Exception&quot;
comma
id|regs
)paren
suffix:semicolon
)brace
DECL|function|do_iae_tl1
r_void
id|do_iae_tl1
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|die_if_kernel
c_func
(paren
l_string|&quot;TL1: Instruction Access Exception&quot;
comma
id|regs
)paren
suffix:semicolon
)brace
DECL|function|do_div0_tl1
r_void
id|do_div0_tl1
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|die_if_kernel
c_func
(paren
l_string|&quot;TL1: DIV0 Exception&quot;
comma
id|regs
)paren
suffix:semicolon
)brace
DECL|function|do_fpdis_tl1
r_void
id|do_fpdis_tl1
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|die_if_kernel
c_func
(paren
l_string|&quot;TL1: FPU Disabled&quot;
comma
id|regs
)paren
suffix:semicolon
)brace
DECL|function|do_fpieee_tl1
r_void
id|do_fpieee_tl1
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|die_if_kernel
c_func
(paren
l_string|&quot;TL1: FPU IEEE Exception&quot;
comma
id|regs
)paren
suffix:semicolon
)brace
DECL|function|do_fpother_tl1
r_void
id|do_fpother_tl1
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|die_if_kernel
c_func
(paren
l_string|&quot;TL1: FPU Other Exception&quot;
comma
id|regs
)paren
suffix:semicolon
)brace
DECL|function|do_ill_tl1
r_void
id|do_ill_tl1
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|die_if_kernel
c_func
(paren
l_string|&quot;TL1: Illegal Instruction Exception&quot;
comma
id|regs
)paren
suffix:semicolon
)brace
DECL|function|do_irq_tl1
r_void
id|do_irq_tl1
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|die_if_kernel
c_func
(paren
l_string|&quot;TL1: IRQ Exception&quot;
comma
id|regs
)paren
suffix:semicolon
)brace
DECL|function|do_lddfmna_tl1
r_void
id|do_lddfmna_tl1
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|die_if_kernel
c_func
(paren
l_string|&quot;TL1: LDDF Exception&quot;
comma
id|regs
)paren
suffix:semicolon
)brace
DECL|function|do_stdfmna_tl1
r_void
id|do_stdfmna_tl1
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|die_if_kernel
c_func
(paren
l_string|&quot;TL1: STDF Exception&quot;
comma
id|regs
)paren
suffix:semicolon
)brace
DECL|function|do_paw
r_void
id|do_paw
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|die_if_kernel
c_func
(paren
l_string|&quot;TL0: Phys Watchpoint Exception&quot;
comma
id|regs
)paren
suffix:semicolon
)brace
DECL|function|do_paw_tl1
r_void
id|do_paw_tl1
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|die_if_kernel
c_func
(paren
l_string|&quot;TL1: Phys Watchpoint Exception&quot;
comma
id|regs
)paren
suffix:semicolon
)brace
DECL|function|do_vaw
r_void
id|do_vaw
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|die_if_kernel
c_func
(paren
l_string|&quot;TL0: Virt Watchpoint Exception&quot;
comma
id|regs
)paren
suffix:semicolon
)brace
DECL|function|do_vaw_tl1
r_void
id|do_vaw_tl1
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|die_if_kernel
c_func
(paren
l_string|&quot;TL1: Virt Watchpoint Exception&quot;
comma
id|regs
)paren
suffix:semicolon
)brace
DECL|function|do_tof_tl1
r_void
id|do_tof_tl1
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|die_if_kernel
c_func
(paren
l_string|&quot;TL1: Tag Overflow Exception&quot;
comma
id|regs
)paren
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_EC_FLUSH_TRAP
DECL|function|cache_flush_trap
r_void
id|cache_flush_trap
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
macro_line|#ifndef CONFIG_SMP
r_int
id|node
op_assign
id|linux_cpus
(braket
id|get_cpuid
c_func
(paren
)paren
)braket
dot
id|prom_node
suffix:semicolon
macro_line|#else
macro_line|#error cache_flush_trap not supported on sparc64/SMP yet
macro_line|#endif
macro_line|#if 0
multiline_comment|/* Broken */
r_int
id|size
op_assign
id|prom_getintdefault
c_func
(paren
id|node
comma
l_string|&quot;ecache-size&quot;
comma
l_int|512
op_star
l_int|1024
)paren
suffix:semicolon
r_int
id|i
comma
id|j
suffix:semicolon
r_int
r_int
id|addr
suffix:semicolon
r_struct
id|page
op_star
id|page
comma
op_star
id|end
suffix:semicolon
id|regs-&gt;tpc
op_assign
id|regs-&gt;tnpc
suffix:semicolon
id|regs-&gt;tnpc
op_assign
id|regs-&gt;tnpc
op_plus
l_int|4
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|capable
c_func
(paren
id|CAP_SYS_ADMIN
)paren
)paren
r_return
suffix:semicolon
id|size
op_rshift_assign
id|PAGE_SHIFT
suffix:semicolon
id|addr
op_assign
id|PAGE_OFFSET
op_minus
id|PAGE_SIZE
suffix:semicolon
id|page
op_assign
id|mem_map
op_minus
l_int|1
suffix:semicolon
id|end
op_assign
id|mem_map
op_plus
id|max_mapnr
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|size
suffix:semicolon
id|i
op_increment
)paren
(brace
r_do
(brace
id|addr
op_add_assign
id|PAGE_SIZE
suffix:semicolon
id|page
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|page
op_ge
id|end
)paren
r_return
suffix:semicolon
)brace
r_while
c_loop
(paren
op_logical_neg
id|PageReserved
c_func
(paren
id|page
)paren
)paren
suffix:semicolon
multiline_comment|/* E-Cache line size is 64B. Let us pollute it :)) */
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
id|PAGE_SIZE
suffix:semicolon
id|j
op_add_assign
l_int|64
)paren
id|__asm__
id|__volatile__
(paren
l_string|&quot;ldx [%0 + %1], %%g1&quot;
suffix:colon
suffix:colon
l_string|&quot;r&quot;
(paren
id|j
)paren
comma
l_string|&quot;r&quot;
(paren
id|addr
)paren
suffix:colon
l_string|&quot;g1&quot;
)paren
suffix:semicolon
)brace
macro_line|#endif
)brace
macro_line|#endif
DECL|function|do_getpsr
r_void
id|do_getpsr
c_func
(paren
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|regs-&gt;u_regs
(braket
id|UREG_I0
)braket
op_assign
id|tstate_to_psr
c_func
(paren
id|regs-&gt;tstate
)paren
suffix:semicolon
id|regs-&gt;tpc
op_assign
id|regs-&gt;tnpc
suffix:semicolon
id|regs-&gt;tnpc
op_add_assign
l_int|4
suffix:semicolon
)brace
DECL|function|trap_init
r_void
id|trap_init
c_func
(paren
r_void
)paren
(brace
multiline_comment|/* Attach to the address space of init_task. */
id|atomic_inc
c_func
(paren
op_amp
id|init_mm.mm_count
)paren
suffix:semicolon
id|current-&gt;active_mm
op_assign
op_amp
id|init_mm
suffix:semicolon
multiline_comment|/* NOTE: Other cpus have this done as they are started&n;&t; *       up on SMP.&n;&t; */
)brace
eof
