multiline_comment|/* auxio.c: Probing for the Sparc AUXIO register at boot time.&n; *&n; * Copyright (C) 1996 David S. Miller (davem@caip.rutgers.edu)&n; */
macro_line|#include &lt;linux/stddef.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/smp.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;asm/oplib.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;asm/auxio.h&gt;
macro_line|#include &lt;asm/sbus.h&gt;
multiline_comment|/* Probe and map in the Auxiliary I/O register */
DECL|variable|auxio_register
r_int
r_char
op_star
id|auxio_register
suffix:semicolon
DECL|function|__initfunc
id|__initfunc
c_func
(paren
r_void
id|auxio_probe
c_func
(paren
r_void
)paren
)paren
(brace
r_struct
id|linux_sbus
op_star
id|bus
suffix:semicolon
r_struct
id|linux_sbus_device
op_star
id|sdev
op_assign
l_int|0
suffix:semicolon
r_struct
id|linux_prom_registers
id|auxregs
(braket
l_int|1
)braket
suffix:semicolon
id|for_each_sbus
c_func
(paren
id|bus
)paren
(brace
id|for_each_sbusdev
c_func
(paren
id|sdev
comma
id|bus
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|sdev-&gt;prom_name
comma
l_string|&quot;auxio&quot;
)paren
)paren
(brace
r_break
suffix:semicolon
)brace
)brace
)brace
r_if
c_cond
(paren
op_logical_neg
id|sdev
)paren
(brace
id|prom_printf
c_func
(paren
l_string|&quot;Cannot find auxio node, cannot continue...&bslash;n&quot;
)paren
suffix:semicolon
id|prom_halt
c_func
(paren
)paren
suffix:semicolon
)brace
id|prom_getproperty
c_func
(paren
id|sdev-&gt;prom_node
comma
l_string|&quot;reg&quot;
comma
(paren
r_char
op_star
)paren
id|auxregs
comma
r_sizeof
(paren
id|auxregs
)paren
)paren
suffix:semicolon
id|prom_apply_sbus_ranges
c_func
(paren
id|sdev-&gt;my_bus
comma
id|auxregs
comma
l_int|0x1
comma
id|sdev
)paren
suffix:semicolon
multiline_comment|/* Map the register both read and write */
id|auxio_register
op_assign
(paren
r_int
r_char
op_star
)paren
id|sparc_alloc_io
c_func
(paren
id|auxregs
(braket
l_int|0
)braket
dot
id|phys_addr
comma
l_int|0
comma
id|auxregs
(braket
l_int|0
)braket
dot
id|reg_size
comma
l_string|&quot;auxiliaryIO&quot;
comma
id|auxregs
(braket
l_int|0
)braket
dot
id|which_io
comma
l_int|0x0
)paren
suffix:semicolon
id|TURN_ON_LED
suffix:semicolon
)brace
eof
