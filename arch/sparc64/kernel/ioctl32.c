multiline_comment|/* $Id: ioctl32.c,v 1.8 1997/06/04 13:05:15 jj Exp $&n; * ioctl32.c: Conversion between 32bit and 64bit native ioctls.&n; *&n; * Copyright (C) 1997 Jakub Jelinek (jj@sunsite.mff.cuni.cz)&n; *&n; * These routines maintain argument size conversion between 32bit and 64bit&n; * ioctls.&n; */
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/smp.h&gt;
macro_line|#include &lt;linux/smp_lock.h&gt;
macro_line|#include &lt;linux/ioctl.h&gt;
macro_line|#include &lt;linux/if.h&gt;
macro_line|#include &lt;linux/malloc.h&gt;
macro_line|#include &lt;linux/hdreg.h&gt;
macro_line|#include &lt;linux/md.h&gt;
macro_line|#include &lt;linux/kd.h&gt;
macro_line|#include &lt;linux/route.h&gt;
macro_line|#include &lt;linux/netlink.h&gt;
macro_line|#include &lt;asm/types.h&gt;
macro_line|#include &lt;asm/uaccess.h&gt;
multiline_comment|/* As gcc will warn about casting u32 to some ptr, we have to cast it to&n; * unsigned long first, and that&squot;s what is A() for.&n; * You just do (void *)A(x), instead of having to type (void *)((unsigned long)x)&n; * or instead of just (void *)x, which will produce warnings.&n; */
DECL|macro|A
mdefine_line|#define A(x) ((unsigned long)x)
r_extern
id|asmlinkage
r_int
id|sys_ioctl
c_func
(paren
r_int
r_int
id|fd
comma
r_int
r_int
id|cmd
comma
r_int
r_int
id|arg
)paren
suffix:semicolon
DECL|function|w_long
r_static
r_int
id|w_long
c_func
(paren
r_int
r_int
id|fd
comma
r_int
r_int
id|cmd
comma
id|u32
id|arg
)paren
(brace
r_int
r_int
id|old_fs
op_assign
id|get_fs
c_func
(paren
)paren
suffix:semicolon
r_int
id|err
suffix:semicolon
r_int
r_int
id|val
suffix:semicolon
id|set_fs
(paren
id|KERNEL_DS
)paren
suffix:semicolon
id|err
op_assign
id|sys_ioctl
c_func
(paren
id|fd
comma
id|cmd
comma
(paren
r_int
r_int
)paren
op_amp
id|val
)paren
suffix:semicolon
id|set_fs
(paren
id|old_fs
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|err
op_logical_and
id|put_user
c_func
(paren
id|val
comma
(paren
id|u32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|struct|ifmap32
r_struct
id|ifmap32
(brace
DECL|member|mem_start
id|u32
id|mem_start
suffix:semicolon
DECL|member|mem_end
id|u32
id|mem_end
suffix:semicolon
DECL|member|base_addr
r_int
r_int
id|base_addr
suffix:semicolon
DECL|member|irq
r_int
r_char
id|irq
suffix:semicolon
DECL|member|dma
r_int
r_char
id|dma
suffix:semicolon
DECL|member|port
r_int
r_char
id|port
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|ifreq32
r_struct
id|ifreq32
(brace
DECL|macro|IFHWADDRLEN
mdefine_line|#define IFHWADDRLEN     6
DECL|macro|IFNAMSIZ
mdefine_line|#define IFNAMSIZ        16
r_union
(brace
DECL|member|ifrn_name
r_char
id|ifrn_name
(braket
id|IFNAMSIZ
)braket
suffix:semicolon
multiline_comment|/* if name, e.g. &quot;en0&quot; */
DECL|member|ifr_ifrn
)brace
id|ifr_ifrn
suffix:semicolon
r_union
(brace
DECL|member|ifru_addr
r_struct
id|sockaddr
id|ifru_addr
suffix:semicolon
DECL|member|ifru_dstaddr
r_struct
id|sockaddr
id|ifru_dstaddr
suffix:semicolon
DECL|member|ifru_broadaddr
r_struct
id|sockaddr
id|ifru_broadaddr
suffix:semicolon
DECL|member|ifru_netmask
r_struct
id|sockaddr
id|ifru_netmask
suffix:semicolon
DECL|member|ifru_hwaddr
r_struct
id|sockaddr
id|ifru_hwaddr
suffix:semicolon
DECL|member|ifru_flags
r_int
id|ifru_flags
suffix:semicolon
DECL|member|ifru_ivalue
r_int
id|ifru_ivalue
suffix:semicolon
DECL|member|ifru_mtu
r_int
id|ifru_mtu
suffix:semicolon
DECL|member|ifru_map
r_struct
id|ifmap32
id|ifru_map
suffix:semicolon
DECL|member|ifru_slave
r_char
id|ifru_slave
(braket
id|IFNAMSIZ
)braket
suffix:semicolon
multiline_comment|/* Just fits the size */
DECL|member|ifru_data
id|__kernel_caddr_t32
id|ifru_data
suffix:semicolon
DECL|member|ifr_ifru
)brace
id|ifr_ifru
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|ifconf32
r_struct
id|ifconf32
(brace
DECL|member|ifc_len
r_int
id|ifc_len
suffix:semicolon
multiline_comment|/* size of buffer       */
DECL|member|ifcbuf
id|__kernel_caddr_t32
id|ifcbuf
suffix:semicolon
)brace
suffix:semicolon
DECL|function|dev_ifconf
r_static
r_inline
r_int
id|dev_ifconf
c_func
(paren
r_int
r_int
id|fd
comma
id|u32
id|arg
)paren
(brace
r_struct
id|ifconf32
id|ifc32
suffix:semicolon
r_struct
id|ifconf
id|ifc
suffix:semicolon
r_struct
id|ifreq32
op_star
id|ifr32
suffix:semicolon
r_struct
id|ifreq
op_star
id|ifr
suffix:semicolon
r_int
r_int
id|old_fs
suffix:semicolon
r_int
r_int
id|i
comma
id|j
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|ifc32
comma
(paren
r_struct
id|ifconf32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
comma
r_sizeof
(paren
r_struct
id|ifconf32
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|ifc.ifc_len
op_assign
(paren
(paren
id|ifc32.ifc_len
op_div
r_sizeof
(paren
r_struct
id|ifreq32
)paren
)paren
op_plus
l_int|1
)paren
op_star
r_sizeof
(paren
r_struct
id|ifreq
)paren
suffix:semicolon
id|ifc.ifc_buf
op_assign
id|kmalloc
(paren
id|ifc.ifc_len
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ifc.ifc_buf
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|ifr
op_assign
id|ifc.ifc_req
suffix:semicolon
id|ifr32
op_assign
(paren
r_struct
id|ifreq32
op_star
)paren
id|A
c_func
(paren
id|ifc32.ifcbuf
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ifc32.ifc_len
suffix:semicolon
id|i
op_add_assign
r_sizeof
(paren
r_struct
id|ifreq32
)paren
)paren
(brace
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
id|ifr
op_increment
comma
id|ifr32
op_increment
comma
r_sizeof
(paren
r_struct
id|ifreq32
)paren
)paren
)paren
(brace
id|kfree
(paren
id|ifc.ifc_buf
)paren
suffix:semicolon
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
)brace
id|old_fs
op_assign
id|get_fs
c_func
(paren
)paren
suffix:semicolon
id|set_fs
(paren
id|KERNEL_DS
)paren
suffix:semicolon
id|err
op_assign
id|sys_ioctl
(paren
id|fd
comma
id|SIOCGIFCONF
comma
(paren
r_int
r_int
)paren
op_amp
id|ifc
)paren
suffix:semicolon
id|set_fs
(paren
id|old_fs
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|err
)paren
(brace
id|ifr
op_assign
id|ifc.ifc_req
suffix:semicolon
id|ifr32
op_assign
(paren
r_struct
id|ifreq32
op_star
)paren
id|A
c_func
(paren
id|ifc32.ifcbuf
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
comma
id|j
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ifc32.ifc_len
op_logical_and
id|j
OL
id|ifc.ifc_len
suffix:semicolon
id|i
op_add_assign
r_sizeof
(paren
r_struct
id|ifreq32
)paren
comma
id|j
op_add_assign
r_sizeof
(paren
r_struct
id|ifreq
)paren
)paren
(brace
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|ifr32
op_increment
comma
id|ifr
op_increment
comma
r_sizeof
(paren
r_struct
id|ifreq32
)paren
)paren
)paren
(brace
id|err
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
op_logical_neg
id|err
)paren
(brace
r_if
c_cond
(paren
id|i
op_le
id|ifc32.ifc_len
)paren
id|ifc32.ifc_len
op_assign
id|i
suffix:semicolon
r_else
id|ifc32.ifc_len
op_assign
id|i
op_minus
r_sizeof
(paren
r_struct
id|ifreq32
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
(paren
r_struct
id|ifconf32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
comma
op_amp
id|ifc32
comma
r_sizeof
(paren
r_struct
id|ifconf32
)paren
)paren
)paren
id|err
op_assign
op_minus
id|EFAULT
suffix:semicolon
)brace
)brace
id|kfree
(paren
id|ifc.ifc_buf
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|dev_ifsioc
r_static
r_inline
r_int
id|dev_ifsioc
c_func
(paren
r_int
r_int
id|fd
comma
r_int
r_int
id|cmd
comma
id|u32
id|arg
)paren
(brace
r_struct
id|ifreq
id|ifr
suffix:semicolon
r_int
r_int
id|old_fs
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|cmd
op_eq
id|SIOCSIFMAP
)paren
(brace
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|ifr
comma
(paren
r_struct
id|ifreq32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
comma
r_sizeof
(paren
id|ifr.ifr_name
)paren
)paren
op_logical_or
id|__get_user
c_func
(paren
id|ifr.ifr_map.mem_start
comma
op_amp
(paren
(paren
(paren
r_struct
id|ifreq32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|ifr_ifru.ifru_map.mem_start
)paren
)paren
op_logical_or
id|__get_user
c_func
(paren
id|ifr.ifr_map.mem_end
comma
op_amp
(paren
(paren
(paren
r_struct
id|ifreq32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|ifr_ifru.ifru_map.mem_end
)paren
)paren
op_logical_or
id|__get_user
c_func
(paren
id|ifr.ifr_map.base_addr
comma
op_amp
(paren
(paren
(paren
r_struct
id|ifreq32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|ifr_ifru.ifru_map.base_addr
)paren
)paren
op_logical_or
id|__get_user
c_func
(paren
id|ifr.ifr_map.irq
comma
op_amp
(paren
(paren
(paren
r_struct
id|ifreq32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|ifr_ifru.ifru_map.irq
)paren
)paren
op_logical_or
id|__get_user
c_func
(paren
id|ifr.ifr_map.dma
comma
op_amp
(paren
(paren
(paren
r_struct
id|ifreq32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|ifr_ifru.ifru_map.dma
)paren
)paren
op_logical_or
id|__get_user
c_func
(paren
id|ifr.ifr_map.port
comma
op_amp
(paren
(paren
(paren
r_struct
id|ifreq32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|ifr_ifru.ifru_map.port
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|ifr
comma
(paren
r_struct
id|ifreq32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
comma
r_sizeof
(paren
r_struct
id|ifreq32
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
id|old_fs
op_assign
id|get_fs
c_func
(paren
)paren
suffix:semicolon
id|set_fs
(paren
id|KERNEL_DS
)paren
suffix:semicolon
id|err
op_assign
id|sys_ioctl
(paren
id|fd
comma
id|cmd
comma
(paren
r_int
r_int
)paren
op_amp
id|ifr
)paren
suffix:semicolon
id|set_fs
(paren
id|old_fs
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|err
)paren
(brace
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|SIOCGIFFLAGS
suffix:colon
r_case
id|SIOCGIFMETRIC
suffix:colon
r_case
id|SIOCGIFMTU
suffix:colon
r_case
id|SIOCGIFMEM
suffix:colon
r_case
id|SIOCGIFHWADDR
suffix:colon
r_case
id|SIOGIFINDEX
suffix:colon
r_case
id|SIOCGIFADDR
suffix:colon
r_case
id|SIOCGIFBRDADDR
suffix:colon
r_case
id|SIOCGIFDSTADDR
suffix:colon
r_case
id|SIOCGIFNETMASK
suffix:colon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
(paren
r_struct
id|ifreq32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
comma
op_amp
id|ifr
comma
r_sizeof
(paren
r_struct
id|ifreq32
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SIOCGIFMAP
suffix:colon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
(paren
r_struct
id|ifreq32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
comma
op_amp
id|ifr
comma
r_sizeof
(paren
id|ifr.ifr_name
)paren
)paren
op_logical_or
id|__put_user
c_func
(paren
id|ifr.ifr_map.mem_start
comma
op_amp
(paren
(paren
(paren
r_struct
id|ifreq32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|ifr_ifru.ifru_map.mem_start
)paren
)paren
op_logical_or
id|__put_user
c_func
(paren
id|ifr.ifr_map.mem_end
comma
op_amp
(paren
(paren
(paren
r_struct
id|ifreq32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|ifr_ifru.ifru_map.mem_end
)paren
)paren
op_logical_or
id|__put_user
c_func
(paren
id|ifr.ifr_map.base_addr
comma
op_amp
(paren
(paren
(paren
r_struct
id|ifreq32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|ifr_ifru.ifru_map.base_addr
)paren
)paren
op_logical_or
id|__put_user
c_func
(paren
id|ifr.ifr_map.irq
comma
op_amp
(paren
(paren
(paren
r_struct
id|ifreq32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|ifr_ifru.ifru_map.irq
)paren
)paren
op_logical_or
id|__put_user
c_func
(paren
id|ifr.ifr_map.dma
comma
op_amp
(paren
(paren
(paren
r_struct
id|ifreq32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|ifr_ifru.ifru_map.dma
)paren
)paren
op_logical_or
id|__put_user
c_func
(paren
id|ifr.ifr_map.port
comma
op_amp
(paren
(paren
(paren
r_struct
id|ifreq32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|ifr_ifru.ifru_map.port
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_return
id|err
suffix:semicolon
)brace
DECL|struct|rtentry32
r_struct
id|rtentry32
(brace
DECL|member|rt_pad1
id|u32
id|rt_pad1
suffix:semicolon
DECL|member|rt_dst
r_struct
id|sockaddr
id|rt_dst
suffix:semicolon
multiline_comment|/* target address               */
DECL|member|rt_gateway
r_struct
id|sockaddr
id|rt_gateway
suffix:semicolon
multiline_comment|/* gateway addr (RTF_GATEWAY)   */
DECL|member|rt_genmask
r_struct
id|sockaddr
id|rt_genmask
suffix:semicolon
multiline_comment|/* target network mask (IP)     */
DECL|member|rt_flags
r_int
r_int
id|rt_flags
suffix:semicolon
DECL|member|rt_pad2
r_int
id|rt_pad2
suffix:semicolon
DECL|member|rt_pad3
id|u32
id|rt_pad3
suffix:semicolon
DECL|member|rt_tos
r_int
r_char
id|rt_tos
suffix:semicolon
DECL|member|rt_class
r_int
r_char
id|rt_class
suffix:semicolon
DECL|member|rt_pad4
r_int
id|rt_pad4
suffix:semicolon
DECL|member|rt_metric
r_int
id|rt_metric
suffix:semicolon
multiline_comment|/* +1 for binary compatibility! */
DECL|member|rt_dev
multiline_comment|/* char * */
id|u32
id|rt_dev
suffix:semicolon
multiline_comment|/* forcing the device at add    */
DECL|member|rt_mtu
id|u32
id|rt_mtu
suffix:semicolon
multiline_comment|/* per route MTU/Window         */
DECL|member|rt_window
id|u32
id|rt_window
suffix:semicolon
multiline_comment|/* Window clamping              */
DECL|member|rt_irtt
r_int
r_int
id|rt_irtt
suffix:semicolon
multiline_comment|/* Initial RTT                  */
)brace
suffix:semicolon
DECL|function|routing_ioctl
r_static
r_inline
r_int
id|routing_ioctl
c_func
(paren
r_int
r_int
id|fd
comma
r_int
r_int
id|cmd
comma
id|u32
id|arg
)paren
(brace
r_struct
id|rtentry
id|r
suffix:semicolon
r_char
id|devname
(braket
l_int|16
)braket
suffix:semicolon
id|u32
id|rtdev
suffix:semicolon
r_int
id|ret
suffix:semicolon
r_int
r_int
id|old_fs
op_assign
id|get_fs
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|get_user
(paren
id|r.rt_pad1
comma
op_amp
(paren
(paren
(paren
r_struct
id|rtentry32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|rt_pad1
)paren
)paren
op_logical_or
id|copy_from_user
(paren
op_amp
id|r.rt_dst
comma
op_amp
(paren
(paren
(paren
r_struct
id|rtentry32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|rt_dst
)paren
comma
l_int|3
op_star
r_sizeof
(paren
r_struct
id|sockaddr
)paren
)paren
op_logical_or
id|__get_user
(paren
id|r.rt_flags
comma
op_amp
(paren
(paren
(paren
r_struct
id|rtentry32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|rt_flags
)paren
)paren
op_logical_or
id|__get_user
(paren
id|r.rt_pad2
comma
op_amp
(paren
(paren
(paren
r_struct
id|rtentry32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|rt_pad2
)paren
)paren
op_logical_or
id|__get_user
(paren
id|r.rt_pad3
comma
op_amp
(paren
(paren
(paren
r_struct
id|rtentry32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|rt_pad3
)paren
)paren
op_logical_or
id|__get_user
(paren
id|r.rt_tos
comma
op_amp
(paren
(paren
(paren
r_struct
id|rtentry32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|rt_tos
)paren
)paren
op_logical_or
id|__get_user
(paren
id|r.rt_class
comma
op_amp
(paren
(paren
(paren
r_struct
id|rtentry32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|rt_class
)paren
)paren
op_logical_or
id|__get_user
(paren
id|r.rt_pad4
comma
op_amp
(paren
(paren
(paren
r_struct
id|rtentry32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|rt_pad4
)paren
)paren
op_logical_or
id|__get_user
(paren
id|r.rt_metric
comma
op_amp
(paren
(paren
(paren
r_struct
id|rtentry32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|rt_metric
)paren
)paren
op_logical_or
id|__get_user
(paren
id|r.rt_mtu
comma
op_amp
(paren
(paren
(paren
r_struct
id|rtentry32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|rt_mtu
)paren
)paren
op_logical_or
id|__get_user
(paren
id|r.rt_window
comma
op_amp
(paren
(paren
(paren
r_struct
id|rtentry32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|rt_window
)paren
)paren
op_logical_or
id|__get_user
(paren
id|r.rt_irtt
comma
op_amp
(paren
(paren
(paren
r_struct
id|rtentry32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|rt_irtt
)paren
)paren
op_logical_or
id|__get_user
(paren
id|rtdev
comma
op_amp
(paren
(paren
(paren
r_struct
id|rtentry32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|rt_dev
)paren
)paren
op_logical_or
(paren
id|rtdev
op_logical_and
id|copy_from_user
(paren
id|devname
comma
(paren
r_char
op_star
)paren
id|A
c_func
(paren
id|rtdev
)paren
comma
l_int|15
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|rtdev
)paren
(brace
id|r.rt_dev
op_assign
id|devname
suffix:semicolon
id|devname
(braket
l_int|15
)braket
op_assign
l_int|0
suffix:semicolon
)brace
r_else
id|r.rt_dev
op_assign
l_int|0
suffix:semicolon
id|set_fs
(paren
id|KERNEL_DS
)paren
suffix:semicolon
id|ret
op_assign
id|sys_ioctl
(paren
id|fd
comma
id|cmd
comma
(paren
r_int
)paren
op_amp
id|r
)paren
suffix:semicolon
id|set_fs
(paren
id|old_fs
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|struct|nlmsghdr32
r_struct
id|nlmsghdr32
(brace
DECL|member|nlmsg_len
id|u32
id|nlmsg_len
suffix:semicolon
multiline_comment|/* Length of message including header */
DECL|member|nlmsg_type
id|u32
id|nlmsg_type
suffix:semicolon
multiline_comment|/* Message type */
DECL|member|nlmsg_seq
id|u32
id|nlmsg_seq
suffix:semicolon
multiline_comment|/* Sequence number */
DECL|member|nlmsg_pid
id|u32
id|nlmsg_pid
suffix:semicolon
multiline_comment|/* Sending process PID */
DECL|member|nlmsg_data
r_int
r_char
id|nlmsg_data
(braket
l_int|0
)braket
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|in_rtmsg32
r_struct
id|in_rtmsg32
(brace
DECL|member|rtmsg_prefix
r_struct
id|in_addr
id|rtmsg_prefix
suffix:semicolon
DECL|member|rtmsg_gateway
r_struct
id|in_addr
id|rtmsg_gateway
suffix:semicolon
DECL|member|rtmsg_flags
r_int
id|rtmsg_flags
suffix:semicolon
DECL|member|rtmsg_mtu
id|u32
id|rtmsg_mtu
suffix:semicolon
DECL|member|rtmsg_window
id|u32
id|rtmsg_window
suffix:semicolon
DECL|member|rtmsg_rtt
r_int
r_int
id|rtmsg_rtt
suffix:semicolon
DECL|member|rtmsg_metric
r_int
id|rtmsg_metric
suffix:semicolon
DECL|member|rtmsg_tos
r_int
r_char
id|rtmsg_tos
suffix:semicolon
DECL|member|rtmsg_class
r_int
r_char
id|rtmsg_class
suffix:semicolon
DECL|member|rtmsg_prefixlen
r_int
r_char
id|rtmsg_prefixlen
suffix:semicolon
DECL|member|rtmsg_reserved
r_int
r_char
id|rtmsg_reserved
suffix:semicolon
DECL|member|rtmsg_ifindex
r_int
id|rtmsg_ifindex
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|in_ifmsg32
r_struct
id|in_ifmsg32
(brace
DECL|member|ifmsg_lladdr
r_struct
id|sockaddr
id|ifmsg_lladdr
suffix:semicolon
DECL|member|ifmsg_prefix
r_struct
id|in_addr
id|ifmsg_prefix
suffix:semicolon
DECL|member|ifmsg_brd
r_struct
id|in_addr
id|ifmsg_brd
suffix:semicolon
DECL|member|ifmsg_flags
r_int
id|ifmsg_flags
suffix:semicolon
DECL|member|ifmsg_mtu
id|u32
id|ifmsg_mtu
suffix:semicolon
DECL|member|ifmsg_metric
r_int
id|ifmsg_metric
suffix:semicolon
DECL|member|ifmsg_prefixlen
r_int
r_char
id|ifmsg_prefixlen
suffix:semicolon
DECL|member|ifmsg_reserved
r_int
r_char
id|ifmsg_reserved
suffix:semicolon
DECL|member|ifmsg_index
r_int
id|ifmsg_index
suffix:semicolon
DECL|member|ifmsg_name
r_char
id|ifmsg_name
(braket
l_int|16
)braket
suffix:semicolon
)brace
suffix:semicolon
DECL|function|rtmsg_ioctl
r_static
r_inline
r_int
id|rtmsg_ioctl
c_func
(paren
r_int
r_int
id|fd
comma
id|u32
id|arg
)paren
(brace
r_struct
(brace
r_struct
id|nlmsghdr
id|n
suffix:semicolon
r_union
(brace
r_struct
id|in_rtmsg
id|rt
suffix:semicolon
r_struct
id|in_ifmsg
id|iff
suffix:semicolon
r_struct
id|in_rtctlmsg
id|ctl
suffix:semicolon
r_struct
id|in_rtrulemsg
id|rule
suffix:semicolon
)brace
id|u
suffix:semicolon
)brace
id|nn
suffix:semicolon
r_char
op_star
id|p
suffix:semicolon
r_int
id|ret
suffix:semicolon
r_int
r_int
id|old_fs
op_assign
id|get_fs
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|get_user
(paren
id|nn.n.nlmsg_len
comma
op_amp
(paren
(paren
(paren
r_struct
id|nlmsghdr32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|nlmsg_len
)paren
)paren
op_logical_or
id|__get_user
(paren
id|nn.n.nlmsg_type
comma
op_amp
(paren
(paren
(paren
r_struct
id|nlmsghdr32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|nlmsg_type
)paren
)paren
op_logical_or
id|__get_user
(paren
id|nn.n.nlmsg_seq
comma
op_amp
(paren
(paren
(paren
r_struct
id|nlmsghdr32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|nlmsg_seq
)paren
)paren
op_logical_or
id|__get_user
(paren
id|nn.n.nlmsg_pid
comma
op_amp
(paren
(paren
(paren
r_struct
id|nlmsghdr32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|nlmsg_pid
)paren
)paren
op_logical_or
id|__get_user
(paren
id|nn.n.nlmsg_data
(braket
l_int|0
)braket
comma
op_amp
(paren
(paren
(paren
r_struct
id|nlmsghdr32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|nlmsg_data
(braket
l_int|0
)braket
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|p
op_assign
(paren
(paren
r_char
op_star
)paren
(paren
op_amp
id|nn.n
)paren
)paren
op_plus
r_sizeof
(paren
r_struct
id|nlmsghdr
)paren
suffix:semicolon
id|arg
op_add_assign
r_sizeof
(paren
r_struct
id|nlmsghdr32
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|nn.n.nlmsg_type
)paren
(brace
r_case
id|RTMSG_NEWRULE
suffix:colon
r_case
id|RTMSG_DELRULE
suffix:colon
r_if
c_cond
(paren
id|nn.n.nlmsg_len
OL
r_sizeof
(paren
r_struct
id|nlmsghdr32
)paren
op_plus
r_sizeof
(paren
r_struct
id|in_rtrulemsg
)paren
op_minus
r_sizeof
(paren
r_struct
id|in_rtmsg
)paren
op_plus
r_sizeof
(paren
r_struct
id|in_rtmsg32
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
(paren
id|p
comma
(paren
r_struct
id|in_rtrulemsg
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
comma
r_sizeof
(paren
r_struct
id|in_rtrulemsg
)paren
op_minus
r_sizeof
(paren
r_struct
id|in_rtmsg
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|nn.n.nlmsg_len
op_assign
r_sizeof
(paren
r_struct
id|nlmsghdr
)paren
op_plus
r_sizeof
(paren
r_struct
id|in_rtrulemsg
)paren
suffix:semicolon
id|p
op_add_assign
r_sizeof
(paren
r_struct
id|in_rtrulemsg
)paren
op_minus
r_sizeof
(paren
r_struct
id|in_rtmsg
)paren
suffix:semicolon
id|arg
op_add_assign
r_sizeof
(paren
r_struct
id|in_rtrulemsg
)paren
op_minus
r_sizeof
(paren
r_struct
id|in_rtmsg
)paren
suffix:semicolon
r_goto
id|newroute
suffix:semicolon
r_case
id|RTMSG_NEWROUTE
suffix:colon
r_case
id|RTMSG_DELROUTE
suffix:colon
r_if
c_cond
(paren
id|nn.n.nlmsg_len
OL
r_sizeof
(paren
r_struct
id|nlmsghdr32
)paren
op_plus
r_sizeof
(paren
r_struct
id|in_rtmsg
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|nn.n.nlmsg_len
op_assign
r_sizeof
(paren
r_struct
id|nlmsghdr
)paren
op_plus
r_sizeof
(paren
r_struct
id|in_rtmsg
)paren
suffix:semicolon
id|newroute
suffix:colon
r_if
c_cond
(paren
id|copy_from_user
(paren
id|p
comma
(paren
r_struct
id|in_rtmsg32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
comma
l_int|2
op_star
r_sizeof
(paren
r_struct
id|in_addr
)paren
op_plus
r_sizeof
(paren
r_int
)paren
)paren
op_logical_or
id|__get_user
(paren
(paren
(paren
r_struct
id|in_rtmsg
op_star
)paren
id|p
)paren
op_member_access_from_pointer
id|rtmsg_mtu
comma
op_amp
(paren
(paren
r_struct
id|in_rtmsg32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|rtmsg_mtu
)paren
op_logical_or
id|__get_user
(paren
(paren
(paren
r_struct
id|in_rtmsg
op_star
)paren
id|p
)paren
op_member_access_from_pointer
id|rtmsg_window
comma
op_amp
(paren
(paren
r_struct
id|in_rtmsg32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|rtmsg_window
)paren
op_logical_or
id|copy_from_user
(paren
op_amp
(paren
(paren
(paren
r_struct
id|in_rtmsg
op_star
)paren
id|p
)paren
op_member_access_from_pointer
id|rtmsg_rtt
)paren
comma
op_amp
(paren
(paren
r_struct
id|in_rtmsg32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|rtmsg_rtt
comma
l_int|2
op_star
r_sizeof
(paren
r_int
)paren
op_plus
l_int|4
op_plus
r_sizeof
(paren
r_int
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_break
suffix:semicolon
r_case
id|RTMSG_NEWDEVICE
suffix:colon
r_case
id|RTMSG_DELDEVICE
suffix:colon
r_if
c_cond
(paren
id|nn.n.nlmsg_len
OL
r_sizeof
(paren
r_struct
id|nlmsghdr32
)paren
op_plus
r_sizeof
(paren
r_struct
id|in_ifmsg
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|nn.n.nlmsg_len
op_assign
r_sizeof
(paren
r_struct
id|nlmsghdr
)paren
op_plus
r_sizeof
(paren
r_struct
id|in_ifmsg
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
(paren
id|p
comma
(paren
r_struct
id|in_ifmsg32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
comma
r_sizeof
(paren
r_struct
id|sockaddr
)paren
op_plus
l_int|2
op_star
r_sizeof
(paren
r_struct
id|in_addr
)paren
op_plus
r_sizeof
(paren
r_int
)paren
)paren
op_logical_or
id|__get_user
(paren
(paren
(paren
r_struct
id|in_ifmsg
op_star
)paren
id|p
)paren
op_member_access_from_pointer
id|ifmsg_mtu
comma
op_amp
(paren
(paren
r_struct
id|in_ifmsg32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|ifmsg_mtu
)paren
op_logical_or
id|copy_from_user
(paren
op_amp
(paren
(paren
(paren
r_struct
id|in_ifmsg
op_star
)paren
id|p
)paren
op_member_access_from_pointer
id|ifmsg_metric
)paren
comma
op_amp
(paren
(paren
r_struct
id|in_ifmsg32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|ifmsg_metric
comma
r_sizeof
(paren
r_int
)paren
op_plus
l_int|2
op_plus
r_sizeof
(paren
r_int
)paren
op_plus
l_int|16
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_break
suffix:semicolon
r_case
id|RTMSG_CONTROL
suffix:colon
r_if
c_cond
(paren
id|nn.n.nlmsg_len
OL
r_sizeof
(paren
r_struct
id|nlmsghdr32
)paren
op_plus
r_sizeof
(paren
r_struct
id|in_rtctlmsg
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|nn.n.nlmsg_len
op_assign
r_sizeof
(paren
r_struct
id|nlmsghdr
)paren
op_plus
r_sizeof
(paren
r_struct
id|in_rtctlmsg
)paren
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
(paren
id|p
comma
(paren
r_struct
id|in_rtctlmsg
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
comma
r_sizeof
(paren
r_struct
id|in_rtctlmsg
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_break
suffix:semicolon
)brace
id|set_fs
(paren
id|KERNEL_DS
)paren
suffix:semicolon
id|ret
op_assign
id|sys_ioctl
(paren
id|fd
comma
id|SIOCRTMSG
comma
(paren
r_int
)paren
op_amp
(paren
id|nn.n
)paren
)paren
suffix:semicolon
id|set_fs
(paren
id|old_fs
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|struct|hd_geometry32
r_struct
id|hd_geometry32
(brace
DECL|member|heads
r_int
r_char
id|heads
suffix:semicolon
DECL|member|sectors
r_int
r_char
id|sectors
suffix:semicolon
DECL|member|cylinders
r_int
r_int
id|cylinders
suffix:semicolon
DECL|member|start
id|u32
id|start
suffix:semicolon
)brace
suffix:semicolon
DECL|function|hdio_getgeo
r_static
r_inline
r_int
id|hdio_getgeo
c_func
(paren
r_int
r_int
id|fd
comma
id|u32
id|arg
)paren
(brace
r_int
r_int
id|old_fs
op_assign
id|get_fs
c_func
(paren
)paren
suffix:semicolon
r_struct
id|hd_geometry
id|geo
suffix:semicolon
r_int
id|err
suffix:semicolon
id|set_fs
(paren
id|KERNEL_DS
)paren
suffix:semicolon
id|err
op_assign
id|sys_ioctl
c_func
(paren
id|fd
comma
id|HDIO_GETGEO
comma
(paren
r_int
r_int
)paren
op_amp
id|geo
)paren
suffix:semicolon
id|set_fs
(paren
id|old_fs
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|err
)paren
(brace
r_if
c_cond
(paren
id|copy_to_user
(paren
(paren
r_struct
id|hd_geometry32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
comma
op_amp
id|geo
comma
l_int|4
)paren
op_logical_or
id|__put_user
(paren
id|geo.start
comma
op_amp
(paren
(paren
(paren
r_struct
id|hd_geometry32
op_star
)paren
id|A
c_func
(paren
id|arg
)paren
)paren
op_member_access_from_pointer
id|start
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
)brace
r_return
id|err
suffix:semicolon
)brace
DECL|function|sys32_ioctl
id|asmlinkage
r_int
id|sys32_ioctl
c_func
(paren
r_int
r_int
id|fd
comma
r_int
r_int
id|cmd
comma
id|u32
id|arg
)paren
(brace
r_struct
id|file
op_star
id|filp
suffix:semicolon
r_int
id|error
op_assign
op_minus
id|EBADF
suffix:semicolon
id|lock_kernel
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fd
op_ge
id|NR_OPEN
op_logical_or
op_logical_neg
(paren
id|filp
op_assign
id|current-&gt;files-&gt;fd
(braket
id|fd
)braket
)paren
)paren
r_goto
id|out
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|filp-&gt;f_op
op_logical_or
op_logical_neg
id|filp-&gt;f_op-&gt;ioctl
)paren
(brace
id|error
op_assign
id|sys_ioctl
(paren
id|fd
comma
id|cmd
comma
(paren
r_int
r_int
)paren
id|arg
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
)brace
id|error
op_assign
op_minus
id|EFAULT
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|SIOCGIFCONF
suffix:colon
id|error
op_assign
id|dev_ifconf
c_func
(paren
id|fd
comma
id|arg
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
r_case
id|SIOCGIFFLAGS
suffix:colon
r_case
id|SIOCSIFFLAGS
suffix:colon
r_case
id|SIOCGIFMETRIC
suffix:colon
r_case
id|SIOCSIFMETRIC
suffix:colon
r_case
id|SIOCGIFMTU
suffix:colon
r_case
id|SIOCSIFMTU
suffix:colon
r_case
id|SIOCGIFMEM
suffix:colon
r_case
id|SIOCSIFMEM
suffix:colon
r_case
id|SIOCGIFHWADDR
suffix:colon
r_case
id|SIOCSIFHWADDR
suffix:colon
r_case
id|SIOCADDMULTI
suffix:colon
r_case
id|SIOCDELMULTI
suffix:colon
r_case
id|SIOGIFINDEX
suffix:colon
r_case
id|SIOCGIFMAP
suffix:colon
r_case
id|SIOCSIFMAP
suffix:colon
r_case
id|SIOCGIFADDR
suffix:colon
r_case
id|SIOCSIFADDR
suffix:colon
r_case
id|SIOCGIFBRDADDR
suffix:colon
r_case
id|SIOCSIFBRDADDR
suffix:colon
r_case
id|SIOCGIFDSTADDR
suffix:colon
r_case
id|SIOCSIFDSTADDR
suffix:colon
r_case
id|SIOCGIFNETMASK
suffix:colon
r_case
id|SIOCSIFNETMASK
suffix:colon
id|error
op_assign
id|dev_ifsioc
c_func
(paren
id|fd
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
r_case
id|SIOCADDRT
suffix:colon
r_case
id|SIOCDELRT
suffix:colon
id|error
op_assign
id|routing_ioctl
c_func
(paren
id|fd
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
r_case
id|SIOCRTMSG
suffix:colon
id|error
op_assign
id|rtmsg_ioctl
c_func
(paren
id|fd
comma
id|arg
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
r_case
id|HDIO_GETGEO
suffix:colon
id|error
op_assign
id|hdio_getgeo
c_func
(paren
id|fd
comma
id|arg
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
r_case
id|BLKRAGET
suffix:colon
r_case
id|BLKGETSIZE
suffix:colon
id|error
op_assign
id|w_long
c_func
(paren
id|fd
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
multiline_comment|/* List here exlicitly which ioctl&squot;s are known to have&n;&t; * compatable types passed or none at all...&n;&t; */
multiline_comment|/* Bit T */
r_case
id|TCGETA
suffix:colon
r_case
id|TCSETA
suffix:colon
r_case
id|TCSETAW
suffix:colon
r_case
id|TCSETAF
suffix:colon
r_case
id|TCSBRK
suffix:colon
r_case
id|TCXONC
suffix:colon
r_case
id|TCFLSH
suffix:colon
r_case
id|TCGETS
suffix:colon
r_case
id|TCSETS
suffix:colon
r_case
id|TCSETSW
suffix:colon
r_case
id|TCSETSF
suffix:colon
r_case
id|TIOCLINUX
suffix:colon
multiline_comment|/* Little t */
r_case
id|TIOCGETD
suffix:colon
r_case
id|TIOCSETD
suffix:colon
r_case
id|TIOCEXCL
suffix:colon
r_case
id|TIOCNXCL
suffix:colon
r_case
id|TIOCCONS
suffix:colon
r_case
id|TIOCGSOFTCAR
suffix:colon
r_case
id|TIOCSSOFTCAR
suffix:colon
r_case
id|TIOCSWINSZ
suffix:colon
r_case
id|TIOCGWINSZ
suffix:colon
r_case
id|TIOCMGET
suffix:colon
r_case
id|TIOCMBIC
suffix:colon
r_case
id|TIOCMBIS
suffix:colon
r_case
id|TIOCMSET
suffix:colon
r_case
id|TIOCPKT
suffix:colon
r_case
id|TIOCNOTTY
suffix:colon
r_case
id|TIOCSTI
suffix:colon
r_case
id|TIOCOUTQ
suffix:colon
r_case
id|TIOCSPGRP
suffix:colon
r_case
id|TIOCGPGRP
suffix:colon
r_case
id|TIOCSCTTY
suffix:colon
multiline_comment|/* Little f */
r_case
id|FIOCLEX
suffix:colon
r_case
id|FIONCLEX
suffix:colon
r_case
id|FIOASYNC
suffix:colon
r_case
id|FIONBIO
suffix:colon
r_case
id|FIONREAD
suffix:colon
multiline_comment|/* This is also TIOCINQ */
multiline_comment|/* 0x12 */
r_case
id|BLKRRPART
suffix:colon
r_case
id|BLKFLSBUF
suffix:colon
r_case
id|BLKRASET
suffix:colon
multiline_comment|/* 0x09 */
r_case
id|REGISTER_DEV
suffix:colon
r_case
id|START_MD
suffix:colon
r_case
id|STOP_MD
suffix:colon
multiline_comment|/* Big K */
r_case
id|PIO_FONT
suffix:colon
r_case
id|GIO_FONT
suffix:colon
r_case
id|KDSIGACCEPT
suffix:colon
r_case
id|KDGETKEYCODE
suffix:colon
r_case
id|KDSETKEYCODE
suffix:colon
multiline_comment|/* Socket level stuff */
r_case
id|FIOSETOWN
suffix:colon
r_case
id|SIOCSPGRP
suffix:colon
r_case
id|FIOGETOWN
suffix:colon
r_case
id|SIOCGPGRP
suffix:colon
r_case
id|SIOCATMARK
suffix:colon
r_case
id|SIOCGSTAMP
suffix:colon
r_case
id|SIOCSIFLINK
suffix:colon
r_case
id|SIOCSIFENCAP
suffix:colon
r_case
id|SIOCGIFENCAP
suffix:colon
r_case
id|SIOCSIFBR
suffix:colon
r_case
id|SIOCGIFBR
suffix:colon
r_case
id|SIOCSARP
suffix:colon
r_case
id|SIOCGARP
suffix:colon
r_case
id|SIOCDARP
suffix:colon
r_case
id|SIOCADDDLCI
suffix:colon
r_case
id|SIOCDELDLCI
suffix:colon
id|error
op_assign
id|sys_ioctl
(paren
id|fd
comma
id|cmd
comma
(paren
r_int
r_int
)paren
id|arg
)paren
suffix:semicolon
r_goto
id|out
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|printk
c_func
(paren
l_string|&quot;sys32_ioctl: Unknown cmd fd(%d) cmd(%08x) arg(%08x)&bslash;n&quot;
comma
(paren
r_int
)paren
id|fd
comma
(paren
r_int
r_int
)paren
id|cmd
comma
(paren
r_int
r_int
)paren
id|arg
)paren
suffix:semicolon
id|error
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_goto
id|out
suffix:semicolon
r_break
suffix:semicolon
)brace
id|out
suffix:colon
id|unlock_kernel
c_func
(paren
)paren
suffix:semicolon
r_return
id|error
suffix:semicolon
)brace
eof
