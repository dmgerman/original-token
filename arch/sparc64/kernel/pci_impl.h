multiline_comment|/* $Id: pci_impl.h,v 1.6 2000/03/25 05:18:11 davem Exp $&n; * pci_impl.h: Helper definitions for PCI controller support.&n; *&n; * Copyright (C) 1999 David S. Miller (davem@redhat.com)&n; */
macro_line|#ifndef PCI_IMPL_H
DECL|macro|PCI_IMPL_H
mdefine_line|#define PCI_IMPL_H
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/spinlock.h&gt;
macro_line|#include &lt;asm/io.h&gt;
r_extern
id|spinlock_t
id|pci_controller_lock
suffix:semicolon
r_extern
r_struct
id|pci_controller_info
op_star
id|pci_controller_root
suffix:semicolon
r_extern
r_struct
id|pci_pbm_info
op_star
id|pci_bus2pbm
(braket
l_int|256
)braket
suffix:semicolon
r_extern
r_int
r_char
id|pci_highest_busnum
suffix:semicolon
r_extern
r_int
id|pci_num_controllers
suffix:semicolon
multiline_comment|/* PCI bus scanning and fixup support. */
r_extern
r_void
id|pci_fill_in_pbm_cookies
c_func
(paren
r_struct
id|pci_bus
op_star
id|pbus
comma
r_struct
id|pci_pbm_info
op_star
id|pbm
comma
r_int
id|prom_node
)paren
suffix:semicolon
r_extern
r_void
id|pci_record_assignments
c_func
(paren
r_struct
id|pci_pbm_info
op_star
id|pbm
comma
r_struct
id|pci_bus
op_star
id|pbus
)paren
suffix:semicolon
r_extern
r_void
id|pci_assign_unassigned
c_func
(paren
r_struct
id|pci_pbm_info
op_star
id|pbm
comma
r_struct
id|pci_bus
op_star
id|pbus
)paren
suffix:semicolon
r_extern
r_void
id|pci_fixup_irq
c_func
(paren
r_struct
id|pci_pbm_info
op_star
id|pbm
comma
r_struct
id|pci_bus
op_star
id|pbus
)paren
suffix:semicolon
r_extern
r_void
id|pci_determine_66mhz_disposition
c_func
(paren
r_struct
id|pci_pbm_info
op_star
id|pbm
comma
r_struct
id|pci_bus
op_star
id|pbus
)paren
suffix:semicolon
r_extern
r_void
id|pci_setup_busmastering
c_func
(paren
r_struct
id|pci_pbm_info
op_star
id|pbm
comma
r_struct
id|pci_bus
op_star
id|pbus
)paren
suffix:semicolon
multiline_comment|/* Error reporting support. */
r_extern
r_void
id|pci_scan_for_target_abort
c_func
(paren
r_struct
id|pci_controller_info
op_star
comma
r_struct
id|pci_pbm_info
op_star
comma
r_struct
id|pci_bus
op_star
)paren
suffix:semicolon
r_extern
r_void
id|pci_scan_for_master_abort
c_func
(paren
r_struct
id|pci_controller_info
op_star
comma
r_struct
id|pci_pbm_info
op_star
comma
r_struct
id|pci_bus
op_star
)paren
suffix:semicolon
r_extern
r_void
id|pci_scan_for_parity_error
c_func
(paren
r_struct
id|pci_controller_info
op_star
comma
r_struct
id|pci_pbm_info
op_star
comma
r_struct
id|pci_bus
op_star
)paren
suffix:semicolon
multiline_comment|/* Configuration space access. */
r_extern
id|spinlock_t
id|pci_poke_lock
suffix:semicolon
r_extern
r_volatile
r_int
id|pci_poke_in_progress
suffix:semicolon
r_extern
r_volatile
r_int
id|pci_poke_faulted
suffix:semicolon
DECL|function|pci_config_read8
r_static
id|__inline__
r_void
id|pci_config_read8
c_func
(paren
id|u8
op_star
id|addr
comma
id|u8
op_star
id|ret
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
id|u8
id|byte
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|pci_poke_lock
comma
id|flags
)paren
suffix:semicolon
id|pci_poke_in_progress
op_assign
l_int|1
suffix:semicolon
id|pci_poke_faulted
op_assign
l_int|0
suffix:semicolon
id|__asm__
id|__volatile__
c_func
(paren
l_string|&quot;membar #Sync&bslash;n&bslash;t&quot;
l_string|&quot;lduba [%1] %2, %0&bslash;n&bslash;t&quot;
l_string|&quot;membar #Sync&quot;
suffix:colon
l_string|&quot;=r&quot;
(paren
id|byte
)paren
suffix:colon
l_string|&quot;r&quot;
(paren
id|addr
)paren
comma
l_string|&quot;i&quot;
(paren
id|ASI_PHYS_BYPASS_EC_E_L
)paren
suffix:colon
l_string|&quot;memory&quot;
)paren
suffix:semicolon
id|pci_poke_in_progress
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|pci_poke_faulted
)paren
op_star
id|ret
op_assign
id|byte
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|pci_poke_lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|pci_config_read16
r_static
id|__inline__
r_void
id|pci_config_read16
c_func
(paren
id|u16
op_star
id|addr
comma
id|u16
op_star
id|ret
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
id|u16
id|word
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|pci_poke_lock
comma
id|flags
)paren
suffix:semicolon
id|pci_poke_in_progress
op_assign
l_int|1
suffix:semicolon
id|pci_poke_faulted
op_assign
l_int|0
suffix:semicolon
id|__asm__
id|__volatile__
c_func
(paren
l_string|&quot;membar #Sync&bslash;n&bslash;t&quot;
l_string|&quot;lduha [%1] %2, %0&bslash;n&bslash;t&quot;
l_string|&quot;membar #Sync&quot;
suffix:colon
l_string|&quot;=r&quot;
(paren
id|word
)paren
suffix:colon
l_string|&quot;r&quot;
(paren
id|addr
)paren
comma
l_string|&quot;i&quot;
(paren
id|ASI_PHYS_BYPASS_EC_E_L
)paren
suffix:colon
l_string|&quot;memory&quot;
)paren
suffix:semicolon
id|pci_poke_in_progress
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|pci_poke_faulted
)paren
op_star
id|ret
op_assign
id|word
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|pci_poke_lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|pci_config_read32
r_static
id|__inline__
r_void
id|pci_config_read32
c_func
(paren
id|u32
op_star
id|addr
comma
id|u32
op_star
id|ret
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
id|u32
id|dword
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|pci_poke_lock
comma
id|flags
)paren
suffix:semicolon
id|pci_poke_in_progress
op_assign
l_int|1
suffix:semicolon
id|pci_poke_faulted
op_assign
l_int|0
suffix:semicolon
id|__asm__
id|__volatile__
c_func
(paren
l_string|&quot;membar #Sync&bslash;n&bslash;t&quot;
l_string|&quot;lduwa [%1] %2, %0&bslash;n&bslash;t&quot;
l_string|&quot;membar #Sync&quot;
suffix:colon
l_string|&quot;=r&quot;
(paren
id|dword
)paren
suffix:colon
l_string|&quot;r&quot;
(paren
id|addr
)paren
comma
l_string|&quot;i&quot;
(paren
id|ASI_PHYS_BYPASS_EC_E_L
)paren
suffix:colon
l_string|&quot;memory&quot;
)paren
suffix:semicolon
id|pci_poke_in_progress
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|pci_poke_faulted
)paren
op_star
id|ret
op_assign
id|dword
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|pci_poke_lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|pci_config_write8
r_static
id|__inline__
r_void
id|pci_config_write8
c_func
(paren
id|u8
op_star
id|addr
comma
id|u8
id|val
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|pci_poke_lock
comma
id|flags
)paren
suffix:semicolon
id|pci_poke_in_progress
op_assign
l_int|1
suffix:semicolon
id|pci_poke_faulted
op_assign
l_int|0
suffix:semicolon
id|__asm__
id|__volatile__
c_func
(paren
l_string|&quot;membar #Sync&bslash;n&bslash;t&quot;
l_string|&quot;stba %0, [%1] %2&bslash;n&bslash;t&quot;
l_string|&quot;membar #Sync&quot;
suffix:colon
multiline_comment|/* no outputs */
suffix:colon
l_string|&quot;r&quot;
(paren
id|val
)paren
comma
l_string|&quot;r&quot;
(paren
id|addr
)paren
comma
l_string|&quot;i&quot;
(paren
id|ASI_PHYS_BYPASS_EC_E_L
)paren
suffix:colon
l_string|&quot;memory&quot;
)paren
suffix:semicolon
id|pci_poke_in_progress
op_assign
l_int|0
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|pci_poke_lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|pci_config_write16
r_static
id|__inline__
r_void
id|pci_config_write16
c_func
(paren
id|u16
op_star
id|addr
comma
id|u16
id|val
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|pci_poke_lock
comma
id|flags
)paren
suffix:semicolon
id|pci_poke_in_progress
op_assign
l_int|1
suffix:semicolon
id|pci_poke_faulted
op_assign
l_int|0
suffix:semicolon
id|__asm__
id|__volatile__
c_func
(paren
l_string|&quot;membar #Sync&bslash;n&bslash;t&quot;
l_string|&quot;stha %0, [%1] %2&bslash;n&bslash;t&quot;
l_string|&quot;membar #Sync&quot;
suffix:colon
multiline_comment|/* no outputs */
suffix:colon
l_string|&quot;r&quot;
(paren
id|val
)paren
comma
l_string|&quot;r&quot;
(paren
id|addr
)paren
comma
l_string|&quot;i&quot;
(paren
id|ASI_PHYS_BYPASS_EC_E_L
)paren
suffix:colon
l_string|&quot;memory&quot;
)paren
suffix:semicolon
id|pci_poke_in_progress
op_assign
l_int|0
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|pci_poke_lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|pci_config_write32
r_static
id|__inline__
r_void
id|pci_config_write32
c_func
(paren
id|u32
op_star
id|addr
comma
id|u32
id|val
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|pci_poke_lock
comma
id|flags
)paren
suffix:semicolon
id|pci_poke_in_progress
op_assign
l_int|1
suffix:semicolon
id|pci_poke_faulted
op_assign
l_int|0
suffix:semicolon
id|__asm__
id|__volatile__
c_func
(paren
l_string|&quot;membar #Sync&bslash;n&bslash;t&quot;
l_string|&quot;stwa %0, [%1] %2&bslash;n&bslash;t&quot;
l_string|&quot;membar #Sync&quot;
suffix:colon
multiline_comment|/* no outputs */
suffix:colon
l_string|&quot;r&quot;
(paren
id|val
)paren
comma
l_string|&quot;r&quot;
(paren
id|addr
)paren
comma
l_string|&quot;i&quot;
(paren
id|ASI_PHYS_BYPASS_EC_E_L
)paren
suffix:colon
l_string|&quot;memory&quot;
)paren
suffix:semicolon
id|pci_poke_in_progress
op_assign
l_int|0
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|pci_poke_lock
comma
id|flags
)paren
suffix:semicolon
)brace
macro_line|#endif /* !(PCI_IMPL_H) */
eof
