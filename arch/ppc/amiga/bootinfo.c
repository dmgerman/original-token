multiline_comment|/*&n; *  linux/arch/ppc/amiga/bootinfo.c&n; *&n; *  Extracted from arch/m68k/kernel/setup.c.&n; *  Should be properly generalized and put somewhere else.&n; *                              Jesper&n; */
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;asm/setup.h&gt;
macro_line|#include &lt;asm/bootinfo.h&gt;
r_extern
r_char
id|cmd_line
(braket
id|CL_SIZE
)braket
suffix:semicolon
r_extern
r_int
id|num_memory
suffix:semicolon
r_extern
r_int
id|m68k_realnum_memory
suffix:semicolon
r_extern
r_struct
id|mem_info
id|memory
(braket
id|NUM_MEMINFO
)braket
suffix:semicolon
r_extern
r_struct
id|mem_info
id|m68k_memory
(braket
id|NUM_MEMINFO
)braket
suffix:semicolon
r_extern
r_struct
id|mem_info
id|ramdisk
suffix:semicolon
r_extern
r_int
id|amiga_parse_bootinfo
c_func
(paren
r_const
r_struct
id|bi_record
op_star
)paren
suffix:semicolon
r_extern
r_int
id|atari_parse_bootinfo
c_func
(paren
r_const
r_struct
id|bi_record
op_star
)paren
suffix:semicolon
r_extern
r_int
id|mac_parse_bootinfo
c_func
(paren
r_const
r_struct
id|bi_record
op_star
)paren
suffix:semicolon
DECL|function|parse_bootinfo
r_void
id|__init
id|parse_bootinfo
c_func
(paren
r_const
r_struct
id|bi_record
op_star
id|record
)paren
(brace
r_while
c_loop
(paren
id|record-&gt;tag
op_ne
id|BI_LAST
)paren
(brace
r_int
id|unknown
op_assign
l_int|0
suffix:semicolon
r_const
id|u_long
op_star
id|data
op_assign
id|record-&gt;data
suffix:semicolon
r_switch
c_cond
(paren
id|record-&gt;tag
)paren
(brace
r_case
id|BI_MACHTYPE
suffix:colon
r_case
id|BI_CPUTYPE
suffix:colon
r_case
id|BI_FPUTYPE
suffix:colon
r_case
id|BI_MMUTYPE
suffix:colon
multiline_comment|/* Already set up by head.S */
r_break
suffix:semicolon
r_case
id|BI_MEMCHUNK
suffix:colon
r_if
c_cond
(paren
id|num_memory
OL
id|NUM_MEMINFO
)paren
(brace
id|memory
(braket
id|num_memory
)braket
dot
id|addr
op_assign
id|data
(braket
l_int|0
)braket
suffix:semicolon
id|memory
(braket
id|num_memory
)braket
dot
id|size
op_assign
id|data
(braket
l_int|1
)braket
suffix:semicolon
id|num_memory
op_increment
suffix:semicolon
multiline_comment|/* FIXME: duplicate for m68k drivers. */
id|m68k_memory
(braket
id|m68k_realnum_memory
)braket
dot
id|addr
op_assign
id|data
(braket
l_int|0
)braket
suffix:semicolon
id|m68k_memory
(braket
id|m68k_realnum_memory
)braket
dot
id|size
op_assign
id|data
(braket
l_int|1
)braket
suffix:semicolon
id|m68k_realnum_memory
op_increment
suffix:semicolon
)brace
r_else
id|printk
c_func
(paren
l_string|&quot;parse_bootinfo: too many memory chunks&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|BI_RAMDISK
suffix:colon
id|ramdisk.addr
op_assign
id|data
(braket
l_int|0
)braket
suffix:semicolon
id|ramdisk.size
op_assign
id|data
(braket
l_int|1
)braket
suffix:semicolon
r_break
suffix:semicolon
r_case
id|BI_COMMAND_LINE
suffix:colon
id|strncpy
c_func
(paren
id|cmd_line
comma
(paren
r_const
r_char
op_star
)paren
id|data
comma
id|CL_SIZE
)paren
suffix:semicolon
id|cmd_line
(braket
id|CL_SIZE
op_minus
l_int|1
)braket
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
(brace
)brace
r_if
c_cond
(paren
id|MACH_IS_AMIGA
)paren
id|unknown
op_assign
id|amiga_parse_bootinfo
c_func
(paren
id|record
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|MACH_IS_ATARI
)paren
id|unknown
op_assign
id|atari_parse_bootinfo
c_func
(paren
id|record
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|MACH_IS_MAC
)paren
id|unknown
op_assign
id|mac_parse_bootinfo
c_func
(paren
id|record
)paren
suffix:semicolon
r_else
id|unknown
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|unknown
)paren
id|printk
c_func
(paren
l_string|&quot;parse_bootinfo: unknown tag 0x%04x ignored&bslash;n&quot;
comma
id|record-&gt;tag
)paren
suffix:semicolon
id|record
op_assign
(paren
r_struct
id|bi_record
op_star
)paren
(paren
(paren
id|u_long
)paren
id|record
op_plus
id|record-&gt;size
)paren
suffix:semicolon
)brace
)brace
eof
