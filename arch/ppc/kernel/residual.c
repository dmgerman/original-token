multiline_comment|/*&n; * $Id: residual.c,v 1.17 1999/09/27 18:40:23 cort Exp $&n; *&n; * Code to deal with the PReP residual data.&n; *&n; * Written by: Cort Dougan (cort@cs.nmt.edu)&n; * Improved _greatly_ and rewritten by Gabriel Paubert (paubert@iram.es)&n; *&n; *  This file is based on the following documentation:&n; *&n; *&t;IBM Power Personal Systems Architecture&n; *&t;Residual Data&n; * &t;Document Number: PPS-AR-FW0001&n; *&n; *  This file is subject to the terms and conditions of the GNU General Public&n; *  License.  See the file COPYING in the main directory of this archive&n; *  for more details.&n; *&n; */
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;asm/residual.h&gt;
macro_line|#include &lt;asm/pnp.h&gt;
macro_line|#include &lt;asm/byteorder.h&gt;
macro_line|#include &lt;linux/errno.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/stddef.h&gt;
macro_line|#include &lt;linux/unistd.h&gt;
macro_line|#include &lt;linux/ptrace.h&gt;
macro_line|#include &lt;linux/malloc.h&gt;
macro_line|#include &lt;linux/user.h&gt;
macro_line|#include &lt;linux/a.out.h&gt;
macro_line|#include &lt;linux/tty.h&gt;
macro_line|#include &lt;linux/major.h&gt;
macro_line|#include &lt;linux/interrupt.h&gt;
macro_line|#include &lt;linux/reboot.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/blk.h&gt;
macro_line|#include &lt;linux/ioport.h&gt;
macro_line|#include &lt;linux/pci.h&gt;
macro_line|#include &lt;linux/ide.h&gt;
macro_line|#include &lt;asm/init.h&gt;
macro_line|#include &lt;asm/mmu.h&gt;
macro_line|#include &lt;asm/processor.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;asm/pgtable.h&gt;
macro_line|#include &lt;asm/ide.h&gt;
DECL|variable|__prepdata
r_int
r_char
id|__res
(braket
r_sizeof
(paren
id|RESIDUAL
)paren
)braket
id|__prepdata
op_assign
(brace
l_int|0
comma
)brace
suffix:semicolon
DECL|variable|res
id|RESIDUAL
op_star
id|res
op_assign
(paren
id|RESIDUAL
op_star
)paren
op_amp
id|__res
suffix:semicolon
DECL|variable|__initdata
r_const
r_char
op_star
id|PnP_BASE_TYPES
(braket
)braket
id|__initdata
op_assign
(brace
l_string|&quot;Reserved&quot;
comma
l_string|&quot;MassStorageDevice&quot;
comma
l_string|&quot;NetworkInterfaceController&quot;
comma
l_string|&quot;DisplayController&quot;
comma
l_string|&quot;MultimediaController&quot;
comma
l_string|&quot;MemoryController&quot;
comma
l_string|&quot;BridgeController&quot;
comma
l_string|&quot;CommunicationsDevice&quot;
comma
l_string|&quot;SystemPeripheral&quot;
comma
l_string|&quot;InputDevice&quot;
comma
l_string|&quot;ServiceProcessor&quot;
)brace
suffix:semicolon
multiline_comment|/* Device Sub Type Codes */
DECL|variable|__initdata
r_const
r_int
r_char
op_star
id|PnP_SUB_TYPES
(braket
)braket
id|__initdata
op_assign
(brace
l_string|&quot;&bslash;001&bslash;000SCSIController&quot;
comma
l_string|&quot;&bslash;001&bslash;001IDEController&quot;
comma
l_string|&quot;&bslash;001&bslash;002FloppyController&quot;
comma
l_string|&quot;&bslash;001&bslash;003IPIController&quot;
comma
l_string|&quot;&bslash;001&bslash;200OtherMassStorageController&quot;
comma
l_string|&quot;&bslash;002&bslash;000EthernetController&quot;
comma
l_string|&quot;&bslash;002&bslash;001TokenRingController&quot;
comma
l_string|&quot;&bslash;002&bslash;002FDDIController&quot;
comma
l_string|&quot;&bslash;002&bslash;0x80OtherNetworkController&quot;
comma
l_string|&quot;&bslash;003&bslash;000VGAController&quot;
comma
l_string|&quot;&bslash;003&bslash;001SVGAController&quot;
comma
l_string|&quot;&bslash;003&bslash;002XGAController&quot;
comma
l_string|&quot;&bslash;003&bslash;200OtherDisplayController&quot;
comma
l_string|&quot;&bslash;004&bslash;000VideoController&quot;
comma
l_string|&quot;&bslash;004&bslash;001AudioController&quot;
comma
l_string|&quot;&bslash;004&bslash;200OtherMultimediaController&quot;
comma
l_string|&quot;&bslash;005&bslash;000RAM&quot;
comma
l_string|&quot;&bslash;005&bslash;001FLASH&quot;
comma
l_string|&quot;&bslash;005&bslash;200OtherMemoryDevice&quot;
comma
l_string|&quot;&bslash;006&bslash;000HostProcessorBridge&quot;
comma
l_string|&quot;&bslash;006&bslash;001ISABridge&quot;
comma
l_string|&quot;&bslash;006&bslash;002EISABridge&quot;
comma
l_string|&quot;&bslash;006&bslash;003MicroChannelBridge&quot;
comma
l_string|&quot;&bslash;006&bslash;004PCIBridge&quot;
comma
l_string|&quot;&bslash;006&bslash;005PCMCIABridge&quot;
comma
l_string|&quot;&bslash;006&bslash;006VMEBridge&quot;
comma
l_string|&quot;&bslash;006&bslash;200OtherBridgeDevice&quot;
comma
l_string|&quot;&bslash;007&bslash;000RS232Device&quot;
comma
l_string|&quot;&bslash;007&bslash;001ATCompatibleParallelPort&quot;
comma
l_string|&quot;&bslash;007&bslash;200OtherCommunicationsDevice&quot;
comma
l_string|&quot;&bslash;010&bslash;000ProgrammableInterruptController&quot;
comma
l_string|&quot;&bslash;010&bslash;001DMAController&quot;
comma
l_string|&quot;&bslash;010&bslash;002SystemTimer&quot;
comma
l_string|&quot;&bslash;010&bslash;003RealTimeClock&quot;
comma
l_string|&quot;&bslash;010&bslash;004L2Cache&quot;
comma
l_string|&quot;&bslash;010&bslash;005NVRAM&quot;
comma
l_string|&quot;&bslash;010&bslash;006PowerManagement&quot;
comma
l_string|&quot;&bslash;010&bslash;007CMOS&quot;
comma
l_string|&quot;&bslash;010&bslash;010OperatorPanel&quot;
comma
l_string|&quot;&bslash;010&bslash;011ServiceProcessorClass1&quot;
comma
l_string|&quot;&bslash;010&bslash;012ServiceProcessorClass2&quot;
comma
l_string|&quot;&bslash;010&bslash;013ServiceProcessorClass3&quot;
comma
l_string|&quot;&bslash;010&bslash;014GraphicAssist&quot;
comma
l_string|&quot;&bslash;010&bslash;017SystemPlanar&quot;
comma
l_string|&quot;&bslash;010&bslash;200OtherSystemPeripheral&quot;
comma
l_string|&quot;&bslash;011&bslash;000KeyboardController&quot;
comma
l_string|&quot;&bslash;011&bslash;001Digitizer&quot;
comma
l_string|&quot;&bslash;011&bslash;002MouseController&quot;
comma
l_string|&quot;&bslash;011&bslash;003TabletController&quot;
comma
l_string|&quot;&bslash;011&bslash;0x80OtherInputController&quot;
comma
l_string|&quot;&bslash;012&bslash;000GeneralMemoryController&quot;
comma
l_int|NULL
)brace
suffix:semicolon
multiline_comment|/* Device Interface Type Codes */
DECL|variable|__initdata
r_const
r_int
r_char
op_star
id|PnP_INTERFACES
(braket
)braket
id|__initdata
op_assign
(brace
l_string|&quot;&bslash;000&bslash;000&bslash;000General&quot;
comma
l_string|&quot;&bslash;001&bslash;000&bslash;000GeneralSCSI&quot;
comma
l_string|&quot;&bslash;001&bslash;001&bslash;000GeneralIDE&quot;
comma
l_string|&quot;&bslash;001&bslash;001&bslash;001ATACompatible&quot;
comma
l_string|&quot;&bslash;001&bslash;002&bslash;000GeneralFloppy&quot;
comma
l_string|&quot;&bslash;001&bslash;002&bslash;001Compatible765&quot;
comma
l_string|&quot;&bslash;001&bslash;002&bslash;002NS398_Floppy&quot;
comma
multiline_comment|/* NS Super I/O wired to use index&n;                                         register at port 398 and data&n;                                         register at port 399               */
l_string|&quot;&bslash;001&bslash;002&bslash;003NS26E_Floppy&quot;
comma
multiline_comment|/* Ports 26E and 26F                  */
l_string|&quot;&bslash;001&bslash;002&bslash;004NS15C_Floppy&quot;
comma
multiline_comment|/* Ports 15C and 15D                  */
l_string|&quot;&bslash;001&bslash;002&bslash;005NS2E_Floppy&quot;
comma
multiline_comment|/* Ports 2E and 2F                    */
l_string|&quot;&bslash;001&bslash;002&bslash;006CHRP_Floppy&quot;
comma
multiline_comment|/* CHRP Floppy in PR*P system         */
l_string|&quot;&bslash;001&bslash;003&bslash;000GeneralIPI&quot;
comma
l_string|&quot;&bslash;002&bslash;000&bslash;000GeneralEther&quot;
comma
l_string|&quot;&bslash;002&bslash;001&bslash;000GeneralToken&quot;
comma
l_string|&quot;&bslash;002&bslash;002&bslash;000GeneralFDDI&quot;
comma
l_string|&quot;&bslash;003&bslash;000&bslash;000GeneralVGA&quot;
comma
l_string|&quot;&bslash;003&bslash;001&bslash;000GeneralSVGA&quot;
comma
l_string|&quot;&bslash;003&bslash;002&bslash;000GeneralXGA&quot;
comma
l_string|&quot;&bslash;004&bslash;000&bslash;000GeneralVideo&quot;
comma
l_string|&quot;&bslash;004&bslash;001&bslash;000GeneralAudio&quot;
comma
l_string|&quot;&bslash;004&bslash;001&bslash;001CS4232Audio&quot;
comma
multiline_comment|/* CS 4232 Plug &squot;n Play Configured    */
l_string|&quot;&bslash;005&bslash;000&bslash;000GeneralRAM&quot;
comma
multiline_comment|/* This one is obviously wrong ! */
l_string|&quot;&bslash;005&bslash;000&bslash;000PCIMemoryController&quot;
comma
multiline_comment|/* PCI Config Method                  */
l_string|&quot;&bslash;005&bslash;000&bslash;001RS6KMemoryController&quot;
comma
multiline_comment|/* RS6K Config Method                 */
l_string|&quot;&bslash;005&bslash;001&bslash;000GeneralFLASH&quot;
comma
l_string|&quot;&bslash;006&bslash;000&bslash;000GeneralHostBridge&quot;
comma
l_string|&quot;&bslash;006&bslash;001&bslash;000GeneralISABridge&quot;
comma
l_string|&quot;&bslash;006&bslash;002&bslash;000GeneralEISABridge&quot;
comma
l_string|&quot;&bslash;006&bslash;003&bslash;000GeneralMCABridge&quot;
comma
multiline_comment|/* GeneralPCIBridge = 0, */
l_string|&quot;&bslash;006&bslash;004&bslash;000PCIBridgeDirect&quot;
comma
l_string|&quot;&bslash;006&bslash;004&bslash;001PCIBridgeIndirect&quot;
comma
l_string|&quot;&bslash;006&bslash;004&bslash;002PCIBridgeRS6K&quot;
comma
l_string|&quot;&bslash;006&bslash;005&bslash;000GeneralPCMCIABridge&quot;
comma
l_string|&quot;&bslash;006&bslash;006&bslash;000GeneralVMEBridge&quot;
comma
l_string|&quot;&bslash;007&bslash;000&bslash;000GeneralRS232&quot;
comma
l_string|&quot;&bslash;007&bslash;000&bslash;001COMx&quot;
comma
l_string|&quot;&bslash;007&bslash;000&bslash;002Compatible16450&quot;
comma
l_string|&quot;&bslash;007&bslash;000&bslash;003Compatible16550&quot;
comma
l_string|&quot;&bslash;007&bslash;000&bslash;004NS398SerPort&quot;
comma
multiline_comment|/* NS Super I/O wired to use index&n;                                         register at port 398 and data&n;                                         register at port 399               */
l_string|&quot;&bslash;007&bslash;000&bslash;005NS26ESerPort&quot;
comma
multiline_comment|/* Ports 26E and 26F                  */
l_string|&quot;&bslash;007&bslash;000&bslash;006NS15CSerPort&quot;
comma
multiline_comment|/* Ports 15C and 15D                  */
l_string|&quot;&bslash;007&bslash;000&bslash;007NS2ESerPort&quot;
comma
multiline_comment|/* Ports 2E and 2F                    */
l_string|&quot;&bslash;007&bslash;001&bslash;000GeneralParPort&quot;
comma
l_string|&quot;&bslash;007&bslash;001&bslash;001LPTx&quot;
comma
l_string|&quot;&bslash;007&bslash;001&bslash;002NS398ParPort&quot;
comma
multiline_comment|/* NS Super I/O wired to use index&n;                                         register at port 398 and data&n;                                         register at port 399               */
l_string|&quot;&bslash;007&bslash;001&bslash;003NS26EParPort&quot;
comma
multiline_comment|/* Ports 26E and 26F                  */
l_string|&quot;&bslash;007&bslash;001&bslash;004NS15CParPort&quot;
comma
multiline_comment|/* Ports 15C and 15D                  */
l_string|&quot;&bslash;007&bslash;001&bslash;005NS2EParPort&quot;
comma
multiline_comment|/* Ports 2E and 2F                    */
l_string|&quot;&bslash;010&bslash;000&bslash;000GeneralPIC&quot;
comma
l_string|&quot;&bslash;010&bslash;000&bslash;001ISA_PIC&quot;
comma
l_string|&quot;&bslash;010&bslash;000&bslash;002EISA_PIC&quot;
comma
l_string|&quot;&bslash;010&bslash;000&bslash;003MPIC&quot;
comma
l_string|&quot;&bslash;010&bslash;000&bslash;004RS6K_PIC&quot;
comma
l_string|&quot;&bslash;010&bslash;001&bslash;000GeneralDMA&quot;
comma
l_string|&quot;&bslash;010&bslash;001&bslash;001ISA_DMA&quot;
comma
l_string|&quot;&bslash;010&bslash;001&bslash;002EISA_DMA&quot;
comma
l_string|&quot;&bslash;010&bslash;002&bslash;000GeneralTimer&quot;
comma
l_string|&quot;&bslash;010&bslash;002&bslash;001ISA_Timer&quot;
comma
l_string|&quot;&bslash;010&bslash;002&bslash;002EISA_Timer&quot;
comma
l_string|&quot;&bslash;010&bslash;003&bslash;000GeneralRTC&quot;
comma
l_string|&quot;&bslash;010&bslash;003&bslash;001ISA_RTC&quot;
comma
l_string|&quot;&bslash;010&bslash;004&bslash;001StoreThruOnly&quot;
comma
l_string|&quot;&bslash;010&bslash;004&bslash;002StoreInEnabled&quot;
comma
l_string|&quot;&bslash;010&bslash;004&bslash;003RS6KL2Cache&quot;
comma
l_string|&quot;&bslash;010&bslash;005&bslash;000IndirectNVRAM&quot;
comma
multiline_comment|/* Indirectly addressed               */
l_string|&quot;&bslash;010&bslash;005&bslash;001DirectNVRAM&quot;
comma
multiline_comment|/* Memory Mapped                      */
l_string|&quot;&bslash;010&bslash;005&bslash;002IndirectNVRAM24&quot;
comma
multiline_comment|/* Indirectly addressed - 24 bit      */
l_string|&quot;&bslash;010&bslash;006&bslash;000GeneralPowerManagement&quot;
comma
l_string|&quot;&bslash;010&bslash;006&bslash;001EPOWPowerManagement&quot;
comma
l_string|&quot;&bslash;010&bslash;006&bslash;002PowerControl&quot;
comma
singleline_comment|// d1378
l_string|&quot;&bslash;010&bslash;007&bslash;000GeneralCMOS&quot;
comma
l_string|&quot;&bslash;010&bslash;010&bslash;000GeneralOPPanel&quot;
comma
l_string|&quot;&bslash;010&bslash;010&bslash;001HarddiskLight&quot;
comma
l_string|&quot;&bslash;010&bslash;010&bslash;002CDROMLight&quot;
comma
l_string|&quot;&bslash;010&bslash;010&bslash;003PowerLight&quot;
comma
l_string|&quot;&bslash;010&bslash;010&bslash;004KeyLock&quot;
comma
l_string|&quot;&bslash;010&bslash;010&bslash;005ANDisplay&quot;
comma
multiline_comment|/* AlphaNumeric Display               */
l_string|&quot;&bslash;010&bslash;010&bslash;006SystemStatusLED&quot;
comma
multiline_comment|/* 3 digit 7 segment LED              */
l_string|&quot;&bslash;010&bslash;010&bslash;007CHRP_SystemStatusLED&quot;
comma
multiline_comment|/* CHRP LEDs in PR*P system           */
l_string|&quot;&bslash;010&bslash;011&bslash;000GeneralServiceProcessor&quot;
comma
l_string|&quot;&bslash;010&bslash;012&bslash;000GeneralServiceProcessor&quot;
comma
l_string|&quot;&bslash;010&bslash;013&bslash;000GeneralServiceProcessor&quot;
comma
l_string|&quot;&bslash;010&bslash;014&bslash;001TransferData&quot;
comma
l_string|&quot;&bslash;010&bslash;014&bslash;002IGMC32&quot;
comma
l_string|&quot;&bslash;010&bslash;014&bslash;003IGMC64&quot;
comma
l_string|&quot;&bslash;010&bslash;017&bslash;000GeneralSystemPlanar&quot;
comma
multiline_comment|/* 10/5/95                            */
l_int|NULL
)brace
suffix:semicolon
DECL|function|PnP_SUB_TYPE_STR
r_static
r_const
r_int
r_char
id|__init
op_star
id|PnP_SUB_TYPE_STR
c_func
(paren
r_int
r_char
id|BaseType
comma
r_int
r_char
id|SubType
)paren
(brace
r_const
r_int
r_char
op_star
op_star
id|s
op_assign
id|PnP_SUB_TYPES
suffix:semicolon
r_while
c_loop
(paren
op_star
id|s
op_logical_and
op_logical_neg
(paren
(paren
op_star
id|s
)paren
(braket
l_int|0
)braket
op_eq
id|BaseType
op_logical_and
(paren
op_star
id|s
)paren
(braket
l_int|1
)braket
op_eq
id|SubType
)paren
)paren
id|s
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|s
)paren
r_return
op_star
id|s
op_plus
l_int|2
suffix:semicolon
r_else
r_return
l_string|&quot;Unknown !&quot;
suffix:semicolon
)brace
suffix:semicolon
DECL|function|PnP_INTERFACE_STR
r_static
r_const
r_int
r_char
id|__init
op_star
id|PnP_INTERFACE_STR
c_func
(paren
r_int
r_char
id|BaseType
comma
r_int
r_char
id|SubType
comma
r_int
r_char
id|Interface
)paren
(brace
r_const
r_int
r_char
op_star
op_star
id|s
op_assign
id|PnP_INTERFACES
suffix:semicolon
r_while
c_loop
(paren
op_star
id|s
op_logical_and
op_logical_neg
(paren
(paren
op_star
id|s
)paren
(braket
l_int|0
)braket
op_eq
id|BaseType
op_logical_and
(paren
op_star
id|s
)paren
(braket
l_int|1
)braket
op_eq
id|SubType
op_logical_and
(paren
op_star
id|s
)paren
(braket
l_int|2
)braket
op_eq
id|Interface
)paren
)paren
id|s
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|s
)paren
r_return
op_star
id|s
op_plus
l_int|3
suffix:semicolon
r_else
r_return
l_int|NULL
suffix:semicolon
)brace
suffix:semicolon
DECL|function|printsmallvendor
r_static
r_void
id|__init
id|printsmallvendor
c_func
(paren
id|PnP_TAG_PACKET
op_star
id|pkt
comma
r_int
id|size
)paren
(brace
r_int
id|i
comma
id|c
suffix:semicolon
r_char
id|decomp
(braket
l_int|4
)braket
suffix:semicolon
DECL|macro|p
mdefine_line|#define p pkt-&gt;S14_Pack.S14_Data.S14_PPCPack
r_switch
c_cond
(paren
id|p.Type
)paren
(brace
r_case
l_int|1
suffix:colon
multiline_comment|/* Decompress first 3 chars */
id|c
op_assign
op_star
(paren
r_int
r_int
op_star
)paren
id|p.PPCData
suffix:semicolon
id|decomp
(braket
l_int|0
)braket
op_assign
l_char|&squot;A&squot;
op_minus
l_int|1
op_plus
(paren
(paren
id|c
op_rshift
l_int|10
)paren
op_amp
l_int|0x1F
)paren
suffix:semicolon
id|decomp
(braket
l_int|1
)braket
op_assign
l_char|&squot;A&squot;
op_minus
l_int|1
op_plus
(paren
(paren
id|c
op_rshift
l_int|5
)paren
op_amp
l_int|0x1F
)paren
suffix:semicolon
id|decomp
(braket
l_int|2
)braket
op_assign
l_char|&squot;A&squot;
op_minus
l_int|1
op_plus
(paren
id|c
op_amp
l_int|0x1F
)paren
suffix:semicolon
id|decomp
(braket
l_int|3
)braket
op_assign
l_int|0
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;    Chip identification: %s%4.4X&bslash;n&quot;
comma
id|decomp
comma
id|ld_le16
c_func
(paren
(paren
r_int
r_int
op_star
)paren
(paren
id|p.PPCData
op_plus
l_int|2
)paren
)paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|printk
c_func
(paren
l_string|&quot;    Small vendor item type 0x%2.2x, data (hex): &quot;
comma
id|p.Type
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|size
op_minus
l_int|2
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%2.2x &quot;
comma
id|p.PPCData
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
DECL|macro|p
macro_line|#undef p
)brace
DECL|function|printsmallpacket
r_static
r_void
id|__init
id|printsmallpacket
c_func
(paren
id|PnP_TAG_PACKET
op_star
id|pkt
comma
r_int
id|size
)paren
(brace
r_static
r_const
r_int
r_char
op_star
id|intlevel
(braket
)braket
op_assign
(brace
l_string|&quot;high&quot;
comma
l_string|&quot;low&quot;
)brace
suffix:semicolon
r_static
r_const
r_int
r_char
op_star
id|intsense
(braket
)braket
op_assign
(brace
l_string|&quot;edge&quot;
comma
l_string|&quot;level&quot;
)brace
suffix:semicolon
r_switch
c_cond
(paren
id|tag_small_item_name
c_func
(paren
id|pkt-&gt;S1_Pack.Tag
)paren
)paren
(brace
r_case
id|PnPVersion
suffix:colon
id|printk
c_func
(paren
l_string|&quot;    PnPversion 0x%x.%x&bslash;n&quot;
comma
id|pkt-&gt;S1_Pack.Version
(braket
l_int|0
)braket
comma
multiline_comment|/* How to interpret version ? */
id|pkt-&gt;S1_Pack.Version
(braket
l_int|1
)braket
)paren
suffix:semicolon
r_break
suffix:semicolon
singleline_comment|//&t;case Logicaldevice:
r_break
suffix:semicolon
singleline_comment|//&t;case CompatibleDevice:
r_break
suffix:semicolon
r_case
id|IRQFormat
suffix:colon
DECL|macro|p
mdefine_line|#define p pkt-&gt;S4_Pack
id|printk
c_func
(paren
l_string|&quot;    IRQ Mask 0x%4.4x, %s %s sensitive&bslash;n&quot;
comma
id|ld_le16
c_func
(paren
(paren
r_int
r_int
op_star
)paren
id|p.IRQMask
)paren
comma
id|intlevel
(braket
(paren
id|size
OG
l_int|3
)paren
ques
c_cond
op_logical_neg
(paren
id|p.IRQInfo
op_amp
l_int|0x05
)paren
suffix:colon
l_int|0
)braket
comma
id|intsense
(braket
(paren
id|size
OG
l_int|3
)paren
ques
c_cond
op_logical_neg
(paren
id|p.IRQInfo
op_amp
l_int|0x03
)paren
suffix:colon
l_int|0
)braket
)paren
suffix:semicolon
DECL|macro|p
macro_line|#undef p
r_break
suffix:semicolon
r_case
id|DMAFormat
suffix:colon
DECL|macro|p
mdefine_line|#define p pkt-&gt;S5_Pack
id|printk
c_func
(paren
l_string|&quot;    DMA channel mask 0x%2.2x, info 0x%2.2x&bslash;n&quot;
comma
id|p.DMAMask
comma
id|p.DMAInfo
)paren
suffix:semicolon
DECL|macro|p
macro_line|#undef p
r_break
suffix:semicolon
r_case
id|StartDepFunc
suffix:colon
id|printk
c_func
(paren
l_string|&quot;Start dependent function:&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|EndDepFunc
suffix:colon
id|printk
c_func
(paren
l_string|&quot;End dependent function&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|IOPort
suffix:colon
DECL|macro|p
mdefine_line|#define p pkt-&gt;S8_Pack
id|printk
c_func
(paren
l_string|&quot;    Variable (%d decoded bits) I/O port&bslash;n&quot;
l_string|&quot;      from 0x%4.4x to 0x%4.4x, alignment %d, %d ports&bslash;n&quot;
comma
id|p.IOInfo
op_amp
id|ISAAddr16bit
ques
c_cond
l_int|16
suffix:colon
l_int|10
comma
id|ld_le16
c_func
(paren
(paren
r_int
r_int
op_star
)paren
id|p.RangeMin
)paren
comma
id|ld_le16
c_func
(paren
(paren
r_int
r_int
op_star
)paren
id|p.RangeMax
)paren
comma
id|p.IOAlign
comma
id|p.IONum
)paren
suffix:semicolon
DECL|macro|p
macro_line|#undef p
r_break
suffix:semicolon
r_case
id|FixedIOPort
suffix:colon
DECL|macro|p
mdefine_line|#define p pkt-&gt;S9_Pack
id|printk
c_func
(paren
l_string|&quot;    Fixed (10 decoded bits) I/O port from %3.3x to %3.3x&bslash;n&quot;
comma
(paren
id|p.Range
(braket
l_int|1
)braket
op_lshift
l_int|8
)paren
op_or
id|p.Range
(braket
l_int|0
)braket
comma
(paren
(paren
id|p.Range
(braket
l_int|1
)braket
op_lshift
l_int|8
)paren
op_or
id|p.Range
(braket
l_int|0
)braket
)paren
op_plus
id|p.IONum
op_minus
l_int|1
)paren
suffix:semicolon
DECL|macro|p
macro_line|#undef p&t;&t; 
r_break
suffix:semicolon
r_case
id|Res1
suffix:colon
r_case
id|Res2
suffix:colon
r_case
id|Res3
suffix:colon
id|printk
c_func
(paren
l_string|&quot;    Undefined packet type %d!&bslash;n&quot;
comma
id|tag_small_item_name
c_func
(paren
id|pkt-&gt;S1_Pack.Tag
)paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SmallVendorItem
suffix:colon
id|printsmallvendor
c_func
(paren
id|pkt
comma
id|size
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|printk
c_func
(paren
l_string|&quot;    Type 0x2.2x%d, size=%d&bslash;n&quot;
comma
id|pkt-&gt;S1_Pack.Tag
comma
id|size
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
DECL|function|printlargevendor
r_static
r_void
id|__init
id|printlargevendor
c_func
(paren
id|PnP_TAG_PACKET
op_star
id|pkt
comma
r_int
id|size
)paren
(brace
r_static
r_const
r_int
r_char
op_star
id|addrtype
(braket
)braket
op_assign
(brace
l_string|&quot;I/O&quot;
comma
l_string|&quot;Memory&quot;
comma
l_string|&quot;System&quot;
)brace
suffix:semicolon
r_static
r_const
r_int
r_char
op_star
id|inttype
(braket
)braket
op_assign
(brace
l_string|&quot;8259&quot;
comma
l_string|&quot;MPIC&quot;
comma
l_string|&quot;RS6k BUID %d&quot;
)brace
suffix:semicolon
r_static
r_const
r_int
r_char
op_star
id|convtype
(braket
)braket
op_assign
(brace
l_string|&quot;Bus Memory&quot;
comma
l_string|&quot;Bus I/O&quot;
comma
l_string|&quot;DMA&quot;
)brace
suffix:semicolon
r_static
r_const
r_int
r_char
op_star
id|transtype
(braket
)braket
op_assign
(brace
l_string|&quot;direct&quot;
comma
l_string|&quot;mapped&quot;
comma
l_string|&quot;direct-store segment&quot;
)brace
suffix:semicolon
r_static
r_const
r_int
r_char
op_star
id|L2type
(braket
)braket
op_assign
(brace
l_string|&quot;WriteThru&quot;
comma
l_string|&quot;CopyBack&quot;
)brace
suffix:semicolon
r_static
r_const
r_int
r_char
op_star
id|L2assoc
(braket
)braket
op_assign
(brace
l_string|&quot;DirectMapped&quot;
comma
l_string|&quot;2-way set&quot;
)brace
suffix:semicolon
r_int
id|i
suffix:semicolon
r_char
id|tmpstr
(braket
l_int|30
)braket
comma
op_star
id|t
suffix:semicolon
DECL|macro|p
mdefine_line|#define p pkt-&gt;L4_Pack.L4_Data.L4_PPCPack
r_switch
c_cond
(paren
id|p.Type
)paren
(brace
r_case
l_int|2
suffix:colon
id|printk
c_func
(paren
l_string|&quot;    %d K %s %s L2 cache, %d/%d bytes line/sector size&bslash;n&quot;
comma
id|ld_le32
c_func
(paren
(paren
r_int
r_int
op_star
)paren
id|p.PPCData
)paren
comma
id|L2type
(braket
id|p.PPCData
(braket
l_int|10
)braket
op_minus
l_int|1
)braket
comma
id|L2assoc
(braket
id|p.PPCData
(braket
l_int|4
)braket
op_minus
l_int|1
)braket
comma
id|ld_le16
c_func
(paren
(paren
r_int
r_int
op_star
)paren
id|p.PPCData
op_plus
l_int|3
)paren
comma
id|ld_le16
c_func
(paren
(paren
r_int
r_int
op_star
)paren
id|p.PPCData
op_plus
l_int|4
)paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|printk
c_func
(paren
l_string|&quot;    PCI Bridge parameters&bslash;n&quot;
l_string|&quot;      ConfigBaseAddress %0x&bslash;n&quot;
l_string|&quot;      ConfigBaseData %0x&bslash;n&quot;
l_string|&quot;      Bus number %d&bslash;n&quot;
comma
id|ld_le32
c_func
(paren
(paren
r_int
r_int
op_star
)paren
id|p.PPCData
)paren
comma
id|ld_le32
c_func
(paren
(paren
r_int
r_int
op_star
)paren
(paren
id|p.PPCData
op_plus
l_int|8
)paren
)paren
comma
id|p.PPCData
(braket
l_int|16
)braket
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|20
suffix:semicolon
id|i
OL
id|size
op_minus
l_int|4
suffix:semicolon
id|i
op_add_assign
l_int|12
)paren
(brace
r_int
id|j
comma
id|first
suffix:semicolon
r_if
c_cond
(paren
id|p.PPCData
(braket
id|i
)braket
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;      PCI Slot %d&quot;
comma
id|p.PPCData
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
r_else
id|printk
(paren
l_string|&quot;      Integrated PCI device&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
comma
id|first
op_assign
l_int|1
comma
id|t
op_assign
id|tmpstr
suffix:semicolon
id|j
OL
l_int|4
suffix:semicolon
id|j
op_increment
)paren
(brace
r_int
id|line
op_assign
id|ld_le16
c_func
(paren
(paren
r_int
r_int
op_star
)paren
(paren
id|p.PPCData
op_plus
id|i
op_plus
l_int|4
)paren
op_plus
id|j
)paren
suffix:semicolon
r_if
c_cond
(paren
id|line
op_ne
l_int|0xffff
)paren
(brace
r_if
c_cond
(paren
id|first
)paren
(brace
id|first
op_assign
l_int|0
suffix:semicolon
)brace
r_else
op_star
id|t
op_increment
op_assign
l_char|&squot;/&squot;
suffix:semicolon
op_star
id|t
op_increment
op_assign
l_char|&squot;A&squot;
op_plus
id|j
suffix:semicolon
)brace
)brace
op_star
id|t
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; DevFunc 0x%x interrupt line(s) %s routed to&quot;
comma
id|p.PPCData
(braket
id|i
op_plus
l_int|1
)braket
comma
id|tmpstr
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|tmpstr
comma
id|inttype
(braket
id|p.PPCData
(braket
id|i
op_plus
l_int|2
)braket
op_minus
l_int|1
)braket
comma
id|p.PPCData
(braket
id|i
op_plus
l_int|3
)braket
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; %s line(s) &quot;
comma
id|tmpstr
)paren
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
comma
id|first
op_assign
l_int|1
comma
id|t
op_assign
id|tmpstr
suffix:semicolon
id|j
OL
l_int|4
suffix:semicolon
id|j
op_increment
)paren
(brace
r_int
id|line
op_assign
id|ld_le16
c_func
(paren
(paren
r_int
r_int
op_star
)paren
(paren
id|p.PPCData
op_plus
id|i
op_plus
l_int|4
)paren
op_plus
id|j
)paren
suffix:semicolon
r_if
c_cond
(paren
id|line
op_ne
l_int|0xffff
)paren
(brace
r_if
c_cond
(paren
id|first
)paren
(brace
id|first
op_assign
l_int|0
suffix:semicolon
)brace
r_else
op_star
id|t
op_increment
op_assign
l_char|&squot;/&squot;
suffix:semicolon
id|t
op_add_assign
id|sprintf
c_func
(paren
id|t
comma
l_string|&quot;%d(%c)&quot;
comma
id|line
op_amp
l_int|0x7fff
comma
id|line
op_amp
l_int|0x8000
ques
c_cond
l_char|&squot;E&squot;
suffix:colon
l_char|&squot;L&squot;
)paren
suffix:semicolon
)brace
)brace
id|printk
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|tmpstr
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
id|printk
c_func
(paren
l_string|&quot;    Bridge address translation, %s decoding:&bslash;n&quot;
l_string|&quot;      Processor  Bus        Size       Conversion Translation&bslash;n&quot;
l_string|&quot;      0x%8.8x 0x%8.8x 0x%8.8x %s %s&bslash;n&quot;
comma
id|p.PPCData
(braket
l_int|0
)braket
op_amp
l_int|1
ques
c_cond
l_string|&quot;positive&quot;
suffix:colon
l_string|&quot;subtractive&quot;
comma
id|ld_le32
c_func
(paren
(paren
r_int
r_int
op_star
)paren
id|p.PPCData
op_plus
l_int|1
)paren
comma
id|ld_le32
c_func
(paren
(paren
r_int
r_int
op_star
)paren
id|p.PPCData
op_plus
l_int|3
)paren
comma
id|ld_le32
c_func
(paren
(paren
r_int
r_int
op_star
)paren
id|p.PPCData
op_plus
l_int|5
)paren
comma
id|convtype
(braket
id|p.PPCData
(braket
l_int|2
)braket
op_minus
l_int|1
)braket
comma
id|transtype
(braket
id|p.PPCData
(braket
l_int|1
)braket
op_minus
l_int|1
)braket
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|6
suffix:colon
id|printk
c_func
(paren
l_string|&quot;    Bus speed %d Hz, %d slot(s)&bslash;n&quot;
comma
id|ld_le32
c_func
(paren
(paren
r_int
r_int
op_star
)paren
id|p.PPCData
)paren
comma
id|p.PPCData
(braket
l_int|4
)braket
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|7
suffix:colon
id|printk
c_func
(paren
l_string|&quot;    SCSI buses: %d, id(s):&quot;
comma
id|p.PPCData
(braket
l_int|0
)braket
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|1
suffix:semicolon
id|i
op_le
id|p.PPCData
(braket
l_int|0
)braket
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot; %d%c&quot;
comma
id|p.PPCData
(braket
id|i
)braket
comma
id|i
op_eq
id|p.PPCData
(braket
l_int|0
)braket
ques
c_cond
l_char|&squot;&bslash;n&squot;
suffix:colon
l_char|&squot;,&squot;
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
l_int|9
suffix:colon
id|printk
c_func
(paren
l_string|&quot;    %s address (%d bits), at 0x%x size 0x%x bytes&bslash;n&quot;
comma
id|addrtype
(braket
id|p.PPCData
(braket
l_int|0
)braket
op_minus
l_int|1
)braket
comma
id|p.PPCData
(braket
l_int|1
)braket
comma
id|ld_le32
c_func
(paren
(paren
r_int
r_int
op_star
)paren
(paren
id|p.PPCData
op_plus
l_int|4
)paren
)paren
comma
id|ld_le32
c_func
(paren
(paren
r_int
r_int
op_star
)paren
(paren
id|p.PPCData
op_plus
l_int|12
)paren
)paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|10
suffix:colon
id|sprintf
c_func
(paren
id|tmpstr
comma
id|inttype
(braket
id|p.PPCData
(braket
l_int|0
)braket
op_minus
l_int|1
)braket
comma
id|p.PPCData
(braket
l_int|1
)braket
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;    ISA interrupts routed to %s&bslash;n&quot;
l_string|&quot;      lines&quot;
comma
id|tmpstr
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|16
suffix:semicolon
id|i
op_increment
)paren
(brace
r_int
id|line
op_assign
id|ld_le16
c_func
(paren
(paren
r_int
r_int
op_star
)paren
id|p.PPCData
op_plus
id|i
op_plus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|line
op_ne
l_int|0xffff
)paren
id|printk
c_func
(paren
l_string|&quot; %d(IRQ%d)&quot;
comma
id|line
comma
id|i
)paren
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|printk
c_func
(paren
l_string|&quot;    Large vendor item type 0x%2.2x&bslash;n      Data (hex):&quot;
comma
id|p.Type
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|size
op_minus
l_int|4
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot; %2.2x&quot;
comma
id|p.PPCData
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
DECL|macro|p
macro_line|#undef p
)brace
)brace
DECL|function|printlargepacket
r_static
r_void
id|__init
id|printlargepacket
c_func
(paren
id|PnP_TAG_PACKET
op_star
id|pkt
comma
r_int
id|size
)paren
(brace
r_switch
c_cond
(paren
id|tag_large_item_name
c_func
(paren
id|pkt-&gt;S1_Pack.Tag
)paren
)paren
(brace
r_case
id|LargeVendorItem
suffix:colon
id|printlargevendor
c_func
(paren
id|pkt
comma
id|size
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|printk
c_func
(paren
l_string|&quot;    Type 0x2.2x%d, size=%d&bslash;n&quot;
comma
id|pkt-&gt;S1_Pack.Tag
comma
id|size
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
DECL|function|printpackets
r_static
r_void
id|__init
id|printpackets
c_func
(paren
id|PnP_TAG_PACKET
op_star
id|pkt
comma
r_const
r_char
op_star
id|cat
)paren
(brace
r_if
c_cond
(paren
id|pkt-&gt;S1_Pack.Tag
op_eq
id|END_TAG
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;  No packets describing %s resources.&bslash;n&quot;
comma
id|cat
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;  Packets describing %s resources:&bslash;n&quot;
comma
id|cat
)paren
suffix:semicolon
r_do
(brace
r_int
id|size
suffix:semicolon
r_if
c_cond
(paren
id|tag_type
c_func
(paren
id|pkt-&gt;S1_Pack.Tag
)paren
)paren
(brace
id|size
op_assign
l_int|3
op_plus
id|pkt-&gt;L1_Pack.Count0
op_plus
id|pkt-&gt;L1_Pack.Count1
op_star
l_int|256
suffix:semicolon
id|printlargepacket
c_func
(paren
id|pkt
comma
id|size
)paren
suffix:semicolon
)brace
r_else
(brace
id|size
op_assign
id|tag_small_count
c_func
(paren
id|pkt-&gt;S1_Pack.Tag
)paren
op_plus
l_int|1
suffix:semicolon
id|printsmallpacket
c_func
(paren
id|pkt
comma
id|size
)paren
suffix:semicolon
)brace
(paren
r_int
r_char
op_star
)paren
id|pkt
op_add_assign
id|size
suffix:semicolon
)brace
r_while
c_loop
(paren
id|pkt-&gt;S1_Pack.Tag
op_ne
id|END_TAG
)paren
suffix:semicolon
)brace
DECL|function|print_residual_device_info
r_void
id|__init
id|print_residual_device_info
c_func
(paren
r_void
)paren
(brace
r_int
id|i
suffix:semicolon
id|PPC_DEVICE
op_star
id|dev
suffix:semicolon
DECL|macro|did
mdefine_line|#define did dev-&gt;DeviceId
multiline_comment|/* make sure we have residual data first */
r_if
c_cond
(paren
id|res-&gt;ResidualLength
op_eq
l_int|0
)paren
r_return
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;Residual: %ld devices&bslash;n&quot;
comma
id|res-&gt;ActualNumDevices
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|res-&gt;ActualNumDevices
suffix:semicolon
id|i
op_increment
)paren
(brace
r_char
id|decomp
(braket
l_int|4
)braket
comma
id|sn
(braket
l_int|20
)braket
suffix:semicolon
r_const
r_char
op_star
id|s
suffix:semicolon
id|dev
op_assign
op_amp
id|res-&gt;Devices
(braket
id|i
)braket
suffix:semicolon
id|s
op_assign
id|PnP_INTERFACE_STR
c_func
(paren
id|did.BaseType
comma
id|did.SubType
comma
id|did.Interface
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|s
)paren
(brace
id|sprintf
c_func
(paren
id|sn
comma
l_string|&quot;interface %d&quot;
comma
id|did.Interface
)paren
suffix:semicolon
id|s
op_assign
id|sn
suffix:semicolon
)brace
r_if
c_cond
(paren
id|did.BusId
op_amp
id|PCIDEVICE
)paren
id|printk
c_func
(paren
l_string|&quot;PCI Device, Bus %d, DevFunc 0x%x:&quot;
comma
id|dev-&gt;BusAccess.PCIAccess.BusNumber
comma
id|dev-&gt;BusAccess.PCIAccess.DevFuncNumber
)paren
suffix:semicolon
r_if
c_cond
(paren
id|did.BusId
op_amp
id|PNPISADEVICE
)paren
id|printk
c_func
(paren
l_string|&quot;PNPISA Device:&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|did.BusId
op_amp
id|ISADEVICE
)paren
id|printk
c_func
(paren
l_string|&quot;ISA Device, Slot %d, LogicalDev %d:&quot;
comma
id|dev-&gt;BusAccess.ISAAccess.SlotNumber
comma
id|dev-&gt;BusAccess.ISAAccess.LogicalDevNumber
)paren
suffix:semicolon
r_if
c_cond
(paren
id|did.BusId
op_amp
id|EISADEVICE
)paren
id|printk
c_func
(paren
l_string|&quot;EISA Device:&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|did.BusId
op_amp
id|PROCESSORDEVICE
)paren
id|printk
c_func
(paren
l_string|&quot;ProcBus Device, Bus %d, BUID %d: &quot;
comma
id|dev-&gt;BusAccess.ProcBusAccess.BusNumber
comma
id|dev-&gt;BusAccess.ProcBusAccess.BUID
)paren
suffix:semicolon
r_if
c_cond
(paren
id|did.BusId
op_amp
id|PCMCIADEVICE
)paren
id|printk
c_func
(paren
l_string|&quot;PCMCIA &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|did.BusId
op_amp
id|VMEDEVICE
)paren
id|printk
c_func
(paren
l_string|&quot;VME &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|did.BusId
op_amp
id|MCADEVICE
)paren
id|printk
c_func
(paren
l_string|&quot;MCA &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|did.BusId
op_amp
id|MXDEVICE
)paren
id|printk
c_func
(paren
l_string|&quot;MX &quot;
)paren
suffix:semicolon
multiline_comment|/* Decompress first 3 chars */
id|decomp
(braket
l_int|0
)braket
op_assign
l_char|&squot;A&squot;
op_minus
l_int|1
op_plus
(paren
(paren
id|did.DevId
op_rshift
l_int|26
)paren
op_amp
l_int|0x1F
)paren
suffix:semicolon
id|decomp
(braket
l_int|1
)braket
op_assign
l_char|&squot;A&squot;
op_minus
l_int|1
op_plus
(paren
(paren
id|did.DevId
op_rshift
l_int|21
)paren
op_amp
l_int|0x1F
)paren
suffix:semicolon
id|decomp
(braket
l_int|2
)braket
op_assign
l_char|&squot;A&squot;
op_minus
l_int|1
op_plus
(paren
(paren
id|did.DevId
op_rshift
l_int|16
)paren
op_amp
l_int|0x1F
)paren
suffix:semicolon
id|decomp
(braket
l_int|3
)braket
op_assign
l_int|0
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; %s%4.4lX, %s, %s, %s&bslash;n&quot;
comma
id|decomp
comma
id|did.DevId
op_amp
l_int|0xffff
comma
id|PnP_BASE_TYPES
(braket
id|did.BaseType
)braket
comma
id|PnP_SUB_TYPE_STR
c_func
(paren
id|did.BaseType
comma
id|did.SubType
)paren
comma
id|s
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dev-&gt;AllocatedOffset
)paren
id|printpackets
c_func
(paren
(paren
r_union
id|_PnP_TAG_PACKET
op_star
)paren
op_amp
id|res-&gt;DevicePnPHeap
(braket
id|dev-&gt;AllocatedOffset
)braket
comma
l_string|&quot;allocated&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dev-&gt;PossibleOffset
)paren
id|printpackets
c_func
(paren
(paren
r_union
id|_PnP_TAG_PACKET
op_star
)paren
op_amp
id|res-&gt;DevicePnPHeap
(braket
id|dev-&gt;PossibleOffset
)braket
comma
l_string|&quot;possible&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dev-&gt;CompatibleOffset
)paren
id|printpackets
c_func
(paren
(paren
r_union
id|_PnP_TAG_PACKET
op_star
)paren
op_amp
id|res-&gt;DevicePnPHeap
(braket
id|dev-&gt;CompatibleOffset
)braket
comma
l_string|&quot;compatible&quot;
)paren
suffix:semicolon
)brace
)brace
macro_line|#if 0
r_static
r_void
id|__init
id|printVPD
c_func
(paren
r_void
)paren
(brace
mdefine_line|#define vpd res-&gt;VitalProductData
r_int
id|ps
op_assign
id|vpd.PageSize
comma
id|i
comma
id|j
suffix:semicolon
r_static
r_const
r_char
op_star
id|Usage
(braket
)braket
op_assign
initialization_block
suffix:semicolon
r_static
r_const
r_int
r_char
op_star
id|FWMan
(braket
)braket
op_assign
initialization_block
suffix:semicolon
r_static
r_const
r_int
r_char
op_star
id|FWFlags
(braket
)braket
op_assign
initialization_block
suffix:semicolon
r_static
r_const
r_int
r_char
op_star
id|ESM
(braket
)braket
op_assign
initialization_block
suffix:semicolon
r_static
r_const
r_int
r_char
op_star
id|SIOM
(braket
)braket
op_assign
initialization_block
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;Model: %s&bslash;n&quot;
comma
id|vpd.PrintableModel
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;Serial: %s&bslash;n&quot;
comma
id|vpd.Serial
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;FirmwareSupplier: %s&bslash;n&quot;
comma
id|FWMan
(braket
id|vpd.FirmwareSupplier
)braket
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;FirmwareFlags:&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
l_int|12
suffix:semicolon
id|j
op_increment
)paren
(brace
r_if
c_cond
(paren
id|vpd.FirmwareSupports
op_amp
(paren
l_int|1
op_lshift
id|j
)paren
)paren
(brace
id|printk
c_func
(paren
l_string|&quot; %s%c&quot;
comma
id|FWFlags
(braket
id|j
)braket
comma
id|vpd.FirmwareSupports
op_amp
(paren
op_minus
l_int|2
op_lshift
id|j
)paren
ques
c_cond
l_char|&squot;,&squot;
suffix:colon
l_char|&squot;&bslash;n&squot;
)paren
suffix:semicolon
)brace
)brace
id|printk
c_func
(paren
l_string|&quot;NVRamSize: %ld&bslash;n&quot;
comma
id|vpd.NvramSize
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;SIMMslots: %ld&bslash;n&quot;
comma
id|vpd.NumSIMMSlots
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;EndianSwitchMethod: %s&bslash;n&quot;
comma
id|ESM
(braket
id|vpd.EndianSwitchMethod
OG
l_int|2
ques
c_cond
l_int|2
suffix:colon
id|vpd.EndianSwitchMethod
)braket
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;SpreadIOMethod: %s&bslash;n&quot;
comma
id|SIOM
(braket
id|vpd.SpreadIOMethod
OG
l_int|3
ques
c_cond
l_int|3
suffix:colon
id|vpd.SpreadIOMethod
)braket
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;Processor/Bus frequencies (Hz): %ld/%ld&bslash;n&quot;
comma
id|vpd.ProcessorHz
comma
id|vpd.ProcessorBusHz
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;Time Base Divisor: %ld&bslash;n&quot;
comma
id|vpd.TimeBaseDivisor
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;WordWidth, PageSize: %ld, %d&bslash;n&quot;
comma
id|vpd.WordWidth
comma
id|ps
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;Cache sector size, Lock granularity: %ld, %ld&bslash;n&quot;
comma
id|vpd.CoherenceBlockSize
comma
id|vpd.GranuleSize
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|res-&gt;ActualNumMemSegs
suffix:semicolon
id|i
op_increment
)paren
(brace
r_int
id|mask
op_assign
id|res-&gt;Segs
(braket
id|i
)braket
dot
id|Usage
comma
id|first
comma
id|j
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%8.8lx-%8.8lx &quot;
comma
id|res-&gt;Segs
(braket
id|i
)braket
dot
id|BasePage
op_star
id|ps
comma
(paren
id|res-&gt;Segs
(braket
id|i
)braket
dot
id|PageCount
op_plus
id|res-&gt;Segs
(braket
id|i
)braket
dot
id|BasePage
)paren
op_star
id|ps
op_minus
l_int|1
)paren
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|15
comma
id|first
op_assign
l_int|1
suffix:semicolon
id|j
op_ge
l_int|0
suffix:semicolon
id|j
op_decrement
)paren
(brace
r_if
c_cond
(paren
id|mask
op_amp
(paren
l_int|1
op_lshift
id|j
)paren
)paren
(brace
r_if
c_cond
(paren
id|first
)paren
id|first
op_assign
l_int|0
suffix:semicolon
r_else
id|printk
c_func
(paren
l_string|&quot;, &quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s&quot;
comma
id|Usage
(braket
id|j
)braket
)paren
suffix:semicolon
)brace
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/*&n; * Spit out some info about residual data&n; */
r_void
id|print_residual_device_info
c_func
(paren
r_void
)paren
(brace
r_int
id|i
suffix:semicolon
r_union
id|_PnP_TAG_PACKET
op_star
id|pkt
suffix:semicolon
id|PPC_DEVICE
op_star
id|dev
suffix:semicolon
mdefine_line|#define did dev-&gt;DeviceId
multiline_comment|/* make sure we have residual data first */
r_if
c_cond
(paren
id|res-&gt;ResidualLength
op_eq
l_int|0
)paren
r_return
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;Residual: %ld devices&bslash;n&quot;
comma
id|res-&gt;ActualNumDevices
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|res-&gt;ActualNumDevices
suffix:semicolon
id|i
op_increment
)paren
(brace
id|dev
op_assign
op_amp
id|res-&gt;Devices
(braket
id|i
)braket
suffix:semicolon
multiline_comment|/*&n;&t;&t; * pci devices&n;&t;&t; */
r_if
c_cond
(paren
id|did.BusId
op_amp
id|PCIDEVICE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;PCI Device:&quot;
)paren
suffix:semicolon
multiline_comment|/* unknown vendor */
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
l_string|&quot;Unknown&quot;
comma
id|pci_strvendor
c_func
(paren
id|did.DevId
op_rshift
l_int|16
)paren
comma
l_int|7
)paren
)paren
id|printk
c_func
(paren
l_string|&quot; id %08lx types %d/%d&quot;
comma
id|did.DevId
comma
id|did.BaseType
comma
id|did.SubType
)paren
suffix:semicolon
multiline_comment|/* known vendor */
r_else
id|printk
c_func
(paren
l_string|&quot; %s %s&quot;
comma
id|pci_strvendor
c_func
(paren
id|did.DevId
op_rshift
l_int|16
)paren
comma
id|pci_strdev
c_func
(paren
id|did.DevId
op_rshift
l_int|16
comma
id|did.DevId
op_amp
l_int|0xffff
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|did.BusId
op_amp
id|PNPISADEVICE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot; pnp:&quot;
)paren
suffix:semicolon
multiline_comment|/* get pnp info on the device */
id|pkt
op_assign
(paren
r_union
id|_PnP_TAG_PACKET
op_star
)paren
op_amp
id|res-&gt;DevicePnPHeap
(braket
id|dev-&gt;AllocatedOffset
)braket
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
id|pkt-&gt;S1_Pack.Tag
op_ne
id|DF_END_TAG
suffix:semicolon
id|pkt
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|pkt-&gt;S1_Pack.Tag
op_eq
id|S4_Packet
)paren
op_logical_or
(paren
id|pkt-&gt;S1_Pack.Tag
op_eq
id|S4_Packet_flags
)paren
)paren
id|printk
c_func
(paren
l_string|&quot; irq %02x%02x&quot;
comma
id|pkt-&gt;S4_Pack.IRQMask
(braket
l_int|0
)braket
comma
id|pkt-&gt;S4_Pack.IRQMask
(braket
l_int|1
)braket
)paren
suffix:semicolon
)brace
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
r_continue
suffix:semicolon
)brace
multiline_comment|/*&n;&t;&t; * isa devices&n;&t;&t; */
r_if
c_cond
(paren
id|did.BusId
op_amp
id|ISADEVICE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;ISA Device: basetype: %d subtype: %d&quot;
comma
id|did.BaseType
comma
id|did.SubType
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
r_continue
suffix:semicolon
)brace
multiline_comment|/*&n;&t;&t; * eisa devices&n;&t;&t; */
r_if
c_cond
(paren
id|did.BusId
op_amp
id|EISADEVICE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;EISA Device: basetype: %d subtype: %d&quot;
comma
id|did.BaseType
comma
id|did.SubType
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
r_continue
suffix:semicolon
)brace
multiline_comment|/*&n;&t;&t; * proc bus devices&n;&t;&t; */
r_if
c_cond
(paren
id|did.BusId
op_amp
id|PROCESSORDEVICE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;ProcBus Device: basetype: %d subtype: %d&quot;
comma
id|did.BaseType
comma
id|did.SubType
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
r_continue
suffix:semicolon
)brace
multiline_comment|/*&n;&t;&t; * pcmcia devices&n;&t;&t; */
r_if
c_cond
(paren
id|did.BusId
op_amp
id|PCMCIADEVICE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;PCMCIA Device: basetype: %d subtype: %d&quot;
comma
id|did.BaseType
comma
id|did.SubType
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
r_continue
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;Unknown bus access device: busid %lx&bslash;n&quot;
comma
id|did.BusId
)paren
suffix:semicolon
)brace
)brace
macro_line|#endif&t;
multiline_comment|/* Returns the device index in the residual data, &n;   any of the search items may be set as -1 for wildcard,&n;   DevID number field (second halfword) is big endian ! &n;&n;   Examples:&n;   - search for the Interrupt controller (8259 type), 2 methods:&n;     1) i8259 = residual_find_device(~0, &n;                                     NULL, &n;&t;&t;&t;&t;     SystemPeripheral, &n;&t;&t;&t;&t;     ProgrammableInterruptController, &n;&t;&t;&t;&t;     ISA_PIC, &n;&t;&t;&t;&t;     0);&n;     2) i8259 = residual_find_device(~0, &quot;PNP0000&quot;, -1, -1, -1, 0) &n;&n;   - search for the first two serial devices, whatever their type)&n;     iserial1 = residual_find_device(~0,NULL,&n;                                     CommunicationsDevice,&n;&t;&t;&t;&t;     RS232Device,&n;&t;&t;&t;&t;     -1, 0)&n;     iserial2 = residual_find_device(~0,NULL,&n;                                     CommunicationsDevice,&n;&t;&t;&t;&t;     RS232Device,&n;&t;&t;&t;&t;     -1, 1)&n;   - but search for typical COM1 and COM2 is not easy due to the&n;     fact that the interface may be anything and the name &quot;PNP0500&quot; or &n;     &quot;PNP0501&quot;. Quite bad. &n;&n;*/
multiline_comment|/* devid are easier to uncompress than to compress, so to minimize bloat&n;in this rarely used area we unencode and compare */
multiline_comment|/* in residual data number is big endian in the device table and&n;little endian in the heap, so we use two parameters to avoid writing&n;two very similar functions */
DECL|function|same_DevID
r_static
r_int
id|__init
id|same_DevID
c_func
(paren
r_int
r_int
id|vendor
comma
r_int
r_int
id|Number
comma
r_char
op_star
id|str
)paren
(brace
r_static
r_int
r_const
r_char
id|hexdigit
(braket
)braket
op_assign
l_string|&quot;0123456789ABCDEF&quot;
suffix:semicolon
r_if
c_cond
(paren
id|strlen
c_func
(paren
id|str
)paren
op_ne
l_int|7
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
(paren
id|vendor
op_rshift
l_int|10
)paren
op_amp
l_int|0x1f
)paren
op_plus
l_char|&squot;A&squot;
op_minus
l_int|1
op_eq
id|str
(braket
l_int|0
)braket
)paren
op_logical_and
(paren
(paren
(paren
id|vendor
op_rshift
l_int|5
)paren
op_amp
l_int|0x1f
)paren
op_plus
l_char|&squot;A&squot;
op_minus
l_int|1
op_eq
id|str
(braket
l_int|1
)braket
)paren
op_logical_and
(paren
(paren
id|vendor
op_amp
l_int|0x1f
)paren
op_plus
l_char|&squot;A&squot;
op_minus
l_int|1
op_eq
id|str
(braket
l_int|2
)braket
)paren
op_logical_and
(paren
id|hexdigit
(braket
(paren
id|Number
op_rshift
l_int|12
)paren
op_amp
l_int|0x0f
)braket
op_eq
id|str
(braket
l_int|3
)braket
)paren
op_logical_and
(paren
id|hexdigit
(braket
(paren
id|Number
op_rshift
l_int|8
)paren
op_amp
l_int|0x0f
)braket
op_eq
id|str
(braket
l_int|4
)braket
)paren
op_logical_and
(paren
id|hexdigit
(braket
(paren
id|Number
op_rshift
l_int|4
)paren
op_amp
l_int|0x0f
)braket
op_eq
id|str
(braket
l_int|5
)braket
)paren
op_logical_and
(paren
id|hexdigit
(braket
id|Number
op_amp
l_int|0x0f
)braket
op_eq
id|str
(braket
l_int|6
)braket
)paren
)paren
r_return
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|residual_find_device
id|PPC_DEVICE
id|__init
op_star
id|residual_find_device
c_func
(paren
r_int
r_int
id|BusMask
comma
r_int
r_char
op_star
id|DevID
comma
r_int
id|BaseType
comma
r_int
id|SubType
comma
r_int
id|Interface
comma
r_int
id|n
)paren
(brace
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|res-&gt;ResidualLength
)paren
r_return
l_int|NULL
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|res-&gt;ActualNumDevices
suffix:semicolon
id|i
op_increment
)paren
(brace
DECL|macro|Dev
mdefine_line|#define Dev res-&gt;Devices[i].DeviceId
r_if
c_cond
(paren
(paren
id|Dev.BusId
op_amp
id|BusMask
)paren
op_logical_and
(paren
id|BaseType
op_eq
op_minus
l_int|1
op_logical_or
id|Dev.BaseType
op_eq
id|BaseType
)paren
op_logical_and
(paren
id|SubType
op_eq
op_minus
l_int|1
op_logical_or
id|Dev.SubType
op_eq
id|SubType
)paren
op_logical_and
(paren
id|Interface
op_eq
op_minus
l_int|1
op_logical_or
id|Dev.Interface
op_eq
id|Interface
)paren
op_logical_and
(paren
id|DevID
op_eq
l_int|NULL
op_logical_or
id|same_DevID
c_func
(paren
(paren
id|Dev.DevId
op_rshift
l_int|16
)paren
op_amp
l_int|0xffff
comma
id|Dev.DevId
op_amp
l_int|0xffff
comma
id|DevID
)paren
)paren
op_logical_and
op_logical_neg
(paren
id|n
op_decrement
)paren
)paren
r_return
id|res-&gt;Devices
op_plus
id|i
suffix:semicolon
DECL|macro|Dev
macro_line|#undef Dev
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|residual_find_device_id
id|PPC_DEVICE
id|__init
op_star
id|residual_find_device_id
c_func
(paren
r_int
r_int
id|BusMask
comma
r_int
r_int
id|DevID
comma
r_int
id|BaseType
comma
r_int
id|SubType
comma
r_int
id|Interface
comma
r_int
id|n
)paren
(brace
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|res-&gt;ResidualLength
)paren
r_return
l_int|NULL
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|res-&gt;ActualNumDevices
suffix:semicolon
id|i
op_increment
)paren
(brace
DECL|macro|Dev
mdefine_line|#define Dev res-&gt;Devices[i].DeviceId
r_if
c_cond
(paren
(paren
id|Dev.BusId
op_amp
id|BusMask
)paren
op_logical_and
(paren
id|BaseType
op_eq
op_minus
l_int|1
op_logical_or
id|Dev.BaseType
op_eq
id|BaseType
)paren
op_logical_and
(paren
id|SubType
op_eq
op_minus
l_int|1
op_logical_or
id|Dev.SubType
op_eq
id|SubType
)paren
op_logical_and
(paren
id|Interface
op_eq
op_minus
l_int|1
op_logical_or
id|Dev.Interface
op_eq
id|Interface
)paren
op_logical_and
(paren
id|DevID
op_eq
l_int|0xffff
op_logical_or
(paren
id|Dev.DevId
op_amp
l_int|0xffff
)paren
op_eq
id|DevID
)paren
op_logical_and
op_logical_neg
(paren
id|n
op_decrement
)paren
)paren
r_return
id|res-&gt;Devices
op_plus
id|i
suffix:semicolon
DECL|macro|Dev
macro_line|#undef Dev
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|PnP_find_packet
id|PnP_TAG_PACKET
op_star
id|PnP_find_packet
c_func
(paren
r_int
r_char
op_star
id|p
comma
r_int
id|packet_tag
comma
r_int
id|n
)paren
(brace
r_int
id|mask
comma
id|masked_tag
comma
id|size
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|p
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|tag_type
c_func
(paren
id|packet_tag
)paren
)paren
id|mask
op_assign
l_int|0xff
suffix:semicolon
r_else
id|mask
op_assign
l_int|0xF8
suffix:semicolon
id|masked_tag
op_assign
id|packet_tag
op_amp
id|mask
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
op_star
id|p
op_ne
id|END_TAG
suffix:semicolon
id|p
op_add_assign
id|size
)paren
(brace
r_if
c_cond
(paren
(paren
op_star
id|p
op_amp
id|mask
)paren
op_eq
id|masked_tag
op_logical_and
op_logical_neg
(paren
id|n
op_decrement
)paren
)paren
r_return
(paren
id|PnP_TAG_PACKET
op_star
)paren
id|p
suffix:semicolon
r_if
c_cond
(paren
id|tag_type
c_func
(paren
op_star
id|p
)paren
)paren
id|size
op_assign
id|ld_le16
c_func
(paren
(paren
r_int
r_int
op_star
)paren
(paren
id|p
op_plus
l_int|1
)paren
)paren
op_plus
l_int|3
suffix:semicolon
r_else
id|size
op_assign
id|tag_small_count
c_func
(paren
op_star
id|p
)paren
op_plus
l_int|1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
multiline_comment|/* not found */
)brace
DECL|function|PnP_find_small_vendor_packet
id|PnP_TAG_PACKET
id|__init
op_star
id|PnP_find_small_vendor_packet
c_func
(paren
r_int
r_char
op_star
id|p
comma
r_int
id|packet_type
comma
r_int
id|n
)paren
(brace
r_int
id|next
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|p
)paren
(brace
id|p
op_assign
(paren
r_int
r_char
op_star
)paren
id|PnP_find_packet
c_func
(paren
id|p
comma
l_int|0x70
comma
id|next
)paren
suffix:semicolon
r_if
c_cond
(paren
id|p
op_logical_and
id|p
(braket
l_int|1
)braket
op_eq
id|packet_type
op_logical_and
op_logical_neg
(paren
id|n
op_decrement
)paren
)paren
r_return
(paren
id|PnP_TAG_PACKET
op_star
)paren
id|p
suffix:semicolon
id|next
op_assign
l_int|1
suffix:semicolon
)brace
suffix:semicolon
r_return
l_int|0
suffix:semicolon
multiline_comment|/* not found */
)brace
DECL|function|PnP_find_large_vendor_packet
id|PnP_TAG_PACKET
id|__init
op_star
id|PnP_find_large_vendor_packet
c_func
(paren
r_int
r_char
op_star
id|p
comma
r_int
id|packet_type
comma
r_int
id|n
)paren
(brace
r_int
id|next
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|p
)paren
(brace
id|p
op_assign
(paren
r_int
r_char
op_star
)paren
id|PnP_find_packet
c_func
(paren
id|p
comma
l_int|0x84
comma
id|next
)paren
suffix:semicolon
r_if
c_cond
(paren
id|p
op_logical_and
id|p
(braket
l_int|3
)braket
op_eq
id|packet_type
op_logical_and
op_logical_neg
(paren
id|n
op_decrement
)paren
)paren
r_return
(paren
id|PnP_TAG_PACKET
op_star
)paren
id|p
suffix:semicolon
id|next
op_assign
l_int|1
suffix:semicolon
)brace
suffix:semicolon
r_return
l_int|0
suffix:semicolon
multiline_comment|/* not found */
)brace
eof
