multiline_comment|/*&n; *  linux/arch/ppc/kernel/setup.c&n; *&n; *  PowerPC version &n; *    Copyright (C) 1995-1996 Gary Thomas (gdt@linuxppc.org)&n; *&n; *  Adapted for Power Macintosh by Paul Mackerras&n; *    Copyright (C) 1996 Paul Mackerras (paulus@cs.anu.edu.au)&n; *&n; *  Derived from &quot;arch/alpha/kernel/setup.c&quot;&n; *    Copyright (C) 1995 Linus Torvalds&n; *&n; *  This program is free software; you can redistribute it and/or&n; *  modify it under the terms of the GNU General Public License&n; *  as published by the Free Software Foundation; either version&n; *  2 of the License, or (at your option) any later version.&n; *&n; */
multiline_comment|/*&n; * bootup setup stuff..&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/errno.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/stddef.h&gt;
macro_line|#include &lt;linux/unistd.h&gt;
macro_line|#include &lt;linux/ptrace.h&gt;
macro_line|#include &lt;linux/malloc.h&gt;
macro_line|#include &lt;linux/user.h&gt;
macro_line|#include &lt;linux/a.out.h&gt;
macro_line|#include &lt;linux/tty.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/ioport.h&gt;
macro_line|#include &lt;linux/major.h&gt;
macro_line|#include &lt;linux/blk.h&gt;
macro_line|#include &lt;linux/vt_kern.h&gt;
macro_line|#include &lt;linux/console.h&gt;
macro_line|#include &lt;linux/ide.h&gt;
macro_line|#include &lt;linux/pci.h&gt;
macro_line|#include &lt;linux/adb.h&gt;
macro_line|#include &lt;linux/cuda.h&gt;
macro_line|#include &lt;linux/pmu.h&gt;
macro_line|#include &lt;asm/init.h&gt;
macro_line|#include &lt;asm/prom.h&gt;
macro_line|#include &lt;asm/system.h&gt;
macro_line|#include &lt;asm/pgtable.h&gt;
macro_line|#include &lt;asm/bitops.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;asm/pci-bridge.h&gt;
macro_line|#include &lt;asm/ohare.h&gt;
macro_line|#include &lt;asm/mediabay.h&gt;
macro_line|#include &lt;asm/feature.h&gt;
macro_line|#include &lt;asm/machdep.h&gt;
macro_line|#include &lt;asm/keyboard.h&gt;
macro_line|#include &lt;asm/dma.h&gt;
macro_line|#include &lt;asm/bootx.h&gt;
macro_line|#include &lt;asm/time.h&gt;
macro_line|#include &quot;local_irq.h&quot;
macro_line|#include &quot;pmac_pic.h&quot;
DECL|macro|SHOW_GATWICK_IRQS
macro_line|#undef SHOW_GATWICK_IRQS
r_extern
r_int
id|pmac_time_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
r_int
id|pmac_get_rtc_time
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|pmac_set_rtc_time
c_func
(paren
r_int
r_int
id|nowtime
)paren
suffix:semicolon
r_extern
r_void
id|pmac_read_rtc_time
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_void
id|pmac_calibrate_decr
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_void
id|pmac_setup_pci_ptrs
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|mackbd_setkeycode
c_func
(paren
r_int
r_int
id|scancode
comma
r_int
r_int
id|keycode
)paren
suffix:semicolon
r_extern
r_int
id|mackbd_getkeycode
c_func
(paren
r_int
r_int
id|scancode
)paren
suffix:semicolon
r_extern
r_int
id|mackbd_translate
c_func
(paren
r_int
r_char
id|keycode
comma
r_int
r_char
op_star
id|keycodep
comma
r_char
id|raw_mode
)paren
suffix:semicolon
r_extern
r_int
id|mackbd_unexpected_up
c_func
(paren
r_int
r_char
id|keycode
)paren
suffix:semicolon
r_extern
r_void
id|mackbd_leds
c_func
(paren
r_int
r_char
id|leds
)paren
suffix:semicolon
r_extern
r_void
id|__init
id|mackbd_init_hw
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|mac_hid_kbd_translate
c_func
(paren
r_int
r_char
id|scancode
comma
r_int
r_char
op_star
id|keycode
comma
r_char
id|raw_mode
)paren
suffix:semicolon
r_extern
r_char
id|mac_hid_kbd_unexpected_up
c_func
(paren
r_int
r_char
id|keycode
)paren
suffix:semicolon
r_extern
r_void
id|mac_hid_init_hw
c_func
(paren
r_void
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_MAGIC_SYSRQ
r_extern
r_int
r_char
id|mac_hid_kbd_sysrq_xlate
(braket
l_int|128
)braket
suffix:semicolon
r_extern
r_int
r_char
id|pckbd_sysrq_xlate
(braket
l_int|128
)braket
suffix:semicolon
r_extern
r_int
r_char
id|mackbd_sysrq_xlate
(braket
l_int|128
)braket
suffix:semicolon
macro_line|#endif /* CONFIG_MAGIC_SYSRQ */
r_extern
r_int
id|pckbd_setkeycode
c_func
(paren
r_int
r_int
id|scancode
comma
r_int
r_int
id|keycode
)paren
suffix:semicolon
r_extern
r_int
id|pckbd_getkeycode
c_func
(paren
r_int
r_int
id|scancode
)paren
suffix:semicolon
r_extern
r_int
id|pckbd_translate
c_func
(paren
r_int
r_char
id|scancode
comma
r_int
r_char
op_star
id|keycode
comma
r_char
id|raw_mode
)paren
suffix:semicolon
r_extern
r_char
id|pckbd_unexpected_up
c_func
(paren
r_int
r_char
id|keycode
)paren
suffix:semicolon
r_extern
r_int
id|keyboard_sends_linux_keycodes
suffix:semicolon
r_extern
r_void
id|pmac_nvram_update
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_void
op_star
id|pmac_pci_dev_io_base
c_func
(paren
r_int
r_char
id|bus
comma
r_int
r_char
id|devfn
comma
r_int
id|physical
)paren
suffix:semicolon
r_extern
r_void
op_star
id|pmac_pci_dev_mem_base
c_func
(paren
r_int
r_char
id|bus
comma
r_int
r_char
id|devfn
)paren
suffix:semicolon
r_extern
r_int
id|pmac_pci_dev_root_bridge
c_func
(paren
r_int
r_char
id|bus
comma
r_int
r_char
id|devfn
)paren
suffix:semicolon
DECL|variable|drive_info
r_int
r_char
id|drive_info
suffix:semicolon
DECL|variable|ppc_override_l2cr
r_int
id|ppc_override_l2cr
op_assign
l_int|0
suffix:semicolon
DECL|variable|ppc_override_l2cr_value
r_int
id|ppc_override_l2cr_value
suffix:semicolon
DECL|variable|has_l2cache
r_int
id|has_l2cache
op_assign
l_int|0
suffix:semicolon
DECL|variable|current_root_goodness
r_static
r_int
id|current_root_goodness
op_assign
op_minus
l_int|1
suffix:semicolon
r_extern
r_char
id|saved_command_line
(braket
)braket
suffix:semicolon
r_extern
r_int
id|pmac_newworld
suffix:semicolon
DECL|macro|DEFAULT_ROOT_DEVICE
mdefine_line|#define DEFAULT_ROOT_DEVICE 0x0801&t;/* sda1 - slightly silly choice */
r_extern
r_void
id|zs_kgdb_hook
c_func
(paren
r_int
id|tty_num
)paren
suffix:semicolon
r_static
r_void
id|ohare_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_static
r_void
id|init_p2pbridge
c_func
(paren
r_void
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_BOOTX_TEXT
r_void
id|pmac_progress
c_func
(paren
r_char
op_star
id|s
comma
r_int
r_int
id|hex
)paren
suffix:semicolon
macro_line|#endif
DECL|variable|sys_ctrler
id|sys_ctrler_t
id|sys_ctrler
op_assign
id|SYS_CTRLER_UNKNOWN
suffix:semicolon
id|__pmac
r_int
DECL|function|pmac_get_cpuinfo
id|pmac_get_cpuinfo
c_func
(paren
r_char
op_star
id|buffer
)paren
(brace
r_int
id|len
suffix:semicolon
r_struct
id|device_node
op_star
id|np
suffix:semicolon
r_char
op_star
id|pp
suffix:semicolon
r_int
id|plen
suffix:semicolon
multiline_comment|/* find motherboard type */
id|len
op_assign
id|sprintf
c_func
(paren
id|buffer
comma
l_string|&quot;machine&bslash;t&bslash;t: &quot;
)paren
suffix:semicolon
id|np
op_assign
id|find_devices
c_func
(paren
l_string|&quot;device-tree&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|np
op_ne
l_int|NULL
)paren
(brace
id|pp
op_assign
(paren
r_char
op_star
)paren
id|get_property
c_func
(paren
id|np
comma
l_string|&quot;model&quot;
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pp
op_ne
l_int|NULL
)paren
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot;%s&bslash;n&quot;
comma
id|pp
)paren
suffix:semicolon
r_else
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot;PowerMac&bslash;n&quot;
)paren
suffix:semicolon
id|pp
op_assign
(paren
r_char
op_star
)paren
id|get_property
c_func
(paren
id|np
comma
l_string|&quot;compatible&quot;
comma
op_amp
id|plen
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pp
op_ne
l_int|NULL
)paren
(brace
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot;motherboard&bslash;t:&quot;
)paren
suffix:semicolon
r_while
c_loop
(paren
id|plen
OG
l_int|0
)paren
(brace
r_int
id|l
op_assign
id|strlen
c_func
(paren
id|pp
)paren
op_plus
l_int|1
suffix:semicolon
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot; %s&quot;
comma
id|pp
)paren
suffix:semicolon
id|plen
op_sub_assign
id|l
suffix:semicolon
id|pp
op_add_assign
id|l
suffix:semicolon
)brace
id|buffer
(braket
id|len
op_increment
)braket
op_assign
l_char|&squot;&bslash;n&squot;
suffix:semicolon
)brace
)brace
r_else
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot;PowerMac&bslash;n&quot;
)paren
suffix:semicolon
multiline_comment|/* find l2 cache info */
id|np
op_assign
id|find_devices
c_func
(paren
l_string|&quot;l2-cache&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|np
op_eq
l_int|0
)paren
id|np
op_assign
id|find_type_devices
c_func
(paren
l_string|&quot;cache&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|np
op_ne
l_int|0
)paren
(brace
r_int
r_int
op_star
id|ic
op_assign
(paren
r_int
r_int
op_star
)paren
id|get_property
c_func
(paren
id|np
comma
l_string|&quot;i-cache-size&quot;
comma
l_int|NULL
)paren
suffix:semicolon
r_int
r_int
op_star
id|dc
op_assign
(paren
r_int
r_int
op_star
)paren
id|get_property
c_func
(paren
id|np
comma
l_string|&quot;d-cache-size&quot;
comma
l_int|NULL
)paren
suffix:semicolon
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot;L2 cache&bslash;t:&quot;
)paren
suffix:semicolon
id|has_l2cache
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|get_property
c_func
(paren
id|np
comma
l_string|&quot;cache-unified&quot;
comma
l_int|NULL
)paren
op_ne
l_int|0
op_logical_and
id|dc
)paren
(brace
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot; %dK unified&quot;
comma
op_star
id|dc
op_div
l_int|1024
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|ic
)paren
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot; %dK instruction&quot;
comma
op_star
id|ic
op_div
l_int|1024
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dc
)paren
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot;%s %dK data&quot;
comma
(paren
id|ic
ques
c_cond
l_string|&quot; +&quot;
suffix:colon
l_string|&quot;&quot;
)paren
comma
op_star
id|dc
op_div
l_int|1024
)paren
suffix:semicolon
)brace
id|pp
op_assign
id|get_property
c_func
(paren
id|np
comma
l_string|&quot;ram-type&quot;
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pp
)paren
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot; %s&quot;
comma
id|pp
)paren
suffix:semicolon
id|buffer
(braket
id|len
op_increment
)braket
op_assign
l_char|&squot;&bslash;n&squot;
suffix:semicolon
)brace
multiline_comment|/* find ram info */
id|np
op_assign
id|find_devices
c_func
(paren
l_string|&quot;memory&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|np
op_ne
l_int|0
)paren
(brace
r_int
id|n
suffix:semicolon
r_struct
id|reg_property
op_star
id|reg
op_assign
(paren
r_struct
id|reg_property
op_star
)paren
id|get_property
c_func
(paren
id|np
comma
l_string|&quot;reg&quot;
comma
op_amp
id|n
)paren
suffix:semicolon
r_if
c_cond
(paren
id|reg
op_ne
l_int|0
)paren
(brace
r_int
r_int
id|total
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|n
op_div_assign
r_sizeof
(paren
r_struct
id|reg_property
)paren
suffix:semicolon
id|n
OG
l_int|0
suffix:semicolon
op_decrement
id|n
)paren
id|total
op_add_assign
(paren
id|reg
op_increment
)paren
op_member_access_from_pointer
id|size
suffix:semicolon
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot;memory&bslash;t&bslash;t: %luMB&bslash;n&quot;
comma
id|total
op_rshift
l_int|20
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/* Checks &quot;l2cr-value&quot; property in the registry */
id|np
op_assign
id|find_devices
c_func
(paren
l_string|&quot;cpus&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|np
op_eq
l_int|0
)paren
id|np
op_assign
id|find_type_devices
c_func
(paren
l_string|&quot;cpu&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|np
op_ne
l_int|0
)paren
(brace
r_int
r_int
op_star
id|l2cr
op_assign
(paren
r_int
r_int
op_star
)paren
id|get_property
c_func
(paren
id|np
comma
l_string|&quot;l2cr-value&quot;
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|l2cr
op_ne
l_int|0
)paren
(brace
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot;l2cr override&bslash;t: 0x%x&bslash;n&quot;
comma
op_star
id|l2cr
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/* Indicate newworld/oldworld */
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot;pmac-generation&bslash;t: %s&bslash;n&quot;
comma
id|pmac_newworld
ques
c_cond
l_string|&quot;NewWorld&quot;
suffix:colon
l_string|&quot;OldWorld&quot;
)paren
suffix:semicolon
r_return
id|len
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_SCSI
multiline_comment|/* Find the device number for the disk (if any) at target tgt&n;   on host adaptor host.  We just need to get the prototype from&n;   sd.h */
macro_line|#include &lt;linux/blkdev.h&gt;
macro_line|#include &quot;../../../drivers/scsi/scsi.h&quot;
macro_line|#include &quot;../../../drivers/scsi/sd.h&quot;
macro_line|#endif
multiline_comment|/*&n; * Dummy mksound function that does nothing.&n; * The real one is in the dmasound driver.&n; */
id|__pmac
r_static
r_void
DECL|function|pmac_mksound
id|pmac_mksound
c_func
(paren
r_int
r_int
id|hz
comma
r_int
r_int
id|ticks
)paren
(brace
)brace
DECL|variable|sysctrl_regs
r_static
r_volatile
id|u32
op_star
id|sysctrl_regs
suffix:semicolon
r_void
id|__init
DECL|function|pmac_setup_arch
id|pmac_setup_arch
c_func
(paren
r_void
)paren
(brace
r_struct
id|device_node
op_star
id|cpu
suffix:semicolon
r_int
op_star
id|fp
suffix:semicolon
multiline_comment|/* Set loops_per_sec to a half-way reasonable value,&n;&t;   for use until calibrate_delay gets called. */
id|cpu
op_assign
id|find_type_devices
c_func
(paren
l_string|&quot;cpu&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|cpu
op_ne
l_int|0
)paren
(brace
id|fp
op_assign
(paren
r_int
op_star
)paren
id|get_property
c_func
(paren
id|cpu
comma
l_string|&quot;clock-frequency&quot;
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fp
op_ne
l_int|0
)paren
(brace
r_switch
c_cond
(paren
id|_get_PVR
c_func
(paren
)paren
op_rshift
l_int|16
)paren
(brace
r_case
l_int|4
suffix:colon
multiline_comment|/* 604 */
r_case
l_int|8
suffix:colon
multiline_comment|/* G3 */
r_case
l_int|9
suffix:colon
multiline_comment|/* 604e */
r_case
l_int|10
suffix:colon
multiline_comment|/* mach V (604ev5) */
r_case
l_int|12
suffix:colon
multiline_comment|/* G4 */
r_case
l_int|20
suffix:colon
multiline_comment|/* 620 */
id|loops_per_sec
op_assign
op_star
id|fp
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
multiline_comment|/* 601, 603, etc. */
id|loops_per_sec
op_assign
op_star
id|fp
op_div
l_int|2
suffix:semicolon
)brace
)brace
r_else
id|loops_per_sec
op_assign
l_int|50000000
suffix:semicolon
)brace
multiline_comment|/* this area has the CPU identification register&n;&t;   and some registers used by smp boards */
id|sysctrl_regs
op_assign
(paren
r_volatile
id|u32
op_star
)paren
id|ioremap
c_func
(paren
l_int|0xf8000000
comma
l_int|0x1000
)paren
suffix:semicolon
id|__ioremap
c_func
(paren
l_int|0xffc00000
comma
l_int|0x400000
comma
id|pgprot_val
c_func
(paren
id|PAGE_READONLY
)paren
)paren
suffix:semicolon
id|ohare_init
c_func
(paren
)paren
suffix:semicolon
id|pmac_find_bridges
c_func
(paren
)paren
suffix:semicolon
id|init_p2pbridge
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* Checks &quot;l2cr-value&quot; property in the registry */
r_if
c_cond
(paren
(paren
id|_get_PVR
c_func
(paren
)paren
op_rshift
l_int|16
)paren
op_eq
l_int|8
op_logical_or
(paren
id|_get_PVR
c_func
(paren
)paren
op_rshift
l_int|16
)paren
op_eq
l_int|12
)paren
(brace
r_struct
id|device_node
op_star
id|np
op_assign
id|find_devices
c_func
(paren
l_string|&quot;cpus&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|np
op_eq
l_int|0
)paren
id|np
op_assign
id|find_type_devices
c_func
(paren
l_string|&quot;cpu&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|np
op_ne
l_int|0
)paren
(brace
r_int
r_int
op_star
id|l2cr
op_assign
(paren
r_int
r_int
op_star
)paren
id|get_property
c_func
(paren
id|np
comma
l_string|&quot;l2cr-value&quot;
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|l2cr
op_ne
l_int|0
)paren
(brace
id|ppc_override_l2cr
op_assign
l_int|1
suffix:semicolon
id|ppc_override_l2cr_value
op_assign
op_star
id|l2cr
suffix:semicolon
id|_set_L2CR
c_func
(paren
l_int|0
)paren
suffix:semicolon
id|_set_L2CR
c_func
(paren
id|ppc_override_l2cr_value
)paren
suffix:semicolon
)brace
)brace
)brace
r_if
c_cond
(paren
id|ppc_override_l2cr
)paren
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;L2CR overriden (0x%x), backside cache is %s&bslash;n&quot;
comma
id|ppc_override_l2cr_value
comma
(paren
id|ppc_override_l2cr_value
op_amp
l_int|0x80000000
)paren
ques
c_cond
l_string|&quot;enabled&quot;
suffix:colon
l_string|&quot;disabled&quot;
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_KGDB
id|zs_kgdb_hook
c_func
(paren
l_int|0
)paren
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_ADB_CUDA
id|find_via_cuda
c_func
(paren
)paren
suffix:semicolon
macro_line|#endif&t;
macro_line|#ifdef CONFIG_ADB_PMU
id|find_via_pmu
c_func
(paren
)paren
suffix:semicolon
macro_line|#endif&t;
macro_line|#ifdef CONFIG_NVRAM
id|pmac_nvram_init
c_func
(paren
)paren
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_DUMMY_CONSOLE
id|conswitchp
op_assign
op_amp
id|dummy_con
suffix:semicolon
macro_line|#endif
id|kd_mksound
op_assign
id|pmac_mksound
suffix:semicolon
macro_line|#ifdef CONFIG_BLK_DEV_INITRD
r_if
c_cond
(paren
id|initrd_start
)paren
id|ROOT_DEV
op_assign
id|MKDEV
c_func
(paren
id|RAMDISK_MAJOR
comma
l_int|0
)paren
suffix:semicolon
r_else
macro_line|#endif
id|ROOT_DEV
op_assign
id|to_kdev_t
c_func
(paren
id|DEFAULT_ROOT_DEVICE
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Tweak the PCI-PCI bridge chip on the blue &amp; white G3s.&n; */
DECL|function|init_p2pbridge
r_static
r_void
id|__init
id|init_p2pbridge
c_func
(paren
r_void
)paren
(brace
r_struct
id|device_node
op_star
id|p2pbridge
suffix:semicolon
r_int
r_char
id|bus
comma
id|devfn
suffix:semicolon
r_int
r_int
id|val
suffix:semicolon
multiline_comment|/* XXX it would be better here to identify the specific&n;&t;   PCI-PCI bridge chip we have. */
r_if
c_cond
(paren
(paren
id|p2pbridge
op_assign
id|find_devices
c_func
(paren
l_string|&quot;pci-bridge&quot;
)paren
)paren
op_eq
l_int|0
op_logical_or
id|p2pbridge-&gt;parent
op_eq
l_int|NULL
op_logical_or
id|strcmp
c_func
(paren
id|p2pbridge-&gt;parent-&gt;name
comma
l_string|&quot;pci&quot;
)paren
op_ne
l_int|0
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|pci_device_loc
c_func
(paren
id|p2pbridge
comma
op_amp
id|bus
comma
op_amp
id|devfn
)paren
OL
l_int|0
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|ppc_md
dot
id|pcibios_read_config_word
c_func
(paren
id|bus
comma
id|devfn
comma
id|PCI_BRIDGE_CONTROL
comma
op_amp
id|val
)paren
OL
l_int|0
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;init_p2pbridge: couldn&squot;t read bridge control&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|val
op_and_assign
op_complement
id|PCI_BRIDGE_CTL_MASTER_ABORT
suffix:semicolon
id|ppc_md
dot
id|pcibios_write_config_word
c_func
(paren
id|bus
comma
id|devfn
comma
id|PCI_BRIDGE_CONTROL
comma
id|val
)paren
suffix:semicolon
id|ppc_md
dot
id|pcibios_read_config_word
c_func
(paren
id|bus
comma
id|devfn
comma
id|PCI_BRIDGE_CONTROL
comma
op_amp
id|val
)paren
suffix:semicolon
)brace
DECL|function|ohare_init
r_static
r_void
id|__init
id|ohare_init
c_func
(paren
r_void
)paren
(brace
multiline_comment|/*&n;&t; * Turn on the L2 cache.&n;&t; * We assume that we have a PSX memory controller iff&n;&t; * we have an ohare I/O controller.&n;&t; */
r_if
c_cond
(paren
id|find_devices
c_func
(paren
l_string|&quot;ohare&quot;
)paren
op_ne
l_int|NULL
)paren
(brace
r_if
c_cond
(paren
(paren
(paren
id|sysctrl_regs
(braket
l_int|2
)braket
op_rshift
l_int|24
)paren
op_amp
l_int|0xf
)paren
op_ge
l_int|3
)paren
(brace
r_if
c_cond
(paren
id|sysctrl_regs
(braket
l_int|4
)braket
op_amp
l_int|0x10
)paren
id|sysctrl_regs
(braket
l_int|4
)braket
op_or_assign
l_int|0x04000020
suffix:semicolon
r_else
id|sysctrl_regs
(braket
l_int|4
)braket
op_or_assign
l_int|0x04000000
suffix:semicolon
r_if
c_cond
(paren
id|has_l2cache
)paren
(brace
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;Level 2 cache enabled&bslash;n&quot;
)paren
suffix:semicolon
)brace
)brace
)brace
)brace
r_extern
r_char
op_star
id|bootpath
suffix:semicolon
r_extern
r_char
op_star
id|bootdevice
suffix:semicolon
DECL|variable|boot_host
r_void
op_star
id|boot_host
suffix:semicolon
DECL|variable|boot_target
r_int
id|boot_target
suffix:semicolon
DECL|variable|boot_part
r_int
id|boot_part
suffix:semicolon
DECL|variable|boot_dev
id|kdev_t
id|boot_dev
suffix:semicolon
r_void
id|__init
DECL|function|pmac_init2
id|pmac_init2
c_func
(paren
r_void
)paren
(brace
macro_line|#ifdef CONFIG_ADB_PMU
id|via_pmu_start
c_func
(paren
)paren
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_ADB_CUDA
id|via_cuda_start
c_func
(paren
)paren
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_PMAC_PBOOK
id|media_bay_init
c_func
(paren
)paren
suffix:semicolon
macro_line|#endif&t;
)brace
macro_line|#ifdef CONFIG_SCSI
r_void
id|__init
DECL|function|note_scsi_host
id|note_scsi_host
c_func
(paren
r_struct
id|device_node
op_star
id|node
comma
r_void
op_star
id|host
)paren
(brace
r_int
id|l
suffix:semicolon
r_char
op_star
id|p
suffix:semicolon
id|l
op_assign
id|strlen
c_func
(paren
id|node-&gt;full_name
)paren
suffix:semicolon
r_if
c_cond
(paren
id|bootpath
op_ne
l_int|NULL
op_logical_and
id|bootdevice
op_ne
l_int|NULL
op_logical_and
id|strncmp
c_func
(paren
id|node-&gt;full_name
comma
id|bootdevice
comma
id|l
)paren
op_eq
l_int|0
op_logical_and
(paren
id|bootdevice
(braket
id|l
)braket
op_eq
l_char|&squot;/&squot;
op_logical_or
id|bootdevice
(braket
id|l
)braket
op_eq
l_int|0
)paren
)paren
(brace
id|boot_host
op_assign
id|host
suffix:semicolon
multiline_comment|/*&n;&t;&t; * There&squot;s a bug in OF 1.0.5.  (Why am I not surprised.)&n;&t;&t; * If you pass a path like scsi/sd@1:0 to canon, it returns&n;&t;&t; * something like /bandit@F2000000/gc@10/53c94@10000/sd@0,0&n;&t;&t; * That is, the scsi target number doesn&squot;t get preserved.&n;&t;&t; * So we pick the target number out of bootpath and use that.&n;&t;&t; */
id|p
op_assign
id|strstr
c_func
(paren
id|bootpath
comma
l_string|&quot;/sd@&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|p
op_ne
l_int|NULL
)paren
(brace
id|p
op_add_assign
l_int|4
suffix:semicolon
id|boot_target
op_assign
id|simple_strtoul
c_func
(paren
id|p
comma
l_int|NULL
comma
l_int|10
)paren
suffix:semicolon
id|p
op_assign
id|strchr
c_func
(paren
id|p
comma
l_char|&squot;:&squot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|p
op_ne
l_int|NULL
)paren
id|boot_part
op_assign
id|simple_strtoul
c_func
(paren
id|p
op_plus
l_int|1
comma
l_int|NULL
comma
l_int|10
)paren
suffix:semicolon
)brace
)brace
)brace
macro_line|#endif
macro_line|#if defined(CONFIG_BLK_DEV_IDE) &amp;&amp; defined(CONFIG_BLK_DEV_IDE_PMAC)
DECL|function|find_ide_boot
id|kdev_t
id|__init
id|find_ide_boot
c_func
(paren
r_void
)paren
(brace
r_char
op_star
id|p
suffix:semicolon
r_int
id|n
suffix:semicolon
id|kdev_t
id|__init
id|pmac_find_ide_boot
c_func
(paren
r_char
op_star
id|bootdevice
comma
r_int
id|n
)paren
suffix:semicolon
r_if
c_cond
(paren
id|bootdevice
op_eq
l_int|NULL
)paren
r_return
l_int|0
suffix:semicolon
id|p
op_assign
id|strrchr
c_func
(paren
id|bootdevice
comma
l_char|&squot;/&squot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|p
op_eq
l_int|NULL
)paren
r_return
l_int|0
suffix:semicolon
id|n
op_assign
id|p
op_minus
id|bootdevice
suffix:semicolon
r_return
id|pmac_find_ide_boot
c_func
(paren
id|bootdevice
comma
id|n
)paren
suffix:semicolon
)brace
macro_line|#endif /* CONFIG_BLK_DEV_IDE &amp;&amp; CONFIG_BLK_DEV_IDE_PMAC */
DECL|function|find_boot_device
r_void
id|__init
id|find_boot_device
c_func
(paren
r_void
)paren
(brace
macro_line|#ifdef CONFIG_SCSI
r_if
c_cond
(paren
id|boot_host
op_ne
l_int|NULL
)paren
(brace
id|boot_dev
op_assign
id|sd_find_target
c_func
(paren
id|boot_host
comma
id|boot_target
)paren
suffix:semicolon
r_if
c_cond
(paren
id|boot_dev
op_ne
l_int|0
)paren
r_return
suffix:semicolon
)brace
macro_line|#endif
macro_line|#if defined(CONFIG_BLK_DEV_IDE) &amp;&amp; defined(CONFIG_BLK_DEV_IDE_PMAC)
id|boot_dev
op_assign
id|find_ide_boot
c_func
(paren
)paren
suffix:semicolon
macro_line|#endif
)brace
multiline_comment|/* can&squot;t be __init - can be called whenever a disk is first accessed */
id|__pmac
DECL|function|note_bootable_part
r_void
id|note_bootable_part
c_func
(paren
id|kdev_t
id|dev
comma
r_int
id|part
comma
r_int
id|goodness
)paren
(brace
r_static
r_int
id|found_boot
op_assign
l_int|0
suffix:semicolon
r_char
op_star
id|p
suffix:semicolon
multiline_comment|/* Do nothing if the root has been set already. */
r_if
c_cond
(paren
(paren
id|goodness
OL
id|current_root_goodness
)paren
op_logical_and
(paren
id|ROOT_DEV
op_ne
id|to_kdev_t
c_func
(paren
id|DEFAULT_ROOT_DEVICE
)paren
)paren
)paren
r_return
suffix:semicolon
id|p
op_assign
id|strstr
c_func
(paren
id|saved_command_line
comma
l_string|&quot;root=&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|p
op_ne
l_int|NULL
op_logical_and
(paren
id|p
op_eq
id|saved_command_line
op_logical_or
id|p
(braket
op_minus
l_int|1
)braket
op_eq
l_char|&squot; &squot;
)paren
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|found_boot
)paren
(brace
id|find_boot_device
c_func
(paren
)paren
suffix:semicolon
id|found_boot
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|boot_dev
op_eq
l_int|0
op_logical_or
id|dev
op_eq
id|boot_dev
)paren
(brace
id|ROOT_DEV
op_assign
id|MKDEV
c_func
(paren
id|MAJOR
c_func
(paren
id|dev
)paren
comma
id|MINOR
c_func
(paren
id|dev
)paren
op_plus
id|part
)paren
suffix:semicolon
id|boot_dev
op_assign
id|NODEV
suffix:semicolon
id|current_root_goodness
op_assign
id|goodness
suffix:semicolon
)brace
)brace
r_void
DECL|function|pmac_restart
id|pmac_restart
c_func
(paren
r_char
op_star
id|cmd
)paren
(brace
macro_line|#ifdef CONFIG_ADB_CUDA
r_struct
id|adb_request
id|req
suffix:semicolon
macro_line|#endif /* CONFIG_ADB_CUDA */
id|pmac_nvram_update
c_func
(paren
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|sys_ctrler
)paren
(brace
macro_line|#ifdef CONFIG_ADB_CUDA
r_case
id|SYS_CTRLER_CUDA
suffix:colon
id|cuda_request
c_func
(paren
op_amp
id|req
comma
l_int|NULL
comma
l_int|2
comma
id|CUDA_PACKET
comma
id|CUDA_RESET_SYSTEM
)paren
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
suffix:semicolon
)paren
id|cuda_poll
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif /* CONFIG_ADB_CUDA */
macro_line|#ifdef CONFIG_ADB_PMU&t;&t;
r_case
id|SYS_CTRLER_PMU
suffix:colon
id|pmu_restart
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif /* CONFIG_ADB_PMU */&t;&t;
r_default
suffix:colon
(brace
)brace
)brace
)brace
r_void
DECL|function|pmac_power_off
id|pmac_power_off
c_func
(paren
r_void
)paren
(brace
macro_line|#ifdef CONFIG_ADB_CUDA
r_struct
id|adb_request
id|req
suffix:semicolon
macro_line|#endif /* CONFIG_ADB_CUDA */
id|pmac_nvram_update
c_func
(paren
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|sys_ctrler
)paren
(brace
macro_line|#ifdef CONFIG_ADB_CUDA
r_case
id|SYS_CTRLER_CUDA
suffix:colon
id|cuda_request
c_func
(paren
op_amp
id|req
comma
l_int|NULL
comma
l_int|2
comma
id|CUDA_PACKET
comma
id|CUDA_POWERDOWN
)paren
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
suffix:semicolon
)paren
id|cuda_poll
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif /* CONFIG_ADB_CUDA */
macro_line|#ifdef CONFIG_ADB_PMU
r_case
id|SYS_CTRLER_PMU
suffix:colon
id|pmu_shutdown
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif /* CONFIG_ADB_PMU */
r_default
suffix:colon
(brace
)brace
)brace
)brace
r_void
DECL|function|pmac_halt
id|pmac_halt
c_func
(paren
r_void
)paren
(brace
id|pmac_power_off
c_func
(paren
)paren
suffix:semicolon
)brace
macro_line|#if defined(CONFIG_BLK_DEV_IDE) || defined(CONFIG_BLK_DEV_IDE_MODULE)
multiline_comment|/*&n; * IDE stuff.&n; */
r_void
DECL|function|pmac_ide_insw
id|pmac_ide_insw
c_func
(paren
id|ide_ioreg_t
id|port
comma
r_void
op_star
id|buf
comma
r_int
id|ns
)paren
(brace
id|_insw_ns
c_func
(paren
(paren
r_int
r_int
op_star
)paren
(paren
id|port
op_plus
id|_IO_BASE
)paren
comma
id|buf
comma
id|ns
)paren
suffix:semicolon
)brace
r_void
DECL|function|pmac_ide_outsw
id|pmac_ide_outsw
c_func
(paren
id|ide_ioreg_t
id|port
comma
r_void
op_star
id|buf
comma
r_int
id|ns
)paren
(brace
id|_outsw_ns
c_func
(paren
(paren
r_int
r_int
op_star
)paren
(paren
id|port
op_plus
id|_IO_BASE
)paren
comma
id|buf
comma
id|ns
)paren
suffix:semicolon
)brace
r_int
DECL|function|pmac_ide_default_irq
id|pmac_ide_default_irq
c_func
(paren
id|ide_ioreg_t
id|base
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#if defined(CONFIG_BLK_DEV_IDE) &amp;&amp; defined(CONFIG_BLK_DEV_IDE_PMAC)
r_extern
id|ide_ioreg_t
id|pmac_ide_get_base
c_func
(paren
r_int
id|index
)paren
suffix:semicolon
macro_line|#endif
id|ide_ioreg_t
DECL|function|pmac_ide_default_io_base
id|pmac_ide_default_io_base
c_func
(paren
r_int
id|index
)paren
(brace
macro_line|#if defined(CONFIG_BLK_DEV_IDE) &amp;&amp; defined(CONFIG_BLK_DEV_IDE_PMAC)
r_return
id|pmac_ide_get_base
c_func
(paren
id|index
)paren
suffix:semicolon
macro_line|#else
r_return
l_int|0
suffix:semicolon
macro_line|#endif
)brace
r_int
DECL|function|pmac_ide_check_region
id|pmac_ide_check_region
c_func
(paren
id|ide_ioreg_t
id|from
comma
r_int
r_int
id|extent
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
r_void
DECL|function|pmac_ide_request_region
id|pmac_ide_request_region
c_func
(paren
id|ide_ioreg_t
id|from
comma
r_int
r_int
id|extent
comma
r_const
r_char
op_star
id|name
)paren
(brace
)brace
r_void
DECL|function|pmac_ide_release_region
id|pmac_ide_release_region
c_func
(paren
id|ide_ioreg_t
id|from
comma
r_int
r_int
id|extent
)paren
(brace
)brace
multiline_comment|/* Convert the shorts/longs in hd_driveid from little to big endian;&n; * chars are endian independant, of course, but strings need to be flipped.&n; * (Despite what it says in drivers/block/ide.h, they come up as little&n; * endian...)&n; *&n; * Changes to linux/hdreg.h may require changes here. */
r_void
DECL|function|pmac_ide_fix_driveid
id|pmac_ide_fix_driveid
c_func
(paren
r_struct
id|hd_driveid
op_star
id|id
)paren
(brace
id|ppc_generic_ide_fix_driveid
c_func
(paren
id|id
)paren
suffix:semicolon
)brace
macro_line|#if defined(CONFIG_BLK_DEV_IDE) &amp;&amp; defined(CONFIG_BLK_DEV_IDE_PMAC)
multiline_comment|/* This is declared in drivers/block/ide-pmac.c */
r_void
id|pmac_ide_init_hwif_ports
(paren
id|hw_regs_t
op_star
id|hw
comma
id|ide_ioreg_t
id|data_port
comma
id|ide_ioreg_t
id|ctrl_port
comma
r_int
op_star
id|irq
)paren
suffix:semicolon
macro_line|#else
multiline_comment|/*&n; * This registers the standard ports for this architecture with the IDE&n; * driver.&n; */
DECL|function|pmac_ide_init_hwif_ports
r_void
id|pmac_ide_init_hwif_ports
c_func
(paren
id|hw_regs_t
op_star
id|hw
comma
id|ide_ioreg_t
id|data_port
comma
id|ide_ioreg_t
id|ctrl_port
comma
r_int
op_star
id|irq
)paren
(brace
)brace
macro_line|#endif
macro_line|#endif
r_void
id|__init
DECL|function|pmac_init
id|pmac_init
c_func
(paren
r_int
r_int
id|r3
comma
r_int
r_int
id|r4
comma
r_int
r_int
id|r5
comma
r_int
r_int
id|r6
comma
r_int
r_int
id|r7
)paren
(brace
id|pmac_setup_pci_ptrs
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* isa_io_base gets set in pmac_find_bridges */
id|isa_mem_base
op_assign
id|PMAC_ISA_MEM_BASE
suffix:semicolon
id|pci_dram_offset
op_assign
id|PMAC_PCI_DRAM_OFFSET
suffix:semicolon
id|ISA_DMA_THRESHOLD
op_assign
op_complement
l_int|0L
suffix:semicolon
id|DMA_MODE_READ
op_assign
l_int|1
suffix:semicolon
id|DMA_MODE_WRITE
op_assign
l_int|2
suffix:semicolon
id|ppc_md.setup_arch
op_assign
id|pmac_setup_arch
suffix:semicolon
id|ppc_md.setup_residual
op_assign
l_int|NULL
suffix:semicolon
id|ppc_md.get_cpuinfo
op_assign
id|pmac_get_cpuinfo
suffix:semicolon
id|ppc_md.irq_cannonicalize
op_assign
l_int|NULL
suffix:semicolon
id|ppc_md.init_IRQ
op_assign
id|pmac_pic_init
suffix:semicolon
id|ppc_md.get_irq
op_assign
id|pmac_get_irq
suffix:semicolon
id|ppc_md.init
op_assign
id|pmac_init2
suffix:semicolon
id|ppc_md.restart
op_assign
id|pmac_restart
suffix:semicolon
id|ppc_md.power_off
op_assign
id|pmac_power_off
suffix:semicolon
id|ppc_md.halt
op_assign
id|pmac_halt
suffix:semicolon
id|ppc_md.time_init
op_assign
id|pmac_time_init
suffix:semicolon
id|ppc_md.set_rtc_time
op_assign
id|pmac_set_rtc_time
suffix:semicolon
id|ppc_md.get_rtc_time
op_assign
id|pmac_get_rtc_time
suffix:semicolon
id|ppc_md.calibrate_decr
op_assign
id|pmac_calibrate_decr
suffix:semicolon
id|ppc_md.pci_dev_io_base
op_assign
id|pmac_pci_dev_io_base
suffix:semicolon
id|ppc_md.pci_dev_mem_base
op_assign
id|pmac_pci_dev_mem_base
suffix:semicolon
id|ppc_md.pci_dev_root_bridge
op_assign
id|pmac_pci_dev_root_bridge
suffix:semicolon
macro_line|#ifdef CONFIG_VT
macro_line|#ifdef CONFIG_INPUT_ADBHID
id|ppc_md.kbd_init_hw
op_assign
id|mac_hid_init_hw
suffix:semicolon
id|ppc_md.kbd_translate
op_assign
id|mac_hid_kbd_translate
suffix:semicolon
id|ppc_md.kbd_unexpected_up
op_assign
id|mac_hid_kbd_unexpected_up
suffix:semicolon
id|ppc_md.kbd_setkeycode
op_assign
l_int|0
suffix:semicolon
id|ppc_md.kbd_getkeycode
op_assign
l_int|0
suffix:semicolon
macro_line|#ifdef CONFIG_MAGIC_SYSRQ
macro_line|#ifdef CONFIG_MAC_ADBKEYCODES
r_if
c_cond
(paren
op_logical_neg
id|keyboard_sends_linux_keycodes
)paren
(brace
id|ppc_md.ppc_kbd_sysrq_xlate
op_assign
id|mac_hid_kbd_sysrq_xlate
suffix:semicolon
id|SYSRQ_KEY
op_assign
l_int|0x69
suffix:semicolon
)brace
r_else
macro_line|#endif /* CONFIG_MAC_ADBKEYCODES */
(brace
id|ppc_md.ppc_kbd_sysrq_xlate
op_assign
id|pckbd_sysrq_xlate
suffix:semicolon
id|SYSRQ_KEY
op_assign
l_int|0x54
suffix:semicolon
)brace
macro_line|#endif /* CONFIG_MAGIC_SYSRQ */
macro_line|#elif defined(CONFIG_ADB_KEYBOARD)
id|ppc_md.kbd_setkeycode
op_assign
id|mackbd_setkeycode
suffix:semicolon
id|ppc_md.kbd_getkeycode
op_assign
id|mackbd_getkeycode
suffix:semicolon
id|ppc_md.kbd_translate
op_assign
id|mackbd_translate
suffix:semicolon
id|ppc_md.kbd_unexpected_up
op_assign
id|mackbd_unexpected_up
suffix:semicolon
id|ppc_md.kbd_leds
op_assign
id|mackbd_leds
suffix:semicolon
id|ppc_md.kbd_init_hw
op_assign
id|mackbd_init_hw
suffix:semicolon
macro_line|#ifdef CONFIG_MAGIC_SYSRQ
id|ppc_md.ppc_kbd_sysrq_xlate
op_assign
id|mackbd_sysrq_xlate
suffix:semicolon
id|SYSRQ_KEY
op_assign
l_int|0x69
suffix:semicolon
macro_line|#endif /* CONFIG_MAGIC_SYSRQ */
macro_line|#endif /* CONFIG_INPUT_ADBHID/CONFIG_ADB_KEYBOARD */
macro_line|#endif /* CONFIG_VT */
macro_line|#if defined(CONFIG_BLK_DEV_IDE) &amp;&amp; defined(CONFIG_BLK_DEV_IDE_PMAC)
id|ppc_ide_md.insw
op_assign
id|pmac_ide_insw
suffix:semicolon
id|ppc_ide_md.outsw
op_assign
id|pmac_ide_outsw
suffix:semicolon
id|ppc_ide_md.default_irq
op_assign
id|pmac_ide_default_irq
suffix:semicolon
id|ppc_ide_md.default_io_base
op_assign
id|pmac_ide_default_io_base
suffix:semicolon
id|ppc_ide_md.ide_check_region
op_assign
id|pmac_ide_check_region
suffix:semicolon
id|ppc_ide_md.ide_request_region
op_assign
id|pmac_ide_request_region
suffix:semicolon
id|ppc_ide_md.ide_release_region
op_assign
id|pmac_ide_release_region
suffix:semicolon
id|ppc_ide_md.fix_driveid
op_assign
id|pmac_ide_fix_driveid
suffix:semicolon
id|ppc_ide_md.ide_init_hwif
op_assign
id|pmac_ide_init_hwif_ports
suffix:semicolon
id|ppc_ide_md.io_base
op_assign
id|_IO_BASE
suffix:semicolon
multiline_comment|/* actually too early for this :-( */
macro_line|#endif
macro_line|#ifdef CONFIG_BOOTX_TEXT
id|ppc_md.progress
op_assign
id|pmac_progress
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
id|ppc_md.progress
)paren
id|ppc_md
dot
id|progress
c_func
(paren
l_string|&quot;pmac_init(): exit&quot;
comma
l_int|0
)paren
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_BOOTX_TEXT
r_extern
r_void
id|drawchar
c_func
(paren
r_char
id|c
)paren
suffix:semicolon
r_extern
r_void
id|drawstring
c_func
(paren
r_const
r_char
op_star
id|c
)paren
suffix:semicolon
r_extern
id|boot_infos_t
op_star
id|disp_bi
suffix:semicolon
r_void
DECL|function|pmac_progress
id|pmac_progress
c_func
(paren
r_char
op_star
id|s
comma
r_int
r_int
id|hex
)paren
(brace
r_if
c_cond
(paren
id|disp_bi
op_eq
l_int|0
)paren
r_return
suffix:semicolon
id|prom_drawstring
c_func
(paren
id|s
)paren
suffix:semicolon
id|prom_drawchar
c_func
(paren
l_char|&squot;&bslash;n&squot;
)paren
suffix:semicolon
)brace
macro_line|#endif CONFIG_BOOTX_TEXT
eof
