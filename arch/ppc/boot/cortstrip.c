macro_line|#include &lt;stdio.h&gt;
macro_line|#include &lt;sys/types.h&gt;
macro_line|#include &lt;unistd.h&gt;
macro_line|#include &lt;fcntl.h&gt;
multiline_comment|/* amount to skip */
DECL|macro|PLACE
mdefine_line|#define PLACE 65536
multiline_comment|/* size of read buffer */
DECL|macro|SIZE
mdefine_line|#define SIZE 0x100000
multiline_comment|/* crude program to strip the elf header to make a bootable&n;   image via tftp&n; */
DECL|function|main
r_int
id|main
c_func
(paren
r_int
id|argc
comma
r_char
op_star
op_star
id|argv
)paren
(brace
r_int
id|fd
comma
id|fdo
suffix:semicolon
r_int
r_char
id|data
(braket
id|SIZE
)braket
suffix:semicolon
r_int
id|i
comma
id|n
comma
id|skip
suffix:semicolon
macro_line|#if 0
r_if
c_cond
(paren
id|argc
op_ne
l_int|3
)paren
(brace
id|fprintf
c_func
(paren
id|stderr
comma
l_string|&quot;%s infile outfile&bslash;n&quot;
comma
id|argv
(braket
l_int|0
)braket
)paren
suffix:semicolon
m_exit
(paren
op_minus
l_int|1
)paren
suffix:semicolon
)brace
macro_line|#endif
id|fd
op_assign
id|open
c_func
(paren
id|argv
(braket
l_int|1
)braket
comma
id|O_RDONLY
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fd
op_eq
op_minus
l_int|1
)paren
(brace
id|fprintf
c_func
(paren
id|stderr
comma
l_string|&quot;Couldn&squot;t open %s&bslash;n&quot;
comma
id|argv
(braket
l_int|1
)braket
)paren
suffix:semicolon
id|perror
c_func
(paren
l_string|&quot;open()&quot;
)paren
suffix:semicolon
m_exit
(paren
op_minus
l_int|1
)paren
suffix:semicolon
)brace
id|fdo
op_assign
id|open
c_func
(paren
id|argv
(braket
l_int|2
)braket
comma
id|O_WRONLY
op_or
id|O_CREAT
op_or
id|O_TRUNC
comma
l_int|0755
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fdo
op_eq
op_minus
l_int|1
)paren
(brace
id|fprintf
c_func
(paren
id|stderr
comma
l_string|&quot;Couldn&squot;t open %s&bslash;n&quot;
comma
id|argv
(braket
l_int|2
)braket
)paren
suffix:semicolon
id|perror
c_func
(paren
l_string|&quot;open()&quot;
)paren
suffix:semicolon
m_exit
(paren
op_minus
l_int|1
)paren
suffix:semicolon
)brace
macro_line|#if 0
id|skip
op_assign
id|atoi
c_func
(paren
id|argv
(braket
l_int|3
)braket
)paren
suffix:semicolon
macro_line|#else
id|skip
op_assign
id|PLACE
suffix:semicolon
macro_line|#endif
id|i
op_assign
id|lseek
c_func
(paren
id|fd
comma
id|skip
comma
id|SEEK_SET
)paren
suffix:semicolon
multiline_comment|/*printf(&quot;lseek&squot;d %d bytes&bslash;n&quot;, i);*/
r_if
c_cond
(paren
id|i
op_eq
op_minus
l_int|1
)paren
(brace
id|perror
c_func
(paren
l_string|&quot;lseek()&quot;
)paren
suffix:semicolon
)brace
r_while
c_loop
(paren
(paren
id|n
op_assign
id|read
c_func
(paren
id|fd
comma
id|data
comma
id|SIZE
)paren
)paren
OG
l_int|0
)paren
(brace
multiline_comment|/*printf(&quot;Read %d bytes&bslash;n&quot;, n);*/
id|i
op_assign
id|write
c_func
(paren
id|fdo
comma
id|data
comma
id|n
)paren
suffix:semicolon
multiline_comment|/*printf(&quot;Wrote %d bytes&bslash;n&quot;, i);    */
)brace
id|close
c_func
(paren
id|fdo
)paren
suffix:semicolon
id|close
c_func
(paren
id|fd
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
eof
