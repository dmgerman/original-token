multiline_comment|/* $Id: setup.c,v 1.4 1999/10/09 00:00:57 ralf Exp $&n; *&n; * setup.c: Baget/MIPS specific setup, including init of the feature struct.&n; *&n; * Copyright (C) 1998 Gleb Raiko &amp; Vladimir Roganov&n; *&n; */
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;asm/irq.h&gt;
macro_line|#include &lt;asm/addrspace.h&gt;
macro_line|#include &lt;asm/reboot.h&gt;
macro_line|#include &lt;asm/baget/baget.h&gt;
r_extern
r_int
id|mips_memory_upper
suffix:semicolon
DECL|macro|CACHEABLE_STR
mdefine_line|#define CACHEABLE_STR(val) ((val) ? &quot;not cached&quot; : &quot;cached&quot;)
DECL|macro|MIN
mdefine_line|#define MIN(a,b)           (((a)&lt;(b)) ? (a):(b)) 
DECL|function|vac_show
r_static
r_void
id|__init
id|vac_show
c_func
(paren
r_void
)paren
(brace
r_int
id|i
suffix:semicolon
r_int
r_int
id|val
comma
id|decode
op_assign
id|vac_inw
c_func
(paren
id|VAC_DECODE_CTRL
)paren
suffix:semicolon
r_int
r_int
id|a24_base
op_assign
id|vac_inw
c_func
(paren
id|VAC_A24_BASE
)paren
suffix:semicolon
r_int
r_int
id|a24_addr
op_assign
(paren
(paren
r_int
r_int
)paren
(paren
id|a24_base
op_amp
id|VAC_A24_MASK
)paren
)paren
op_lshift
l_int|16
suffix:semicolon
r_char
op_star
id|decode_mode
(braket
)braket
op_assign
(brace
l_string|&quot;eprom&quot;
comma
l_string|&quot;vsb&quot;
comma
l_string|&quot;shared&quot;
comma
l_string|&quot;dram&quot;
)brace
suffix:semicolon
r_char
op_star
id|address_mode
(braket
)braket
op_assign
(brace
l_string|&quot;&quot;
comma
l_string|&quot;, A16&quot;
comma
l_string|&quot;, A32/A24&quot;
comma
l_string|&quot;, A32/A24/A16&quot;
)brace
suffix:semicolon
r_char
op_star
id|state
(braket
)braket
op_assign
(brace
l_string|&quot;&quot;
comma
l_string|&quot; on write&quot;
comma
l_string|&quot; on read&quot;
comma
l_string|&quot; on read/write&quot;
comma
)brace
suffix:semicolon
r_char
op_star
id|region_mode
(braket
)braket
op_assign
(brace
l_string|&quot;inactive&quot;
comma
l_string|&quot;shared&quot;
comma
l_string|&quot;vsb&quot;
comma
l_string|&quot;vme&quot;
)brace
suffix:semicolon
r_char
op_star
id|asiz
(braket
)braket
op_assign
(brace
l_string|&quot;user&quot;
comma
l_string|&quot;A32&quot;
comma
l_string|&quot;A16&quot;
comma
l_string|&quot;A24&quot;
)brace
suffix:semicolon
r_int
r_int
id|regs
(braket
)braket
op_assign
(brace
id|VAC_REG1
comma
id|VAC_REG2
comma
id|VAC_REG3
)brace
suffix:semicolon
r_int
r_int
id|bndr
(braket
)braket
op_assign
(brace
id|VAC_DRAM_MASK
comma
id|VAC_BNDR2
comma
id|VAC_BNDR3
)brace
suffix:semicolon
r_int
r_int
id|io_sels
(braket
)braket
op_assign
(brace
id|VAC_IOSEL0_CTRL
comma
id|VAC_IOSEL1_CTRL
comma
id|VAC_IOSEL2_CTRL
comma
id|VAC_IOSEL3_CTRL
comma
id|VAC_IOSEL4_CTRL
comma
id|VAC_IOSEL5_CTRL
)brace
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;[DSACKi %s, DRAMCS%s qualified, boundary%s qualified%s]&bslash;n&quot;
comma
(paren
id|decode
op_amp
id|VAC_DECODE_DSACKI
)paren
ques
c_cond
l_string|&quot;on&quot;
suffix:colon
l_string|&quot;off&quot;
comma
(paren
id|decode
op_amp
id|VAC_DECODE_QFY_DRAMCS
)paren
ques
c_cond
l_string|&quot;&quot;
suffix:colon
l_string|&quot; not&quot;
comma
(paren
id|decode
op_amp
id|VAC_DECODE_QFY_BNDR
)paren
ques
c_cond
l_string|&quot;&quot;
suffix:colon
l_string|&quot; not&quot;
comma
(paren
id|decode
op_amp
id|VAC_DECODE_FPUCS
)paren
ques
c_cond
l_string|&quot;, fpu&quot;
suffix:colon
l_string|&quot;&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;slave0 &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|decode
op_amp
id|VAC_DECODE_RDR_SLSEL0
)paren
id|printk
c_func
(paren
l_string|&quot;at %08lx (%d MB)&bslash;t[dram %s]&bslash;n&quot;
comma
(paren
(paren
r_int
r_int
)paren
id|vac_inw
c_func
(paren
id|VAC_SLSEL0_BASE
)paren
)paren
op_lshift
l_int|16
comma
(paren
(paren
l_int|0xffff
op_xor
id|vac_inw
c_func
(paren
id|VAC_SLSEL0_MASK
)paren
)paren
op_plus
l_int|1
)paren
op_rshift
l_int|4
comma
(paren
id|decode
op_amp
id|VAC_DECODE_QFY_SLSEL0
)paren
ques
c_cond
l_string|&quot;qualified&quot;
suffix:colon
l_string|&quot;&quot;
)paren
suffix:semicolon
r_else
id|printk
c_func
(paren
l_string|&quot;off&bslash;n&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;slave1 &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|decode
op_amp
id|VAC_DECODE_RDR_SLSEL1
)paren
id|printk
c_func
(paren
l_string|&quot;at %08lx (%d MB)&bslash;t[%s%s, %s]&bslash;n&quot;
comma
(paren
(paren
r_int
r_int
)paren
id|vac_inw
c_func
(paren
id|VAC_SLSEL1_BASE
)paren
)paren
op_lshift
l_int|16
comma
(paren
(paren
l_int|0xffff
op_xor
id|vac_inw
c_func
(paren
id|VAC_SLSEL1_MASK
)paren
)paren
op_plus
l_int|1
)paren
op_rshift
l_int|4
comma
id|decode_mode
(braket
id|VAC_DECODE_MODE_VAL
c_func
(paren
id|decode
)paren
)braket
comma
id|address_mode
(braket
id|VAC_DECODE_CMP_SLSEL1_VAL
c_func
(paren
id|decode
)paren
)braket
comma
(paren
id|decode
op_amp
id|VAC_DECODE_QFY_SLSEL1
)paren
ques
c_cond
l_string|&quot;qualified&quot;
suffix:colon
l_string|&quot;&quot;
)paren
suffix:semicolon
r_else
id|printk
c_func
(paren
l_string|&quot;off&bslash;n&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;icf global at %04x, module at %04x [%s]&bslash;n&quot;
comma
(paren
(paren
r_int
r_int
)paren
id|VAC_ICFSEL_GLOBAL_VAL
c_func
(paren
id|vac_inw
c_func
(paren
id|VAC_ICFSEL_BASE
)paren
)paren
)paren
op_lshift
l_int|4
comma
(paren
(paren
r_int
r_int
)paren
id|VAC_ICFSEL_MODULE_VAL
c_func
(paren
id|vac_inw
c_func
(paren
id|VAC_ICFSEL_BASE
)paren
)paren
)paren
op_lshift
l_int|4
comma
(paren
id|decode
op_amp
id|VAC_DECODE_QFY_ICFSEL
)paren
ques
c_cond
l_string|&quot;qualified&quot;
suffix:colon
l_string|&quot;&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;region0 at 00000000 (%dMB)&bslash;t[dram, %s, delay %d cpuclk&quot;
l_string|&quot;, cached]&bslash;n&quot;
comma
(paren
id|vac_inw
c_func
(paren
id|VAC_DRAM_MASK
)paren
op_plus
l_int|1
)paren
op_rshift
l_int|4
comma
(paren
id|decode
op_amp
id|VAC_DECODE_DSACK
)paren
ques
c_cond
l_string|&quot;D32&quot;
suffix:colon
l_string|&quot;3state&quot;
comma
id|VAC_DECODE_CPUCLK_VAL
c_func
(paren
id|decode
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
r_sizeof
(paren
id|regs
)paren
op_div
r_sizeof
(paren
id|regs
(braket
l_int|0
)braket
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
r_int
r_int
id|from
op_assign
(paren
(paren
r_int
r_int
)paren
id|vac_inw
c_func
(paren
id|bndr
(braket
id|i
)braket
)paren
)paren
op_lshift
l_int|16
suffix:semicolon
r_int
r_int
id|to
op_assign
(paren
(paren
r_int
r_int
)paren
(paren
(paren
id|i
op_plus
l_int|1
op_eq
r_sizeof
(paren
id|bndr
)paren
op_div
r_sizeof
(paren
id|bndr
(braket
l_int|0
)braket
)paren
)paren
ques
c_cond
l_int|0xff00
suffix:colon
id|vac_inw
c_func
(paren
id|bndr
(braket
id|i
op_plus
l_int|1
)braket
)paren
)paren
)paren
op_lshift
l_int|16
suffix:semicolon
id|val
op_assign
id|vac_inw
c_func
(paren
id|regs
(braket
id|i
)braket
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;region%d at %08lx (%dMB)&bslash;t[%s %s/%s, %s]&bslash;n&quot;
comma
id|i
op_plus
l_int|1
comma
id|from
comma
(paren
r_int
r_int
)paren
(paren
(paren
id|to
op_minus
id|from
)paren
op_rshift
l_int|20
)paren
comma
id|region_mode
(braket
id|VAC_REG_MODE
c_func
(paren
id|val
)paren
)braket
comma
id|asiz
(braket
id|VAC_REG_ASIZ_VAL
c_func
(paren
id|val
)paren
)braket
comma
(paren
(paren
id|val
op_amp
id|VAC_REG_WORD
)paren
ques
c_cond
l_string|&quot;D16&quot;
suffix:colon
l_string|&quot;D32&quot;
)paren
comma
id|CACHEABLE_STR
c_func
(paren
id|val
op_amp
id|VAC_A24_A24_CACHINH
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|a24_addr
op_ge
id|from
op_logical_and
id|a24_addr
OL
id|to
)paren
id|printk
c_func
(paren
l_string|&quot;&bslash;ta24 at %08lx (%dMB)&bslash;t[vme, A24/%s, %s]&bslash;n&quot;
comma
id|a24_addr
comma
id|MIN
c_func
(paren
(paren
r_int
r_int
)paren
(paren
id|a24_addr
op_minus
id|from
)paren
op_rshift
l_int|20
comma
l_int|32
)paren
comma
(paren
id|a24_base
op_amp
id|VAC_A24_DATAPATH
)paren
ques
c_cond
l_string|&quot;user&quot;
suffix:colon
(paren
(paren
id|a24_base
op_amp
id|VAC_A24_D32_ENABLE
)paren
ques
c_cond
l_string|&quot;D32&quot;
suffix:colon
l_string|&quot;D16&quot;
)paren
comma
id|CACHEABLE_STR
c_func
(paren
id|a24_base
op_amp
id|VAC_A24_A24_CACHINH
)paren
)paren
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;region4 at ff000000 (15MB)&bslash;t[eprom]&bslash;n&quot;
)paren
suffix:semicolon
id|val
op_assign
id|vac_inw
c_func
(paren
id|VAC_EPROMCS_CTRL
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;t[ack %d cpuclk%s, %s%srecovery %d cpuclk, &quot;
l_string|&quot;read %d%s, write %d%s, assert %d%s]&bslash;n&quot;
comma
id|VAC_CTRL_DELAY_DSACKI_VAL
c_func
(paren
id|val
)paren
comma
id|state
(braket
id|val
op_amp
(paren
id|VAC_CTRL_IORD
op_or
id|VAC_CTRL_IOWR
)paren
)braket
comma
(paren
id|val
op_amp
id|VAC_CTRL_DSACK0
)paren
ques
c_cond
l_string|&quot;dsack0*, &quot;
suffix:colon
l_string|&quot;&quot;
comma
(paren
id|val
op_amp
id|VAC_CTRL_DSACK1
)paren
ques
c_cond
l_string|&quot;dsack1*, &quot;
suffix:colon
l_string|&quot;&quot;
comma
id|VAC_CTRL_RECOVERY_IOSELI_VAL
c_func
(paren
id|val
)paren
comma
id|VAC_CTRL_DELAY_IORD_VAL
c_func
(paren
id|val
)paren
op_div
l_int|2
comma
(paren
id|VAC_CTRL_DELAY_IORD_VAL
c_func
(paren
id|val
)paren
op_amp
l_int|1
)paren
ques
c_cond
l_string|&quot;.5&quot;
suffix:colon
l_string|&quot;&quot;
comma
id|VAC_CTRL_DELAY_IOWR_VAL
c_func
(paren
id|val
)paren
op_div
l_int|2
comma
(paren
id|VAC_CTRL_DELAY_IOWR_VAL
c_func
(paren
id|val
)paren
op_amp
l_int|1
)paren
ques
c_cond
l_string|&quot;.5&quot;
suffix:colon
l_string|&quot;&quot;
comma
id|VAC_CTRL_DELAY_IOSELI_VAL
c_func
(paren
id|val
)paren
op_div
l_int|2
comma
(paren
id|VAC_CTRL_DELAY_IOSELI_VAL
c_func
(paren
id|val
)paren
op_amp
l_int|1
)paren
ques
c_cond
l_string|&quot;.5&quot;
suffix:colon
l_string|&quot;&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;region5 at fff00000 (896KB)&bslash;t[local io, %s]&bslash;n&quot;
comma
id|CACHEABLE_STR
c_func
(paren
id|vac_inw
c_func
(paren
id|VAC_A24_BASE
)paren
op_amp
id|VAC_A24_IO_CACHINH
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
r_sizeof
(paren
id|io_sels
)paren
op_div
r_sizeof
(paren
id|io_sels
(braket
l_int|0
)braket
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
id|val
op_assign
id|vac_inw
c_func
(paren
id|io_sels
(braket
id|i
)braket
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;tio%d[ack %d cpuclk%s, %s%srecovery %d cpuclk, &quot;
l_string|&quot;&bslash;n&bslash;t read %d%s cpuclk, write %d%s cpuclk, &quot;
l_string|&quot;assert %d%s%s cpuclk]&bslash;n&quot;
comma
id|i
comma
id|VAC_CTRL_DELAY_DSACKI_VAL
c_func
(paren
id|val
)paren
comma
id|state
(braket
id|val
op_amp
(paren
id|VAC_CTRL_IORD
op_or
id|VAC_CTRL_IOWR
)paren
)braket
comma
(paren
id|val
op_amp
id|VAC_CTRL_DSACK0
)paren
ques
c_cond
l_string|&quot;dsack0*, &quot;
suffix:colon
l_string|&quot;&quot;
comma
(paren
id|val
op_amp
id|VAC_CTRL_DSACK1
)paren
ques
c_cond
l_string|&quot;dsack1*, &quot;
suffix:colon
l_string|&quot;&quot;
comma
id|VAC_CTRL_RECOVERY_IOSELI_VAL
c_func
(paren
id|val
)paren
comma
id|VAC_CTRL_DELAY_IORD_VAL
c_func
(paren
id|val
)paren
op_div
l_int|2
comma
(paren
id|VAC_CTRL_DELAY_IORD_VAL
c_func
(paren
id|val
)paren
op_amp
l_int|1
)paren
ques
c_cond
l_string|&quot;.5&quot;
suffix:colon
l_string|&quot;&quot;
comma
id|VAC_CTRL_DELAY_IOWR_VAL
c_func
(paren
id|val
)paren
op_div
l_int|2
comma
(paren
id|VAC_CTRL_DELAY_IOWR_VAL
c_func
(paren
id|val
)paren
op_amp
l_int|1
)paren
ques
c_cond
l_string|&quot;.5&quot;
suffix:colon
l_string|&quot;&quot;
comma
id|VAC_CTRL_DELAY_IOSELI_VAL
c_func
(paren
id|val
)paren
op_div
l_int|2
comma
(paren
id|VAC_CTRL_DELAY_IOSELI_VAL
c_func
(paren
id|val
)paren
op_amp
l_int|1
)paren
ques
c_cond
l_string|&quot;.5&quot;
suffix:colon
l_string|&quot;&quot;
comma
(paren
id|vac_inw
c_func
(paren
id|VAC_DEV_LOC
)paren
op_amp
id|VAC_DEV_LOC_IOSEL
c_func
(paren
id|i
)paren
)paren
ques
c_cond
l_string|&quot;, id&quot;
suffix:colon
l_string|&quot;&quot;
)paren
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;region6 at fffe0000 (128KB)&bslash;t[vme, A16/%s, &quot;
l_string|&quot;not cached]&bslash;n&quot;
comma
(paren
id|a24_base
op_amp
id|VAC_A24_A16D32_ENABLE
)paren
ques
c_cond
(paren
(paren
id|a24_base
op_amp
id|VAC_A24_A16D32
)paren
ques
c_cond
l_string|&quot;D32&quot;
suffix:colon
l_string|&quot;D16&quot;
)paren
suffix:colon
l_string|&quot;user&quot;
)paren
suffix:semicolon
id|val
op_assign
id|vac_inw
c_func
(paren
id|VAC_SHRCS_CTRL
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;shared[ack %d cpuclk%s, %s%srecovery %d cpuclk, &quot;
l_string|&quot;read %d%s, write %d%s, assert %d%s]&bslash;n&quot;
comma
id|VAC_CTRL_DELAY_DSACKI_VAL
c_func
(paren
id|val
)paren
comma
id|state
(braket
id|val
op_amp
(paren
id|VAC_CTRL_IORD
op_or
id|VAC_CTRL_IOWR
)paren
)braket
comma
(paren
id|val
op_amp
id|VAC_CTRL_DSACK0
)paren
ques
c_cond
l_string|&quot;dsack0*, &quot;
suffix:colon
l_string|&quot;&quot;
comma
(paren
id|val
op_amp
id|VAC_CTRL_DSACK1
)paren
ques
c_cond
l_string|&quot;dsack1*, &quot;
suffix:colon
l_string|&quot;&quot;
comma
id|VAC_CTRL_RECOVERY_IOSELI_VAL
c_func
(paren
id|val
)paren
comma
id|VAC_CTRL_DELAY_IORD_VAL
c_func
(paren
id|val
)paren
op_div
l_int|2
comma
(paren
id|VAC_CTRL_DELAY_IORD_VAL
c_func
(paren
id|val
)paren
op_amp
l_int|1
)paren
ques
c_cond
l_string|&quot;.5&quot;
suffix:colon
l_string|&quot;&quot;
comma
id|VAC_CTRL_DELAY_IOWR_VAL
c_func
(paren
id|val
)paren
op_div
l_int|2
comma
(paren
id|VAC_CTRL_DELAY_IOWR_VAL
c_func
(paren
id|val
)paren
op_amp
l_int|1
)paren
ques
c_cond
l_string|&quot;.5&quot;
suffix:colon
l_string|&quot;&quot;
comma
id|VAC_CTRL_DELAY_IOSELI_VAL
c_func
(paren
id|val
)paren
op_div
l_int|2
comma
(paren
id|VAC_CTRL_DELAY_IOSELI_VAL
c_func
(paren
id|val
)paren
op_amp
l_int|1
)paren
ques
c_cond
l_string|&quot;.5&quot;
suffix:colon
l_string|&quot;&quot;
)paren
suffix:semicolon
)brace
DECL|function|vac_init
r_static
r_void
id|__init
id|vac_init
c_func
(paren
r_void
)paren
(brace
r_int
r_int
id|mem_limit
op_assign
(paren
(paren
id|mips_memory_upper
op_minus
id|KSEG0
)paren
op_rshift
l_int|16
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|vac_inw
c_func
(paren
id|VAC_ID
)paren
)paren
(brace
r_case
l_int|0x1AC0
suffix:colon
id|printk
c_func
(paren
l_string|&quot;VAC068-F5: &quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x1AC1
suffix:colon
id|printk
c_func
(paren
l_string|&quot;VAC068A: &quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|panic
c_func
(paren
l_string|&quot;Unknown VAC revision number&quot;
)paren
suffix:semicolon
)brace
id|vac_outw
c_func
(paren
id|mem_limit
op_minus
l_int|1
comma
id|VAC_DRAM_MASK
)paren
suffix:semicolon
id|vac_outw
c_func
(paren
id|mem_limit
comma
id|VAC_BNDR2
)paren
suffix:semicolon
id|vac_outw
c_func
(paren
id|mem_limit
comma
id|VAC_BNDR3
)paren
suffix:semicolon
id|vac_outw
c_func
(paren
(paren
(paren
id|BAGET_A24M_BASE
op_rshift
l_int|16
)paren
op_amp
op_complement
id|VAC_A24_D32_ENABLE
)paren
op_or
id|VAC_A24_DATAPATH
comma
id|VAC_A24_BASE
)paren
suffix:semicolon
id|vac_outw
c_func
(paren
id|VAC_REG_INACTIVE
op_or
id|VAC_REG_ASIZ0
comma
id|VAC_REG1
)paren
suffix:semicolon
id|vac_outw
c_func
(paren
id|VAC_REG_INACTIVE
op_or
id|VAC_REG_ASIZ0
comma
id|VAC_REG2
)paren
suffix:semicolon
id|vac_outw
c_func
(paren
id|VAC_REG_MWB
op_or
id|VAC_REG_ASIZ1
comma
id|VAC_REG3
)paren
suffix:semicolon
id|vac_outw
c_func
(paren
id|BAGET_A24S_BASE
op_rshift
l_int|16
comma
id|VAC_SLSEL0_BASE
)paren
suffix:semicolon
id|vac_outw
c_func
(paren
id|BAGET_A24S_MASK
op_rshift
l_int|16
comma
id|VAC_SLSEL0_MASK
)paren
suffix:semicolon
id|vac_outw
c_func
(paren
id|BAGET_A24S_BASE
op_rshift
l_int|16
comma
id|VAC_SLSEL1_BASE
)paren
suffix:semicolon
id|vac_outw
c_func
(paren
id|BAGET_A24S_MASK
op_rshift
l_int|16
comma
id|VAC_SLSEL1_MASK
)paren
suffix:semicolon
id|vac_outw
c_func
(paren
id|BAGET_GSW_BASE
op_or
id|BAGET_MSW_BASE
c_func
(paren
l_int|0
)paren
comma
id|VAC_ICFSEL_BASE
)paren
suffix:semicolon
id|vac_outw
c_func
(paren
id|VAC_DECODE_FPUCS
op_or
id|VAC_DECODE_CPUCLK
c_func
(paren
l_int|3
)paren
op_or
id|VAC_DECODE_RDR_SLSEL0
op_or
id|VAC_DECODE_RDR_SLSEL1
op_or
id|VAC_DECODE_DSACK
op_or
id|VAC_DECODE_QFY_BNDR
op_or
id|VAC_DECODE_QFY_ICFSEL
op_or
id|VAC_DECODE_QFY_SLSEL1
op_or
id|VAC_DECODE_QFY_SLSEL0
op_or
id|VAC_DECODE_CMP_SLSEL1_HI
op_or
id|VAC_DECODE_DRAMCS
op_or
id|VAC_DECODE_QFY_DRAMCS
op_or
id|VAC_DECODE_DSACKI
comma
id|VAC_DECODE_CTRL
)paren
suffix:semicolon
id|vac_outw
c_func
(paren
id|VAC_PIO_FUNC_UART_A_TX
op_or
id|VAC_PIO_FUNC_UART_A_RX
op_or
id|VAC_PIO_FUNC_UART_B_TX
op_or
id|VAC_PIO_FUNC_UART_B_RX
op_or
id|VAC_PIO_FUNC_IOWR
op_or
id|VAC_PIO_FUNC_IOSEL3
op_or
id|VAC_PIO_FUNC_IRQ7
op_or
id|VAC_PIO_FUNC_IRQ10
op_or
id|VAC_PIO_FUNC_IRQ11
op_or
id|VAC_PIO_FUNC_IOSEL2
op_or
id|VAC_PIO_FUNC_FCIACK
comma
id|VAC_PIO_FUNC
)paren
suffix:semicolon
id|vac_outw
c_func
(paren
id|VAC_PIO_DIR_FCIACK
op_or
id|VAC_PIO_DIR_OUT
c_func
(paren
l_int|0
)paren
op_or
id|VAC_PIO_DIR_OUT
c_func
(paren
l_int|1
)paren
op_or
id|VAC_PIO_DIR_OUT
c_func
(paren
l_int|2
)paren
op_or
id|VAC_PIO_DIR_OUT
c_func
(paren
l_int|3
)paren
op_or
id|VAC_PIO_DIR_IN
c_func
(paren
l_int|4
)paren
op_or
id|VAC_PIO_DIR_OUT
c_func
(paren
l_int|5
)paren
op_or
id|VAC_PIO_DIR_OUT
c_func
(paren
l_int|6
)paren
op_or
id|VAC_PIO_DIR_OUT
c_func
(paren
l_int|7
)paren
op_or
id|VAC_PIO_DIR_OUT
c_func
(paren
l_int|8
)paren
op_or
id|VAC_PIO_DIR_IN
c_func
(paren
l_int|9
)paren
op_or
id|VAC_PIO_DIR_OUT
c_func
(paren
l_int|10
)paren
op_or
id|VAC_PIO_DIR_OUT
c_func
(paren
l_int|11
)paren
op_or
id|VAC_PIO_DIR_OUT
c_func
(paren
l_int|12
)paren
op_or
id|VAC_PIO_DIR_OUT
c_func
(paren
l_int|13
)paren
comma
id|VAC_PIO_DIRECTION
)paren
suffix:semicolon
id|vac_outw
c_func
(paren
id|VAC_DEV_LOC_IOSEL
c_func
(paren
l_int|2
)paren
comma
id|VAC_DEV_LOC
)paren
suffix:semicolon
id|vac_outw
c_func
(paren
id|VAC_CTRL_IOWR
op_or
id|VAC_CTRL_DELAY_IOWR
c_func
(paren
l_int|3
)paren
op_or
id|VAC_CTRL_DELAY_IORD
c_func
(paren
l_int|3
)paren
op_or
id|VAC_CTRL_RECOVERY_IOSELI
c_func
(paren
l_int|1
)paren
op_or
id|VAC_CTRL_DELAY_DSACKI
c_func
(paren
l_int|8
)paren
comma
id|VAC_SHRCS_CTRL
)paren
suffix:semicolon
id|vac_outw
c_func
(paren
id|VAC_CTRL_IOWR
op_or
id|VAC_CTRL_DELAY_IOWR
c_func
(paren
l_int|3
)paren
op_or
id|VAC_CTRL_DELAY_IORD
c_func
(paren
l_int|3
)paren
op_or
id|VAC_CTRL_RECOVERY_IOSELI
c_func
(paren
l_int|1
)paren
op_or
id|VAC_CTRL_DSACK0
op_or
id|VAC_CTRL_DSACK1
op_or
id|VAC_CTRL_DELAY_DSACKI
c_func
(paren
l_int|8
)paren
comma
id|VAC_EPROMCS_CTRL
)paren
suffix:semicolon
id|vac_outw
c_func
(paren
id|VAC_CTRL_IOWR
op_or
id|VAC_CTRL_DELAY_IOWR
c_func
(paren
l_int|3
)paren
op_or
id|VAC_CTRL_DELAY_IORD
c_func
(paren
l_int|3
)paren
op_or
id|VAC_CTRL_RECOVERY_IOSELI
c_func
(paren
l_int|2
)paren
op_or
id|VAC_CTRL_DSACK0
op_or
id|VAC_CTRL_DSACK1
op_or
id|VAC_CTRL_DELAY_DSACKI
c_func
(paren
l_int|8
)paren
comma
id|VAC_IOSEL0_CTRL
)paren
suffix:semicolon
id|vac_outw
c_func
(paren
id|VAC_CTRL_IOWR
op_or
id|VAC_CTRL_DELAY_IOWR
c_func
(paren
l_int|3
)paren
op_or
id|VAC_CTRL_DELAY_IORD
c_func
(paren
l_int|3
)paren
op_or
id|VAC_CTRL_RECOVERY_IOSELI
c_func
(paren
l_int|2
)paren
op_or
id|VAC_CTRL_DSACK0
op_or
id|VAC_CTRL_DSACK1
op_or
id|VAC_CTRL_DELAY_DSACKI
c_func
(paren
l_int|8
)paren
comma
id|VAC_IOSEL1_CTRL
)paren
suffix:semicolon
id|vac_outw
c_func
(paren
id|VAC_CTRL_IOWR
op_or
id|VAC_CTRL_DELAY_IOWR
c_func
(paren
l_int|3
)paren
op_or
id|VAC_CTRL_DELAY_IORD
c_func
(paren
l_int|3
)paren
op_or
id|VAC_CTRL_RECOVERY_IOSELI
c_func
(paren
l_int|2
)paren
op_or
id|VAC_CTRL_DSACK0
op_or
id|VAC_CTRL_DSACK1
op_or
id|VAC_CTRL_DELAY_DSACKI
c_func
(paren
l_int|8
)paren
comma
id|VAC_IOSEL2_CTRL
)paren
suffix:semicolon
id|vac_outw
c_func
(paren
id|VAC_CTRL_IOWR
op_or
id|VAC_CTRL_DELAY_IOWR
c_func
(paren
l_int|3
)paren
op_or
id|VAC_CTRL_DELAY_IORD
c_func
(paren
l_int|3
)paren
op_or
id|VAC_CTRL_RECOVERY_IOSELI
c_func
(paren
l_int|2
)paren
op_or
id|VAC_CTRL_DSACK0
op_or
id|VAC_CTRL_DSACK1
op_or
id|VAC_CTRL_DELAY_DSACKI
c_func
(paren
l_int|8
)paren
comma
id|VAC_IOSEL3_CTRL
)paren
suffix:semicolon
id|vac_outw
c_func
(paren
id|VAC_CTRL_IOWR
op_or
id|VAC_CTRL_DELAY_IOWR
c_func
(paren
l_int|3
)paren
op_or
id|VAC_CTRL_DELAY_IORD
c_func
(paren
l_int|3
)paren
op_or
id|VAC_CTRL_RECOVERY_IOSELI
c_func
(paren
l_int|2
)paren
op_or
id|VAC_CTRL_DELAY_DSACKI
c_func
(paren
l_int|8
)paren
comma
id|VAC_IOSEL4_CTRL
)paren
suffix:semicolon
id|vac_outw
c_func
(paren
id|VAC_CTRL_IOWR
op_or
id|VAC_CTRL_DELAY_IOWR
c_func
(paren
l_int|3
)paren
op_or
id|VAC_CTRL_DELAY_IORD
c_func
(paren
l_int|3
)paren
op_or
id|VAC_CTRL_RECOVERY_IOSELI
c_func
(paren
l_int|2
)paren
op_or
id|VAC_CTRL_DELAY_DSACKI
c_func
(paren
l_int|8
)paren
comma
id|VAC_IOSEL5_CTRL
)paren
suffix:semicolon
id|vac_show
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|function|vac_start
r_static
r_void
id|__init
id|vac_start
c_func
(paren
r_void
)paren
(brace
id|vac_outw
c_func
(paren
l_int|0
comma
id|VAC_ID
)paren
suffix:semicolon
id|vac_outw
c_func
(paren
id|VAC_INT_CTRL_TIMER_DISABLE
op_or
id|VAC_INT_CTRL_UART_B_DISABLE
op_or
id|VAC_INT_CTRL_UART_A_DISABLE
op_or
id|VAC_INT_CTRL_MBOX_DISABLE
op_or
id|VAC_INT_CTRL_PIO4_DISABLE
op_or
id|VAC_INT_CTRL_PIO7_DISABLE
op_or
id|VAC_INT_CTRL_PIO8_DISABLE
op_or
id|VAC_INT_CTRL_PIO9_DISABLE
comma
id|VAC_INT_CTRL
)paren
suffix:semicolon
id|vac_outw
c_func
(paren
id|VAC_INT_CTRL_TIMER_PIO10
op_or
id|VAC_INT_CTRL_UART_B_PIO7
op_or
id|VAC_INT_CTRL_UART_A_PIO7
comma
id|VAC_INT_CTRL
)paren
suffix:semicolon
multiline_comment|/* &n;&t; *  Set quadro speed for both UARTs.&n;&t; *  To do it we need use formulae from VIC/VAC manual,&n;&t; *  keeping in mind Baget&squot;s 50MHz frequency...&n;&t; */
id|vac_outw
c_func
(paren
(paren
l_int|500000
op_div
(paren
l_int|384
op_star
l_int|16
)paren
)paren
op_lshift
l_int|8
comma
id|VAC_CPU_CLK_DIV
)paren
suffix:semicolon
)brace
DECL|function|vic_show
r_static
r_void
id|__init
id|vic_show
c_func
(paren
r_void
)paren
(brace
r_int
r_char
id|val
suffix:semicolon
r_char
op_star
id|timeout
(braket
)braket
op_assign
(brace
l_string|&quot;4&quot;
comma
l_string|&quot;16&quot;
comma
l_string|&quot;32&quot;
comma
l_string|&quot;64&quot;
comma
l_string|&quot;128&quot;
comma
l_string|&quot;256&quot;
comma
l_string|&quot;disabled&quot;
)brace
suffix:semicolon
r_char
op_star
id|deadlock
(braket
)braket
op_assign
(brace
l_string|&quot;[dedlk only]&quot;
comma
l_string|&quot;[dedlk only]&quot;
comma
l_string|&quot;[dedlk], [halt w/ rmc], [lberr]&quot;
comma
l_string|&quot;[dedlk], [halt w/o rmc], [lberr]&quot;
)brace
suffix:semicolon
id|val
op_assign
id|vic_inb
c_func
(paren
id|VIC_IFACE_CFG
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
op_amp
id|VIC_IFACE_CFG_VME
)paren
id|printk
c_func
(paren
l_string|&quot;VMEbus controller &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
op_amp
id|VIC_IFACE_CFG_TURBO
)paren
id|printk
c_func
(paren
l_string|&quot;turbo &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
op_amp
id|VIC_IFACE_CFG_MSTAB
)paren
id|printk
c_func
(paren
l_string|&quot;metastability delay &quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s &quot;
comma
id|deadlock
(braket
id|VIC_IFACE_CFG_DEADLOCK_VAL
c_func
(paren
id|val
)paren
)braket
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;interrupts: &quot;
)paren
suffix:semicolon
id|val
op_assign
id|vic_inb
c_func
(paren
id|VIC_ERR_INT
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|val
op_amp
id|VIC_ERR_INT_SYSFAIL
)paren
)paren
id|printk
c_func
(paren
l_string|&quot;[sysfail]&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|val
op_amp
id|VIC_ERR_INT_TIMO
)paren
)paren
id|printk
c_func
(paren
l_string|&quot;[timeout]&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|val
op_amp
id|VIC_ERR_INT_WRPOST
)paren
)paren
id|printk
c_func
(paren
l_string|&quot;[write post]&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|val
op_amp
id|VIC_ERR_INT_ACFAIL
)paren
)paren
id|printk
c_func
(paren
l_string|&quot;[acfail] &quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;timeouts: &quot;
)paren
suffix:semicolon
id|val
op_assign
id|vic_inb
c_func
(paren
id|VIC_XFER_TIMO
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;local %s, vme %s &quot;
comma
id|timeout
(braket
id|VIC_XFER_TIMO_LOCAL_PERIOD_VAL
c_func
(paren
id|val
)paren
)braket
comma
id|timeout
(braket
id|VIC_XFER_TIMO_VME_PERIOD_VAL
c_func
(paren
id|val
)paren
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
op_amp
id|VIC_XFER_TIMO_VME
)paren
id|printk
c_func
(paren
l_string|&quot;acquisition &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
op_amp
id|VIC_XFER_TIMO_ARB
)paren
id|printk
c_func
(paren
l_string|&quot;arbitration &quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|val
op_assign
id|vic_inb
c_func
(paren
id|VIC_LOCAL_TIM
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;pas time: (%d,%d), ds time: %d&bslash;n&quot;
comma
id|VIC_LOCAL_TIM_PAS_ASSERT_VAL
c_func
(paren
id|val
)paren
comma
id|VIC_LOCAL_TIM_PAS_DEASSERT_VAL
c_func
(paren
id|val
)paren
comma
id|VIC_LOCAT_TIM_DS_DEASSERT_VAL
c_func
(paren
id|val
)paren
)paren
suffix:semicolon
id|val
op_assign
id|vic_inb
c_func
(paren
id|VIC_BXFER_DEF
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;dma: &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
op_amp
id|VIC_BXFER_DEF_DUAL
)paren
id|printk
c_func
(paren
l_string|&quot;[dual path]&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
op_amp
id|VIC_BXFER_DEF_LOCAL_CROSS
)paren
id|printk
c_func
(paren
l_string|&quot;[local boundary cross]&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
op_amp
id|VIC_BXFER_DEF_VME_CROSS
)paren
id|printk
c_func
(paren
l_string|&quot;[vme boundary cross]&quot;
)paren
suffix:semicolon
)brace
DECL|function|vic_init
r_static
r_void
id|__init
id|vic_init
c_func
(paren
r_void
)paren
(brace
r_int
r_char
id|id
op_assign
id|vic_inb
c_func
(paren
id|VIC_ID
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|id
op_amp
l_int|0xf0
)paren
op_ne
l_int|0xf0
)paren
id|panic
c_func
(paren
l_string|&quot;VIC not found&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; VIC068A Rev. %X: &quot;
comma
id|id
op_amp
l_int|0x0f
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
id|VIC_INT_IPL
c_func
(paren
l_int|3
)paren
op_or
id|VIC_INT_DISABLE
comma
id|VIC_VME_II
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
id|VIC_INT_IPL
c_func
(paren
l_int|3
)paren
op_or
id|VIC_INT_DISABLE
comma
id|VIC_VME_INT1
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
id|VIC_INT_IPL
c_func
(paren
l_int|3
)paren
op_or
id|VIC_INT_DISABLE
comma
id|VIC_VME_INT2
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
id|VIC_INT_IPL
c_func
(paren
l_int|3
)paren
op_or
id|VIC_INT_DISABLE
comma
id|VIC_VME_INT3
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
id|VIC_INT_IPL
c_func
(paren
l_int|3
)paren
op_or
id|VIC_INT_DISABLE
comma
id|VIC_VME_INT4
)paren
suffix:semicolon
multiline_comment|/*&t; &n;&t; vic_outb(VIC_INT_IPL(3)|VIC_INT_DISABLE, VIC_VME_INT5);&n;*/
id|vic_outb
c_func
(paren
id|VIC_INT_IPL
c_func
(paren
l_int|3
)paren
op_or
id|VIC_INT_DISABLE
comma
id|VIC_VME_INT6
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
id|VIC_INT_IPL
c_func
(paren
l_int|3
)paren
op_or
id|VIC_INT_DISABLE
comma
id|VIC_VME_INT7
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
id|VIC_INT_IPL
c_func
(paren
l_int|3
)paren
op_or
id|VIC_INT_DISABLE
comma
id|VIC_DMA_INT
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
id|VIC_INT_IPL
c_func
(paren
l_int|3
)paren
op_or
id|VIC_INT_NOAUTO
op_or
id|VIC_INT_EDGE
op_or
id|VIC_INT_LOW
op_or
id|VIC_INT_DISABLE
comma
id|VIC_LINT1
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
id|VIC_INT_IPL
c_func
(paren
l_int|3
)paren
op_or
id|VIC_INT_NOAUTO
op_or
id|VIC_INT_EDGE
op_or
id|VIC_INT_HIGH
op_or
id|VIC_INT_DISABLE
comma
id|VIC_LINT2
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
id|VIC_INT_IPL
c_func
(paren
l_int|3
)paren
op_or
id|VIC_INT_NOAUTO
op_or
id|VIC_INT_EDGE
op_or
id|VIC_INT_HIGH
op_or
id|VIC_INT_DISABLE
comma
id|VIC_LINT3
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
id|VIC_INT_IPL
c_func
(paren
l_int|3
)paren
op_or
id|VIC_INT_NOAUTO
op_or
id|VIC_INT_EDGE
op_or
id|VIC_INT_LOW
op_or
id|VIC_INT_DISABLE
comma
id|VIC_LINT4
)paren
suffix:semicolon
multiline_comment|/*&t; &n;&t; vic_outb(VIC_INT_IPL(3)|VIC_INT_NOAUTO|VIC_INT_LEVEL|&n;&t;&t;  VIC_INT_LOW|VIC_INT_DISABLE, VIC_LINT5);&n;*/
id|vic_outb
c_func
(paren
id|VIC_INT_IPL
c_func
(paren
l_int|6
)paren
op_or
id|VIC_INT_NOAUTO
op_or
id|VIC_INT_EDGE
op_or
id|VIC_INT_LOW
op_or
id|VIC_INT_DISABLE
comma
id|VIC_LINT6
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
id|VIC_INT_IPL
c_func
(paren
l_int|6
)paren
op_or
id|VIC_INT_NOAUTO
op_or
id|VIC_INT_EDGE
op_or
id|VIC_INT_LOW
op_or
id|VIC_INT_DISABLE
comma
id|VIC_LINT7
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
id|VIC_INT_IPL
c_func
(paren
l_int|3
)paren
op_or
id|VIC_INT_SWITCH
c_func
(paren
l_int|0
)paren
op_or
id|VIC_INT_SWITCH
c_func
(paren
l_int|1
)paren
op_or
id|VIC_INT_SWITCH
c_func
(paren
l_int|2
)paren
op_or
id|VIC_INT_SWITCH
c_func
(paren
l_int|3
)paren
comma
id|VIC_ICGS_INT
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
id|VIC_INT_IPL
c_func
(paren
l_int|3
)paren
op_or
id|VIC_INT_SWITCH
c_func
(paren
l_int|0
)paren
op_or
id|VIC_INT_SWITCH
c_func
(paren
l_int|1
)paren
op_or
id|VIC_INT_SWITCH
c_func
(paren
l_int|2
)paren
op_or
id|VIC_INT_SWITCH
c_func
(paren
l_int|3
)paren
comma
id|VIC_ICMS_INT
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
id|VIC_INT_IPL
c_func
(paren
l_int|6
)paren
op_or
id|VIC_ERR_INT_SYSFAIL
op_or
id|VIC_ERR_INT_TIMO
op_or
id|VIC_ERR_INT_WRPOST
op_or
id|VIC_ERR_INT_ACFAIL
comma
id|VIC_ERR_INT
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
id|VIC_ICxS_BASE_ID
c_func
(paren
l_int|0xf
)paren
comma
id|VIC_ICGS_BASE
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
id|VIC_ICxS_BASE_ID
c_func
(paren
l_int|0xe
)paren
comma
id|VIC_ICMS_BASE
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
id|VIC_LOCAL_BASE_ID
c_func
(paren
l_int|0x6
)paren
comma
id|VIC_LOCAL_BASE
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
id|VIC_ERR_BASE_ID
c_func
(paren
l_int|0x3
)paren
comma
id|VIC_ERR_BASE
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
id|VIC_XFER_TIMO_VME_PERIOD_32
op_or
id|VIC_XFER_TIMO_LOCAL_PERIOD_32
comma
id|VIC_XFER_TIMO
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
id|VIC_LOCAL_TIM_PAS_ASSERT
c_func
(paren
l_int|2
)paren
op_or
id|VIC_LOCAT_TIM_DS_DEASSERT
c_func
(paren
l_int|1
)paren
op_or
id|VIC_LOCAL_TIM_PAS_DEASSERT
c_func
(paren
l_int|1
)paren
comma
id|VIC_LOCAL_TIM
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
id|VIC_BXFER_DEF_VME_CROSS
op_or
id|VIC_BXFER_DEF_LOCAL_CROSS
op_or
id|VIC_BXFER_DEF_AMSR
op_or
id|VIC_BXFER_DEF_DUAL
comma
id|VIC_BXFER_DEF
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
id|VIC_SSxCR0_LOCAL_XFER_SINGLE
op_or
id|VIC_SSxCR0_A32
op_or
id|VIC_SSxCR0_D32
op_or
id|VIC_SS0CR0_TIMER_FREQ_NONE
comma
id|VIC_SS0CR0
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
id|VIC_SSxCR1_TF1
c_func
(paren
l_int|0xf
)paren
op_or
id|VIC_SSxCR1_TF2
c_func
(paren
l_int|0xf
)paren
comma
id|VIC_SS0CR1
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
id|VIC_SSxCR0_LOCAL_XFER_SINGLE
op_or
id|VIC_SSxCR0_A24
op_or
id|VIC_SSxCR0_D32
comma
id|VIC_SS1CR0
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
id|VIC_SSxCR1_TF1
c_func
(paren
l_int|0xf
)paren
op_or
id|VIC_SSxCR1_TF2
c_func
(paren
l_int|0xf
)paren
comma
id|VIC_SS1CR1
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
id|VIC_IFACE_CFG_NOHALT
op_or
id|VIC_IFACE_CFG_NOTURBO
comma
id|VIC_IFACE_CFG
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
id|VIC_AMS_CODE
c_func
(paren
l_int|0
)paren
comma
id|VIC_AMS
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
id|VIC_BXFER_CTRL_INTERLEAVE
c_func
(paren
l_int|0
)paren
comma
id|VIC_BXFER_CTRL
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
l_int|0
comma
id|VIC_BXFER_LEN_LO
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
l_int|0
comma
id|VIC_BXFER_LEN_HI
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
id|VIC_REQ_CFG_FAIRNESS_DISABLED
op_or
id|VIC_REQ_CFG_LEVEL
c_func
(paren
l_int|3
)paren
op_or
id|VIC_REQ_CFG_RR_ARBITRATION
comma
id|VIC_REQ_CFG
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
id|VIC_RELEASE_BLKXFER_BLEN
c_func
(paren
l_int|0
)paren
op_or
id|VIC_RELEASE_RWD
comma
id|VIC_RELEASE
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
id|VIC_IC6_RUN
comma
id|VIC_IC6
)paren
suffix:semicolon
id|vic_outb
c_func
(paren
l_int|0
comma
id|VIC_IC7
)paren
suffix:semicolon
id|vic_show
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|function|vic_start
r_static
r_void
id|vic_start
c_func
(paren
r_void
)paren
(brace
id|vic_outb
c_func
(paren
id|VIC_INT_IPL
c_func
(paren
l_int|3
)paren
op_or
id|VIC_INT_NOAUTO
op_or
id|VIC_INT_EDGE
op_or
id|VIC_INT_HIGH
op_or
id|VIC_INT_ENABLE
comma
id|VIC_LINT7
)paren
suffix:semicolon
)brace
DECL|function|baget_irq_setup
r_void
id|__init
id|baget_irq_setup
c_func
(paren
r_void
)paren
(brace
r_extern
r_void
id|bagetIRQ
c_func
(paren
r_void
)paren
suffix:semicolon
multiline_comment|/* Now, it&squot;s safe to set the exception vector. */
id|set_except_vector
c_func
(paren
l_int|0
comma
id|bagetIRQ
)paren
suffix:semicolon
)brace
r_extern
r_void
id|baget_machine_restart
c_func
(paren
r_char
op_star
id|command
)paren
suffix:semicolon
r_extern
r_void
id|baget_machine_halt
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_void
id|baget_machine_power_off
c_func
(paren
r_void
)paren
suffix:semicolon
DECL|function|baget_setup
r_void
id|__init
id|baget_setup
c_func
(paren
r_void
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;BT23/63-201n found.&bslash;n&quot;
)paren
suffix:semicolon
op_star
id|BAGET_WRERR_ACK
op_assign
l_int|0
suffix:semicolon
id|irq_setup
op_assign
id|baget_irq_setup
suffix:semicolon
id|_machine_restart
op_assign
id|baget_machine_restart
suffix:semicolon
id|_machine_halt
op_assign
id|baget_machine_halt
suffix:semicolon
id|_machine_power_off
op_assign
id|baget_machine_power_off
suffix:semicolon
id|vac_init
c_func
(paren
)paren
suffix:semicolon
id|vic_init
c_func
(paren
)paren
suffix:semicolon
id|vac_start
c_func
(paren
)paren
suffix:semicolon
id|vic_start
c_func
(paren
)paren
suffix:semicolon
)brace
eof
