multiline_comment|/*&n; *  linux/arch/mips/lib/tags.c&n; *&n; *  Copyright (C) 1996  Stoned Elipot&n; */
macro_line|#include &lt;linux/stddef.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;asm/addrspace.h&gt;
macro_line|#include &lt;asm/bootinfo.h&gt;
multiline_comment|/*&n; * Parse the tags present in upper memory to find out&n; * a pecular one.&n; *&n; * Parameter: type - tag type to find&n; * &n; * returns  : NULL  - failure&n; *            !NULL - pointer on the tag structure found &n; */
id|tag
op_star
DECL|function|bi_TagFind
id|bi_TagFind
c_func
(paren
r_enum
id|bi_tag
id|type
)paren
(brace
id|tag
op_star
id|t
op_assign
(paren
id|tag
op_star
)paren
(paren
id|mips_memory_upper
op_minus
r_sizeof
(paren
id|tag
)paren
)paren
suffix:semicolon
r_while
c_loop
(paren
(paren
id|t-&gt;tag
op_ne
id|tag_dummy
)paren
op_logical_and
(paren
id|t-&gt;tag
op_ne
id|type
)paren
)paren
(brace
id|t
op_assign
(paren
id|tag
op_star
)paren
(paren
id|NEXTTAGPTR
c_func
(paren
id|t
)paren
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|t-&gt;tag
op_eq
id|tag_dummy
)paren
multiline_comment|/* tag not found */
r_return
(paren
id|tag
op_star
)paren
l_int|NULL
suffix:semicolon
r_return
id|t
suffix:semicolon
)brace
multiline_comment|/*&n; * Snarf from the tag list in memory end some tags needed&n; * before the kernel reachs setup_arch()&n; *&n; * add yours here if you want to, but *beware*: the kernel var&n; * that will hold the values you want to snarf have to be&n; * in .data section of the kernel, so initialized in to whatever&n; * value in the kernel&squot;s sources.&n; */
DECL|function|bi_EarlySnarf
r_void
id|bi_EarlySnarf
c_func
(paren
r_void
)paren
(brace
id|tag
op_star
id|atag
suffix:semicolon
multiline_comment|/* for wire_mappings() */
id|atag
op_assign
id|bi_TagFind
c_func
(paren
id|tag_machgroup
)paren
suffix:semicolon
r_if
c_cond
(paren
id|atag
)paren
id|memcpy
c_func
(paren
op_amp
id|mips_machgroup
comma
id|TAGVALPTR
c_func
(paren
id|atag
)paren
comma
id|atag-&gt;size
)paren
suffix:semicolon
r_else
(brace
multiline_comment|/* useless for boxes without text video mode but....*/
id|panic
c_func
(paren
l_string|&quot;machine group not specified by bootloader&quot;
)paren
suffix:semicolon
)brace
id|atag
op_assign
id|bi_TagFind
c_func
(paren
id|tag_machtype
)paren
suffix:semicolon
r_if
c_cond
(paren
id|atag
)paren
id|memcpy
c_func
(paren
op_amp
id|mips_machtype
comma
id|TAGVALPTR
c_func
(paren
id|atag
)paren
comma
id|atag-&gt;size
)paren
suffix:semicolon
r_else
(brace
multiline_comment|/* useless for boxes without text video mode but....*/
id|panic
c_func
(paren
l_string|&quot;machine type not specified by bootloader&quot;
)paren
suffix:semicolon
)brace
multiline_comment|/* for tlbflush() */
id|atag
op_assign
id|bi_TagFind
c_func
(paren
id|tag_tlb_entries
)paren
suffix:semicolon
r_if
c_cond
(paren
id|atag
)paren
id|memcpy
c_func
(paren
op_amp
id|mips_tlb_entries
comma
id|TAGVALPTR
c_func
(paren
id|atag
)paren
comma
id|atag-&gt;size
)paren
suffix:semicolon
r_else
(brace
multiline_comment|/* useless for boxes without text video mode but....*/
id|panic
c_func
(paren
l_string|&quot;number of TLB entries not specified by bootloader&quot;
)paren
suffix:semicolon
)brace
r_return
suffix:semicolon
)brace
eof
