multiline_comment|/*&n; * misc.c: Miscellaneous ARCS PROM routines.&n; *&n; * Copyright (C) 1996 David S. Miller (dm@engr.sgi.com)&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;asm/sgialib.h&gt;
macro_line|#include &lt;asm/bootinfo.h&gt;
macro_line|#include &lt;asm/system.h&gt;
r_extern
r_int
r_int
id|mips_cputype
suffix:semicolon
r_extern
r_int
id|initialize_kbd
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_void
op_star
id|sgiwd93_host
suffix:semicolon
r_extern
r_void
id|reset_wd33c93
c_func
(paren
r_void
op_star
id|instance
)paren
suffix:semicolon
DECL|function|shutoff_r4600_cache
r_static
r_inline
r_void
id|shutoff_r4600_cache
c_func
(paren
r_void
)paren
(brace
r_int
r_int
id|tmp1
comma
id|tmp2
comma
id|tmp3
suffix:semicolon
r_if
c_cond
(paren
id|mips_cputype
op_ne
id|CPU_R4600
op_logical_and
id|mips_cputype
op_ne
id|CPU_R4640
op_logical_and
id|mips_cputype
op_ne
id|CPU_R4700
)paren
(brace
r_return
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;Disabling R4600 SCACHE&bslash;n&quot;
)paren
suffix:semicolon
id|__asm__
id|__volatile__
c_func
(paren
"&quot;"
dot
id|set
id|noreorder
dot
id|set
id|mips3
id|li
op_mod
l_int|0
comma
l_int|0x1
id|dsll
op_mod
l_int|0
comma
l_int|31
id|lui
op_mod
l_int|1
comma
l_int|0x9000
id|dsll32
op_mod
l_int|1
comma
l_int|0
op_logical_or
op_mod
l_int|0
comma
op_mod
l_int|1
comma
op_mod
l_int|0
id|mfc0
op_mod
l_int|2
comma
"$"
l_int|12
id|nop
suffix:semicolon
id|nop
suffix:semicolon
id|nop
suffix:semicolon
id|nop
suffix:semicolon
id|li
op_mod
l_int|1
comma
l_int|0x80
id|mtc0
op_mod
l_int|1
comma
"$"
l_int|12
id|nop
suffix:semicolon
id|nop
suffix:semicolon
id|nop
suffix:semicolon
id|nop
suffix:semicolon
id|sh
"$"
l_int|0
comma
l_int|0
(paren
op_mod
l_int|0
)paren
id|mtc0
"$"
l_int|0
comma
"$"
l_int|12
id|nop
suffix:semicolon
id|nop
suffix:semicolon
id|nop
suffix:semicolon
id|nop
suffix:semicolon
id|mtc0
op_mod
l_int|2
comma
"$"
l_int|12
id|nop
suffix:semicolon
id|nop
suffix:semicolon
id|nop
suffix:semicolon
id|nop
suffix:semicolon
dot
id|set
id|mips2
dot
id|set
id|reorder
l_string|&quot; : &quot;
op_assign
id|r
l_string|&quot; (tmp1), &quot;
op_assign
id|r
l_string|&quot; (tmp2), &quot;
op_assign
id|r
"&quot;"
(paren
id|tmp3
)paren
)paren
suffix:semicolon
)brace
DECL|function|prom_halt
r_void
id|prom_halt
c_func
(paren
r_void
)paren
(brace
id|shutoff_r4600_cache
c_func
(paren
)paren
suffix:semicolon
id|initialize_kbd
c_func
(paren
)paren
suffix:semicolon
macro_line|#if CONFIG_SCSI_SGIWD93
id|reset_wd33c93
c_func
(paren
id|sgiwd93_host
)paren
suffix:semicolon
macro_line|#endif
id|cli
c_func
(paren
)paren
suffix:semicolon
id|romvec
op_member_access_from_pointer
id|halt
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|function|prom_powerdown
r_void
id|prom_powerdown
c_func
(paren
r_void
)paren
(brace
id|shutoff_r4600_cache
c_func
(paren
)paren
suffix:semicolon
id|initialize_kbd
c_func
(paren
)paren
suffix:semicolon
macro_line|#if CONFIG_SCSI_SGIWD93
id|reset_wd33c93
c_func
(paren
id|sgiwd93_host
)paren
suffix:semicolon
macro_line|#endif
id|cli
c_func
(paren
)paren
suffix:semicolon
id|romvec
op_member_access_from_pointer
id|pdown
c_func
(paren
)paren
suffix:semicolon
)brace
multiline_comment|/* XXX is this a soft reset basically? XXX */
DECL|function|prom_restart
r_void
id|prom_restart
c_func
(paren
r_void
)paren
(brace
id|shutoff_r4600_cache
c_func
(paren
)paren
suffix:semicolon
id|initialize_kbd
c_func
(paren
)paren
suffix:semicolon
macro_line|#if CONFIG_SCSI_SGIWD93
id|reset_wd33c93
c_func
(paren
id|sgiwd93_host
)paren
suffix:semicolon
macro_line|#endif
id|cli
c_func
(paren
)paren
suffix:semicolon
id|romvec
op_member_access_from_pointer
id|restart
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|function|prom_reboot
r_void
id|prom_reboot
c_func
(paren
r_void
)paren
(brace
id|shutoff_r4600_cache
c_func
(paren
)paren
suffix:semicolon
id|initialize_kbd
c_func
(paren
)paren
suffix:semicolon
macro_line|#if CONFIG_SCSI_SGIWD93
id|reset_wd33c93
c_func
(paren
id|sgiwd93_host
)paren
suffix:semicolon
macro_line|#endif
id|cli
c_func
(paren
)paren
suffix:semicolon
id|romvec
op_member_access_from_pointer
id|reboot
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|function|prom_imode
r_void
id|prom_imode
c_func
(paren
r_void
)paren
(brace
id|shutoff_r4600_cache
c_func
(paren
)paren
suffix:semicolon
id|initialize_kbd
c_func
(paren
)paren
suffix:semicolon
macro_line|#if CONFIG_SCSI_SGIWD93
id|reset_wd33c93
c_func
(paren
id|sgiwd93_host
)paren
suffix:semicolon
macro_line|#endif
id|cli
c_func
(paren
)paren
suffix:semicolon
id|romvec
op_member_access_from_pointer
id|imode
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|function|prom_cfgsave
r_int
id|prom_cfgsave
c_func
(paren
r_void
)paren
(brace
r_return
id|romvec
op_member_access_from_pointer
id|cfg_save
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|function|prom_getsysid
r_struct
id|linux_sysid
op_star
id|prom_getsysid
c_func
(paren
r_void
)paren
(brace
r_return
id|romvec
op_member_access_from_pointer
id|get_sysid
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|function|prom_cacheflush
r_void
id|prom_cacheflush
c_func
(paren
r_void
)paren
(brace
id|romvec
op_member_access_from_pointer
id|cache_flush
c_func
(paren
)paren
suffix:semicolon
)brace
eof
