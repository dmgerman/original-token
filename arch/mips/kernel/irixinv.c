multiline_comment|/*&n; * Support the inventory interface for IRIX binaries&n; * This is invoked before the mm layer is working, so we do not&n; * use the linked lists for the inventory yet. &n; *&n; * Miguel de Icaza, 1997.&n; *&n; * $Id: irixinv.c,v 1.3 1998/04/05 11:23:51 ralf Exp $&n; */
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/slab.h&gt;
macro_line|#include &lt;asm/uaccess.h&gt;
macro_line|#include &lt;asm/inventory.h&gt;
DECL|macro|MAX_INVENTORY
mdefine_line|#define MAX_INVENTORY 50
DECL|variable|inventory_items
r_int
id|inventory_items
op_assign
l_int|0
suffix:semicolon
DECL|variable|inventory
r_static
id|inventory_t
id|inventory
(braket
id|MAX_INVENTORY
)braket
suffix:semicolon
r_void
DECL|function|add_to_inventory
id|add_to_inventory
(paren
r_int
r_class
comma
r_int
id|type
comma
r_int
id|controller
comma
r_int
id|unit
comma
r_int
id|state
)paren
(brace
id|inventory_t
op_star
id|ni
op_assign
op_amp
id|inventory
(braket
id|inventory_items
)braket
suffix:semicolon
r_if
c_cond
(paren
id|inventory_items
op_eq
id|MAX_INVENTORY
)paren
r_return
suffix:semicolon
id|ni-&gt;inv_class
op_assign
r_class
suffix:semicolon
id|ni-&gt;inv_type
op_assign
id|type
suffix:semicolon
id|ni-&gt;inv_controller
op_assign
id|controller
suffix:semicolon
id|ni-&gt;inv_unit
op_assign
id|unit
suffix:semicolon
id|ni-&gt;inv_state
op_assign
id|state
suffix:semicolon
id|ni-&gt;inv_next
op_assign
id|ni
suffix:semicolon
id|inventory_items
op_increment
suffix:semicolon
)brace
r_int
DECL|function|dump_inventory_to_user
id|dump_inventory_to_user
(paren
r_void
op_star
id|userbuf
comma
r_int
id|size
)paren
(brace
id|inventory_t
op_star
id|inv
op_assign
op_amp
id|inventory
(braket
l_int|0
)braket
suffix:semicolon
id|inventory_t
op_star
id|user
op_assign
id|userbuf
suffix:semicolon
r_int
id|v
suffix:semicolon
r_if
c_cond
(paren
(paren
id|v
op_assign
id|verify_area
(paren
id|VERIFY_WRITE
comma
id|userbuf
comma
id|size
)paren
)paren
)paren
r_return
id|v
suffix:semicolon
r_for
c_loop
(paren
id|v
op_assign
l_int|0
suffix:semicolon
id|v
OL
id|inventory_items
suffix:semicolon
id|v
op_increment
)paren
(brace
id|inv
op_assign
op_amp
id|inventory
(braket
id|v
)braket
suffix:semicolon
id|copy_to_user
(paren
id|user
comma
id|inv
comma
r_sizeof
(paren
id|inventory_t
)paren
)paren
suffix:semicolon
id|user
op_increment
suffix:semicolon
)brace
r_return
id|inventory_items
op_star
r_sizeof
(paren
id|inventory_t
)paren
suffix:semicolon
)brace
DECL|function|init_inventory
r_void
id|__init
id|init_inventory
(paren
r_void
)paren
(brace
multiline_comment|/* gross hack while we put the right bits all over the kernel&n;&t; * most likely this will not let just anyone run the X server&n;&t; * until we put the right values all over the place&n;&t; */
id|add_to_inventory
(paren
l_int|10
comma
l_int|3
comma
l_int|0
comma
l_int|0
comma
l_int|16400
)paren
suffix:semicolon
id|add_to_inventory
(paren
l_int|1
comma
l_int|1
comma
l_int|150
comma
op_minus
l_int|1
comma
l_int|12
)paren
suffix:semicolon
id|add_to_inventory
(paren
l_int|1
comma
l_int|3
comma
l_int|0
comma
l_int|0
comma
l_int|8976
)paren
suffix:semicolon
id|add_to_inventory
(paren
l_int|1
comma
l_int|2
comma
l_int|0
comma
l_int|0
comma
l_int|8976
)paren
suffix:semicolon
id|add_to_inventory
(paren
l_int|4
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
id|add_to_inventory
(paren
l_int|5
comma
l_int|5
comma
l_int|0
comma
l_int|0
comma
l_int|1
)paren
suffix:semicolon
id|add_to_inventory
(paren
l_int|3
comma
l_int|3
comma
l_int|0
comma
l_int|0
comma
l_int|32768
)paren
suffix:semicolon
id|add_to_inventory
(paren
l_int|3
comma
l_int|4
comma
l_int|0
comma
l_int|0
comma
l_int|32768
)paren
suffix:semicolon
id|add_to_inventory
(paren
l_int|3
comma
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|524288
)paren
suffix:semicolon
id|add_to_inventory
(paren
l_int|3
comma
l_int|9
comma
l_int|0
comma
l_int|0
comma
l_int|64
)paren
suffix:semicolon
id|add_to_inventory
(paren
l_int|3
comma
l_int|1
comma
l_int|0
comma
l_int|0
comma
l_int|67108864
)paren
suffix:semicolon
id|add_to_inventory
(paren
l_int|12
comma
l_int|3
comma
l_int|0
comma
l_int|0
comma
l_int|16
)paren
suffix:semicolon
id|add_to_inventory
(paren
l_int|8
comma
l_int|7
comma
l_int|17
comma
l_int|0
comma
l_int|16777472
)paren
suffix:semicolon
id|add_to_inventory
(paren
l_int|8
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|1
)paren
suffix:semicolon
id|add_to_inventory
(paren
l_int|2
comma
l_int|1
comma
l_int|0
comma
l_int|13
comma
l_int|2
)paren
suffix:semicolon
id|add_to_inventory
(paren
l_int|2
comma
l_int|2
comma
l_int|0
comma
l_int|2
comma
l_int|0
)paren
suffix:semicolon
id|add_to_inventory
(paren
l_int|2
comma
l_int|2
comma
l_int|0
comma
l_int|1
comma
l_int|0
)paren
suffix:semicolon
id|add_to_inventory
(paren
l_int|7
comma
l_int|14
comma
l_int|0
comma
l_int|0
comma
l_int|6
)paren
suffix:semicolon
)brace
eof
