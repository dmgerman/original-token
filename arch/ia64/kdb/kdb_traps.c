macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/kdb.h&gt;
DECL|struct|kdb_bp_support
r_static
r_struct
id|kdb_bp_support
(brace
DECL|member|addr
r_int
r_int
id|addr
suffix:semicolon
DECL|member|slot
r_int
id|slot
suffix:semicolon
DECL|variable|kdb_bp_info
)brace
id|kdb_bp_info
(braket
id|NR_CPUS
)braket
suffix:semicolon
r_extern
r_void
id|kdb_bp_install
(paren
r_void
)paren
suffix:semicolon
multiline_comment|/*&n; * This gets invoked right before a call to ia64_fault().&n; * Returns zero the normal fault handler should be invoked.&n; */
r_int
DECL|function|ia64_kdb_fault_handler
id|ia64_kdb_fault_handler
(paren
r_int
r_int
id|vector
comma
r_int
r_int
id|isr
comma
r_int
r_int
id|ifa
comma
r_int
r_int
id|iim
comma
r_int
r_int
id|itir
comma
r_int
r_int
id|arg5
comma
r_int
r_int
id|arg6
comma
r_int
r_int
id|arg7
comma
r_int
r_int
id|stack
)paren
(brace
r_struct
id|switch_stack
op_star
id|sw
op_assign
(paren
r_struct
id|switch_stack
op_star
)paren
op_amp
id|stack
suffix:semicolon
r_struct
id|pt_regs
op_star
id|regs
op_assign
(paren
r_struct
id|pt_regs
op_star
)paren
(paren
id|sw
op_plus
l_int|1
)paren
suffix:semicolon
r_int
id|bundle_slot
suffix:semicolon
multiline_comment|/*&n;&t; * TBD&n;&t; * If KDB is configured, enter KDB for any fault.&n;&t; */
r_if
c_cond
(paren
(paren
id|vector
op_eq
l_int|29
)paren
op_logical_or
(paren
id|vector
op_eq
l_int|35
)paren
op_logical_or
(paren
id|vector
op_eq
l_int|36
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|user_mode
c_func
(paren
id|regs
)paren
)paren
(brace
id|bundle_slot
op_assign
id|ia64_psr
c_func
(paren
id|regs
)paren
op_member_access_from_pointer
id|ri
suffix:semicolon
r_if
c_cond
(paren
id|vector
op_eq
l_int|29
)paren
(brace
r_if
c_cond
(paren
id|bundle_slot
op_eq
l_int|0
)paren
(brace
id|kdb_bp_info
(braket
l_int|0
)braket
dot
id|addr
op_assign
id|regs-&gt;cr_iip
suffix:semicolon
id|kdb_bp_info
(braket
l_int|0
)braket
dot
id|slot
op_assign
id|bundle_slot
suffix:semicolon
id|kdb
c_func
(paren
id|KDB_REASON_FLTDBG
comma
l_int|0
comma
id|regs
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
(paren
id|bundle_slot
OL
l_int|3
)paren
op_logical_and
(paren
id|kdb_bp_info
(braket
l_int|0
)braket
dot
id|addr
op_eq
id|regs-&gt;cr_iip
)paren
)paren
(brace
id|ia64_psr
c_func
(paren
id|regs
)paren
op_member_access_from_pointer
id|id
op_assign
l_int|1
suffix:semicolon
id|ia64_psr
c_func
(paren
id|regs
)paren
op_member_access_from_pointer
id|db
op_assign
l_int|1
suffix:semicolon
id|kdb_bp_install
c_func
(paren
)paren
suffix:semicolon
)brace
r_else
multiline_comment|/* some error ?? */
id|kdb
c_func
(paren
id|KDB_REASON_FLTDBG
comma
l_int|0
comma
id|regs
)paren
suffix:semicolon
)brace
)brace
r_else
multiline_comment|/* single step or taken branch */
id|kdb
c_func
(paren
id|KDB_REASON_DEBUG
comma
l_int|0
comma
id|regs
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
eof
