multiline_comment|/*&n; * Internal Interrupt Vectors &n; *&n; * This takes care of interrupts that are generated by the CPU&n; * internally, such as the ITC and IPI interrupts.&n; *&n; * Copyright (C) 1999 VA Linux Systems&n; * Copyright (C) 1999 Walt Drummond &lt;drummond@valinux.com&gt;&n; */
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;asm/irq.h&gt;
macro_line|#include &lt;asm/processor.h&gt;
macro_line|#include &lt;asm/ptrace.h&gt;
macro_line|#include &lt;asm/irq.h&gt;
multiline_comment|/*&n; * This is identical to IOSAPIC handle_irq.  It may go away . . .&n; */
r_static
r_int
DECL|function|internal_handle_irq
id|internal_handle_irq
(paren
r_int
r_int
id|irq
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_struct
id|irqaction
op_star
id|action
op_assign
l_int|0
suffix:semicolon
r_struct
id|irq_desc
op_star
id|id
op_assign
id|irq_desc
op_plus
id|irq
suffix:semicolon
r_int
r_int
id|status
suffix:semicolon
r_int
id|retval
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|irq_controller_lock
)paren
suffix:semicolon
(brace
id|status
op_assign
id|id-&gt;status
suffix:semicolon
r_if
c_cond
(paren
(paren
id|status
op_amp
id|IRQ_ENABLED
)paren
op_ne
l_int|0
)paren
id|action
op_assign
id|id-&gt;action
suffix:semicolon
id|id-&gt;status
op_assign
id|status
op_amp
op_complement
(paren
id|IRQ_REPLAY
op_or
id|IRQ_WAITING
)paren
suffix:semicolon
)brace
id|spin_unlock
c_func
(paren
op_amp
id|irq_controller_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|action
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|id-&gt;status
op_amp
id|IRQ_AUTODETECT
)paren
)paren
id|printk
c_func
(paren
l_string|&quot;irq_hpsim_handle_irq: unexpected interrupt %u&bslash;n&quot;
comma
id|irq
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|retval
op_assign
id|invoke_irq_handlers
c_func
(paren
id|irq
comma
id|regs
comma
id|action
)paren
suffix:semicolon
id|spin_lock
c_func
(paren
op_amp
id|irq_controller_lock
)paren
suffix:semicolon
(brace
id|status
op_assign
(paren
id|id-&gt;status
op_amp
op_complement
id|IRQ_INPROGRESS
)paren
suffix:semicolon
id|id-&gt;status
op_assign
id|status
suffix:semicolon
)brace
id|spin_unlock
c_func
(paren
op_amp
id|irq_controller_lock
)paren
suffix:semicolon
r_return
id|retval
suffix:semicolon
)brace
r_static
r_void
DECL|function|internal_noop
id|internal_noop
(paren
r_int
r_int
id|irq
)paren
(brace
multiline_comment|/* nuthing to do... */
)brace
DECL|variable|irq_type_ia64_internal
r_struct
id|hw_interrupt_type
id|irq_type_ia64_internal
op_assign
(brace
l_string|&quot;IA64 internal&quot;
comma
(paren
r_void
(paren
op_star
)paren
(paren
r_int
r_int
)paren
)paren
id|internal_noop
comma
multiline_comment|/* init */
id|internal_noop
comma
multiline_comment|/* startup */
id|internal_noop
comma
multiline_comment|/* shutdown */
id|internal_handle_irq
comma
multiline_comment|/* handle */
id|internal_noop
comma
multiline_comment|/* enable */
id|internal_noop
multiline_comment|/* disable */
)brace
suffix:semicolon
eof
