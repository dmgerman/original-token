multiline_comment|/*&n; *  linux/arch/m68k/kernel/setup.c&n; *&n; *  Copyright (C) 1995  Hamish Macdonald&n; */
multiline_comment|/*&n; * This file handles the architecture-dependent parts of system setup&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/interrupt.h&gt;
macro_line|#include &lt;linux/fs.h&gt;
macro_line|#include &lt;linux/console.h&gt;
macro_line|#include &lt;linux/genhd.h&gt;
macro_line|#include &lt;linux/errno.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;asm/bootinfo.h&gt;
macro_line|#include &lt;asm/irq.h&gt;
macro_line|#include &lt;asm/machdep.h&gt;
macro_line|#include &lt;asm/amigatypes.h&gt;
macro_line|#include &lt;asm/amigahw.h&gt;
macro_line|#ifdef CONFIG_BLK_DEV_INITRD
macro_line|#include &lt;linux/blk.h&gt;
macro_line|#include &lt;asm/pgtable.h&gt;
macro_line|#endif
DECL|variable|boot_info
r_struct
id|bootinfo
id|boot_info
op_assign
(brace
l_int|0
comma
)brace
suffix:semicolon
DECL|variable|bisize
r_int
id|bisize
op_assign
r_sizeof
id|boot_info
suffix:semicolon
DECL|variable|m68k_is040or060
r_int
id|m68k_is040or060
op_assign
l_int|0
suffix:semicolon
DECL|variable|m68k_debug_device
r_char
id|m68k_debug_device
(braket
l_int|6
)braket
op_assign
l_string|&quot;&quot;
suffix:semicolon
r_extern
r_int
id|end
suffix:semicolon
r_extern
r_int
r_int
id|availmem
suffix:semicolon
DECL|variable|saved_command_line
r_char
id|saved_command_line
(braket
id|CL_SIZE
)braket
suffix:semicolon
multiline_comment|/* setup some dummy routines */
DECL|function|dummy_waitbut
r_static
r_void
id|dummy_waitbut
c_func
(paren
r_void
)paren
(brace
)brace
DECL|variable|mach_sched_init
r_void
(paren
op_star
id|mach_sched_init
)paren
(paren
id|isrfunc
)paren
suffix:semicolon
DECL|variable|mach_keyb_init
r_int
(paren
op_star
id|mach_keyb_init
)paren
(paren
r_void
)paren
suffix:semicolon
DECL|variable|mach_kbdrate
r_int
(paren
op_star
id|mach_kbdrate
)paren
(paren
r_struct
id|kbd_repeat
op_star
)paren
op_assign
l_int|NULL
suffix:semicolon
DECL|variable|mach_kbd_leds
r_void
(paren
op_star
id|mach_kbd_leds
)paren
(paren
r_int
r_int
)paren
op_assign
l_int|NULL
suffix:semicolon
DECL|variable|mach_init_INTS
r_void
(paren
op_star
id|mach_init_INTS
)paren
(paren
r_void
)paren
suffix:semicolon
DECL|variable|mach_add_isr
r_int
(paren
op_star
id|mach_add_isr
)paren
(paren
r_int
r_int
comma
id|isrfunc
comma
r_int
comma
r_void
op_star
comma
r_char
op_star
)paren
suffix:semicolon
DECL|variable|mach_remove_isr
r_int
(paren
op_star
id|mach_remove_isr
)paren
(paren
r_int
r_int
comma
id|isrfunc
)paren
suffix:semicolon
DECL|variable|mach_process_int
r_void
(paren
op_star
id|mach_process_int
)paren
(paren
r_int
comma
r_struct
id|pt_regs
op_star
)paren
op_assign
l_int|NULL
suffix:semicolon
DECL|variable|mach_enable_irq
r_void
(paren
op_star
id|mach_enable_irq
)paren
(paren
r_int
)paren
op_assign
l_int|NULL
suffix:semicolon
DECL|variable|mach_disable_irq
r_void
(paren
op_star
id|mach_disable_irq
)paren
(paren
r_int
)paren
op_assign
l_int|NULL
suffix:semicolon
DECL|variable|mach_get_irq_list
r_int
(paren
op_star
id|mach_get_irq_list
)paren
(paren
r_char
op_star
comma
r_int
)paren
op_assign
l_int|NULL
suffix:semicolon
DECL|variable|mach_gettimeoffset
r_int
r_int
(paren
op_star
id|mach_gettimeoffset
)paren
(paren
r_void
)paren
suffix:semicolon
DECL|variable|mach_gettod
r_void
(paren
op_star
id|mach_gettod
)paren
(paren
r_int
op_star
comma
r_int
op_star
comma
r_int
op_star
comma
r_int
op_star
comma
r_int
op_star
comma
r_int
op_star
)paren
suffix:semicolon
DECL|variable|mach_hwclk
r_int
(paren
op_star
id|mach_hwclk
)paren
(paren
r_int
comma
r_struct
id|hwclk_time
op_star
)paren
op_assign
l_int|NULL
suffix:semicolon
DECL|variable|mach_set_clock_mmss
r_int
(paren
op_star
id|mach_set_clock_mmss
)paren
(paren
r_int
r_int
)paren
op_assign
l_int|NULL
suffix:semicolon
DECL|variable|mach_check_partition
r_void
(paren
op_star
id|mach_check_partition
)paren
(paren
r_struct
id|gendisk
op_star
comma
r_int
r_int
)paren
suffix:semicolon
DECL|variable|mach_mksound
r_void
(paren
op_star
id|mach_mksound
)paren
(paren
r_int
r_int
id|count
comma
r_int
r_int
id|ticks
)paren
suffix:semicolon
DECL|variable|mach_reset
r_void
(paren
op_star
id|mach_reset
)paren
(paren
r_void
)paren
suffix:semicolon
DECL|variable|waitbut
r_void
(paren
op_star
id|waitbut
)paren
(paren
r_void
)paren
op_assign
id|dummy_waitbut
suffix:semicolon
DECL|variable|mach_fb_init
r_struct
id|fb_info
op_star
(paren
op_star
id|mach_fb_init
)paren
(paren
r_int
op_star
)paren
suffix:semicolon
DECL|variable|mach_max_dma_address
r_int
id|mach_max_dma_address
op_assign
l_int|0x00ffffff
suffix:semicolon
multiline_comment|/* default set to the lower 16MB */
DECL|variable|mach_debug_init
r_void
(paren
op_star
id|mach_debug_init
)paren
(paren
r_void
)paren
suffix:semicolon
DECL|variable|mach_video_setup
r_void
(paren
op_star
id|mach_video_setup
)paren
(paren
r_char
op_star
comma
r_int
op_star
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_BLK_DEV_FD
DECL|variable|mach_floppy_init
r_int
(paren
op_star
id|mach_floppy_init
)paren
(paren
r_void
)paren
op_assign
l_int|NULL
suffix:semicolon
DECL|variable|mach_floppy_setup
r_void
(paren
op_star
id|mach_floppy_setup
)paren
(paren
r_char
op_star
comma
r_int
op_star
)paren
op_assign
l_int|NULL
suffix:semicolon
macro_line|#endif
r_extern
r_void
id|config_amiga
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_void
id|config_atari
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_void
id|config_mac
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_void
id|register_console
c_func
(paren
r_void
(paren
op_star
id|proc
)paren
(paren
r_const
r_char
op_star
)paren
)paren
suffix:semicolon
r_extern
r_void
id|ami_serial_print
(paren
r_const
r_char
op_star
id|str
)paren
suffix:semicolon
r_extern
r_void
id|ata_serial_print
(paren
r_const
r_char
op_star
id|str
)paren
suffix:semicolon
r_extern
r_void
(paren
op_star
id|kd_mksound
)paren
(paren
r_int
r_int
comma
r_int
r_int
)paren
suffix:semicolon
r_extern
r_void
id|amiga_get_model
c_func
(paren
r_char
op_star
id|model
)paren
suffix:semicolon
r_extern
r_void
id|atari_get_model
c_func
(paren
r_char
op_star
id|model
)paren
suffix:semicolon
r_extern
r_void
id|mac_get_model
c_func
(paren
r_char
op_star
id|model
)paren
suffix:semicolon
r_extern
r_int
id|amiga_get_hardware_list
c_func
(paren
r_char
op_star
id|buffer
)paren
suffix:semicolon
r_extern
r_int
id|atari_get_hardware_list
c_func
(paren
r_char
op_star
id|buffer
)paren
suffix:semicolon
r_extern
r_int
id|mac_get_hardware_list
c_func
(paren
r_char
op_star
id|buffer
)paren
suffix:semicolon
DECL|macro|MASK_256K
mdefine_line|#define MASK_256K 0xfffc0000
DECL|function|setup_arch
r_void
id|setup_arch
c_func
(paren
r_char
op_star
op_star
id|cmdline_p
comma
r_int
r_int
op_star
id|memory_start_p
comma
r_int
r_int
op_star
id|memory_end_p
)paren
(brace
r_int
r_int
id|memory_start
comma
id|memory_end
suffix:semicolon
r_extern
r_int
id|_etext
comma
id|_edata
comma
id|_end
suffix:semicolon
r_int
id|i
suffix:semicolon
r_char
op_star
id|p
comma
op_star
id|q
suffix:semicolon
macro_line|#ifdef CONFIG_AMIGA
r_if
c_cond
(paren
id|MACH_IS_AMIGA
)paren
id|register_console
(paren
id|ami_serial_print
)paren
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_ATARI
r_if
c_cond
(paren
id|MACH_IS_ATARI
)paren
id|register_console
(paren
id|ata_serial_print
)paren
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
id|boot_info.cputype
op_amp
id|CPU_68040
)paren
id|m68k_is040or060
op_assign
l_int|4
suffix:semicolon
r_else
r_if
c_cond
(paren
id|boot_info.cputype
op_amp
id|CPU_68060
)paren
id|m68k_is040or060
op_assign
l_int|6
suffix:semicolon
id|memory_start
op_assign
id|availmem
suffix:semicolon
id|memory_end
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|boot_info.num_memory
suffix:semicolon
id|i
op_increment
)paren
id|memory_end
op_add_assign
id|boot_info.memory
(braket
id|i
)braket
dot
id|size
op_amp
id|MASK_256K
suffix:semicolon
id|init_task.mm-&gt;start_code
op_assign
l_int|0
suffix:semicolon
id|init_task.mm-&gt;end_code
op_assign
(paren
r_int
r_int
)paren
op_amp
id|_etext
suffix:semicolon
id|init_task.mm-&gt;end_data
op_assign
(paren
r_int
r_int
)paren
op_amp
id|_edata
suffix:semicolon
id|init_task.mm-&gt;brk
op_assign
(paren
r_int
r_int
)paren
op_amp
id|_end
suffix:semicolon
op_star
id|cmdline_p
op_assign
id|boot_info.command_line
suffix:semicolon
id|memcpy
c_func
(paren
id|saved_command_line
comma
op_star
id|cmdline_p
comma
id|CL_SIZE
)paren
suffix:semicolon
multiline_comment|/* Parse the command line for arch-specific options.&n;&t; * For the m68k, this is currently only &quot;debug=xxx&quot; to enable printing&n;&t; * certain kernel messages to some machine-specific device.&n;&t; */
r_for
c_loop
(paren
id|p
op_assign
op_star
id|cmdline_p
suffix:semicolon
id|p
op_logical_and
op_star
id|p
suffix:semicolon
)paren
(brace
id|i
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|p
comma
l_string|&quot;debug=&quot;
comma
l_int|6
)paren
)paren
(brace
id|strncpy
c_func
(paren
id|m68k_debug_device
comma
id|p
op_plus
l_int|6
comma
r_sizeof
(paren
id|m68k_debug_device
)paren
op_minus
l_int|1
)paren
suffix:semicolon
id|m68k_debug_device
(braket
r_sizeof
(paren
id|m68k_debug_device
)paren
op_minus
l_int|1
)braket
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
(paren
id|q
op_assign
id|strchr
c_func
(paren
id|m68k_debug_device
comma
l_char|&squot; &squot;
)paren
)paren
)paren
op_star
id|q
op_assign
l_int|0
suffix:semicolon
id|i
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|i
)paren
(brace
multiline_comment|/* option processed, delete it */
r_if
c_cond
(paren
(paren
id|q
op_assign
id|strchr
c_func
(paren
id|p
comma
l_char|&squot; &squot;
)paren
)paren
)paren
id|strcpy
c_func
(paren
id|p
comma
id|q
op_plus
l_int|1
)paren
suffix:semicolon
r_else
op_star
id|p
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
(paren
id|p
op_assign
id|strchr
c_func
(paren
id|p
comma
l_char|&squot; &squot;
)paren
)paren
)paren
op_increment
id|p
suffix:semicolon
)brace
)brace
op_star
id|memory_start_p
op_assign
id|memory_start
suffix:semicolon
op_star
id|memory_end_p
op_assign
id|memory_end
suffix:semicolon
r_switch
c_cond
(paren
id|boot_info.machtype
)paren
(brace
macro_line|#ifdef CONFIG_AMIGA
r_case
id|MACH_AMIGA
suffix:colon
id|config_amiga
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_ATARI
r_case
id|MACH_ATARI
suffix:colon
id|config_atari
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_MAC
r_case
id|MACH_MAC
suffix:colon
id|config_mac
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
r_default
suffix:colon
id|panic
(paren
l_string|&quot;No configuration setup&quot;
)paren
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_BLK_DEV_INITRD
r_if
c_cond
(paren
id|boot_info.ramdisk_size
)paren
(brace
id|initrd_start
op_assign
id|PTOV
(paren
id|boot_info.ramdisk_addr
)paren
suffix:semicolon
id|initrd_end
op_assign
id|initrd_start
op_plus
id|boot_info.ramdisk_size
op_star
l_int|1024
suffix:semicolon
)brace
macro_line|#endif
)brace
DECL|function|setkeycode
r_int
id|setkeycode
c_func
(paren
r_int
r_int
id|scancode
comma
r_int
r_int
id|keycode
)paren
(brace
r_return
op_minus
id|EOPNOTSUPP
suffix:semicolon
)brace
DECL|function|getkeycode
r_int
id|getkeycode
c_func
(paren
r_int
r_int
id|scancode
)paren
(brace
r_return
op_minus
id|EOPNOTSUPP
suffix:semicolon
)brace
DECL|function|get_cpuinfo
r_int
id|get_cpuinfo
c_func
(paren
r_char
op_star
id|buffer
)paren
(brace
r_char
op_star
id|cpu
comma
op_star
id|mmu
comma
op_star
id|fpu
suffix:semicolon
id|u_long
id|clockfreq
comma
id|clockfactor
suffix:semicolon
DECL|macro|CLOCK_FACTOR_68020
mdefine_line|#define CLOCK_FACTOR_68020&t;(8046)&t;/*  3107016 loops/s @ 25 MHz (Sun-3) */
DECL|macro|CLOCK_FACTOR_68030
mdefine_line|#define CLOCK_FACTOR_68030&t;(8010)&t;/*  3994575 loops/s @ 32 MHz */
DECL|macro|CLOCK_FACTOR_68040
mdefine_line|#define CLOCK_FACTOR_68040&t;(3010)&t;/*  8305552 loops/s @ 25 MHz */
DECL|macro|CLOCK_FACTOR_68060
mdefine_line|#define CLOCK_FACTOR_68060&t;(998)&t;/* 50081241 loops/s @ 50 MHz */
r_if
c_cond
(paren
id|boot_info.cputype
op_amp
id|CPU_68020
)paren
(brace
id|cpu
op_assign
l_string|&quot;68020&quot;
suffix:semicolon
id|mmu
op_assign
l_string|&quot;68851&quot;
suffix:semicolon
id|clockfactor
op_assign
id|CLOCK_FACTOR_68020
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|boot_info.cputype
op_amp
id|CPU_68030
)paren
(brace
id|cpu
op_assign
id|mmu
op_assign
l_string|&quot;68030&quot;
suffix:semicolon
id|clockfactor
op_assign
id|CLOCK_FACTOR_68030
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|boot_info.cputype
op_amp
id|CPU_68040
)paren
(brace
id|cpu
op_assign
id|mmu
op_assign
l_string|&quot;68040&quot;
suffix:semicolon
id|clockfactor
op_assign
id|CLOCK_FACTOR_68040
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|boot_info.cputype
op_amp
id|CPU_68060
)paren
(brace
id|cpu
op_assign
id|mmu
op_assign
l_string|&quot;68060&quot;
suffix:semicolon
id|clockfactor
op_assign
id|CLOCK_FACTOR_68060
suffix:semicolon
)brace
r_else
(brace
id|cpu
op_assign
id|mmu
op_assign
l_string|&quot;680x0&quot;
suffix:semicolon
id|clockfactor
op_assign
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|boot_info.cputype
op_amp
id|FPU_68881
)paren
id|fpu
op_assign
l_string|&quot;68881&quot;
suffix:semicolon
r_else
r_if
c_cond
(paren
id|boot_info.cputype
op_amp
id|FPU_68882
)paren
id|fpu
op_assign
l_string|&quot;68882&quot;
suffix:semicolon
r_else
r_if
c_cond
(paren
id|boot_info.cputype
op_amp
id|FPU_68040
)paren
id|fpu
op_assign
l_string|&quot;68040&quot;
suffix:semicolon
r_else
r_if
c_cond
(paren
id|boot_info.cputype
op_amp
id|FPU_68060
)paren
id|fpu
op_assign
l_string|&quot;68060&quot;
suffix:semicolon
r_else
id|fpu
op_assign
l_string|&quot;none&quot;
suffix:semicolon
id|clockfreq
op_assign
id|loops_per_sec
op_div
l_int|1000
op_star
id|clockfactor
suffix:semicolon
r_return
id|sprintf
c_func
(paren
id|buffer
comma
l_string|&quot;CPU:&bslash;t&bslash;t%s&bslash;n&quot;
l_string|&quot;MMU:&bslash;t&bslash;t%s&bslash;n&quot;
l_string|&quot;FPU:&bslash;t&bslash;t%s&bslash;n&quot;
l_string|&quot;Clockspeed:&bslash;t%lu.%1luMHz&bslash;n&quot;
l_string|&quot;BogoMips:&bslash;t%lu.%02lu&bslash;n&quot;
comma
id|cpu
comma
id|mmu
comma
id|fpu
comma
id|clockfreq
op_div
l_int|1000000
comma
(paren
(paren
id|clockfreq
op_plus
l_int|50000
)paren
op_div
l_int|100000
)paren
op_mod
l_int|10
comma
id|loops_per_sec
op_div
l_int|500000
comma
(paren
id|loops_per_sec
op_div
l_int|5000
)paren
op_mod
l_int|100
)paren
suffix:semicolon
)brace
DECL|function|get_hardware_list
r_int
id|get_hardware_list
c_func
(paren
r_char
op_star
id|buffer
)paren
(brace
r_int
id|len
op_assign
l_int|0
suffix:semicolon
r_char
id|model
(braket
l_int|80
)braket
suffix:semicolon
id|u_long
id|mem
suffix:semicolon
r_int
id|i
suffix:semicolon
r_switch
c_cond
(paren
id|boot_info.machtype
)paren
(brace
macro_line|#ifdef CONFIG_AMIGA
r_case
id|MACH_AMIGA
suffix:colon
id|amiga_get_model
c_func
(paren
id|model
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_ATARI
r_case
id|MACH_ATARI
suffix:colon
id|atari_get_model
c_func
(paren
id|model
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_MAC
r_case
id|MACH_MAC
suffix:colon
id|mac_get_model
c_func
(paren
id|model
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
r_default
suffix:colon
id|strcpy
c_func
(paren
id|model
comma
l_string|&quot;Unknown m68k&quot;
)paren
suffix:semicolon
)brace
multiline_comment|/* boot_info.machtype */
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot;Model:&bslash;t&bslash;t%s&bslash;n&quot;
comma
id|model
)paren
suffix:semicolon
id|len
op_add_assign
id|get_cpuinfo
c_func
(paren
id|buffer
op_plus
id|len
)paren
suffix:semicolon
r_for
c_loop
(paren
id|mem
op_assign
l_int|0
comma
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|boot_info.num_memory
suffix:semicolon
id|i
op_increment
)paren
id|mem
op_add_assign
id|boot_info.memory
(braket
id|i
)braket
dot
id|size
suffix:semicolon
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot;System Memory:&bslash;t%ldK&bslash;n&quot;
comma
id|mem
op_rshift
l_int|10
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|boot_info.machtype
)paren
(brace
macro_line|#ifdef CONFIG_AMIGA
r_case
id|MACH_AMIGA
suffix:colon
id|len
op_add_assign
id|amiga_get_hardware_list
c_func
(paren
id|buffer
op_plus
id|len
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_ATARI
r_case
id|MACH_ATARI
suffix:colon
id|len
op_add_assign
id|atari_get_hardware_list
c_func
(paren
id|buffer
op_plus
id|len
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_MAC
r_case
id|MACH_MAC
suffix:colon
r_break
suffix:semicolon
macro_line|#endif
)brace
multiline_comment|/* boot_info.machtype */
macro_line|#if 0 /* ++1.3++ */
id|len
op_add_assign
id|get_serial_list
(paren
id|buffer
op_plus
id|len
)paren
suffix:semicolon
macro_line|#endif /* ++1.3++ */
r_return
id|len
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_BLK_DEV_FD
DECL|function|floppy_init
r_int
id|floppy_init
c_func
(paren
r_void
)paren
(brace
r_if
c_cond
(paren
id|mach_floppy_init
)paren
r_return
id|mach_floppy_init
c_func
(paren
)paren
suffix:semicolon
r_else
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|floppy_setup
r_void
id|floppy_setup
c_func
(paren
r_char
op_star
id|str
comma
r_int
op_star
id|ints
)paren
(brace
r_if
c_cond
(paren
id|mach_floppy_setup
)paren
id|mach_floppy_setup
(paren
id|str
comma
id|ints
)paren
suffix:semicolon
)brace
macro_line|#endif
DECL|function|arch_kbd_init
r_int
r_int
id|arch_kbd_init
c_func
(paren
r_void
)paren
(brace
r_return
id|mach_keyb_init
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|function|rs_init
r_int
id|rs_init
c_func
(paren
r_void
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
r_struct
id|serial_struct
suffix:semicolon
DECL|function|register_serial
r_int
id|register_serial
c_func
(paren
r_struct
id|serial_struct
op_star
id|req
)paren
(brace
r_return
op_minus
l_int|1
suffix:semicolon
)brace
DECL|function|unregister_serial
r_void
id|unregister_serial
c_func
(paren
r_int
id|line
)paren
(brace
)brace
DECL|function|arch_gettod
r_void
id|arch_gettod
c_func
(paren
r_int
op_star
id|year
comma
r_int
op_star
id|mon
comma
r_int
op_star
id|day
comma
r_int
op_star
id|hour
comma
r_int
op_star
id|min
comma
r_int
op_star
id|sec
)paren
(brace
r_if
c_cond
(paren
id|mach_gettod
)paren
id|mach_gettod
c_func
(paren
id|year
comma
id|mon
comma
id|day
comma
id|hour
comma
id|min
comma
id|sec
)paren
suffix:semicolon
r_else
op_star
id|year
op_assign
op_star
id|mon
op_assign
op_star
id|day
op_assign
op_star
id|hour
op_assign
op_star
id|min
op_assign
op_star
id|sec
op_assign
l_int|0
suffix:semicolon
)brace
DECL|function|video_setup
r_void
id|video_setup
(paren
r_char
op_star
id|options
comma
r_int
op_star
id|ints
)paren
(brace
r_if
c_cond
(paren
id|mach_video_setup
)paren
id|mach_video_setup
(paren
id|options
comma
id|ints
)paren
suffix:semicolon
)brace
eof
