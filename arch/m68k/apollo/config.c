macro_line|#include &lt;stdarg.h&gt;
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/kd.h&gt;
macro_line|#include &lt;linux/tty.h&gt;
macro_line|#include &lt;linux/console.h&gt;
macro_line|#include &lt;asm/setup.h&gt;
macro_line|#include &lt;asm/system.h&gt;
macro_line|#include &lt;asm/pgtable.h&gt;
macro_line|#include &lt;asm/apollohw.h&gt;
macro_line|#include &lt;asm/irq.h&gt;
macro_line|#include &lt;asm/machdep.h&gt;
r_extern
r_struct
id|consw
id|fb_con
suffix:semicolon
r_extern
r_void
id|dn_sched_init
c_func
(paren
r_void
(paren
op_star
id|handler
)paren
(paren
r_int
comma
r_void
op_star
comma
r_struct
id|pt_regs
op_star
)paren
)paren
suffix:semicolon
r_extern
r_int
id|dn_keyb_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|dn_dummy_kbdrate
c_func
(paren
r_struct
id|kbd_repeat
op_star
)paren
suffix:semicolon
r_extern
r_void
id|dn_init_IRQ
c_func
(paren
r_void
)paren
suffix:semicolon
macro_line|#if 0
r_extern
r_void
(paren
op_star
id|dn_default_handler
(braket
)braket
)paren
(paren
r_int
comma
r_void
op_star
comma
r_struct
id|pt_regs
op_star
)paren
suffix:semicolon
macro_line|#endif
r_extern
r_int
id|dn_request_irq
c_func
(paren
r_int
r_int
id|irq
comma
r_void
(paren
op_star
id|handler
)paren
(paren
r_int
comma
r_void
op_star
comma
r_struct
id|pt_regs
op_star
)paren
comma
r_int
r_int
id|flags
comma
r_const
r_char
op_star
id|devname
comma
r_void
op_star
id|dev_id
)paren
suffix:semicolon
r_extern
r_void
id|dn_free_irq
c_func
(paren
r_int
r_int
id|irq
comma
r_void
op_star
id|dev_id
)paren
suffix:semicolon
r_extern
r_void
id|dn_enable_irq
c_func
(paren
r_int
r_int
)paren
suffix:semicolon
r_extern
r_void
id|dn_disable_irq
c_func
(paren
r_int
r_int
)paren
suffix:semicolon
r_extern
r_int
id|dn_get_irq_list
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
r_extern
r_int
r_int
id|dn_gettimeoffset
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_void
id|dn_gettod
c_func
(paren
r_int
op_star
comma
r_int
op_star
comma
r_int
op_star
comma
r_int
op_star
comma
r_int
op_star
comma
r_int
op_star
)paren
suffix:semicolon
r_extern
r_int
id|dn_dummy_hwclk
c_func
(paren
r_int
comma
r_struct
id|hwclk_time
op_star
)paren
suffix:semicolon
r_extern
r_int
id|dn_dummy_set_clock_mmss
c_func
(paren
r_int
r_int
)paren
suffix:semicolon
r_extern
r_void
id|dn_mksound
c_func
(paren
r_int
r_int
id|count
comma
r_int
r_int
id|ticks
)paren
suffix:semicolon
r_extern
r_void
id|dn_dummy_reset
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_void
id|dn_dummy_waitbut
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_struct
id|fb_info
op_star
id|dn_fb_init
c_func
(paren
r_int
op_star
)paren
suffix:semicolon
r_extern
r_void
id|dn_dummy_debug_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_void
(paren
op_star
id|kd_mksound
)paren
(paren
r_int
r_int
comma
r_int
r_int
)paren
suffix:semicolon
r_extern
r_void
id|dn_dummy_video_setup
c_func
(paren
r_char
op_star
comma
r_int
op_star
)paren
suffix:semicolon
r_extern
r_void
id|dn_process_int
c_func
(paren
r_int
id|irq
comma
r_struct
id|pt_regs
op_star
id|fp
)paren
suffix:semicolon
DECL|variable|dn_console_driver
r_static
r_struct
id|console
id|dn_console_driver
suffix:semicolon
r_static
r_void
id|dn_debug_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_static
r_void
id|dn_timer_int
c_func
(paren
r_int
id|irq
comma
r_void
op_star
comma
r_struct
id|pt_regs
op_star
)paren
suffix:semicolon
DECL|variable|sched_timer_handler
r_static
r_void
(paren
op_star
id|sched_timer_handler
)paren
(paren
r_int
comma
r_void
op_star
comma
r_struct
id|pt_regs
op_star
)paren
op_assign
l_int|NULL
suffix:semicolon
DECL|function|dn_serial_console_wait_key
r_int
id|dn_serial_console_wait_key
c_func
(paren
r_void
)paren
(brace
r_while
c_loop
(paren
op_logical_neg
(paren
id|sio01.srb_csrb
op_amp
l_int|1
)paren
)paren
(brace
id|barrier
c_func
(paren
)paren
suffix:semicolon
)brace
r_return
id|sio01.rhrb_thrb
suffix:semicolon
)brace
DECL|function|dn_serial_console_write
r_void
id|dn_serial_console_write
(paren
r_const
r_char
op_star
id|str
comma
r_int
r_int
id|count
)paren
(brace
r_while
c_loop
(paren
id|count
op_decrement
)paren
(brace
r_if
c_cond
(paren
op_star
id|str
op_eq
l_char|&squot;&bslash;n&squot;
)paren
(brace
id|sio01.rhrb_thrb
op_assign
(paren
r_int
r_char
)paren
l_char|&squot;&bslash;r&squot;
suffix:semicolon
r_while
c_loop
(paren
op_logical_neg
(paren
id|sio01.srb_csrb
op_amp
l_int|0x4
)paren
)paren
suffix:semicolon
)brace
id|sio01.rhrb_thrb
op_assign
(paren
r_int
r_char
)paren
op_star
id|str
op_increment
suffix:semicolon
r_while
c_loop
(paren
op_logical_neg
(paren
id|sio01.srb_csrb
op_amp
l_int|0x4
)paren
)paren
suffix:semicolon
)brace
)brace
DECL|function|dn_serial_print
r_void
id|dn_serial_print
(paren
r_const
r_char
op_star
id|str
)paren
(brace
r_while
c_loop
(paren
op_star
id|str
)paren
(brace
r_if
c_cond
(paren
op_star
id|str
op_eq
l_char|&squot;&bslash;n&squot;
)paren
(brace
id|sio01.rhrb_thrb
op_assign
(paren
r_int
r_char
)paren
l_char|&squot;&bslash;r&squot;
suffix:semicolon
r_while
c_loop
(paren
op_logical_neg
(paren
id|sio01.srb_csrb
op_amp
l_int|0x4
)paren
)paren
suffix:semicolon
)brace
id|sio01.rhrb_thrb
op_assign
(paren
r_int
r_char
)paren
op_star
id|str
op_increment
suffix:semicolon
r_while
c_loop
(paren
op_logical_neg
(paren
id|sio01.srb_csrb
op_amp
l_int|0x4
)paren
)paren
suffix:semicolon
)brace
)brace
DECL|function|config_apollo
r_void
id|config_apollo
c_func
(paren
r_void
)paren
(brace
id|dn_serial_print
c_func
(paren
l_string|&quot;Config apollo !&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#if 0
id|dn_debug_init
c_func
(paren
)paren
suffix:semicolon
macro_line|#endif
id|printk
c_func
(paren
l_string|&quot;Config apollo !&bslash;n&quot;
)paren
suffix:semicolon
id|mach_sched_init
op_assign
id|dn_sched_init
suffix:semicolon
multiline_comment|/* */
id|mach_keyb_init
op_assign
id|dn_keyb_init
suffix:semicolon
id|mach_kbdrate
op_assign
id|dn_dummy_kbdrate
suffix:semicolon
id|mach_init_IRQ
op_assign
id|dn_init_IRQ
suffix:semicolon
id|mach_default_handler
op_assign
l_int|NULL
suffix:semicolon
id|mach_request_irq
op_assign
id|dn_request_irq
suffix:semicolon
id|mach_free_irq
op_assign
id|dn_free_irq
suffix:semicolon
id|enable_irq
op_assign
id|dn_enable_irq
suffix:semicolon
id|disable_irq
op_assign
id|dn_disable_irq
suffix:semicolon
id|mach_get_irq_list
op_assign
id|dn_get_irq_list
suffix:semicolon
id|mach_gettimeoffset
op_assign
id|dn_gettimeoffset
suffix:semicolon
id|mach_gettod
op_assign
id|dn_gettod
suffix:semicolon
multiline_comment|/* */
id|mach_max_dma_address
op_assign
l_int|0xffffffff
suffix:semicolon
id|mach_hwclk
op_assign
id|dn_dummy_hwclk
suffix:semicolon
multiline_comment|/* */
id|mach_set_clock_mmss
op_assign
id|dn_dummy_set_clock_mmss
suffix:semicolon
multiline_comment|/* */
id|mach_process_int
op_assign
id|dn_process_int
suffix:semicolon
macro_line|#ifdef CONFIG_BLK_DEV_FD
id|mach_floppy_init
op_assign
id|dn_dummy_floppy_init
suffix:semicolon
id|mach_floppy_setup
op_assign
id|dn_dummy_floppy_setup
suffix:semicolon
macro_line|#endif
id|mach_reset
op_assign
id|dn_dummy_reset
suffix:semicolon
multiline_comment|/* */
id|conswitchp
op_assign
op_amp
id|fb_con
suffix:semicolon
macro_line|#if 0
id|mach_fb_init
op_assign
id|dn_fb_init
suffix:semicolon
id|mach_video_setup
op_assign
id|dn_dummy_video_setup
suffix:semicolon
macro_line|#endif
id|kd_mksound
op_assign
id|dn_mksound
suffix:semicolon
)brace
DECL|function|dn_timer_int
r_void
id|dn_timer_int
c_func
(paren
r_int
id|irq
comma
r_void
op_star
id|dev_id
comma
r_struct
id|pt_regs
op_star
id|fp
)paren
(brace
r_volatile
r_int
r_char
id|x
suffix:semicolon
id|sched_timer_handler
c_func
(paren
id|irq
comma
id|dev_id
comma
id|fp
)paren
suffix:semicolon
id|x
op_assign
op_star
(paren
r_volatile
r_int
r_char
op_star
)paren
(paren
id|IO_BASE
op_plus
l_int|0x10803
)paren
suffix:semicolon
id|x
op_assign
op_star
(paren
r_volatile
r_int
r_char
op_star
)paren
(paren
id|IO_BASE
op_plus
l_int|0x10805
)paren
suffix:semicolon
)brace
DECL|function|dn_sched_init
r_void
id|dn_sched_init
c_func
(paren
r_void
(paren
op_star
id|timer_routine
)paren
(paren
r_int
comma
r_void
op_star
comma
r_struct
id|pt_regs
op_star
)paren
)paren
(brace
id|dn_serial_print
c_func
(paren
l_string|&quot;dn sched_init&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#if 0
multiline_comment|/* program timer 2 */
op_star
(paren
r_volatile
r_int
r_char
op_star
)paren
(paren
id|IO_BASE
op_plus
l_int|0x10803
)paren
op_assign
l_int|0x00
suffix:semicolon
op_star
(paren
r_volatile
r_int
r_char
op_star
)paren
(paren
id|IO_BASE
op_plus
l_int|0x10809
)paren
op_assign
l_int|0
suffix:semicolon
op_star
(paren
r_volatile
r_int
r_char
op_star
)paren
(paren
id|IO_BASE
op_plus
l_int|0x1080b
)paren
op_assign
l_int|50
suffix:semicolon
multiline_comment|/* program timer 3 */
op_star
(paren
r_volatile
r_int
r_char
op_star
)paren
(paren
id|IO_BASE
op_plus
l_int|0x10801
)paren
op_assign
l_int|0x00
suffix:semicolon
op_star
(paren
r_volatile
r_int
r_char
op_star
)paren
(paren
id|IO_BASE
op_plus
l_int|0x1080c
)paren
op_assign
l_int|0
suffix:semicolon
op_star
(paren
r_volatile
r_int
r_char
op_star
)paren
(paren
id|IO_BASE
op_plus
l_int|0x1080f
)paren
op_assign
l_int|50
suffix:semicolon
macro_line|#endif
multiline_comment|/* program timer 1 */
op_star
(paren
r_volatile
r_int
r_char
op_star
)paren
(paren
id|IO_BASE
op_plus
l_int|0x10803
)paren
op_assign
l_int|0x01
suffix:semicolon
op_star
(paren
r_volatile
r_int
r_char
op_star
)paren
(paren
id|IO_BASE
op_plus
l_int|0x10801
)paren
op_assign
l_int|0x40
suffix:semicolon
op_star
(paren
r_volatile
r_int
r_char
op_star
)paren
(paren
id|IO_BASE
op_plus
l_int|0x10805
)paren
op_assign
l_int|0x09
suffix:semicolon
op_star
(paren
r_volatile
r_int
r_char
op_star
)paren
(paren
id|IO_BASE
op_plus
l_int|0x10807
)paren
op_assign
l_int|0xc4
suffix:semicolon
multiline_comment|/* enable IRQ of PIC B */
op_star
(paren
r_volatile
r_int
r_char
op_star
)paren
(paren
id|IO_BASE
op_plus
id|PICA
op_plus
l_int|1
)paren
op_and_assign
(paren
op_complement
l_int|8
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;*(0x10803) %02x&bslash;n&quot;
comma
op_star
(paren
r_volatile
r_int
r_char
op_star
)paren
(paren
id|IO_BASE
op_plus
l_int|0x10803
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;*(0x10803) %02x&bslash;n&quot;
comma
op_star
(paren
r_volatile
r_int
r_char
op_star
)paren
(paren
id|IO_BASE
op_plus
l_int|0x10803
)paren
)paren
suffix:semicolon
id|sched_timer_handler
op_assign
id|timer_routine
suffix:semicolon
id|request_irq
c_func
(paren
l_int|0
comma
id|dn_timer_int
comma
l_int|0
comma
l_int|NULL
comma
l_int|NULL
)paren
suffix:semicolon
)brace
DECL|function|dn_gettimeoffset
r_int
r_int
id|dn_gettimeoffset
c_func
(paren
r_void
)paren
(brace
r_return
l_int|0xdeadbeef
suffix:semicolon
)brace
DECL|function|dn_gettod
r_void
id|dn_gettod
c_func
(paren
r_int
op_star
id|yearp
comma
r_int
op_star
id|monp
comma
r_int
op_star
id|dayp
comma
r_int
op_star
id|hourp
comma
r_int
op_star
id|minp
comma
r_int
op_star
id|secp
)paren
(brace
op_star
id|yearp
op_assign
id|rtc-&gt;year
suffix:semicolon
op_star
id|monp
op_assign
id|rtc-&gt;month
suffix:semicolon
op_star
id|dayp
op_assign
id|rtc-&gt;day_of_month
suffix:semicolon
op_star
id|hourp
op_assign
id|rtc-&gt;hours
suffix:semicolon
op_star
id|minp
op_assign
id|rtc-&gt;minute
suffix:semicolon
op_star
id|secp
op_assign
id|rtc-&gt;second
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;gettod: %d %d %d %d %d %d&bslash;n&quot;
comma
op_star
id|yearp
comma
op_star
id|monp
comma
op_star
id|dayp
comma
op_star
id|hourp
comma
op_star
id|minp
comma
op_star
id|secp
)paren
suffix:semicolon
)brace
DECL|function|dn_dummy_hwclk
r_int
id|dn_dummy_hwclk
c_func
(paren
r_int
id|op
comma
r_struct
id|hwclk_time
op_star
id|t
)paren
(brace
id|dn_serial_print
c_func
(paren
l_string|&quot;hwclk !&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|op
)paren
(brace
multiline_comment|/* read */
id|t-&gt;sec
op_assign
id|rtc-&gt;second
suffix:semicolon
id|t-&gt;min
op_assign
id|rtc-&gt;minute
suffix:semicolon
id|t-&gt;hour
op_assign
id|rtc-&gt;hours
suffix:semicolon
id|t-&gt;day
op_assign
id|rtc-&gt;day_of_month
suffix:semicolon
id|t-&gt;wday
op_assign
id|rtc-&gt;day_of_week
suffix:semicolon
id|t-&gt;mon
op_assign
id|rtc-&gt;month
suffix:semicolon
id|t-&gt;year
op_assign
id|rtc-&gt;year
suffix:semicolon
)brace
r_else
(brace
id|rtc-&gt;second
op_assign
id|t-&gt;sec
suffix:semicolon
id|rtc-&gt;minute
op_assign
id|t-&gt;min
suffix:semicolon
id|rtc-&gt;hours
op_assign
id|t-&gt;hour
suffix:semicolon
id|rtc-&gt;day_of_month
op_assign
id|t-&gt;day
suffix:semicolon
r_if
c_cond
(paren
id|t-&gt;wday
op_ne
op_minus
l_int|1
)paren
(brace
id|rtc-&gt;day_of_week
op_assign
id|t-&gt;wday
suffix:semicolon
)brace
id|rtc-&gt;month
op_assign
id|t-&gt;mon
suffix:semicolon
id|rtc-&gt;year
op_assign
id|t-&gt;year
suffix:semicolon
)brace
id|dn_serial_print
c_func
(paren
l_string|&quot;hwclk end!&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dn_dummy_set_clock_mmss
r_int
id|dn_dummy_set_clock_mmss
c_func
(paren
r_int
r_int
id|nowtime
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;set_clock_mmss&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dn_dummy_reset
r_void
id|dn_dummy_reset
c_func
(paren
r_void
)paren
(brace
id|dn_serial_print
c_func
(paren
l_string|&quot;The end !&bslash;n&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
suffix:semicolon
)paren
(brace
suffix:semicolon
)brace
)brace
DECL|function|dn_dummy_waitbut
r_void
id|dn_dummy_waitbut
c_func
(paren
r_void
)paren
(brace
id|dn_serial_print
c_func
(paren
l_string|&quot;waitbut&bslash;n&quot;
)paren
suffix:semicolon
)brace
macro_line|#if 0
r_void
id|dn_debug_init
c_func
(paren
r_void
)paren
(brace
id|dn_console_driver.write
op_assign
id|dn_serial_console_write
suffix:semicolon
id|register_console
c_func
(paren
op_amp
id|dn_console_driver
)paren
suffix:semicolon
)brace
macro_line|#endif
eof
