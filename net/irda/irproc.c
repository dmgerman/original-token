multiline_comment|/*********************************************************************&n; *                &n; * Filename:      irproc.c&n; * Version:       &n; * Description:   Various entries in the /proc file system&n; * Status:        Experimental.&n; * Author:        Thomas Davis, &lt;ratbert@radiks.net&gt;&n; * Created at:    Sat Feb 21 21:33:24 1998&n; * Modified at:   Wed Dec  9 02:26:45 1998&n; * Modified by:   Dag Brattli &lt;dagb@cs.uit.no&gt;&n; * &n; *     Copyright (c) 1998, Thomas Davis, &lt;ratbert@radiks.net&gt;, &n; *     All Rights Reserved.&n; *      &n; *     This program is free software; you can redistribute it and/or &n; *     modify it under the terms of the GNU General Public License as &n; *     published by the Free Software Foundation; either version 2 of &n; *     the License, or (at your option) any later version.&n; *  &n; *     I, Thomas Davis, provide no warranty for any of this software. &n; *     This material is provided &quot;AS-IS&quot; and at no charge. &n; *     &n; *     Portions lifted from the linux/fs/procfs/ files.&n; *&n; ********************************************************************/
macro_line|#include &lt;linux/miscdevice.h&gt;
macro_line|#include &lt;linux/proc_fs.h&gt;
macro_line|#include &lt;net/irda/irmod.h&gt;
macro_line|#include &lt;net/irda/irlap.h&gt;
macro_line|#include &lt;net/irda/irlmp.h&gt;
r_static
r_int
id|proc_irda_21x_lookup
c_func
(paren
r_struct
id|inode
op_star
id|dir
comma
r_struct
id|dentry
op_star
id|dentry
)paren
suffix:semicolon
r_static
r_int
id|proc_irda_readdir
c_func
(paren
r_struct
id|file
op_star
id|filp
comma
r_void
op_star
id|dirent
comma
id|filldir_t
id|filldir
)paren
suffix:semicolon
r_extern
r_int
id|irda_device_proc_read
c_func
(paren
r_char
op_star
id|buf
comma
r_char
op_star
op_star
id|start
comma
id|off_t
id|offset
comma
r_int
id|len
comma
r_int
id|unused
)paren
suffix:semicolon
r_extern
r_int
id|irlap_proc_read
c_func
(paren
r_char
op_star
id|buf
comma
r_char
op_star
op_star
id|start
comma
id|off_t
id|offset
comma
r_int
id|len
comma
r_int
id|unused
)paren
suffix:semicolon
r_extern
r_int
id|irlmp_proc_read
c_func
(paren
r_char
op_star
id|buf
comma
r_char
op_star
op_star
id|start
comma
id|off_t
id|offset
comma
r_int
id|len
comma
r_int
id|unused
)paren
suffix:semicolon
r_extern
r_int
id|irttp_proc_read
c_func
(paren
r_char
op_star
id|buf
comma
r_char
op_star
op_star
id|start
comma
id|off_t
id|offset
comma
r_int
id|len
comma
r_int
id|unused
)paren
suffix:semicolon
r_extern
r_int
id|irias_proc_read
c_func
(paren
r_char
op_star
id|buf
comma
r_char
op_star
op_star
id|start
comma
id|off_t
id|offset
comma
r_int
id|len
comma
r_int
id|unused
)paren
suffix:semicolon
r_static
r_int
id|proc_discovery_read
c_func
(paren
r_char
op_star
id|buf
comma
r_char
op_star
op_star
id|start
comma
id|off_t
id|offset
comma
r_int
id|len
comma
r_int
id|unused
)paren
suffix:semicolon
multiline_comment|/* int proc_irda_readdir(struct inode *inode, struct file *filp, void *dirent,  */
multiline_comment|/* &t;&t;      filldir_t filldir); */
DECL|enum|irda_directory_inos
r_enum
id|irda_directory_inos
(brace
DECL|enumerator|PROC_IRDA_LAP
id|PROC_IRDA_LAP
op_assign
l_int|1
comma
DECL|enumerator|PROC_IRDA_LMP
id|PROC_IRDA_LMP
comma
DECL|enumerator|PROC_IRDA_TTP
id|PROC_IRDA_TTP
comma
DECL|enumerator|PROC_IRDA_LPT
id|PROC_IRDA_LPT
comma
DECL|enumerator|PROC_IRDA_COMM
id|PROC_IRDA_COMM
comma
DECL|enumerator|PROC_IRDA_IRDA_DEVICE
id|PROC_IRDA_IRDA_DEVICE
comma
DECL|enumerator|PROC_IRDA_IRIAS
id|PROC_IRDA_IRIAS
)brace
suffix:semicolon
DECL|variable|proc_irda_dir_operations
r_static
r_struct
id|file_operations
id|proc_irda_dir_operations
op_assign
(brace
l_int|NULL
comma
multiline_comment|/* lseek - default */
l_int|NULL
comma
multiline_comment|/* read - bad */
l_int|NULL
comma
multiline_comment|/* write - bad */
id|proc_irda_readdir
comma
multiline_comment|/* readdir */
l_int|NULL
comma
multiline_comment|/* select - default */
l_int|NULL
comma
multiline_comment|/* ioctl - default */
l_int|NULL
comma
multiline_comment|/* mmap */
l_int|NULL
comma
multiline_comment|/* no special open code */
l_int|NULL
comma
multiline_comment|/* no special release code */
l_int|NULL
multiline_comment|/* can&squot;t fsync */
)brace
suffix:semicolon
multiline_comment|/*&n; * proc directories can do almost nothing..&n; */
DECL|variable|proc_irda_dir_inode_operations
r_struct
id|inode_operations
id|proc_irda_dir_inode_operations
op_assign
(brace
op_amp
id|proc_irda_dir_operations
comma
multiline_comment|/* default net directory file-ops */
l_int|NULL
comma
multiline_comment|/* create */
id|proc_irda_21x_lookup
comma
l_int|NULL
comma
multiline_comment|/* link */
l_int|NULL
comma
multiline_comment|/* unlink */
l_int|NULL
comma
multiline_comment|/* symlink */
l_int|NULL
comma
multiline_comment|/* mkdir */
l_int|NULL
comma
multiline_comment|/* rmdir */
l_int|NULL
comma
multiline_comment|/* mknod */
l_int|NULL
comma
multiline_comment|/* rename */
l_int|NULL
comma
multiline_comment|/* readlink */
l_int|NULL
comma
multiline_comment|/* follow_link */
l_int|NULL
comma
multiline_comment|/* readpage */
l_int|NULL
comma
multiline_comment|/* writepage */
l_int|NULL
comma
multiline_comment|/* bmap */
l_int|NULL
comma
multiline_comment|/* truncate */
l_int|NULL
multiline_comment|/* permission */
)brace
suffix:semicolon
DECL|variable|proc_irda
r_struct
id|proc_dir_entry
id|proc_irda
op_assign
(brace
l_int|0
comma
l_int|4
comma
l_string|&quot;irda&quot;
comma
id|S_IFDIR
op_or
id|S_IRUGO
op_or
id|S_IXUGO
comma
l_int|2
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
op_amp
id|proc_irda_dir_inode_operations
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
)brace
suffix:semicolon
macro_line|#if 0 
r_struct
id|proc_dir_entry
id|proc_lpt
op_assign
(brace
l_int|0
comma
l_int|3
comma
l_string|&quot;lpt&quot;
comma
id|S_IFREG
op_or
id|S_IRUGO
comma
l_int|1
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|NULL
multiline_comment|/* ops -- default to array */
comma
op_amp
id|irlpt_proc_read
multiline_comment|/* get_info */
comma
)brace
suffix:semicolon
macro_line|#endif
DECL|variable|proc_discovery
r_struct
id|proc_dir_entry
id|proc_discovery
op_assign
(brace
l_int|0
comma
l_int|9
comma
l_string|&quot;discovery&quot;
comma
id|S_IFREG
op_or
id|S_IRUGO
comma
l_int|1
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|NULL
multiline_comment|/* ops -- default to array */
comma
op_amp
id|proc_discovery_read
multiline_comment|/* get_info */
comma
)brace
suffix:semicolon
DECL|variable|proc_irda_device
r_struct
id|proc_dir_entry
id|proc_irda_device
op_assign
(brace
l_int|0
comma
l_int|11
comma
l_string|&quot;irda_device&quot;
comma
id|S_IFREG
op_or
id|S_IRUGO
comma
l_int|1
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|NULL
comma
op_amp
id|irda_device_proc_read
comma
)brace
suffix:semicolon
DECL|variable|proc_ttp
r_struct
id|proc_dir_entry
id|proc_ttp
op_assign
(brace
l_int|0
comma
l_int|5
comma
l_string|&quot;irttp&quot;
comma
id|S_IFREG
op_or
id|S_IRUGO
comma
l_int|1
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|NULL
multiline_comment|/* ops -- default to array */
comma
op_amp
id|irttp_proc_read
multiline_comment|/* get_info */
comma
)brace
suffix:semicolon
DECL|variable|proc_lmp
r_struct
id|proc_dir_entry
id|proc_lmp
op_assign
(brace
l_int|0
comma
l_int|5
comma
l_string|&quot;irlmp&quot;
comma
id|S_IFREG
op_or
id|S_IRUGO
comma
l_int|1
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|NULL
multiline_comment|/* ops -- default to array */
comma
op_amp
id|irlmp_proc_read
multiline_comment|/* get_info */
comma
)brace
suffix:semicolon
DECL|variable|proc_lap
r_struct
id|proc_dir_entry
id|proc_lap
op_assign
(brace
l_int|0
comma
l_int|5
comma
l_string|&quot;irlap&quot;
comma
id|S_IFREG
op_or
id|S_IRUGO
comma
l_int|1
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|NULL
multiline_comment|/* ops -- default to array */
comma
op_amp
id|irlap_proc_read
multiline_comment|/* get_info */
comma
)brace
suffix:semicolon
DECL|variable|proc_ias
r_struct
id|proc_dir_entry
id|proc_ias
op_assign
(brace
l_int|0
comma
l_int|5
comma
l_string|&quot;irias&quot;
comma
id|S_IFREG
op_or
id|S_IRUGO
comma
l_int|1
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|NULL
multiline_comment|/* ops -- default to array */
comma
op_amp
id|irias_proc_read
multiline_comment|/* get_info */
comma
)brace
suffix:semicolon
multiline_comment|/*&n; * Function proc_delete_dentry (dentry)&n; *&n; *    Copy of proc/root.c because this function is invisible to the irda&n; *    module&n; * &n; */
DECL|function|proc_delete_dentry
r_static
r_void
id|proc_delete_dentry
c_func
(paren
r_struct
id|dentry
op_star
id|dentry
)paren
(brace
id|d_drop
c_func
(paren
id|dentry
)paren
suffix:semicolon
)brace
DECL|variable|proc_dentry_operations
r_static
r_struct
id|dentry_operations
id|proc_dentry_operations
op_assign
(brace
l_int|NULL
comma
multiline_comment|/* revalidate */
l_int|NULL
comma
multiline_comment|/* d_hash */
l_int|NULL
comma
multiline_comment|/* d_compare */
id|proc_delete_dentry
multiline_comment|/* d_delete(struct dentry *) */
)brace
suffix:semicolon
multiline_comment|/*&n; * Function irda_proc_register (void)&n; *&n; *    Register irda entry in /proc file system&n; *&n; */
DECL|function|irda_proc_register
r_void
id|irda_proc_register
c_func
(paren
r_void
)paren
(brace
id|proc_net_register
c_func
(paren
op_amp
id|proc_irda
)paren
suffix:semicolon
id|proc_register
c_func
(paren
op_amp
id|proc_irda
comma
op_amp
id|proc_lap
)paren
suffix:semicolon
id|proc_register
c_func
(paren
op_amp
id|proc_irda
comma
op_amp
id|proc_lmp
)paren
suffix:semicolon
id|proc_register
c_func
(paren
op_amp
id|proc_irda
comma
op_amp
id|proc_ttp
)paren
suffix:semicolon
id|proc_register
c_func
(paren
op_amp
id|proc_irda
comma
op_amp
id|proc_ias
)paren
suffix:semicolon
id|proc_register
c_func
(paren
op_amp
id|proc_irda
comma
op_amp
id|proc_irda_device
)paren
suffix:semicolon
id|proc_register
c_func
(paren
op_amp
id|proc_irda
comma
op_amp
id|proc_discovery
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Function irda_proc_unregister (void)&n; *&n; *    Unregister irda entry in /proc file system&n; *&n; */
DECL|function|irda_proc_unregister
r_void
id|irda_proc_unregister
c_func
(paren
r_void
)paren
(brace
id|proc_unregister
c_func
(paren
op_amp
id|proc_irda
comma
id|proc_discovery.low_ino
)paren
suffix:semicolon
id|proc_unregister
c_func
(paren
op_amp
id|proc_irda
comma
id|proc_irda_device.low_ino
)paren
suffix:semicolon
id|proc_unregister
c_func
(paren
op_amp
id|proc_irda
comma
id|proc_ias.low_ino
)paren
suffix:semicolon
id|proc_unregister
c_func
(paren
op_amp
id|proc_irda
comma
id|proc_ttp.low_ino
)paren
suffix:semicolon
id|proc_unregister
c_func
(paren
op_amp
id|proc_irda
comma
id|proc_lmp.low_ino
)paren
suffix:semicolon
id|proc_unregister
c_func
(paren
op_amp
id|proc_irda
comma
id|proc_lap.low_ino
)paren
suffix:semicolon
id|proc_unregister
c_func
(paren
id|proc_net
comma
id|proc_irda.low_ino
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Function proc_irda_21x_lookup (dir, dentry)&n; *&n; *    This is a copy of proc_lookup from the linux-2.1.x &n; *&n; */
DECL|function|proc_irda_21x_lookup
r_int
id|proc_irda_21x_lookup
c_func
(paren
r_struct
id|inode
op_star
id|dir
comma
r_struct
id|dentry
op_star
id|dentry
)paren
(brace
r_struct
id|inode
op_star
id|inode
suffix:semicolon
r_struct
id|proc_dir_entry
op_star
id|de
suffix:semicolon
r_int
id|error
suffix:semicolon
id|error
op_assign
op_minus
id|ENOTDIR
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dir
op_logical_or
op_logical_neg
id|S_ISDIR
c_func
(paren
id|dir-&gt;i_mode
)paren
)paren
r_goto
id|out
suffix:semicolon
id|error
op_assign
op_minus
id|ENOENT
suffix:semicolon
id|inode
op_assign
l_int|NULL
suffix:semicolon
id|de
op_assign
(paren
r_struct
id|proc_dir_entry
op_star
)paren
id|dir-&gt;u.generic_ip
suffix:semicolon
r_if
c_cond
(paren
id|de
)paren
(brace
r_for
c_loop
(paren
id|de
op_assign
id|de-&gt;subdir
suffix:semicolon
id|de
suffix:semicolon
id|de
op_assign
id|de-&gt;next
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|de
op_logical_or
op_logical_neg
id|de-&gt;low_ino
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|de-&gt;namelen
op_ne
id|dentry-&gt;d_name.len
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|memcmp
c_func
(paren
id|dentry-&gt;d_name.name
comma
id|de-&gt;name
comma
id|de-&gt;namelen
)paren
)paren
(brace
r_int
id|ino
op_assign
id|de-&gt;low_ino
op_or
(paren
id|dir-&gt;i_ino
op_amp
op_complement
(paren
l_int|0xffff
)paren
)paren
suffix:semicolon
id|error
op_assign
op_minus
id|EINVAL
suffix:semicolon
id|inode
op_assign
id|proc_get_inode
c_func
(paren
id|dir-&gt;i_sb
comma
id|ino
comma
id|de
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
)brace
r_if
c_cond
(paren
id|inode
)paren
(brace
id|dentry-&gt;d_op
op_assign
op_amp
id|proc_dentry_operations
suffix:semicolon
id|d_add
c_func
(paren
id|dentry
comma
id|inode
)paren
suffix:semicolon
id|error
op_assign
l_int|0
suffix:semicolon
)brace
id|out
suffix:colon
r_return
id|error
suffix:semicolon
)brace
multiline_comment|/*&n; * Function proc_irda_readdir (filp, dirent, filldir)&n; *&n; *    This is a copy from linux/fs/proc because the function is invisible&n; *    to the irda module&n; * &n; */
DECL|function|proc_irda_readdir
r_static
r_int
id|proc_irda_readdir
c_func
(paren
r_struct
id|file
op_star
id|filp
comma
r_void
op_star
id|dirent
comma
id|filldir_t
id|filldir
)paren
(brace
r_struct
id|proc_dir_entry
op_star
id|de
suffix:semicolon
r_int
r_int
id|ino
suffix:semicolon
r_int
id|i
suffix:semicolon
r_struct
id|inode
op_star
id|inode
op_assign
id|filp-&gt;f_dentry-&gt;d_inode
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|inode
op_logical_or
op_logical_neg
id|S_ISDIR
c_func
(paren
id|inode-&gt;i_mode
)paren
)paren
r_return
op_minus
id|ENOTDIR
suffix:semicolon
id|ino
op_assign
id|inode-&gt;i_ino
suffix:semicolon
id|de
op_assign
(paren
r_struct
id|proc_dir_entry
op_star
)paren
id|inode-&gt;u.generic_ip
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|de
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|i
op_assign
id|filp-&gt;f_pos
suffix:semicolon
r_switch
c_cond
(paren
id|i
)paren
(brace
r_case
l_int|0
suffix:colon
r_if
c_cond
(paren
id|filldir
c_func
(paren
id|dirent
comma
l_string|&quot;.&quot;
comma
l_int|1
comma
id|i
comma
id|ino
)paren
OL
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
id|i
op_increment
suffix:semicolon
id|filp-&gt;f_pos
op_increment
suffix:semicolon
multiline_comment|/* fall through */
r_case
l_int|1
suffix:colon
r_if
c_cond
(paren
id|filldir
c_func
(paren
id|dirent
comma
l_string|&quot;..&quot;
comma
l_int|2
comma
id|i
comma
id|de-&gt;parent-&gt;low_ino
)paren
OL
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
id|i
op_increment
suffix:semicolon
id|filp-&gt;f_pos
op_increment
suffix:semicolon
multiline_comment|/* fall through */
r_default
suffix:colon
id|ino
op_and_assign
op_complement
l_int|0xffff
suffix:semicolon
id|de
op_assign
id|de-&gt;subdir
suffix:semicolon
id|i
op_sub_assign
l_int|2
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
suffix:semicolon
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|de
)paren
r_return
l_int|1
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|i
)paren
r_break
suffix:semicolon
id|de
op_assign
id|de-&gt;next
suffix:semicolon
id|i
op_decrement
suffix:semicolon
)brace
r_do
(brace
r_if
c_cond
(paren
id|filldir
c_func
(paren
id|dirent
comma
id|de-&gt;name
comma
id|de-&gt;namelen
comma
id|filp-&gt;f_pos
comma
id|ino
op_or
id|de-&gt;low_ino
)paren
OL
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
id|filp-&gt;f_pos
op_increment
suffix:semicolon
id|de
op_assign
id|de-&gt;next
suffix:semicolon
)brace
r_while
c_loop
(paren
id|de
)paren
suffix:semicolon
)brace
r_return
l_int|1
suffix:semicolon
)brace
multiline_comment|/*&n; * Function proc_discovery_read (buf, start, offset, len, unused)&n; *&n; *    Print discovery information in /proc file system&n; *&n; */
DECL|function|proc_discovery_read
r_int
id|proc_discovery_read
c_func
(paren
r_char
op_star
id|buf
comma
r_char
op_star
op_star
id|start
comma
id|off_t
id|offset
comma
r_int
id|len
comma
r_int
id|unused
)paren
(brace
id|DISCOVERY
op_star
id|discovery
suffix:semicolon
r_struct
id|lap_cb
op_star
id|lap
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|irlmp
)paren
r_return
id|len
suffix:semicolon
id|len
op_assign
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;IrLMP: Discovery log:&bslash;n&bslash;n&quot;
)paren
suffix:semicolon
id|save_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
id|cli
c_func
(paren
)paren
suffix:semicolon
id|lap
op_assign
(paren
r_struct
id|lap_cb
op_star
)paren
id|hashbin_get_first
c_func
(paren
id|irlmp-&gt;links
)paren
suffix:semicolon
r_while
c_loop
(paren
id|lap
op_ne
l_int|NULL
)paren
(brace
id|ASSERT
c_func
(paren
id|lap-&gt;magic
op_eq
id|LMP_LAP_MAGIC
comma
r_return
l_int|0
suffix:semicolon
)paren
suffix:semicolon
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buf
op_plus
id|len
comma
l_string|&quot;Link saddr=0x%08x&bslash;n&quot;
comma
id|lap-&gt;saddr
)paren
suffix:semicolon
id|discovery
op_assign
(paren
id|DISCOVERY
op_star
)paren
id|hashbin_get_first
c_func
(paren
id|lap-&gt;cachelog
)paren
suffix:semicolon
r_while
c_loop
(paren
id|discovery
op_ne
l_int|NULL
)paren
(brace
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buf
op_plus
id|len
comma
l_string|&quot;  name: %s,&quot;
comma
id|discovery-&gt;info
)paren
suffix:semicolon
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buf
op_plus
id|len
comma
l_string|&quot; hint: &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|discovery-&gt;hint
(braket
l_int|0
)braket
op_amp
id|HINT_PNP
)paren
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buf
op_plus
id|len
comma
l_string|&quot;PnP Compatible &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|discovery-&gt;hint
(braket
l_int|0
)braket
op_amp
id|HINT_PDA
)paren
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buf
op_plus
id|len
comma
l_string|&quot;PDA/Palmtop &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|discovery-&gt;hint
(braket
l_int|0
)braket
op_amp
id|HINT_COMPUTER
)paren
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buf
op_plus
id|len
comma
l_string|&quot;Computer &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|discovery-&gt;hint
(braket
l_int|0
)braket
op_amp
id|HINT_PRINTER
)paren
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buf
op_plus
id|len
comma
l_string|&quot;Printer &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|discovery-&gt;hint
(braket
l_int|0
)braket
op_amp
id|HINT_MODEM
)paren
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buf
op_plus
id|len
comma
l_string|&quot;Modem &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|discovery-&gt;hint
(braket
l_int|0
)braket
op_amp
id|HINT_FAX
)paren
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buf
op_plus
id|len
comma
l_string|&quot;Fax &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|discovery-&gt;hint
(braket
l_int|0
)braket
op_amp
id|HINT_LAN
)paren
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buf
op_plus
id|len
comma
l_string|&quot;LAN Access&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|discovery-&gt;hint
(braket
l_int|1
)braket
op_amp
id|HINT_TELEPHONY
)paren
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buf
op_plus
id|len
comma
l_string|&quot;Telephony &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|discovery-&gt;hint
(braket
l_int|1
)braket
op_amp
id|HINT_FILE_SERVER
)paren
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buf
op_plus
id|len
comma
l_string|&quot;File Server &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|discovery-&gt;hint
(braket
l_int|1
)braket
op_amp
id|HINT_COMM
)paren
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buf
op_plus
id|len
comma
l_string|&quot;IrCOMM &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|discovery-&gt;hint
(braket
l_int|1
)braket
op_amp
id|HINT_OBEX
)paren
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buf
op_plus
id|len
comma
l_string|&quot;IrOBEX &quot;
)paren
suffix:semicolon
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buf
op_plus
id|len
comma
l_string|&quot;, daddr: 0x%08x&bslash;n&quot;
comma
id|discovery-&gt;daddr
)paren
suffix:semicolon
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buf
op_plus
id|len
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|discovery
op_assign
(paren
id|DISCOVERY
op_star
)paren
id|hashbin_get_next
c_func
(paren
id|lap-&gt;cachelog
)paren
suffix:semicolon
)brace
id|lap
op_assign
(paren
r_struct
id|lap_cb
op_star
)paren
id|hashbin_get_next
c_func
(paren
id|irlmp-&gt;links
)paren
suffix:semicolon
)brace
id|restore_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
r_return
id|len
suffix:semicolon
)brace
eof
