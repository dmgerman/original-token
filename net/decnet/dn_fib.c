multiline_comment|/*&n; * DECnet       An implementation of the DECnet protocol suite for the LINUX&n; *              operating system.  DECnet is implemented using the  BSD Socket&n; *              interface as the means of communication with the user level.&n; *&n; *              DECnet Routing Forwarding Information Base&n; *&n; * Author:      Steve Whitehouse &lt;SteveW@ACM.org&gt;&n; *&n; *&n; * Changes:&n; *              Alexey Kuznetsov : SMP locking changes&n; *&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/net.h&gt;
macro_line|#include &lt;linux/socket.h&gt;
macro_line|#include &lt;linux/sockios.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/skbuff.h&gt;
macro_line|#include &lt;linux/netlink.h&gt;
macro_line|#include &lt;linux/rtnetlink.h&gt;
macro_line|#include &lt;linux/proc_fs.h&gt;
macro_line|#include &lt;linux/netdevice.h&gt;
macro_line|#include &lt;linux/timer.h&gt;
macro_line|#include &lt;linux/spinlock.h&gt;
macro_line|#include &lt;asm/atomic.h&gt;
macro_line|#include &lt;asm/uaccess.h&gt;
macro_line|#include &lt;net/neighbour.h&gt;
macro_line|#include &lt;net/dst.h&gt;
macro_line|#include &lt;net/dn.h&gt;
macro_line|#include &lt;net/dn_fib.h&gt;
macro_line|#include &lt;net/dn_neigh.h&gt;
macro_line|#include &lt;net/dn_dev.h&gt;
multiline_comment|/*&n; * N.B. Some of the functions here should really be inlines, but&n; * I&squot;ll sort out that when its all working properly, for now the&n; * stack frames will be useful for debugging.&n; */
DECL|macro|DN_NUM_TABLES
mdefine_line|#define DN_NUM_TABLES 255
DECL|macro|DN_MIN_TABLE
mdefine_line|#define DN_MIN_TABLE  1
DECL|macro|DN_L1_TABLE
mdefine_line|#define DN_L1_TABLE 1
DECL|macro|DN_L2_TABLE
mdefine_line|#define DN_L2_TABLE 2
macro_line|#ifdef CONFIG_RTNETLINK
r_static
r_int
id|dn_fib_table_dump
c_func
(paren
r_struct
id|dn_fib_table
op_star
id|t
comma
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|netlink_callback
op_star
id|cb
)paren
suffix:semicolon
r_static
r_void
id|dn_rtmsg_fib
c_func
(paren
r_int
id|event
comma
r_int
id|table
comma
r_struct
id|dn_fib_action
op_star
id|fa
comma
r_struct
id|nlmsghdr
op_star
id|nlh
comma
r_struct
id|netlink_skb_parms
op_star
id|req
)paren
suffix:semicolon
r_extern
r_int
id|dn_cache_dump
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|netlink_callback
op_star
id|cb
)paren
suffix:semicolon
macro_line|#endif /* CONFIG_RTNETLINK */
r_static
r_void
id|dn_fib_del_tree
c_func
(paren
r_struct
id|dn_fib_table
op_star
id|t
)paren
suffix:semicolon
DECL|variable|dn_fib_tables
r_static
r_struct
id|dn_fib_table
op_star
id|dn_fib_tables
(braket
id|DN_NUM_TABLES
op_plus
l_int|1
)braket
suffix:semicolon
DECL|variable|dn_fib_allocs
r_static
r_int
id|dn_fib_allocs
op_assign
l_int|0
suffix:semicolon
DECL|variable|dn_fib_actions
r_static
r_int
id|dn_fib_actions
op_assign
l_int|0
suffix:semicolon
DECL|function|dn_fib_alloc
r_static
r_struct
id|dn_fib_node
op_star
id|dn_fib_alloc
c_func
(paren
r_void
)paren
(brace
r_struct
id|dn_fib_node
op_star
id|fn
suffix:semicolon
id|fn
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|dn_fib_node
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fn
)paren
(brace
id|memset
c_func
(paren
id|fn
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|dn_fib_node
)paren
)paren
suffix:semicolon
id|dn_fib_allocs
op_increment
suffix:semicolon
)brace
r_return
id|fn
suffix:semicolon
)brace
DECL|function|dn_fib_free
r_static
id|__inline__
r_void
id|dn_fib_free
c_func
(paren
r_struct
id|dn_fib_node
op_star
id|fn
)paren
(brace
id|kfree_s
c_func
(paren
id|fn
comma
r_sizeof
(paren
r_struct
id|dn_fib_node
)paren
)paren
suffix:semicolon
id|dn_fib_allocs
op_decrement
suffix:semicolon
)brace
DECL|function|dn_fib_new_action
r_static
r_struct
id|dn_fib_action
op_star
id|dn_fib_new_action
c_func
(paren
r_void
)paren
(brace
r_struct
id|dn_fib_action
op_star
id|fa
suffix:semicolon
id|fa
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|dn_fib_action
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fa
)paren
(brace
id|memset
c_func
(paren
id|fa
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|dn_fib_action
)paren
)paren
suffix:semicolon
id|dn_fib_actions
op_increment
suffix:semicolon
)brace
r_return
id|fa
suffix:semicolon
)brace
DECL|function|dn_fib_del_action
r_static
id|__inline__
r_void
id|dn_fib_del_action
c_func
(paren
r_struct
id|dn_fib_action
op_star
id|fa
)paren
(brace
r_if
c_cond
(paren
(paren
id|fa-&gt;fa_type
op_eq
id|RTN_UNICAST
)paren
op_logical_and
id|fa-&gt;fa_neigh
)paren
id|neigh_release
c_func
(paren
id|fa-&gt;fa_neigh
)paren
suffix:semicolon
id|kfree_s
c_func
(paren
id|fa
comma
r_sizeof
(paren
r_struct
id|dn_fib_action
)paren
)paren
suffix:semicolon
id|dn_fib_actions
op_decrement
suffix:semicolon
)brace
DECL|function|dn_fib_follow
r_static
r_struct
id|dn_fib_node
op_star
id|dn_fib_follow
c_func
(paren
r_struct
id|dn_fib_node
op_star
id|fn
comma
id|dn_address
id|key
)paren
(brace
r_while
c_loop
(paren
id|fn-&gt;fn_action
op_eq
l_int|NULL
)paren
(brace
id|fn
op_assign
id|DN_FIB_NEXT
c_func
(paren
id|fn
comma
id|key
)paren
suffix:semicolon
)brace
r_return
id|fn
suffix:semicolon
)brace
DECL|function|dn_fib_follow1
r_static
r_struct
id|dn_fib_node
op_star
id|dn_fib_follow1
c_func
(paren
r_struct
id|dn_fib_node
op_star
id|fn
comma
id|dn_address
id|key
)paren
(brace
r_while
c_loop
(paren
(paren
id|fn-&gt;fn_action
op_eq
l_int|NULL
)paren
op_logical_and
(paren
(paren
(paren
id|key
op_xor
id|fn-&gt;fn_key
)paren
op_rshift
id|fn-&gt;fn_shift
)paren
op_eq
l_int|0
)paren
)paren
(brace
id|fn
op_assign
id|DN_FIB_NEXT
c_func
(paren
id|fn
comma
id|key
)paren
suffix:semicolon
)brace
r_return
id|fn
suffix:semicolon
)brace
DECL|function|dn_fib_table_insert1
r_static
r_int
id|dn_fib_table_insert1
c_func
(paren
r_struct
id|dn_fib_table
op_star
id|t
comma
r_struct
id|dn_fib_node
op_star
id|leaf
)paren
(brace
r_struct
id|dn_fib_node
op_star
id|fn
comma
op_star
id|fn1
comma
op_star
id|fn2
suffix:semicolon
r_int
id|shift
op_assign
op_minus
l_int|1
suffix:semicolon
id|dn_address
id|match
suffix:semicolon
id|dn_address
id|cmpmask
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|t-&gt;root
)paren
(brace
id|t-&gt;root
op_assign
id|leaf
suffix:semicolon
id|t-&gt;count
op_increment
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|fn1
op_assign
id|dn_fib_follow1
c_func
(paren
id|t-&gt;root
comma
id|leaf-&gt;fn_key
)paren
suffix:semicolon
id|fn2
op_assign
id|fn1-&gt;fn_up
suffix:semicolon
r_if
c_cond
(paren
id|fn1-&gt;fn_key
op_eq
id|leaf-&gt;fn_key
)paren
r_return
op_minus
id|EEXIST
suffix:semicolon
r_if
c_cond
(paren
(paren
id|fn
op_assign
id|dn_fib_alloc
c_func
(paren
)paren
)paren
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOBUFS
suffix:semicolon
id|fn-&gt;fn_key
op_assign
id|leaf-&gt;fn_key
suffix:semicolon
id|match
op_assign
id|fn1-&gt;fn_key
op_xor
id|fn-&gt;fn_key
suffix:semicolon
r_while
c_loop
(paren
id|match
)paren
(brace
id|match
op_rshift_assign
l_int|1
suffix:semicolon
id|shift
op_increment
suffix:semicolon
)brace
id|cmpmask
op_lshift_assign
id|shift
suffix:semicolon
id|fn-&gt;fn_cmpmask
op_assign
id|cmpmask
suffix:semicolon
id|fn-&gt;fn_shift
op_assign
id|shift
suffix:semicolon
r_if
c_cond
(paren
id|fn2
)paren
(brace
id|DN_FIB_NEXT
c_func
(paren
id|fn2
comma
id|fn-&gt;fn_key
)paren
op_assign
id|fn
suffix:semicolon
)brace
r_else
(brace
id|t-&gt;root
op_assign
id|fn
suffix:semicolon
)brace
id|t-&gt;count
op_increment
suffix:semicolon
id|fn-&gt;fn_up
op_assign
id|fn2
suffix:semicolon
id|DN_FIB_NEXT
c_func
(paren
id|fn
comma
id|fn1-&gt;fn_key
)paren
op_assign
id|fn1
suffix:semicolon
id|DN_FIB_NEXT
c_func
(paren
id|fn
comma
id|leaf-&gt;fn_key
)paren
op_assign
id|leaf
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dn_maskcmp
r_static
id|__inline__
r_int
id|dn_maskcmp
c_func
(paren
id|dn_address
id|m1
comma
id|dn_address
id|m2
)paren
(brace
r_int
id|cmp
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|m1
op_logical_or
id|m2
)paren
(brace
r_if
c_cond
(paren
id|m1
op_amp
l_int|0x8000
)paren
id|cmp
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|m2
op_amp
l_int|0x8000
)paren
id|cmp
op_decrement
suffix:semicolon
id|m1
op_lshift_assign
l_int|1
suffix:semicolon
id|m2
op_lshift_assign
l_int|1
suffix:semicolon
)brace
r_return
id|cmp
suffix:semicolon
)brace
DECL|function|dn_fib_table_insert
r_static
r_int
id|dn_fib_table_insert
c_func
(paren
r_struct
id|dn_fib_table
op_star
id|t
comma
r_struct
id|dn_fib_action
op_star
id|fa
)paren
(brace
r_struct
id|dn_fib_node
op_star
id|fn
suffix:semicolon
r_struct
id|dn_fib_action
op_star
op_star
id|fap
suffix:semicolon
r_int
id|err
suffix:semicolon
r_int
id|cmp
suffix:semicolon
r_if
c_cond
(paren
id|t-&gt;root
op_logical_and
(paren
(paren
id|fn
op_assign
id|dn_fib_follow
c_func
(paren
id|t-&gt;root
comma
id|fa-&gt;fa_key
)paren
)paren
op_ne
l_int|NULL
)paren
op_logical_and
(paren
id|fn-&gt;fn_key
op_eq
id|fa-&gt;fa_key
)paren
)paren
r_goto
id|add_action
suffix:semicolon
r_if
c_cond
(paren
(paren
id|fn
op_assign
id|dn_fib_alloc
c_func
(paren
)paren
)paren
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOBUFS
suffix:semicolon
id|fn-&gt;fn_key
op_assign
id|fa-&gt;fa_key
suffix:semicolon
id|fn-&gt;fn_action
op_assign
id|fa
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|dn_fib_table_insert1
c_func
(paren
id|t
comma
id|fn
)paren
)paren
OL
l_int|0
)paren
id|dn_fib_free
c_func
(paren
id|fn
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_RTNETLINK
r_if
c_cond
(paren
op_logical_neg
id|err
)paren
id|dn_rtmsg_fib
c_func
(paren
id|RTM_NEWROUTE
comma
id|t-&gt;n
comma
id|fa
comma
l_int|NULL
comma
l_int|NULL
)paren
suffix:semicolon
macro_line|#endif /* CONFIG_RTNETLINK */
r_return
id|err
suffix:semicolon
id|add_action
suffix:colon
id|fap
op_assign
op_amp
id|fn-&gt;fn_action
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
op_star
id|fap
suffix:semicolon
id|fap
op_assign
op_amp
(paren
(paren
op_star
id|fap
)paren
op_member_access_from_pointer
id|fa_next
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
id|cmp
op_assign
id|dn_maskcmp
c_func
(paren
(paren
op_star
id|fap
)paren
op_member_access_from_pointer
id|fa_mask
comma
id|fa-&gt;fa_mask
)paren
)paren
OG
l_int|0
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|cmp
OL
l_int|0
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
(paren
op_star
id|fap
)paren
op_member_access_from_pointer
id|fa_cost
OG
id|fa-&gt;fa_cost
)paren
r_break
suffix:semicolon
)brace
id|fa-&gt;fa_next
op_assign
op_star
id|fap
suffix:semicolon
op_star
id|fap
op_assign
id|fa
suffix:semicolon
macro_line|#ifdef CONFIG_RTNETLINK
id|dn_rtmsg_fib
c_func
(paren
id|RTM_NEWROUTE
comma
id|t-&gt;n
comma
id|fa
comma
l_int|NULL
comma
l_int|NULL
)paren
suffix:semicolon
macro_line|#endif /* CONFIG_RTNETLINK */
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dn_fib_table_delete1
r_static
r_int
id|dn_fib_table_delete1
c_func
(paren
r_struct
id|dn_fib_table
op_star
id|t
comma
r_struct
id|dn_fib_node
op_star
id|fn
)paren
(brace
r_struct
id|dn_fib_node
op_star
id|fn1
op_assign
id|fn-&gt;fn_up
suffix:semicolon
r_struct
id|dn_fib_node
op_star
id|fn2
suffix:semicolon
r_struct
id|dn_fib_node
op_star
id|fn3
suffix:semicolon
r_if
c_cond
(paren
id|fn
op_eq
id|t-&gt;root
)paren
(brace
id|t-&gt;root
op_assign
l_int|NULL
suffix:semicolon
id|t-&gt;count
op_decrement
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|fn1
op_eq
l_int|NULL
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|fn2
op_assign
id|fn1-&gt;fn_up
suffix:semicolon
id|fn3
op_assign
id|DN_FIB_NEXT
c_func
(paren
id|fn1
comma
op_complement
id|fn-&gt;fn_key
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fn2
)paren
id|DN_FIB_NEXT
c_func
(paren
id|fn2
comma
id|fn1-&gt;fn_key
)paren
op_assign
id|fn3
suffix:semicolon
r_else
id|t-&gt;root
op_assign
id|fn3
suffix:semicolon
id|fn3-&gt;fn_up
op_assign
id|fn2
suffix:semicolon
id|dn_fib_free
c_func
(paren
id|fn1
)paren
suffix:semicolon
id|t-&gt;count
op_decrement
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dn_fib_table_delete
r_static
r_int
id|dn_fib_table_delete
c_func
(paren
r_struct
id|dn_fib_table
op_star
id|t
comma
r_struct
id|dn_fib_action
op_star
id|fa
)paren
(brace
r_struct
id|dn_fib_res
id|res
suffix:semicolon
r_struct
id|dn_fib_node
op_star
id|fn
suffix:semicolon
r_struct
id|dn_fib_action
op_star
op_star
id|fap
comma
op_star
id|old
suffix:semicolon
r_int
id|err
suffix:semicolon
id|res.res_type
op_assign
l_int|0
suffix:semicolon
id|res.res_addr
op_assign
id|fa-&gt;fa_key
suffix:semicolon
id|res.res_mask
op_assign
id|fa-&gt;fa_mask
suffix:semicolon
id|res.res_ifindex
op_assign
id|fa-&gt;fa_ifindex
suffix:semicolon
id|res.res_proto
op_assign
id|fa-&gt;fa_proto
suffix:semicolon
id|res.res_cost
op_assign
id|fa-&gt;fa_cost
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|t
op_member_access_from_pointer
id|lookup
c_func
(paren
id|t
comma
op_amp
id|res
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|fn
op_assign
id|res.res_fn
suffix:semicolon
id|fap
op_assign
op_amp
id|fn-&gt;fn_action
suffix:semicolon
r_while
c_loop
(paren
(paren
op_star
id|fap
)paren
op_ne
id|res.res_fa
)paren
(brace
id|fap
op_assign
op_amp
(paren
(paren
op_star
id|fap
)paren
op_member_access_from_pointer
id|fa_next
)paren
suffix:semicolon
)brace
id|old
op_assign
op_star
id|fap
suffix:semicolon
op_star
id|fap
op_assign
(paren
op_star
id|fap
)paren
op_member_access_from_pointer
id|fa_next
suffix:semicolon
r_if
c_cond
(paren
id|fn-&gt;fn_action
op_eq
l_int|NULL
)paren
id|dn_fib_table_delete1
c_func
(paren
id|t
comma
id|fn
)paren
suffix:semicolon
r_if
c_cond
(paren
id|t-&gt;root
op_eq
l_int|NULL
)paren
id|dn_fib_del_tree
c_func
(paren
id|t
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_RTNETLINK
id|dn_rtmsg_fib
c_func
(paren
id|RTM_DELROUTE
comma
id|t-&gt;n
comma
id|old
comma
l_int|NULL
comma
l_int|NULL
)paren
suffix:semicolon
macro_line|#endif /* CONFIG_RTNETLINK */
id|dn_fib_del_action
c_func
(paren
id|old
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dn_fib_search
r_static
r_int
id|dn_fib_search
c_func
(paren
r_struct
id|dn_fib_node
op_star
id|fn
comma
r_struct
id|dn_fib_res
op_star
id|res
)paren
(brace
r_struct
id|dn_fib_action
op_star
id|fa
op_assign
id|fn-&gt;fn_action
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
id|fa
suffix:semicolon
id|fa
op_assign
id|fa-&gt;fa_next
)paren
(brace
r_if
c_cond
(paren
(paren
id|fa-&gt;fa_key
op_xor
id|res-&gt;res_addr
)paren
op_amp
id|fa-&gt;fa_mask
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|res-&gt;res_ifindex
op_logical_and
(paren
id|res-&gt;res_ifindex
op_ne
id|fa-&gt;fa_ifindex
)paren
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|res-&gt;res_mask
op_logical_and
(paren
id|res-&gt;res_mask
op_ne
id|fa-&gt;fa_mask
)paren
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|res-&gt;res_proto
op_logical_and
(paren
id|res-&gt;res_proto
op_ne
id|fa-&gt;fa_proto
)paren
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|res-&gt;res_cost
op_logical_and
(paren
id|res-&gt;res_cost
op_ne
id|fa-&gt;fa_cost
)paren
)paren
r_continue
suffix:semicolon
id|res-&gt;res_fn
op_assign
id|fn
suffix:semicolon
id|res-&gt;res_fa
op_assign
id|fa
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dn_fib_recurse
r_static
r_int
id|dn_fib_recurse
c_func
(paren
r_struct
id|dn_fib_node
op_star
id|fn
comma
r_struct
id|dn_fib_res
op_star
id|res
)paren
(brace
r_struct
id|dn_fib_node
op_star
id|fn1
suffix:semicolon
r_int
id|err
op_assign
op_minus
id|ENOENT
suffix:semicolon
id|fn1
op_assign
id|dn_fib_follow
c_func
(paren
id|fn
comma
id|res-&gt;res_addr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dn_fib_search
c_func
(paren
id|fn1
comma
id|res
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_while
c_loop
(paren
(paren
id|fn1
op_assign
id|fn1-&gt;fn_up
)paren
op_ne
id|fn
)paren
r_if
c_cond
(paren
(paren
id|err
op_assign
id|dn_fib_recurse
c_func
(paren
id|DN_FIB_NEXT
c_func
(paren
id|fn1
comma
op_complement
id|res-&gt;res_addr
)paren
comma
id|res
)paren
)paren
op_eq
l_int|0
)paren
r_break
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|dn_fib_table_lookup
r_static
r_int
id|dn_fib_table_lookup
c_func
(paren
r_struct
id|dn_fib_table
op_star
id|t
comma
r_struct
id|dn_fib_res
op_star
id|res
)paren
(brace
r_struct
id|dn_fib_node
op_star
id|fn
op_assign
id|t-&gt;root
suffix:semicolon
r_int
id|err
op_assign
op_minus
id|ENOENT
suffix:semicolon
r_if
c_cond
(paren
id|t-&gt;root
op_eq
l_int|NULL
)paren
r_return
id|err
suffix:semicolon
id|fn
op_assign
id|dn_fib_follow
c_func
(paren
id|t-&gt;root
comma
id|res-&gt;res_addr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dn_fib_search
c_func
(paren
id|fn
comma
id|res
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_while
c_loop
(paren
(paren
id|fn
op_assign
id|fn-&gt;fn_up
)paren
op_ne
l_int|NULL
)paren
r_if
c_cond
(paren
(paren
id|err
op_assign
id|dn_fib_recurse
c_func
(paren
id|DN_FIB_NEXT
c_func
(paren
id|fn
comma
op_complement
id|res-&gt;res_addr
)paren
comma
id|res
)paren
)paren
op_eq
l_int|0
)paren
r_break
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
DECL|function|dn_fib_table_walk_recurse
r_static
r_int
id|dn_fib_table_walk_recurse
c_func
(paren
r_struct
id|dn_fib_walker_t
op_star
id|fwt
comma
r_struct
id|dn_fib_node
op_star
id|fn
)paren
(brace
r_struct
id|dn_fib_table
op_star
id|t
op_assign
id|fwt-&gt;table
suffix:semicolon
r_if
c_cond
(paren
id|fn-&gt;fn_action
)paren
(brace
id|fwt
op_member_access_from_pointer
id|fxn
c_func
(paren
id|fwt
comma
id|fn
)paren
suffix:semicolon
)brace
r_else
(brace
id|dn_fib_table_walk_recurse
c_func
(paren
id|fwt
comma
id|t-&gt;root-&gt;fn_children
(braket
l_int|0
)braket
)paren
suffix:semicolon
id|dn_fib_table_walk_recurse
c_func
(paren
id|fwt
comma
id|t-&gt;root-&gt;fn_children
(braket
l_int|1
)braket
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dn_fib_table_walk
r_static
r_int
id|dn_fib_table_walk
c_func
(paren
r_struct
id|dn_fib_walker_t
op_star
id|fwt
)paren
(brace
r_struct
id|dn_fib_table
op_star
id|t
op_assign
id|fwt-&gt;table
suffix:semicolon
r_if
c_cond
(paren
id|t-&gt;root
op_ne
l_int|NULL
)paren
(brace
r_if
c_cond
(paren
id|t-&gt;root-&gt;fn_action
)paren
(brace
id|fwt
op_member_access_from_pointer
id|fxn
c_func
(paren
id|fwt
comma
id|t-&gt;root
)paren
suffix:semicolon
)brace
r_else
(brace
id|dn_fib_table_walk_recurse
c_func
(paren
id|fwt
comma
id|t-&gt;root-&gt;fn_children
(braket
l_int|0
)braket
)paren
suffix:semicolon
id|dn_fib_table_walk_recurse
c_func
(paren
id|fwt
comma
id|t-&gt;root-&gt;fn_children
(braket
l_int|1
)braket
)paren
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dn_fib_get_tree
r_static
r_struct
id|dn_fib_table
op_star
id|dn_fib_get_tree
c_func
(paren
r_int
id|n
comma
r_int
id|create
)paren
(brace
r_struct
id|dn_fib_table
op_star
id|t
suffix:semicolon
r_if
c_cond
(paren
id|n
OL
id|DN_MIN_TABLE
)paren
r_return
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
id|n
OG
id|DN_NUM_TABLES
)paren
r_return
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
id|dn_fib_tables
(braket
id|n
)braket
)paren
r_return
id|dn_fib_tables
(braket
id|n
)braket
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|create
)paren
r_return
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
(paren
id|t
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|dn_fib_table
)paren
comma
id|GFP_KERNEL
)paren
)paren
op_eq
l_int|NULL
)paren
r_return
l_int|NULL
suffix:semicolon
id|dn_fib_tables
(braket
id|n
)braket
op_assign
id|t
suffix:semicolon
id|memset
c_func
(paren
id|t
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|dn_fib_table
)paren
)paren
suffix:semicolon
id|t-&gt;n
op_assign
id|n
suffix:semicolon
id|t-&gt;insert
op_assign
id|dn_fib_table_insert
suffix:semicolon
id|t
op_member_access_from_pointer
r_delete
op_assign
id|dn_fib_table_delete
suffix:semicolon
id|t-&gt;lookup
op_assign
id|dn_fib_table_lookup
suffix:semicolon
id|t-&gt;walk
op_assign
id|dn_fib_table_walk
suffix:semicolon
macro_line|#ifdef CONFIG_RTNETLINK
id|t-&gt;dump
op_assign
id|dn_fib_table_dump
suffix:semicolon
macro_line|#endif
r_return
id|t
suffix:semicolon
)brace
DECL|function|dn_fib_del_tree
r_static
r_void
id|dn_fib_del_tree
c_func
(paren
r_struct
id|dn_fib_table
op_star
id|t
)paren
(brace
id|dn_fib_tables
(braket
id|t-&gt;n
)braket
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
id|t
)paren
(brace
id|kfree_s
c_func
(paren
id|t
comma
r_sizeof
(paren
r_struct
id|dn_fib_table
)paren
)paren
suffix:semicolon
)brace
)brace
DECL|function|dn_fib_resolve
r_int
id|dn_fib_resolve
c_func
(paren
r_struct
id|dn_fib_res
op_star
id|res
)paren
(brace
r_int
id|table
op_assign
id|DN_L1_TABLE
suffix:semicolon
r_int
id|count
op_assign
l_int|0
suffix:semicolon
r_struct
id|dn_fib_action
op_star
id|fa
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
id|res-&gt;res_addr
op_xor
id|dn_ntohs
c_func
(paren
id|decnet_address
)paren
)paren
op_amp
l_int|0xfc00
)paren
id|table
op_assign
id|DN_L2_TABLE
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
suffix:semicolon
)paren
(brace
r_struct
id|dn_fib_table
op_star
id|t
op_assign
id|dn_fib_get_tree
c_func
(paren
id|table
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|t
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOENT
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|t
op_member_access_from_pointer
id|lookup
c_func
(paren
id|t
comma
id|res
)paren
)paren
OL
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_if
c_cond
(paren
(paren
id|fa
op_assign
id|res-&gt;res_fa
)paren
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOENT
suffix:semicolon
r_if
c_cond
(paren
id|fa-&gt;fa_type
op_ne
id|RTN_THROW
)paren
r_break
suffix:semicolon
id|table
op_assign
id|fa-&gt;fa_table
suffix:semicolon
r_if
c_cond
(paren
id|count
op_increment
OG
id|DN_NUM_TABLES
)paren
r_return
op_minus
id|ENOENT
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|fa-&gt;fa_type
)paren
(brace
r_case
id|RTN_PROHIBIT
suffix:colon
r_case
id|RTN_UNREACHABLE
suffix:colon
r_return
op_minus
id|fa-&gt;fa_error
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * Punt to user via netlink for example, but for now&n; * we just drop it.&n; */
DECL|function|dn_fib_rt_message
r_int
id|dn_fib_rt_message
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
id|kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_RTNETLINK
DECL|function|dn_fib_convert_rtm
r_static
r_int
id|dn_fib_convert_rtm
c_func
(paren
r_struct
id|dn_fib_action
op_star
id|fa
comma
r_struct
id|rtmsg
op_star
id|r
comma
r_struct
id|rtattr
op_star
op_star
id|rta
comma
r_struct
id|nlmsghdr
op_star
id|n
comma
r_struct
id|netlink_skb_parms
op_star
id|req
)paren
(brace
id|dn_address
id|dst
comma
id|gw
comma
id|mask
op_assign
l_int|0xffff
suffix:semicolon
r_int
id|ifindex
op_assign
l_int|0
suffix:semicolon
r_struct
id|neighbour
op_star
id|neigh
suffix:semicolon
r_struct
id|net_device
op_star
id|dev
suffix:semicolon
r_int
r_char
id|addr
(braket
id|ETH_ALEN
)braket
suffix:semicolon
r_if
c_cond
(paren
id|r-&gt;rtm_family
op_ne
id|AF_DECnet
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|rta
(braket
id|RTA_DST
op_minus
l_int|1
)braket
)paren
id|memcpy
c_func
(paren
op_amp
id|dst
comma
id|RTA_DATA
c_func
(paren
id|rta
(braket
id|RTA_DST
op_minus
l_int|1
)braket
)paren
comma
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rta
(braket
id|RTA_OIF
op_minus
l_int|1
)braket
)paren
id|memcpy
c_func
(paren
op_amp
id|ifindex
comma
id|RTA_DATA
c_func
(paren
id|rta
(braket
id|RTA_OIF
op_minus
l_int|1
)braket
)paren
comma
r_sizeof
(paren
r_int
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rta
(braket
id|RTA_GATEWAY
op_minus
l_int|1
)braket
)paren
id|memcpy
c_func
(paren
op_amp
id|gw
comma
id|RTA_DATA
c_func
(paren
id|rta
(braket
id|RTA_GATEWAY
op_minus
l_int|1
)braket
)paren
comma
l_int|2
)paren
suffix:semicolon
id|fa-&gt;fa_key
op_assign
id|dn_ntohs
c_func
(paren
id|dst
)paren
suffix:semicolon
id|fa-&gt;fa_mask
op_assign
id|dn_ntohs
c_func
(paren
id|mask
)paren
suffix:semicolon
id|fa-&gt;fa_ifindex
op_assign
id|ifindex
suffix:semicolon
id|fa-&gt;fa_proto
op_assign
id|r-&gt;rtm_protocol
suffix:semicolon
id|fa-&gt;fa_type
op_assign
id|r-&gt;rtm_type
suffix:semicolon
r_switch
c_cond
(paren
id|fa-&gt;fa_type
)paren
(brace
r_case
id|RTN_UNICAST
suffix:colon
r_if
c_cond
(paren
(paren
id|dev
op_assign
id|__dev_get_by_index
c_func
(paren
id|ifindex
)paren
)paren
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
id|dn_dn2eth
c_func
(paren
id|addr
comma
id|dn_ntohs
c_func
(paren
id|gw
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|neigh
op_assign
id|__neigh_lookup
c_func
(paren
op_amp
id|dn_neigh_table
comma
op_amp
id|addr
comma
id|dev
comma
l_int|1
)paren
)paren
op_eq
l_int|NULL
)paren
r_return
op_minus
id|EHOSTUNREACH
suffix:semicolon
id|fa-&gt;fa_neigh
op_assign
id|neigh
suffix:semicolon
r_break
suffix:semicolon
r_case
id|RTN_THROW
suffix:colon
id|fa-&gt;fa_table
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
id|RTN_PROHIBIT
suffix:colon
id|fa-&gt;fa_error
op_assign
id|EPERM
suffix:semicolon
r_break
suffix:semicolon
r_case
id|RTN_UNREACHABLE
suffix:colon
id|fa-&gt;fa_error
op_assign
id|EHOSTUNREACH
suffix:semicolon
r_break
suffix:semicolon
r_case
id|RTN_BLACKHOLE
suffix:colon
id|fa-&gt;fa_error
op_assign
id|EINVAL
suffix:semicolon
r_break
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dn_fib_check_attr
r_static
r_int
id|dn_fib_check_attr
c_func
(paren
r_struct
id|rtmsg
op_star
id|r
comma
r_struct
id|rtattr
op_star
op_star
id|rta
)paren
(brace
r_switch
c_cond
(paren
id|r-&gt;rtm_type
)paren
(brace
r_case
id|RTN_UNICAST
suffix:colon
r_case
id|RTN_BLACKHOLE
suffix:colon
r_case
id|RTN_PROHIBIT
suffix:colon
r_case
id|RTN_UNREACHABLE
suffix:colon
r_case
id|RTN_THROW
suffix:colon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dn_fib_rtm_delroute
r_int
id|dn_fib_rtm_delroute
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|nlmsghdr
op_star
id|nlh
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|dn_fib_table
op_star
id|t
suffix:semicolon
r_struct
id|rtattr
op_star
op_star
id|rta
op_assign
id|arg
suffix:semicolon
r_struct
id|rtmsg
op_star
id|r
op_assign
id|NLMSG_DATA
c_func
(paren
id|nlh
)paren
suffix:semicolon
r_struct
id|dn_fib_action
op_star
id|fa
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|dn_fib_check_attr
c_func
(paren
id|r
comma
id|rta
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
(paren
id|fa
op_assign
id|dn_fib_new_action
c_func
(paren
)paren
)paren
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOBUFS
suffix:semicolon
id|t
op_assign
id|dn_fib_get_tree
c_func
(paren
id|r-&gt;rtm_table
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|t
)paren
(brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|dn_fib_convert_rtm
c_func
(paren
id|fa
comma
id|r
comma
id|rta
comma
id|nlh
comma
op_amp
id|NETLINK_CB
c_func
(paren
id|skb
)paren
)paren
)paren
OL
l_int|0
)paren
(brace
id|dn_fib_del_action
c_func
(paren
id|fa
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
id|err
op_assign
id|t
op_member_access_from_pointer
r_delete
(paren
id|t
comma
id|fa
)paren
suffix:semicolon
id|dn_fib_del_action
c_func
(paren
id|fa
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
r_return
op_minus
id|ESRCH
suffix:semicolon
)brace
DECL|function|dn_fib_rtm_newroute
r_int
id|dn_fib_rtm_newroute
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|nlmsghdr
op_star
id|nlh
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|dn_fib_table
op_star
id|t
suffix:semicolon
r_struct
id|rtattr
op_star
op_star
id|rta
op_assign
id|arg
suffix:semicolon
r_struct
id|rtmsg
op_star
id|r
op_assign
id|NLMSG_DATA
c_func
(paren
id|nlh
)paren
suffix:semicolon
r_struct
id|dn_fib_action
op_star
id|fa
suffix:semicolon
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|dn_fib_check_attr
c_func
(paren
id|r
comma
id|rta
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
(paren
id|fa
op_assign
id|dn_fib_new_action
c_func
(paren
)paren
)paren
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOBUFS
suffix:semicolon
id|t
op_assign
id|dn_fib_get_tree
c_func
(paren
id|r-&gt;rtm_table
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|t
)paren
(brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|dn_fib_convert_rtm
c_func
(paren
id|fa
comma
id|r
comma
id|rta
comma
id|nlh
comma
op_amp
id|NETLINK_CB
c_func
(paren
id|skb
)paren
)paren
)paren
OL
l_int|0
)paren
(brace
id|dn_fib_del_action
c_func
(paren
id|fa
)paren
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
r_return
id|t
op_member_access_from_pointer
id|insert
c_func
(paren
id|t
comma
id|fa
)paren
suffix:semicolon
)brace
r_return
op_minus
id|ENOBUFS
suffix:semicolon
)brace
DECL|function|dn_fib_dump_info
r_int
id|dn_fib_dump_info
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
id|u32
id|pid
comma
id|u32
id|seq
comma
r_int
id|event
comma
r_int
id|table
comma
r_struct
id|dn_fib_action
op_star
id|fa
)paren
(brace
r_struct
id|rtmsg
op_star
id|rtm
suffix:semicolon
r_struct
id|nlmsghdr
op_star
id|nlh
suffix:semicolon
r_int
r_char
op_star
id|b
op_assign
id|skb-&gt;tail
suffix:semicolon
id|nlh
op_assign
id|NLMSG_PUT
c_func
(paren
id|skb
comma
id|pid
comma
id|seq
comma
id|event
comma
r_sizeof
(paren
op_star
id|rtm
)paren
)paren
suffix:semicolon
id|rtm
op_assign
id|NLMSG_DATA
c_func
(paren
id|nlh
)paren
suffix:semicolon
id|rtm-&gt;rtm_family
op_assign
id|AF_DECnet
suffix:semicolon
id|rtm-&gt;rtm_dst_len
op_assign
l_int|16
suffix:semicolon
id|rtm-&gt;rtm_src_len
op_assign
l_int|16
suffix:semicolon
id|rtm-&gt;rtm_tos
op_assign
l_int|0
suffix:semicolon
id|rtm-&gt;rtm_table
op_assign
id|table
suffix:semicolon
id|rtm-&gt;rtm_type
op_assign
id|fa-&gt;fa_type
suffix:semicolon
id|rtm-&gt;rtm_flags
op_assign
l_int|0
suffix:semicolon
id|rtm-&gt;rtm_protocol
op_assign
id|fa-&gt;fa_proto
suffix:semicolon
id|RTA_PUT
c_func
(paren
id|skb
comma
id|RTA_DST
comma
l_int|2
comma
op_amp
id|fa-&gt;fa_key
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fa-&gt;fa_ifindex
)paren
id|RTA_PUT
c_func
(paren
id|skb
comma
id|RTA_OIF
comma
r_sizeof
(paren
r_int
)paren
comma
op_amp
id|fa-&gt;fa_ifindex
)paren
suffix:semicolon
id|nlh-&gt;nlmsg_len
op_assign
id|skb-&gt;tail
op_minus
id|b
suffix:semicolon
r_return
id|skb-&gt;len
suffix:semicolon
id|nlmsg_failure
suffix:colon
id|rtattr_failure
suffix:colon
id|skb_trim
c_func
(paren
id|skb
comma
id|b
op_minus
id|skb-&gt;data
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
DECL|function|dn_rtmsg_fib
r_static
r_void
id|dn_rtmsg_fib
c_func
(paren
r_int
id|event
comma
r_int
id|table
comma
r_struct
id|dn_fib_action
op_star
id|fa
comma
r_struct
id|nlmsghdr
op_star
id|nlh
comma
r_struct
id|netlink_skb_parms
op_star
id|req
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|u32
id|pid
op_assign
id|req
ques
c_cond
id|req-&gt;pid
suffix:colon
l_int|0
suffix:semicolon
r_int
id|size
op_assign
id|NLMSG_SPACE
c_func
(paren
r_sizeof
(paren
r_struct
id|rtmsg
)paren
op_plus
l_int|256
)paren
suffix:semicolon
id|skb
op_assign
id|alloc_skb
c_func
(paren
id|size
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|dn_fib_dump_info
c_func
(paren
id|skb
comma
id|pid
comma
id|nlh-&gt;nlmsg_seq
comma
id|event
comma
id|table
comma
id|fa
)paren
OL
l_int|0
)paren
(brace
id|kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|NETLINK_CB
c_func
(paren
id|skb
)paren
dot
id|dst_groups
op_assign
id|RTMGRP_DECnet_ROUTE
suffix:semicolon
r_if
c_cond
(paren
id|nlh-&gt;nlmsg_flags
op_amp
id|NLM_F_ECHO
)paren
id|atomic_inc
c_func
(paren
op_amp
id|skb-&gt;users
)paren
suffix:semicolon
id|netlink_broadcast
c_func
(paren
id|rtnl
comma
id|skb
comma
id|pid
comma
id|RTMGRP_DECnet_ROUTE
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|nlh-&gt;nlmsg_flags
op_amp
id|NLM_F_ECHO
)paren
id|netlink_unicast
c_func
(paren
id|rtnl
comma
id|skb
comma
id|pid
comma
id|MSG_DONTWAIT
)paren
suffix:semicolon
)brace
DECL|function|dn_fib_table_dump
r_static
r_int
id|dn_fib_table_dump
c_func
(paren
r_struct
id|dn_fib_table
op_star
id|t
comma
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|netlink_callback
op_star
id|cb
)paren
(brace
r_return
id|skb-&gt;len
suffix:semicolon
)brace
DECL|function|dn_fib_dump
r_int
id|dn_fib_dump
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|netlink_callback
op_star
id|cb
)paren
(brace
r_int
id|t
suffix:semicolon
r_int
id|s_t
suffix:semicolon
r_struct
id|dn_fib_table
op_star
id|tb
suffix:semicolon
r_if
c_cond
(paren
id|NLMSG_PAYLOAD
c_func
(paren
id|cb-&gt;nlh
comma
l_int|0
)paren
op_ge
r_sizeof
(paren
r_struct
id|rtmsg
)paren
op_logical_and
(paren
(paren
r_struct
id|rtmsg
op_star
)paren
id|NLMSG_DATA
c_func
(paren
id|cb-&gt;nlh
)paren
)paren
op_member_access_from_pointer
id|rtm_flags
op_amp
id|RTM_F_CLONED
)paren
r_return
id|dn_cache_dump
c_func
(paren
id|skb
comma
id|cb
)paren
suffix:semicolon
id|s_t
op_assign
id|cb-&gt;args
(braket
l_int|0
)braket
suffix:semicolon
r_if
c_cond
(paren
id|s_t
op_eq
l_int|0
)paren
id|s_t
op_assign
id|cb-&gt;args
(braket
l_int|0
)braket
op_assign
id|DN_MIN_TABLE
suffix:semicolon
r_for
c_loop
(paren
id|t
op_assign
id|s_t
suffix:semicolon
id|t
OL
id|DN_NUM_TABLES
suffix:semicolon
id|t
op_increment
)paren
(brace
r_if
c_cond
(paren
id|t
OL
id|s_t
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|t
OG
id|s_t
)paren
id|memset
c_func
(paren
op_amp
id|cb-&gt;args
(braket
l_int|1
)braket
comma
l_int|0
comma
r_sizeof
(paren
id|cb-&gt;args
)paren
op_minus
r_sizeof
(paren
r_int
)paren
)paren
suffix:semicolon
id|tb
op_assign
id|dn_fib_get_tree
c_func
(paren
id|t
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tb
op_eq
l_int|NULL
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|tb
op_member_access_from_pointer
id|dump
c_func
(paren
id|tb
comma
id|skb
comma
id|cb
)paren
OL
l_int|0
)paren
r_break
suffix:semicolon
)brace
id|cb-&gt;args
(braket
l_int|0
)braket
op_assign
id|t
suffix:semicolon
r_return
id|skb-&gt;len
suffix:semicolon
)brace
macro_line|#endif /* CONFIG_RTNETLINK */
DECL|function|dn_fib_ioctl
r_int
id|dn_fib_ioctl
c_func
(paren
r_struct
id|socket
op_star
id|sock
comma
r_int
r_int
id|cmd
comma
r_int
r_int
id|arg
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|capable
c_func
(paren
id|CAP_NET_ADMIN
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|SIOCADDRT
suffix:colon
r_case
id|SIOCDELRT
suffix:colon
r_return
l_int|0
suffix:semicolon
)brace
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_PROC_FS
DECL|struct|dn_fib_procfs
r_struct
id|dn_fib_procfs
(brace
DECL|member|len
r_int
id|len
suffix:semicolon
DECL|member|pos
id|off_t
id|pos
suffix:semicolon
DECL|member|begin
id|off_t
id|begin
suffix:semicolon
DECL|member|offset
id|off_t
id|offset
suffix:semicolon
DECL|member|length
r_int
id|length
suffix:semicolon
DECL|member|buffer
r_char
op_star
id|buffer
suffix:semicolon
)brace
suffix:semicolon
DECL|function|dn_proc_action_list
r_static
r_int
id|dn_proc_action_list
c_func
(paren
r_struct
id|dn_fib_walker_t
op_star
id|fwt
comma
r_struct
id|dn_fib_node
op_star
id|fn
)paren
(brace
r_struct
id|dn_fib_procfs
op_star
id|pinfo
op_assign
(paren
r_struct
id|dn_fib_procfs
op_star
)paren
id|fwt-&gt;arg
suffix:semicolon
r_struct
id|dn_fib_action
op_star
id|fa
suffix:semicolon
r_char
id|ab
(braket
id|DN_ASCBUF_LEN
)braket
suffix:semicolon
r_if
c_cond
(paren
id|pinfo-&gt;pos
OG
id|pinfo-&gt;offset
op_plus
id|pinfo-&gt;length
)paren
r_return
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|fa
op_assign
id|fn-&gt;fn_action
suffix:semicolon
id|fa
suffix:semicolon
id|fa
op_assign
id|fa-&gt;fa_next
)paren
(brace
id|pinfo-&gt;len
op_add_assign
id|sprintf
c_func
(paren
id|pinfo-&gt;buffer
op_plus
id|pinfo-&gt;len
comma
l_string|&quot;%s/%04hx %02x %02x&bslash;n&quot;
comma
id|dn_addr2asc
c_func
(paren
id|fa-&gt;fa_key
comma
id|ab
)paren
comma
id|fa-&gt;fa_mask
comma
id|fa-&gt;fa_type
comma
id|fa-&gt;fa_proto
)paren
suffix:semicolon
id|pinfo-&gt;pos
op_assign
id|pinfo-&gt;begin
op_plus
id|pinfo-&gt;len
suffix:semicolon
r_if
c_cond
(paren
id|pinfo-&gt;pos
OL
id|pinfo-&gt;offset
)paren
(brace
id|pinfo-&gt;len
op_assign
l_int|0
suffix:semicolon
id|pinfo-&gt;begin
op_assign
id|pinfo-&gt;pos
suffix:semicolon
)brace
r_if
c_cond
(paren
id|pinfo-&gt;pos
OG
id|pinfo-&gt;offset
op_plus
id|pinfo-&gt;length
)paren
r_break
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|decnet_rt_get_info
r_static
r_int
id|decnet_rt_get_info
c_func
(paren
r_char
op_star
id|buffer
comma
r_char
op_star
op_star
id|start
comma
id|off_t
id|offset
comma
r_int
id|length
)paren
(brace
r_struct
id|dn_fib_procfs
id|pinfo
suffix:semicolon
r_int
id|i
suffix:semicolon
r_struct
id|dn_fib_table
op_star
id|t
suffix:semicolon
r_struct
id|dn_fib_walker_t
id|fwt
suffix:semicolon
id|pinfo.pos
op_assign
l_int|0
suffix:semicolon
id|pinfo.len
op_assign
l_int|0
suffix:semicolon
id|pinfo.begin
op_assign
l_int|0
suffix:semicolon
id|pinfo.offset
op_assign
id|offset
suffix:semicolon
id|pinfo.length
op_assign
id|length
suffix:semicolon
id|pinfo.buffer
op_assign
id|buffer
suffix:semicolon
id|fwt.arg
op_assign
op_amp
id|pinfo
suffix:semicolon
id|fwt.fxn
op_assign
id|dn_proc_action_list
suffix:semicolon
id|start_bh_atomic
c_func
(paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|DN_NUM_TABLES
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|t
op_assign
id|dn_fib_get_tree
c_func
(paren
id|i
comma
l_int|0
)paren
)paren
op_eq
l_int|NULL
)paren
r_continue
suffix:semicolon
id|fwt.table
op_assign
id|t
suffix:semicolon
id|t
op_member_access_from_pointer
id|walk
c_func
(paren
op_amp
id|fwt
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pinfo.pos
OG
id|pinfo.offset
op_plus
id|pinfo.length
)paren
r_break
suffix:semicolon
)brace
id|end_bh_atomic
c_func
(paren
)paren
suffix:semicolon
op_star
id|start
op_assign
id|pinfo.buffer
op_plus
(paren
id|pinfo.offset
op_minus
id|pinfo.begin
)paren
suffix:semicolon
id|pinfo.len
op_sub_assign
(paren
id|pinfo.offset
op_minus
id|pinfo.begin
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pinfo.len
OG
id|pinfo.length
)paren
id|pinfo.len
op_assign
id|pinfo.length
suffix:semicolon
r_return
id|pinfo.len
suffix:semicolon
)brace
macro_line|#endif /* CONFIG_PROC_FS */
macro_line|#ifdef CONFIG_DECNET_MODULE
DECL|function|dn_fib_cleanup
r_void
id|dn_fib_cleanup
c_func
(paren
r_void
)paren
(brace
macro_line|#ifdef CONFIG_PROC_FS
id|proc_net_create
c_func
(paren
l_string|&quot;decnet_route&quot;
comma
l_int|0
comma
id|decnet_rt_get_info
)paren
suffix:semicolon
macro_line|#endif /* CONFIG_PROC_FS */
)brace
macro_line|#endif /* CONFIG_DECNET_MODULE */
DECL|function|dn_fib_init
r_void
id|__init
id|dn_fib_init
c_func
(paren
r_void
)paren
(brace
id|memset
c_func
(paren
id|dn_fib_tables
comma
l_int|0
comma
id|DN_NUM_TABLES
op_star
r_sizeof
(paren
r_struct
id|dn_fib_table
op_star
)paren
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_PROC_FS
id|proc_net_remove
c_func
(paren
l_string|&quot;decnet_route&quot;
)paren
suffix:semicolon
macro_line|#endif
)brace
eof
