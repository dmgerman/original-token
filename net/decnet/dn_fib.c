multiline_comment|/*&n; * DECnet       An implementation of the DECnet protocol suite for the LINUX&n; *              operating system.  DECnet is implemented using the  BSD Socket&n; *              interface as the means of communication with the user level.&n; *&n; *              DECnet Routing Forwarding Information Base (Glue/Info List)&n; *&n; * Author:      Steve Whitehouse &lt;SteveW@ACM.org&gt;&n; *&n; *&n; * Changes:&n; *              Alexey Kuznetsov : SMP locking changes&n; *              Steve Whitehouse : Rewrote it... Well to be more correct, I&n; *                                 copied most of it from the ipv4 fib code.&n; *&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/net.h&gt;
macro_line|#include &lt;linux/socket.h&gt;
macro_line|#include &lt;linux/sockios.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/skbuff.h&gt;
macro_line|#include &lt;linux/netlink.h&gt;
macro_line|#include &lt;linux/rtnetlink.h&gt;
macro_line|#include &lt;linux/proc_fs.h&gt;
macro_line|#include &lt;linux/netdevice.h&gt;
macro_line|#include &lt;linux/timer.h&gt;
macro_line|#include &lt;linux/spinlock.h&gt;
macro_line|#include &lt;asm/atomic.h&gt;
macro_line|#include &lt;asm/uaccess.h&gt;
macro_line|#include &lt;net/neighbour.h&gt;
macro_line|#include &lt;net/dst.h&gt;
macro_line|#include &lt;net/dn.h&gt;
macro_line|#include &lt;net/dn_route.h&gt;
macro_line|#include &lt;net/dn_fib.h&gt;
macro_line|#include &lt;net/dn_neigh.h&gt;
macro_line|#include &lt;net/dn_dev.h&gt;
DECL|macro|for_fib_info
mdefine_line|#define for_fib_info() { struct dn_fib_info *fi;&bslash;&n;&t;for(fi = dn_fib_info_list; fi; fi = fi-&gt;fib_next)
DECL|macro|endfor_fib_info
mdefine_line|#define endfor_fib_info() }
DECL|macro|for_nexthops
mdefine_line|#define for_nexthops(fi) { int nhsel; const struct dn_fib_nh *nh;&bslash;&n;&t;for(nhsel = 0, nh = (fi)-&gt;fib_nh; nhsel &lt; (fi)-&gt;fib_nhs; nh++, nhsel++)
DECL|macro|change_nexthops
mdefine_line|#define change_nexthops(fi) { int nhsel; struct dn_fib_nh *nh;&bslash;&n;&t;for(nhsel = 0, nh = (struct dn_fib_nh *)((fi)-&gt;fib_nh); nhsel &lt; (fi)-&gt;fib_nhs; nh++, nhsel++)
DECL|macro|endfor_nexthops
mdefine_line|#define endfor_nexthops(fi) }
macro_line|#ifdef CONFIG_RTNETLINK
r_extern
r_int
id|dn_cache_dump
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|netlink_callback
op_star
id|cb
)paren
suffix:semicolon
macro_line|#endif /* CONFIG_RTNETLINK */
DECL|variable|dn_fib_info_list
r_static
r_struct
id|dn_fib_info
op_star
id|dn_fib_info_list
op_assign
l_int|NULL
suffix:semicolon
DECL|variable|dn_fib_info_lock
r_static
id|rwlock_t
id|dn_fib_info_lock
op_assign
id|RW_LOCK_UNLOCKED
suffix:semicolon
DECL|variable|dn_fib_info_cnt
r_int
id|dn_fib_info_cnt
suffix:semicolon
r_static
r_struct
(brace
DECL|member|error
r_int
id|error
suffix:semicolon
DECL|member|scope
id|u8
id|scope
suffix:semicolon
DECL|variable|dn_fib_props
)brace
id|dn_fib_props
(braket
id|RTA_MAX
op_plus
l_int|1
)braket
op_assign
(brace
(brace
l_int|0
comma
id|RT_SCOPE_NOWHERE
)brace
comma
multiline_comment|/* RTN_UNSPEC */
(brace
l_int|0
comma
id|RT_SCOPE_UNIVERSE
)brace
comma
multiline_comment|/* RTN_UNICAST */
(brace
l_int|0
comma
id|RT_SCOPE_HOST
)brace
comma
multiline_comment|/* RTN_LOCAL */
(brace
op_minus
id|EINVAL
comma
id|RT_SCOPE_NOWHERE
)brace
comma
multiline_comment|/* RTN_BROADCAST */
(brace
op_minus
id|EINVAL
comma
id|RT_SCOPE_NOWHERE
)brace
comma
multiline_comment|/* RTN_ANYCAST */
(brace
op_minus
id|EINVAL
comma
id|RT_SCOPE_NOWHERE
)brace
comma
multiline_comment|/* RTN_MULTICAST */
(brace
op_minus
id|EINVAL
comma
id|RT_SCOPE_UNIVERSE
)brace
comma
multiline_comment|/* RTN_BLACKHOLE */
(brace
op_minus
id|EHOSTUNREACH
comma
id|RT_SCOPE_UNIVERSE
)brace
comma
multiline_comment|/* RTN_UNREACHABLE */
(brace
op_minus
id|EACCES
comma
id|RT_SCOPE_UNIVERSE
)brace
comma
multiline_comment|/* RTN_PROHIBIT */
(brace
op_minus
id|EAGAIN
comma
id|RT_SCOPE_UNIVERSE
)brace
comma
multiline_comment|/* RTN_THROW */
(brace
op_minus
id|EINVAL
comma
id|RT_SCOPE_NOWHERE
)brace
comma
multiline_comment|/* RTN_NAT */
(brace
op_minus
id|EINVAL
comma
id|RT_SCOPE_NOWHERE
)brace
multiline_comment|/* RTN_XRESOLVE */
)brace
suffix:semicolon
DECL|function|dn_fib_free_info
r_void
id|dn_fib_free_info
c_func
(paren
r_struct
id|dn_fib_info
op_star
id|fi
)paren
(brace
r_if
c_cond
(paren
id|fi-&gt;fib_dead
op_eq
l_int|0
)paren
(brace
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;DECnet: BUG! Attempt to free alive dn_fib_info&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|change_nexthops
c_func
(paren
id|fi
)paren
(brace
r_if
c_cond
(paren
id|nh-&gt;nh_dev
)paren
id|dev_put
c_func
(paren
id|nh-&gt;nh_dev
)paren
suffix:semicolon
id|nh-&gt;nh_dev
op_assign
l_int|NULL
suffix:semicolon
)brace
id|endfor_nexthops
c_func
(paren
id|fi
)paren
suffix:semicolon
id|dn_fib_info_cnt
op_decrement
suffix:semicolon
id|kfree
c_func
(paren
id|fi
)paren
suffix:semicolon
)brace
DECL|function|dn_fib_release_info
r_void
id|dn_fib_release_info
c_func
(paren
r_struct
id|dn_fib_info
op_star
id|fi
)paren
(brace
id|write_lock
c_func
(paren
op_amp
id|dn_fib_info_lock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fi
op_logical_and
op_decrement
id|fi-&gt;fib_treeref
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|fi-&gt;fib_next
)paren
id|fi-&gt;fib_next-&gt;fib_prev
op_assign
id|fi-&gt;fib_prev
suffix:semicolon
r_if
c_cond
(paren
id|fi-&gt;fib_prev
)paren
id|fi-&gt;fib_prev-&gt;fib_next
op_assign
id|fi-&gt;fib_next
suffix:semicolon
r_if
c_cond
(paren
id|fi
op_eq
id|dn_fib_info_list
)paren
id|dn_fib_info_list
op_assign
id|fi-&gt;fib_next
suffix:semicolon
id|fi-&gt;fib_dead
op_assign
l_int|1
suffix:semicolon
id|dn_fib_info_put
c_func
(paren
id|fi
)paren
suffix:semicolon
)brace
id|write_unlock
c_func
(paren
op_amp
id|dn_fib_info_lock
)paren
suffix:semicolon
)brace
DECL|function|dn_fib_nh_comp
r_static
id|__inline__
r_int
id|dn_fib_nh_comp
c_func
(paren
r_const
r_struct
id|dn_fib_info
op_star
id|fi
comma
r_const
r_struct
id|dn_fib_info
op_star
id|ofi
)paren
(brace
r_const
r_struct
id|dn_fib_nh
op_star
id|onh
op_assign
id|ofi-&gt;fib_nh
suffix:semicolon
id|for_nexthops
c_func
(paren
id|fi
)paren
(brace
r_if
c_cond
(paren
id|nh-&gt;nh_oif
op_ne
id|onh-&gt;nh_oif
op_logical_or
id|nh-&gt;nh_gw
op_ne
id|onh-&gt;nh_gw
op_logical_or
id|nh-&gt;nh_scope
op_ne
id|onh-&gt;nh_scope
op_logical_or
id|nh-&gt;nh_weight
op_ne
id|onh-&gt;nh_weight
op_logical_or
(paren
(paren
id|nh-&gt;nh_flags
op_xor
id|onh-&gt;nh_flags
)paren
op_amp
op_complement
id|RTNH_F_DEAD
)paren
)paren
r_return
op_minus
l_int|1
suffix:semicolon
id|onh
op_increment
suffix:semicolon
)brace
id|endfor_nexthops
c_func
(paren
id|fi
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dn_fib_find_info
r_static
id|__inline__
r_struct
id|dn_fib_info
op_star
id|dn_fib_find_info
c_func
(paren
r_const
r_struct
id|dn_fib_info
op_star
id|nfi
)paren
(brace
id|for_fib_info
c_func
(paren
)paren
(brace
r_if
c_cond
(paren
id|fi-&gt;fib_nhs
op_ne
id|nfi-&gt;fib_nhs
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|nfi-&gt;fib_protocol
op_eq
id|fi-&gt;fib_protocol
op_logical_and
id|nfi-&gt;fib_prefsrc
op_eq
id|fi-&gt;fib_prefsrc
op_logical_and
id|nfi-&gt;fib_priority
op_eq
id|fi-&gt;fib_priority
op_logical_and
(paren
(paren
id|nfi-&gt;fib_flags
op_xor
id|fi-&gt;fib_flags
)paren
op_amp
op_complement
id|RTNH_F_DEAD
)paren
op_eq
l_int|0
op_logical_and
(paren
id|nfi-&gt;fib_nhs
op_eq
l_int|0
op_logical_or
id|dn_fib_nh_comp
c_func
(paren
id|fi
comma
id|nfi
)paren
op_eq
l_int|0
)paren
)paren
r_return
id|fi
suffix:semicolon
)brace
id|endfor_fib_info
c_func
(paren
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
DECL|function|dn_fib_get_attr16
id|u16
id|dn_fib_get_attr16
c_func
(paren
r_struct
id|rtattr
op_star
id|attr
comma
r_int
id|attrlen
comma
r_int
id|type
)paren
(brace
r_while
c_loop
(paren
id|RTA_OK
c_func
(paren
id|attr
comma
id|attrlen
)paren
)paren
(brace
r_if
c_cond
(paren
id|attr-&gt;rta_type
op_eq
id|type
)paren
r_return
op_star
(paren
id|u16
op_star
)paren
id|RTA_DATA
c_func
(paren
id|attr
)paren
suffix:semicolon
id|attr
op_assign
id|RTA_NEXT
c_func
(paren
id|attr
comma
id|attrlen
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dn_fib_count_nhs
r_static
r_int
id|dn_fib_count_nhs
c_func
(paren
r_struct
id|rtattr
op_star
id|rta
)paren
(brace
r_int
id|nhs
op_assign
l_int|0
suffix:semicolon
r_struct
id|rtnexthop
op_star
id|nhp
op_assign
id|RTA_DATA
c_func
(paren
id|rta
)paren
suffix:semicolon
r_int
id|nhlen
op_assign
id|RTA_PAYLOAD
c_func
(paren
id|rta
)paren
suffix:semicolon
r_while
c_loop
(paren
id|nhlen
op_ge
(paren
r_int
)paren
r_sizeof
(paren
r_struct
id|rtnexthop
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
id|nhlen
op_sub_assign
id|nhp-&gt;rtnh_len
)paren
OL
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
id|nhs
op_increment
suffix:semicolon
id|nhp
op_assign
id|RTNH_NEXT
c_func
(paren
id|nhp
)paren
suffix:semicolon
)brace
r_return
id|nhs
suffix:semicolon
)brace
DECL|function|dn_fib_get_nhs
r_static
r_int
id|dn_fib_get_nhs
c_func
(paren
r_struct
id|dn_fib_info
op_star
id|fi
comma
r_const
r_struct
id|rtattr
op_star
id|rta
comma
r_const
r_struct
id|rtmsg
op_star
id|r
)paren
(brace
r_struct
id|rtnexthop
op_star
id|nhp
op_assign
id|RTA_DATA
c_func
(paren
id|rta
)paren
suffix:semicolon
r_int
id|nhlen
op_assign
id|RTA_PAYLOAD
c_func
(paren
id|rta
)paren
suffix:semicolon
id|change_nexthops
c_func
(paren
id|fi
)paren
(brace
r_int
id|attrlen
op_assign
id|nhlen
op_minus
r_sizeof
(paren
r_struct
id|rtnexthop
)paren
suffix:semicolon
r_if
c_cond
(paren
id|attrlen
OL
l_int|0
op_logical_or
(paren
id|nhlen
op_sub_assign
id|nhp-&gt;rtnh_len
)paren
OL
l_int|0
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|nh-&gt;nh_flags
op_assign
(paren
id|r-&gt;rtm_flags
op_amp
op_complement
l_int|0xFF
)paren
op_or
id|nhp-&gt;rtnh_flags
suffix:semicolon
id|nh-&gt;nh_oif
op_assign
id|nhp-&gt;rtnh_ifindex
suffix:semicolon
id|nh-&gt;nh_weight
op_assign
id|nhp-&gt;rtnh_hops
op_plus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|attrlen
)paren
(brace
id|nh-&gt;nh_gw
op_assign
id|dn_fib_get_attr16
c_func
(paren
id|RTNH_DATA
c_func
(paren
id|nhp
)paren
comma
id|attrlen
comma
id|RTA_GATEWAY
)paren
suffix:semicolon
)brace
id|nhp
op_assign
id|RTNH_NEXT
c_func
(paren
id|nhp
)paren
suffix:semicolon
)brace
id|endfor_nexthops
c_func
(paren
id|fi
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dn_fib_check_nh
r_static
r_int
id|dn_fib_check_nh
c_func
(paren
r_const
r_struct
id|rtmsg
op_star
id|r
comma
r_struct
id|dn_fib_info
op_star
id|fi
comma
r_struct
id|dn_fib_nh
op_star
id|nh
)paren
(brace
r_int
id|err
suffix:semicolon
r_if
c_cond
(paren
id|nh-&gt;nh_gw
)paren
(brace
r_struct
id|dn_fib_key
id|key
suffix:semicolon
r_struct
id|dn_fib_res
id|res
suffix:semicolon
r_if
c_cond
(paren
id|nh-&gt;nh_flags
op_amp
id|RTNH_F_ONLINK
)paren
(brace
r_struct
id|net_device
op_star
id|dev
suffix:semicolon
r_if
c_cond
(paren
id|r-&gt;rtm_scope
op_ge
id|RT_SCOPE_LINK
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
(paren
id|dev
op_assign
id|__dev_get_by_index
c_func
(paren
id|nh-&gt;nh_oif
)paren
)paren
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|dev-&gt;flags
op_amp
id|IFF_UP
)paren
)paren
r_return
op_minus
id|ENETDOWN
suffix:semicolon
id|nh-&gt;nh_dev
op_assign
id|dev
suffix:semicolon
id|atomic_inc
c_func
(paren
op_amp
id|dev-&gt;refcnt
)paren
suffix:semicolon
id|nh-&gt;nh_scope
op_assign
id|RT_SCOPE_LINK
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|memset
c_func
(paren
op_amp
id|key
comma
l_int|0
comma
r_sizeof
(paren
id|key
)paren
)paren
suffix:semicolon
id|key.dst
op_assign
id|nh-&gt;nh_gw
suffix:semicolon
id|key.oif
op_assign
id|nh-&gt;nh_oif
suffix:semicolon
id|key.scope
op_assign
id|r-&gt;rtm_scope
op_plus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|key.scope
OL
id|RT_SCOPE_LINK
)paren
id|key.scope
op_assign
id|RT_SCOPE_LINK
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|dn_fib_lookup
c_func
(paren
op_amp
id|key
comma
op_amp
id|res
)paren
)paren
op_ne
l_int|0
)paren
r_return
id|err
suffix:semicolon
id|nh-&gt;nh_scope
op_assign
id|res.scope
suffix:semicolon
id|nh-&gt;nh_oif
op_assign
id|DN_FIB_RES_OIF
c_func
(paren
id|res
)paren
suffix:semicolon
id|nh-&gt;nh_dev
op_assign
id|DN_FIB_RES_DEV
c_func
(paren
id|res
)paren
suffix:semicolon
r_if
c_cond
(paren
id|nh-&gt;nh_dev
)paren
id|atomic_inc
c_func
(paren
op_amp
id|nh-&gt;nh_dev-&gt;refcnt
)paren
suffix:semicolon
id|dn_fib_res_put
c_func
(paren
op_amp
id|res
)paren
suffix:semicolon
)brace
r_else
(brace
r_struct
id|net_device
op_star
id|dev
suffix:semicolon
r_if
c_cond
(paren
id|nh-&gt;nh_flags
op_amp
(paren
id|RTNH_F_PERVASIVE
op_or
id|RTNH_F_ONLINK
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|dev
op_assign
id|__dev_get_by_index
c_func
(paren
id|nh-&gt;nh_oif
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dev
op_eq
l_int|NULL
op_logical_or
id|dev-&gt;dn_ptr
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|dev-&gt;flags
op_amp
id|IFF_UP
)paren
)paren
r_return
op_minus
id|ENETDOWN
suffix:semicolon
id|nh-&gt;nh_dev
op_assign
id|dev
suffix:semicolon
id|atomic_inc
c_func
(paren
op_amp
id|nh-&gt;nh_dev-&gt;refcnt
)paren
suffix:semicolon
id|nh-&gt;nh_scope
op_assign
id|RT_SCOPE_HOST
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dn_fib_create_info
r_struct
id|dn_fib_info
op_star
id|dn_fib_create_info
c_func
(paren
r_const
r_struct
id|rtmsg
op_star
id|r
comma
r_struct
id|dn_kern_rta
op_star
id|rta
comma
r_const
r_struct
id|nlmsghdr
op_star
id|nlh
comma
r_int
op_star
id|errp
)paren
(brace
r_int
id|err
suffix:semicolon
r_struct
id|dn_fib_info
op_star
id|fi
op_assign
l_int|NULL
suffix:semicolon
r_struct
id|dn_fib_info
op_star
id|ofi
suffix:semicolon
r_int
id|nhs
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|dn_fib_props
(braket
id|r-&gt;rtm_type
)braket
dot
id|scope
OG
id|r-&gt;rtm_scope
)paren
r_goto
id|err_inval
suffix:semicolon
r_if
c_cond
(paren
id|rta-&gt;rta_mp
)paren
(brace
id|nhs
op_assign
id|dn_fib_count_nhs
c_func
(paren
id|rta-&gt;rta_mp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|nhs
op_eq
l_int|0
)paren
r_goto
id|err_inval
suffix:semicolon
)brace
id|fi
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
op_star
id|fi
)paren
op_plus
id|nhs
op_star
r_sizeof
(paren
r_struct
id|dn_fib_nh
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
id|err
op_assign
op_minus
id|ENOBUFS
suffix:semicolon
r_if
c_cond
(paren
id|fi
op_eq
l_int|NULL
)paren
r_goto
id|failure
suffix:semicolon
id|memset
c_func
(paren
id|fi
comma
l_int|0
comma
r_sizeof
(paren
op_star
id|fi
)paren
op_plus
id|nhs
op_star
r_sizeof
(paren
r_struct
id|dn_fib_nh
)paren
)paren
suffix:semicolon
id|fi-&gt;fib_protocol
op_assign
id|r-&gt;rtm_protocol
suffix:semicolon
id|fi-&gt;fib_nhs
op_assign
id|nhs
suffix:semicolon
id|fi-&gt;fib_flags
op_assign
id|r-&gt;rtm_flags
suffix:semicolon
r_if
c_cond
(paren
id|rta-&gt;rta_priority
)paren
id|fi-&gt;fib_priority
op_assign
op_star
id|rta-&gt;rta_priority
suffix:semicolon
r_if
c_cond
(paren
id|rta-&gt;rta_prefsrc
)paren
id|memcpy
c_func
(paren
op_amp
id|fi-&gt;fib_prefsrc
comma
id|rta-&gt;rta_prefsrc
comma
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rta-&gt;rta_mp
)paren
(brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|dn_fib_get_nhs
c_func
(paren
id|fi
comma
id|rta-&gt;rta_mp
comma
id|r
)paren
)paren
op_ne
l_int|0
)paren
r_goto
id|failure
suffix:semicolon
r_if
c_cond
(paren
id|rta-&gt;rta_oif
op_logical_and
id|fi-&gt;fib_nh-&gt;nh_oif
op_ne
op_star
id|rta-&gt;rta_oif
)paren
r_goto
id|err_inval
suffix:semicolon
r_if
c_cond
(paren
id|rta-&gt;rta_gw
op_logical_and
id|memcmp
c_func
(paren
op_amp
id|fi-&gt;fib_nh-&gt;nh_gw
comma
id|rta-&gt;rta_gw
comma
l_int|2
)paren
)paren
r_goto
id|err_inval
suffix:semicolon
)brace
r_else
(brace
r_struct
id|dn_fib_nh
op_star
id|nh
op_assign
id|fi-&gt;fib_nh
suffix:semicolon
r_if
c_cond
(paren
id|rta-&gt;rta_oif
)paren
id|nh-&gt;nh_oif
op_assign
op_star
id|rta-&gt;rta_oif
suffix:semicolon
r_if
c_cond
(paren
id|rta-&gt;rta_gw
)paren
id|memcpy
c_func
(paren
op_amp
id|nh-&gt;nh_gw
comma
id|rta-&gt;rta_gw
comma
l_int|2
)paren
suffix:semicolon
id|nh-&gt;nh_flags
op_assign
id|r-&gt;rtm_flags
suffix:semicolon
id|nh-&gt;nh_weight
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|dn_fib_props
(braket
id|r-&gt;rtm_type
)braket
dot
id|error
)paren
(brace
r_if
c_cond
(paren
id|rta-&gt;rta_gw
op_logical_or
id|rta-&gt;rta_oif
op_logical_or
id|rta-&gt;rta_mp
)paren
r_goto
id|err_inval
suffix:semicolon
r_goto
id|link_it
suffix:semicolon
)brace
r_if
c_cond
(paren
id|r-&gt;rtm_scope
OG
id|RT_SCOPE_HOST
)paren
r_goto
id|err_inval
suffix:semicolon
r_if
c_cond
(paren
id|r-&gt;rtm_scope
op_eq
id|RT_SCOPE_HOST
)paren
(brace
r_struct
id|dn_fib_nh
op_star
id|nh
op_assign
id|fi-&gt;fib_nh
suffix:semicolon
multiline_comment|/* Local address is added */
r_if
c_cond
(paren
id|nhs
op_ne
l_int|1
op_logical_or
id|nh-&gt;nh_gw
)paren
r_goto
id|err_inval
suffix:semicolon
id|nh-&gt;nh_scope
op_assign
id|RT_SCOPE_NOWHERE
suffix:semicolon
id|nh-&gt;nh_dev
op_assign
id|dev_get_by_index
c_func
(paren
id|fi-&gt;fib_nh-&gt;nh_oif
)paren
suffix:semicolon
id|err
op_assign
op_minus
id|ENODEV
suffix:semicolon
r_if
c_cond
(paren
id|nh-&gt;nh_dev
op_eq
l_int|NULL
)paren
r_goto
id|failure
suffix:semicolon
)brace
r_else
(brace
id|change_nexthops
c_func
(paren
id|fi
)paren
(brace
r_if
c_cond
(paren
(paren
id|err
op_assign
id|dn_fib_check_nh
c_func
(paren
id|r
comma
id|fi
comma
id|nh
)paren
)paren
op_ne
l_int|0
)paren
r_goto
id|failure
suffix:semicolon
)brace
id|endfor_nexthops
c_func
(paren
id|fi
)paren
)brace
macro_line|#if I_GET_AROUND_TO_FIXING_PREFSRC
r_if
c_cond
(paren
id|fi-&gt;fib_prefsrc
)paren
(brace
r_if
c_cond
(paren
id|r-&gt;rtm_type
op_ne
id|RTN_LOCAL
op_logical_or
id|rta-&gt;rta_dst
op_eq
l_int|NULL
op_logical_or
id|memcmp
c_func
(paren
op_amp
id|fi-&gt;fib_prefsrc
comma
id|rta-&gt;rta_dst
comma
l_int|2
)paren
)paren
r_if
c_cond
(paren
id|dn_addr_type
c_func
(paren
id|fi-&gt;fib_prefsrc
)paren
op_ne
id|RTN_LOCAL
)paren
r_goto
id|err_inval
suffix:semicolon
)brace
macro_line|#endif
id|link_it
suffix:colon
r_if
c_cond
(paren
(paren
id|ofi
op_assign
id|dn_fib_find_info
c_func
(paren
id|fi
)paren
)paren
op_ne
l_int|NULL
)paren
(brace
id|fi-&gt;fib_dead
op_assign
l_int|1
suffix:semicolon
id|dn_fib_free_info
c_func
(paren
id|fi
)paren
suffix:semicolon
id|ofi-&gt;fib_treeref
op_increment
suffix:semicolon
r_return
id|ofi
suffix:semicolon
)brace
id|fi-&gt;fib_treeref
op_increment
suffix:semicolon
id|atomic_inc
c_func
(paren
op_amp
id|fi-&gt;fib_clntref
)paren
suffix:semicolon
id|write_lock
c_func
(paren
op_amp
id|dn_fib_info_lock
)paren
suffix:semicolon
id|fi-&gt;fib_next
op_assign
id|dn_fib_info_list
suffix:semicolon
id|fi-&gt;fib_prev
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
id|dn_fib_info_list
)paren
id|dn_fib_info_list-&gt;fib_prev
op_assign
id|fi
suffix:semicolon
id|dn_fib_info_list
op_assign
id|fi
suffix:semicolon
id|dn_fib_info_cnt
op_increment
suffix:semicolon
id|write_unlock
c_func
(paren
op_amp
id|dn_fib_info_lock
)paren
suffix:semicolon
r_return
id|fi
suffix:semicolon
id|err_inval
suffix:colon
id|err
op_assign
op_minus
id|EINVAL
suffix:semicolon
id|failure
suffix:colon
op_star
id|errp
op_assign
id|err
suffix:semicolon
r_if
c_cond
(paren
id|fi
)paren
(brace
id|fi-&gt;fib_dead
op_assign
l_int|1
suffix:semicolon
id|dn_fib_free_info
c_func
(paren
id|fi
)paren
suffix:semicolon
)brace
r_return
l_int|NULL
suffix:semicolon
)brace
DECL|function|dn_fib_select_multipath
r_void
id|dn_fib_select_multipath
c_func
(paren
r_const
r_struct
id|dn_fib_key
op_star
id|key
comma
r_struct
id|dn_fib_res
op_star
id|res
)paren
(brace
r_struct
id|dn_fib_info
op_star
id|fi
op_assign
id|res-&gt;fi
suffix:semicolon
r_int
id|w
suffix:semicolon
r_if
c_cond
(paren
id|fi-&gt;fib_power
op_le
l_int|0
)paren
(brace
r_int
id|power
op_assign
l_int|0
suffix:semicolon
id|change_nexthops
c_func
(paren
id|fi
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|nh-&gt;nh_flags
op_amp
id|RTNH_F_DEAD
)paren
)paren
(brace
id|power
op_add_assign
id|nh-&gt;nh_weight
suffix:semicolon
id|nh-&gt;nh_power
op_assign
id|nh-&gt;nh_weight
suffix:semicolon
)brace
)brace
id|endfor_nexthops
c_func
(paren
id|fi
)paren
suffix:semicolon
id|fi-&gt;fib_power
op_assign
id|power
suffix:semicolon
)brace
id|w
op_assign
id|jiffies
op_mod
id|fi-&gt;fib_power
suffix:semicolon
id|change_nexthops
c_func
(paren
id|fi
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|nh-&gt;nh_flags
op_amp
id|RTNH_F_DEAD
)paren
op_logical_and
id|nh-&gt;nh_power
)paren
(brace
r_if
c_cond
(paren
(paren
id|w
op_sub_assign
id|nh-&gt;nh_power
)paren
op_le
l_int|0
)paren
(brace
id|nh-&gt;nh_power
op_decrement
suffix:semicolon
id|fi-&gt;fib_power
op_decrement
suffix:semicolon
id|res-&gt;nh_sel
op_assign
id|nhsel
suffix:semicolon
r_return
suffix:semicolon
)brace
)brace
)brace
id|endfor_nexthops
c_func
(paren
id|fi
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;DECnet: BUG! dn_fib_select_multipath&bslash;n&quot;
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Punt to user via netlink for example, but for now&n; * we just drop it.&n; */
DECL|function|dn_fib_rt_message
r_int
id|dn_fib_rt_message
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
id|kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_RTNETLINK
DECL|function|dn_fib_check_attr
r_static
r_int
id|dn_fib_check_attr
c_func
(paren
r_struct
id|rtmsg
op_star
id|r
comma
r_struct
id|rtattr
op_star
op_star
id|rta
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|1
suffix:semicolon
id|i
op_le
id|RTA_MAX
suffix:semicolon
id|i
op_increment
)paren
(brace
r_struct
id|rtattr
op_star
id|attr
op_assign
id|rta
(braket
id|i
op_minus
l_int|1
)braket
suffix:semicolon
r_if
c_cond
(paren
id|attr
)paren
(brace
r_if
c_cond
(paren
id|RTA_PAYLOAD
c_func
(paren
id|attr
)paren
OL
l_int|4
op_logical_and
id|RTA_PAYLOAD
c_func
(paren
id|attr
)paren
op_ne
l_int|2
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|i
op_ne
id|RTA_MULTIPATH
op_logical_and
id|i
op_ne
id|RTA_METRICS
)paren
id|rta
(braket
id|i
op_minus
l_int|1
)braket
op_assign
(paren
r_struct
id|rtattr
op_star
)paren
id|RTA_DATA
c_func
(paren
id|attr
)paren
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|dn_fib_rtm_delroute
r_int
id|dn_fib_rtm_delroute
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|nlmsghdr
op_star
id|nlh
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|dn_fib_table
op_star
id|tb
suffix:semicolon
r_struct
id|rtattr
op_star
op_star
id|rta
op_assign
id|arg
suffix:semicolon
r_struct
id|rtmsg
op_star
id|r
op_assign
id|NLMSG_DATA
c_func
(paren
id|nlh
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dn_fib_check_attr
c_func
(paren
id|r
comma
id|rta
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|tb
op_assign
id|dn_fib_get_table
c_func
(paren
id|r-&gt;rtm_table
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tb
)paren
r_return
id|tb
op_member_access_from_pointer
r_delete
(paren
id|tb
comma
id|r
comma
(paren
r_struct
id|dn_kern_rta
op_star
)paren
id|rta
comma
id|nlh
comma
op_amp
id|NETLINK_CB
c_func
(paren
id|skb
)paren
)paren
suffix:semicolon
r_return
op_minus
id|ESRCH
suffix:semicolon
)brace
DECL|function|dn_fib_rtm_newroute
r_int
id|dn_fib_rtm_newroute
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|nlmsghdr
op_star
id|nlh
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|dn_fib_table
op_star
id|tb
suffix:semicolon
r_struct
id|rtattr
op_star
op_star
id|rta
op_assign
id|arg
suffix:semicolon
r_struct
id|rtmsg
op_star
id|r
op_assign
id|NLMSG_DATA
c_func
(paren
id|nlh
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dn_fib_check_attr
c_func
(paren
id|r
comma
id|rta
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|tb
op_assign
id|dn_fib_get_table
c_func
(paren
id|r-&gt;rtm_table
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tb
)paren
r_return
id|tb
op_member_access_from_pointer
id|insert
c_func
(paren
id|tb
comma
id|r
comma
(paren
r_struct
id|dn_kern_rta
op_star
)paren
id|rta
comma
id|nlh
comma
op_amp
id|NETLINK_CB
c_func
(paren
id|skb
)paren
)paren
suffix:semicolon
r_return
op_minus
id|ENOBUFS
suffix:semicolon
)brace
DECL|function|dn_fib_dump
r_int
id|dn_fib_dump
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|netlink_callback
op_star
id|cb
)paren
(brace
r_int
id|t
suffix:semicolon
r_int
id|s_t
suffix:semicolon
r_struct
id|dn_fib_table
op_star
id|tb
suffix:semicolon
r_if
c_cond
(paren
id|NLMSG_PAYLOAD
c_func
(paren
id|cb-&gt;nlh
comma
l_int|0
)paren
op_ge
r_sizeof
(paren
r_struct
id|rtmsg
)paren
op_logical_and
(paren
(paren
r_struct
id|rtmsg
op_star
)paren
id|NLMSG_DATA
c_func
(paren
id|cb-&gt;nlh
)paren
)paren
op_member_access_from_pointer
id|rtm_flags
op_amp
id|RTM_F_CLONED
)paren
r_return
id|dn_cache_dump
c_func
(paren
id|skb
comma
id|cb
)paren
suffix:semicolon
id|s_t
op_assign
id|cb-&gt;args
(braket
l_int|0
)braket
suffix:semicolon
r_if
c_cond
(paren
id|s_t
op_eq
l_int|0
)paren
id|s_t
op_assign
id|cb-&gt;args
(braket
l_int|0
)braket
op_assign
id|DN_MIN_TABLE
suffix:semicolon
r_for
c_loop
(paren
id|t
op_assign
id|s_t
suffix:semicolon
id|t
OL
id|DN_NUM_TABLES
suffix:semicolon
id|t
op_increment
)paren
(brace
r_if
c_cond
(paren
id|t
OL
id|s_t
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|t
OG
id|s_t
)paren
id|memset
c_func
(paren
op_amp
id|cb-&gt;args
(braket
l_int|1
)braket
comma
l_int|0
comma
r_sizeof
(paren
id|cb-&gt;args
)paren
op_minus
r_sizeof
(paren
r_int
)paren
)paren
suffix:semicolon
id|tb
op_assign
id|dn_fib_get_table
c_func
(paren
id|t
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tb
op_eq
l_int|NULL
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|tb
op_member_access_from_pointer
id|dump
c_func
(paren
id|tb
comma
id|skb
comma
id|cb
)paren
OL
l_int|0
)paren
r_break
suffix:semicolon
)brace
id|cb-&gt;args
(braket
l_int|0
)braket
op_assign
id|t
suffix:semicolon
r_return
id|skb-&gt;len
suffix:semicolon
)brace
macro_line|#endif /* CONFIG_RTNETLINK */
DECL|function|dn_fib_sync_down
r_int
id|dn_fib_sync_down
c_func
(paren
id|dn_address
id|local
comma
r_struct
id|net_device
op_star
id|dev
comma
r_int
id|force
)paren
(brace
r_int
id|ret
op_assign
l_int|0
suffix:semicolon
r_int
id|scope
op_assign
id|RT_SCOPE_NOWHERE
suffix:semicolon
r_if
c_cond
(paren
id|force
)paren
id|scope
op_assign
op_minus
l_int|1
suffix:semicolon
id|for_fib_info
c_func
(paren
)paren
(brace
multiline_comment|/* &n;                 * This makes no sense for DECnet.... we will almost&n;                 * certainly have more than one local address the same&n;                 * over all our interfaces. It needs thinking about&n;                 * some more.&n;                 */
r_if
c_cond
(paren
id|local
op_logical_and
id|fi-&gt;fib_prefsrc
op_eq
id|local
)paren
(brace
id|fi-&gt;fib_flags
op_or_assign
id|RTNH_F_DEAD
suffix:semicolon
id|ret
op_increment
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|dev
op_logical_and
id|fi-&gt;fib_nhs
)paren
(brace
r_int
id|dead
op_assign
l_int|0
suffix:semicolon
id|change_nexthops
c_func
(paren
id|fi
)paren
(brace
r_if
c_cond
(paren
id|nh-&gt;nh_flags
op_amp
id|RTNH_F_DEAD
)paren
id|dead
op_increment
suffix:semicolon
r_else
r_if
c_cond
(paren
id|nh-&gt;nh_dev
op_eq
id|dev
op_logical_and
id|nh-&gt;nh_scope
op_ne
id|scope
)paren
(brace
id|nh-&gt;nh_flags
op_or_assign
id|RTNH_F_DEAD
suffix:semicolon
id|fi-&gt;fib_power
op_sub_assign
id|nh-&gt;nh_power
suffix:semicolon
id|nh-&gt;nh_power
op_assign
l_int|0
suffix:semicolon
id|dead
op_increment
suffix:semicolon
)brace
)brace
id|endfor_nexthops
c_func
(paren
id|fi
)paren
r_if
c_cond
(paren
id|dead
op_eq
id|fi-&gt;fib_nhs
)paren
(brace
id|fi-&gt;fib_flags
op_or_assign
id|RTNH_F_DEAD
suffix:semicolon
id|ret
op_increment
suffix:semicolon
)brace
)brace
)brace
id|endfor_fib_info
c_func
(paren
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|dn_fib_sync_up
r_int
id|dn_fib_sync_up
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_int
id|ret
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|dev-&gt;flags
op_amp
id|IFF_UP
)paren
)paren
r_return
l_int|0
suffix:semicolon
id|for_fib_info
c_func
(paren
)paren
(brace
r_int
id|alive
op_assign
l_int|0
suffix:semicolon
id|change_nexthops
c_func
(paren
id|fi
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|nh-&gt;nh_flags
op_amp
id|RTNH_F_DEAD
)paren
)paren
(brace
id|alive
op_increment
suffix:semicolon
r_continue
suffix:semicolon
)brace
r_if
c_cond
(paren
id|nh-&gt;nh_dev
op_eq
l_int|NULL
op_logical_or
op_logical_neg
(paren
id|nh-&gt;nh_dev-&gt;flags
op_amp
id|IFF_UP
)paren
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|nh-&gt;nh_dev
op_ne
id|dev
op_logical_or
id|dev-&gt;dn_ptr
op_eq
l_int|NULL
)paren
r_continue
suffix:semicolon
id|alive
op_increment
suffix:semicolon
id|nh-&gt;nh_power
op_assign
l_int|0
suffix:semicolon
id|nh-&gt;nh_flags
op_and_assign
op_complement
id|RTNH_F_DEAD
suffix:semicolon
)brace
id|endfor_nexthops
c_func
(paren
id|fi
)paren
suffix:semicolon
r_if
c_cond
(paren
id|alive
op_eq
id|fi-&gt;fib_nhs
)paren
(brace
id|fi-&gt;fib_flags
op_and_assign
op_complement
id|RTNH_F_DEAD
suffix:semicolon
id|ret
op_increment
suffix:semicolon
)brace
)brace
id|endfor_fib_info
c_func
(paren
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
DECL|function|dn_fib_flush
r_void
id|dn_fib_flush
c_func
(paren
r_void
)paren
(brace
r_int
id|flushed
op_assign
l_int|0
suffix:semicolon
r_struct
id|dn_fib_table
op_star
id|tb
suffix:semicolon
r_int
id|id
suffix:semicolon
r_for
c_loop
(paren
id|id
op_assign
id|DN_NUM_TABLES
suffix:semicolon
id|id
OG
l_int|0
suffix:semicolon
id|id
op_decrement
)paren
(brace
r_if
c_cond
(paren
(paren
id|tb
op_assign
id|dn_fib_get_table
c_func
(paren
id|id
comma
l_int|0
)paren
)paren
op_eq
l_int|NULL
)paren
r_continue
suffix:semicolon
id|flushed
op_add_assign
id|tb
op_member_access_from_pointer
id|flush
c_func
(paren
id|tb
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|flushed
)paren
id|dn_rt_cache_flush
c_func
(paren
op_minus
l_int|1
)paren
suffix:semicolon
)brace
DECL|function|dn_fib_ioctl
r_int
id|dn_fib_ioctl
c_func
(paren
r_struct
id|socket
op_star
id|sock
comma
r_int
r_int
id|cmd
comma
r_int
r_int
id|arg
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|capable
c_func
(paren
id|CAP_NET_ADMIN
)paren
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|SIOCADDRT
suffix:colon
r_case
id|SIOCDELRT
suffix:colon
r_return
l_int|0
suffix:semicolon
)brace
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_PROC_FS
DECL|function|decnet_rt_get_info
r_static
r_int
id|decnet_rt_get_info
c_func
(paren
r_char
op_star
id|buffer
comma
r_char
op_star
op_star
id|start
comma
id|off_t
id|offset
comma
r_int
id|length
)paren
(brace
r_int
id|first
op_assign
id|offset
op_div
l_int|128
suffix:semicolon
r_char
op_star
id|ptr
op_assign
id|buffer
suffix:semicolon
r_int
id|count
op_assign
(paren
id|length
op_plus
l_int|127
)paren
op_div
l_int|128
suffix:semicolon
r_int
id|len
suffix:semicolon
r_int
id|i
suffix:semicolon
r_struct
id|dn_fib_table
op_star
id|tb
suffix:semicolon
op_star
id|start
op_assign
id|buffer
op_plus
(paren
id|offset
op_mod
l_int|128
)paren
suffix:semicolon
r_if
c_cond
(paren
op_decrement
id|first
OL
l_int|0
)paren
(brace
id|sprintf
c_func
(paren
id|buffer
comma
l_string|&quot;%-127s&bslash;n&quot;
comma
l_string|&quot;Iface&bslash;tDest&bslash;tGW  &bslash;tFlags&bslash;tRefCnt&bslash;tUse&bslash;tMetric&bslash;tMask&bslash;t&bslash;tMTU&bslash;tWindow&bslash;tIRTT&quot;
)paren
suffix:semicolon
op_decrement
id|count
suffix:semicolon
id|ptr
op_add_assign
l_int|128
suffix:semicolon
id|first
op_assign
l_int|0
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
id|DN_MIN_TABLE
suffix:semicolon
(paren
id|i
op_le
id|DN_NUM_TABLES
)paren
op_logical_and
(paren
id|count
OG
l_int|0
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|tb
op_assign
id|dn_fib_get_table
c_func
(paren
id|i
comma
l_int|0
)paren
)paren
op_ne
l_int|NULL
)paren
(brace
r_int
id|n
op_assign
id|tb
op_member_access_from_pointer
id|get_info
c_func
(paren
id|tb
comma
id|ptr
comma
id|first
comma
id|count
)paren
suffix:semicolon
id|count
op_sub_assign
id|n
suffix:semicolon
id|ptr
op_add_assign
id|n
op_star
l_int|128
suffix:semicolon
)brace
)brace
id|len
op_assign
id|ptr
op_minus
op_star
id|start
suffix:semicolon
r_if
c_cond
(paren
id|len
op_ge
id|length
)paren
r_return
id|length
suffix:semicolon
r_if
c_cond
(paren
id|len
op_ge
l_int|0
)paren
r_return
id|len
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif /* CONFIG_PROC_FS */
DECL|function|dn_fib_cleanup
r_void
id|__exit
id|dn_fib_cleanup
c_func
(paren
r_void
)paren
(brace
macro_line|#ifdef CONFIG_PROC_FS
id|proc_net_remove
c_func
(paren
l_string|&quot;decnet_route&quot;
)paren
suffix:semicolon
macro_line|#endif
id|dn_fib_table_cleanup
c_func
(paren
)paren
suffix:semicolon
id|dn_fib_rules_cleanup
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|function|dn_fib_init
r_void
id|__init
id|dn_fib_init
c_func
(paren
r_void
)paren
(brace
macro_line|#ifdef CONFIG_PROC_FS
id|proc_net_create
c_func
(paren
l_string|&quot;decnet_route&quot;
comma
l_int|0
comma
id|decnet_rt_get_info
)paren
suffix:semicolon
macro_line|#endif
id|dn_fib_table_init
c_func
(paren
)paren
suffix:semicolon
id|dn_fib_rules_init
c_func
(paren
)paren
suffix:semicolon
)brace
eof
