multiline_comment|/*&n;&n;kHTTPd -- the next generation&n;&n;RFC related functions (headers and stuff)&n;&n;*/
multiline_comment|/****************************************************************&n; *&t;This program is free software; you can redistribute it and/or modify&n; *&t;it under the terms of the GNU General Public License as published by&n; *&t;the Free Software Foundation; either version 2, or (at your option)&n; *&t;any later version.&n; *&n; *&t;This program is distributed in the hope that it will be useful,&n; *&t;but WITHOUT ANY WARRANTY; without even the implied warranty of&n; *&t;MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; *&t;GNU General Public License for more details.&n; *&n; *&t;You should have received a copy of the GNU General Public License&n; *&t;along with this program; if not, write to the Free Software&n; *&t;Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.&n; *&n; ****************************************************************/
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/ctype.h&gt;
macro_line|#include &lt;linux/errno.h&gt;
macro_line|#include &lt;linux/malloc.h&gt;
macro_line|#include &lt;linux/net.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/skbuff.h&gt;
macro_line|#include &lt;linux/unistd.h&gt;
macro_line|#include &lt;linux/file.h&gt;
macro_line|#include &lt;linux/smp_lock.h&gt;
macro_line|#include &lt;net/ip.h&gt;
macro_line|#include &lt;net/sock.h&gt;
macro_line|#include &lt;asm/atomic.h&gt;
macro_line|#include &lt;asm/semaphore.h&gt;
macro_line|#include &lt;asm/processor.h&gt;
macro_line|#include &lt;asm/uaccess.h&gt;
macro_line|#include &quot;prototypes.h&quot;
macro_line|#include &quot;structure.h&quot;
macro_line|#include &quot;sysctl.h&quot;
DECL|macro|KHTTPD_NUMMIMETYPES
mdefine_line|#define KHTTPD_NUMMIMETYPES &t;40
DECL|variable|MimeCount
r_static
id|atomic_t
id|MimeCount
suffix:semicolon
DECL|struct|MimeType
r_struct
id|MimeType
(brace
DECL|member|identifier
id|__u32
id|identifier
suffix:semicolon
DECL|member|type
r_char
id|type
(braket
l_int|64
op_minus
r_sizeof
(paren
id|__u32
)paren
op_minus
r_sizeof
(paren
id|__kernel_size_t
)paren
)braket
suffix:semicolon
DECL|member|len
id|__kernel_size_t
id|len
suffix:semicolon
)brace
suffix:semicolon
DECL|variable|MimeTypes
r_static
r_struct
id|MimeType
id|MimeTypes
(braket
id|KHTTPD_NUMMIMETYPES
)braket
suffix:semicolon
DECL|function|AddMimeType
r_void
id|AddMimeType
c_func
(paren
r_const
r_char
op_star
id|Ident
comma
r_const
r_char
op_star
id|Type
)paren
(brace
id|__u32
op_star
id|I
suffix:semicolon
id|EnterFunction
c_func
(paren
l_string|&quot;AddMimeType&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|strlen
c_func
(paren
id|Ident
)paren
op_ne
l_int|4
)paren
(brace
(paren
r_void
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;httpd: Only 4-byte mime-identifiers are accepted&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|strlen
c_func
(paren
id|Type
)paren
OG
(paren
l_int|64
op_minus
r_sizeof
(paren
id|__u32
)paren
op_minus
r_sizeof
(paren
id|__kernel_size_t
)paren
)paren
)paren
(brace
(paren
r_void
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;httpd: Mime-string too long.&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|I
op_assign
(paren
id|__u32
op_star
)paren
id|Ident
suffix:semicolon
multiline_comment|/* FIXME: Need to lock-down all access to the mime-structure here */
multiline_comment|/*        For now, just don&squot;t add mime-types after initialisation */
id|MimeTypes
(braket
id|atomic_read
c_func
(paren
op_amp
id|MimeCount
)paren
)braket
dot
id|identifier
op_assign
op_star
id|I
suffix:semicolon
id|strncpy
c_func
(paren
id|MimeTypes
(braket
id|atomic_read
c_func
(paren
op_amp
id|MimeCount
)paren
)braket
dot
id|type
comma
id|Type
comma
(paren
l_int|64
op_minus
r_sizeof
(paren
id|__u32
)paren
op_minus
r_sizeof
(paren
id|__kernel_size_t
)paren
)paren
)paren
suffix:semicolon
id|MimeTypes
(braket
id|atomic_read
c_func
(paren
op_amp
id|MimeCount
)paren
)braket
dot
id|len
op_assign
id|strlen
c_func
(paren
id|Type
)paren
suffix:semicolon
id|atomic_inc
c_func
(paren
op_amp
id|MimeCount
)paren
suffix:semicolon
id|LeaveFunction
c_func
(paren
l_string|&quot;AddMimeType&quot;
)paren
suffix:semicolon
)brace
DECL|function|ResolveMimeType
r_char
op_star
id|ResolveMimeType
c_func
(paren
r_const
r_char
op_star
id|File
comma
id|__kernel_size_t
op_star
id|Len
)paren
multiline_comment|/*&n;&n;&t;The returned string is for READ ONLY, ownership of the memory is NOT&n;&t;transfered.&n;&n;*/
(brace
id|__u32
op_star
id|I
suffix:semicolon
r_int
id|pos
comma
id|lc
comma
id|filelen
suffix:semicolon
id|EnterFunction
c_func
(paren
l_string|&quot;ResolveMimeType&quot;
)paren
suffix:semicolon
op_star
id|Len
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|File
op_eq
l_int|NULL
)paren
r_return
l_int|NULL
suffix:semicolon
id|filelen
op_assign
(paren
r_int
)paren
id|strlen
c_func
(paren
id|File
)paren
suffix:semicolon
r_if
c_cond
(paren
id|filelen
OL
l_int|4
)paren
(brace
r_return
l_int|NULL
suffix:semicolon
)brace
multiline_comment|/* The Merced-people are NOT going to like this! So this has to be fixed&n;   &t;   in a later stage. */
id|pos
op_assign
id|filelen
op_minus
l_int|4
suffix:semicolon
id|I
op_assign
(paren
id|__u32
op_star
)paren
(paren
id|File
op_plus
id|pos
)paren
suffix:semicolon
id|lc
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|lc
OL
id|atomic_read
c_func
(paren
op_amp
id|MimeCount
)paren
)paren
(brace
r_if
c_cond
(paren
id|MimeTypes
(braket
id|lc
)braket
dot
id|identifier
op_eq
op_star
id|I
)paren
(brace
op_star
id|Len
op_assign
id|MimeTypes
(braket
id|lc
)braket
dot
id|len
suffix:semicolon
id|LeaveFunction
c_func
(paren
l_string|&quot;ResolveMimeType - success&quot;
)paren
suffix:semicolon
r_return
id|MimeTypes
(braket
id|lc
)braket
dot
id|type
suffix:semicolon
)brace
id|lc
op_increment
suffix:semicolon
)brace
r_if
c_cond
(paren
id|sysctl_khttpd_sloppymime
)paren
(brace
op_star
id|Len
op_assign
id|MimeTypes
(braket
l_int|0
)braket
dot
id|len
suffix:semicolon
id|LeaveFunction
c_func
(paren
l_string|&quot;ResolveMimeType - unknown&quot;
)paren
suffix:semicolon
r_return
id|MimeTypes
(braket
l_int|0
)braket
dot
id|type
suffix:semicolon
)brace
r_else
(brace
id|LeaveFunction
c_func
(paren
l_string|&quot;ResolveMimeType - failure&quot;
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
)brace
DECL|variable|HeaderPart1
r_static
r_char
id|HeaderPart1
(braket
)braket
op_assign
l_string|&quot;HTTP/1.0 200 OK&bslash;r&bslash;nServer: kHTTPd/0.1.6&bslash;r&bslash;nDate: &quot;
suffix:semicolon
macro_line|#ifdef BENCHMARK
DECL|variable|HeaderPart1b
r_static
r_char
id|HeaderPart1b
(braket
)braket
op_assign
l_string|&quot;HTTP/1.0 200 OK&quot;
suffix:semicolon
macro_line|#endif
DECL|variable|HeaderPart3
r_static
r_char
id|HeaderPart3
(braket
)braket
op_assign
l_string|&quot;&bslash;r&bslash;nContent-type: &quot;
suffix:semicolon
DECL|variable|HeaderPart5
r_static
r_char
id|HeaderPart5
(braket
)braket
op_assign
l_string|&quot;&bslash;r&bslash;nLast-modified: &quot;
suffix:semicolon
DECL|variable|HeaderPart7
r_static
r_char
id|HeaderPart7
(braket
)braket
op_assign
l_string|&quot;&bslash;r&bslash;nContent-length: &quot;
suffix:semicolon
DECL|variable|HeaderPart9
r_static
r_char
id|HeaderPart9
(braket
)braket
op_assign
l_string|&quot;&bslash;r&bslash;n&bslash;r&bslash;n&quot;
suffix:semicolon
macro_line|#ifdef BENCHMARK
multiline_comment|/* In BENCHMARK-mode, just send the bare essentials */
DECL|function|SendHTTPHeader
r_void
id|SendHTTPHeader
c_func
(paren
r_struct
id|http_request
op_star
id|Request
)paren
(brace
r_struct
id|msghdr
id|msg
suffix:semicolon
id|mm_segment_t
id|oldfs
suffix:semicolon
r_struct
id|iovec
id|iov
(braket
l_int|9
)braket
suffix:semicolon
r_int
id|len
comma
id|len2
suffix:semicolon
id|EnterFunction
c_func
(paren
l_string|&quot;SendHTTPHeader&quot;
)paren
suffix:semicolon
id|msg.msg_name
op_assign
l_int|0
suffix:semicolon
id|msg.msg_namelen
op_assign
l_int|0
suffix:semicolon
id|msg.msg_iov
op_assign
op_amp
id|iov
(braket
l_int|0
)braket
suffix:semicolon
id|msg.msg_iovlen
op_assign
l_int|6
suffix:semicolon
id|msg.msg_control
op_assign
l_int|NULL
suffix:semicolon
id|msg.msg_controllen
op_assign
l_int|0
suffix:semicolon
id|msg.msg_flags
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* Synchronous for now */
id|iov
(braket
l_int|0
)braket
dot
id|iov_base
op_assign
id|HeaderPart1b
suffix:semicolon
id|iov
(braket
l_int|0
)braket
dot
id|iov_len
op_assign
l_int|15
suffix:semicolon
id|iov
(braket
l_int|1
)braket
dot
id|iov_base
op_assign
id|HeaderPart3
suffix:semicolon
id|iov
(braket
l_int|1
)braket
dot
id|iov_len
op_assign
l_int|16
suffix:semicolon
id|iov
(braket
l_int|2
)braket
dot
id|iov_base
op_assign
id|Request-&gt;MimeType
suffix:semicolon
id|iov
(braket
l_int|2
)braket
dot
id|iov_len
op_assign
id|Request-&gt;MimeLength
suffix:semicolon
id|iov
(braket
l_int|3
)braket
dot
id|iov_base
op_assign
id|HeaderPart7
suffix:semicolon
id|iov
(braket
l_int|3
)braket
dot
id|iov_len
op_assign
l_int|18
suffix:semicolon
id|sprintf
c_func
(paren
id|Request-&gt;LengthS
comma
l_string|&quot;%i&quot;
comma
id|Request-&gt;FileLength
)paren
suffix:semicolon
id|iov
(braket
l_int|4
)braket
dot
id|iov_base
op_assign
id|Request-&gt;LengthS
suffix:semicolon
id|iov
(braket
l_int|4
)braket
dot
id|iov_len
op_assign
id|strlen
c_func
(paren
id|Request-&gt;LengthS
)paren
suffix:semicolon
id|iov
(braket
l_int|5
)braket
dot
id|iov_base
op_assign
id|HeaderPart9
suffix:semicolon
id|iov
(braket
l_int|5
)braket
dot
id|iov_len
op_assign
l_int|4
suffix:semicolon
id|len2
op_assign
l_int|15
op_plus
l_int|16
op_plus
l_int|18
op_plus
id|iov
(braket
l_int|2
)braket
dot
id|iov_len
op_plus
id|iov
(braket
l_int|4
)braket
dot
id|iov_len
op_plus
l_int|4
suffix:semicolon
id|len
op_assign
l_int|0
suffix:semicolon
id|oldfs
op_assign
id|get_fs
c_func
(paren
)paren
suffix:semicolon
id|set_fs
c_func
(paren
id|KERNEL_DS
)paren
suffix:semicolon
id|len
op_assign
id|sock_sendmsg
c_func
(paren
id|Request-&gt;sock
comma
op_amp
id|msg
comma
id|len2
)paren
suffix:semicolon
id|set_fs
c_func
(paren
id|oldfs
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
macro_line|#else
DECL|function|SendHTTPHeader
r_void
id|SendHTTPHeader
c_func
(paren
r_struct
id|http_request
op_star
id|Request
)paren
(brace
r_struct
id|msghdr
id|msg
suffix:semicolon
id|mm_segment_t
id|oldfs
suffix:semicolon
r_struct
id|iovec
id|iov
(braket
l_int|9
)braket
suffix:semicolon
r_int
id|len
comma
id|len2
suffix:semicolon
id|__kernel_size_t
id|slen
suffix:semicolon
id|EnterFunction
c_func
(paren
l_string|&quot;SendHTTPHeader&quot;
)paren
suffix:semicolon
id|msg.msg_name
op_assign
l_int|0
suffix:semicolon
id|msg.msg_namelen
op_assign
l_int|0
suffix:semicolon
id|msg.msg_iov
op_assign
op_amp
(paren
id|iov
(braket
l_int|0
)braket
)paren
suffix:semicolon
id|msg.msg_iovlen
op_assign
l_int|9
suffix:semicolon
id|msg.msg_control
op_assign
l_int|NULL
suffix:semicolon
id|msg.msg_controllen
op_assign
l_int|0
suffix:semicolon
id|msg.msg_flags
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* Synchronous for now */
id|iov
(braket
l_int|0
)braket
dot
id|iov_base
op_assign
id|HeaderPart1
suffix:semicolon
id|iov
(braket
l_int|0
)braket
dot
id|iov_len
op_assign
l_int|45
suffix:semicolon
id|iov
(braket
l_int|1
)braket
dot
id|iov_base
op_assign
id|CurrentTime
suffix:semicolon
id|iov
(braket
l_int|1
)braket
dot
id|iov_len
op_assign
l_int|29
suffix:semicolon
id|iov
(braket
l_int|2
)braket
dot
id|iov_base
op_assign
id|HeaderPart3
suffix:semicolon
id|iov
(braket
l_int|2
)braket
dot
id|iov_len
op_assign
l_int|16
suffix:semicolon
id|iov
(braket
l_int|3
)braket
dot
id|iov_base
op_assign
id|Request-&gt;MimeType
suffix:semicolon
id|iov
(braket
l_int|3
)braket
dot
id|iov_len
op_assign
id|Request-&gt;MimeLength
suffix:semicolon
id|iov
(braket
l_int|4
)braket
dot
id|iov_base
op_assign
id|HeaderPart5
suffix:semicolon
id|iov
(braket
l_int|4
)braket
dot
id|iov_len
op_assign
l_int|17
suffix:semicolon
id|iov
(braket
l_int|5
)braket
dot
id|iov_base
op_assign
op_amp
(paren
id|Request-&gt;TimeS
(braket
l_int|0
)braket
)paren
suffix:semicolon
id|iov
(braket
l_int|5
)braket
dot
id|iov_len
op_assign
l_int|29
suffix:semicolon
id|iov
(braket
l_int|6
)braket
dot
id|iov_base
op_assign
id|HeaderPart7
suffix:semicolon
id|iov
(braket
l_int|6
)braket
dot
id|iov_len
op_assign
l_int|18
suffix:semicolon
id|iov
(braket
l_int|7
)braket
dot
id|iov_base
op_assign
op_amp
(paren
id|Request-&gt;LengthS
(braket
l_int|0
)braket
)paren
suffix:semicolon
id|slen
op_assign
id|strlen
c_func
(paren
id|Request-&gt;LengthS
)paren
suffix:semicolon
id|iov
(braket
l_int|7
)braket
dot
id|iov_len
op_assign
id|slen
suffix:semicolon
id|iov
(braket
l_int|8
)braket
dot
id|iov_base
op_assign
id|HeaderPart9
suffix:semicolon
id|iov
(braket
l_int|8
)braket
dot
id|iov_len
op_assign
l_int|4
suffix:semicolon
id|len2
op_assign
l_int|45
op_plus
l_int|2
op_star
l_int|29
op_plus
l_int|16
op_plus
l_int|17
op_plus
l_int|18
op_plus
id|slen
op_plus
l_int|4
op_plus
id|iov
(braket
l_int|3
)braket
dot
id|iov_len
suffix:semicolon
id|len
op_assign
l_int|0
suffix:semicolon
id|oldfs
op_assign
id|get_fs
c_func
(paren
)paren
suffix:semicolon
id|set_fs
c_func
(paren
id|KERNEL_DS
)paren
suffix:semicolon
id|len
op_assign
id|sock_sendmsg
c_func
(paren
id|Request-&gt;sock
comma
op_amp
id|msg
comma
id|len2
)paren
suffix:semicolon
id|set_fs
c_func
(paren
id|oldfs
)paren
suffix:semicolon
id|LeaveFunction
c_func
(paren
l_string|&quot;SendHTTPHeader&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
macro_line|#endif
multiline_comment|/* &n;&n;Parse a HTTP-header. Be careful for buffer-overflows here, this is the most important&n;place for this, since the remote-user controls the data.&n;&n;*/
DECL|function|ParseHeader
r_void
id|ParseHeader
c_func
(paren
r_char
op_star
id|Buffer
comma
r_const
r_int
id|length
comma
r_struct
id|http_request
op_star
id|Head
)paren
(brace
r_char
op_star
id|Endval
comma
op_star
id|EOL
comma
op_star
id|tmp
suffix:semicolon
id|EnterFunction
c_func
(paren
l_string|&quot;ParseHeader&quot;
)paren
suffix:semicolon
id|Endval
op_assign
id|Buffer
op_plus
id|length
suffix:semicolon
multiline_comment|/* We want to parse only the first header if multiple headers are present */
id|tmp
op_assign
id|strstr
c_func
(paren
id|Buffer
comma
l_string|&quot;&bslash;r&bslash;n&bslash;r&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tmp
op_ne
l_int|NULL
)paren
id|Endval
op_assign
id|tmp
suffix:semicolon
r_while
c_loop
(paren
id|Buffer
OL
id|Endval
)paren
(brace
r_if
c_cond
(paren
id|isspace
c_func
(paren
id|Buffer
(braket
l_int|0
)braket
)paren
)paren
(brace
id|Buffer
op_increment
suffix:semicolon
r_continue
suffix:semicolon
)brace
id|EOL
op_assign
id|strchr
c_func
(paren
id|Buffer
comma
l_char|&squot;&bslash;n&squot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|EOL
op_eq
l_int|NULL
)paren
id|EOL
op_assign
id|Endval
suffix:semicolon
r_if
c_cond
(paren
id|EOL
op_minus
id|Buffer
OL
l_int|4
)paren
(brace
id|Buffer
op_increment
suffix:semicolon
r_continue
suffix:semicolon
)brace
r_if
c_cond
(paren
id|strncmp
c_func
(paren
l_string|&quot;GET &quot;
comma
id|Buffer
comma
l_int|4
)paren
op_eq
l_int|0
)paren
(brace
r_int
id|PrefixLen
suffix:semicolon
id|Buffer
op_add_assign
l_int|4
suffix:semicolon
id|tmp
op_assign
id|strchr
c_func
(paren
id|Buffer
comma
l_char|&squot; &squot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tmp
op_eq
l_int|0
)paren
(brace
id|tmp
op_assign
id|EOL
op_minus
l_int|1
suffix:semicolon
id|Head-&gt;HTTPVER
op_assign
l_int|9
suffix:semicolon
)brace
r_else
id|Head-&gt;HTTPVER
op_assign
l_int|10
suffix:semicolon
r_if
c_cond
(paren
id|tmp
OG
id|Endval
)paren
r_continue
suffix:semicolon
id|strncpy
c_func
(paren
id|Head-&gt;FileName
comma
id|sysctl_khttpd_docroot
comma
r_sizeof
(paren
id|Head-&gt;FileName
)paren
)paren
suffix:semicolon
id|PrefixLen
op_assign
id|strlen
c_func
(paren
id|sysctl_khttpd_docroot
)paren
suffix:semicolon
id|Head-&gt;FileNameLength
op_assign
id|min
c_func
(paren
l_int|255
comma
id|tmp
op_minus
id|Buffer
op_plus
id|PrefixLen
)paren
suffix:semicolon
id|strncat
c_func
(paren
id|Head-&gt;FileName
comma
id|Buffer
comma
id|min
c_func
(paren
l_int|255
op_minus
id|PrefixLen
comma
id|tmp
op_minus
id|Buffer
)paren
)paren
suffix:semicolon
id|Buffer
op_assign
id|EOL
op_plus
l_int|1
suffix:semicolon
macro_line|#ifdef BENCHMARK
r_break
suffix:semicolon
macro_line|#endif&t;&t;&t;&t;&t;&t;
r_continue
suffix:semicolon
)brace
macro_line|#ifndef BENCHMARK&t;&t;
r_if
c_cond
(paren
id|strncmp
c_func
(paren
l_string|&quot;If-Modified-Since: &quot;
comma
id|Buffer
comma
l_int|19
)paren
op_eq
l_int|0
)paren
(brace
id|Buffer
op_add_assign
l_int|19
suffix:semicolon
id|strncpy
c_func
(paren
id|Head-&gt;IMS
comma
id|Buffer
comma
id|min
c_func
(paren
l_int|127
comma
id|EOL
op_minus
id|Buffer
op_minus
l_int|1
)paren
)paren
suffix:semicolon
id|Buffer
op_assign
id|EOL
op_plus
l_int|1
suffix:semicolon
r_continue
suffix:semicolon
)brace
r_if
c_cond
(paren
id|strncmp
c_func
(paren
l_string|&quot;User-Agent: &quot;
comma
id|Buffer
comma
l_int|12
)paren
op_eq
l_int|0
)paren
(brace
id|Buffer
op_add_assign
l_int|12
suffix:semicolon
id|strncpy
c_func
(paren
id|Head-&gt;Agent
comma
id|Buffer
comma
id|min
c_func
(paren
l_int|127
comma
id|EOL
op_minus
id|Buffer
op_minus
l_int|1
)paren
)paren
suffix:semicolon
id|Buffer
op_assign
id|EOL
op_plus
l_int|1
suffix:semicolon
r_continue
suffix:semicolon
)brace
r_if
c_cond
(paren
id|strncmp
c_func
(paren
l_string|&quot;Host: &quot;
comma
id|Buffer
comma
l_int|6
)paren
op_eq
l_int|0
)paren
(brace
id|Buffer
op_add_assign
l_int|6
suffix:semicolon
id|strncpy
c_func
(paren
id|Head-&gt;Host
comma
id|Buffer
comma
id|min
c_func
(paren
l_int|127
comma
id|EOL
op_minus
id|Buffer
op_minus
l_int|1
)paren
)paren
suffix:semicolon
id|Buffer
op_assign
id|EOL
op_plus
l_int|1
suffix:semicolon
r_continue
suffix:semicolon
)brace
macro_line|#endif&t;&t;
id|Buffer
op_assign
id|EOL
op_plus
l_int|1
suffix:semicolon
multiline_comment|/* Skip line */
)brace
id|LeaveFunction
c_func
(paren
l_string|&quot;ParseHeader&quot;
)paren
suffix:semicolon
)brace
eof
