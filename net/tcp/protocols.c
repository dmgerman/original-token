multiline_comment|/* protocols.c */
multiline_comment|/* these headers are overkill, but until I clean up the socket header&n;   files, this is the best way. */
macro_line|#include &lt;asm/segment.h&gt;
macro_line|#include &lt;asm/system.h&gt;
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/socket.h&gt;
macro_line|#include &lt;netinet/in.h&gt;
macro_line|#include &quot;timer.h&quot;
macro_line|#include &quot;ip.h&quot;
macro_line|#include &quot;tcp.h&quot;
macro_line|#include &quot;sock.h&quot;
macro_line|#include &quot;icmp.h&quot;
r_int
id|udp_rcv
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|device
op_star
id|dev
comma
r_struct
id|options
op_star
id|opt
comma
r_int
r_int
id|daddr
comma
r_int
r_int
id|len
comma
r_int
r_int
id|saddr
comma
r_int
id|redo
comma
r_struct
id|ip_protocol
op_star
id|protocol
)paren
suffix:semicolon
r_void
id|udp_err
(paren
r_int
id|err
comma
r_int
r_char
op_star
id|header
comma
r_int
r_int
id|daddr
comma
r_int
r_int
id|saddr
comma
r_struct
id|ip_protocol
op_star
id|protocol
)paren
suffix:semicolon
r_int
id|tcp_rcv
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|device
op_star
id|dev
comma
r_struct
id|options
op_star
id|opt
comma
r_int
r_int
id|daddr
comma
r_int
r_int
id|len
comma
r_int
r_int
id|saddr
comma
r_int
id|redo
comma
r_struct
id|ip_protocol
op_star
id|protocol
)paren
suffix:semicolon
r_void
id|tcp_err
(paren
r_int
id|err
comma
r_int
r_char
op_star
id|header
comma
r_int
r_int
id|daddr
comma
r_int
r_int
id|saddr
comma
r_struct
id|ip_protocol
op_star
id|protocol
)paren
suffix:semicolon
r_int
id|icmp_rcv
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|device
op_star
id|dev
comma
r_struct
id|options
op_star
id|opt
comma
r_int
r_int
id|daddr
comma
r_int
r_int
id|len
comma
r_int
r_int
id|saddr
comma
r_int
id|redo
comma
r_struct
id|ip_protocol
op_star
id|protocol
)paren
suffix:semicolon
DECL|variable|tcp_protocol
r_static
r_struct
id|ip_protocol
id|tcp_protocol
op_assign
(brace
id|tcp_rcv
comma
id|tcp_err
comma
l_int|NULL
comma
id|IPPROTO_TCP
comma
l_int|0
comma
multiline_comment|/* copy */
l_int|NULL
)brace
suffix:semicolon
DECL|variable|udp_protocol
r_static
r_struct
id|ip_protocol
id|udp_protocol
op_assign
(brace
id|udp_rcv
comma
id|udp_err
comma
op_amp
id|tcp_protocol
comma
id|IPPROTO_UDP
comma
l_int|0
comma
multiline_comment|/* copy */
l_int|NULL
)brace
suffix:semicolon
DECL|variable|icmp_protocol
r_static
r_struct
id|ip_protocol
id|icmp_protocol
op_assign
(brace
id|icmp_rcv
comma
l_int|NULL
comma
op_amp
id|udp_protocol
comma
id|IPPROTO_ICMP
comma
l_int|0
comma
multiline_comment|/* copy */
l_int|NULL
)brace
suffix:semicolon
DECL|variable|ip_protocol_base
r_struct
id|ip_protocol
op_star
id|ip_protocol_base
op_assign
op_amp
id|icmp_protocol
suffix:semicolon
eof
