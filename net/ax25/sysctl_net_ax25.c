multiline_comment|/* -*- linux-c -*-&n; * sysctl_net_ax25.c: sysctl interface to net AX.25 subsystem.&n; *&n; * Begun April 1, 1996, Mike Shaver.&n; * Added /proc/sys/net/ax25 directory entry (empty =) ). [MS]&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/sysctl.h&gt;
macro_line|#include &lt;net/ax25.h&gt;
DECL|variable|min_ipdefmode
DECL|variable|max_ipdefmode
r_static
r_int
id|min_ipdefmode
(braket
)braket
op_assign
(brace
l_int|0
)brace
comma
id|max_ipdefmode
(braket
)braket
op_assign
(brace
l_int|1
)brace
suffix:semicolon
DECL|variable|min_axdefmode
DECL|variable|max_axdefmode
r_static
r_int
id|min_axdefmode
(braket
)braket
op_assign
(brace
l_int|0
)brace
comma
id|max_axdefmode
(braket
)braket
op_assign
(brace
l_int|1
)brace
suffix:semicolon
DECL|variable|min_backoff
DECL|variable|max_backoff
r_static
r_int
id|min_backoff
(braket
)braket
op_assign
(brace
l_int|0
)brace
comma
id|max_backoff
(braket
)braket
op_assign
(brace
l_int|2
)brace
suffix:semicolon
DECL|variable|min_conmode
DECL|variable|max_conmode
r_static
r_int
id|min_conmode
(braket
)braket
op_assign
(brace
l_int|0
)brace
comma
id|max_conmode
(braket
)braket
op_assign
(brace
l_int|2
)brace
suffix:semicolon
DECL|variable|min_window
DECL|variable|max_window
r_static
r_int
id|min_window
(braket
)braket
op_assign
(brace
l_int|1
)brace
comma
id|max_window
(braket
)braket
op_assign
(brace
l_int|7
)brace
suffix:semicolon
DECL|variable|min_ewindow
DECL|variable|max_ewindow
r_static
r_int
id|min_ewindow
(braket
)braket
op_assign
(brace
l_int|1
)brace
comma
id|max_ewindow
(braket
)braket
op_assign
(brace
l_int|63
)brace
suffix:semicolon
DECL|variable|min_t1
DECL|variable|max_t1
r_static
r_int
id|min_t1
(braket
)braket
op_assign
(brace
l_int|1
)brace
comma
id|max_t1
(braket
)braket
op_assign
(brace
l_int|30
op_star
id|HZ
)brace
suffix:semicolon
DECL|variable|min_t2
DECL|variable|max_t2
r_static
r_int
id|min_t2
(braket
)braket
op_assign
(brace
l_int|1
)brace
comma
id|max_t2
(braket
)braket
op_assign
(brace
l_int|20
op_star
id|HZ
)brace
suffix:semicolon
DECL|variable|min_t3
DECL|variable|max_t3
r_static
r_int
id|min_t3
(braket
)braket
op_assign
(brace
l_int|0
)brace
comma
id|max_t3
(braket
)braket
op_assign
(brace
l_int|3600
op_star
id|HZ
)brace
suffix:semicolon
DECL|variable|min_idle
DECL|variable|max_idle
r_static
r_int
id|min_idle
(braket
)braket
op_assign
(brace
l_int|0
)brace
comma
id|max_idle
(braket
)braket
op_assign
(brace
l_int|65535
op_star
id|HZ
)brace
suffix:semicolon
DECL|variable|min_n2
DECL|variable|max_n2
r_static
r_int
id|min_n2
(braket
)braket
op_assign
(brace
l_int|1
)brace
comma
id|max_n2
(braket
)braket
op_assign
(brace
l_int|31
)brace
suffix:semicolon
DECL|variable|min_paclen
DECL|variable|max_paclen
r_static
r_int
id|min_paclen
(braket
)braket
op_assign
(brace
l_int|1
)brace
comma
id|max_paclen
(braket
)braket
op_assign
(brace
l_int|512
)brace
suffix:semicolon
DECL|variable|min_proto
DECL|variable|max_proto
r_static
r_int
id|min_proto
(braket
)braket
op_assign
(brace
l_int|0
)brace
comma
id|max_proto
(braket
)braket
op_assign
(brace
l_int|3
)brace
suffix:semicolon
DECL|variable|min_ds_timeout
DECL|variable|max_ds_timeout
r_static
r_int
id|min_ds_timeout
(braket
)braket
op_assign
(brace
l_int|0
)brace
comma
id|max_ds_timeout
(braket
)braket
op_assign
(brace
l_int|65535
op_star
id|HZ
)brace
suffix:semicolon
DECL|variable|ax25_table_header
r_static
r_struct
id|ctl_table_header
op_star
id|ax25_table_header
suffix:semicolon
DECL|variable|ax25_table
r_static
id|ctl_table
op_star
id|ax25_table
op_assign
l_int|NULL
suffix:semicolon
DECL|variable|ax25_table_size
r_static
r_int
id|ax25_table_size
op_assign
l_int|0
suffix:semicolon
DECL|variable|ax25_dir_table
r_static
id|ctl_table
id|ax25_dir_table
(braket
)braket
op_assign
(brace
(brace
id|NET_AX25
comma
l_string|&quot;ax25&quot;
comma
l_int|NULL
comma
l_int|0
comma
l_int|0555
comma
l_int|NULL
)brace
comma
(brace
l_int|0
)brace
)brace
suffix:semicolon
DECL|variable|ax25_root_table
r_static
id|ctl_table
id|ax25_root_table
(braket
)braket
op_assign
(brace
(brace
id|CTL_NET
comma
l_string|&quot;net&quot;
comma
l_int|NULL
comma
l_int|0
comma
l_int|0555
comma
id|ax25_dir_table
)brace
comma
(brace
l_int|0
)brace
)brace
suffix:semicolon
DECL|variable|ax25_param_table
r_static
r_const
id|ctl_table
id|ax25_param_table
(braket
)braket
op_assign
(brace
(brace
id|NET_AX25_IP_DEFAULT_MODE
comma
l_string|&quot;ip_default_mode&quot;
comma
l_int|NULL
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec_minmax
comma
op_amp
id|sysctl_intvec
comma
l_int|NULL
comma
op_amp
id|min_ipdefmode
comma
op_amp
id|max_ipdefmode
)brace
comma
(brace
id|NET_AX25_DEFAULT_MODE
comma
l_string|&quot;ax25_default_mode&quot;
comma
l_int|NULL
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec_minmax
comma
op_amp
id|sysctl_intvec
comma
l_int|NULL
comma
op_amp
id|min_axdefmode
comma
op_amp
id|max_axdefmode
)brace
comma
(brace
id|NET_AX25_BACKOFF_TYPE
comma
l_string|&quot;backoff_type&quot;
comma
l_int|NULL
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec_minmax
comma
op_amp
id|sysctl_intvec
comma
l_int|NULL
comma
op_amp
id|min_backoff
comma
op_amp
id|max_backoff
)brace
comma
(brace
id|NET_AX25_CONNECT_MODE
comma
l_string|&quot;connect_mode&quot;
comma
l_int|NULL
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec_minmax
comma
op_amp
id|sysctl_intvec
comma
l_int|NULL
comma
op_amp
id|min_conmode
comma
op_amp
id|max_conmode
)brace
comma
(brace
id|NET_AX25_STANDARD_WINDOW
comma
l_string|&quot;standard_window_size&quot;
comma
l_int|NULL
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec_minmax
comma
op_amp
id|sysctl_intvec
comma
l_int|NULL
comma
op_amp
id|min_window
comma
op_amp
id|max_window
)brace
comma
(brace
id|NET_AX25_EXTENDED_WINDOW
comma
l_string|&quot;extended_window_size&quot;
comma
l_int|NULL
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec_minmax
comma
op_amp
id|sysctl_intvec
comma
l_int|NULL
comma
op_amp
id|min_ewindow
comma
op_amp
id|max_ewindow
)brace
comma
(brace
id|NET_AX25_T1_TIMEOUT
comma
l_string|&quot;t1_timeout&quot;
comma
l_int|NULL
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec_minmax
comma
op_amp
id|sysctl_intvec
comma
l_int|NULL
comma
op_amp
id|min_t1
comma
op_amp
id|max_t1
)brace
comma
(brace
id|NET_AX25_T2_TIMEOUT
comma
l_string|&quot;t2_timeout&quot;
comma
l_int|NULL
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec_minmax
comma
op_amp
id|sysctl_intvec
comma
l_int|NULL
comma
op_amp
id|min_t2
comma
op_amp
id|max_t2
)brace
comma
(brace
id|NET_AX25_T3_TIMEOUT
comma
l_string|&quot;t3_timeout&quot;
comma
l_int|NULL
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec_minmax
comma
op_amp
id|sysctl_intvec
comma
l_int|NULL
comma
op_amp
id|min_t3
comma
op_amp
id|max_t3
)brace
comma
(brace
id|NET_AX25_IDLE_TIMEOUT
comma
l_string|&quot;idle_timeout&quot;
comma
l_int|NULL
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec_minmax
comma
op_amp
id|sysctl_intvec
comma
l_int|NULL
comma
op_amp
id|min_idle
comma
op_amp
id|max_idle
)brace
comma
(brace
id|NET_AX25_N2
comma
l_string|&quot;maximum_retry_count&quot;
comma
l_int|NULL
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec_minmax
comma
op_amp
id|sysctl_intvec
comma
l_int|NULL
comma
op_amp
id|min_n2
comma
op_amp
id|max_n2
)brace
comma
(brace
id|NET_AX25_PACLEN
comma
l_string|&quot;maximum_packet_length&quot;
comma
l_int|NULL
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec_minmax
comma
op_amp
id|sysctl_intvec
comma
l_int|NULL
comma
op_amp
id|min_paclen
comma
op_amp
id|max_paclen
)brace
comma
(brace
id|NET_AX25_PROTOCOL
comma
l_string|&quot;protocol&quot;
comma
l_int|NULL
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec_minmax
comma
op_amp
id|sysctl_intvec
comma
l_int|NULL
comma
op_amp
id|min_proto
comma
op_amp
id|max_proto
)brace
comma
(brace
id|NET_AX25_DAMA_SLAVE_TIMEOUT
comma
l_string|&quot;dama_slave_timeout&quot;
comma
l_int|NULL
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec_minmax
comma
op_amp
id|sysctl_intvec
comma
l_int|NULL
comma
op_amp
id|min_ds_timeout
comma
op_amp
id|max_ds_timeout
)brace
comma
(brace
l_int|0
)brace
multiline_comment|/* that&squot;s all, folks! */
)brace
suffix:semicolon
DECL|function|ax25_register_sysctl
r_void
id|ax25_register_sysctl
c_func
(paren
r_void
)paren
(brace
id|ax25_dev
op_star
id|ax25_dev
suffix:semicolon
r_int
id|n
comma
id|k
suffix:semicolon
r_for
c_loop
(paren
id|ax25_table_size
op_assign
r_sizeof
(paren
id|ctl_table
)paren
comma
id|ax25_dev
op_assign
id|ax25_dev_list
suffix:semicolon
id|ax25_dev
op_ne
l_int|NULL
suffix:semicolon
id|ax25_dev
op_assign
id|ax25_dev-&gt;next
)paren
id|ax25_table_size
op_add_assign
r_sizeof
(paren
id|ctl_table
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ax25_table
op_assign
id|kmalloc
c_func
(paren
id|ax25_table_size
comma
id|GFP_ATOMIC
)paren
)paren
op_eq
l_int|NULL
)paren
r_return
suffix:semicolon
id|memset
c_func
(paren
id|ax25_table
comma
l_int|0x00
comma
id|ax25_table_size
)paren
suffix:semicolon
r_for
c_loop
(paren
id|n
op_assign
l_int|0
comma
id|ax25_dev
op_assign
id|ax25_dev_list
suffix:semicolon
id|ax25_dev
op_ne
l_int|NULL
suffix:semicolon
id|ax25_dev
op_assign
id|ax25_dev-&gt;next
)paren
(brace
id|ctl_table
op_star
id|child
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
id|ax25_param_table
)paren
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|child
)paren
(brace
r_while
c_loop
(paren
id|n
op_decrement
)paren
id|kfree
c_func
(paren
id|ax25_table
(braket
id|n
)braket
dot
id|child
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|ax25_table
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|child
comma
id|ax25_param_table
comma
r_sizeof
(paren
id|ax25_param_table
)paren
)paren
suffix:semicolon
id|ax25_table
(braket
id|n
)braket
dot
id|child
op_assign
id|ax25_dev-&gt;systable
op_assign
id|child
suffix:semicolon
id|ax25_table
(braket
id|n
)braket
dot
id|ctl_name
op_assign
id|n
op_plus
l_int|1
suffix:semicolon
id|ax25_table
(braket
id|n
)braket
dot
id|procname
op_assign
id|ax25_dev-&gt;dev-&gt;name
suffix:semicolon
id|ax25_table
(braket
id|n
)braket
dot
id|mode
op_assign
l_int|0555
suffix:semicolon
macro_line|#ifndef CONFIG_AX25_DAMA_SLAVE
multiline_comment|/* &n;&t;&t; * We do not wish to have a representation of this parameter&n;&t;&t; * in /proc/sys/ when configured *not* to include the&n;&t;&t; * AX.25 DAMA slave code, do we?&n;&t;&t; */
id|child
(braket
id|AX25_VALUES_DS_TIMEOUT
)braket
dot
id|procname
op_assign
l_int|NULL
suffix:semicolon
macro_line|#endif
id|child
(braket
id|AX25_MAX_VALUES
)braket
dot
id|ctl_name
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* just in case... */
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
OL
id|AX25_MAX_VALUES
suffix:semicolon
id|k
op_increment
)paren
id|child
(braket
id|k
)braket
dot
id|data
op_assign
op_amp
id|ax25_dev-&gt;values
(braket
id|k
)braket
suffix:semicolon
id|n
op_increment
suffix:semicolon
)brace
id|ax25_dir_table
(braket
l_int|0
)braket
dot
id|child
op_assign
id|ax25_table
suffix:semicolon
id|ax25_table_header
op_assign
id|register_sysctl_table
c_func
(paren
id|ax25_root_table
comma
l_int|1
)paren
suffix:semicolon
)brace
DECL|function|ax25_unregister_sysctl
r_void
id|ax25_unregister_sysctl
c_func
(paren
r_void
)paren
(brace
id|ctl_table
op_star
id|p
suffix:semicolon
id|unregister_sysctl_table
c_func
(paren
id|ax25_table_header
)paren
suffix:semicolon
id|ax25_dir_table
(braket
l_int|0
)braket
dot
id|child
op_assign
l_int|NULL
suffix:semicolon
r_for
c_loop
(paren
id|p
op_assign
id|ax25_table
suffix:semicolon
id|p-&gt;ctl_name
suffix:semicolon
id|p
op_increment
)paren
id|kfree
c_func
(paren
id|p-&gt;child
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|ax25_table
)paren
suffix:semicolon
)brace
eof
