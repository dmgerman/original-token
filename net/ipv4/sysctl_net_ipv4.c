multiline_comment|/*&n; * sysctl_net_ipv4.c: sysctl interface to net IPV4 subsystem.&n; *&n; * Begun April 1, 1996, Mike Shaver.&n; * Added /proc/sys/net/ipv4 directory entry (empty =) ). [MS]&n; */
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/sysctl.h&gt;
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;net/snmp.h&gt;
macro_line|#include &lt;net/ip.h&gt;
macro_line|#include &lt;net/route.h&gt;
macro_line|#include &lt;net/tcp.h&gt;
multiline_comment|/*&n; *&t;TCP configuration parameters&n; */
DECL|macro|TCP_PMTU_DISC
mdefine_line|#define TCP_PMTU_DISC&t;0x00000001&t;/* perform PMTU discovery&t;  */
DECL|macro|TCP_CONG_AVOID
mdefine_line|#define TCP_CONG_AVOID&t;0x00000002&t;/* congestion avoidance algorithm */
DECL|macro|TCP_DELAY_ACKS
mdefine_line|#define TCP_DELAY_ACKS&t;0x00000003&t;/* delayed ack stategy&t;&t;  */
macro_line|#if 0
r_static
r_int
id|boolean_min
op_assign
l_int|0
suffix:semicolon
r_static
r_int
id|boolean_max
op_assign
l_int|1
suffix:semicolon
macro_line|#endif
multiline_comment|/* From arp.c */
r_extern
r_int
id|sysctl_arp_res_time
suffix:semicolon
r_extern
r_int
id|sysctl_arp_dead_res_time
suffix:semicolon
r_extern
r_int
id|sysctl_arp_max_tries
suffix:semicolon
r_extern
r_int
id|sysctl_arp_timeout
suffix:semicolon
r_extern
r_int
id|sysctl_arp_check_interval
suffix:semicolon
r_extern
r_int
id|sysctl_arp_confirm_interval
suffix:semicolon
r_extern
r_int
id|sysctl_arp_confirm_timeout
suffix:semicolon
r_extern
r_int
id|sysctl_tcp_cong_avoidance
suffix:semicolon
r_extern
r_int
id|tcp_sysctl_congavoid
c_func
(paren
id|ctl_table
op_star
id|ctl
comma
r_int
id|write
comma
r_struct
id|file
op_star
id|filp
comma
r_void
op_star
id|buffer
comma
r_int
op_star
id|lenp
)paren
suffix:semicolon
DECL|variable|ipv4_config
r_struct
id|ipv4_config
id|ipv4_config
op_assign
(brace
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
)brace
suffix:semicolon
macro_line|#ifdef CONFIG_SYSCTL
DECL|variable|ipv4_def_router_config
r_struct
id|ipv4_config
id|ipv4_def_router_config
op_assign
(brace
l_int|0
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
)brace
suffix:semicolon
DECL|variable|ipv4_def_host_config
r_struct
id|ipv4_config
id|ipv4_def_host_config
op_assign
(brace
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
)brace
suffix:semicolon
DECL|function|ipv4_sysctl_forwarding
r_int
id|ipv4_sysctl_forwarding
c_func
(paren
id|ctl_table
op_star
id|ctl
comma
r_int
id|write
comma
r_struct
id|file
op_star
id|filp
comma
r_void
op_star
id|buffer
comma
r_int
op_star
id|lenp
)paren
(brace
r_int
id|val
op_assign
id|IS_ROUTER
suffix:semicolon
r_int
id|ret
suffix:semicolon
id|ret
op_assign
id|proc_dointvec
c_func
(paren
id|ctl
comma
id|write
comma
id|filp
comma
id|buffer
comma
id|lenp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|write
op_logical_and
id|IS_ROUTER
op_ne
id|val
)paren
(brace
r_if
c_cond
(paren
id|IS_ROUTER
)paren
id|ipv4_config
op_assign
id|ipv4_def_router_config
suffix:semicolon
r_else
id|ipv4_config
op_assign
id|ipv4_def_host_config
suffix:semicolon
id|rt_cache_flush
c_func
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_return
id|ret
suffix:semicolon
)brace
DECL|variable|ipv4_table
id|ctl_table
id|ipv4_table
(braket
)braket
op_assign
(brace
(brace
id|NET_IPV4_ARP_RES_TIME
comma
l_string|&quot;arp_res_time&quot;
comma
op_amp
id|sysctl_arp_res_time
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec
)brace
comma
(brace
id|NET_IPV4_ARP_DEAD_RES_TIME
comma
l_string|&quot;arp_dead_res_time&quot;
comma
op_amp
id|sysctl_arp_dead_res_time
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec
)brace
comma
(brace
id|NET_IPV4_ARP_MAX_TRIES
comma
l_string|&quot;arp_max_tries&quot;
comma
op_amp
id|sysctl_arp_max_tries
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec
)brace
comma
(brace
id|NET_IPV4_ARP_TIMEOUT
comma
l_string|&quot;arp_timeout&quot;
comma
op_amp
id|sysctl_arp_timeout
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec
)brace
comma
(brace
id|NET_IPV4_ARP_CHECK_INTERVAL
comma
l_string|&quot;arp_check_interval&quot;
comma
op_amp
id|sysctl_arp_check_interval
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec
)brace
comma
(brace
id|NET_IPV4_ARP_CONFIRM_INTERVAL
comma
l_string|&quot;arp_confirm_interval&quot;
comma
op_amp
id|sysctl_arp_confirm_interval
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec
)brace
comma
(brace
id|NET_IPV4_ARP_CONFIRM_TIMEOUT
comma
l_string|&quot;arp_confirm_timeout&quot;
comma
op_amp
id|sysctl_arp_confirm_timeout
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec
)brace
comma
(brace
id|NET_IPV4_TCP_VEGAS_CONG_AVOID
comma
l_string|&quot;tcp_vegas_cong_avoid&quot;
comma
op_amp
id|sysctl_tcp_cong_avoidance
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|tcp_sysctl_congavoid
)brace
comma
(brace
id|NET_IPV4_FORWARDING
comma
l_string|&quot;ip_forwarding&quot;
comma
op_amp
id|ip_statistics.IpForwarding
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|ipv4_sysctl_forwarding
)brace
comma
(brace
id|NET_IPV4_DEFAULT_TTL
comma
l_string|&quot;ip_default_ttl&quot;
comma
op_amp
id|ip_statistics.IpDefaultTTL
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec
)brace
comma
(brace
id|NET_IPV4_RFC1812_FILTER
comma
l_string|&quot;ip_rfc1812_filter&quot;
comma
op_amp
id|ipv4_config.rfc1812_filter
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec
)brace
comma
(brace
id|NET_IPV4_LOG_MARTIANS
comma
l_string|&quot;ip_log_martians&quot;
comma
op_amp
id|ipv4_config.log_martians
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec
)brace
comma
(brace
id|NET_IPV4_SOURCE_ROUTE
comma
l_string|&quot;ip_source_route&quot;
comma
op_amp
id|ipv4_config.source_route
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec
)brace
comma
(brace
id|NET_IPV4_ADDRMASK_AGENT
comma
l_string|&quot;ip_addrmask_agent&quot;
comma
op_amp
id|ipv4_config.addrmask_agent
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec
)brace
comma
(brace
id|NET_IPV4_BOOTP_AGENT
comma
l_string|&quot;ip_bootp_agent&quot;
comma
op_amp
id|ipv4_config.bootp_agent
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec
)brace
comma
(brace
id|NET_IPV4_BOOTP_RELAY
comma
l_string|&quot;ip_bootp_relay&quot;
comma
op_amp
id|ipv4_config.bootp_relay
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec
)brace
comma
(brace
id|NET_IPV4_FIB_MODEL
comma
l_string|&quot;ip_fib_model&quot;
comma
op_amp
id|ipv4_config.fib_model
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec
)brace
comma
(brace
id|NET_IPV4_NO_PMTU_DISC
comma
l_string|&quot;ip_no_pmtu_disc&quot;
comma
op_amp
id|ipv4_config.no_pmtu_disc
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec
)brace
comma
(brace
id|NET_IPV4_ACCEPT_REDIRECTS
comma
l_string|&quot;ip_accept_redirects&quot;
comma
op_amp
id|ipv4_config.accept_redirects
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec
)brace
comma
(brace
id|NET_IPV4_SECURE_REDIRECTS
comma
l_string|&quot;ip_secure_redirects&quot;
comma
op_amp
id|ipv4_config.secure_redirects
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec
)brace
comma
(brace
id|NET_IPV4_RFC1620_REDIRECTS
comma
l_string|&quot;ip_rfc1620_redirects&quot;
comma
op_amp
id|ipv4_config.rfc1620_redirects
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec
)brace
comma
(brace
l_int|0
)brace
)brace
suffix:semicolon
macro_line|#endif /* CONFIG_SYSCTL */
eof
