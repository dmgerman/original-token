multiline_comment|/*&n; *&t;802.2 Class 2 LLC service.&n; */
DECL|function|llc_rx_adm
r_int
id|llc_rx_adm
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|sk_buff
op_star
id|skb
comma
r_int
id|type
comma
r_int
id|cmd
comma
r_int
id|pf
comma
r_int
id|nr
comma
r_int
id|ns
)paren
(brace
r_if
c_cond
(paren
id|type
op_eq
id|CMD
)paren
(brace
r_if
c_cond
(paren
id|cmd
op_eq
id|DISC
)paren
(brace
id|send_response
c_func
(paren
id|sk
comma
id|DM
op_or
id|pf
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|cmd
op_eq
id|SABM
)paren
(brace
r_if
c_cond
(paren
id|sk-&gt;state
op_ne
id|TCP_LISTEN
)paren
(brace
id|send_response
c_func
(paren
id|sk
dot
id|DM
op_or
id|pf
)paren
suffix:semicolon
)brace
r_else
(brace
id|sk
op_assign
id|ll_rx_accept
c_func
(paren
id|sk
)paren
suffix:semicolon
r_if
c_cond
(paren
id|sk
op_ne
l_int|NULL
)paren
(brace
id|send_response
c_func
(paren
id|sk
comma
id|UA
op_or
id|pf
)paren
suffix:semicolon
id|sk-&gt;llc.vs
op_assign
l_int|0
suffix:semicolon
id|sk-&gt;llc.vr
op_assign
l_int|0
suffix:semicolon
id|sk-&gt;llc.p_flag
op_assign
l_int|0
suffix:semicolon
id|sk-&gt;llc.remote_busy
op_assign
l_int|0
suffix:semicolon
id|llc_state
c_func
(paren
id|sk
comma
id|LLC_NORMAL
)paren
suffix:semicolon
)brace
)brace
)brace
r_else
r_if
c_cond
(paren
id|pf
)paren
(brace
id|send_response
c_func
(paren
id|sk
comma
id|DM
op_or
id|PF
)paren
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_rx_setup
r_int
id|llc_rx_setup
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|sk_buff
op_star
id|skb
comma
r_int
id|type
comma
r_int
id|cmd
comma
r_int
id|pf
comma
r_int
id|nr
comma
r_int
id|ns
)paren
(brace
r_if
c_cond
(paren
id|type
op_eq
id|CMD
)paren
(brace
r_if
c_cond
(paren
id|cmd
op_eq
id|SABM
)paren
(brace
id|sk-&gt;llc.vs
op_assign
l_int|0
suffix:semicolon
id|sk-&gt;llc.vr
op_assign
l_int|0
suffix:semicolon
id|send_response
c_func
(paren
id|sk
comma
id|UA
op_or
id|pf
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|cmd
op_eq
id|DISC
)paren
(brace
id|send_response
c_func
(paren
id|sk
comma
id|DM
op_or
id|pf
)paren
suffix:semicolon
id|llc_error
c_func
(paren
id|sk
comma
id|ECONNRESET
)paren
suffix:semicolon
id|llc_state
c_func
(paren
id|sk
comma
id|LLC_ADM
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|cmd
op_eq
id|UA
op_logical_and
id|pf
op_eq
id|sk-&gt;llc.p_flag
)paren
(brace
id|del_timer
c_func
(paren
op_amp
id|sk-&gt;llc.t1
)paren
suffix:semicolon
id|sk-&gt;llc.vs
op_assign
l_int|0
suffix:semicolon
id|llc_update_p_flag
c_func
(paren
id|sk
comma
id|pf
)paren
suffix:semicolon
id|llc_state
c_func
(paren
id|sk
comma
id|LLC_NORMAL
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|cmd
op_eq
id|DM
)paren
(brace
id|llc_error
c_func
(paren
id|sk
comma
id|ECONNRESET
)paren
suffix:semicolon
id|llc_state
c_func
(paren
id|sk
comma
id|LLC_ADM
)paren
suffix:semicolon
)brace
)brace
)brace
DECL|function|llc_rx_reset
r_int
id|llc_rx_reset
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|sk_buff
op_star
id|skb
comma
r_int
id|type
comma
r_int
id|cmd
comma
r_int
id|pf
comma
r_int
id|nr
comma
r_int
id|ns
)paren
(brace
r_if
c_cond
(paren
id|type
op_eq
id|CMD
)paren
(brace
r_if
c_cond
(paren
id|cmd
op_eq
id|SABM
)paren
(brace
id|sk-&gt;llc.vr
op_assign
l_int|0
suffix:semicolon
id|sk-&gt;llc.vs
op_assign
l_int|0
suffix:semicolon
id|send_response
c_func
(paren
id|sk
comma
id|UA
op_or
id|pf
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|cmd
op_eq
id|DISC
)paren
(brace
r_if
c_cond
(paren
id|sk-&gt;llc.cause_flag
op_eq
l_int|1
)paren
(brace
id|llc_shutdown
c_func
(paren
id|sk
comma
id|SHUTDOWN_MASK
)paren
suffix:semicolon
)brace
r_else
id|llc_eror
c_func
(paren
id|sk
comma
id|ECONNREFUSED
)paren
suffix:semicolon
id|send_response
c_func
(paren
id|sk
comma
id|DM
op_or
id|pf
)paren
suffix:semicolon
id|llc_state
c_func
(paren
id|sk
comma
id|LLC_ADM
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|cmd
op_eq
id|UA
)paren
(brace
r_if
c_cond
(paren
id|sk-&gt;llc.p_flag
op_eq
id|pf
)paren
(brace
id|del_timer
c_func
(paren
op_amp
id|sk-&gt;llc.t1
)paren
suffix:semicolon
id|sk-&gt;llc.vs
op_assign
l_int|0
suffix:semicolon
id|sk-&gt;llc.vr
op_assign
l_int|0
suffix:semicolon
id|llc_update_p_flag
c_func
(paren
id|sk
comma
id|pf
)paren
suffix:semicolon
id|llc_confirm_reset
c_func
(paren
id|sk
comma
id|sk-&gt;llc.cause_flag
)paren
suffix:semicolon
id|sk-&gt;llc.remote_busy
op_assign
l_int|0
suffix:semicolon
id|llc_state
c_func
(paren
id|sk
comma
id|LLC_NORMAL
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|cmd
op_eq
id|DM
)paren
(brace
multiline_comment|/* Should check cause_flag */
id|llc_shutdown
c_func
(paren
id|sk
comma
id|SHUTDOWN_MASK
)paren
suffix:semicolon
id|llc_state
c_func
(paren
id|sk
comma
id|LLC_ADM
)paren
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_rx_d_conn
r_int
id|llc_rx_d_conn
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|sk_buff
op_star
id|skb
comma
r_int
id|type
comma
r_int
id|cmd
comma
r_int
id|pf
comma
r_int
id|nr
comma
r_int
id|ns
)paren
(brace
r_if
c_cond
(paren
id|type
op_eq
id|CMD
)paren
(brace
r_if
c_cond
(paren
id|cmd
op_eq
id|SABM
)paren
(brace
id|llc_error
c_func
(paren
id|sk
comma
id|ECONNRESET
)paren
suffix:semicolon
id|llc_state
c_func
(paren
id|sk
comma
id|ADM
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|cmd
op_eq
id|DISC
)paren
(brace
id|send_response
c_func
(paren
id|UA
op_or
id|pf
)paren
suffix:semicolon
id|llc_state
c_func
(paren
id|sk
comma
id|LLC_D_CONN
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|pf
)paren
(brace
id|send_response
c_func
(paren
id|sk
comma
id|DM
op_or
id|PF
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|cmd
op_eq
id|UA
op_logical_and
id|pf
op_eq
id|sk-&gt;llc.p_flag
)paren
(brace
id|del_timer
c_func
(paren
op_amp
id|sk-&gt;llc.t1
)paren
suffix:semicolon
id|llc_state
c_func
(paren
id|sk
comma
id|ADM
)paren
suffix:semicolon
id|llc_confirm_reset
c_func
(paren
id|sk
comma
id|sk-&gt;llc.cause_flag
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|cmd
op_eq
id|DM
)paren
(brace
id|del_timer
c_func
(paren
op_amp
id|sk-&gt;llc.t1
)paren
suffix:semicolon
multiline_comment|/*if(sk-&gt;llc.cause_flag)*/
id|llc_shutdown
c_func
(paren
id|sk
comma
id|SHUTDOWN_MASK
)paren
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|llc_rx_error
r_int
id|llc_rx_error
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|sk_buff
op_star
id|skb
comma
r_int
id|type
comma
r_int
id|cmd
comma
r_int
id|pf
comma
r_int
id|nr
comma
r_int
id|ns
)paren
(brace
r_if
c_cond
(paren
id|type
op_eq
id|CMD
)paren
(brace
r_if
c_cond
(paren
id|cmd
op_eq
id|SABM
)paren
(brace
id|sk-&gt;llc.vs
op_assign
l_int|0
suffix:semicolon
id|sk-&gt;llc.vr
op_assign
l_int|0
suffix:semicolon
id|send_response
c_func
(paren
id|sk
comma
id|UA
op_or
id|pf
)paren
suffix:semicolon
id|llc_error
c_func
(paren
id|sk
comma
id|ECONNRESET
)paren
suffix:semicolon
id|sk-&gt;llc.p_flag
op_assign
l_int|0
suffix:semicolon
id|sk-&gt;llc.remote_busy
op_assign
l_int|0
suffix:semicolon
id|llc_state
c_func
(paren
id|sk
comma
id|LLC_NORMAL
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|cmd
op_eq
id|DISC
)paren
(brace
id|send_response
c_func
(paren
id|sk
comma
id|UA
op_or
id|pf
)paren
suffix:semicolon
id|llc_shutdown
c_func
(paren
id|sk
comma
id|SHUTDOWN_MASK
)paren
suffix:semicolon
id|llc_state
c_func
(paren
id|sk
comma
id|LLC_ADM
)paren
suffix:semicolon
)brace
r_else
id|llc_resend_frmr_rsp
c_func
(paren
id|sk
comma
id|pf
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|cmd
op_eq
id|DM
)paren
(brace
id|llc_error
c_func
(paren
id|sk
comma
id|ECONNRESET
)paren
suffix:semicolon
id|del_timer
c_func
(paren
op_amp
id|sk-&gt;llc.t1
)paren
suffix:semicolon
id|llc_state
c_func
(paren
id|sk
comma
id|LLC_ADM
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|cmd
op_eq
id|FRMR
)paren
(brace
id|send_command
c_func
(paren
id|sk
comma
id|SABM
)paren
suffix:semicolon
id|sk-&gt;llc.p_flag
op_assign
id|pf
suffix:semicolon
id|llc_start_t1
c_func
(paren
)paren
suffix:semicolon
id|sk-&gt;llc.retry_count
op_assign
l_int|0
suffix:semicolon
id|sk-&gt;llc.cause_flag
op_assign
l_int|0
suffix:semicolon
id|llc_error
c_func
(paren
id|sk
comma
id|EPROTO
)paren
suffix:semicolon
id|llc_state
c_func
(paren
id|sk
comma
id|LLC_RESET
)paren
suffix:semicolon
)brace
)brace
)brace
multiline_comment|/*&n; *&t;Subroutine for handling the shared cases of the data modes.&n; */
DECL|function|llc_rx_nr_shared
r_int
id|llc_rx_nr_shared
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|sk_buff
op_star
id|skb
comma
r_int
id|type
comma
r_int
id|cmd
comma
r_int
id|pf
comma
r_int
id|nr
comma
r_int
id|ns
)paren
(brace
r_if
c_cond
(paren
id|type
op_eq
id|CMD
)paren
(brace
r_if
c_cond
(paren
id|cmd
op_eq
id|SABM
)paren
(brace
multiline_comment|/*&n;&t;&t;&t; *&t;Optional reset processing. We decline resets.&n;&t;&t;&t; */
id|send_response
c_func
(paren
id|sk
comma
id|DM
op_or
id|pf
)paren
suffix:semicolon
id|llc_error
c_func
(paren
id|sk
comma
id|ECONNRESET
)paren
suffix:semicolon
id|llc_state
c_func
(paren
id|sk
comma
id|LLC_ADM
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|cmd
op_eq
id|DISC
)paren
(brace
id|send_response
c_func
(paren
id|sk
comma
id|UA
op_or
id|pf
)paren
suffix:semicolon
id|llc_state
c_func
(paren
id|sk
comma
id|LLC_ADM
)paren
suffix:semicolon
id|llc_shutdown
c_func
(paren
id|sk
comma
id|SHUTDOWN_MASK
)paren
suffix:semicolon
)brace
multiline_comment|/*&n;&t;&t; *&t;We only ever use windows of 7, so there is no illegal NR/NS value&n;&t;&t; *&t;otherwise we would FRMR here and go to ERROR state&n;&t;&t; */
r_else
r_if
c_cond
(paren
id|cmd
op_eq
id|ILLEGAL
)paren
(brace
id|llc_send_frmr_response
c_func
(paren
id|sk
comma
id|ILLEGAL_TYPE
comma
id|pf
)paren
suffix:semicolon
id|llc_state
c_func
(paren
id|sk
comma
id|LLC_ERROR
)paren
suffix:semicolon
id|llc_error
c_func
(paren
id|sk
comma
id|EPROTO
)paren
suffix:semicolon
)brace
r_else
multiline_comment|/*&n;&t;&t;&t; *&t;Not covered by general rule&n;&t;&t;&t; */
r_return
l_int|0
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/*&n;&t;&t; *&t;We close on errors&n;&t;&t; */
r_if
c_cond
(paren
id|cmd
op_eq
id|FRMR
)paren
(brace
id|send_command
c_func
(paren
id|sk
comma
id|DM
op_or
id|pf
)paren
suffix:semicolon
id|sk-&gt;llc.p_flag
op_assign
id|pf
suffix:semicolon
id|llc_start_t1
c_func
(paren
id|sk
)paren
suffix:semicolon
id|llc_error
c_func
(paren
id|sk
comma
id|EPROTO
)paren
suffix:semicolon
id|sk-&gt;llc.cause_flag
op_assign
l_int|0
suffix:semicolon
id|llc_state
c_func
(paren
id|sk
comma
id|LLC_D_CONN
)paren
suffix:colon
)brace
r_else
r_if
c_cond
(paren
id|cmd
op_eq
id|DM
)paren
(brace
id|llc_state
c_func
(paren
id|sk
comma
id|LLC_ADM
)paren
suffix:semicolon
id|llc_error
c_func
(paren
id|sk
comma
id|ECONNREFUSED
)paren
suffix:semicolon
)brace
multiline_comment|/*&n;&t;&t; *&t;We always use a window of 7 so can&squot;t get I resp&n;&t;&t; *&t;with invalid NS,  or any resp with invalid NR. If&n;&t;&t; *&t;we add this they do the same as..&n;&t;&t; */
r_else
r_if
c_cond
(paren
id|cmd
op_eq
id|UA
)paren
(brace
id|llc_send_frmr_response
c_func
(paren
id|sk
comma
id|UNEXPECTED_CONTROL
comma
id|pf
)paren
suffix:semicolon
id|llc_state
c_func
(paren
id|sk
comma
id|LLC_ERROR
)paren
suffix:semicolon
id|llc_error
c_func
(paren
id|sk
comma
id|EPROTO
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|pf
op_eq
l_int|1
op_logical_and
id|sk-&gt;llc.p_flag
op_eq
l_int|0
)paren
(brace
id|llc_send_frmr_response
c_func
(paren
id|sk
comma
id|UNEXPECTED_RESPONSE
comma
id|pf
)paren
suffix:semicolon
id|llc_state
c_func
(paren
id|sk
comma
id|LLC_ERROR
)paren
suffix:semicolon
id|llc_error
c_func
(paren
id|sk
comma
id|EPROTO
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|cmd
op_eq
id|ILLEGAL
)paren
(brace
id|llc_send_frmr_response
c_func
(paren
id|sk
comma
id|ILLEGAL_TYPE
comma
id|pf
)paren
suffix:semicolon
id|llc_state
c_func
(paren
id|sk
comma
id|LLC_ERROR
)paren
suffix:semicolon
id|llc_error
c_func
(paren
id|sk
comma
id|EPROTO
)paren
suffix:semicolon
)brace
r_else
multiline_comment|/*&n;&t;&t;&t; *&t;Not covered by general rule&n;&t;&t;&t; */
r_return
l_int|0
)brace
multiline_comment|/*&n;&t; *&t;Processed.&n;&t; */
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|llc_rx_normal
r_int
id|llc_rx_normal
c_func
(paren
r_struct
id|sock
op_star
id|sk
comma
r_struct
id|sk_buff
op_star
id|skb
comma
r_int
id|type
comma
r_int
id|cmd
comma
r_int
id|pf
comma
r_int
id|nr
comma
r_int
id|ns
)paren
(brace
r_if
c_cond
(paren
id|llc_rx_nr_shared
c_func
(paren
id|sk
comma
id|skb
comma
id|type
comma
id|cmd
comma
id|pf
comma
id|nr
comma
id|ns
)paren
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|cmd
op_eq
id|I
)paren
(brace
r_if
c_cond
(paren
id|llc_invalid_ns
c_func
(paren
id|sk
comma
id|ns
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
id|type
op_eq
id|RESP
op_logical_and
id|sk-&gt;llc.p_flag
op_eq
id|pf
)paren
op_logical_or
(paren
id|type
op_eq
id|CMD
op_logical_and
id|pf
op_eq
l_int|0
op_logical_and
id|sk-&gt;llc.p_flag
op_eq
l_int|0
)paren
)paren
(brace
id|llc_command
c_func
(paren
id|sk
comma
id|REJ
op_or
id|PF
)paren
suffix:semicolon
id|llc_ack_frames
c_func
(paren
id|sk
comma
id|nr
)paren
suffix:semicolon
multiline_comment|/* Ack frames and update N(R) */
id|sk-&gt;llc.p_flag
op_assign
id|PF
suffix:semicolon
id|llc_state
c_func
(paren
id|sk
comma
id|LLC_REJECT
)paren
suffix:semicolon
id|sk-&gt;llc.retry_count
op_assign
l_int|0
suffix:semicolon
id|llc_start_t1
c_func
(paren
id|sk
)paren
suffix:semicolon
id|sk-&gt;llc.remote_busy
op_assign
l_int|0
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
id|type
op_eq
id|CMD
op_logical_and
op_logical_neg
id|pf
op_logical_and
id|sk-&gt;llc.p_flag
op_eq
l_int|1
)paren
op_logical_or
(paren
id|type
op_eq
id|RESP
op_logical_and
op_logical_neg
id|pf
op_logical_and
id|sk-&gt;llc.p_flag
op_eq
l_int|1
)paren
)paren
(brace
r_if
c_cond
(paren
id|type
op_eq
id|CMD
)paren
(brace
id|llc_response
c_func
(paren
id|sk
comma
id|REJ
)paren
suffix:semicolon
)brace
r_else
id|llc_command
c_func
(paren
id|sk
comma
id|REJ
)paren
suffix:semicolon
id|llc_ack_frames
c_func
(paren
id|sk
comma
id|nr
)paren
suffix:semicolon
id|sk-&gt;llc.retry_count
op_assign
l_int|0
suffix:semicolon
id|llc_state
c_func
(paren
id|sk
comma
id|LLC_REJECT
)paren
suffix:semicolon
id|llc_start_t1
c_func
(paren
id|sk
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|pf
op_logical_and
id|type
op_eq
id|CMD
)paren
(brace
id|llc_response
c_func
(paren
id|sk
comma
id|REJ
op_or
id|PF
)paren
suffix:semicolon
id|llc_ack_frames
c_func
(paren
id|sk
comma
id|nr
)paren
suffix:semicolon
id|sk-&gt;llc.retry_count
op_assign
l_int|0
suffix:semicolon
id|llc_start_t1
c_func
(paren
id|sk
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
multiline_comment|/*&n;&t;&t;&t; *&t;Valid I frame cases&n;&t;&t;&t; */
r_if
c_cond
(paren
id|sk-&gt;llc.p_flag
op_eq
id|pf
op_logical_and
op_logical_neg
(paren
id|type
op_eq
id|CMD
op_logical_and
id|pf
)paren
)paren
(brace
id|sk-&gt;llc.vr
op_assign
(paren
id|sk-&gt;llc.vr
op_plus
l_int|1
)paren
op_amp
l_int|7
suffix:semicolon
id|llc_queue_rr_cmd
c_func
(paren
id|sk
comma
id|PF
)paren
suffix:semicolon
id|sk-&gt;llc.retry_count
op_assign
l_int|0
suffix:semicolon
id|llc_start_t1
c_func
(paren
id|sk
)paren
suffix:semicolon
id|sk-&gt;llc.p_flag
op_assign
l_int|1
suffix:semicolon
id|llc_ack_frames
c_func
(paren
id|sk
comma
id|nr
)paren
suffix:semicolon
id|sk-&gt;llc.remote_busy
op_assign
l_int|0
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|sk-&gt;ppc.p_flag
op_ne
id|pf
)paren
(brace
id|sk-&gt;llc.vr
op_assign
(paren
id|sk-&gt;llc.vr
op_plus
l_int|1
)paren
op_amp
l_int|7
suffix:semicolon
r_if
c_cond
(paren
id|type
op_eq
id|CMD
)paren
(brace
id|llc_queue_rr_resp
c_func
(paren
id|sk
comma
l_int|0
)paren
suffix:semicolon
)brace
r_else
id|llc_queue_rr_cmd
c_func
(paren
id|sk
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|sk-&gt;llc.nr
op_ne
id|nr
)paren
(brace
id|llc_ack_frames
c_func
(paren
id|sk
comma
id|nr
)paren
suffix:semicolon
id|llc_reset_t1
c_func
(paren
id|sk
)paren
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|pf
)paren
(brace
id|sk-&gt;llc.vr
op_assign
(paren
id|sk-&gt;llc.vr
op_plus
l_int|1
)paren
op_amp
l_int|7
suffix:semicolon
id|llc_queue_rr_resp
c_func
(paren
id|sk
comma
id|PF
)paren
suffix:semicolon
r_if
c_cond
(paren
id|sk-&gt;llc.nr
op_ne
id|nr
)paren
(brace
id|llc_ack_frames
c_func
(paren
id|sk
comma
id|nr
)paren
suffix:semicolon
id|llc_reset_t1
c_func
(paren
id|sk
)paren
suffix:semicolon
)brace
)brace
id|llc_queue_data
c_func
(paren
id|sk
comma
id|skb
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|cmd
op_eq
id|RR
op_logical_or
id|cmd
op_eq
id|RNR
)paren
(brace
r_if
c_cond
(paren
id|type
op_eq
id|CMD
op_logical_or
(paren
id|type
op_eq
id|RESP
op_logical_and
(paren
op_logical_neg
id|pf
op_logical_or
id|pf
op_eq
l_int|1
op_logical_and
id|sk-&gt;llc.p_flag
op_eq
l_int|1
)paren
)paren
)paren
(brace
id|llc_update_p_flag
c_func
(paren
id|sk
comma
id|pf
)paren
suffix:semicolon
r_if
c_cond
(paren
id|sk-&gt;llc.nr
op_ne
id|nr
)paren
(brace
id|llc_ack_frames
c_func
(paren
id|sk
comma
id|nr
)paren
suffix:semicolon
id|llc_reset_t1
c_func
(paren
id|sk
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|cmd
op_eq
id|RR
)paren
(brace
id|sk-&gt;llc.remote_busy
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|sk-&gt;llc.remote_busy
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|llc_t1_running
c_func
(paren
id|sk
)paren
)paren
(brace
id|llc_start_t1
c_func
(paren
id|sk
)paren
suffix:semicolon
)brace
)brace
)brace
r_else
r_if
c_cond
(paren
id|type
op_eq
id|cmd
op_logical_and
id|pf
)paren
(brace
r_if
c_cond
(paren
id|cmd
op_eq
id|RR
)paren
(brace
id|llc_queue_rr_resp
c_func
(paren
id|sk
comma
id|PF
)paren
suffix:semicolon
)brace
r_else
(brace
id|send_response
c_func
(paren
id|sk
comma
id|RR
op_or
id|PF
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|llc_t1_running
c_func
(paren
id|sk
)paren
)paren
(brace
id|llc_start_t1
c_func
(paren
id|sk
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|sk-&gt;llc.nr
op_ne
id|nr
)paren
(brace
id|llc_ack_frames
c_func
(paren
id|sk
comma
id|nr
)paren
suffix:semicolon
id|llc_reset_t1
c_func
(paren
id|sk
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|cmd
op_eq
id|RR
)paren
(brace
id|sk-&gt;llc.remote_busy
op_assign
l_int|0
suffix:semicolon
)brace
r_else
id|sk-&gt;llc.remote_busy
op_assign
l_int|1
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|cmd
op_eq
id|REJ
)paren
(brace
)brace
)brace
eof
