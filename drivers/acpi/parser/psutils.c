multiline_comment|/******************************************************************************&n; *&n; * Module Name: psutils - Parser miscellaneous utilities (Parser only)&n; *              $Revision: 30 $&n; *&n; *****************************************************************************/
multiline_comment|/*&n; *  Copyright (C) 2000 R. Byron Moore&n; *&n; *  This program is free software; you can redistribute it and/or modify&n; *  it under the terms of the GNU General Public License as published by&n; *  the Free Software Foundation; either version 2 of the License, or&n; *  (at your option) any later version.&n; *&n; *  This program is distributed in the hope that it will be useful,&n; *  but WITHOUT ANY WARRANTY; without even the implied warranty of&n; *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; *  GNU General Public License for more details.&n; *&n; *  You should have received a copy of the GNU General Public License&n; *  along with this program; if not, write to the Free Software&n; *  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA&n; */
macro_line|#include &quot;acpi.h&quot;
macro_line|#include &quot;acparser.h&quot;
macro_line|#include &quot;amlcode.h&quot;
DECL|macro|_COMPONENT
mdefine_line|#define _COMPONENT          PARSER
id|MODULE_NAME
(paren
l_string|&quot;psutils&quot;
)paren
DECL|macro|PARSEOP_GENERIC
mdefine_line|#define PARSEOP_GENERIC     0x01
DECL|macro|PARSEOP_NAMED
mdefine_line|#define PARSEOP_NAMED       0x02
DECL|macro|PARSEOP_DEFERRED
mdefine_line|#define PARSEOP_DEFERRED    0x03
DECL|macro|PARSEOP_BYTELIST
mdefine_line|#define PARSEOP_BYTELIST    0x04
DECL|macro|PARSEOP_IN_CACHE
mdefine_line|#define PARSEOP_IN_CACHE    0x80
multiline_comment|/*******************************************************************************&n; *&n; * FUNCTION:    Acpi_ps_init_op&n; *&n; * PARAMETERS:  Op              - A newly allocated Op object&n; *              Opcode          - Opcode to store in the Op&n; *&n; * RETURN:      Status&n; *&n; * DESCRIPTION: Allocate an acpi_op, choose op type (and thus size) based on&n; *              opcode&n; *&n; ******************************************************************************/
r_void
DECL|function|acpi_ps_init_op
id|acpi_ps_init_op
(paren
id|ACPI_PARSE_OBJECT
op_star
id|op
comma
id|u16
id|opcode
)paren
(brace
id|ACPI_OPCODE_INFO
op_star
id|aml_op
suffix:semicolon
id|op-&gt;data_type
op_assign
id|ACPI_DESC_TYPE_PARSER
suffix:semicolon
id|op-&gt;opcode
op_assign
id|opcode
suffix:semicolon
id|aml_op
op_assign
id|acpi_ps_get_opcode_info
(paren
id|opcode
)paren
suffix:semicolon
id|DEBUG_ONLY_MEMBERS
(paren
id|STRNCPY
(paren
id|op-&gt;op_name
comma
id|aml_op-&gt;name
comma
r_sizeof
(paren
id|op-&gt;op_name
)paren
)paren
)paren
suffix:semicolon
)brace
multiline_comment|/*******************************************************************************&n; *&n; * FUNCTION:    Acpi_ps_alloc_op&n; *&n; * PARAMETERS:  Opcode          - Opcode that will be stored in the new Op&n; *&n; * RETURN:      Pointer to the new Op.&n; *&n; * DESCRIPTION: Allocate an acpi_op, choose op type (and thus size) based on&n; *              opcode.  A cache of opcodes is available for the pure&n; *              GENERIC_OP, since this is by far the most commonly used.&n; *&n; ******************************************************************************/
id|ACPI_PARSE_OBJECT
op_star
DECL|function|acpi_ps_alloc_op
id|acpi_ps_alloc_op
(paren
id|u16
id|opcode
)paren
(brace
id|ACPI_PARSE_OBJECT
op_star
id|op
op_assign
l_int|NULL
suffix:semicolon
id|u32
id|size
suffix:semicolon
id|u8
id|flags
suffix:semicolon
multiline_comment|/* Allocate the minimum required size object */
r_if
c_cond
(paren
id|acpi_ps_is_deferred_op
(paren
id|opcode
)paren
)paren
(brace
id|size
op_assign
r_sizeof
(paren
id|ACPI_PARSE2_OBJECT
)paren
suffix:semicolon
id|flags
op_assign
id|PARSEOP_DEFERRED
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|acpi_ps_is_named_op
(paren
id|opcode
)paren
)paren
(brace
id|size
op_assign
r_sizeof
(paren
id|ACPI_PARSE2_OBJECT
)paren
suffix:semicolon
id|flags
op_assign
id|PARSEOP_NAMED
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|acpi_ps_is_bytelist_op
(paren
id|opcode
)paren
)paren
(brace
id|size
op_assign
r_sizeof
(paren
id|ACPI_PARSE2_OBJECT
)paren
suffix:semicolon
id|flags
op_assign
id|PARSEOP_BYTELIST
suffix:semicolon
)brace
r_else
(brace
id|size
op_assign
r_sizeof
(paren
id|ACPI_PARSE_OBJECT
)paren
suffix:semicolon
id|flags
op_assign
id|PARSEOP_GENERIC
suffix:semicolon
)brace
r_if
c_cond
(paren
id|size
op_eq
r_sizeof
(paren
id|ACPI_PARSE_OBJECT
)paren
)paren
(brace
multiline_comment|/*&n;&t;&t; * The generic op is by far the most common (16 to 1), and therefore&n;&t;&t; * the op cache is implemented with this type.&n;&t;&t; *&n;&t;&t; * Check if there is an Op already available in the cache&n;&t;&t; */
id|acpi_cm_acquire_mutex
(paren
id|ACPI_MTX_CACHES
)paren
suffix:semicolon
id|acpi_gbl_parse_cache_requests
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|acpi_gbl_parse_cache
)paren
(brace
multiline_comment|/* Extract an op from the front of the cache list */
id|acpi_gbl_parse_cache_depth
op_decrement
suffix:semicolon
id|acpi_gbl_parse_cache_hits
op_increment
suffix:semicolon
id|op
op_assign
id|acpi_gbl_parse_cache
suffix:semicolon
id|acpi_gbl_parse_cache
op_assign
id|op-&gt;next
suffix:semicolon
multiline_comment|/* Clear the previously used Op */
id|MEMSET
(paren
id|op
comma
l_int|0
comma
r_sizeof
(paren
id|ACPI_PARSE_OBJECT
)paren
)paren
suffix:semicolon
)brace
id|acpi_cm_release_mutex
(paren
id|ACPI_MTX_CACHES
)paren
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/*&n;&t;&t; * The generic op is by far the most common (16 to 1), and therefore&n;&t;&t; * the op cache is implemented with this type.&n;&t;&t; *&n;&t;&t; * Check if there is an Op already available in the cache&n;&t;&t; */
id|acpi_cm_acquire_mutex
(paren
id|ACPI_MTX_CACHES
)paren
suffix:semicolon
id|acpi_gbl_ext_parse_cache_requests
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|acpi_gbl_ext_parse_cache
)paren
(brace
multiline_comment|/* Extract an op from the front of the cache list */
id|acpi_gbl_ext_parse_cache_depth
op_decrement
suffix:semicolon
id|acpi_gbl_ext_parse_cache_hits
op_increment
suffix:semicolon
id|op
op_assign
(paren
id|ACPI_PARSE_OBJECT
op_star
)paren
id|acpi_gbl_ext_parse_cache
suffix:semicolon
id|acpi_gbl_ext_parse_cache
op_assign
(paren
id|ACPI_PARSE2_OBJECT
op_star
)paren
id|op-&gt;next
suffix:semicolon
multiline_comment|/* Clear the previously used Op */
id|MEMSET
(paren
id|op
comma
l_int|0
comma
r_sizeof
(paren
id|ACPI_PARSE2_OBJECT
)paren
)paren
suffix:semicolon
)brace
id|acpi_cm_release_mutex
(paren
id|ACPI_MTX_CACHES
)paren
suffix:semicolon
)brace
multiline_comment|/* Allocate a new Op if necessary */
r_if
c_cond
(paren
op_logical_neg
id|op
)paren
(brace
id|op
op_assign
id|acpi_cm_callocate
(paren
id|size
)paren
suffix:semicolon
)brace
multiline_comment|/* Initialize the Op */
r_if
c_cond
(paren
id|op
)paren
(brace
id|acpi_ps_init_op
(paren
id|op
comma
id|opcode
)paren
suffix:semicolon
id|op-&gt;flags
op_assign
id|flags
suffix:semicolon
)brace
r_return
(paren
id|op
)paren
suffix:semicolon
)brace
multiline_comment|/*******************************************************************************&n; *&n; * FUNCTION:    Acpi_ps_free_op&n; *&n; * PARAMETERS:  Op              - Op to be freed&n; *&n; * RETURN:      None.&n; *&n; * DESCRIPTION: Free an Op object.  Either put it on the GENERIC_OP cache list&n; *              or actually free it.&n; *&n; ******************************************************************************/
r_void
DECL|function|acpi_ps_free_op
id|acpi_ps_free_op
(paren
id|ACPI_PARSE_OBJECT
op_star
id|op
)paren
(brace
r_if
c_cond
(paren
id|op-&gt;flags
op_eq
id|PARSEOP_GENERIC
)paren
(brace
multiline_comment|/* Is the cache full? */
r_if
c_cond
(paren
id|acpi_gbl_parse_cache_depth
OL
id|MAX_PARSE_CACHE_DEPTH
)paren
(brace
multiline_comment|/* Put a GENERIC_OP back into the cache */
multiline_comment|/* Clear the previously used Op */
id|MEMSET
(paren
id|op
comma
l_int|0
comma
r_sizeof
(paren
id|ACPI_PARSE_OBJECT
)paren
)paren
suffix:semicolon
id|op-&gt;flags
op_assign
id|PARSEOP_IN_CACHE
suffix:semicolon
id|acpi_cm_acquire_mutex
(paren
id|ACPI_MTX_CACHES
)paren
suffix:semicolon
id|acpi_gbl_parse_cache_depth
op_increment
suffix:semicolon
id|op-&gt;next
op_assign
id|acpi_gbl_parse_cache
suffix:semicolon
id|acpi_gbl_parse_cache
op_assign
id|op
suffix:semicolon
id|acpi_cm_release_mutex
(paren
id|ACPI_MTX_CACHES
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
)brace
r_else
(brace
multiline_comment|/* Is the cache full? */
r_if
c_cond
(paren
id|acpi_gbl_ext_parse_cache_depth
OL
id|MAX_EXTPARSE_CACHE_DEPTH
)paren
(brace
multiline_comment|/* Put a GENERIC_OP back into the cache */
multiline_comment|/* Clear the previously used Op */
id|MEMSET
(paren
id|op
comma
l_int|0
comma
r_sizeof
(paren
id|ACPI_PARSE2_OBJECT
)paren
)paren
suffix:semicolon
id|op-&gt;flags
op_assign
id|PARSEOP_IN_CACHE
suffix:semicolon
id|acpi_cm_acquire_mutex
(paren
id|ACPI_MTX_CACHES
)paren
suffix:semicolon
id|acpi_gbl_ext_parse_cache_depth
op_increment
suffix:semicolon
id|op-&gt;next
op_assign
(paren
id|ACPI_PARSE_OBJECT
op_star
)paren
id|acpi_gbl_ext_parse_cache
suffix:semicolon
id|acpi_gbl_ext_parse_cache
op_assign
(paren
id|ACPI_PARSE2_OBJECT
op_star
)paren
id|op
suffix:semicolon
id|acpi_cm_release_mutex
(paren
id|ACPI_MTX_CACHES
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
)brace
multiline_comment|/*&n;&t; * Not a GENERIC OP, or the cache is full, just free the Op&n;&t; */
id|acpi_cm_free
(paren
id|op
)paren
suffix:semicolon
)brace
multiline_comment|/*******************************************************************************&n; *&n; * FUNCTION:    Acpi_ps_delete_parse_cache&n; *&n; * PARAMETERS:  None&n; *&n; * RETURN:      None&n; *&n; * DESCRIPTION: Free all objects that are on the parse cache list.&n; *&n; ******************************************************************************/
r_void
DECL|function|acpi_ps_delete_parse_cache
id|acpi_ps_delete_parse_cache
(paren
r_void
)paren
(brace
id|ACPI_PARSE_OBJECT
op_star
id|next
suffix:semicolon
multiline_comment|/* Traverse the global cache list */
r_while
c_loop
(paren
id|acpi_gbl_parse_cache
)paren
(brace
multiline_comment|/* Delete one cached state object */
id|next
op_assign
id|acpi_gbl_parse_cache-&gt;next
suffix:semicolon
id|acpi_cm_free
(paren
id|acpi_gbl_parse_cache
)paren
suffix:semicolon
id|acpi_gbl_parse_cache
op_assign
id|next
suffix:semicolon
id|acpi_gbl_parse_cache_depth
op_decrement
suffix:semicolon
)brace
multiline_comment|/* Traverse the global cache list */
r_while
c_loop
(paren
id|acpi_gbl_ext_parse_cache
)paren
(brace
multiline_comment|/* Delete one cached state object */
id|next
op_assign
id|acpi_gbl_ext_parse_cache-&gt;next
suffix:semicolon
id|acpi_cm_free
(paren
id|acpi_gbl_ext_parse_cache
)paren
suffix:semicolon
id|acpi_gbl_ext_parse_cache
op_assign
(paren
id|ACPI_PARSE2_OBJECT
op_star
)paren
id|next
suffix:semicolon
id|acpi_gbl_ext_parse_cache_depth
op_decrement
suffix:semicolon
)brace
r_return
suffix:semicolon
)brace
multiline_comment|/*******************************************************************************&n; *&n; * FUNCTION:    Utility functions&n; *&n; * DESCRIPTION: Low level functions&n; *&n; * TBD: [Restructure]&n; * 1) Some of these functions should be macros&n; * 2) Some can be simplified&n; *&n; ******************************************************************************/
multiline_comment|/*&n; * Is &quot;c&quot; a namestring lead character?&n; */
id|u8
DECL|function|acpi_ps_is_leading_char
id|acpi_ps_is_leading_char
(paren
id|u32
id|c
)paren
(brace
r_return
(paren
(paren
id|u8
)paren
(paren
id|c
op_eq
l_char|&squot;_&squot;
op_logical_or
(paren
id|c
op_ge
l_char|&squot;A&squot;
op_logical_and
id|c
op_le
l_char|&squot;Z&squot;
)paren
)paren
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Is &quot;c&quot; a namestring prefix character?&n; */
id|u8
DECL|function|acpi_ps_is_prefix_char
id|acpi_ps_is_prefix_char
(paren
id|u32
id|c
)paren
(brace
r_return
(paren
(paren
id|u8
)paren
(paren
id|c
op_eq
l_char|&squot;&bslash;&bslash;&squot;
op_logical_or
id|c
op_eq
l_char|&squot;^&squot;
)paren
)paren
suffix:semicolon
)brace
id|u8
DECL|function|acpi_ps_is_namespace_object_op
id|acpi_ps_is_namespace_object_op
(paren
id|u16
id|opcode
)paren
(brace
r_return
(paren
(paren
id|u8
)paren
(paren
id|opcode
op_eq
id|AML_SCOPE_OP
op_logical_or
id|opcode
op_eq
id|AML_DEVICE_OP
op_logical_or
id|opcode
op_eq
id|AML_THERMAL_ZONE_OP
op_logical_or
id|opcode
op_eq
id|AML_METHOD_OP
op_logical_or
id|opcode
op_eq
id|AML_POWER_RES_OP
op_logical_or
id|opcode
op_eq
id|AML_PROCESSOR_OP
op_logical_or
id|opcode
op_eq
id|AML_DEF_FIELD_OP
op_logical_or
id|opcode
op_eq
id|AML_INDEX_FIELD_OP
op_logical_or
id|opcode
op_eq
id|AML_BANK_FIELD_OP
op_logical_or
id|opcode
op_eq
id|AML_NAMEDFIELD_OP
op_logical_or
id|opcode
op_eq
id|AML_NAME_OP
op_logical_or
id|opcode
op_eq
id|AML_ALIAS_OP
op_logical_or
id|opcode
op_eq
id|AML_MUTEX_OP
op_logical_or
id|opcode
op_eq
id|AML_EVENT_OP
op_logical_or
id|opcode
op_eq
id|AML_REGION_OP
op_logical_or
id|opcode
op_eq
id|AML_CREATE_FIELD_OP
op_logical_or
id|opcode
op_eq
id|AML_BIT_FIELD_OP
op_logical_or
id|opcode
op_eq
id|AML_BYTE_FIELD_OP
op_logical_or
id|opcode
op_eq
id|AML_WORD_FIELD_OP
op_logical_or
id|opcode
op_eq
id|AML_DWORD_FIELD_OP
op_logical_or
id|opcode
op_eq
id|AML_METHODCALL_OP
op_logical_or
id|opcode
op_eq
id|AML_NAMEPATH_OP
)paren
)paren
suffix:semicolon
)brace
id|u8
DECL|function|acpi_ps_is_namespace_op
id|acpi_ps_is_namespace_op
(paren
id|u16
id|opcode
)paren
(brace
r_return
(paren
(paren
id|u8
)paren
(paren
id|opcode
op_eq
id|AML_SCOPE_OP
op_logical_or
id|opcode
op_eq
id|AML_DEVICE_OP
op_logical_or
id|opcode
op_eq
id|AML_THERMAL_ZONE_OP
op_logical_or
id|opcode
op_eq
id|AML_METHOD_OP
op_logical_or
id|opcode
op_eq
id|AML_POWER_RES_OP
op_logical_or
id|opcode
op_eq
id|AML_PROCESSOR_OP
op_logical_or
id|opcode
op_eq
id|AML_DEF_FIELD_OP
op_logical_or
id|opcode
op_eq
id|AML_INDEX_FIELD_OP
op_logical_or
id|opcode
op_eq
id|AML_BANK_FIELD_OP
op_logical_or
id|opcode
op_eq
id|AML_NAME_OP
op_logical_or
id|opcode
op_eq
id|AML_ALIAS_OP
op_logical_or
id|opcode
op_eq
id|AML_MUTEX_OP
op_logical_or
id|opcode
op_eq
id|AML_EVENT_OP
op_logical_or
id|opcode
op_eq
id|AML_REGION_OP
op_logical_or
id|opcode
op_eq
id|AML_NAMEDFIELD_OP
)paren
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Is opcode for a named object Op?&n; * (Includes all named object opcodes)&n; *&n; * TBD: [Restructure] Need a better way than this brute force approach!&n; */
id|u8
DECL|function|acpi_ps_is_node_op
id|acpi_ps_is_node_op
(paren
id|u16
id|opcode
)paren
(brace
r_return
(paren
(paren
id|u8
)paren
(paren
id|opcode
op_eq
id|AML_SCOPE_OP
op_logical_or
id|opcode
op_eq
id|AML_DEVICE_OP
op_logical_or
id|opcode
op_eq
id|AML_THERMAL_ZONE_OP
op_logical_or
id|opcode
op_eq
id|AML_METHOD_OP
op_logical_or
id|opcode
op_eq
id|AML_POWER_RES_OP
op_logical_or
id|opcode
op_eq
id|AML_PROCESSOR_OP
op_logical_or
id|opcode
op_eq
id|AML_NAMEDFIELD_OP
op_logical_or
id|opcode
op_eq
id|AML_NAME_OP
op_logical_or
id|opcode
op_eq
id|AML_ALIAS_OP
op_logical_or
id|opcode
op_eq
id|AML_MUTEX_OP
op_logical_or
id|opcode
op_eq
id|AML_EVENT_OP
op_logical_or
id|opcode
op_eq
id|AML_REGION_OP
op_logical_or
id|opcode
op_eq
id|AML_CREATE_FIELD_OP
op_logical_or
id|opcode
op_eq
id|AML_BIT_FIELD_OP
op_logical_or
id|opcode
op_eq
id|AML_BYTE_FIELD_OP
op_logical_or
id|opcode
op_eq
id|AML_WORD_FIELD_OP
op_logical_or
id|opcode
op_eq
id|AML_DWORD_FIELD_OP
op_logical_or
id|opcode
op_eq
id|AML_METHODCALL_OP
op_logical_or
id|opcode
op_eq
id|AML_NAMEPATH_OP
)paren
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Is opcode for a named Op?&n; */
id|u8
DECL|function|acpi_ps_is_named_op
id|acpi_ps_is_named_op
(paren
id|u16
id|opcode
)paren
(brace
r_return
(paren
(paren
id|u8
)paren
(paren
id|opcode
op_eq
id|AML_SCOPE_OP
op_logical_or
id|opcode
op_eq
id|AML_DEVICE_OP
op_logical_or
id|opcode
op_eq
id|AML_THERMAL_ZONE_OP
op_logical_or
id|opcode
op_eq
id|AML_METHOD_OP
op_logical_or
id|opcode
op_eq
id|AML_POWER_RES_OP
op_logical_or
id|opcode
op_eq
id|AML_PROCESSOR_OP
op_logical_or
id|opcode
op_eq
id|AML_NAME_OP
op_logical_or
id|opcode
op_eq
id|AML_ALIAS_OP
op_logical_or
id|opcode
op_eq
id|AML_MUTEX_OP
op_logical_or
id|opcode
op_eq
id|AML_EVENT_OP
op_logical_or
id|opcode
op_eq
id|AML_REGION_OP
op_logical_or
id|opcode
op_eq
id|AML_NAMEDFIELD_OP
)paren
)paren
suffix:semicolon
)brace
id|u8
DECL|function|acpi_ps_is_deferred_op
id|acpi_ps_is_deferred_op
(paren
id|u16
id|opcode
)paren
(brace
r_return
(paren
(paren
id|u8
)paren
(paren
id|opcode
op_eq
id|AML_METHOD_OP
op_logical_or
id|opcode
op_eq
id|AML_CREATE_FIELD_OP
op_logical_or
id|opcode
op_eq
id|AML_BIT_FIELD_OP
op_logical_or
id|opcode
op_eq
id|AML_BYTE_FIELD_OP
op_logical_or
id|opcode
op_eq
id|AML_WORD_FIELD_OP
op_logical_or
id|opcode
op_eq
id|AML_DWORD_FIELD_OP
op_logical_or
id|opcode
op_eq
id|AML_REGION_OP
)paren
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Is opcode for a bytelist?&n; */
id|u8
DECL|function|acpi_ps_is_bytelist_op
id|acpi_ps_is_bytelist_op
(paren
id|u16
id|opcode
)paren
(brace
r_return
(paren
(paren
id|u8
)paren
(paren
id|opcode
op_eq
id|AML_BYTELIST_OP
)paren
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Is opcode for a Field, Index_field, or Bank_field&n; */
id|u8
DECL|function|acpi_ps_is_field_op
id|acpi_ps_is_field_op
(paren
id|u16
id|opcode
)paren
(brace
r_return
(paren
(paren
id|u8
)paren
(paren
id|opcode
op_eq
id|AML_CREATE_FIELD_OP
op_logical_or
id|opcode
op_eq
id|AML_DEF_FIELD_OP
op_logical_or
id|opcode
op_eq
id|AML_INDEX_FIELD_OP
op_logical_or
id|opcode
op_eq
id|AML_BANK_FIELD_OP
)paren
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Is field creation op&n; */
id|u8
DECL|function|acpi_ps_is_create_field_op
id|acpi_ps_is_create_field_op
(paren
id|u16
id|opcode
)paren
(brace
r_return
(paren
(paren
id|u8
)paren
(paren
id|opcode
op_eq
id|AML_CREATE_FIELD_OP
op_logical_or
id|opcode
op_eq
id|AML_BIT_FIELD_OP
op_logical_or
id|opcode
op_eq
id|AML_BYTE_FIELD_OP
op_logical_or
id|opcode
op_eq
id|AML_WORD_FIELD_OP
op_logical_or
id|opcode
op_eq
id|AML_DWORD_FIELD_OP
)paren
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Cast an acpi_op to an acpi_extended_op if possible&n; */
multiline_comment|/* TBD: This is very inefficient, fix */
id|ACPI_PARSE2_OBJECT
op_star
DECL|function|acpi_ps_to_extended_op
id|acpi_ps_to_extended_op
(paren
id|ACPI_PARSE_OBJECT
op_star
id|op
)paren
(brace
r_return
(paren
(paren
id|acpi_ps_is_deferred_op
(paren
id|op-&gt;opcode
)paren
op_logical_or
id|acpi_ps_is_named_op
(paren
id|op-&gt;opcode
)paren
op_logical_or
id|acpi_ps_is_bytelist_op
(paren
id|op-&gt;opcode
)paren
)paren
ques
c_cond
(paren
(paren
id|ACPI_PARSE2_OBJECT
op_star
)paren
id|op
)paren
suffix:colon
l_int|NULL
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Get op&squot;s name (4-byte name segment) or 0 if unnamed&n; */
id|u32
DECL|function|acpi_ps_get_name
id|acpi_ps_get_name
(paren
id|ACPI_PARSE_OBJECT
op_star
id|op
)paren
(brace
id|ACPI_PARSE2_OBJECT
op_star
id|named
op_assign
id|acpi_ps_to_extended_op
(paren
id|op
)paren
suffix:semicolon
r_return
(paren
id|named
ques
c_cond
id|named-&gt;name
suffix:colon
l_int|0
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Set op&squot;s name&n; */
r_void
DECL|function|acpi_ps_set_name
id|acpi_ps_set_name
(paren
id|ACPI_PARSE_OBJECT
op_star
id|op
comma
id|u32
id|name
)paren
(brace
id|ACPI_PARSE2_OBJECT
op_star
id|named
op_assign
id|acpi_ps_to_extended_op
(paren
id|op
)paren
suffix:semicolon
r_if
c_cond
(paren
id|named
)paren
(brace
id|named-&gt;name
op_assign
id|name
suffix:semicolon
)brace
)brace
eof
