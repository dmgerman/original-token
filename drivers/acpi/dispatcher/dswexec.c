multiline_comment|/******************************************************************************&n; *&n; * Module Name: dswexec - Dispatcher method execution callbacks;&n; *                        dispatch to interpreter.&n; *              $Revision: 50 $&n; *&n; *****************************************************************************/
multiline_comment|/*&n; *  Copyright (C) 2000 R. Byron Moore&n; *&n; *  This program is free software; you can redistribute it and/or modify&n; *  it under the terms of the GNU General Public License as published by&n; *  the Free Software Foundation; either version 2 of the License, or&n; *  (at your option) any later version.&n; *&n; *  This program is distributed in the hope that it will be useful,&n; *  but WITHOUT ANY WARRANTY; without even the implied warranty of&n; *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; *  GNU General Public License for more details.&n; *&n; *  You should have received a copy of the GNU General Public License&n; *  along with this program; if not, write to the Free Software&n; *  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA&n; */
macro_line|#include &quot;acpi.h&quot;
macro_line|#include &quot;acparser.h&quot;
macro_line|#include &quot;amlcode.h&quot;
macro_line|#include &quot;acdispat.h&quot;
macro_line|#include &quot;acinterp.h&quot;
macro_line|#include &quot;acnamesp.h&quot;
macro_line|#include &quot;acdebug.h&quot;
DECL|macro|_COMPONENT
mdefine_line|#define _COMPONENT          DISPATCHER
id|MODULE_NAME
(paren
l_string|&quot;dswexec&quot;
)paren
multiline_comment|/*****************************************************************************&n; *&n; * FUNCTION:    Acpi_ds_get_predicate_value&n; *&n; * PARAMETERS:  Walk_state      - Current state of the parse tree walk&n; *&n; * RETURN:      Status&n; *&n; * DESCRIPTION:&n; *&n; ****************************************************************************/
id|ACPI_STATUS
DECL|function|acpi_ds_get_predicate_value
id|acpi_ds_get_predicate_value
(paren
id|ACPI_WALK_STATE
op_star
id|walk_state
comma
id|ACPI_PARSE_OBJECT
op_star
id|op
comma
id|u32
id|has_result_obj
)paren
(brace
id|ACPI_STATUS
id|status
op_assign
id|AE_OK
suffix:semicolon
id|ACPI_OPERAND_OBJECT
op_star
id|obj_desc
suffix:semicolon
id|walk_state-&gt;control_state-&gt;common.state
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|has_result_obj
)paren
(brace
id|status
op_assign
id|acpi_ds_result_pop
(paren
op_amp
id|obj_desc
comma
id|walk_state
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_FAILURE
(paren
id|status
)paren
)paren
(brace
r_return
(paren
id|status
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
id|status
op_assign
id|acpi_ds_create_operand
(paren
id|walk_state
comma
id|op
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_FAILURE
(paren
id|status
)paren
)paren
(brace
r_return
(paren
id|status
)paren
suffix:semicolon
)brace
id|status
op_assign
id|acpi_aml_resolve_to_value
(paren
op_amp
id|walk_state-&gt;operands
(braket
l_int|0
)braket
comma
id|walk_state
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_FAILURE
(paren
id|status
)paren
)paren
(brace
r_return
(paren
id|status
)paren
suffix:semicolon
)brace
id|obj_desc
op_assign
id|walk_state-&gt;operands
(braket
l_int|0
)braket
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|obj_desc
)paren
(brace
r_return
(paren
id|AE_AML_NO_OPERAND
)paren
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * Result of predicate evaluation currently must&n;&t; * be a number&n;&t; */
r_if
c_cond
(paren
id|obj_desc-&gt;common.type
op_ne
id|ACPI_TYPE_NUMBER
)paren
(brace
id|status
op_assign
id|AE_AML_OPERAND_TYPE
suffix:semicolon
r_goto
id|cleanup
suffix:semicolon
)brace
multiline_comment|/* TBD: 64/32-bit */
id|obj_desc-&gt;number.value
op_and_assign
(paren
id|UINT64
)paren
l_int|0x00000000FFFFFFFF
suffix:semicolon
multiline_comment|/*&n;&t; * Save the result of the predicate evaluation on&n;&t; * the control stack&n;&t; */
r_if
c_cond
(paren
id|obj_desc-&gt;number.value
)paren
(brace
id|walk_state-&gt;control_state-&gt;common.value
op_assign
id|TRUE
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/*&n;&t;&t; * Predicate is FALSE, we will just toss the&n;&t;&t; * rest of the package&n;&t;&t; */
id|walk_state-&gt;control_state-&gt;common.value
op_assign
id|FALSE
suffix:semicolon
id|status
op_assign
id|AE_CTRL_FALSE
suffix:semicolon
)brace
id|cleanup
suffix:colon
multiline_comment|/* Break to debugger to display result */
id|DEBUGGER_EXEC
(paren
id|acpi_db_display_result_object
(paren
id|obj_desc
comma
id|walk_state
)paren
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Delete the predicate result object (we know that&n;&t; * we don&squot;t need it anymore)&n;&t; */
id|acpi_cm_remove_reference
(paren
id|obj_desc
)paren
suffix:semicolon
id|walk_state-&gt;control_state-&gt;common.state
op_assign
id|CONTROL_NORMAL
suffix:semicolon
r_return
(paren
id|status
)paren
suffix:semicolon
)brace
multiline_comment|/*****************************************************************************&n; *&n; * FUNCTION:    Acpi_ds_exec_begin_op&n; *&n; * PARAMETERS:  Walk_state      - Current state of the parse tree walk&n; *              Op              - Op that has been just been reached in the&n; *                                walk;  Arguments have not been evaluated yet.&n; *&n; * RETURN:      Status&n; *&n; * DESCRIPTION: Descending callback used during the execution of control&n; *              methods.  This is where most operators and operands are&n; *              dispatched to the interpreter.&n; *&n; ****************************************************************************/
id|ACPI_STATUS
DECL|function|acpi_ds_exec_begin_op
id|acpi_ds_exec_begin_op
(paren
id|u16
id|opcode
comma
id|ACPI_PARSE_OBJECT
op_star
id|op
comma
id|ACPI_WALK_STATE
op_star
id|walk_state
comma
id|ACPI_PARSE_OBJECT
op_star
op_star
id|out_op
)paren
(brace
id|ACPI_OPCODE_INFO
op_star
id|op_info
suffix:semicolon
id|ACPI_STATUS
id|status
op_assign
id|AE_OK
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|op
)paren
(brace
id|status
op_assign
id|acpi_ds_load2_begin_op
(paren
id|opcode
comma
l_int|NULL
comma
id|walk_state
comma
id|out_op
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_FAILURE
(paren
id|status
)paren
)paren
(brace
r_return
(paren
id|status
)paren
suffix:semicolon
)brace
id|op
op_assign
op_star
id|out_op
suffix:semicolon
)brace
r_if
c_cond
(paren
id|op
op_eq
id|walk_state-&gt;origin
)paren
(brace
r_if
c_cond
(paren
id|out_op
)paren
(brace
op_star
id|out_op
op_assign
id|op
suffix:semicolon
)brace
r_return
(paren
id|AE_OK
)paren
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * If the previous opcode was a conditional, this opcode&n;&t; * must be the beginning of the associated predicate.&n;&t; * Save this knowledge in the current scope descriptor&n;&t; */
r_if
c_cond
(paren
(paren
id|walk_state-&gt;control_state
)paren
op_logical_and
(paren
id|walk_state-&gt;control_state-&gt;common.state
op_eq
id|CONTROL_CONDITIONAL_EXECUTING
)paren
)paren
(brace
id|walk_state-&gt;control_state-&gt;common.state
op_assign
id|CONTROL_PREDICATE_EXECUTING
suffix:semicolon
multiline_comment|/* Save start of predicate */
id|walk_state-&gt;control_state-&gt;control.predicate_op
op_assign
id|op
suffix:semicolon
)brace
id|op_info
op_assign
id|acpi_ps_get_opcode_info
(paren
id|op-&gt;opcode
)paren
suffix:semicolon
multiline_comment|/* We want to send namepaths to the load code */
r_if
c_cond
(paren
id|op-&gt;opcode
op_eq
id|AML_NAMEPATH_OP
)paren
(brace
id|op_info-&gt;flags
op_assign
id|OPTYPE_NAMED_OBJECT
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * Handle the opcode based upon the opcode type&n;&t; */
r_switch
c_cond
(paren
id|ACPI_GET_OP_CLASS
(paren
id|op_info
)paren
)paren
(brace
r_case
id|OPTYPE_CONTROL
suffix:colon
id|status
op_assign
id|acpi_ds_result_stack_push
(paren
id|walk_state
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_FAILURE
(paren
id|status
)paren
)paren
(brace
r_return
(paren
id|status
)paren
suffix:semicolon
)brace
id|status
op_assign
id|acpi_ds_exec_begin_control_op
(paren
id|walk_state
comma
id|op
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|OPTYPE_NAMED_OBJECT
suffix:colon
r_if
c_cond
(paren
id|walk_state-&gt;walk_type
op_eq
id|WALK_METHOD
)paren
(brace
multiline_comment|/*&n;&t;&t;&t; * Found a named object declaration during method&n;&t;&t;&t; * execution;  we must enter this object into the&n;&t;&t;&t; * namespace.  The created object is temporary and&n;&t;&t;&t; * will be deleted upon completion of the execution&n;&t;&t;&t; * of this method.&n;&t;&t;&t; */
id|status
op_assign
id|acpi_ds_load2_begin_op
(paren
id|op-&gt;opcode
comma
id|op
comma
id|walk_state
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|op-&gt;opcode
op_eq
id|AML_REGION_OP
)paren
(brace
id|status
op_assign
id|acpi_ds_result_stack_push
(paren
id|walk_state
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
multiline_comment|/* most operators with arguments */
r_case
id|OPTYPE_MONADIC1
suffix:colon
r_case
id|OPTYPE_DYADIC1
suffix:colon
r_case
id|OPTYPE_MONADIC2
suffix:colon
r_case
id|OPTYPE_MONADIC2_r
suffix:colon
r_case
id|OPTYPE_DYADIC2
suffix:colon
r_case
id|OPTYPE_DYADIC2_r
suffix:colon
r_case
id|OPTYPE_DYADIC2_s
suffix:colon
r_case
id|OPTYPE_RECONFIGURATION
suffix:colon
r_case
id|OPTYPE_INDEX
suffix:colon
r_case
id|OPTYPE_MATCH
suffix:colon
r_case
id|OPTYPE_FATAL
suffix:colon
r_case
id|OPTYPE_CREATE_FIELD
suffix:colon
multiline_comment|/* Start a new result/operand state */
id|status
op_assign
id|acpi_ds_result_stack_push
(paren
id|walk_state
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_break
suffix:semicolon
)brace
multiline_comment|/* Nothing to do here during method execution */
r_return
(paren
id|status
)paren
suffix:semicolon
)brace
multiline_comment|/*****************************************************************************&n; *&n; * FUNCTION:    Acpi_ds_exec_end_op&n; *&n; * PARAMETERS:  Walk_state      - Current state of the parse tree walk&n; *              Op              - Op that has been just been completed in the&n; *                                walk;  Arguments have now been evaluated.&n; *&n; * RETURN:      Status&n; *&n; * DESCRIPTION: Ascending callback used during the execution of control&n; *              methods.  The only thing we really need to do here is to&n; *              notice the beginning of IF, ELSE, and WHILE blocks.&n; *&n; ****************************************************************************/
id|ACPI_STATUS
DECL|function|acpi_ds_exec_end_op
id|acpi_ds_exec_end_op
(paren
id|ACPI_WALK_STATE
op_star
id|walk_state
comma
id|ACPI_PARSE_OBJECT
op_star
id|op
)paren
(brace
id|ACPI_STATUS
id|status
op_assign
id|AE_OK
suffix:semicolon
id|u16
id|opcode
suffix:semicolon
id|u8
id|optype
suffix:semicolon
id|ACPI_PARSE_OBJECT
op_star
id|next_op
suffix:semicolon
id|ACPI_NAMESPACE_NODE
op_star
id|node
suffix:semicolon
id|ACPI_PARSE_OBJECT
op_star
id|first_arg
suffix:semicolon
id|ACPI_OPERAND_OBJECT
op_star
id|result_obj
op_assign
l_int|NULL
suffix:semicolon
id|ACPI_OPCODE_INFO
op_star
id|op_info
suffix:semicolon
id|u32
id|operand_index
suffix:semicolon
id|opcode
op_assign
(paren
id|u16
)paren
id|op-&gt;opcode
suffix:semicolon
id|op_info
op_assign
id|acpi_ps_get_opcode_info
(paren
id|op-&gt;opcode
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_GET_OP_TYPE
(paren
id|op_info
)paren
op_ne
id|ACPI_OP_TYPE_OPCODE
)paren
(brace
r_return
(paren
id|AE_NOT_IMPLEMENTED
)paren
suffix:semicolon
)brace
id|optype
op_assign
(paren
id|u8
)paren
id|ACPI_GET_OP_CLASS
(paren
id|op_info
)paren
suffix:semicolon
id|first_arg
op_assign
id|op-&gt;value.arg
suffix:semicolon
multiline_comment|/* Init the walk state */
id|walk_state-&gt;num_operands
op_assign
l_int|0
suffix:semicolon
id|walk_state-&gt;return_desc
op_assign
l_int|NULL
suffix:semicolon
multiline_comment|/* Call debugger for single step support (DEBUG build only) */
id|DEBUGGER_EXEC
(paren
id|status
op_assign
id|acpi_db_single_step
(paren
id|walk_state
comma
id|op
comma
id|optype
)paren
)paren
suffix:semicolon
id|DEBUGGER_EXEC
(paren
r_if
(paren
id|ACPI_FAILURE
(paren
id|status
)paren
)paren
(brace
r_return
(paren
id|status
)paren
suffix:semicolon
)brace
)paren
suffix:semicolon
multiline_comment|/* Decode the opcode */
r_switch
c_cond
(paren
id|optype
)paren
(brace
r_case
id|OPTYPE_UNDEFINED
suffix:colon
r_return
(paren
id|AE_NOT_IMPLEMENTED
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|OPTYPE_BOGUS
suffix:colon
r_break
suffix:semicolon
r_case
id|OPTYPE_CONSTANT
suffix:colon
multiline_comment|/* argument type only */
r_case
id|OPTYPE_LITERAL
suffix:colon
multiline_comment|/* argument type only */
r_case
id|OPTYPE_DATA_TERM
suffix:colon
multiline_comment|/* argument type only */
r_case
id|OPTYPE_LOCAL_VARIABLE
suffix:colon
multiline_comment|/* argument type only */
r_case
id|OPTYPE_METHOD_ARGUMENT
suffix:colon
multiline_comment|/* argument type only */
r_break
suffix:semicolon
multiline_comment|/* most operators with arguments */
r_case
id|OPTYPE_MONADIC1
suffix:colon
r_case
id|OPTYPE_DYADIC1
suffix:colon
r_case
id|OPTYPE_MONADIC2
suffix:colon
r_case
id|OPTYPE_MONADIC2_r
suffix:colon
r_case
id|OPTYPE_DYADIC2
suffix:colon
r_case
id|OPTYPE_DYADIC2_r
suffix:colon
r_case
id|OPTYPE_DYADIC2_s
suffix:colon
r_case
id|OPTYPE_RECONFIGURATION
suffix:colon
r_case
id|OPTYPE_INDEX
suffix:colon
r_case
id|OPTYPE_MATCH
suffix:colon
r_case
id|OPTYPE_FATAL
suffix:colon
multiline_comment|/* Build resolved operand stack */
id|status
op_assign
id|acpi_ds_create_operands
(paren
id|walk_state
comma
id|first_arg
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_FAILURE
(paren
id|status
)paren
)paren
(brace
r_goto
id|cleanup
suffix:semicolon
)brace
id|operand_index
op_assign
id|walk_state-&gt;num_operands
op_minus
l_int|1
suffix:semicolon
multiline_comment|/* Done with this result state (Now that operand stack is built) */
id|status
op_assign
id|acpi_ds_result_stack_pop
(paren
id|walk_state
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_FAILURE
(paren
id|status
)paren
)paren
(brace
r_goto
id|cleanup
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|optype
)paren
(brace
r_case
id|OPTYPE_MONADIC1
suffix:colon
multiline_comment|/* 1 Operand, 0 External_result, 0 Internal_result */
id|status
op_assign
id|acpi_aml_exec_monadic1
(paren
id|opcode
comma
id|walk_state
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|OPTYPE_MONADIC2
suffix:colon
multiline_comment|/* 1 Operand, 0 External_result, 1 Internal_result */
id|status
op_assign
id|acpi_aml_exec_monadic2
(paren
id|opcode
comma
id|walk_state
comma
op_amp
id|result_obj
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|OPTYPE_MONADIC2_r
suffix:colon
multiline_comment|/* 1 Operand, 1 External_result, 1 Internal_result */
id|status
op_assign
id|acpi_aml_exec_monadic2_r
(paren
id|opcode
comma
id|walk_state
comma
op_amp
id|result_obj
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|OPTYPE_DYADIC1
suffix:colon
multiline_comment|/* 2 Operands, 0 External_result, 0 Internal_result */
id|status
op_assign
id|acpi_aml_exec_dyadic1
(paren
id|opcode
comma
id|walk_state
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|OPTYPE_DYADIC2
suffix:colon
multiline_comment|/* 2 Operands, 0 External_result, 1 Internal_result */
id|status
op_assign
id|acpi_aml_exec_dyadic2
(paren
id|opcode
comma
id|walk_state
comma
op_amp
id|result_obj
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|OPTYPE_DYADIC2_r
suffix:colon
multiline_comment|/* 2 Operands, 1 or 2 External_results, 1 Internal_result */
id|status
op_assign
id|acpi_aml_exec_dyadic2_r
(paren
id|opcode
comma
id|walk_state
comma
op_amp
id|result_obj
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|OPTYPE_DYADIC2_s
suffix:colon
multiline_comment|/* Synchronization Operator */
multiline_comment|/* 2 Operands, 0 External_result, 1 Internal_result */
id|status
op_assign
id|acpi_aml_exec_dyadic2_s
(paren
id|opcode
comma
id|walk_state
comma
op_amp
id|result_obj
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|OPTYPE_INDEX
suffix:colon
multiline_comment|/* Type 2 opcode with 3 operands */
multiline_comment|/* 3 Operands, 1 External_result, 1 Internal_result */
id|status
op_assign
id|acpi_aml_exec_index
(paren
id|walk_state
comma
op_amp
id|result_obj
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|OPTYPE_MATCH
suffix:colon
multiline_comment|/* Type 2 opcode with 6 operands */
multiline_comment|/* 6 Operands, 0 External_result, 1 Internal_result */
id|status
op_assign
id|acpi_aml_exec_match
(paren
id|walk_state
comma
op_amp
id|result_obj
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|OPTYPE_RECONFIGURATION
suffix:colon
multiline_comment|/* 1 or 2 operands, 0 Internal Result */
id|status
op_assign
id|acpi_aml_exec_reconfiguration
(paren
id|opcode
comma
id|walk_state
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|OPTYPE_FATAL
suffix:colon
multiline_comment|/* 3 Operands, 0 External_result, 0 Internal_result */
id|status
op_assign
id|acpi_aml_exec_fatal
(paren
id|walk_state
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
multiline_comment|/*&n;&t;&t; * If a result object was returned from above, push it on the&n;&t;&t; * current result stack&n;&t;&t; */
r_if
c_cond
(paren
id|ACPI_SUCCESS
(paren
id|status
)paren
op_logical_and
id|result_obj
)paren
(brace
id|status
op_assign
id|acpi_ds_result_push
(paren
id|result_obj
comma
id|walk_state
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|OPTYPE_CONTROL
suffix:colon
multiline_comment|/* Type 1 opcode, IF/ELSE/WHILE/NOOP */
multiline_comment|/* 1 Operand, 0 External_result, 0 Internal_result */
id|status
op_assign
id|acpi_ds_exec_end_control_op
(paren
id|walk_state
comma
id|op
)paren
suffix:semicolon
id|acpi_ds_result_stack_pop
(paren
id|walk_state
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|OPTYPE_METHOD_CALL
suffix:colon
multiline_comment|/*&n;&t;&t; * (AML_METHODCALL) Op-&gt;Value-&gt;Arg-&gt;Node contains&n;&t;&t; * the method Node pointer&n;&t;&t; */
multiline_comment|/* Next_op points to the op that holds the method name */
id|next_op
op_assign
id|first_arg
suffix:semicolon
id|node
op_assign
id|next_op-&gt;node
suffix:semicolon
multiline_comment|/* Next_op points to first argument op */
id|next_op
op_assign
id|next_op-&gt;next
suffix:semicolon
multiline_comment|/*&n;&t;&t; * Get the method&squot;s arguments and put them on the operand stack&n;&t;&t; */
id|status
op_assign
id|acpi_ds_create_operands
(paren
id|walk_state
comma
id|next_op
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_FAILURE
(paren
id|status
)paren
)paren
(brace
r_break
suffix:semicolon
)brace
multiline_comment|/*&n;&t;&t; * Since the operands will be passed to another&n;&t;&t; * control method, we must resolve all local&n;&t;&t; * references here (Local variables, arguments&n;&t;&t; * to *this* method, etc.)&n;&t;&t; */
id|status
op_assign
id|acpi_ds_resolve_operands
(paren
id|walk_state
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_FAILURE
(paren
id|status
)paren
)paren
(brace
r_break
suffix:semicolon
)brace
multiline_comment|/*&n;&t;&t; * Tell the walk loop to preempt this running method and&n;&t;&t; * execute the new method&n;&t;&t; */
id|status
op_assign
id|AE_CTRL_TRANSFER
suffix:semicolon
multiline_comment|/*&n;&t;&t; * Return now; we don&squot;t want to disturb anything,&n;&t;&t; * especially the operand count!&n;&t;&t; */
r_return
(paren
id|status
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|OPTYPE_CREATE_FIELD
suffix:colon
id|status
op_assign
id|acpi_ds_load2_end_op
(paren
id|walk_state
comma
id|op
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_FAILURE
(paren
id|status
)paren
)paren
(brace
r_break
suffix:semicolon
)brace
id|status
op_assign
id|acpi_ds_eval_field_unit_operands
(paren
id|walk_state
comma
id|op
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|OPTYPE_NAMED_OBJECT
suffix:colon
id|status
op_assign
id|acpi_ds_load2_end_op
(paren
id|walk_state
comma
id|op
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_FAILURE
(paren
id|status
)paren
)paren
(brace
r_break
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|op-&gt;opcode
)paren
(brace
r_case
id|AML_REGION_OP
suffix:colon
id|status
op_assign
id|acpi_ds_eval_region_operands
(paren
id|walk_state
comma
id|op
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_FAILURE
(paren
id|status
)paren
)paren
(brace
r_break
suffix:semicolon
)brace
id|status
op_assign
id|acpi_ds_result_stack_pop
(paren
id|walk_state
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AML_METHOD_OP
suffix:colon
r_break
suffix:semicolon
r_case
id|AML_ALIAS_OP
suffix:colon
multiline_comment|/* Alias creation was already handled by call&n;&t;&t;&t;to psxload above */
r_break
suffix:semicolon
r_default
suffix:colon
multiline_comment|/* Nothing needs to be done */
id|status
op_assign
id|AE_OK
suffix:semicolon
r_break
suffix:semicolon
)brace
r_break
suffix:semicolon
r_default
suffix:colon
id|status
op_assign
id|AE_NOT_IMPLEMENTED
suffix:semicolon
r_break
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * ACPI 2.0 support for 64-bit integers:&n;&t; * Truncate numeric result value if we are executing from a 32-bit ACPI table&n;&t; */
id|acpi_aml_truncate_for32bit_table
(paren
id|result_obj
comma
id|walk_state
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Check if we just completed the evaluation of a&n;&t; * conditional predicate&n;&t; */
r_if
c_cond
(paren
(paren
id|walk_state-&gt;control_state
)paren
op_logical_and
(paren
id|walk_state-&gt;control_state-&gt;common.state
op_eq
id|CONTROL_PREDICATE_EXECUTING
)paren
op_logical_and
(paren
id|walk_state-&gt;control_state-&gt;control.predicate_op
op_eq
id|op
)paren
)paren
(brace
id|status
op_assign
id|acpi_ds_get_predicate_value
(paren
id|walk_state
comma
id|op
comma
(paren
id|u32
)paren
id|result_obj
)paren
suffix:semicolon
id|result_obj
op_assign
l_int|NULL
suffix:semicolon
)brace
id|cleanup
suffix:colon
r_if
c_cond
(paren
id|result_obj
)paren
(brace
multiline_comment|/* Break to debugger to display result */
id|DEBUGGER_EXEC
(paren
id|acpi_db_display_result_object
(paren
id|result_obj
comma
id|walk_state
)paren
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t; * Delete the result op if and only if:&n;&t;&t; * Parent will not use the result -- such as any&n;&t;&t; * non-nested type2 op in a method (parent will be method)&n;&t;&t; */
id|acpi_ds_delete_result_if_not_used
(paren
id|op
comma
id|result_obj
comma
id|walk_state
)paren
suffix:semicolon
)brace
multiline_comment|/* Always clear the object stack */
multiline_comment|/* TBD: [Investigate] Clear stack of return value,&n;&t;but don&squot;t delete it */
id|walk_state-&gt;num_operands
op_assign
l_int|0
suffix:semicolon
r_return
(paren
id|status
)paren
suffix:semicolon
)brace
eof
