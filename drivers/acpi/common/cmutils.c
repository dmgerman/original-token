multiline_comment|/*******************************************************************************&n; *&n; * Module Name: cmutils - common utility procedures&n; *              $Revision: 21 $&n; *&n; ******************************************************************************/
multiline_comment|/*&n; *  Copyright (C) 2000 R. Byron Moore&n; *&n; *  This program is free software; you can redistribute it and/or modify&n; *  it under the terms of the GNU General Public License as published by&n; *  the Free Software Foundation; either version 2 of the License, or&n; *  (at your option) any later version.&n; *&n; *  This program is distributed in the hope that it will be useful,&n; *  but WITHOUT ANY WARRANTY; without even the implied warranty of&n; *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; *  GNU General Public License for more details.&n; *&n; *  You should have received a copy of the GNU General Public License&n; *  along with this program; if not, write to the Free Software&n; *  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA&n; */
macro_line|#include &quot;acpi.h&quot;
macro_line|#include &quot;acevents.h&quot;
macro_line|#include &quot;achware.h&quot;
macro_line|#include &quot;acnamesp.h&quot;
macro_line|#include &quot;acinterp.h&quot;
macro_line|#include &quot;amlcode.h&quot;
macro_line|#include &quot;acdebug.h&quot;
DECL|macro|_COMPONENT
mdefine_line|#define _COMPONENT          MISCELLANEOUS
id|MODULE_NAME
(paren
l_string|&quot;cmutils&quot;
)paren
multiline_comment|/*******************************************************************************&n; *&n; * FUNCTION:    Acpi_cm_valid_acpi_name&n; *&n; * PARAMETERS:  Character           - The character to be examined&n; *&n; * RETURN:      1 if Character may appear in a name, else 0&n; *&n; * DESCRIPTION: Check for a valid ACPI name.  Each character must be one of:&n; *              1) Upper case alpha&n; *              2) numeric&n; *              3) underscore&n; *&n; ******************************************************************************/
id|u8
DECL|function|acpi_cm_valid_acpi_name
id|acpi_cm_valid_acpi_name
(paren
id|u32
id|name
)paren
(brace
id|NATIVE_CHAR
op_star
id|name_ptr
op_assign
(paren
id|NATIVE_CHAR
op_star
)paren
op_amp
id|name
suffix:semicolon
id|u32
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ACPI_NAME_SIZE
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
(paren
id|name_ptr
(braket
id|i
)braket
op_eq
l_char|&squot;_&squot;
)paren
op_logical_or
(paren
id|name_ptr
(braket
id|i
)braket
op_ge
l_char|&squot;A&squot;
op_logical_and
id|name_ptr
(braket
id|i
)braket
op_le
l_char|&squot;Z&squot;
)paren
op_logical_or
(paren
id|name_ptr
(braket
id|i
)braket
op_ge
l_char|&squot;0&squot;
op_logical_and
id|name_ptr
(braket
id|i
)braket
op_le
l_char|&squot;9&squot;
)paren
)paren
)paren
(brace
r_return
(paren
id|FALSE
)paren
suffix:semicolon
)brace
)brace
r_return
(paren
id|TRUE
)paren
suffix:semicolon
)brace
multiline_comment|/*******************************************************************************&n; *&n; * FUNCTION:    Acpi_cm_valid_acpi_character&n; *&n; * PARAMETERS:  Character           - The character to be examined&n; *&n; * RETURN:      1 if Character may appear in a name, else 0&n; *&n; * DESCRIPTION: Check for a printable character&n; *&n; ******************************************************************************/
id|u8
DECL|function|acpi_cm_valid_acpi_character
id|acpi_cm_valid_acpi_character
(paren
id|NATIVE_CHAR
id|character
)paren
(brace
r_return
(paren
(paren
id|u8
)paren
(paren
(paren
id|character
op_eq
l_char|&squot;_&squot;
)paren
op_logical_or
(paren
id|character
op_ge
l_char|&squot;A&squot;
op_logical_and
id|character
op_le
l_char|&squot;Z&squot;
)paren
op_logical_or
(paren
id|character
op_ge
l_char|&squot;0&squot;
op_logical_and
id|character
op_le
l_char|&squot;9&squot;
)paren
)paren
)paren
suffix:semicolon
)brace
multiline_comment|/*******************************************************************************&n; *&n; * FUNCTION:    Acpi_cm_mutex_initialize&n; *&n; * PARAMETERS:  None.&n; *&n; * RETURN:      Status&n; *&n; * DESCRIPTION: Create the system mutex objects.&n; *&n; ******************************************************************************/
id|ACPI_STATUS
DECL|function|acpi_cm_mutex_initialize
id|acpi_cm_mutex_initialize
(paren
r_void
)paren
(brace
id|u32
id|i
suffix:semicolon
id|ACPI_STATUS
id|status
suffix:semicolon
multiline_comment|/*&n;&t; * Create each of the predefined mutex objects&n;&t; */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|NUM_MTX
suffix:semicolon
id|i
op_increment
)paren
(brace
id|status
op_assign
id|acpi_cm_create_mutex
(paren
id|i
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_FAILURE
(paren
id|status
)paren
)paren
(brace
r_return
(paren
id|status
)paren
suffix:semicolon
)brace
)brace
r_return
(paren
id|AE_OK
)paren
suffix:semicolon
)brace
multiline_comment|/*******************************************************************************&n; *&n; * FUNCTION:    Acpi_cm_mutex_terminate&n; *&n; * PARAMETERS:  None.&n; *&n; * RETURN:      None.&n; *&n; * DESCRIPTION: Delete all of the system mutex objects.&n; *&n; ******************************************************************************/
r_void
DECL|function|acpi_cm_mutex_terminate
id|acpi_cm_mutex_terminate
(paren
r_void
)paren
(brace
id|u32
id|i
suffix:semicolon
multiline_comment|/*&n;&t; * Delete each predefined mutex object&n;&t; */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|NUM_MTX
suffix:semicolon
id|i
op_increment
)paren
(brace
id|acpi_cm_delete_mutex
(paren
id|i
)paren
suffix:semicolon
)brace
r_return
suffix:semicolon
)brace
multiline_comment|/*******************************************************************************&n; *&n; * FUNCTION:    Acpi_cm_create_mutex&n; *&n; * PARAMETERS:  Mutex_iD        - ID of the mutex to be created&n; *&n; * RETURN:      Status&n; *&n; * DESCRIPTION: Create a mutex object.&n; *&n; ******************************************************************************/
id|ACPI_STATUS
DECL|function|acpi_cm_create_mutex
id|acpi_cm_create_mutex
(paren
id|ACPI_MUTEX_HANDLE
id|mutex_id
)paren
(brace
id|ACPI_STATUS
id|status
op_assign
id|AE_OK
suffix:semicolon
r_if
c_cond
(paren
id|mutex_id
OG
id|MAX_MTX
)paren
(brace
r_return
(paren
id|AE_BAD_PARAMETER
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|acpi_gbl_acpi_mutex_info
(braket
id|mutex_id
)braket
dot
id|mutex
)paren
(brace
id|status
op_assign
id|acpi_os_create_semaphore
(paren
l_int|1
comma
l_int|1
comma
op_amp
id|acpi_gbl_acpi_mutex_info
(braket
id|mutex_id
)braket
dot
id|mutex
)paren
suffix:semicolon
id|acpi_gbl_acpi_mutex_info
(braket
id|mutex_id
)braket
dot
id|locked
op_assign
id|FALSE
suffix:semicolon
id|acpi_gbl_acpi_mutex_info
(braket
id|mutex_id
)braket
dot
id|use_count
op_assign
l_int|0
suffix:semicolon
)brace
r_return
(paren
id|status
)paren
suffix:semicolon
)brace
multiline_comment|/*******************************************************************************&n; *&n; * FUNCTION:    Acpi_cm_delete_mutex&n; *&n; * PARAMETERS:  Mutex_iD        - ID of the mutex to be deleted&n; *&n; * RETURN:      Status&n; *&n; * DESCRIPTION: Delete a mutex object.&n; *&n; ******************************************************************************/
id|ACPI_STATUS
DECL|function|acpi_cm_delete_mutex
id|acpi_cm_delete_mutex
(paren
id|ACPI_MUTEX_HANDLE
id|mutex_id
)paren
(brace
id|ACPI_STATUS
id|status
suffix:semicolon
r_if
c_cond
(paren
id|mutex_id
OG
id|MAX_MTX
)paren
(brace
r_return
(paren
id|AE_BAD_PARAMETER
)paren
suffix:semicolon
)brace
id|status
op_assign
id|acpi_os_delete_semaphore
(paren
id|acpi_gbl_acpi_mutex_info
(braket
id|mutex_id
)braket
dot
id|mutex
)paren
suffix:semicolon
id|acpi_gbl_acpi_mutex_info
(braket
id|mutex_id
)braket
dot
id|mutex
op_assign
l_int|NULL
suffix:semicolon
id|acpi_gbl_acpi_mutex_info
(braket
id|mutex_id
)braket
dot
id|locked
op_assign
id|FALSE
suffix:semicolon
r_return
(paren
id|status
)paren
suffix:semicolon
)brace
multiline_comment|/*******************************************************************************&n; *&n; * FUNCTION:    Acpi_cm_acquire_mutex&n; *&n; * PARAMETERS:  Mutex_iD        - ID of the mutex to be acquired&n; *&n; * RETURN:      Status&n; *&n; * DESCRIPTION: Acquire a mutex object.&n; *&n; ******************************************************************************/
id|ACPI_STATUS
DECL|function|acpi_cm_acquire_mutex
id|acpi_cm_acquire_mutex
(paren
id|ACPI_MUTEX_HANDLE
id|mutex_id
)paren
(brace
id|ACPI_STATUS
id|status
suffix:semicolon
r_if
c_cond
(paren
id|mutex_id
OG
id|MAX_MTX
)paren
(brace
r_return
(paren
id|AE_BAD_PARAMETER
)paren
suffix:semicolon
)brace
id|status
op_assign
id|acpi_os_wait_semaphore
(paren
id|acpi_gbl_acpi_mutex_info
(braket
id|mutex_id
)braket
dot
id|mutex
comma
l_int|1
comma
id|WAIT_FOREVER
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACPI_SUCCESS
(paren
id|status
)paren
)paren
(brace
id|acpi_gbl_acpi_mutex_info
(braket
id|mutex_id
)braket
dot
id|locked
op_assign
id|TRUE
suffix:semicolon
id|acpi_gbl_acpi_mutex_info
(braket
id|mutex_id
)braket
dot
id|use_count
op_increment
suffix:semicolon
)brace
r_return
(paren
id|status
)paren
suffix:semicolon
)brace
multiline_comment|/*******************************************************************************&n; *&n; * FUNCTION:    Acpi_cm_release_mutex&n; *&n; * PARAMETERS:  Mutex_iD        - ID of the mutex to be released&n; *&n; * RETURN:      Status&n; *&n; * DESCRIPTION: Release a mutex object.&n; *&n; ******************************************************************************/
id|ACPI_STATUS
DECL|function|acpi_cm_release_mutex
id|acpi_cm_release_mutex
(paren
id|ACPI_MUTEX_HANDLE
id|mutex_id
)paren
(brace
id|ACPI_STATUS
id|status
suffix:semicolon
r_if
c_cond
(paren
id|mutex_id
OG
id|MAX_MTX
)paren
(brace
r_return
(paren
id|AE_BAD_PARAMETER
)paren
suffix:semicolon
)brace
id|acpi_gbl_acpi_mutex_info
(braket
id|mutex_id
)braket
dot
id|locked
op_assign
id|FALSE
suffix:semicolon
multiline_comment|/* Mark before unlocking */
id|status
op_assign
id|acpi_os_signal_semaphore
(paren
id|acpi_gbl_acpi_mutex_info
(braket
id|mutex_id
)braket
dot
id|mutex
comma
l_int|1
)paren
suffix:semicolon
r_return
(paren
id|status
)paren
suffix:semicolon
)brace
multiline_comment|/*******************************************************************************&n; *&n; * FUNCTION:    Acpi_cm_create_update_state_and_push&n; *&n; * PARAMETERS:  *Object         - Object to be added to the new state&n; *              Action          - Increment/Decrement&n; *              State_list      - List the state will be added to&n; *&n; * RETURN:      None&n; *&n; * DESCRIPTION: Create a new state and push it&n; *&n; ******************************************************************************/
id|ACPI_STATUS
DECL|function|acpi_cm_create_update_state_and_push
id|acpi_cm_create_update_state_and_push
(paren
id|ACPI_OPERAND_OBJECT
op_star
id|object
comma
id|u16
id|action
comma
id|ACPI_GENERIC_STATE
op_star
op_star
id|state_list
)paren
(brace
id|ACPI_GENERIC_STATE
op_star
id|state
suffix:semicolon
multiline_comment|/* Ignore null objects; these are expected */
r_if
c_cond
(paren
op_logical_neg
id|object
)paren
(brace
r_return
(paren
id|AE_OK
)paren
suffix:semicolon
)brace
id|state
op_assign
id|acpi_cm_create_update_state
(paren
id|object
comma
id|action
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|state
)paren
(brace
r_return
(paren
id|AE_NO_MEMORY
)paren
suffix:semicolon
)brace
id|acpi_cm_push_generic_state
(paren
id|state_list
comma
id|state
)paren
suffix:semicolon
r_return
(paren
id|AE_OK
)paren
suffix:semicolon
)brace
multiline_comment|/*******************************************************************************&n; *&n; * FUNCTION:    Acpi_cm_push_generic_state&n; *&n; * PARAMETERS:  List_head           - Head of the state stack&n; *              State               - State object to push&n; *&n; * RETURN:      Status&n; *&n; * DESCRIPTION: Push a state object onto a state stack&n; *&n; ******************************************************************************/
r_void
DECL|function|acpi_cm_push_generic_state
id|acpi_cm_push_generic_state
(paren
id|ACPI_GENERIC_STATE
op_star
op_star
id|list_head
comma
id|ACPI_GENERIC_STATE
op_star
id|state
)paren
(brace
multiline_comment|/* Push the state object onto the front of the list (stack) */
id|state-&gt;common.next
op_assign
op_star
id|list_head
suffix:semicolon
op_star
id|list_head
op_assign
id|state
suffix:semicolon
r_return
suffix:semicolon
)brace
multiline_comment|/*******************************************************************************&n; *&n; * FUNCTION:    Acpi_cm_pop_generic_state&n; *&n; * PARAMETERS:  List_head           - Head of the state stack&n; *&n; * RETURN:      Status&n; *&n; * DESCRIPTION: Pop a state object from a state stack&n; *&n; ******************************************************************************/
id|ACPI_GENERIC_STATE
op_star
DECL|function|acpi_cm_pop_generic_state
id|acpi_cm_pop_generic_state
(paren
id|ACPI_GENERIC_STATE
op_star
op_star
id|list_head
)paren
(brace
id|ACPI_GENERIC_STATE
op_star
id|state
suffix:semicolon
multiline_comment|/* Remove the state object at the head of the list (stack) */
id|state
op_assign
op_star
id|list_head
suffix:semicolon
r_if
c_cond
(paren
id|state
)paren
(brace
multiline_comment|/* Update the list head */
op_star
id|list_head
op_assign
id|state-&gt;common.next
suffix:semicolon
)brace
r_return
(paren
id|state
)paren
suffix:semicolon
)brace
multiline_comment|/*******************************************************************************&n; *&n; * FUNCTION:    Acpi_cm_create_generic_state&n; *&n; * PARAMETERS:  None&n; *&n; * RETURN:      Status&n; *&n; * DESCRIPTION: Create a generic state object.  Attempt to obtain one from&n; *              the global state cache;  If none available, create a new one.&n; *&n; ******************************************************************************/
id|ACPI_GENERIC_STATE
op_star
DECL|function|acpi_cm_create_generic_state
id|acpi_cm_create_generic_state
(paren
r_void
)paren
(brace
id|ACPI_GENERIC_STATE
op_star
id|state
suffix:semicolon
id|acpi_cm_acquire_mutex
(paren
id|ACPI_MTX_CACHES
)paren
suffix:semicolon
id|acpi_gbl_state_cache_requests
op_increment
suffix:semicolon
multiline_comment|/* Check the cache first */
r_if
c_cond
(paren
id|acpi_gbl_generic_state_cache
)paren
(brace
multiline_comment|/* There is an object available, use it */
id|state
op_assign
id|acpi_gbl_generic_state_cache
suffix:semicolon
id|acpi_gbl_generic_state_cache
op_assign
id|state-&gt;common.next
suffix:semicolon
id|state-&gt;common.next
op_assign
l_int|NULL
suffix:semicolon
id|acpi_gbl_state_cache_hits
op_increment
suffix:semicolon
id|acpi_gbl_generic_state_cache_depth
op_decrement
suffix:semicolon
id|acpi_cm_release_mutex
(paren
id|ACPI_MTX_CACHES
)paren
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* The cache is empty, create a new object */
id|acpi_cm_release_mutex
(paren
id|ACPI_MTX_CACHES
)paren
suffix:semicolon
id|state
op_assign
id|acpi_cm_callocate
(paren
r_sizeof
(paren
id|ACPI_GENERIC_STATE
)paren
)paren
suffix:semicolon
)brace
multiline_comment|/* Initialize */
r_if
c_cond
(paren
id|state
)paren
(brace
multiline_comment|/* Always zero out the object before init */
id|MEMSET
(paren
id|state
comma
l_int|0
comma
r_sizeof
(paren
id|ACPI_GENERIC_STATE
)paren
)paren
suffix:semicolon
id|state-&gt;common.data_type
op_assign
id|ACPI_DESC_TYPE_STATE
suffix:semicolon
)brace
r_return
(paren
id|state
)paren
suffix:semicolon
)brace
multiline_comment|/*******************************************************************************&n; *&n; * FUNCTION:    Acpi_cm_create_update_state&n; *&n; * PARAMETERS:  Object              - Initial Object to be installed in the&n; *                                    state&n; *              Action              - Update action to be performed&n; *&n; * RETURN:      Status&n; *&n; * DESCRIPTION: Create an &quot;Update State&quot; - a flavor of the generic state used&n; *              to update reference counts and delete complex objects such&n; *              as packages.&n; *&n; ******************************************************************************/
id|ACPI_GENERIC_STATE
op_star
DECL|function|acpi_cm_create_update_state
id|acpi_cm_create_update_state
(paren
id|ACPI_OPERAND_OBJECT
op_star
id|object
comma
id|u16
id|action
)paren
(brace
id|ACPI_GENERIC_STATE
op_star
id|state
suffix:semicolon
multiline_comment|/* Create the generic state object */
id|state
op_assign
id|acpi_cm_create_generic_state
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|state
)paren
(brace
r_return
(paren
l_int|NULL
)paren
suffix:semicolon
)brace
multiline_comment|/* Init fields specific to the update struct */
id|state-&gt;update.object
op_assign
id|object
suffix:semicolon
id|state-&gt;update.value
op_assign
id|action
suffix:semicolon
r_return
(paren
id|state
)paren
suffix:semicolon
)brace
multiline_comment|/*******************************************************************************&n; *&n; * FUNCTION:    Acpi_cm_create_control_state&n; *&n; * PARAMETERS:  None&n; *&n; * RETURN:      Status&n; *&n; * DESCRIPTION: Create a &quot;Control State&quot; - a flavor of the generic state used&n; *              to support nested IF/WHILE constructs in the AML.&n; *&n; ******************************************************************************/
id|ACPI_GENERIC_STATE
op_star
DECL|function|acpi_cm_create_control_state
id|acpi_cm_create_control_state
(paren
r_void
)paren
(brace
id|ACPI_GENERIC_STATE
op_star
id|state
suffix:semicolon
multiline_comment|/* Create the generic state object */
id|state
op_assign
id|acpi_cm_create_generic_state
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|state
)paren
(brace
r_return
(paren
l_int|NULL
)paren
suffix:semicolon
)brace
multiline_comment|/* Init fields specific to the control struct */
id|state-&gt;common.state
op_assign
id|CONTROL_CONDITIONAL_EXECUTING
suffix:semicolon
r_return
(paren
id|state
)paren
suffix:semicolon
)brace
multiline_comment|/*******************************************************************************&n; *&n; * FUNCTION:    Acpi_cm_delete_generic_state&n; *&n; * PARAMETERS:  State               - The state object to be deleted&n; *&n; * RETURN:      Status&n; *&n; * DESCRIPTION: Put a state object back into the global state cache.  The object&n; *              is not actually freed at this time.&n; *&n; ******************************************************************************/
r_void
DECL|function|acpi_cm_delete_generic_state
id|acpi_cm_delete_generic_state
(paren
id|ACPI_GENERIC_STATE
op_star
id|state
)paren
(brace
multiline_comment|/* If cache is full, just free this state object */
r_if
c_cond
(paren
id|acpi_gbl_generic_state_cache_depth
op_ge
id|MAX_STATE_CACHE_DEPTH
)paren
(brace
id|acpi_cm_free
(paren
id|state
)paren
suffix:semicolon
)brace
multiline_comment|/* Otherwise put this object back into the cache */
r_else
(brace
id|acpi_cm_acquire_mutex
(paren
id|ACPI_MTX_CACHES
)paren
suffix:semicolon
multiline_comment|/* Clear the state */
id|MEMSET
(paren
id|state
comma
l_int|0
comma
r_sizeof
(paren
id|ACPI_GENERIC_STATE
)paren
)paren
suffix:semicolon
id|state-&gt;common.data_type
op_assign
id|ACPI_DESC_TYPE_STATE
suffix:semicolon
multiline_comment|/* Put the object at the head of the global cache list */
id|state-&gt;common.next
op_assign
id|acpi_gbl_generic_state_cache
suffix:semicolon
id|acpi_gbl_generic_state_cache
op_assign
id|state
suffix:semicolon
id|acpi_gbl_generic_state_cache_depth
op_increment
suffix:semicolon
id|acpi_cm_release_mutex
(paren
id|ACPI_MTX_CACHES
)paren
suffix:semicolon
)brace
r_return
suffix:semicolon
)brace
multiline_comment|/*******************************************************************************&n; *&n; * FUNCTION:    Acpi_cm_delete_generic_state_cache&n; *&n; * PARAMETERS:  None&n; *&n; * RETURN:      Status&n; *&n; * DESCRIPTION: Purge the global state object cache.  Used during subsystem&n; *              termination.&n; *&n; ******************************************************************************/
r_void
DECL|function|acpi_cm_delete_generic_state_cache
id|acpi_cm_delete_generic_state_cache
(paren
r_void
)paren
(brace
id|ACPI_GENERIC_STATE
op_star
id|next
suffix:semicolon
multiline_comment|/* Traverse the global cache list */
r_while
c_loop
(paren
id|acpi_gbl_generic_state_cache
)paren
(brace
multiline_comment|/* Delete one cached state object */
id|next
op_assign
id|acpi_gbl_generic_state_cache-&gt;common.next
suffix:semicolon
id|acpi_cm_free
(paren
id|acpi_gbl_generic_state_cache
)paren
suffix:semicolon
id|acpi_gbl_generic_state_cache
op_assign
id|next
suffix:semicolon
id|acpi_gbl_generic_state_cache_depth
op_decrement
suffix:semicolon
)brace
r_return
suffix:semicolon
)brace
multiline_comment|/*******************************************************************************&n; *&n; * FUNCTION:    Acpi_cm_resolve_package_references&n; *&n; * PARAMETERS:  Obj_desc        - The Package object on which to resolve refs&n; *&n; * RETURN:      Status&n; *&n; * DESCRIPTION: Walk through a package and turn internal references into values&n; *&n; ******************************************************************************/
id|ACPI_STATUS
DECL|function|acpi_cm_resolve_package_references
id|acpi_cm_resolve_package_references
(paren
id|ACPI_OPERAND_OBJECT
op_star
id|obj_desc
)paren
(brace
id|u32
id|count
suffix:semicolon
id|ACPI_OPERAND_OBJECT
op_star
id|sub_object
suffix:semicolon
r_if
c_cond
(paren
id|obj_desc-&gt;common.type
op_ne
id|ACPI_TYPE_PACKAGE
)paren
(brace
multiline_comment|/* Must be a package */
id|REPORT_ERROR
(paren
(paren
l_string|&quot;Must resolve Package Refs on a Package&bslash;n&quot;
)paren
)paren
suffix:semicolon
r_return
id|AE_ERROR
suffix:semicolon
)brace
r_for
c_loop
(paren
id|count
op_assign
l_int|0
suffix:semicolon
id|count
OL
id|obj_desc-&gt;package.count
suffix:semicolon
id|count
op_increment
)paren
(brace
id|sub_object
op_assign
id|obj_desc-&gt;package.elements
(braket
id|count
)braket
suffix:semicolon
r_if
c_cond
(paren
id|sub_object-&gt;common.type
op_eq
id|INTERNAL_TYPE_REFERENCE
)paren
(brace
r_if
c_cond
(paren
id|sub_object-&gt;reference.op_code
op_eq
id|AML_ZERO_OP
)paren
(brace
id|sub_object-&gt;common.type
op_assign
id|ACPI_TYPE_NUMBER
suffix:semicolon
id|sub_object-&gt;number.value
op_assign
l_int|0
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|sub_object-&gt;reference.op_code
op_eq
id|AML_ONE_OP
)paren
(brace
id|sub_object-&gt;common.type
op_assign
id|ACPI_TYPE_NUMBER
suffix:semicolon
id|sub_object-&gt;number.value
op_assign
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|sub_object-&gt;reference.op_code
op_eq
id|AML_ONES_OP
)paren
(brace
id|sub_object-&gt;common.type
op_assign
id|ACPI_TYPE_NUMBER
suffix:semicolon
id|sub_object-&gt;number.value
op_assign
id|ACPI_INTEGER_MAX
suffix:semicolon
)brace
)brace
)brace
r_return
id|AE_OK
suffix:semicolon
)brace
multiline_comment|/*******************************************************************************&n; *&n; * FUNCTION:    _Report_error&n; *&n; * PARAMETERS:  Module_name         - Caller&squot;s module name (for error output)&n; *              Line_number         - Caller&squot;s line number (for error output)&n; *              Component_id        - Caller&squot;s component ID (for error output)&n; *              Message             - Error message to use on failure&n; *&n; * RETURN:      None&n; *&n; * DESCRIPTION: Print error message from KD table&n; *&n; ******************************************************************************/
r_void
DECL|function|_report_error
id|_report_error
(paren
id|NATIVE_CHAR
op_star
id|module_name
comma
id|u32
id|line_number
comma
id|u32
id|component_id
)paren
(brace
id|acpi_os_printf
(paren
l_string|&quot;%8s-%04d: *** Error: &quot;
comma
id|module_name
comma
id|line_number
)paren
suffix:semicolon
)brace
multiline_comment|/*******************************************************************************&n; *&n; * FUNCTION:    _Report_warning&n; *&n; * PARAMETERS:  Module_name         - Caller&squot;s module name (for error output)&n; *              Line_number         - Caller&squot;s line number (for error output)&n; *              Component_id        - Caller&squot;s component ID (for error output)&n; *              Message             - Error message to use on failure&n; *&n; * RETURN:      None&n; *&n; * DESCRIPTION: Print warning message from KD table&n; *&n; ******************************************************************************/
r_void
DECL|function|_report_warning
id|_report_warning
(paren
id|NATIVE_CHAR
op_star
id|module_name
comma
id|u32
id|line_number
comma
id|u32
id|component_id
)paren
(brace
id|acpi_os_printf
(paren
l_string|&quot;%8s-%04d: *** Warning: &quot;
comma
id|module_name
comma
id|line_number
)paren
suffix:semicolon
)brace
multiline_comment|/*******************************************************************************&n; *&n; * FUNCTION:    _Report_info&n; *&n; * PARAMETERS:  Module_name         - Caller&squot;s module name (for error output)&n; *              Line_number         - Caller&squot;s line number (for error output)&n; *              Component_id        - Caller&squot;s component ID (for error output)&n; *              Message             - Error message to use on failure&n; *&n; * RETURN:      None&n; *&n; * DESCRIPTION: Print information message from KD table&n; *&n; ******************************************************************************/
r_void
DECL|function|_report_info
id|_report_info
(paren
id|NATIVE_CHAR
op_star
id|module_name
comma
id|u32
id|line_number
comma
id|u32
id|component_id
)paren
(brace
id|acpi_os_printf
(paren
l_string|&quot;%8s-%04d: *** Info: &quot;
comma
id|module_name
comma
id|line_number
)paren
suffix:semicolon
)brace
eof
