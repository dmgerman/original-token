multiline_comment|/*&n; * ni6510 (am7990 &squot;lance&squot; chip) driver for Linux-net-3 by MH&n; * Alphacode v0.33 (94/08/22) for 1.1.47 (or later)&n; *&n; * ----------------------------------------------------------&n; * WARNING: DOESN&squot;T WORK ON MACHINES WITH MORE THAN 16MB !!!!&n; * ----------------------------------------------------------&n; *&n; * copyright (c) 1994 M.Hipp&n; *&n; * This is an extension to the Linux operating system, and is covered by the&n; * same Gnu Public License that covers the Linux-kernel.&n; *&n; * comments/bugs/suggestions can be sent to:&n; *    Michael Hipp&n; *    email: mhipp@student.uni-tuebingen.de&n; *&n; * sources:&n; *  some things are from the &squot;ni6510-packet-driver for dos by Russ Nelson&squot;&n; *  and from the original drivers by D.Becker&n; */
multiline_comment|/*&n; * Aug.22: changes in xmit_intr (ack more than one xmitted-packet), ni65_send_packet (p-&gt;lock) (MH)&n; *&n; * July.16: fixed bugs in recv_skb and skb-alloc stuff  (MH)&n; */
multiline_comment|/*&n; * known BUGS: 16MB limit&n; */
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/ptrace.h&gt;
macro_line|#include &lt;linux/errno.h&gt;
macro_line|#include &lt;linux/ioport.h&gt;
macro_line|#include &lt;linux/malloc.h&gt;
macro_line|#include &lt;linux/interrupt.h&gt;
macro_line|#include &lt;asm/bitops.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;asm/dma.h&gt;
macro_line|#include &lt;linux/netdevice.h&gt;
macro_line|#include &lt;linux/etherdevice.h&gt;
macro_line|#include &lt;linux/skbuff.h&gt;
macro_line|#include &quot;ni65.h&quot;
multiline_comment|/************************************&n; * skeleton-stuff&n; */
macro_line|#ifndef HAVE_PORTRESERVE
DECL|macro|check_region
mdefine_line|#define check_region(ioaddr, size)              0
DECL|macro|request_region
mdefine_line|#define request_region(ioaddr, size,name)       do ; while (0)
macro_line|#endif
macro_line|#ifndef NET_DEBUG
DECL|macro|NET_DEBUG
mdefine_line|#define NET_DEBUG 2
macro_line|#endif
multiline_comment|/*&n;static unsigned int net_debug = NET_DEBUG;&n;*/
DECL|macro|NI65_TOTAL_SIZE
mdefine_line|#define NI65_TOTAL_SIZE    16
DECL|macro|SA_ADDR0
mdefine_line|#define SA_ADDR0 0x02
DECL|macro|SA_ADDR1
mdefine_line|#define SA_ADDR1 0x07
DECL|macro|SA_ADDR2
mdefine_line|#define SA_ADDR2 0x01
DECL|macro|CARD_ID0
mdefine_line|#define CARD_ID0 0x00
DECL|macro|CARD_ID1
mdefine_line|#define CARD_ID1 0x55
multiline_comment|/*****************************************/
DECL|macro|PORT
mdefine_line|#define PORT dev-&gt;base_addr
DECL|macro|RMDNUM
mdefine_line|#define RMDNUM 8
DECL|macro|RMDNUMMASK
mdefine_line|#define RMDNUMMASK 0x6000 /* log2(RMDNUM)&lt;&lt;13 */
DECL|macro|TMDNUM
mdefine_line|#define TMDNUM 4
DECL|macro|TMDNUMMASK
mdefine_line|#define TMDNUMMASK 0x4000 /* log2(TMDNUM)&lt;&lt;13 */
DECL|macro|R_BUF_SIZE
mdefine_line|#define R_BUF_SIZE 1518
DECL|macro|T_BUF_SIZE
mdefine_line|#define T_BUF_SIZE 1518
DECL|macro|MEMSIZE
mdefine_line|#define MEMSIZE 8+RMDNUM*8+TMDNUM*8
DECL|macro|L_DATAREG
mdefine_line|#define L_DATAREG 0x00
DECL|macro|L_ADDRREG
mdefine_line|#define L_ADDRREG 0x02
DECL|macro|L_RESET
mdefine_line|#define L_RESET   0x04
DECL|macro|L_CONFIG
mdefine_line|#define L_CONFIG  0x05
DECL|macro|L_EBASE
mdefine_line|#define L_EBASE   0x08
multiline_comment|/* &n; * to access the am7990-regs, you have to write&n; * reg-number into L_ADDRREG, then you can access it using L_DATAREG&n; */
DECL|macro|CSR0
mdefine_line|#define CSR0 0x00
DECL|macro|CSR1
mdefine_line|#define CSR1 0x01
DECL|macro|CSR2
mdefine_line|#define CSR2 0x02
DECL|macro|CSR3
mdefine_line|#define CSR3 0x03
multiline_comment|/* if you #define NO_STATIC the driver is faster but you will have (more) problems with &gt;16MB memory */
DECL|macro|NO_STATIC
macro_line|#undef NO_STATIC
DECL|macro|writereg
mdefine_line|#define writereg(val,reg) {outw(reg,PORT+L_ADDRREG);inw(PORT+L_ADDRREG); &bslash;&n;                           outw(val,PORT+L_DATAREG);inw(PORT+L_DATAREG);}
DECL|macro|readreg
mdefine_line|#define readreg(reg) (outw(reg,PORT+L_ADDRREG),inw(PORT+L_ADDRREG),&bslash;&n;                       inw(PORT+L_DATAREG))
DECL|macro|writedatareg
mdefine_line|#define writedatareg(val) {outw(val,PORT+L_DATAREG);inw(PORT+L_DATAREG);}
r_static
r_int
id|ni65_probe1
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_int
)paren
suffix:semicolon
r_static
r_void
id|ni65_interrupt
c_func
(paren
r_int
id|reg_ptr
)paren
suffix:semicolon
r_static
r_void
id|recv_intr
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
suffix:semicolon
r_static
r_void
id|xmit_intr
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
suffix:semicolon
r_static
r_int
id|ni65_open
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
suffix:semicolon
r_static
r_int
id|am7990_reinit
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
suffix:semicolon
r_static
r_int
id|ni65_send_packet
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|device
op_star
id|dev
)paren
suffix:semicolon
r_static
r_int
id|ni65_close
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
suffix:semicolon
r_static
r_struct
id|enet_statistics
op_star
id|ni65_get_stats
c_func
(paren
r_struct
id|device
op_star
)paren
suffix:semicolon
r_static
r_void
id|set_multicast_list
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_int
id|num_addrs
comma
r_void
op_star
id|addrs
)paren
suffix:semicolon
r_extern
r_void
op_star
id|irq2dev_map
(braket
l_int|16
)braket
suffix:semicolon
DECL|struct|priv
r_struct
id|priv
(brace
DECL|member|ib
r_struct
id|init_block
id|ib
suffix:semicolon
DECL|member|memptr
r_void
op_star
id|memptr
suffix:semicolon
DECL|member|rmdhead
r_struct
id|rmd
op_star
id|rmdhead
suffix:semicolon
DECL|member|tmdhead
r_struct
id|tmd
op_star
id|tmdhead
suffix:semicolon
DECL|member|rmdnum
r_int
id|rmdnum
suffix:semicolon
DECL|member|tmdnum
DECL|member|tmdlast
r_int
id|tmdnum
comma
id|tmdlast
suffix:semicolon
DECL|member|recv_skb
r_struct
id|sk_buff
op_star
id|recv_skb
(braket
id|RMDNUM
)braket
suffix:semicolon
DECL|member|tmdbufs
r_void
op_star
id|tmdbufs
(braket
id|TMDNUM
)braket
suffix:semicolon
DECL|member|lock
DECL|member|xmit_queued
r_int
id|lock
comma
id|xmit_queued
suffix:semicolon
DECL|member|stats
r_struct
id|enet_statistics
id|stats
suffix:semicolon
)brace
suffix:semicolon
DECL|variable|irqtab
r_int
id|irqtab
(braket
)braket
op_assign
(brace
l_int|9
comma
l_int|12
comma
l_int|15
comma
l_int|5
)brace
suffix:semicolon
multiline_comment|/* irq config-translate */
DECL|variable|dmatab
r_int
id|dmatab
(braket
)braket
op_assign
(brace
l_int|0
comma
l_int|3
comma
l_int|5
comma
l_int|6
)brace
suffix:semicolon
multiline_comment|/* dma config-translate */
multiline_comment|/*&n; * open (most done by init) &n; */
DECL|function|ni65_open
r_static
r_int
id|ni65_open
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
(brace
r_if
c_cond
(paren
id|am7990_reinit
c_func
(paren
id|dev
)paren
)paren
(brace
id|dev-&gt;tbusy
op_assign
l_int|0
suffix:semicolon
id|dev-&gt;interrupt
op_assign
l_int|0
suffix:semicolon
id|dev-&gt;start
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|dev-&gt;start
op_assign
l_int|0
suffix:semicolon
r_return
op_minus
id|EAGAIN
suffix:semicolon
)brace
)brace
DECL|function|ni65_close
r_static
r_int
id|ni65_close
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
(brace
id|outw
c_func
(paren
l_int|0
comma
id|PORT
op_plus
id|L_RESET
)paren
suffix:semicolon
multiline_comment|/* that&squot;s the hard way */
id|dev-&gt;tbusy
op_assign
l_int|1
suffix:semicolon
id|dev-&gt;start
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* &n; * Probe The Card (not the lance-chip) &n; * and set hardaddress&n; */
DECL|function|ni65_probe
r_int
id|ni65_probe
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
(brace
r_int
op_star
id|port
comma
id|ports
(braket
)braket
op_assign
(brace
l_int|0x300
comma
l_int|0x320
comma
l_int|0x340
comma
l_int|0x360
comma
l_int|0
)brace
suffix:semicolon
r_int
id|base_addr
op_assign
id|dev-&gt;base_addr
suffix:semicolon
r_if
c_cond
(paren
id|base_addr
OG
l_int|0x1ff
)paren
multiline_comment|/* Check a single specified location. */
r_return
id|ni65_probe1
c_func
(paren
id|dev
comma
id|base_addr
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|base_addr
OG
l_int|0
)paren
multiline_comment|/* Don&squot;t probe at all. */
r_return
id|ENXIO
suffix:semicolon
r_for
c_loop
(paren
id|port
op_assign
id|ports
suffix:semicolon
op_star
id|port
suffix:semicolon
id|port
op_increment
)paren
(brace
r_int
id|ioaddr
op_assign
op_star
id|port
suffix:semicolon
r_if
c_cond
(paren
id|check_region
c_func
(paren
id|ioaddr
comma
id|NI65_TOTAL_SIZE
)paren
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|inb
c_func
(paren
id|ioaddr
op_plus
id|L_EBASE
op_plus
l_int|6
)paren
op_eq
id|CARD_ID0
)paren
op_logical_or
op_logical_neg
(paren
id|inb
c_func
(paren
id|ioaddr
op_plus
id|L_EBASE
op_plus
l_int|7
)paren
op_eq
id|CARD_ID1
)paren
)paren
(brace
r_continue
suffix:semicolon
)brace
id|dev-&gt;base_addr
op_assign
id|ioaddr
suffix:semicolon
r_if
c_cond
(paren
id|ni65_probe1
c_func
(paren
id|dev
comma
id|ioaddr
)paren
op_eq
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
)brace
id|dev-&gt;base_addr
op_assign
id|base_addr
suffix:semicolon
r_return
id|ENODEV
suffix:semicolon
)brace
DECL|function|ni65_probe1
r_static
r_int
id|ni65_probe1
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_int
id|ioaddr
)paren
(brace
r_int
id|i
suffix:semicolon
r_int
r_char
id|station_addr
(braket
l_int|6
)braket
suffix:semicolon
r_struct
id|priv
op_star
id|p
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|6
suffix:semicolon
id|i
op_increment
)paren
(brace
id|station_addr
(braket
id|i
)braket
op_assign
id|dev-&gt;dev_addr
(braket
id|i
)braket
op_assign
id|inb
c_func
(paren
id|PORT
op_plus
id|L_EBASE
op_plus
id|i
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|station_addr
(braket
l_int|0
)braket
op_ne
id|SA_ADDR0
op_logical_or
id|station_addr
(braket
l_int|1
)braket
op_ne
id|SA_ADDR1
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: wrong Hardaddress &bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
r_return
id|ENODEV
suffix:semicolon
)brace
r_if
c_cond
(paren
id|dev-&gt;irq
op_eq
l_int|0
)paren
(brace
id|dev-&gt;irq
op_assign
id|irqtab
(braket
(paren
id|inw
c_func
(paren
id|PORT
op_plus
id|L_CONFIG
)paren
op_rshift
l_int|2
)paren
op_amp
l_int|3
)braket
suffix:semicolon
)brace
r_if
c_cond
(paren
id|dev-&gt;dma
op_eq
l_int|0
)paren
(brace
id|dev-&gt;dma
op_assign
id|dmatab
(braket
id|inw
c_func
(paren
id|PORT
op_plus
id|L_CONFIG
)paren
op_amp
l_int|3
)braket
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;%s: %s found at %#3x, IRQ %d DMA %d.&bslash;n&quot;
comma
id|dev-&gt;name
comma
l_string|&quot;network card&quot;
comma
id|dev-&gt;base_addr
comma
id|dev-&gt;irq
comma
id|dev-&gt;dma
)paren
suffix:semicolon
(brace
r_int
id|irqval
op_assign
id|request_irq
c_func
(paren
id|dev-&gt;irq
comma
op_amp
id|ni65_interrupt
comma
l_int|0
comma
l_string|&quot;ni65&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|irqval
)paren
(brace
id|printk
(paren
l_string|&quot;%s: unable to get IRQ %d (irqval=%d).&bslash;n&quot;
comma
id|dev-&gt;name
comma
id|dev-&gt;irq
comma
id|irqval
)paren
suffix:semicolon
r_return
id|EAGAIN
suffix:semicolon
)brace
r_if
c_cond
(paren
id|request_dma
c_func
(paren
id|dev-&gt;dma
comma
l_string|&quot;ni65&quot;
)paren
op_ne
l_int|0
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: Can&squot;t request dma-channel %d&bslash;n&quot;
comma
id|dev-&gt;name
comma
(paren
r_int
)paren
id|dev-&gt;dma
)paren
suffix:semicolon
id|free_irq
c_func
(paren
id|dev-&gt;irq
)paren
suffix:semicolon
r_return
id|EAGAIN
suffix:semicolon
)brace
)brace
id|irq2dev_map
(braket
id|dev-&gt;irq
)braket
op_assign
id|dev
suffix:semicolon
multiline_comment|/* Grab the region so we can find another board if autoIRQ fails. */
id|request_region
c_func
(paren
id|ioaddr
comma
id|NI65_TOTAL_SIZE
comma
l_string|&quot;ni65&quot;
)paren
suffix:semicolon
id|p
op_assign
id|dev-&gt;priv
op_assign
(paren
r_void
op_star
)paren
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|priv
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
id|memset
c_func
(paren
(paren
r_char
op_star
)paren
id|dev-&gt;priv
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|priv
)paren
)paren
suffix:semicolon
id|dev-&gt;open
op_assign
id|ni65_open
suffix:semicolon
id|dev-&gt;stop
op_assign
id|ni65_close
suffix:semicolon
id|dev-&gt;hard_start_xmit
op_assign
id|ni65_send_packet
suffix:semicolon
id|dev-&gt;get_stats
op_assign
id|ni65_get_stats
suffix:semicolon
id|dev-&gt;set_multicast_list
op_assign
id|set_multicast_list
suffix:semicolon
id|ether_setup
c_func
(paren
id|dev
)paren
suffix:semicolon
id|dev-&gt;interrupt
op_assign
l_int|0
suffix:semicolon
id|dev-&gt;tbusy
op_assign
l_int|0
suffix:semicolon
id|dev-&gt;start
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p-&gt;memptr
op_assign
id|kmalloc
c_func
(paren
id|MEMSIZE
comma
id|GFP_KERNEL
)paren
)paren
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: Can&squot;t alloc TMD/RMD-buffer.&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
r_return
id|EAGAIN
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
r_int
r_int
)paren
(paren
id|p-&gt;memptr
op_plus
id|MEMSIZE
)paren
op_amp
l_int|0xff000000
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: Can&squot;t alloc TMD/RMD buffer in lower 16MB!&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
r_return
id|EAGAIN
suffix:semicolon
)brace
id|p-&gt;tmdhead
op_assign
(paren
r_struct
id|tmd
op_star
)paren
(paren
(paren
(paren
(paren
r_int
r_int
)paren
id|p-&gt;memptr
)paren
op_plus
l_int|8
)paren
op_amp
l_int|0xfffffff8
)paren
suffix:semicolon
id|p-&gt;rmdhead
op_assign
(paren
r_struct
id|rmd
op_star
)paren
(paren
id|p-&gt;tmdhead
op_plus
id|TMDNUM
)paren
suffix:semicolon
macro_line|#ifndef NO_STATIC
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|TMDNUM
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|p-&gt;tmdbufs
(braket
id|i
)braket
op_assign
id|kmalloc
c_func
(paren
id|T_BUF_SIZE
comma
id|GFP_ATOMIC
)paren
)paren
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: Can&squot;t alloc Xmit-Mem.&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
r_return
id|EAGAIN
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
r_int
r_int
)paren
(paren
id|p-&gt;tmdbufs
(braket
id|i
)braket
op_plus
id|T_BUF_SIZE
)paren
op_amp
l_int|0xff000000
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: Can&squot;t alloc Xmit-Mem in lower 16MB!&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
r_return
id|EAGAIN
suffix:semicolon
)brace
)brace
macro_line|#endif
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|RMDNUM
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|p-&gt;recv_skb
(braket
id|i
)braket
op_assign
(paren
r_struct
id|sk_buff
op_star
)paren
id|alloc_skb
c_func
(paren
id|R_BUF_SIZE
comma
id|GFP_ATOMIC
)paren
)paren
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: unable to alloc recv-mem&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
r_return
id|EAGAIN
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
r_int
r_int
)paren
(paren
id|p-&gt;recv_skb
(braket
id|i
)braket
op_member_access_from_pointer
id|data
op_plus
id|R_BUF_SIZE
)paren
op_amp
l_int|0xff000000
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: unable to alloc receive-memory in lower 16MB!&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
r_return
id|EAGAIN
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
multiline_comment|/* we&squot;ve found everything */
)brace
multiline_comment|/* &n; * init lance (write init-values .. init-buffers) (open-helper)&n; */
DECL|function|am7990_reinit
r_static
r_int
id|am7990_reinit
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
(brace
r_int
id|i
comma
id|j
suffix:semicolon
r_struct
id|tmd
op_star
id|tmdp
suffix:semicolon
r_struct
id|rmd
op_star
id|rmdp
suffix:semicolon
r_struct
id|priv
op_star
id|p
op_assign
(paren
r_struct
id|priv
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
id|p-&gt;lock
op_assign
l_int|0
suffix:semicolon
id|p-&gt;xmit_queued
op_assign
l_int|0
suffix:semicolon
id|disable_dma
c_func
(paren
id|dev-&gt;dma
)paren
suffix:semicolon
multiline_comment|/* I&squot;ve never worked with dma, but we do it like the packetdriver */
id|set_dma_mode
c_func
(paren
id|dev-&gt;dma
comma
id|DMA_MODE_CASCADE
)paren
suffix:semicolon
id|enable_dma
c_func
(paren
id|dev-&gt;dma
)paren
suffix:semicolon
id|outw
c_func
(paren
l_int|0
comma
id|PORT
op_plus
id|L_RESET
)paren
suffix:semicolon
multiline_comment|/* first: reset the card */
r_if
c_cond
(paren
id|inw
c_func
(paren
id|PORT
op_plus
id|L_DATAREG
)paren
op_ne
l_int|0x4
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: can&squot;t RESET ni6510 card: %04x&bslash;n&quot;
comma
id|dev-&gt;name
comma
(paren
r_int
)paren
id|inw
c_func
(paren
id|PORT
op_plus
id|L_DATAREG
)paren
)paren
suffix:semicolon
id|disable_dma
c_func
(paren
id|dev-&gt;dma
)paren
suffix:semicolon
id|free_dma
c_func
(paren
id|dev-&gt;dma
)paren
suffix:semicolon
id|free_irq
c_func
(paren
id|dev-&gt;irq
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* here: memset all buffs to zero */
id|memset
c_func
(paren
id|p-&gt;memptr
comma
l_int|0
comma
id|MEMSIZE
)paren
suffix:semicolon
id|p-&gt;tmdnum
op_assign
l_int|0
suffix:semicolon
id|p-&gt;tmdlast
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|TMDNUM
suffix:semicolon
id|i
op_increment
)paren
(brace
id|tmdp
op_assign
id|p-&gt;tmdhead
op_plus
id|i
suffix:semicolon
macro_line|#ifndef NO_STATIC
id|tmdp-&gt;u.buffer
op_assign
(paren
r_int
r_int
)paren
id|p-&gt;tmdbufs
(braket
id|i
)braket
suffix:semicolon
macro_line|#endif
id|tmdp-&gt;u.s.status
op_assign
id|XMIT_START
op_or
id|XMIT_END
suffix:semicolon
)brace
id|p-&gt;rmdnum
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|RMDNUM
suffix:semicolon
id|i
op_increment
)paren
(brace
id|rmdp
op_assign
id|p-&gt;rmdhead
op_plus
id|i
suffix:semicolon
id|rmdp-&gt;u.buffer
op_assign
(paren
r_int
r_int
)paren
id|p-&gt;recv_skb
(braket
id|i
)braket
op_member_access_from_pointer
id|data
suffix:semicolon
id|rmdp-&gt;u.s.status
op_assign
id|RCV_OWN
suffix:semicolon
id|rmdp-&gt;blen
op_assign
op_minus
id|R_BUF_SIZE
suffix:semicolon
id|rmdp-&gt;mlen
op_assign
l_int|0
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|6
suffix:semicolon
id|i
op_increment
)paren
(brace
id|p-&gt;ib.eaddr
(braket
id|i
)braket
op_assign
id|dev-&gt;dev_addr
(braket
id|i
)braket
suffix:semicolon
)brace
id|p-&gt;ib.mode
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|8
suffix:semicolon
id|i
op_increment
)paren
(brace
id|p-&gt;ib.filter
(braket
id|i
)braket
op_assign
l_int|0
suffix:semicolon
)brace
id|p-&gt;ib.trplow
op_assign
(paren
r_int
r_int
)paren
(paren
(paren
(paren
r_int
r_int
)paren
id|p-&gt;tmdhead
)paren
op_amp
l_int|0xffff
)paren
suffix:semicolon
id|p-&gt;ib.trphigh
op_assign
(paren
r_int
r_int
)paren
(paren
(paren
(paren
(paren
r_int
r_int
)paren
id|p-&gt;tmdhead
)paren
op_rshift
l_int|16
)paren
op_amp
l_int|0x00ff
)paren
op_or
id|TMDNUMMASK
suffix:semicolon
id|p-&gt;ib.rrplow
op_assign
(paren
r_int
r_int
)paren
(paren
(paren
(paren
r_int
r_int
)paren
id|p-&gt;rmdhead
)paren
op_amp
l_int|0xffff
)paren
suffix:semicolon
id|p-&gt;ib.rrphigh
op_assign
(paren
r_int
r_int
)paren
(paren
(paren
(paren
(paren
r_int
r_int
)paren
id|p-&gt;rmdhead
)paren
op_rshift
l_int|16
)paren
op_amp
l_int|0x00ff
)paren
op_or
id|RMDNUMMASK
suffix:semicolon
id|writereg
c_func
(paren
l_int|0
comma
id|CSR3
)paren
suffix:semicolon
multiline_comment|/* busmaster/no word-swap */
id|writereg
c_func
(paren
(paren
r_int
r_int
)paren
(paren
(paren
(paren
r_int
r_int
)paren
op_amp
(paren
id|p-&gt;ib
)paren
)paren
op_amp
l_int|0xffff
)paren
comma
id|CSR1
)paren
suffix:semicolon
id|writereg
c_func
(paren
(paren
r_int
r_int
)paren
(paren
(paren
(paren
r_int
r_int
)paren
op_amp
(paren
id|p-&gt;ib
)paren
)paren
op_rshift
l_int|16
)paren
comma
id|CSR2
)paren
suffix:semicolon
id|writereg
c_func
(paren
id|CSR0_INIT
comma
id|CSR0
)paren
suffix:semicolon
multiline_comment|/* this changes L_ADDRREG to CSR0 */
multiline_comment|/*&n;   * NOW, WE NEVER WILL CHANGE THE L_ADDRREG, CSR0 IS ALWAYS SELECTED &n;   */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|5
suffix:semicolon
id|i
op_increment
)paren
(brace
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
l_int|2000000
suffix:semicolon
id|j
op_increment
)paren
(brace
suffix:semicolon
)brace
multiline_comment|/* wait a while */
r_if
c_cond
(paren
id|inw
c_func
(paren
id|PORT
op_plus
id|L_DATAREG
)paren
op_amp
id|CSR0_IDON
)paren
(brace
r_break
suffix:semicolon
)brace
multiline_comment|/* init ok ? */
)brace
r_if
c_cond
(paren
id|i
op_eq
l_int|5
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: can&squot;t init am7990, status: %04x&bslash;n&quot;
comma
id|dev-&gt;name
comma
(paren
r_int
)paren
id|inw
c_func
(paren
id|PORT
op_plus
id|L_DATAREG
)paren
)paren
suffix:semicolon
id|disable_dma
c_func
(paren
id|dev-&gt;dma
)paren
suffix:semicolon
id|free_dma
c_func
(paren
id|dev-&gt;dma
)paren
suffix:semicolon
id|free_irq
c_func
(paren
id|dev-&gt;irq
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
multiline_comment|/* false */
)brace
id|writedatareg
c_func
(paren
id|CSR0_CLRALL
op_or
id|CSR0_INEA
op_or
id|CSR0_STRT
)paren
suffix:semicolon
multiline_comment|/* start lance , enable interrupts */
r_return
l_int|1
suffix:semicolon
multiline_comment|/* OK */
)brace
multiline_comment|/* &n; * interrupt handler  &n; */
DECL|function|ni65_interrupt
r_static
r_void
id|ni65_interrupt
c_func
(paren
r_int
id|reg_ptr
)paren
(brace
r_int
id|irq
op_assign
op_minus
(paren
(paren
(paren
r_struct
id|pt_regs
op_star
)paren
id|reg_ptr
)paren
op_member_access_from_pointer
id|orig_eax
op_plus
l_int|2
)paren
suffix:semicolon
r_int
id|csr0
suffix:semicolon
r_struct
id|device
op_star
id|dev
op_assign
(paren
r_struct
id|device
op_star
)paren
id|irq2dev_map
(braket
id|irq
)braket
suffix:semicolon
r_if
c_cond
(paren
id|dev
op_eq
l_int|NULL
)paren
(brace
id|printk
(paren
l_string|&quot;net_interrupt(): irq %d for unknown device.&bslash;n&quot;
comma
id|irq
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|csr0
op_assign
id|inw
c_func
(paren
id|PORT
op_plus
id|L_DATAREG
)paren
suffix:semicolon
id|writedatareg
c_func
(paren
id|csr0
op_amp
id|CSR0_CLRALL
)paren
suffix:semicolon
multiline_comment|/* ack interrupts, disable int. */
id|dev-&gt;interrupt
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|csr0
op_amp
id|CSR0_ERR
)paren
(brace
r_struct
id|priv
op_star
id|p
op_assign
(paren
r_struct
id|priv
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_if
c_cond
(paren
id|csr0
op_amp
id|CSR0_BABL
)paren
(brace
id|p-&gt;stats.tx_errors
op_increment
suffix:semicolon
)brace
r_if
c_cond
(paren
id|csr0
op_amp
id|CSR0_MISS
)paren
(brace
id|p-&gt;stats.rx_errors
op_increment
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|csr0
op_amp
id|CSR0_RINT
)paren
multiline_comment|/* RECV-int? */
(brace
id|recv_intr
c_func
(paren
id|dev
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|csr0
op_amp
id|CSR0_TINT
)paren
multiline_comment|/* XMIT-int? */
(brace
id|xmit_intr
c_func
(paren
id|dev
)paren
suffix:semicolon
)brace
id|writedatareg
c_func
(paren
id|CSR0_INEA
)paren
suffix:semicolon
multiline_comment|/* reenable inter. */
id|dev-&gt;interrupt
op_assign
l_int|0
suffix:semicolon
r_return
suffix:semicolon
)brace
multiline_comment|/*&n; * We have received an Xmit-Interrupt ..&n; * send a new packet if necessary&n; */
DECL|function|xmit_intr
r_static
r_void
id|xmit_intr
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
(brace
r_int
id|tmdstat
suffix:semicolon
r_struct
id|tmd
op_star
id|tmdp
suffix:semicolon
r_struct
id|priv
op_star
id|p
op_assign
(paren
r_struct
id|priv
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
macro_line|#ifdef NO_STATIC
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
macro_line|#endif
r_while
c_loop
(paren
id|p-&gt;xmit_queued
)paren
(brace
id|tmdp
op_assign
id|p-&gt;tmdhead
op_plus
id|p-&gt;tmdlast
suffix:semicolon
id|tmdstat
op_assign
id|tmdp-&gt;u.s.status
suffix:semicolon
r_if
c_cond
(paren
id|tmdstat
op_amp
id|XMIT_OWN
)paren
(brace
r_break
suffix:semicolon
)brace
macro_line|#ifdef NO_STATIC
id|skb
op_assign
(paren
r_struct
id|sk_buff
op_star
)paren
id|p-&gt;tmdbufs
(braket
id|p-&gt;tmdlast
)braket
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
comma
id|FREE_WRITE
)paren
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
id|tmdstat
op_amp
id|XMIT_ERR
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: xmit-error: %04x %04x&bslash;n&quot;
comma
id|dev-&gt;name
comma
(paren
r_int
)paren
id|tmdstat
comma
(paren
r_int
)paren
id|tmdp-&gt;status2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tmdp-&gt;status2
op_amp
id|XMIT_TDRMASK
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: tdr-problems (e.g. no resistor)&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
)brace
multiline_comment|/* checking some errors */
r_if
c_cond
(paren
id|tmdp-&gt;status2
op_amp
id|XMIT_RTRY
)paren
(brace
id|p-&gt;stats.tx_aborted_errors
op_increment
suffix:semicolon
)brace
r_if
c_cond
(paren
id|tmdp-&gt;status2
op_amp
id|XMIT_LCAR
)paren
(brace
id|p-&gt;stats.tx_carrier_errors
op_increment
suffix:semicolon
)brace
id|p-&gt;stats.tx_errors
op_increment
suffix:semicolon
id|tmdp-&gt;status2
op_assign
l_int|0
suffix:semicolon
)brace
r_else
id|p-&gt;stats.tx_packets
op_increment
suffix:semicolon
id|p-&gt;tmdlast
op_assign
(paren
id|p-&gt;tmdlast
op_plus
l_int|1
)paren
op_amp
(paren
id|TMDNUM
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|p-&gt;tmdlast
op_eq
id|p-&gt;tmdnum
)paren
(brace
id|p-&gt;xmit_queued
op_assign
l_int|0
suffix:semicolon
)brace
)brace
id|dev-&gt;tbusy
op_assign
l_int|0
suffix:semicolon
id|mark_bh
c_func
(paren
id|NET_BH
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * We have received a packet&n; */
DECL|function|recv_intr
r_static
r_void
id|recv_intr
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
(brace
r_struct
id|rmd
op_star
id|rmdp
suffix:semicolon
r_int
id|rmdstat
comma
id|len
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
comma
op_star
id|skb1
suffix:semicolon
r_struct
id|priv
op_star
id|p
op_assign
(paren
r_struct
id|priv
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
id|rmdp
op_assign
id|p-&gt;rmdhead
op_plus
id|p-&gt;rmdnum
suffix:semicolon
r_while
c_loop
(paren
op_logical_neg
(paren
(paren
id|rmdstat
op_assign
id|rmdp-&gt;u.s.status
)paren
op_amp
id|RCV_OWN
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
id|rmdstat
op_amp
(paren
id|RCV_START
op_or
id|RCV_END
)paren
)paren
op_ne
(paren
id|RCV_START
op_or
id|RCV_END
)paren
)paren
multiline_comment|/* is packet start &amp; end? */
(brace
r_if
c_cond
(paren
id|rmdstat
op_amp
id|RCV_START
)paren
(brace
id|p-&gt;stats.rx_errors
op_increment
suffix:semicolon
id|p-&gt;stats.rx_length_errors
op_increment
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s: packet too long&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
)brace
id|rmdp-&gt;u.s.status
op_assign
id|RCV_OWN
suffix:semicolon
multiline_comment|/* change owner */
)brace
r_else
r_if
c_cond
(paren
id|rmdstat
op_amp
id|RCV_ERR
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: receive-error: %04x&bslash;n&quot;
comma
id|dev-&gt;name
comma
(paren
r_int
)paren
id|rmdstat
)paren
suffix:semicolon
id|p-&gt;stats.rx_errors
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|rmdstat
op_amp
id|RCV_FRAM
)paren
(brace
id|p-&gt;stats.rx_frame_errors
op_increment
suffix:semicolon
)brace
r_if
c_cond
(paren
id|rmdstat
op_amp
id|RCV_OFLO
)paren
(brace
id|p-&gt;stats.rx_over_errors
op_increment
suffix:semicolon
)brace
r_if
c_cond
(paren
id|rmdstat
op_amp
id|RCV_CRC
)paren
(brace
id|p-&gt;stats.rx_crc_errors
op_increment
suffix:semicolon
)brace
id|rmdp-&gt;u.s.status
op_assign
id|RCV_OWN
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s: lance-status: %04x&bslash;n&quot;
comma
id|dev-&gt;name
comma
(paren
r_int
)paren
id|inw
c_func
(paren
id|PORT
op_plus
id|L_DATAREG
)paren
)paren
suffix:semicolon
)brace
r_else
(brace
id|len
op_assign
(paren
id|rmdp-&gt;mlen
op_amp
l_int|0x0fff
)paren
op_minus
l_int|4
suffix:semicolon
multiline_comment|/* -4: ignore FCS */
id|skb
op_assign
id|alloc_skb
c_func
(paren
id|R_BUF_SIZE
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb
op_ne
l_int|NULL
)paren
(brace
r_if
c_cond
(paren
(paren
r_int
r_int
)paren
(paren
id|skb-&gt;data
op_plus
id|R_BUF_SIZE
)paren
op_amp
l_int|0xff000000
)paren
(brace
id|memcpy
c_func
(paren
id|skb-&gt;data
comma
id|p-&gt;recv_skb
(braket
id|p-&gt;rmdnum
)braket
op_member_access_from_pointer
id|data
comma
id|len
)paren
suffix:semicolon
id|skb1
op_assign
id|skb
suffix:semicolon
)brace
r_else
(brace
id|skb1
op_assign
id|p-&gt;recv_skb
(braket
id|p-&gt;rmdnum
)braket
suffix:semicolon
id|p-&gt;recv_skb
(braket
id|p-&gt;rmdnum
)braket
op_assign
id|skb
suffix:semicolon
id|rmdp-&gt;u.buffer
op_assign
(paren
r_int
r_int
)paren
(paren
id|skb-&gt;data
)paren
suffix:semicolon
)brace
id|rmdp-&gt;u.s.status
op_assign
id|RCV_OWN
suffix:semicolon
id|rmdp-&gt;mlen
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* not necc ???? */
id|skb1-&gt;len
op_assign
id|len
suffix:semicolon
id|skb1-&gt;dev
op_assign
id|dev
suffix:semicolon
id|p-&gt;stats.rx_packets
op_increment
suffix:semicolon
id|netif_rx
c_func
(paren
id|skb1
)paren
suffix:semicolon
)brace
r_else
(brace
id|rmdp-&gt;u.s.status
op_assign
id|RCV_OWN
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s: can&squot;t alloc new sk_buff&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
id|p-&gt;stats.rx_dropped
op_increment
suffix:semicolon
)brace
)brace
id|p-&gt;rmdnum
op_increment
suffix:semicolon
id|p-&gt;rmdnum
op_and_assign
id|RMDNUM
op_minus
l_int|1
suffix:semicolon
id|rmdp
op_assign
id|p-&gt;rmdhead
op_plus
id|p-&gt;rmdnum
suffix:semicolon
)brace
)brace
multiline_comment|/*&n; * kick xmitter ..&n; */
DECL|function|ni65_send_packet
r_static
r_int
id|ni65_send_packet
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|device
op_star
id|dev
)paren
(brace
r_struct
id|priv
op_star
id|p
op_assign
(paren
r_struct
id|priv
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_struct
id|tmd
op_star
id|tmdp
suffix:semicolon
r_if
c_cond
(paren
id|dev-&gt;tbusy
)paren
(brace
r_int
id|tickssofar
op_assign
id|jiffies
op_minus
id|dev-&gt;trans_start
suffix:semicolon
r_if
c_cond
(paren
id|tickssofar
OL
l_int|25
)paren
r_return
l_int|1
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s: xmitter timed out, try to restart!&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
id|am7990_reinit
c_func
(paren
id|dev
)paren
suffix:semicolon
id|dev-&gt;tbusy
op_assign
l_int|0
suffix:semicolon
id|dev-&gt;trans_start
op_assign
id|jiffies
suffix:semicolon
)brace
r_if
c_cond
(paren
id|skb
op_eq
l_int|NULL
)paren
(brace
id|dev_tint
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|skb-&gt;len
op_le
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|set_bit
c_func
(paren
l_int|0
comma
(paren
r_void
op_star
)paren
op_amp
id|dev-&gt;tbusy
)paren
op_ne
l_int|0
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: Transmitter access conflict.&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|set_bit
c_func
(paren
l_int|0
comma
(paren
r_void
op_star
)paren
op_amp
id|p-&gt;lock
)paren
op_ne
l_int|0
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: Queue was locked!&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
(brace
r_int
id|len
op_assign
id|ETH_ZLEN
OL
id|skb-&gt;len
ques
c_cond
id|skb-&gt;len
suffix:colon
id|ETH_ZLEN
suffix:semicolon
id|tmdp
op_assign
id|p-&gt;tmdhead
op_plus
id|p-&gt;tmdnum
suffix:semicolon
macro_line|#ifdef NO_STATIC
id|tmdp-&gt;u.buffer
op_assign
(paren
r_int
r_int
)paren
(paren
id|skb-&gt;data
)paren
suffix:semicolon
id|p-&gt;tmdbufs
(braket
id|p-&gt;tmdnum
)braket
op_assign
id|skb
suffix:semicolon
macro_line|#else
id|memcpy
c_func
(paren
(paren
r_char
op_star
)paren
(paren
id|tmdp-&gt;u.buffer
op_amp
l_int|0x00ffffff
)paren
comma
(paren
r_char
op_star
)paren
id|skb-&gt;data
comma
id|skb-&gt;len
)paren
suffix:semicolon
id|dev_kfree_skb
(paren
id|skb
comma
id|FREE_WRITE
)paren
suffix:semicolon
macro_line|#endif
id|tmdp-&gt;blen
op_assign
op_minus
id|len
suffix:semicolon
id|tmdp-&gt;u.s.status
op_assign
id|XMIT_OWN
op_or
id|XMIT_START
op_or
id|XMIT_END
suffix:semicolon
id|cli
c_func
(paren
)paren
suffix:semicolon
id|p-&gt;xmit_queued
op_assign
l_int|1
suffix:semicolon
id|writedatareg
c_func
(paren
id|CSR0_TDMD
op_or
id|CSR0_INEA
)paren
suffix:semicolon
multiline_comment|/* enable xmit &amp; interrupt */
id|p-&gt;tmdnum
op_increment
suffix:semicolon
id|p-&gt;tmdnum
op_and_assign
id|TMDNUM
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
(paren
id|p-&gt;tmdhead
op_plus
id|p-&gt;tmdnum
)paren
op_member_access_from_pointer
id|u.s.status
op_amp
id|XMIT_OWN
)paren
)paren
(brace
id|dev-&gt;tbusy
op_assign
l_int|0
suffix:semicolon
)brace
id|p-&gt;lock
op_assign
l_int|0
suffix:semicolon
id|sti
c_func
(paren
)paren
suffix:semicolon
id|dev-&gt;trans_start
op_assign
id|jiffies
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|ni65_get_stats
r_static
r_struct
id|enet_statistics
op_star
id|ni65_get_stats
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
(brace
r_return
op_amp
(paren
(paren
r_struct
id|priv
op_star
)paren
id|dev-&gt;priv
)paren
op_member_access_from_pointer
id|stats
suffix:semicolon
)brace
DECL|function|set_multicast_list
r_static
r_void
id|set_multicast_list
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_int
id|num_addrs
comma
r_void
op_star
id|addrs
)paren
(brace
)brace
multiline_comment|/*&n; * END of ni65.c &n; */
eof
