multiline_comment|/*&n; *  Copyright (C) 1997 Cullen Jennings&n; *  Copyright (C) 1998 Elmer Joandiu, elmer@ylenurme.ee&n; *  Gnu Public License applies&n; * This module provides support for the Arlan 655 card made by Aironet&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &quot;arlan.h&quot;
DECL|variable|arlan_version
r_static
r_const
r_char
op_star
id|arlan_version
op_assign
l_string|&quot;C.Jennigs 97 &amp; Elmer.Joandi@ut.ee  Oct&squot;98, http://www.ylenurme.ee/~elmer/655/&quot;
suffix:semicolon
DECL|variable|arlan_device
r_struct
id|net_device
op_star
id|arlan_device
(braket
id|MAX_ARLANS
)braket
suffix:semicolon
DECL|variable|last_arlan
r_int
id|last_arlan
suffix:semicolon
DECL|variable|SID
r_static
r_int
id|SID
op_assign
id|SIDUNKNOWN
suffix:semicolon
DECL|variable|radioNodeId
r_static
r_int
id|radioNodeId
op_assign
id|radioNodeIdUNKNOWN
suffix:semicolon
DECL|variable|encryptionKey
r_static
r_char
id|encryptionKey
(braket
l_int|12
)braket
op_assign
(brace
l_char|&squot;a&squot;
comma
l_char|&squot;b&squot;
comma
l_char|&squot;c&squot;
comma
l_char|&squot;d&squot;
comma
l_char|&squot;e&squot;
comma
l_char|&squot;f&squot;
comma
l_char|&squot;g&squot;
comma
l_char|&squot;h&squot;
)brace
suffix:semicolon
DECL|variable|siteName
r_static
r_char
op_star
id|siteName
op_assign
id|siteNameUNKNOWN
suffix:semicolon
DECL|variable|mem
r_static
r_int
id|mem
op_assign
id|memUNKNOWN
suffix:semicolon
DECL|variable|arlan_debug
r_int
id|arlan_debug
op_assign
id|debugUNKNOWN
suffix:semicolon
DECL|variable|probe
r_static
r_int
id|probe
op_assign
id|probeUNKNOWN
suffix:semicolon
DECL|variable|numDevices
r_static
r_int
id|numDevices
op_assign
id|numDevicesUNKNOWN
suffix:semicolon
DECL|variable|spreadingCode
r_static
r_int
id|spreadingCode
op_assign
id|spreadingCodeUNKNOWN
suffix:semicolon
DECL|variable|channelNumber
r_static
r_int
id|channelNumber
op_assign
id|channelNumberUNKNOWN
suffix:semicolon
DECL|variable|channelSet
r_static
r_int
id|channelSet
op_assign
id|channelSetUNKNOWN
suffix:semicolon
DECL|variable|systemId
r_static
r_int
id|systemId
op_assign
id|systemIdUNKNOWN
suffix:semicolon
DECL|variable|registrationMode
r_static
r_int
id|registrationMode
op_assign
id|registrationModeUNKNOWN
suffix:semicolon
DECL|variable|keyStart
r_static
r_int
id|keyStart
suffix:semicolon
DECL|variable|tx_delay_ms
r_static
r_int
id|tx_delay_ms
suffix:semicolon
DECL|variable|retries
r_static
r_int
id|retries
op_assign
l_int|5
suffix:semicolon
DECL|variable|async
r_static
r_int
id|async
op_assign
l_int|1
suffix:semicolon
DECL|variable|tx_queue_len
r_static
r_int
id|tx_queue_len
op_assign
l_int|1
suffix:semicolon
DECL|variable|arlan_EEPROM_bad
r_static
r_int
id|arlan_EEPROM_bad
suffix:semicolon
DECL|variable|arlan_entry_and_exit_debug
r_int
id|arlan_entry_and_exit_debug
suffix:semicolon
macro_line|#ifdef ARLAN_DEBUGING
DECL|variable|arlan_entry_debug
r_static
r_int
id|arlan_entry_debug
suffix:semicolon
DECL|variable|arlan_exit_debug
r_static
r_int
id|arlan_exit_debug
suffix:semicolon
DECL|variable|testMemory
r_static
r_int
id|testMemory
op_assign
id|testMemoryUNKNOWN
suffix:semicolon
DECL|variable|irq
r_static
r_int
id|irq
op_assign
id|irqUNKNOWN
suffix:semicolon
DECL|variable|txScrambled
r_static
r_int
id|txScrambled
op_assign
l_int|1
suffix:semicolon
DECL|variable|mdebug
r_static
r_int
id|mdebug
suffix:semicolon
macro_line|#endif
macro_line|#if LINUX_VERSION_CODE &gt; 0x20100
id|MODULE_PARM
c_func
(paren
id|irq
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|mem
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|probe
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|arlan_debug
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|numDevices
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|testMemory
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|spreadingCode
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|channelNumber
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|channelSet
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|systemId
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|registrationMode
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|radioNodeId
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|SID
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|txScrambled
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|keyStart
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|mdebug
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|tx_delay_ms
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|retries
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|async
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|tx_queue_len
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|arlan_entry_debug
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|arlan_exit_debug
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|arlan_entry_and_exit_debug
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|arlan_EEPROM_bad
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
DECL|variable|arlan_device
id|EXPORT_SYMBOL
c_func
(paren
id|arlan_device
)paren
suffix:semicolon
DECL|variable|last_arlan
id|EXPORT_SYMBOL
c_func
(paren
id|last_arlan
)paren
suffix:semicolon
singleline_comment|//        #warning kernel 2.1.110 tested
DECL|macro|myATOMIC_INIT
mdefine_line|#define myATOMIC_INIT(a,b) atomic_set(&amp;(a),b)
macro_line|#else
DECL|macro|test_and_set_bit
mdefine_line|#define test_and_set_bit&t;set_bit
macro_line|#if LINUX_VERSION_CODE != 0x20024
singleline_comment|//        #warning kernel  2.0.36  tested
macro_line|#endif
DECL|macro|myATOMIC_INIT
mdefine_line|#define myATOMIC_INIT(a,b) a = b;
macro_line|#endif
DECL|variable|arlan_conf
r_struct
id|arlan_conf_stru
id|arlan_conf
(braket
id|MAX_ARLANS
)braket
suffix:semicolon
DECL|variable|arlans_found
r_int
id|arlans_found
suffix:semicolon
r_static
r_int
id|arlan_probe_here
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_int
id|ioaddr
)paren
suffix:semicolon
r_static
r_int
id|arlan_open
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
suffix:semicolon
r_static
r_int
id|arlan_tx
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|net_device
op_star
id|dev
)paren
suffix:semicolon
r_static
r_void
id|arlan_interrupt
c_func
(paren
r_int
id|irq
comma
r_void
op_star
id|dev_id
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
suffix:semicolon
r_static
r_int
id|arlan_close
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
suffix:semicolon
r_static
r_struct
id|net_device_stats
op_star
id|arlan_statistics
(paren
r_struct
id|net_device
op_star
id|dev
)paren
suffix:semicolon
r_static
r_void
id|arlan_set_multicast
(paren
r_struct
id|net_device
op_star
id|dev
)paren
suffix:semicolon
r_static
r_int
id|arlan_hw_tx
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_char
op_star
id|buf
comma
r_int
id|length
)paren
suffix:semicolon
r_static
r_int
id|arlan_hw_config
(paren
r_struct
id|net_device
op_star
id|dev
)paren
suffix:semicolon
r_static
r_void
id|arlan_tx_done_interrupt
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_int
id|status
)paren
suffix:semicolon
r_static
r_void
id|arlan_rx_interrupt
(paren
r_struct
id|net_device
op_star
id|dev
comma
id|u_char
id|rxStatus
comma
id|u_short
comma
id|u_short
)paren
suffix:semicolon
r_static
r_void
id|arlan_process_interrupt
(paren
r_struct
id|net_device
op_star
id|dev
)paren
suffix:semicolon
r_static
r_void
id|arlan_tx_timeout
(paren
r_struct
id|net_device
op_star
id|dev
)paren
suffix:semicolon
r_int
id|arlan_command
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_int
id|command
)paren
suffix:semicolon
DECL|variable|arlan_command
id|EXPORT_SYMBOL
c_func
(paren
id|arlan_command
)paren
suffix:semicolon
DECL|function|arlan_time
r_extern
r_inline
r_int
r_int
id|arlan_time
c_func
(paren
r_void
)paren
(brace
r_struct
id|timeval
id|timev
suffix:semicolon
id|do_gettimeofday
c_func
(paren
op_amp
id|timev
)paren
suffix:semicolon
r_return
(paren
(paren
r_int
r_int
)paren
id|timev.tv_sec
op_star
l_int|1000000
op_plus
id|timev.tv_usec
)paren
suffix:semicolon
)brace
suffix:semicolon
macro_line|#ifdef ARLAN_ENTRY_EXIT_DEBUGING
DECL|macro|ARLAN_DEBUG_ENTRY
mdefine_line|#define ARLAN_DEBUG_ENTRY(name) &bslash;&n;&t;{&bslash;&n;&t;struct timeval timev;&bslash;&n;&t;do_gettimeofday(&amp;timev);&bslash;&n;&t;&t;if (arlan_entry_debug || arlan_entry_and_exit_debug)&bslash;&n;&t;&t;&t;printk(&quot;---&gt;&gt;&gt;&quot; name &quot; %ld &quot; &quot;&bslash;n&quot;,((long int) timev.tv_sec * 1000000 + timev.tv_usec));&bslash;&n;&t;}
DECL|macro|ARLAN_DEBUG_EXIT
mdefine_line|#define ARLAN_DEBUG_EXIT(name) &bslash;&n;&t;{&bslash;&n;&t;struct timeval timev;&bslash;&n;&t;do_gettimeofday(&amp;timev);&bslash;&n;&t;&t;if (arlan_exit_debug || arlan_entry_and_exit_debug)&bslash;&n;&t;&t;&t;printk(&quot;&lt;&lt;&lt;---&quot; name &quot; %ld &quot; &quot;&bslash;n&quot;,((long int) timev.tv_sec * 1000000 + timev.tv_usec) );&bslash;&n;&t;}
macro_line|#else
DECL|macro|ARLAN_DEBUG_ENTRY
mdefine_line|#define ARLAN_DEBUG_ENTRY(name)
DECL|macro|ARLAN_DEBUG_EXIT
mdefine_line|#define ARLAN_DEBUG_EXIT(name)
macro_line|#endif
DECL|macro|arlan_interrupt_ack
mdefine_line|#define arlan_interrupt_ack(dev)&bslash;&n;        clearClearInterrupt(dev);&bslash;&n;        setClearInterrupt(dev);
DECL|macro|ARLAN_COMMAND_LOCK
mdefine_line|#define ARLAN_COMMAND_LOCK(dev) &bslash;&n;&t;if (atomic_dec_and_test(&amp;((struct arlan_private * )dev-&gt;priv)-&gt;card_users))&bslash;&n;   &t;&t;arlan_wait_command_complete_short(dev,__LINE__);
DECL|macro|ARLAN_COMMAND_UNLOCK
mdefine_line|#define ARLAN_COMMAND_UNLOCK(dev) &bslash;&n;&t;atomic_inc(&amp;((struct arlan_private * )dev-&gt;priv)-&gt;card_users);
DECL|macro|ARLAN_COMMAND_INC
mdefine_line|#define ARLAN_COMMAND_INC(dev) &bslash;&n; &t;{((struct arlan_private *) dev-&gt;priv)-&gt;under_command++;}
DECL|macro|ARLAN_COMMAND_ZERO
mdefine_line|#define ARLAN_COMMAND_ZERO(dev) &bslash;&n; &t;{((struct arlan_private *) dev-&gt;priv)-&gt;under_command =0;}
DECL|macro|ARLAN_UNDER_COMMAND
mdefine_line|#define ARLAN_UNDER_COMMAND(dev)&bslash;&n;&t;(((struct arlan_private *) dev-&gt;priv)-&gt;under_command)
DECL|macro|ARLAN_COMMAND_START
mdefine_line|#define ARLAN_COMMAND_START(dev) ARLAN_COMMAND_INC(dev)
DECL|macro|ARLAN_COMMAND_END
mdefine_line|#define ARLAN_COMMAND_END(dev) ARLAN_COMMAND_ZERO(dev)
DECL|macro|ARLAN_TOGGLE_START
mdefine_line|#define ARLAN_TOGGLE_START(dev)&bslash;&n; &t;{((struct arlan_private *) dev-&gt;priv)-&gt;under_toggle++;}
DECL|macro|ARLAN_TOGGLE_END
mdefine_line|#define ARLAN_TOGGLE_END(dev)&bslash;&n; &t;{((struct arlan_private *) dev-&gt;priv)-&gt;under_toggle=0;}
DECL|macro|ARLAN_UNDER_TOGGLE
mdefine_line|#define ARLAN_UNDER_TOGGLE(dev)&bslash;&n; &t;(((struct arlan_private *) dev-&gt;priv)-&gt;under_toggle)
DECL|function|arlan_drop_tx
r_extern
r_inline
r_int
id|arlan_drop_tx
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|arlan_private
op_star
id|priv
op_assign
(paren
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
)paren
suffix:semicolon
id|priv-&gt;stats.tx_errors
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|priv-&gt;Conf-&gt;tx_delay_ms
)paren
(brace
id|priv-&gt;tx_done_delayed
op_assign
id|jiffies
op_plus
id|priv-&gt;Conf-&gt;tx_delay_ms
op_star
id|HZ
op_div
l_int|1000
op_plus
l_int|1
suffix:semicolon
)brace
r_else
(brace
id|priv-&gt;waiting_command_mask
op_and_assign
op_complement
id|ARLAN_COMMAND_TX
suffix:semicolon
id|TXHEAD
c_func
(paren
id|dev
)paren
dot
id|offset
op_assign
l_int|0
suffix:semicolon
id|TXTAIL
c_func
(paren
id|dev
)paren
dot
id|offset
op_assign
l_int|0
suffix:semicolon
id|priv-&gt;txLast
op_assign
l_int|0
suffix:semicolon
id|priv-&gt;txOffset
op_assign
l_int|0
suffix:semicolon
id|priv-&gt;bad
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|priv-&gt;under_reset
op_logical_and
op_logical_neg
id|priv-&gt;under_config
)paren
id|netif_wake_queue
(paren
id|dev
)paren
suffix:semicolon
)brace
r_return
l_int|1
suffix:semicolon
)brace
suffix:semicolon
DECL|function|arlan_command
r_int
id|arlan_command
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_int
id|command_p
)paren
(brace
r_volatile
r_struct
id|arlan_shmem
op_star
id|arlan
op_assign
(paren
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
)paren
op_member_access_from_pointer
id|card
suffix:semicolon
r_struct
id|arlan_conf_stru
op_star
id|conf
op_assign
(paren
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
)paren
op_member_access_from_pointer
id|Conf
suffix:semicolon
r_struct
id|arlan_private
op_star
id|priv
op_assign
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_int
id|udelayed
op_assign
l_int|0
suffix:semicolon
r_int
id|i
op_assign
l_int|0
suffix:semicolon
r_int
r_int
id|time_mks
op_assign
id|arlan_time
c_func
(paren
)paren
suffix:semicolon
id|ARLAN_DEBUG_ENTRY
c_func
(paren
l_string|&quot;arlan_command&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|priv-&gt;card_polling_interval
)paren
id|priv-&gt;card_polling_interval
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|arlan_debug
op_amp
id|ARLAN_DEBUG_CHAIN_LOCKS
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;arlan_command, %lx lock %lx  commandByte %x waiting %x incoming %x &bslash;n&quot;
comma
id|jiffies
comma
id|priv-&gt;command_lock
comma
id|READSHMB
c_func
(paren
id|arlan-&gt;commandByte
)paren
comma
id|priv-&gt;waiting_command_mask
comma
id|command_p
)paren
suffix:semicolon
id|priv-&gt;waiting_command_mask
op_or_assign
id|command_p
suffix:semicolon
r_if
c_cond
(paren
id|priv-&gt;waiting_command_mask
op_amp
id|ARLAN_COMMAND_RESET
)paren
r_if
c_cond
(paren
id|jiffies
op_minus
id|priv-&gt;lastReset
OL
l_int|5
op_star
id|HZ
)paren
id|priv-&gt;waiting_command_mask
op_and_assign
op_complement
id|ARLAN_COMMAND_RESET
suffix:semicolon
r_if
c_cond
(paren
id|priv-&gt;waiting_command_mask
op_amp
id|ARLAN_COMMAND_INT_ACK
)paren
(brace
id|arlan_interrupt_ack
c_func
(paren
id|dev
)paren
suffix:semicolon
id|priv-&gt;waiting_command_mask
op_and_assign
op_complement
id|ARLAN_COMMAND_INT_ACK
suffix:semicolon
)brace
r_if
c_cond
(paren
id|priv-&gt;waiting_command_mask
op_amp
id|ARLAN_COMMAND_INT_ENABLE
)paren
(brace
id|setInterruptEnable
c_func
(paren
id|dev
)paren
suffix:semicolon
id|priv-&gt;waiting_command_mask
op_and_assign
op_complement
id|ARLAN_COMMAND_INT_ENABLE
suffix:semicolon
)brace
multiline_comment|/* Card access serializing lock */
r_if
c_cond
(paren
id|test_and_set_bit
c_func
(paren
l_int|0
comma
(paren
r_void
op_star
)paren
op_amp
id|priv-&gt;command_lock
)paren
)paren
(brace
r_if
c_cond
(paren
id|arlan_debug
op_amp
id|ARLAN_DEBUG_CHAIN_LOCKS
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;arlan_command: entered when command locked &bslash;n&quot;
)paren
suffix:semicolon
r_goto
id|command_busy_end
suffix:semicolon
)brace
multiline_comment|/* Check cards status and waiting */
r_if
c_cond
(paren
id|priv-&gt;waiting_command_mask
op_amp
(paren
id|ARLAN_COMMAND_LONG_WAIT_NOW
op_or
id|ARLAN_COMMAND_WAIT_NOW
)paren
)paren
(brace
r_while
c_loop
(paren
id|priv-&gt;waiting_command_mask
op_amp
(paren
id|ARLAN_COMMAND_LONG_WAIT_NOW
op_or
id|ARLAN_COMMAND_WAIT_NOW
)paren
)paren
(brace
r_if
c_cond
(paren
id|READSHMB
c_func
(paren
id|arlan-&gt;resetFlag
)paren
op_logical_or
id|READSHMB
c_func
(paren
id|arlan-&gt;commandByte
)paren
)paren
multiline_comment|/* || &n;&t;&t;&t;&t;&t;&t;&t;&t;   (readControlRegister(dev) &amp; ARLAN_ACCESS))&n;&t;&t;&t;&t;&t;&t;&t;&t; */
id|udelay
c_func
(paren
l_int|40
)paren
suffix:semicolon
r_else
id|priv-&gt;waiting_command_mask
op_and_assign
op_complement
(paren
id|ARLAN_COMMAND_LONG_WAIT_NOW
op_or
id|ARLAN_COMMAND_WAIT_NOW
)paren
suffix:semicolon
id|udelayed
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|priv-&gt;waiting_command_mask
op_amp
id|ARLAN_COMMAND_LONG_WAIT_NOW
)paren
(brace
r_if
c_cond
(paren
id|udelayed
op_star
l_int|40
OG
l_int|1000000
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s long wait too long &bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
id|priv-&gt;waiting_command_mask
op_or_assign
id|ARLAN_COMMAND_RESET
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|priv-&gt;waiting_command_mask
op_amp
id|ARLAN_COMMAND_WAIT_NOW
)paren
(brace
r_if
c_cond
(paren
id|udelayed
op_star
l_int|40
OG
l_int|1000
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s short wait too long &bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
r_goto
id|bad_end
suffix:semicolon
)brace
)brace
)brace
)brace
r_else
(brace
id|i
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
(paren
id|READSHMB
c_func
(paren
id|arlan-&gt;resetFlag
)paren
op_logical_or
id|READSHMB
c_func
(paren
id|arlan-&gt;commandByte
)paren
)paren
op_logical_and
id|conf-&gt;pre_Command_Wait
OG
(paren
id|i
op_increment
)paren
op_star
l_int|10
)paren
id|udelay
c_func
(paren
l_int|10
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|READSHMB
c_func
(paren
id|arlan-&gt;resetFlag
)paren
op_logical_or
id|READSHMB
c_func
(paren
id|arlan-&gt;commandByte
)paren
)paren
op_logical_and
op_logical_neg
(paren
id|priv-&gt;waiting_command_mask
op_amp
id|ARLAN_COMMAND_RESET
)paren
)paren
(brace
r_goto
id|card_busy_end
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|priv-&gt;waiting_command_mask
op_amp
id|ARLAN_COMMAND_RESET
)paren
id|priv-&gt;under_reset
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|priv-&gt;waiting_command_mask
op_amp
id|ARLAN_COMMAND_CONF
)paren
id|priv-&gt;under_config
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* Issuing command */
id|arlan_lock_card_access
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|priv-&gt;waiting_command_mask
op_amp
id|ARLAN_COMMAND_POWERUP
)paren
(brace
singleline_comment|//     if (readControlRegister(dev) &amp; (ARLAN_ACCESS &amp;&amp; ARLAN_POWER))
id|setPowerOn
c_func
(paren
id|dev
)paren
suffix:semicolon
id|arlan_interrupt_lancpu
c_func
(paren
id|dev
)paren
suffix:semicolon
id|priv-&gt;waiting_command_mask
op_and_assign
op_complement
id|ARLAN_COMMAND_POWERUP
suffix:semicolon
id|priv-&gt;waiting_command_mask
op_or_assign
id|ARLAN_COMMAND_RESET
suffix:semicolon
id|priv-&gt;card_polling_interval
op_assign
id|HZ
op_div
l_int|10
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|priv-&gt;waiting_command_mask
op_amp
id|ARLAN_COMMAND_ACTIVATE
)paren
(brace
id|WRITESHMB
c_func
(paren
id|arlan-&gt;commandByte
comma
id|ARLAN_COM_ACTIVATE
)paren
suffix:semicolon
id|arlan_interrupt_lancpu
c_func
(paren
id|dev
)paren
suffix:semicolon
id|priv-&gt;waiting_command_mask
op_and_assign
op_complement
id|ARLAN_COMMAND_ACTIVATE
suffix:semicolon
id|priv-&gt;card_polling_interval
op_assign
id|HZ
op_div
l_int|10
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|priv-&gt;waiting_command_mask
op_amp
id|ARLAN_COMMAND_RX_ABORT
)paren
(brace
r_if
c_cond
(paren
id|priv-&gt;rx_command_given
)paren
(brace
id|WRITESHMB
c_func
(paren
id|arlan-&gt;commandByte
comma
id|ARLAN_COM_RX_ABORT
)paren
suffix:semicolon
id|arlan_interrupt_lancpu
c_func
(paren
id|dev
)paren
suffix:semicolon
id|priv-&gt;rx_command_given
op_assign
l_int|0
suffix:semicolon
)brace
id|priv-&gt;waiting_command_mask
op_and_assign
op_complement
id|ARLAN_COMMAND_RX_ABORT
suffix:semicolon
id|priv-&gt;card_polling_interval
op_assign
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|priv-&gt;waiting_command_mask
op_amp
id|ARLAN_COMMAND_TX_ABORT
)paren
(brace
r_if
c_cond
(paren
id|priv-&gt;tx_command_given
)paren
(brace
id|WRITESHMB
c_func
(paren
id|arlan-&gt;commandByte
comma
id|ARLAN_COM_TX_ABORT
)paren
suffix:semicolon
id|arlan_interrupt_lancpu
c_func
(paren
id|dev
)paren
suffix:semicolon
id|priv-&gt;tx_command_given
op_assign
l_int|0
suffix:semicolon
)brace
id|priv-&gt;waiting_command_mask
op_and_assign
op_complement
id|ARLAN_COMMAND_TX_ABORT
suffix:semicolon
id|priv-&gt;card_polling_interval
op_assign
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|priv-&gt;waiting_command_mask
op_amp
id|ARLAN_COMMAND_RESET
)paren
(brace
id|priv-&gt;under_reset
op_assign
l_int|1
suffix:semicolon
id|netif_stop_queue
(paren
id|dev
)paren
suffix:semicolon
id|arlan_drop_tx
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|priv-&gt;tx_command_given
op_logical_or
id|priv-&gt;rx_command_given
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s: Reset under tx or rx command &bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
)brace
suffix:semicolon
id|netif_stop_queue
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|arlan_debug
op_amp
id|ARLAN_DEBUG_RESET
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s: Doing chip reset&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
id|priv-&gt;lastReset
op_assign
id|jiffies
suffix:semicolon
id|WRITESHM
c_func
(paren
id|arlan-&gt;commandByte
comma
l_int|0
comma
id|u_char
)paren
suffix:semicolon
multiline_comment|/* hold card in reset state */
id|setHardwareReset
c_func
(paren
id|dev
)paren
suffix:semicolon
multiline_comment|/* set reset flag and then release reset */
id|WRITESHM
c_func
(paren
id|arlan-&gt;resetFlag
comma
l_int|0xff
comma
id|u_char
)paren
suffix:semicolon
id|clearChannelAttention
c_func
(paren
id|dev
)paren
suffix:semicolon
id|clearHardwareReset
c_func
(paren
id|dev
)paren
suffix:semicolon
id|priv-&gt;numResets
op_increment
suffix:semicolon
id|priv-&gt;card_polling_interval
op_assign
id|HZ
op_div
l_int|4
suffix:semicolon
id|priv-&gt;waiting_command_mask
op_and_assign
op_complement
id|ARLAN_COMMAND_RESET
suffix:semicolon
id|priv-&gt;waiting_command_mask
op_or_assign
id|ARLAN_COMMAND_INT_RACK
suffix:semicolon
singleline_comment|//&t;&t;priv-&gt;waiting_command_mask |= ARLAN_COMMAND_INT_RENABLE; 
singleline_comment|//&t;&t;priv-&gt;waiting_command_mask |= ARLAN_COMMAND_RX;
)brace
r_else
r_if
c_cond
(paren
id|priv-&gt;waiting_command_mask
op_amp
id|ARLAN_COMMAND_INT_RACK
)paren
(brace
id|clearHardwareReset
c_func
(paren
id|dev
)paren
suffix:semicolon
id|clearClearInterrupt
c_func
(paren
id|dev
)paren
suffix:semicolon
id|setClearInterrupt
c_func
(paren
id|dev
)paren
suffix:semicolon
id|setInterruptEnable
c_func
(paren
id|dev
)paren
suffix:semicolon
id|priv-&gt;waiting_command_mask
op_and_assign
op_complement
id|ARLAN_COMMAND_INT_RACK
suffix:semicolon
id|priv-&gt;waiting_command_mask
op_or_assign
id|ARLAN_COMMAND_CONF
suffix:semicolon
id|priv-&gt;under_config
op_assign
l_int|1
suffix:semicolon
id|priv-&gt;under_reset
op_assign
l_int|0
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|priv-&gt;waiting_command_mask
op_amp
id|ARLAN_COMMAND_INT_RENABLE
)paren
(brace
id|setInterruptEnable
c_func
(paren
id|dev
)paren
suffix:semicolon
id|priv-&gt;waiting_command_mask
op_and_assign
op_complement
id|ARLAN_COMMAND_INT_RENABLE
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|priv-&gt;waiting_command_mask
op_amp
id|ARLAN_COMMAND_CONF
)paren
(brace
r_if
c_cond
(paren
id|priv-&gt;tx_command_given
op_logical_or
id|priv-&gt;rx_command_given
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s: Reset under tx or rx command &bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
)brace
id|arlan_drop_tx
c_func
(paren
id|dev
)paren
suffix:semicolon
id|setInterruptEnable
c_func
(paren
id|dev
)paren
suffix:semicolon
id|arlan_hw_config
c_func
(paren
id|dev
)paren
suffix:semicolon
id|arlan_interrupt_lancpu
c_func
(paren
id|dev
)paren
suffix:semicolon
id|priv-&gt;waiting_command_mask
op_and_assign
op_complement
id|ARLAN_COMMAND_CONF
suffix:semicolon
id|priv-&gt;card_polling_interval
op_assign
id|HZ
op_div
l_int|10
suffix:semicolon
singleline_comment|//&t;&t;priv-&gt;waiting_command_mask |= ARLAN_COMMAND_INT_RACK;   
singleline_comment|//&t;&t;priv-&gt;waiting_command_mask |= ARLAN_COMMAND_INT_ENABLE; 
id|priv-&gt;waiting_command_mask
op_or_assign
id|ARLAN_COMMAND_CONF_WAIT
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|priv-&gt;waiting_command_mask
op_amp
id|ARLAN_COMMAND_CONF_WAIT
)paren
(brace
r_if
c_cond
(paren
id|READSHMB
c_func
(paren
id|arlan-&gt;configuredStatusFlag
)paren
op_ne
l_int|0
op_logical_and
id|READSHMB
c_func
(paren
id|arlan-&gt;diagnosticInfo
)paren
op_eq
l_int|0xff
)paren
(brace
id|priv-&gt;waiting_command_mask
op_and_assign
op_complement
id|ARLAN_COMMAND_CONF_WAIT
suffix:semicolon
id|priv-&gt;waiting_command_mask
op_or_assign
id|ARLAN_COMMAND_RX
suffix:semicolon
id|priv-&gt;waiting_command_mask
op_or_assign
id|ARLAN_COMMAND_TBUSY_CLEAR
suffix:semicolon
id|priv-&gt;card_polling_interval
op_assign
id|HZ
op_div
l_int|10
suffix:semicolon
id|priv-&gt;tx_command_given
op_assign
l_int|0
suffix:semicolon
id|priv-&gt;under_config
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|priv-&gt;card_polling_interval
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|arlan_debug
op_amp
id|ARLAN_DEBUG_TIMING
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;configure delayed &bslash;n&quot;
)paren
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|priv-&gt;waiting_command_mask
op_amp
id|ARLAN_COMMAND_RX
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|registrationBad
c_func
(paren
id|dev
)paren
)paren
(brace
id|setInterruptEnable
c_func
(paren
id|dev
)paren
suffix:semicolon
id|memset_io
c_func
(paren
(paren
r_void
op_star
)paren
id|arlan-&gt;commandParameter
comma
l_int|0
comma
l_int|0xf
)paren
suffix:semicolon
id|WRITESHMB
c_func
(paren
id|arlan-&gt;commandByte
comma
id|ARLAN_COM_INT
op_or
id|ARLAN_COM_RX_ENABLE
)paren
suffix:semicolon
id|WRITESHMB
c_func
(paren
id|arlan-&gt;commandParameter
(braket
l_int|0
)braket
comma
id|conf-&gt;rxParameter
)paren
suffix:semicolon
id|arlan_interrupt_lancpu
c_func
(paren
id|dev
)paren
suffix:semicolon
id|priv-&gt;rx_command_given
op_assign
l_int|0
suffix:semicolon
singleline_comment|// mnjah, bad
id|priv-&gt;last_rx_time
op_assign
id|arlan_time
c_func
(paren
)paren
suffix:semicolon
id|priv-&gt;waiting_command_mask
op_and_assign
op_complement
id|ARLAN_COMMAND_RX
suffix:semicolon
id|priv-&gt;card_polling_interval
op_assign
l_int|1
suffix:semicolon
)brace
r_else
id|priv-&gt;card_polling_interval
op_assign
l_int|2
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|priv-&gt;waiting_command_mask
op_amp
id|ARLAN_COMMAND_TBUSY_CLEAR
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|registrationBad
c_func
(paren
id|dev
)paren
op_logical_and
(paren
id|netif_queue_stopped
c_func
(paren
id|dev
)paren
op_logical_or
op_logical_neg
id|netif_running
c_func
(paren
id|dev
)paren
)paren
)paren
(brace
id|priv-&gt;waiting_command_mask
op_and_assign
op_complement
id|ARLAN_COMMAND_TBUSY_CLEAR
suffix:semicolon
id|netif_wake_queue
(paren
id|dev
)paren
suffix:semicolon
)brace
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|priv-&gt;waiting_command_mask
op_amp
id|ARLAN_COMMAND_TX
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|test_and_set_bit
c_func
(paren
l_int|0
comma
(paren
r_void
op_star
)paren
op_amp
id|priv-&gt;tx_command_given
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
id|time_mks
op_minus
id|priv-&gt;last_tx_time
OG
id|conf-&gt;rx_tweak1
)paren
op_logical_or
(paren
id|time_mks
op_minus
id|priv-&gt;last_rx_int_ack_time
OL
id|conf-&gt;rx_tweak2
)paren
)paren
(brace
id|setInterruptEnable
c_func
(paren
id|dev
)paren
suffix:semicolon
id|memset_io
c_func
(paren
(paren
r_void
op_star
)paren
id|arlan-&gt;commandParameter
comma
l_int|0
comma
l_int|0xf
)paren
suffix:semicolon
id|WRITESHMB
c_func
(paren
id|arlan-&gt;commandByte
comma
id|ARLAN_COM_TX_ENABLE
op_or
id|ARLAN_COM_INT
)paren
suffix:semicolon
id|memcpy_toio
c_func
(paren
(paren
r_void
op_star
)paren
id|arlan-&gt;commandParameter
comma
op_amp
id|TXLAST
c_func
(paren
id|dev
)paren
comma
l_int|14
)paren
suffix:semicolon
singleline_comment|//&t;&t;&t;&t;for ( i=1 ; i &lt; 15 ; i++) printk(&quot;%02x:&quot;,READSHMB(arlan-&gt;commandParameter[i]));
id|priv-&gt;last_command_was_rx
op_assign
l_int|0
suffix:semicolon
id|priv-&gt;tx_last_sent
op_assign
id|jiffies
suffix:semicolon
id|arlan_interrupt_lancpu
c_func
(paren
id|dev
)paren
suffix:semicolon
id|priv-&gt;last_tx_time
op_assign
id|arlan_time
c_func
(paren
)paren
suffix:semicolon
id|priv-&gt;tx_command_given
op_assign
l_int|1
suffix:semicolon
id|priv-&gt;waiting_command_mask
op_and_assign
op_complement
id|ARLAN_COMMAND_TX
suffix:semicolon
id|priv-&gt;card_polling_interval
op_assign
l_int|1
suffix:semicolon
)brace
r_else
(brace
id|priv-&gt;tx_command_given
op_assign
l_int|0
suffix:semicolon
id|priv-&gt;card_polling_interval
op_assign
l_int|1
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|arlan_debug
op_amp
id|ARLAN_DEBUG_CHAIN_LOCKS
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;tx command when tx chain locked &bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|priv-&gt;waiting_command_mask
op_amp
id|ARLAN_COMMAND_NOOPINT
)paren
(brace
(brace
id|WRITESHMB
c_func
(paren
id|arlan-&gt;commandByte
comma
id|ARLAN_COM_NOP
op_or
id|ARLAN_COM_INT
)paren
suffix:semicolon
)brace
id|arlan_interrupt_lancpu
c_func
(paren
id|dev
)paren
suffix:semicolon
id|priv-&gt;waiting_command_mask
op_and_assign
op_complement
id|ARLAN_COMMAND_NOOPINT
suffix:semicolon
id|priv-&gt;card_polling_interval
op_assign
id|HZ
op_div
l_int|3
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|priv-&gt;waiting_command_mask
op_amp
id|ARLAN_COMMAND_NOOP
)paren
(brace
id|WRITESHMB
c_func
(paren
id|arlan-&gt;commandByte
comma
id|ARLAN_COM_NOP
)paren
suffix:semicolon
id|arlan_interrupt_lancpu
c_func
(paren
id|dev
)paren
suffix:semicolon
id|priv-&gt;waiting_command_mask
op_and_assign
op_complement
id|ARLAN_COMMAND_NOOP
suffix:semicolon
id|priv-&gt;card_polling_interval
op_assign
id|HZ
op_div
l_int|3
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|priv-&gt;waiting_command_mask
op_amp
id|ARLAN_COMMAND_SLOW_POLL
)paren
(brace
id|WRITESHMB
c_func
(paren
id|arlan-&gt;commandByte
comma
id|ARLAN_COM_GOTO_SLOW_POLL
)paren
suffix:semicolon
id|arlan_interrupt_lancpu
c_func
(paren
id|dev
)paren
suffix:semicolon
id|priv-&gt;waiting_command_mask
op_and_assign
op_complement
id|ARLAN_COMMAND_SLOW_POLL
suffix:semicolon
id|priv-&gt;card_polling_interval
op_assign
id|HZ
op_div
l_int|3
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|priv-&gt;waiting_command_mask
op_amp
id|ARLAN_COMMAND_POWERDOWN
)paren
(brace
id|setPowerOff
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|arlan_debug
op_amp
id|ARLAN_DEBUG_CARD_STATE
)paren
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;%s: Arlan Going Standby&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
id|priv-&gt;waiting_command_mask
op_and_assign
op_complement
id|ARLAN_COMMAND_POWERDOWN
suffix:semicolon
id|priv-&gt;card_polling_interval
op_assign
l_int|3
op_star
id|HZ
suffix:semicolon
)brace
id|arlan_unlock_card_access
c_func
(paren
id|dev
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|READSHMB
c_func
(paren
id|arlan-&gt;commandByte
)paren
op_logical_and
id|i
OL
l_int|20
suffix:semicolon
id|i
op_increment
)paren
id|udelay
c_func
(paren
l_int|10
)paren
suffix:semicolon
r_if
c_cond
(paren
id|READSHMB
c_func
(paren
id|arlan-&gt;commandByte
)paren
)paren
r_if
c_cond
(paren
id|arlan_debug
op_amp
id|ARLAN_DEBUG_CARD_STATE
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;card busy leaving command %x &bslash;n&quot;
comma
id|priv-&gt;waiting_command_mask
)paren
suffix:semicolon
id|priv-&gt;command_lock
op_assign
l_int|0
suffix:semicolon
id|ARLAN_DEBUG_EXIT
c_func
(paren
l_string|&quot;arlan_command&quot;
)paren
suffix:semicolon
id|priv-&gt;last_command_buff_free_time
op_assign
id|jiffies
suffix:semicolon
r_return
l_int|0
suffix:semicolon
id|card_busy_end
suffix:colon
r_if
c_cond
(paren
id|jiffies
op_minus
id|priv-&gt;last_command_buff_free_time
OG
id|HZ
)paren
id|priv-&gt;waiting_command_mask
op_or_assign
id|ARLAN_COMMAND_CLEAN_AND_RESET
suffix:semicolon
r_if
c_cond
(paren
id|arlan_debug
op_amp
id|ARLAN_DEBUG_CARD_STATE
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s arlan_command card busy end &bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
id|priv-&gt;command_lock
op_assign
l_int|0
suffix:semicolon
id|ARLAN_DEBUG_EXIT
c_func
(paren
l_string|&quot;arlan_command&quot;
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
id|bad_end
suffix:colon
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s arlan_command bad end &bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
id|priv-&gt;command_lock
op_assign
l_int|0
suffix:semicolon
id|ARLAN_DEBUG_EXIT
c_func
(paren
l_string|&quot;arlan_command&quot;
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
id|command_busy_end
suffix:colon
r_if
c_cond
(paren
id|arlan_debug
op_amp
id|ARLAN_DEBUG_CARD_STATE
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s arlan_command command busy end &bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
id|ARLAN_DEBUG_EXIT
c_func
(paren
l_string|&quot;arlan_command&quot;
)paren
suffix:semicolon
r_return
l_int|2
suffix:semicolon
)brace
suffix:semicolon
DECL|function|arlan_command_process
r_extern
r_inline
r_void
id|arlan_command_process
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|arlan_private
op_star
id|priv
op_assign
(paren
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
)paren
suffix:semicolon
r_int
id|times
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|priv-&gt;waiting_command_mask
op_logical_and
id|times
OL
l_int|8
)paren
(brace
r_if
c_cond
(paren
id|priv-&gt;waiting_command_mask
)paren
(brace
r_if
c_cond
(paren
id|arlan_command
c_func
(paren
id|dev
comma
l_int|0
)paren
)paren
r_break
suffix:semicolon
id|times
op_increment
suffix:semicolon
)brace
multiline_comment|/* if long command, we wont repeat trying */
suffix:semicolon
r_if
c_cond
(paren
id|priv-&gt;card_polling_interval
OG
l_int|1
)paren
r_break
suffix:semicolon
id|times
op_increment
suffix:semicolon
)brace
)brace
DECL|function|arlan_retransmit_now
r_extern
r_inline
r_void
id|arlan_retransmit_now
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|arlan_private
op_star
id|priv
op_assign
(paren
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
)paren
suffix:semicolon
id|ARLAN_DEBUG_ENTRY
c_func
(paren
l_string|&quot;arlan_retransmit_now&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|TXLAST
c_func
(paren
id|dev
)paren
dot
id|offset
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|TXHEAD
c_func
(paren
id|dev
)paren
dot
id|offset
)paren
(brace
id|priv-&gt;txLast
op_assign
l_int|0
suffix:semicolon
id|IFDEBUG
c_func
(paren
id|ARLAN_DEBUG_TX_CHAIN
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;TX buff switch to head &bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|TXTAIL
c_func
(paren
id|dev
)paren
dot
id|offset
)paren
(brace
id|IFDEBUG
c_func
(paren
id|ARLAN_DEBUG_TX_CHAIN
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;TX buff switch to tail &bslash;n&quot;
)paren
suffix:semicolon
id|priv-&gt;txLast
op_assign
l_int|1
suffix:semicolon
)brace
r_else
id|IFDEBUG
c_func
(paren
id|ARLAN_DEBUG_TX_CHAIN
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;ReTransmit buff empty&quot;
)paren
suffix:semicolon
id|priv-&gt;txOffset
op_assign
l_int|0
suffix:semicolon
id|netif_wake_queue
(paren
id|dev
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|arlan_command
c_func
(paren
id|dev
comma
id|ARLAN_COMMAND_TX
)paren
suffix:semicolon
id|priv-&gt;nof_tx
op_increment
suffix:semicolon
id|priv-&gt;Conf-&gt;driverRetransmissions
op_increment
suffix:semicolon
id|priv-&gt;retransmissions
op_increment
suffix:semicolon
id|IFDEBUG
c_func
(paren
id|ARLAN_DEBUG_TX_CHAIN
)paren
id|printk
c_func
(paren
l_string|&quot;Retransmit %d bytes &bslash;n&quot;
comma
id|TXLAST
c_func
(paren
id|dev
)paren
dot
id|length
)paren
suffix:semicolon
id|ARLAN_DEBUG_EXIT
c_func
(paren
l_string|&quot;arlan_retransmit_now&quot;
)paren
suffix:semicolon
)brace
DECL|function|arlan_registration_timer
r_static
r_void
id|arlan_registration_timer
c_func
(paren
r_int
r_int
id|data
)paren
(brace
r_struct
id|net_device
op_star
id|dev
op_assign
(paren
r_struct
id|net_device
op_star
)paren
id|data
suffix:semicolon
r_struct
id|arlan_private
op_star
id|priv
op_assign
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_int
id|lostTime
op_assign
(paren
(paren
r_int
)paren
(paren
id|jiffies
op_minus
id|priv-&gt;registrationLastSeen
)paren
)paren
op_star
l_int|1000
op_div
id|HZ
suffix:semicolon
r_int
id|bh_mark_needed
op_assign
l_int|0
suffix:semicolon
r_int
id|next_tick
op_assign
l_int|1
suffix:semicolon
id|priv-&gt;timer_chain_active
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|registrationBad
c_func
(paren
id|dev
)paren
)paren
(brace
singleline_comment|//debug=100;
id|priv-&gt;registrationLostCount
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|lostTime
OG
l_int|7000
op_logical_and
id|lostTime
OL
l_int|7200
)paren
(brace
id|printk
c_func
(paren
id|KERN_NOTICE
l_string|&quot;%s registration Lost &bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|lostTime
op_div
id|priv-&gt;reRegisterExp
OG
l_int|2000
)paren
id|arlan_command
c_func
(paren
id|dev
comma
id|ARLAN_COMMAND_CLEAN_AND_CONF
)paren
suffix:semicolon
r_if
c_cond
(paren
id|lostTime
op_div
(paren
id|priv-&gt;reRegisterExp
)paren
OG
l_int|3500
)paren
id|arlan_command
c_func
(paren
id|dev
comma
id|ARLAN_COMMAND_CLEAN_AND_RESET
)paren
suffix:semicolon
r_if
c_cond
(paren
id|priv-&gt;reRegisterExp
OL
l_int|400
)paren
id|priv-&gt;reRegisterExp
op_add_assign
l_int|2
suffix:semicolon
r_if
c_cond
(paren
id|lostTime
OG
l_int|7200
)paren
(brace
id|next_tick
op_assign
id|HZ
suffix:semicolon
id|arlan_command
c_func
(paren
id|dev
comma
id|ARLAN_COMMAND_CLEAN_AND_RESET
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|priv-&gt;Conf-&gt;registrationMode
op_logical_and
id|lostTime
OG
l_int|10000
op_logical_and
id|priv-&gt;registrationLostCount
)paren
(brace
id|printk
c_func
(paren
id|KERN_NOTICE
l_string|&quot;%s registration is back after %d milliseconds&bslash;n&quot;
comma
id|dev-&gt;name
comma
(paren
(paren
r_int
)paren
(paren
id|jiffies
op_minus
id|priv-&gt;registrationLastSeen
)paren
op_star
l_int|1000
)paren
op_div
id|HZ
)paren
suffix:semicolon
)brace
id|priv-&gt;registrationLastSeen
op_assign
id|jiffies
suffix:semicolon
id|priv-&gt;registrationLostCount
op_assign
l_int|0
suffix:semicolon
id|priv-&gt;reRegisterExp
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|netif_running
c_func
(paren
id|dev
)paren
)paren
id|netif_wake_queue
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|priv-&gt;tx_last_sent
OG
id|priv-&gt;tx_last_cleared
op_logical_and
id|jiffies
op_minus
id|priv-&gt;tx_last_sent
OG
l_int|5
op_star
id|HZ
)paren
(brace
id|arlan_command
c_func
(paren
id|dev
comma
id|ARLAN_COMMAND_CLEAN_AND_RESET
)paren
suffix:semicolon
id|priv-&gt;tx_last_cleared
op_assign
id|jiffies
suffix:semicolon
)brace
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|registrationBad
c_func
(paren
id|dev
)paren
op_logical_and
id|priv-&gt;ReTransmitRequested
)paren
(brace
id|IFDEBUG
c_func
(paren
id|ARLAN_DEBUG_TX_CHAIN
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;Retransmit from timer &bslash;n&quot;
)paren
suffix:semicolon
id|priv-&gt;ReTransmitRequested
op_assign
l_int|0
suffix:semicolon
id|arlan_retransmit_now
c_func
(paren
id|dev
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|registrationBad
c_func
(paren
id|dev
)paren
op_logical_and
id|priv-&gt;tx_done_delayed
OL
id|jiffies
op_logical_and
id|priv-&gt;tx_done_delayed
op_ne
l_int|0
)paren
(brace
id|TXLAST
c_func
(paren
id|dev
)paren
dot
id|offset
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|priv-&gt;txLast
)paren
id|priv-&gt;txLast
op_assign
l_int|0
suffix:semicolon
r_else
r_if
c_cond
(paren
id|TXTAIL
c_func
(paren
id|dev
)paren
dot
id|offset
)paren
id|priv-&gt;txLast
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|TXLAST
c_func
(paren
id|dev
)paren
dot
id|offset
)paren
(brace
id|arlan_retransmit_now
c_func
(paren
id|dev
)paren
suffix:semicolon
id|dev-&gt;trans_start
op_assign
id|jiffies
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|TXHEAD
c_func
(paren
id|dev
)paren
dot
id|offset
op_logical_and
id|TXTAIL
c_func
(paren
id|dev
)paren
dot
id|offset
)paren
)paren
(brace
id|priv-&gt;txOffset
op_assign
l_int|0
suffix:semicolon
id|netif_wake_queue
(paren
id|dev
)paren
suffix:semicolon
)brace
id|priv-&gt;tx_done_delayed
op_assign
l_int|0
suffix:semicolon
id|bh_mark_needed
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|bh_mark_needed
)paren
(brace
id|priv-&gt;txOffset
op_assign
l_int|0
suffix:semicolon
id|netif_wake_queue
(paren
id|dev
)paren
suffix:semicolon
)brace
id|arlan_process_interrupt
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|next_tick
OL
id|priv-&gt;card_polling_interval
)paren
id|next_tick
op_assign
id|priv-&gt;card_polling_interval
suffix:semicolon
id|priv-&gt;timer_chain_active
op_assign
l_int|0
suffix:semicolon
id|priv-&gt;timer.expires
op_assign
id|jiffies
op_plus
id|next_tick
suffix:semicolon
id|add_timer
c_func
(paren
op_amp
id|priv-&gt;timer
)paren
suffix:semicolon
)brace
macro_line|#ifdef ARLAN_DEBUGING
DECL|function|arlan_print_registers
r_static
r_void
id|arlan_print_registers
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_int
id|line
)paren
(brace
r_volatile
r_struct
id|arlan_shmem
op_star
id|arlan
op_assign
(paren
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
)paren
op_member_access_from_pointer
id|card
suffix:semicolon
id|u_char
id|hostcpuLock
comma
id|lancpuLock
comma
id|controlRegister
comma
id|cntrlRegImage
comma
id|txStatus
comma
id|rxStatus
comma
id|interruptInProgress
comma
id|commandByte
suffix:semicolon
id|ARLAN_DEBUG_ENTRY
c_func
(paren
l_string|&quot;arlan_print_registers&quot;
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|interruptInProgress
comma
id|arlan-&gt;interruptInProgress
comma
id|u_char
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|hostcpuLock
comma
id|arlan-&gt;hostcpuLock
comma
id|u_char
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|lancpuLock
comma
id|arlan-&gt;lancpuLock
comma
id|u_char
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|controlRegister
comma
id|arlan-&gt;controlRegister
comma
id|u_char
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|cntrlRegImage
comma
id|arlan-&gt;cntrlRegImage
comma
id|u_char
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|txStatus
comma
id|arlan-&gt;txStatus
comma
id|u_char
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|rxStatus
comma
id|arlan-&gt;rxStatus
comma
id|u_char
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|commandByte
comma
id|arlan-&gt;commandByte
comma
id|u_char
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;line %04d IP %02x HL %02x LL %02x CB %02x CR %02x CRI %02x TX %02x RX %02x&bslash;n&quot;
comma
id|line
comma
id|interruptInProgress
comma
id|hostcpuLock
comma
id|lancpuLock
comma
id|commandByte
comma
id|controlRegister
comma
id|cntrlRegImage
comma
id|txStatus
comma
id|rxStatus
)paren
suffix:semicolon
id|ARLAN_DEBUG_EXIT
c_func
(paren
l_string|&quot;arlan_print_registers&quot;
)paren
suffix:semicolon
)brace
macro_line|#endif
DECL|function|arlan_hw_tx
r_static
r_int
id|arlan_hw_tx
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_char
op_star
id|buf
comma
r_int
id|length
)paren
(brace
r_int
id|i
suffix:semicolon
r_struct
id|arlan_private
op_star
id|priv
op_assign
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_volatile
r_struct
id|arlan_shmem
op_star
id|arlan
op_assign
id|priv-&gt;card
suffix:semicolon
r_struct
id|arlan_conf_stru
op_star
id|conf
op_assign
id|priv-&gt;Conf
suffix:semicolon
r_int
id|tailStarts
op_assign
l_int|0x800
suffix:semicolon
r_int
id|headEnds
op_assign
l_int|0x0
suffix:semicolon
id|ARLAN_DEBUG_ENTRY
c_func
(paren
l_string|&quot;arlan_hw_tx&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|TXHEAD
c_func
(paren
id|dev
)paren
dot
id|offset
)paren
id|headEnds
op_assign
(paren
(paren
(paren
id|TXHEAD
c_func
(paren
id|dev
)paren
dot
id|offset
op_plus
id|TXHEAD
c_func
(paren
id|dev
)paren
dot
id|length
op_minus
(paren
(paren
(paren
r_int
)paren
id|arlan-&gt;txBuffer
)paren
op_minus
(paren
(paren
r_int
)paren
id|arlan
)paren
)paren
)paren
op_div
l_int|64
)paren
op_plus
l_int|1
)paren
op_star
l_int|64
suffix:semicolon
r_if
c_cond
(paren
id|TXTAIL
c_func
(paren
id|dev
)paren
dot
id|offset
)paren
id|tailStarts
op_assign
l_int|0x800
op_minus
(paren
(paren
(paren
id|TXTAIL
c_func
(paren
id|dev
)paren
dot
id|offset
op_minus
(paren
(paren
(paren
r_int
)paren
id|arlan-&gt;txBuffer
)paren
op_minus
(paren
(paren
r_int
)paren
id|arlan
)paren
)paren
)paren
op_div
l_int|64
)paren
op_plus
l_int|2
)paren
op_star
l_int|64
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|TXHEAD
c_func
(paren
id|dev
)paren
dot
id|offset
op_logical_and
id|length
OL
id|tailStarts
)paren
(brace
id|IFDEBUG
c_func
(paren
id|ARLAN_DEBUG_TX_CHAIN
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;TXHEAD insert, tailStart %d&bslash;n&quot;
comma
id|tailStarts
)paren
suffix:semicolon
id|TXHEAD
c_func
(paren
id|dev
)paren
dot
id|offset
op_assign
(paren
(paren
(paren
r_int
)paren
id|arlan-&gt;txBuffer
)paren
op_minus
(paren
(paren
r_int
)paren
id|arlan
)paren
)paren
suffix:semicolon
id|TXHEAD
c_func
(paren
id|dev
)paren
dot
id|length
op_assign
id|length
op_minus
id|ARLAN_FAKE_HDR_LEN
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|6
suffix:semicolon
id|i
op_increment
)paren
id|TXHEAD
c_func
(paren
id|dev
)paren
dot
id|dest
(braket
id|i
)braket
op_assign
id|buf
(braket
id|i
)braket
suffix:semicolon
id|TXHEAD
c_func
(paren
id|dev
)paren
dot
id|clear
op_assign
id|conf-&gt;txClear
suffix:semicolon
id|TXHEAD
c_func
(paren
id|dev
)paren
dot
id|retries
op_assign
id|conf-&gt;txRetries
suffix:semicolon
multiline_comment|/* 0 is use default */
id|TXHEAD
c_func
(paren
id|dev
)paren
dot
id|routing
op_assign
id|conf-&gt;txRouting
suffix:semicolon
id|TXHEAD
c_func
(paren
id|dev
)paren
dot
id|scrambled
op_assign
id|conf-&gt;txScrambled
suffix:semicolon
id|memcpy_toio
c_func
(paren
(paren
(paren
r_char
op_star
)paren
id|arlan
op_plus
id|TXHEAD
c_func
(paren
id|dev
)paren
dot
id|offset
)paren
comma
id|buf
op_plus
id|ARLAN_FAKE_HDR_LEN
comma
id|TXHEAD
c_func
(paren
id|dev
)paren
dot
id|length
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|TXTAIL
c_func
(paren
id|dev
)paren
dot
id|offset
op_logical_and
id|length
OL
(paren
l_int|0x800
op_minus
id|headEnds
)paren
)paren
(brace
id|IFDEBUG
c_func
(paren
id|ARLAN_DEBUG_TX_CHAIN
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;TXTAIL insert, headEnd %d&bslash;n&quot;
comma
id|headEnds
)paren
suffix:semicolon
id|TXTAIL
c_func
(paren
id|dev
)paren
dot
id|offset
op_assign
(paren
(paren
(paren
r_int
)paren
id|arlan-&gt;txBuffer
)paren
op_minus
(paren
(paren
r_int
)paren
id|arlan
)paren
)paren
op_plus
l_int|0x800
op_minus
(paren
id|length
op_div
l_int|64
op_plus
l_int|2
)paren
op_star
l_int|64
suffix:semicolon
id|TXTAIL
c_func
(paren
id|dev
)paren
dot
id|length
op_assign
id|length
op_minus
id|ARLAN_FAKE_HDR_LEN
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|6
suffix:semicolon
id|i
op_increment
)paren
id|TXTAIL
c_func
(paren
id|dev
)paren
dot
id|dest
(braket
id|i
)braket
op_assign
id|buf
(braket
id|i
)braket
suffix:semicolon
id|TXTAIL
c_func
(paren
id|dev
)paren
dot
id|clear
op_assign
id|conf-&gt;txClear
suffix:semicolon
id|TXTAIL
c_func
(paren
id|dev
)paren
dot
id|retries
op_assign
id|conf-&gt;txRetries
suffix:semicolon
id|TXTAIL
c_func
(paren
id|dev
)paren
dot
id|routing
op_assign
id|conf-&gt;txRouting
suffix:semicolon
id|TXTAIL
c_func
(paren
id|dev
)paren
dot
id|scrambled
op_assign
id|conf-&gt;txScrambled
suffix:semicolon
id|memcpy_toio
c_func
(paren
(paren
(paren
r_char
op_star
)paren
id|arlan
op_plus
id|TXTAIL
c_func
(paren
id|dev
)paren
dot
id|offset
)paren
comma
id|buf
op_plus
id|ARLAN_FAKE_HDR_LEN
comma
id|TXTAIL
c_func
(paren
id|dev
)paren
dot
id|length
)paren
suffix:semicolon
)brace
r_else
(brace
id|netif_stop_queue
(paren
id|dev
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
id|IFDEBUG
c_func
(paren
id|ARLAN_DEBUG_TX_CHAIN
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;TX TAIL &amp; HEAD full, return, tailStart %d headEnd %d&bslash;n&quot;
comma
id|tailStarts
comma
id|headEnds
)paren
suffix:semicolon
)brace
id|priv-&gt;out_bytes
op_add_assign
id|length
suffix:semicolon
id|priv-&gt;out_bytes10
op_add_assign
id|length
suffix:semicolon
r_if
c_cond
(paren
id|conf-&gt;measure_rate
OL
l_int|1
)paren
id|conf-&gt;measure_rate
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|jiffies
op_minus
id|priv-&gt;out_time
OG
id|conf-&gt;measure_rate
op_star
id|HZ
)paren
(brace
id|conf-&gt;out_speed
op_assign
id|priv-&gt;out_bytes
op_div
id|conf-&gt;measure_rate
suffix:semicolon
id|priv-&gt;out_bytes
op_assign
l_int|0
suffix:semicolon
id|priv-&gt;out_time
op_assign
id|jiffies
suffix:semicolon
)brace
r_if
c_cond
(paren
id|jiffies
op_minus
id|priv-&gt;out_time10
OG
id|conf-&gt;measure_rate
op_star
id|HZ
op_star
l_int|10
)paren
(brace
id|conf-&gt;out_speed10
op_assign
id|priv-&gt;out_bytes10
op_div
(paren
l_int|10
op_star
id|conf-&gt;measure_rate
)paren
suffix:semicolon
id|priv-&gt;out_bytes10
op_assign
l_int|0
suffix:semicolon
id|priv-&gt;out_time10
op_assign
id|jiffies
suffix:semicolon
)brace
r_if
c_cond
(paren
id|TXHEAD
c_func
(paren
id|dev
)paren
dot
id|offset
op_logical_and
id|TXTAIL
c_func
(paren
id|dev
)paren
dot
id|offset
)paren
(brace
id|netif_stop_queue
(paren
id|dev
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_else
id|netif_start_queue
(paren
id|dev
)paren
suffix:semicolon
id|IFDEBUG
c_func
(paren
id|ARLAN_DEBUG_HEADER_DUMP
)paren
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;%s Transmit t %2x:%2x:%2x:%2x:%2x:%2x f %2x:%2x:%2x:%2x:%2x:%2x &bslash;n&quot;
comma
id|dev-&gt;name
comma
(paren
r_int
r_char
)paren
id|buf
(braket
l_int|0
)braket
comma
(paren
r_int
r_char
)paren
id|buf
(braket
l_int|1
)braket
comma
(paren
r_int
r_char
)paren
id|buf
(braket
l_int|2
)braket
comma
(paren
r_int
r_char
)paren
id|buf
(braket
l_int|3
)braket
comma
(paren
r_int
r_char
)paren
id|buf
(braket
l_int|4
)braket
comma
(paren
r_int
r_char
)paren
id|buf
(braket
l_int|5
)braket
comma
(paren
r_int
r_char
)paren
id|buf
(braket
l_int|6
)braket
comma
(paren
r_int
r_char
)paren
id|buf
(braket
l_int|7
)braket
comma
(paren
r_int
r_char
)paren
id|buf
(braket
l_int|8
)braket
comma
(paren
r_int
r_char
)paren
id|buf
(braket
l_int|9
)braket
comma
(paren
r_int
r_char
)paren
id|buf
(braket
l_int|10
)braket
comma
(paren
r_int
r_char
)paren
id|buf
(braket
l_int|11
)braket
)paren
suffix:semicolon
id|IFDEBUG
c_func
(paren
id|ARLAN_DEBUG_TX_CHAIN
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;TX command prepare for buffer %d&bslash;n&quot;
comma
id|priv-&gt;txLast
)paren
suffix:semicolon
id|arlan_command
c_func
(paren
id|dev
comma
id|ARLAN_COMMAND_TX
)paren
suffix:semicolon
id|priv-&gt;last_command_was_rx
op_assign
l_int|0
suffix:semicolon
id|priv-&gt;tx_last_sent
op_assign
id|jiffies
suffix:semicolon
id|priv-&gt;nof_tx
op_increment
suffix:semicolon
id|IFDEBUG
c_func
(paren
id|ARLAN_DEBUG_TX_CHAIN
)paren
id|printk
c_func
(paren
l_string|&quot;%s TX Qued %d bytes &bslash;n&quot;
comma
id|dev-&gt;name
comma
id|length
)paren
suffix:semicolon
id|ARLAN_DEBUG_EXIT
c_func
(paren
l_string|&quot;arlan_hw_tx&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|arlan_hw_config
r_static
r_int
id|arlan_hw_config
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_volatile
r_struct
id|arlan_shmem
op_star
id|arlan
op_assign
(paren
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
)paren
op_member_access_from_pointer
id|card
suffix:semicolon
r_struct
id|arlan_conf_stru
op_star
id|conf
op_assign
(paren
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
)paren
op_member_access_from_pointer
id|Conf
suffix:semicolon
r_struct
id|arlan_private
op_star
id|priv
op_assign
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
id|ARLAN_DEBUG_ENTRY
c_func
(paren
l_string|&quot;arlan_hw_config&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_NOTICE
l_string|&quot;%s arlan configure called &bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
r_if
c_cond
(paren
id|arlan_EEPROM_bad
)paren
id|printk
c_func
(paren
id|KERN_NOTICE
l_string|&quot;arlan configure with eeprom bad option &bslash;n&quot;
)paren
suffix:semicolon
id|WRITESHM
c_func
(paren
id|arlan-&gt;spreadingCode
comma
id|conf-&gt;spreadingCode
comma
id|u_char
)paren
suffix:semicolon
id|WRITESHM
c_func
(paren
id|arlan-&gt;channelSet
comma
id|conf-&gt;channelSet
comma
id|u_char
)paren
suffix:semicolon
r_if
c_cond
(paren
id|arlan_EEPROM_bad
)paren
id|WRITESHM
c_func
(paren
id|arlan-&gt;defaultChannelSet
comma
id|conf-&gt;channelSet
comma
id|u_char
)paren
suffix:semicolon
id|WRITESHM
c_func
(paren
id|arlan-&gt;channelNumber
comma
id|conf-&gt;channelNumber
comma
id|u_char
)paren
suffix:semicolon
id|WRITESHM
c_func
(paren
id|arlan-&gt;scramblingDisable
comma
id|conf-&gt;scramblingDisable
comma
id|u_char
)paren
suffix:semicolon
id|WRITESHM
c_func
(paren
id|arlan-&gt;txAttenuation
comma
id|conf-&gt;txAttenuation
comma
id|u_char
)paren
suffix:semicolon
id|WRITESHM
c_func
(paren
id|arlan-&gt;systemId
comma
id|conf-&gt;systemId
comma
id|u_int
)paren
suffix:semicolon
id|WRITESHM
c_func
(paren
id|arlan-&gt;maxRetries
comma
id|conf-&gt;maxRetries
comma
id|u_char
)paren
suffix:semicolon
id|WRITESHM
c_func
(paren
id|arlan-&gt;receiveMode
comma
id|conf-&gt;receiveMode
comma
id|u_char
)paren
suffix:semicolon
id|WRITESHM
c_func
(paren
id|arlan-&gt;priority
comma
id|conf-&gt;priority
comma
id|u_char
)paren
suffix:semicolon
id|WRITESHM
c_func
(paren
id|arlan-&gt;rootOrRepeater
comma
id|conf-&gt;rootOrRepeater
comma
id|u_char
)paren
suffix:semicolon
id|WRITESHM
c_func
(paren
id|arlan-&gt;SID
comma
id|conf-&gt;SID
comma
id|u_int
)paren
suffix:semicolon
id|WRITESHM
c_func
(paren
id|arlan-&gt;registrationMode
comma
id|conf-&gt;registrationMode
comma
id|u_char
)paren
suffix:semicolon
id|WRITESHM
c_func
(paren
id|arlan-&gt;registrationFill
comma
id|conf-&gt;registrationFill
comma
id|u_char
)paren
suffix:semicolon
id|WRITESHM
c_func
(paren
id|arlan-&gt;localTalkAddress
comma
id|conf-&gt;localTalkAddress
comma
id|u_char
)paren
suffix:semicolon
id|WRITESHM
c_func
(paren
id|arlan-&gt;codeFormat
comma
id|conf-&gt;codeFormat
comma
id|u_char
)paren
suffix:semicolon
id|WRITESHM
c_func
(paren
id|arlan-&gt;numChannels
comma
id|conf-&gt;numChannels
comma
id|u_char
)paren
suffix:semicolon
id|WRITESHM
c_func
(paren
id|arlan-&gt;channel1
comma
id|conf-&gt;channel1
comma
id|u_char
)paren
suffix:semicolon
id|WRITESHM
c_func
(paren
id|arlan-&gt;channel2
comma
id|conf-&gt;channel2
comma
id|u_char
)paren
suffix:semicolon
id|WRITESHM
c_func
(paren
id|arlan-&gt;channel3
comma
id|conf-&gt;channel3
comma
id|u_char
)paren
suffix:semicolon
id|WRITESHM
c_func
(paren
id|arlan-&gt;channel4
comma
id|conf-&gt;channel4
comma
id|u_char
)paren
suffix:semicolon
id|WRITESHM
c_func
(paren
id|arlan-&gt;radioNodeId
comma
id|conf-&gt;radioNodeId
comma
id|u_short
)paren
suffix:semicolon
id|WRITESHM
c_func
(paren
id|arlan-&gt;SID
comma
id|conf-&gt;SID
comma
id|u_int
)paren
suffix:semicolon
id|WRITESHM
c_func
(paren
id|arlan-&gt;waitTime
comma
id|conf-&gt;waitTime
comma
id|u_short
)paren
suffix:semicolon
id|WRITESHM
c_func
(paren
id|arlan-&gt;lParameter
comma
id|conf-&gt;lParameter
comma
id|u_short
)paren
suffix:semicolon
id|memcpy_toio
c_func
(paren
op_amp
(paren
id|arlan-&gt;_15
)paren
comma
op_amp
(paren
id|conf-&gt;_15
)paren
comma
l_int|3
)paren
suffix:semicolon
id|WRITESHM
c_func
(paren
id|arlan-&gt;_15
comma
id|conf-&gt;_15
comma
id|u_short
)paren
suffix:semicolon
id|WRITESHM
c_func
(paren
id|arlan-&gt;headerSize
comma
id|conf-&gt;headerSize
comma
id|u_short
)paren
suffix:semicolon
r_if
c_cond
(paren
id|arlan_EEPROM_bad
)paren
id|WRITESHM
c_func
(paren
id|arlan-&gt;hardwareType
comma
id|conf-&gt;hardwareType
comma
id|u_char
)paren
suffix:semicolon
id|WRITESHM
c_func
(paren
id|arlan-&gt;radioType
comma
id|conf-&gt;radioType
comma
id|u_char
)paren
suffix:semicolon
r_if
c_cond
(paren
id|arlan_EEPROM_bad
)paren
id|WRITESHM
c_func
(paren
id|arlan-&gt;radioModule
comma
id|conf-&gt;radioType
comma
id|u_char
)paren
suffix:semicolon
id|memcpy_toio
c_func
(paren
id|arlan-&gt;encryptionKey
op_plus
id|keyStart
comma
id|encryptionKey
comma
l_int|8
)paren
suffix:semicolon
id|memcpy_toio
c_func
(paren
id|arlan-&gt;name
comma
id|conf-&gt;siteName
comma
l_int|16
)paren
suffix:semicolon
id|WRITESHMB
c_func
(paren
id|arlan-&gt;commandByte
comma
id|ARLAN_COM_INT
op_or
id|ARLAN_COM_CONF
)paren
suffix:semicolon
multiline_comment|/* do configure */
id|memset_io
c_func
(paren
id|arlan-&gt;commandParameter
comma
l_int|0
comma
l_int|0xf
)paren
suffix:semicolon
multiline_comment|/* 0xf */
id|memset_io
c_func
(paren
id|arlan-&gt;commandParameter
op_plus
l_int|1
comma
l_int|0
comma
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|conf-&gt;writeEEPROM
)paren
(brace
id|memset_io
c_func
(paren
id|arlan-&gt;commandParameter
comma
id|conf-&gt;writeEEPROM
comma
l_int|1
)paren
suffix:semicolon
singleline_comment|//&t;&t;conf-&gt;writeEEPROM=0;
)brace
r_if
c_cond
(paren
id|conf-&gt;registrationMode
op_logical_and
id|conf-&gt;registrationInterrupts
)paren
id|memset_io
c_func
(paren
id|arlan-&gt;commandParameter
op_plus
l_int|3
comma
l_int|1
comma
l_int|1
)paren
suffix:semicolon
r_else
id|memset_io
c_func
(paren
id|arlan-&gt;commandParameter
op_plus
l_int|3
comma
l_int|0
comma
l_int|1
)paren
suffix:semicolon
id|priv-&gt;irq_test_done
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|conf-&gt;tx_queue_len
)paren
id|dev-&gt;tx_queue_len
op_assign
id|conf-&gt;tx_queue_len
suffix:semicolon
id|udelay
c_func
(paren
l_int|100
)paren
suffix:semicolon
id|ARLAN_DEBUG_EXIT
c_func
(paren
l_string|&quot;arlan_hw_config&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|arlan_read_card_configuration
r_static
r_int
id|arlan_read_card_configuration
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
id|u_char
id|tlx415
suffix:semicolon
r_volatile
r_struct
id|arlan_shmem
op_star
id|arlan
op_assign
(paren
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
)paren
op_member_access_from_pointer
id|card
suffix:semicolon
r_struct
id|arlan_conf_stru
op_star
id|conf
op_assign
(paren
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
)paren
op_member_access_from_pointer
id|Conf
suffix:semicolon
id|ARLAN_DEBUG_ENTRY
c_func
(paren
l_string|&quot;arlan_read_card_configuration&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|radioNodeId
op_eq
id|radioNodeIdUNKNOWN
)paren
(brace
id|READSHM
c_func
(paren
id|conf-&gt;radioNodeId
comma
id|arlan-&gt;radioNodeId
comma
id|u_short
)paren
suffix:semicolon
)brace
r_else
id|conf-&gt;radioNodeId
op_assign
id|radioNodeId
suffix:semicolon
r_if
c_cond
(paren
id|SID
op_eq
id|SIDUNKNOWN
)paren
(brace
id|READSHM
c_func
(paren
id|conf-&gt;SID
comma
id|arlan-&gt;SID
comma
id|u_int
)paren
suffix:semicolon
)brace
r_else
id|conf-&gt;SID
op_assign
id|SID
suffix:semicolon
r_if
c_cond
(paren
id|spreadingCode
op_eq
id|spreadingCodeUNKNOWN
)paren
(brace
id|READSHM
c_func
(paren
id|conf-&gt;spreadingCode
comma
id|arlan-&gt;spreadingCode
comma
id|u_char
)paren
suffix:semicolon
)brace
r_else
id|conf-&gt;spreadingCode
op_assign
id|spreadingCode
suffix:semicolon
r_if
c_cond
(paren
id|channelSet
op_eq
id|channelSetUNKNOWN
)paren
(brace
id|READSHM
c_func
(paren
id|conf-&gt;channelSet
comma
id|arlan-&gt;channelSet
comma
id|u_char
)paren
suffix:semicolon
)brace
r_else
id|conf-&gt;channelSet
op_assign
id|channelSet
suffix:semicolon
r_if
c_cond
(paren
id|channelNumber
op_eq
id|channelNumberUNKNOWN
)paren
(brace
id|READSHM
c_func
(paren
id|conf-&gt;channelNumber
comma
id|arlan-&gt;channelNumber
comma
id|u_char
)paren
suffix:semicolon
)brace
r_else
id|conf-&gt;channelNumber
op_assign
id|channelNumber
suffix:semicolon
id|READSHM
c_func
(paren
id|conf-&gt;scramblingDisable
comma
id|arlan-&gt;scramblingDisable
comma
id|u_char
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|conf-&gt;txAttenuation
comma
id|arlan-&gt;txAttenuation
comma
id|u_char
)paren
suffix:semicolon
r_if
c_cond
(paren
id|systemId
op_eq
id|systemIdUNKNOWN
)paren
(brace
id|READSHM
c_func
(paren
id|conf-&gt;systemId
comma
id|arlan-&gt;systemId
comma
id|u_int
)paren
suffix:semicolon
)brace
r_else
id|conf-&gt;systemId
op_assign
id|systemId
suffix:semicolon
id|READSHM
c_func
(paren
id|conf-&gt;maxDatagramSize
comma
id|arlan-&gt;maxDatagramSize
comma
id|u_short
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|conf-&gt;maxFrameSize
comma
id|arlan-&gt;maxFrameSize
comma
id|u_short
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|conf-&gt;maxRetries
comma
id|arlan-&gt;maxRetries
comma
id|u_char
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|conf-&gt;receiveMode
comma
id|arlan-&gt;receiveMode
comma
id|u_char
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|conf-&gt;priority
comma
id|arlan-&gt;priority
comma
id|u_char
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|conf-&gt;rootOrRepeater
comma
id|arlan-&gt;rootOrRepeater
comma
id|u_char
)paren
suffix:semicolon
r_if
c_cond
(paren
id|SID
op_eq
id|SIDUNKNOWN
)paren
(brace
id|READSHM
c_func
(paren
id|conf-&gt;SID
comma
id|arlan-&gt;SID
comma
id|u_int
)paren
suffix:semicolon
)brace
r_else
id|conf-&gt;SID
op_assign
id|SID
suffix:semicolon
r_if
c_cond
(paren
id|registrationMode
op_eq
id|registrationModeUNKNOWN
)paren
(brace
id|READSHM
c_func
(paren
id|conf-&gt;registrationMode
comma
id|arlan-&gt;registrationMode
comma
id|u_char
)paren
suffix:semicolon
)brace
r_else
id|conf-&gt;registrationMode
op_assign
id|registrationMode
suffix:semicolon
id|READSHM
c_func
(paren
id|conf-&gt;registrationFill
comma
id|arlan-&gt;registrationFill
comma
id|u_char
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|conf-&gt;localTalkAddress
comma
id|arlan-&gt;localTalkAddress
comma
id|u_char
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|conf-&gt;codeFormat
comma
id|arlan-&gt;codeFormat
comma
id|u_char
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|conf-&gt;numChannels
comma
id|arlan-&gt;numChannels
comma
id|u_char
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|conf-&gt;channel1
comma
id|arlan-&gt;channel1
comma
id|u_char
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|conf-&gt;channel2
comma
id|arlan-&gt;channel2
comma
id|u_char
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|conf-&gt;channel3
comma
id|arlan-&gt;channel3
comma
id|u_char
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|conf-&gt;channel4
comma
id|arlan-&gt;channel4
comma
id|u_char
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|conf-&gt;waitTime
comma
id|arlan-&gt;waitTime
comma
id|u_short
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|conf-&gt;lParameter
comma
id|arlan-&gt;lParameter
comma
id|u_short
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|conf-&gt;_15
comma
id|arlan-&gt;_15
comma
id|u_short
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|conf-&gt;headerSize
comma
id|arlan-&gt;headerSize
comma
id|u_short
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|conf-&gt;hardwareType
comma
id|arlan-&gt;hardwareType
comma
id|u_char
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|conf-&gt;radioType
comma
id|arlan-&gt;radioModule
comma
id|u_char
)paren
suffix:semicolon
r_if
c_cond
(paren
id|conf-&gt;radioType
op_eq
l_int|0
)paren
id|conf-&gt;radioType
op_assign
l_int|0xc
suffix:semicolon
id|WRITESHM
c_func
(paren
id|arlan-&gt;configStatus
comma
l_int|0xA5
comma
id|u_char
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|tlx415
comma
id|arlan-&gt;configStatus
comma
id|u_char
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tlx415
op_ne
l_int|0xA5
)paren
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;%s tlx415 chip &bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
id|conf-&gt;txClear
op_assign
l_int|0
suffix:semicolon
id|conf-&gt;txRetries
op_assign
l_int|1
suffix:semicolon
id|conf-&gt;txRouting
op_assign
l_int|1
suffix:semicolon
id|conf-&gt;txScrambled
op_assign
l_int|0
suffix:semicolon
id|conf-&gt;rxParameter
op_assign
l_int|1
suffix:semicolon
id|conf-&gt;txTimeoutMs
op_assign
l_int|4000
suffix:semicolon
id|conf-&gt;waitCardTimeout
op_assign
l_int|100000
suffix:semicolon
id|conf-&gt;receiveMode
op_assign
id|ARLAN_RCV_CLEAN
suffix:semicolon
id|memcpy_fromio
c_func
(paren
id|conf-&gt;siteName
comma
id|arlan-&gt;name
comma
l_int|16
)paren
suffix:semicolon
id|conf-&gt;siteName
(braket
l_int|16
)braket
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
id|conf-&gt;retries
op_assign
id|retries
suffix:semicolon
id|conf-&gt;tx_delay_ms
op_assign
id|tx_delay_ms
suffix:semicolon
id|conf-&gt;async
op_assign
id|async
suffix:semicolon
id|conf-&gt;ReTransmitPacketMaxSize
op_assign
l_int|200
suffix:semicolon
id|conf-&gt;waitReTransmitPacketMaxSize
op_assign
l_int|200
suffix:semicolon
id|conf-&gt;txAckTimeoutMs
op_assign
l_int|900
suffix:semicolon
id|conf-&gt;fastReTransCount
op_assign
l_int|3
suffix:semicolon
id|ARLAN_DEBUG_EXIT
c_func
(paren
l_string|&quot;arlan_read_card_configuration&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|lastFoundAt
r_static
r_int
id|lastFoundAt
op_assign
l_int|0xbe000
suffix:semicolon
multiline_comment|/*&n; * This is the real probe routine. Linux has a history of friendly device&n; * probes on the ISA bus. A good device probes avoids doing writes, and&n; * verifies that the correct device exists and functions.&n; */
DECL|function|arlan_check_fingerprint
r_static
r_int
id|__init
id|arlan_check_fingerprint
c_func
(paren
r_int
id|memaddr
)paren
(brace
r_static
r_char
id|probeText
(braket
)braket
op_assign
l_string|&quot;TELESYSTEM SLW INC.    ARLAN &bslash;0&quot;
suffix:semicolon
r_char
id|tempBuf
(braket
l_int|49
)braket
suffix:semicolon
r_volatile
r_struct
id|arlan_shmem
op_star
id|arlan
op_assign
(paren
r_struct
id|arlan_shmem
op_star
)paren
id|memaddr
suffix:semicolon
id|ARLAN_DEBUG_ENTRY
c_func
(paren
l_string|&quot;arlan_check_fingerprint&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|check_mem_region
c_func
(paren
id|virt_to_phys
c_func
(paren
(paren
r_void
op_star
)paren
id|memaddr
)paren
comma
l_int|0x2000
)paren
)paren
(brace
singleline_comment|// printk(KERN_WARNING &quot;arlan: memory region %lx excluded from probing &bslash;n&quot;,virt_to_phys((void*)memaddr));
r_return
op_minus
id|ENODEV
suffix:semicolon
)brace
suffix:semicolon
id|memcpy_fromio
c_func
(paren
id|tempBuf
comma
id|arlan-&gt;textRegion
comma
l_int|29
)paren
suffix:semicolon
id|tempBuf
(braket
l_int|30
)braket
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* check for card at this address */
r_if
c_cond
(paren
l_int|0
op_ne
id|strncmp
c_func
(paren
id|tempBuf
comma
id|probeText
comma
l_int|29
)paren
)paren
(brace
singleline_comment|// not &t;&t;release_mem_region(virt_to_phys((void*)memaddr),0x2000);
r_return
op_minus
id|ENODEV
suffix:semicolon
)brace
singleline_comment|//   printk(KERN_INFO &quot;arlan found at 0x%x &bslash;n&quot;,memaddr);
id|ARLAN_DEBUG_EXIT
c_func
(paren
l_string|&quot;arlan_check_fingerprint&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|arlan_probe_everywhere
r_int
id|__init
id|arlan_probe_everywhere
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_int
id|m
suffix:semicolon
r_int
id|probed
op_assign
l_int|0
suffix:semicolon
r_int
id|found
op_assign
l_int|0
suffix:semicolon
id|SET_MODULE_OWNER
c_func
(paren
id|dev
)paren
suffix:semicolon
id|ARLAN_DEBUG_ENTRY
c_func
(paren
l_string|&quot;arlan_probe_everywhere&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mem
op_ne
l_int|0
op_logical_and
id|numDevices
op_eq
l_int|1
)paren
multiline_comment|/* Check a single specified location. */
(brace
r_if
c_cond
(paren
id|arlan_probe_here
c_func
(paren
id|dev
comma
(paren
r_int
)paren
id|phys_to_virt
c_func
(paren
id|mem
)paren
)paren
op_eq
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
r_else
r_return
op_minus
id|ENODEV
suffix:semicolon
)brace
r_for
c_loop
(paren
id|m
op_assign
(paren
r_int
)paren
id|phys_to_virt
c_func
(paren
id|lastFoundAt
)paren
op_plus
l_int|0x2000
suffix:semicolon
id|m
op_le
(paren
r_int
)paren
id|phys_to_virt
c_func
(paren
l_int|0xDE000
)paren
suffix:semicolon
id|m
op_add_assign
l_int|0x2000
)paren
(brace
r_if
c_cond
(paren
id|arlan_probe_here
c_func
(paren
id|dev
comma
id|m
)paren
op_eq
l_int|0
)paren
(brace
id|found
op_increment
suffix:semicolon
id|lastFoundAt
op_assign
(paren
r_int
)paren
id|virt_to_phys
c_func
(paren
(paren
r_void
op_star
)paren
id|m
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|probed
op_increment
suffix:semicolon
)brace
r_if
c_cond
(paren
id|found
op_eq
l_int|0
op_logical_and
id|probed
op_ne
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|lastFoundAt
op_eq
l_int|0xbe000
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;arlan: No Arlan devices found &bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|ENODEV
suffix:semicolon
)brace
r_else
r_return
l_int|0
suffix:semicolon
id|ARLAN_DEBUG_EXIT
c_func
(paren
l_string|&quot;arlan_probe_everywhere&quot;
)paren
suffix:semicolon
r_return
op_minus
id|ENODEV
suffix:semicolon
)brace
DECL|function|arlan_find_devices
r_int
id|__init
id|arlan_find_devices
c_func
(paren
r_void
)paren
(brace
r_int
id|m
suffix:semicolon
r_int
id|found
op_assign
l_int|0
suffix:semicolon
id|ARLAN_DEBUG_ENTRY
c_func
(paren
l_string|&quot;arlan_find_devices&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mem
op_ne
l_int|0
op_logical_and
id|numDevices
op_eq
l_int|1
)paren
multiline_comment|/* Check a single specified location. */
r_return
l_int|1
suffix:semicolon
r_for
c_loop
(paren
id|m
op_assign
(paren
r_int
)paren
id|phys_to_virt
c_func
(paren
l_int|0xc0000
)paren
suffix:semicolon
id|m
op_le
(paren
r_int
)paren
id|phys_to_virt
c_func
(paren
l_int|0xDE000
)paren
suffix:semicolon
id|m
op_add_assign
l_int|0x2000
)paren
(brace
r_if
c_cond
(paren
id|arlan_check_fingerprint
c_func
(paren
id|m
)paren
op_eq
l_int|0
)paren
id|found
op_increment
suffix:semicolon
)brace
id|ARLAN_DEBUG_EXIT
c_func
(paren
l_string|&quot;arlan_find_devices&quot;
)paren
suffix:semicolon
r_return
id|found
suffix:semicolon
)brace
DECL|function|arlan_change_mtu
r_static
r_int
id|arlan_change_mtu
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_int
id|new_mtu
)paren
(brace
r_struct
id|arlan_conf_stru
op_star
id|conf
op_assign
(paren
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
)paren
op_member_access_from_pointer
id|Conf
suffix:semicolon
id|ARLAN_DEBUG_ENTRY
c_func
(paren
l_string|&quot;arlan_change_mtu&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|new_mtu
OL
l_int|68
)paren
op_logical_or
(paren
id|new_mtu
OG
l_int|2032
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|dev-&gt;mtu
op_assign
id|new_mtu
suffix:semicolon
r_if
c_cond
(paren
id|new_mtu
OL
l_int|256
)paren
id|new_mtu
op_assign
l_int|256
suffix:semicolon
multiline_comment|/* cards book suggests 1600 */
id|conf-&gt;maxDatagramSize
op_assign
id|new_mtu
suffix:semicolon
id|conf-&gt;maxFrameSize
op_assign
id|new_mtu
op_plus
l_int|48
suffix:semicolon
id|arlan_command
c_func
(paren
id|dev
comma
id|ARLAN_COMMAND_CLEAN_AND_CONF
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_NOTICE
l_string|&quot;%s mtu changed to %d &bslash;n&quot;
comma
id|dev-&gt;name
comma
id|new_mtu
)paren
suffix:semicolon
id|ARLAN_DEBUG_EXIT
c_func
(paren
l_string|&quot;arlan_change_mtu&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|arlan_mac_addr
r_static
r_int
id|arlan_mac_addr
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_void
op_star
id|p
)paren
(brace
r_struct
id|sockaddr
op_star
id|addr
op_assign
id|p
suffix:semicolon
id|ARLAN_DEBUG_ENTRY
c_func
(paren
l_string|&quot;arlan_mac_addr&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|netif_running
c_func
(paren
id|dev
)paren
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
id|memcpy
c_func
(paren
id|dev-&gt;dev_addr
comma
id|addr-&gt;sa_data
comma
id|dev-&gt;addr_len
)paren
suffix:semicolon
id|ARLAN_DEBUG_EXIT
c_func
(paren
l_string|&quot;arlan_mac_addr&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
id|__init
DECL|function|arlan_allocate_device
id|arlan_allocate_device
c_func
(paren
r_int
id|num
comma
r_struct
id|net_device
op_star
id|devs
)paren
(brace
r_struct
id|net_device
op_star
id|dev
suffix:semicolon
id|ARLAN_DEBUG_ENTRY
c_func
(paren
l_string|&quot;arlan_allocate_device&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|devs
)paren
id|dev
op_assign
id|init_etherdev
c_func
(paren
l_int|0
comma
r_sizeof
(paren
r_struct
id|arlan_private
)paren
)paren
suffix:semicolon
r_else
(brace
id|dev
op_assign
id|devs
suffix:semicolon
id|dev-&gt;priv
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|arlan_private
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
)brace
suffix:semicolon
r_if
c_cond
(paren
id|dev
op_eq
l_int|NULL
op_logical_or
id|dev-&gt;priv
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
id|KERN_CRIT
l_string|&quot;init_etherdev failed &quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|memset
c_func
(paren
id|dev-&gt;priv
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|arlan_private
)paren
)paren
suffix:semicolon
(paren
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
)paren
op_member_access_from_pointer
id|conf
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|arlan_shmem
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dev
op_eq
l_int|NULL
op_logical_or
id|dev-&gt;priv
op_eq
l_int|NULL
op_logical_or
(paren
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
)paren
op_member_access_from_pointer
id|conf
op_eq
l_int|NULL
)paren
(brace
r_return
l_int|0
suffix:semicolon
id|printk
c_func
(paren
id|KERN_CRIT
l_string|&quot; No memory at arlan_allocate_device &bslash;n&quot;
)paren
suffix:semicolon
)brace
multiline_comment|/* Fill in the &squot;dev&squot; fields. */
id|dev-&gt;base_addr
op_assign
l_int|0
suffix:semicolon
id|dev-&gt;mem_start
op_assign
l_int|0
suffix:semicolon
id|dev-&gt;mem_end
op_assign
l_int|0
suffix:semicolon
id|dev-&gt;mtu
op_assign
l_int|1500
suffix:semicolon
id|dev-&gt;flags
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* IFF_BROADCAST &amp; IFF_MULTICAST &amp; IFF_PROMISC; */
id|dev-&gt;irq
op_assign
l_int|0
suffix:semicolon
id|dev-&gt;dma
op_assign
l_int|0
suffix:semicolon
id|dev-&gt;tx_queue_len
op_assign
id|tx_queue_len
suffix:semicolon
id|ether_setup
c_func
(paren
id|dev
)paren
suffix:semicolon
id|dev-&gt;tx_queue_len
op_assign
id|tx_queue_len
suffix:semicolon
id|dev-&gt;open
op_assign
id|arlan_open
suffix:semicolon
id|dev-&gt;stop
op_assign
id|arlan_close
suffix:semicolon
id|dev-&gt;hard_start_xmit
op_assign
id|arlan_tx
suffix:semicolon
id|dev-&gt;get_stats
op_assign
id|arlan_statistics
suffix:semicolon
id|dev-&gt;set_multicast_list
op_assign
id|arlan_set_multicast
suffix:semicolon
id|dev-&gt;change_mtu
op_assign
id|arlan_change_mtu
suffix:semicolon
id|dev-&gt;set_mac_address
op_assign
id|arlan_mac_addr
suffix:semicolon
id|dev-&gt;tx_timeout
op_assign
id|arlan_tx_timeout
suffix:semicolon
id|dev-&gt;watchdog_timeo
op_assign
l_int|3
op_star
id|HZ
suffix:semicolon
(paren
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
)paren
op_member_access_from_pointer
id|irq_test_done
op_assign
l_int|0
suffix:semicolon
id|arlan_device
(braket
id|num
)braket
op_assign
id|dev
suffix:semicolon
(paren
(paren
r_struct
id|arlan_private
op_star
)paren
id|arlan_device
(braket
id|num
)braket
op_member_access_from_pointer
id|priv
)paren
op_member_access_from_pointer
id|Conf
op_assign
op_amp
(paren
id|arlan_conf
(braket
id|num
)braket
)paren
suffix:semicolon
(paren
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
)paren
op_member_access_from_pointer
id|Conf-&gt;pre_Command_Wait
op_assign
l_int|40
suffix:semicolon
(paren
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
)paren
op_member_access_from_pointer
id|Conf-&gt;rx_tweak1
op_assign
l_int|30
suffix:semicolon
(paren
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
)paren
op_member_access_from_pointer
id|Conf-&gt;rx_tweak2
op_assign
l_int|0
suffix:semicolon
id|ARLAN_DEBUG_EXIT
c_func
(paren
l_string|&quot;arlan_allocate_device&quot;
)paren
suffix:semicolon
r_return
(paren
r_int
)paren
id|dev
suffix:semicolon
)brace
DECL|function|arlan_probe_here
r_int
id|__init
id|arlan_probe_here
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_int
id|memaddr
)paren
(brace
r_volatile
r_struct
id|arlan_shmem
op_star
id|arlan
suffix:semicolon
id|ARLAN_DEBUG_ENTRY
c_func
(paren
l_string|&quot;arlan_probe_here&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|arlan_check_fingerprint
c_func
(paren
id|memaddr
)paren
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
id|printk
c_func
(paren
id|KERN_NOTICE
l_string|&quot;%s: Arlan found at %x, &bslash;n &quot;
comma
id|dev-&gt;name
comma
(paren
r_int
)paren
id|virt_to_phys
c_func
(paren
(paren
r_void
op_star
)paren
id|memaddr
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|arlan_allocate_device
c_func
(paren
id|arlans_found
comma
id|dev
)paren
)paren
r_return
op_minus
l_int|1
suffix:semicolon
(paren
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
)paren
op_member_access_from_pointer
id|card
op_assign
(paren
r_struct
id|arlan_shmem
op_star
)paren
id|memaddr
suffix:semicolon
id|arlan
op_assign
(paren
r_void
op_star
)paren
id|memaddr
suffix:semicolon
id|dev-&gt;mem_start
op_assign
id|memaddr
suffix:semicolon
id|dev-&gt;mem_end
op_assign
id|memaddr
op_plus
l_int|0x1FFF
suffix:semicolon
r_if
c_cond
(paren
id|dev-&gt;irq
OL
l_int|2
)paren
(brace
id|READSHM
c_func
(paren
id|dev-&gt;irq
comma
id|arlan-&gt;irqLevel
comma
id|u_char
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|dev-&gt;irq
op_eq
l_int|2
)paren
id|dev-&gt;irq
op_assign
l_int|9
suffix:semicolon
id|arlan_read_card_configuration
c_func
(paren
id|dev
)paren
suffix:semicolon
id|ARLAN_DEBUG_EXIT
c_func
(paren
l_string|&quot;arlan_probe_here&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|arlan_open
r_static
r_int
id|arlan_open
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|arlan_private
op_star
id|priv
op_assign
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_volatile
r_struct
id|arlan_shmem
op_star
id|arlan
op_assign
id|priv-&gt;card
suffix:semicolon
r_int
id|ret
op_assign
l_int|0
suffix:semicolon
id|ARLAN_DEBUG_ENTRY
c_func
(paren
l_string|&quot;arlan_open&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dev-&gt;mem_start
op_eq
l_int|0
)paren
id|ret
op_assign
id|arlan_probe_everywhere
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
op_ne
l_int|0
)paren
r_return
id|ret
suffix:semicolon
id|arlan
op_assign
(paren
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
)paren
op_member_access_from_pointer
id|card
suffix:semicolon
id|ret
op_assign
id|request_irq
c_func
(paren
id|dev-&gt;irq
comma
op_amp
id|arlan_interrupt
comma
l_int|0
comma
id|dev-&gt;name
comma
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s: unable to get IRQ %d .&bslash;n&quot;
comma
id|dev-&gt;name
comma
id|dev-&gt;irq
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
id|priv-&gt;bad
op_assign
l_int|0
suffix:semicolon
id|priv-&gt;lastReset
op_assign
l_int|0
suffix:semicolon
id|priv-&gt;reset
op_assign
l_int|0
suffix:semicolon
id|priv-&gt;open_time
op_assign
id|jiffies
suffix:semicolon
id|memcpy_fromio
c_func
(paren
id|dev-&gt;dev_addr
comma
id|arlan-&gt;lanCardNodeId
comma
l_int|6
)paren
suffix:semicolon
id|memset
c_func
(paren
id|dev-&gt;broadcast
comma
l_int|0xff
comma
l_int|6
)paren
suffix:semicolon
id|priv-&gt;txOffset
op_assign
l_int|0
suffix:semicolon
id|dev-&gt;tx_queue_len
op_assign
id|tx_queue_len
suffix:semicolon
id|priv-&gt;interrupt_processing_active
op_assign
l_int|0
suffix:semicolon
id|priv-&gt;command_lock
op_assign
l_int|0
suffix:semicolon
id|netif_start_queue
(paren
id|dev
)paren
suffix:semicolon
id|init_MUTEX
c_func
(paren
op_amp
id|priv-&gt;card_lock
)paren
suffix:semicolon
id|myATOMIC_INIT
c_func
(paren
id|priv-&gt;card_users
comma
l_int|1
)paren
suffix:semicolon
multiline_comment|/* damn 2.0.33 */
id|priv-&gt;registrationLostCount
op_assign
l_int|0
suffix:semicolon
id|priv-&gt;registrationLastSeen
op_assign
id|jiffies
suffix:semicolon
id|priv-&gt;txLast
op_assign
l_int|0
suffix:semicolon
id|priv-&gt;tx_command_given
op_assign
l_int|0
suffix:semicolon
id|priv-&gt;rx_command_given
op_assign
l_int|0
suffix:semicolon
id|priv-&gt;reRegisterExp
op_assign
l_int|1
suffix:semicolon
id|priv-&gt;nof_tx
op_assign
l_int|0
suffix:semicolon
id|priv-&gt;nof_tx_ack
op_assign
l_int|0
suffix:semicolon
id|priv-&gt;last_command_was_rx
op_assign
l_int|0
suffix:semicolon
id|priv-&gt;tx_last_sent
op_assign
id|jiffies
op_minus
l_int|1
suffix:semicolon
id|priv-&gt;tx_last_cleared
op_assign
id|jiffies
suffix:semicolon
id|priv-&gt;Conf-&gt;writeEEPROM
op_assign
l_int|0
suffix:semicolon
id|priv-&gt;Conf-&gt;registrationInterrupts
op_assign
l_int|1
suffix:semicolon
id|init_timer
c_func
(paren
op_amp
id|priv-&gt;timer
)paren
suffix:semicolon
id|priv-&gt;timer.expires
op_assign
id|jiffies
op_plus
id|HZ
op_div
l_int|10
suffix:semicolon
id|priv-&gt;timer.data
op_assign
(paren
r_int
r_int
)paren
id|dev
suffix:semicolon
id|priv-&gt;timer.function
op_assign
op_amp
id|arlan_registration_timer
suffix:semicolon
multiline_comment|/* timer handler */
id|arlan_command
c_func
(paren
id|dev
comma
id|ARLAN_COMMAND_POWERUP
op_or
id|ARLAN_COMMAND_LONG_WAIT_NOW
)paren
suffix:semicolon
id|mdelay
c_func
(paren
l_int|200
)paren
suffix:semicolon
id|add_timer
c_func
(paren
op_amp
id|priv-&gt;timer
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_PROC_FS
macro_line|#ifndef MODULE
r_if
c_cond
(paren
id|arlan_device
(braket
l_int|0
)braket
)paren
id|init_arlan_proc
c_func
(paren
)paren
suffix:semicolon
macro_line|#endif
macro_line|#endif
id|ARLAN_DEBUG_EXIT
c_func
(paren
l_string|&quot;arlan_open&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|arlan_tx_timeout
r_static
r_void
id|arlan_tx_timeout
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s: arlan transmit timed out, kernel decided&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
multiline_comment|/* Try to restart the adaptor. */
id|arlan_command
c_func
(paren
id|dev
comma
id|ARLAN_COMMAND_CLEAN_AND_RESET
)paren
suffix:semicolon
singleline_comment|// dev-&gt;trans_start = jiffies;
singleline_comment|// netif_start_queue (dev);
)brace
DECL|function|arlan_tx
r_static
r_int
id|arlan_tx
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|arlan_private
op_star
id|priv
op_assign
(paren
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
)paren
suffix:semicolon
r_int
id|length
suffix:semicolon
r_int
r_char
op_star
id|buf
suffix:semicolon
id|ARLAN_DEBUG_ENTRY
c_func
(paren
l_string|&quot;arlan_tx&quot;
)paren
suffix:semicolon
id|length
op_assign
id|ETH_ZLEN
OL
id|skb-&gt;len
ques
c_cond
id|skb-&gt;len
suffix:colon
id|ETH_ZLEN
suffix:semicolon
id|buf
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
id|priv-&gt;txOffset
op_plus
id|length
op_plus
l_int|0x12
OG
l_int|0x800
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;TX RING overflow &bslash;n&quot;
)paren
suffix:semicolon
id|netif_stop_queue
(paren
id|dev
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|arlan_hw_tx
c_func
(paren
id|dev
comma
id|buf
comma
id|length
)paren
op_eq
op_minus
l_int|1
)paren
r_goto
id|bad_end
suffix:semicolon
id|dev-&gt;trans_start
op_assign
id|jiffies
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|arlan_process_interrupt
c_func
(paren
id|dev
)paren
suffix:semicolon
id|priv-&gt;tx_chain_active
op_assign
l_int|0
suffix:semicolon
id|ARLAN_DEBUG_EXIT
c_func
(paren
l_string|&quot;arlan_tx&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
id|bad_end
suffix:colon
id|arlan_process_interrupt
c_func
(paren
id|dev
)paren
suffix:semicolon
id|priv-&gt;tx_chain_active
op_assign
l_int|0
suffix:semicolon
id|netif_stop_queue
(paren
id|dev
)paren
suffix:semicolon
id|ARLAN_DEBUG_EXIT
c_func
(paren
l_string|&quot;arlan_tx&quot;
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|DoNotReTransmitCrap
r_extern
r_inline
r_int
id|DoNotReTransmitCrap
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|arlan_private
op_star
id|priv
op_assign
(paren
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
)paren
suffix:semicolon
r_if
c_cond
(paren
id|TXLAST
c_func
(paren
id|dev
)paren
dot
id|length
OL
id|priv-&gt;Conf-&gt;ReTransmitPacketMaxSize
)paren
r_return
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|DoNotWaitReTransmitCrap
r_extern
r_inline
r_int
id|DoNotWaitReTransmitCrap
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|arlan_private
op_star
id|priv
op_assign
(paren
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
)paren
suffix:semicolon
r_if
c_cond
(paren
id|TXLAST
c_func
(paren
id|dev
)paren
dot
id|length
OL
id|priv-&gt;Conf-&gt;waitReTransmitPacketMaxSize
)paren
r_return
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|arlan_queue_retransmit
r_extern
r_inline
r_void
id|arlan_queue_retransmit
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|arlan_private
op_star
id|priv
op_assign
(paren
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
)paren
suffix:semicolon
id|ARLAN_DEBUG_ENTRY
c_func
(paren
l_string|&quot;arlan_queue_retransmit&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|DoNotWaitReTransmitCrap
c_func
(paren
id|dev
)paren
)paren
(brace
id|arlan_drop_tx
c_func
(paren
id|dev
)paren
suffix:semicolon
)brace
r_else
id|priv-&gt;ReTransmitRequested
op_increment
suffix:semicolon
id|ARLAN_DEBUG_EXIT
c_func
(paren
l_string|&quot;arlan_queue_retransmit&quot;
)paren
suffix:semicolon
)brace
suffix:semicolon
DECL|function|RetryOrFail
r_extern
r_inline
r_void
id|RetryOrFail
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|arlan_private
op_star
id|priv
op_assign
(paren
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
)paren
suffix:semicolon
id|ARLAN_DEBUG_ENTRY
c_func
(paren
l_string|&quot;RetryOrFail&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|priv-&gt;retransmissions
OG
id|priv-&gt;Conf-&gt;retries
op_logical_or
id|DoNotReTransmitCrap
c_func
(paren
id|dev
)paren
)paren
(brace
id|arlan_drop_tx
c_func
(paren
id|dev
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|priv-&gt;bad
op_le
id|priv-&gt;Conf-&gt;fastReTransCount
)paren
(brace
id|arlan_retransmit_now
c_func
(paren
id|dev
)paren
suffix:semicolon
)brace
r_else
id|arlan_queue_retransmit
c_func
(paren
id|dev
)paren
suffix:semicolon
id|ARLAN_DEBUG_EXIT
c_func
(paren
l_string|&quot;RetryOrFail&quot;
)paren
suffix:semicolon
)brace
DECL|function|arlan_tx_done_interrupt
r_static
r_void
id|arlan_tx_done_interrupt
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_int
id|status
)paren
(brace
r_struct
id|arlan_private
op_star
id|priv
op_assign
(paren
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
)paren
suffix:semicolon
id|ARLAN_DEBUG_ENTRY
c_func
(paren
l_string|&quot;arlan_tx_done_interrupt&quot;
)paren
suffix:semicolon
id|priv-&gt;tx_last_cleared
op_assign
id|jiffies
suffix:semicolon
id|priv-&gt;tx_command_given
op_assign
l_int|0
suffix:semicolon
id|priv-&gt;nof_tx_ack
op_increment
suffix:semicolon
r_switch
c_cond
(paren
id|status
)paren
(brace
r_case
l_int|1
suffix:colon
(brace
id|IFDEBUG
c_func
(paren
id|ARLAN_DEBUG_TX_CHAIN
)paren
id|printk
c_func
(paren
l_string|&quot;arlan intr: transmit OK&bslash;n&quot;
)paren
suffix:semicolon
id|priv-&gt;stats.tx_packets
op_increment
suffix:semicolon
id|priv-&gt;bad
op_assign
l_int|0
suffix:semicolon
id|priv-&gt;reset
op_assign
l_int|0
suffix:semicolon
id|priv-&gt;retransmissions
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|priv-&gt;Conf-&gt;tx_delay_ms
)paren
(brace
id|priv-&gt;tx_done_delayed
op_assign
id|jiffies
op_plus
(paren
id|priv-&gt;Conf-&gt;tx_delay_ms
op_star
id|HZ
)paren
op_div
l_int|1000
op_plus
l_int|1
suffix:semicolon
suffix:semicolon
)brace
r_else
(brace
id|TXLAST
c_func
(paren
id|dev
)paren
dot
id|offset
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|priv-&gt;txLast
)paren
id|priv-&gt;txLast
op_assign
l_int|0
suffix:semicolon
r_else
r_if
c_cond
(paren
id|TXTAIL
c_func
(paren
id|dev
)paren
dot
id|offset
)paren
id|priv-&gt;txLast
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|TXLAST
c_func
(paren
id|dev
)paren
dot
id|offset
)paren
(brace
id|arlan_retransmit_now
c_func
(paren
id|dev
)paren
suffix:semicolon
id|dev-&gt;trans_start
op_assign
id|jiffies
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|TXHEAD
c_func
(paren
id|dev
)paren
dot
id|offset
op_logical_or
op_logical_neg
id|TXTAIL
c_func
(paren
id|dev
)paren
dot
id|offset
)paren
(brace
id|priv-&gt;txOffset
op_assign
l_int|0
suffix:semicolon
id|netif_wake_queue
(paren
id|dev
)paren
suffix:semicolon
)brace
)brace
)brace
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
(brace
id|IFDEBUG
c_func
(paren
id|ARLAN_DEBUG_TX_CHAIN
)paren
id|printk
c_func
(paren
l_string|&quot;arlan intr: transmit timed out&bslash;n&quot;
)paren
suffix:semicolon
id|priv-&gt;bad
op_add_assign
l_int|1
suffix:semicolon
singleline_comment|//arlan_queue_retransmit(dev);
id|RetryOrFail
c_func
(paren
id|dev
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
(brace
id|IFDEBUG
c_func
(paren
id|ARLAN_DEBUG_TX_CHAIN
)paren
id|printk
c_func
(paren
l_string|&quot;arlan intr: transmit max retries&bslash;n&quot;
)paren
suffix:semicolon
id|priv-&gt;bad
op_add_assign
l_int|1
suffix:semicolon
id|priv-&gt;reset
op_assign
l_int|0
suffix:semicolon
singleline_comment|//arlan_queue_retransmit(dev);
id|RetryOrFail
c_func
(paren
id|dev
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
(brace
id|IFDEBUG
c_func
(paren
id|ARLAN_DEBUG_TX_CHAIN
)paren
id|printk
c_func
(paren
l_string|&quot;arlan intr: transmit aborted&bslash;n&quot;
)paren
suffix:semicolon
id|priv-&gt;bad
op_add_assign
l_int|1
suffix:semicolon
id|arlan_queue_retransmit
c_func
(paren
id|dev
)paren
suffix:semicolon
singleline_comment|//RetryOrFail(dev);
)brace
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
(brace
id|IFDEBUG
c_func
(paren
id|ARLAN_DEBUG_TX_CHAIN
)paren
id|printk
c_func
(paren
l_string|&quot;arlan intr: transmit not registered&bslash;n&quot;
)paren
suffix:semicolon
id|priv-&gt;bad
op_add_assign
l_int|1
suffix:semicolon
singleline_comment|//debug=101;
id|arlan_queue_retransmit
c_func
(paren
id|dev
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
l_int|6
suffix:colon
(brace
id|IFDEBUG
c_func
(paren
id|ARLAN_DEBUG_TX_CHAIN
)paren
id|printk
c_func
(paren
l_string|&quot;arlan intr: transmit destination full&bslash;n&quot;
)paren
suffix:semicolon
id|priv-&gt;bad
op_add_assign
l_int|1
suffix:semicolon
id|priv-&gt;reset
op_assign
l_int|0
suffix:semicolon
singleline_comment|//arlan_drop_tx(dev);
id|arlan_queue_retransmit
c_func
(paren
id|dev
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
l_int|7
suffix:colon
(brace
id|IFDEBUG
c_func
(paren
id|ARLAN_DEBUG_TX_CHAIN
)paren
id|printk
c_func
(paren
l_string|&quot;arlan intr: transmit unknown ack&bslash;n&quot;
)paren
suffix:semicolon
id|priv-&gt;bad
op_add_assign
l_int|1
suffix:semicolon
id|priv-&gt;reset
op_assign
l_int|0
suffix:semicolon
id|arlan_queue_retransmit
c_func
(paren
id|dev
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
l_int|8
suffix:colon
(brace
id|IFDEBUG
c_func
(paren
id|ARLAN_DEBUG_TX_CHAIN
)paren
id|printk
c_func
(paren
l_string|&quot;arlan intr: transmit dest mail box full&bslash;n&quot;
)paren
suffix:semicolon
id|priv-&gt;bad
op_add_assign
l_int|1
suffix:semicolon
id|priv-&gt;reset
op_assign
l_int|0
suffix:semicolon
singleline_comment|//arlan_drop_tx(dev);
id|arlan_queue_retransmit
c_func
(paren
id|dev
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
l_int|9
suffix:colon
(brace
id|IFDEBUG
c_func
(paren
id|ARLAN_DEBUG_TX_CHAIN
)paren
id|printk
c_func
(paren
l_string|&quot;arlan intr: transmit root dest not reg.&bslash;n&quot;
)paren
suffix:semicolon
id|priv-&gt;bad
op_add_assign
l_int|1
suffix:semicolon
id|priv-&gt;reset
op_assign
l_int|1
suffix:semicolon
singleline_comment|//arlan_drop_tx(dev);
id|arlan_queue_retransmit
c_func
(paren
id|dev
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_default
suffix:colon
(brace
)brace
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;arlan intr: transmit status unknown&bslash;n&quot;
)paren
suffix:semicolon
id|priv-&gt;bad
op_add_assign
l_int|1
suffix:semicolon
id|priv-&gt;reset
op_assign
l_int|1
suffix:semicolon
id|arlan_drop_tx
c_func
(paren
id|dev
)paren
suffix:semicolon
)brace
)brace
id|ARLAN_DEBUG_EXIT
c_func
(paren
l_string|&quot;arlan_tx_done_interrupt&quot;
)paren
suffix:semicolon
)brace
DECL|function|arlan_rx_interrupt
r_static
r_void
id|arlan_rx_interrupt
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
id|u_char
id|rxStatus
comma
id|u_short
id|rxOffset
comma
id|u_short
id|pkt_len
)paren
(brace
r_char
op_star
id|skbtmp
suffix:semicolon
r_int
id|i
op_assign
l_int|0
suffix:semicolon
r_struct
id|arlan_private
op_star
id|priv
op_assign
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_volatile
r_struct
id|arlan_shmem
op_star
id|arlan
op_assign
id|priv-&gt;card
suffix:semicolon
r_struct
id|arlan_conf_stru
op_star
id|conf
op_assign
id|priv-&gt;Conf
suffix:semicolon
id|ARLAN_DEBUG_ENTRY
c_func
(paren
l_string|&quot;arlan_rx_interrupt&quot;
)paren
suffix:semicolon
singleline_comment|// by spec,   not                WRITESHMB(arlan-&gt;rxStatus,0x00);
singleline_comment|// prohibited here              arlan_command(dev, ARLAN_COMMAND_RX);
r_if
c_cond
(paren
id|pkt_len
template_param
l_int|2048
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;%s: got too short or long packet, len %d &bslash;n&quot;
comma
id|dev-&gt;name
comma
id|pkt_len
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|rxOffset
op_plus
id|pkt_len
OG
l_int|0x2000
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: got too long packet, len %d offset %x&bslash;n&quot;
comma
id|dev-&gt;name
comma
id|pkt_len
comma
id|rxOffset
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|priv-&gt;in_bytes
op_add_assign
id|pkt_len
suffix:semicolon
id|priv-&gt;in_bytes10
op_add_assign
id|pkt_len
suffix:semicolon
r_if
c_cond
(paren
id|conf-&gt;measure_rate
OL
l_int|1
)paren
id|conf-&gt;measure_rate
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|jiffies
op_minus
id|priv-&gt;in_time
OG
id|conf-&gt;measure_rate
op_star
id|HZ
)paren
(brace
id|conf-&gt;in_speed
op_assign
id|priv-&gt;in_bytes
op_div
id|conf-&gt;measure_rate
suffix:semicolon
id|priv-&gt;in_bytes
op_assign
l_int|0
suffix:semicolon
id|priv-&gt;in_time
op_assign
id|jiffies
suffix:semicolon
)brace
r_if
c_cond
(paren
id|jiffies
op_minus
id|priv-&gt;in_time10
OG
id|conf-&gt;measure_rate
op_star
id|HZ
op_star
l_int|10
)paren
(brace
id|conf-&gt;in_speed10
op_assign
id|priv-&gt;in_bytes10
op_div
(paren
l_int|10
op_star
id|conf-&gt;measure_rate
)paren
suffix:semicolon
id|priv-&gt;in_bytes10
op_assign
l_int|0
suffix:semicolon
id|priv-&gt;in_time10
op_assign
id|jiffies
suffix:semicolon
)brace
id|DEBUGSHM
c_func
(paren
l_int|1
comma
l_string|&quot;arlan rcv pkt rxStatus= %d &quot;
comma
id|arlan-&gt;rxStatus
comma
id|u_char
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|rxStatus
)paren
(brace
r_case
l_int|1
suffix:colon
r_case
l_int|2
suffix:colon
r_case
l_int|3
suffix:colon
(brace
multiline_comment|/* Malloc up new buffer. */
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|DEBUGSHM
c_func
(paren
l_int|50
comma
l_string|&quot;arlan recv pkt offs=%d&bslash;n&quot;
comma
id|arlan-&gt;rxOffset
comma
id|u_short
)paren
suffix:semicolon
id|DEBUGSHM
c_func
(paren
l_int|1
comma
l_string|&quot;arlan rxFrmType = %d &bslash;n&quot;
comma
id|arlan-&gt;rxFrmType
comma
id|u_char
)paren
suffix:semicolon
id|DEBUGSHM
c_func
(paren
l_int|1
comma
id|KERN_INFO
l_string|&quot;arlan rx scrambled = %d &bslash;n&quot;
comma
id|arlan-&gt;scrambled
comma
id|u_char
)paren
suffix:semicolon
multiline_comment|/* here we do multicast filtering to avoid slow 8-bit memcopy */
macro_line|#ifdef ARLAN_MULTICAST
r_if
c_cond
(paren
op_logical_neg
(paren
id|dev-&gt;flags
op_amp
id|IFF_ALLMULTI
)paren
op_logical_and
op_logical_neg
(paren
id|dev-&gt;flags
op_amp
id|IFF_PROMISC
)paren
op_logical_and
id|dev-&gt;mc_list
)paren
(brace
r_char
id|hw_dst_addr
(braket
l_int|6
)braket
suffix:semicolon
r_struct
id|dev_mc_list
op_star
id|dmi
op_assign
id|dev-&gt;mc_list
suffix:semicolon
r_int
id|i
suffix:semicolon
id|memcpy_fromio
c_func
(paren
id|hw_dst_addr
comma
id|arlan-&gt;ultimateDestAddress
comma
l_int|6
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hw_dst_addr
(braket
l_int|0
)braket
op_eq
l_int|0x01
)paren
(brace
r_if
c_cond
(paren
id|mdebug
)paren
r_if
c_cond
(paren
id|hw_dst_addr
(braket
l_int|1
)braket
op_eq
l_int|0x00
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s mcast 0x0100 &bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|hw_dst_addr
(braket
l_int|1
)braket
op_eq
l_int|0x40
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s m/bcast 0x0140 &bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
r_while
c_loop
(paren
id|dmi
)paren
(brace
r_if
c_cond
(paren
id|dmi-&gt;dmi_addrlen
op_eq
l_int|6
)paren
(brace
r_if
c_cond
(paren
id|arlan_debug
op_amp
id|ARLAN_DEBUG_HEADER_DUMP
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s mcl %2x:%2x:%2x:%2x:%2x:%2x &bslash;n&quot;
comma
id|dev-&gt;name
comma
id|dmi-&gt;dmi_addr
(braket
l_int|0
)braket
comma
id|dmi-&gt;dmi_addr
(braket
l_int|1
)braket
comma
id|dmi-&gt;dmi_addr
(braket
l_int|2
)braket
comma
id|dmi-&gt;dmi_addr
(braket
l_int|3
)braket
comma
id|dmi-&gt;dmi_addr
(braket
l_int|4
)braket
comma
id|dmi-&gt;dmi_addr
(braket
l_int|5
)braket
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|6
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|dmi-&gt;dmi_addr
(braket
id|i
)braket
op_ne
id|hw_dst_addr
(braket
id|i
)braket
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|i
op_eq
l_int|6
)paren
r_break
suffix:semicolon
)brace
r_else
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s: invalid multicast address length given.&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
id|dmi
op_assign
id|dmi-&gt;next
suffix:semicolon
)brace
multiline_comment|/* we reach here if multicast filtering is on and packet &n;&t;&t;&t;&t;&t; * is multicast and not for receive */
r_goto
id|end_of_interupt
suffix:semicolon
)brace
)brace
macro_line|#endif&t;&t;&t;&t;
singleline_comment|// ARLAN_MULTICAST
multiline_comment|/* multicast filtering ends here */
id|pkt_len
op_add_assign
id|ARLAN_FAKE_HDR_LEN
suffix:semicolon
id|skb
op_assign
id|dev_alloc_skb
c_func
(paren
id|pkt_len
op_plus
l_int|4
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s: Memory squeeze, dropping packet.&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
id|priv-&gt;stats.rx_dropped
op_increment
suffix:semicolon
r_break
suffix:semicolon
)brace
id|skb_reserve
c_func
(paren
id|skb
comma
l_int|2
)paren
suffix:semicolon
id|skb-&gt;dev
op_assign
id|dev
suffix:semicolon
id|skbtmp
op_assign
id|skb_put
c_func
(paren
id|skb
comma
id|pkt_len
)paren
suffix:semicolon
id|memcpy_fromio
c_func
(paren
id|skbtmp
op_plus
id|ARLAN_FAKE_HDR_LEN
comma
(paren
(paren
r_char
op_star
)paren
id|arlan
)paren
op_plus
id|rxOffset
comma
id|pkt_len
op_minus
id|ARLAN_FAKE_HDR_LEN
)paren
suffix:semicolon
id|memcpy_fromio
c_func
(paren
id|skbtmp
comma
id|arlan-&gt;ultimateDestAddress
comma
l_int|6
)paren
suffix:semicolon
id|memcpy_fromio
c_func
(paren
id|skbtmp
op_plus
l_int|6
comma
id|arlan-&gt;rxSrc
comma
l_int|6
)paren
suffix:semicolon
id|WRITESHMB
c_func
(paren
id|arlan-&gt;rxStatus
comma
l_int|0x00
)paren
suffix:semicolon
id|arlan_command
c_func
(paren
id|dev
comma
id|ARLAN_COMMAND_RX
)paren
suffix:semicolon
id|IFDEBUG
c_func
(paren
id|ARLAN_DEBUG_HEADER_DUMP
)paren
(brace
r_char
id|immedDestAddress
(braket
l_int|6
)braket
suffix:semicolon
r_char
id|immedSrcAddress
(braket
l_int|6
)braket
suffix:semicolon
id|memcpy_fromio
c_func
(paren
id|immedDestAddress
comma
id|arlan-&gt;immedDestAddress
comma
l_int|6
)paren
suffix:semicolon
id|memcpy_fromio
c_func
(paren
id|immedSrcAddress
comma
id|arlan-&gt;immedSrcAddress
comma
l_int|6
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;%s t %2x:%2x:%2x:%2x:%2x:%2x f %2x:%2x:%2x:%2x:%2x:%2x imd %2x:%2x:%2x:%2x:%2x:%2x ims %2x:%2x:%2x:%2x:%2x:%2x&bslash;n&quot;
comma
id|dev-&gt;name
comma
(paren
r_int
r_char
)paren
id|skbtmp
(braket
l_int|0
)braket
comma
(paren
r_int
r_char
)paren
id|skbtmp
(braket
l_int|1
)braket
comma
(paren
r_int
r_char
)paren
id|skbtmp
(braket
l_int|2
)braket
comma
(paren
r_int
r_char
)paren
id|skbtmp
(braket
l_int|3
)braket
comma
(paren
r_int
r_char
)paren
id|skbtmp
(braket
l_int|4
)braket
comma
(paren
r_int
r_char
)paren
id|skbtmp
(braket
l_int|5
)braket
comma
(paren
r_int
r_char
)paren
id|skbtmp
(braket
l_int|6
)braket
comma
(paren
r_int
r_char
)paren
id|skbtmp
(braket
l_int|7
)braket
comma
(paren
r_int
r_char
)paren
id|skbtmp
(braket
l_int|8
)braket
comma
(paren
r_int
r_char
)paren
id|skbtmp
(braket
l_int|9
)braket
comma
(paren
r_int
r_char
)paren
id|skbtmp
(braket
l_int|10
)braket
comma
(paren
r_int
r_char
)paren
id|skbtmp
(braket
l_int|11
)braket
comma
id|immedDestAddress
(braket
l_int|0
)braket
comma
id|immedDestAddress
(braket
l_int|1
)braket
comma
id|immedDestAddress
(braket
l_int|2
)braket
comma
id|immedDestAddress
(braket
l_int|3
)braket
comma
id|immedDestAddress
(braket
l_int|4
)braket
comma
id|immedDestAddress
(braket
l_int|5
)braket
comma
id|immedSrcAddress
(braket
l_int|0
)braket
comma
id|immedSrcAddress
(braket
l_int|1
)braket
comma
id|immedSrcAddress
(braket
l_int|2
)braket
comma
id|immedSrcAddress
(braket
l_int|3
)braket
comma
id|immedSrcAddress
(braket
l_int|4
)braket
comma
id|immedSrcAddress
(braket
l_int|5
)braket
)paren
suffix:semicolon
)brace
id|skb-&gt;protocol
op_assign
id|eth_type_trans
c_func
(paren
id|skb
comma
id|dev
)paren
suffix:semicolon
id|IFDEBUG
c_func
(paren
id|ARLAN_DEBUG_HEADER_DUMP
)paren
r_if
c_cond
(paren
id|skb-&gt;protocol
op_ne
l_int|0x608
op_logical_and
id|skb-&gt;protocol
op_ne
l_int|0x8
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|22
suffix:semicolon
id|i
op_increment
)paren
id|printk
c_func
(paren
l_string|&quot;%02x:&quot;
comma
(paren
id|u_char
)paren
id|skbtmp
(braket
id|i
op_plus
l_int|12
)braket
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;arlan kernel pkt type trans %x &bslash;n&quot;
comma
id|skb-&gt;protocol
)paren
suffix:semicolon
)brace
id|netif_rx
c_func
(paren
id|skb
)paren
suffix:semicolon
id|priv-&gt;stats.rx_packets
op_increment
suffix:semicolon
)brace
r_break
suffix:semicolon
r_default
suffix:colon
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;arlan intr: recieved unknown status&bslash;n&quot;
)paren
suffix:semicolon
id|priv-&gt;stats.rx_crc_errors
op_increment
suffix:semicolon
r_break
suffix:semicolon
)brace
id|ARLAN_DEBUG_EXIT
c_func
(paren
l_string|&quot;arlan_rx_interrupt&quot;
)paren
suffix:semicolon
)brace
DECL|function|arlan_process_interrupt
r_static
r_void
id|arlan_process_interrupt
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|arlan_private
op_star
id|priv
op_assign
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_volatile
r_struct
id|arlan_shmem
op_star
id|arlan
op_assign
id|priv-&gt;card
suffix:semicolon
id|u_char
id|rxStatus
op_assign
id|READSHMB
c_func
(paren
id|arlan-&gt;rxStatus
)paren
suffix:semicolon
id|u_char
id|txStatus
op_assign
id|READSHMB
c_func
(paren
id|arlan-&gt;txStatus
)paren
suffix:semicolon
id|u_short
id|rxOffset
op_assign
id|READSHMS
c_func
(paren
id|arlan-&gt;rxOffset
)paren
suffix:semicolon
id|u_short
id|pkt_len
op_assign
id|READSHMS
c_func
(paren
id|arlan-&gt;rxLength
)paren
suffix:semicolon
r_int
id|interrupt_count
op_assign
l_int|0
suffix:semicolon
id|ARLAN_DEBUG_ENTRY
c_func
(paren
l_string|&quot;arlan_process_interrupt&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|test_and_set_bit
c_func
(paren
l_int|0
comma
(paren
r_void
op_star
)paren
op_amp
id|priv-&gt;interrupt_processing_active
)paren
)paren
(brace
r_if
c_cond
(paren
id|arlan_debug
op_amp
id|ARLAN_DEBUG_CHAIN_LOCKS
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;interrupt chain reentering &bslash;n&quot;
)paren
suffix:semicolon
r_goto
id|end_int_process
suffix:semicolon
)brace
r_while
c_loop
(paren
(paren
id|rxStatus
op_logical_or
id|txStatus
op_logical_or
id|priv-&gt;interrupt_ack_requested
)paren
op_logical_and
(paren
id|interrupt_count
OL
l_int|5
)paren
)paren
(brace
r_if
c_cond
(paren
id|rxStatus
)paren
id|priv-&gt;last_rx_int_ack_time
op_assign
id|arlan_time
c_func
(paren
)paren
suffix:semicolon
id|arlan_command
c_func
(paren
id|dev
comma
id|ARLAN_COMMAND_INT_ACK
)paren
suffix:semicolon
id|arlan_command
c_func
(paren
id|dev
comma
id|ARLAN_COMMAND_INT_ENABLE
)paren
suffix:semicolon
id|IFDEBUG
c_func
(paren
id|ARLAN_DEBUG_INTERRUPT
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s:  got IRQ rx %x tx %x comm %x rxOff %x rxLen %x &bslash;n&quot;
comma
id|dev-&gt;name
comma
id|rxStatus
comma
id|txStatus
comma
id|READSHMB
c_func
(paren
id|arlan-&gt;commandByte
)paren
comma
id|rxOffset
comma
id|pkt_len
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rxStatus
op_eq
l_int|0
op_logical_and
id|txStatus
op_eq
l_int|0
)paren
(brace
id|priv-&gt;last_command_was_rx
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|priv-&gt;irq_test_done
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|registrationBad
c_func
(paren
id|dev
)paren
)paren
id|IFDEBUG
c_func
(paren
id|ARLAN_DEBUG_INTERRUPT
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s unknown interrupt(nop? regLost ?) reason tx %d rx %d &quot;
comma
id|dev-&gt;name
comma
id|txStatus
comma
id|rxStatus
)paren
suffix:semicolon
)brace
r_else
(brace
id|IFDEBUG
c_func
(paren
id|ARLAN_DEBUG_INTERRUPT
)paren
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;%s irq $%d test OK &bslash;n&quot;
comma
id|dev-&gt;name
comma
id|dev-&gt;irq
)paren
suffix:semicolon
)brace
id|priv-&gt;interrupt_ack_requested
op_assign
l_int|0
suffix:semicolon
r_goto
id|ends
suffix:semicolon
)brace
r_if
c_cond
(paren
id|txStatus
op_ne
l_int|0
)paren
(brace
id|WRITESHMB
c_func
(paren
id|arlan-&gt;txStatus
comma
l_int|0x00
)paren
suffix:semicolon
id|arlan_tx_done_interrupt
c_func
(paren
id|dev
comma
id|txStatus
)paren
suffix:semicolon
r_goto
id|ends
suffix:semicolon
)brace
r_if
c_cond
(paren
id|rxStatus
op_eq
l_int|1
op_logical_or
id|rxStatus
op_eq
l_int|2
)paren
(brace
multiline_comment|/* a packet waiting */
id|arlan_rx_interrupt
c_func
(paren
id|dev
comma
id|rxStatus
comma
id|rxOffset
comma
id|pkt_len
)paren
suffix:semicolon
r_goto
id|ends
suffix:semicolon
)brace
r_if
c_cond
(paren
id|rxStatus
OG
l_int|2
op_logical_and
id|rxStatus
OL
l_int|0xff
)paren
(brace
id|priv-&gt;last_command_was_rx
op_assign
l_int|0
suffix:semicolon
id|WRITESHMB
c_func
(paren
id|arlan-&gt;rxStatus
comma
l_int|0x00
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;%s unknown rxStatus reason tx %d rx %d &quot;
comma
id|dev-&gt;name
comma
id|txStatus
comma
id|rxStatus
)paren
suffix:semicolon
r_goto
id|ends
suffix:semicolon
)brace
r_if
c_cond
(paren
id|rxStatus
op_eq
l_int|0xff
)paren
(brace
id|priv-&gt;last_command_was_rx
op_assign
l_int|0
suffix:semicolon
id|WRITESHMB
c_func
(paren
id|arlan-&gt;rxStatus
comma
l_int|0x00
)paren
suffix:semicolon
id|arlan_command
c_func
(paren
id|dev
comma
id|ARLAN_COMMAND_RX
)paren
suffix:semicolon
r_if
c_cond
(paren
id|registrationBad
c_func
(paren
id|dev
)paren
)paren
id|netif_device_detach
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|registrationBad
c_func
(paren
id|dev
)paren
)paren
(brace
id|priv-&gt;registrationLastSeen
op_assign
id|jiffies
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|netif_queue_stopped
c_func
(paren
id|dev
)paren
op_logical_and
op_logical_neg
id|priv-&gt;under_reset
op_logical_and
op_logical_neg
id|priv-&gt;under_config
)paren
id|netif_wake_queue
(paren
id|dev
)paren
suffix:semicolon
)brace
r_goto
id|ends
suffix:semicolon
)brace
id|ends
suffix:colon
id|arlan_command_process
c_func
(paren
id|dev
)paren
suffix:semicolon
id|rxStatus
op_assign
id|READSHMB
c_func
(paren
id|arlan-&gt;rxStatus
)paren
suffix:semicolon
id|txStatus
op_assign
id|READSHMB
c_func
(paren
id|arlan-&gt;txStatus
)paren
suffix:semicolon
id|rxOffset
op_assign
id|READSHMS
c_func
(paren
id|arlan-&gt;rxOffset
)paren
suffix:semicolon
id|pkt_len
op_assign
id|READSHMS
c_func
(paren
id|arlan-&gt;rxLength
)paren
suffix:semicolon
id|priv-&gt;irq_test_done
op_assign
l_int|1
suffix:semicolon
id|interrupt_count
op_increment
suffix:semicolon
)brace
id|priv-&gt;interrupt_processing_active
op_assign
l_int|0
suffix:semicolon
id|end_int_process
suffix:colon
id|arlan_command_process
c_func
(paren
id|dev
)paren
suffix:semicolon
id|ARLAN_DEBUG_EXIT
c_func
(paren
l_string|&quot;arlan_process_interrupt&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
DECL|function|arlan_interrupt
r_static
r_void
id|arlan_interrupt
c_func
(paren
r_int
id|irq
comma
r_void
op_star
id|dev_id
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
r_struct
id|net_device
op_star
id|dev
op_assign
id|dev_id
suffix:semicolon
r_struct
id|arlan_private
op_star
id|priv
op_assign
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_volatile
r_struct
id|arlan_shmem
op_star
id|arlan
op_assign
id|priv-&gt;card
suffix:semicolon
id|u_char
id|rxStatus
op_assign
id|READSHMB
c_func
(paren
id|arlan-&gt;rxStatus
)paren
suffix:semicolon
id|u_char
id|txStatus
op_assign
id|READSHMB
c_func
(paren
id|arlan-&gt;txStatus
)paren
suffix:semicolon
id|ARLAN_DEBUG_ENTRY
c_func
(paren
l_string|&quot;arlan_interrupt&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|rxStatus
op_logical_and
op_logical_neg
id|txStatus
)paren
id|priv-&gt;interrupt_ack_requested
op_increment
suffix:semicolon
id|arlan_process_interrupt
c_func
(paren
id|dev
)paren
suffix:semicolon
id|priv-&gt;irq_test_done
op_assign
l_int|1
suffix:semicolon
id|ARLAN_DEBUG_EXIT
c_func
(paren
l_string|&quot;arlan_interrupt&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
DECL|function|arlan_close
r_static
r_int
id|arlan_close
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|arlan_private
op_star
id|priv
op_assign
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dev
)paren
(brace
id|printk
c_func
(paren
id|KERN_CRIT
l_string|&quot;arlan: No Device&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|priv
op_assign
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|priv
)paren
(brace
id|printk
c_func
(paren
id|KERN_CRIT
l_string|&quot;arlan: No Device priv &bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|ARLAN_DEBUG_ENTRY
c_func
(paren
l_string|&quot;arlan_close&quot;
)paren
suffix:semicolon
id|del_timer
c_func
(paren
op_amp
id|priv-&gt;timer
)paren
suffix:semicolon
id|arlan_command
c_func
(paren
id|dev
comma
id|ARLAN_COMMAND_POWERDOWN
)paren
suffix:semicolon
id|IFDEBUG
c_func
(paren
id|ARLAN_DEBUG_STARTUP
)paren
id|printk
c_func
(paren
id|KERN_NOTICE
l_string|&quot;%s: Closing device&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
id|priv-&gt;open_time
op_assign
l_int|0
suffix:semicolon
id|netif_stop_queue
c_func
(paren
id|dev
)paren
suffix:semicolon
id|free_irq
c_func
(paren
id|dev-&gt;irq
comma
id|dev
)paren
suffix:semicolon
id|ARLAN_DEBUG_EXIT
c_func
(paren
l_string|&quot;arlan_close&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#ifdef ARLAN_DEBUGING
DECL|function|alignLong
r_static
r_int
id|alignLong
c_func
(paren
r_volatile
id|u_char
op_star
id|ptr
)paren
(brace
r_int
id|ret
suffix:semicolon
id|memcpy_fromio
c_func
(paren
op_amp
id|ret
comma
(paren
r_void
op_star
)paren
id|ptr
comma
l_int|4
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
macro_line|#endif
multiline_comment|/*&n; * Get the current statistics.&n; * This may be called with the card open or closed.&n; */
DECL|function|arlan_statistics
r_static
r_struct
id|net_device_stats
op_star
id|arlan_statistics
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_struct
id|arlan_private
op_star
id|priv
op_assign
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_volatile
r_struct
id|arlan_shmem
op_star
id|arlan
op_assign
(paren
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
)paren
op_member_access_from_pointer
id|card
suffix:semicolon
id|ARLAN_DEBUG_ENTRY
c_func
(paren
l_string|&quot;arlan_statistics&quot;
)paren
suffix:semicolon
multiline_comment|/* Update the statistics from the device registers. */
id|READSHM
c_func
(paren
id|priv-&gt;stats.collisions
comma
id|arlan-&gt;numReTransmissions
comma
id|u_int
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|priv-&gt;stats.rx_crc_errors
comma
id|arlan-&gt;numCRCErrors
comma
id|u_int
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|priv-&gt;stats.rx_dropped
comma
id|arlan-&gt;numFramesDiscarded
comma
id|u_int
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|priv-&gt;stats.rx_fifo_errors
comma
id|arlan-&gt;numRXBufferOverflows
comma
id|u_int
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|priv-&gt;stats.rx_frame_errors
comma
id|arlan-&gt;numReceiveFramesLost
comma
id|u_int
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|priv-&gt;stats.rx_over_errors
comma
id|arlan-&gt;numRXOverruns
comma
id|u_int
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|priv-&gt;stats.rx_packets
comma
id|arlan-&gt;numDatagramsReceived
comma
id|u_int
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|priv-&gt;stats.tx_aborted_errors
comma
id|arlan-&gt;numAbortErrors
comma
id|u_int
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|priv-&gt;stats.tx_carrier_errors
comma
id|arlan-&gt;numStatusTimeouts
comma
id|u_int
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|priv-&gt;stats.tx_dropped
comma
id|arlan-&gt;numDatagramsDiscarded
comma
id|u_int
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|priv-&gt;stats.tx_fifo_errors
comma
id|arlan-&gt;numTXUnderruns
comma
id|u_int
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|priv-&gt;stats.tx_packets
comma
id|arlan-&gt;numDatagramsTransmitted
comma
id|u_int
)paren
suffix:semicolon
id|READSHM
c_func
(paren
id|priv-&gt;stats.tx_window_errors
comma
id|arlan-&gt;numHoldOffs
comma
id|u_int
)paren
suffix:semicolon
id|ARLAN_DEBUG_EXIT
c_func
(paren
l_string|&quot;arlan_statistics&quot;
)paren
suffix:semicolon
r_return
op_amp
id|priv-&gt;stats
suffix:semicolon
)brace
DECL|function|arlan_set_multicast
r_static
r_void
id|arlan_set_multicast
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
r_volatile
r_struct
id|arlan_shmem
op_star
id|arlan
op_assign
(paren
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
)paren
op_member_access_from_pointer
id|card
suffix:semicolon
r_struct
id|arlan_conf_stru
op_star
id|conf
op_assign
(paren
(paren
r_struct
id|arlan_private
op_star
)paren
id|dev-&gt;priv
)paren
op_member_access_from_pointer
id|Conf
suffix:semicolon
r_int
id|board_conf_needed
op_assign
l_int|0
suffix:semicolon
id|ARLAN_DEBUG_ENTRY
c_func
(paren
l_string|&quot;arlan_set_multicast&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dev-&gt;flags
op_amp
id|IFF_PROMISC
)paren
(brace
r_int
r_char
id|recMode
suffix:semicolon
id|READSHM
c_func
(paren
id|recMode
comma
id|arlan-&gt;receiveMode
comma
id|u_char
)paren
suffix:semicolon
id|conf-&gt;receiveMode
op_assign
(paren
id|ARLAN_RCV_PROMISC
op_or
id|ARLAN_RCV_CONTROL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|conf-&gt;receiveMode
op_ne
id|recMode
)paren
id|board_conf_needed
op_assign
l_int|1
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* turn off promiscuous mode  */
r_int
r_char
id|recMode
suffix:semicolon
id|READSHM
c_func
(paren
id|recMode
comma
id|arlan-&gt;receiveMode
comma
id|u_char
)paren
suffix:semicolon
id|conf-&gt;receiveMode
op_assign
id|ARLAN_RCV_CLEAN
op_or
id|ARLAN_RCV_CONTROL
suffix:semicolon
r_if
c_cond
(paren
id|conf-&gt;receiveMode
op_ne
id|recMode
)paren
id|board_conf_needed
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|board_conf_needed
)paren
id|arlan_command
c_func
(paren
id|dev
comma
id|ARLAN_COMMAND_CONF
)paren
suffix:semicolon
id|ARLAN_DEBUG_EXIT
c_func
(paren
l_string|&quot;arlan_set_multicast&quot;
)paren
suffix:semicolon
)brace
DECL|function|arlan_probe
r_int
id|__init
id|arlan_probe
c_func
(paren
r_struct
id|net_device
op_star
id|dev
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;Arlan driver %s&bslash;n&quot;
comma
id|arlan_version
)paren
suffix:semicolon
r_if
c_cond
(paren
id|arlan_probe_everywhere
c_func
(paren
id|dev
)paren
)paren
r_return
op_minus
id|ENODEV
suffix:semicolon
id|arlans_found
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|arlans_found
op_eq
l_int|1
)paren
id|siteName
op_assign
id|kmalloc
c_func
(paren
l_int|100
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#ifdef  MODULE
DECL|function|init_module
r_int
id|init_module
c_func
(paren
r_void
)paren
(brace
r_int
id|i
op_assign
l_int|0
suffix:semicolon
id|ARLAN_DEBUG_ENTRY
c_func
(paren
l_string|&quot;init_module&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|channelSet
op_ne
id|channelSetUNKNOWN
op_logical_or
id|channelNumber
op_ne
id|channelNumberUNKNOWN
op_logical_or
id|systemId
op_ne
id|systemIdUNKNOWN
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;arlan: wrong module params for multiple devices&bslash;n &quot;
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
id|numDevices
op_assign
id|arlan_find_devices
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|numDevices
op_eq
l_int|0
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;arlan: no devices found &bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
id|siteName
op_assign
id|kmalloc
c_func
(paren
l_int|100
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|siteName
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;arlan: No memory for site name.&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|numDevices
op_logical_and
id|i
OL
id|MAX_ARLANS
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|arlan_allocate_device
c_func
(paren
id|i
comma
l_int|NULL
)paren
)paren
r_return
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|arlan_device
(braket
id|i
)braket
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
id|KERN_CRIT
l_string|&quot;arlan: Not Enough memory &bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|probe
)paren
id|arlan_probe_everywhere
c_func
(paren
id|arlan_device
(braket
id|i
)braket
)paren
suffix:semicolon
singleline_comment|//&t;&t;arlan_command(arlan_device[i], ARLAN_COMMAND_POWERDOWN );
)brace
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;Arlan driver %s&bslash;n&quot;
comma
id|arlan_version
)paren
suffix:semicolon
id|ARLAN_DEBUG_EXIT
c_func
(paren
l_string|&quot;init_module&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|cleanup_module
r_void
id|cleanup_module
c_func
(paren
r_void
)paren
(brace
r_int
id|i
op_assign
l_int|0
suffix:semicolon
id|ARLAN_DEBUG_ENTRY
c_func
(paren
l_string|&quot;cleanup_module&quot;
)paren
suffix:semicolon
id|IFDEBUG
c_func
(paren
id|ARLAN_DEBUG_SHUTDOWN
)paren
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;arlan: unloading module&bslash;n&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|MAX_ARLANS
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|arlan_device
(braket
id|i
)braket
)paren
(brace
id|arlan_command
c_func
(paren
id|arlan_device
(braket
id|i
)braket
comma
id|ARLAN_COMMAND_POWERDOWN
)paren
suffix:semicolon
singleline_comment|//&t;&t;&t;release_mem_region(virt_to_phys(arlan_device[i]-&gt;mem_start), 0x2000 );
id|unregister_netdev
c_func
(paren
id|arlan_device
(braket
id|i
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|arlan_device
(braket
id|i
)braket
op_member_access_from_pointer
id|priv
)paren
(brace
r_if
c_cond
(paren
(paren
(paren
r_struct
id|arlan_private
op_star
)paren
id|arlan_device
(braket
id|i
)braket
op_member_access_from_pointer
id|priv
)paren
op_member_access_from_pointer
id|conf
)paren
id|kfree
c_func
(paren
(paren
(paren
r_struct
id|arlan_private
op_star
)paren
id|arlan_device
(braket
id|i
)braket
op_member_access_from_pointer
id|priv
)paren
op_member_access_from_pointer
id|conf
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|arlan_device
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
id|arlan_device
(braket
id|i
)braket
op_assign
l_int|NULL
suffix:semicolon
)brace
)brace
id|ARLAN_DEBUG_EXIT
c_func
(paren
l_string|&quot;cleanup_module&quot;
)paren
suffix:semicolon
)brace
macro_line|#endif
eof
