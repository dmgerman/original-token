multiline_comment|/* apricot.c: An Apricot 82596 ethernet driver for linux. */
multiline_comment|/*&n;    Apricot&n;    &t;Written 1994 by Mark Evans.&n;&t;This driver is for the Apricot 82596 bus-master interface&n;    &n;    Driver skeleton &n;&t;Written 1993 by Donald Becker.&n;&t;Copyright 1993 United States Government as represented by the Director,&n;&t;National Security Agency.  This software may only be used and distributed&n;&t;according to the terms of the GNU Public License as modified by SRC,&n;&t;incorporated herein by reference.&n;&n;&t;The author may be reached as becker@super.org or&n;&t;C/O Supercomputing Research Ctr., 17100 Science Dr., Bowie MD 20715&n;    &n;&n;*/
DECL|variable|version
r_static
r_char
op_star
id|version
op_assign
l_string|&quot;apricot.c:v0.02 19/05/94&bslash;n&quot;
suffix:semicolon
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/ptrace.h&gt;
macro_line|#include &lt;linux/errno.h&gt;
macro_line|#include &lt;linux/ioport.h&gt;
macro_line|#include &lt;linux/malloc.h&gt;
macro_line|#include &lt;linux/interrupt.h&gt;
macro_line|#include &lt;asm/bitops.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;asm/dma.h&gt;
macro_line|#include &lt;linux/netdevice.h&gt;
macro_line|#include &lt;linux/etherdevice.h&gt;
macro_line|#include &lt;linux/skbuff.h&gt;
macro_line|#ifndef HAVE_PORTRESERVE
DECL|macro|check_region
mdefine_line|#define check_region(addr, size)&t;0
DECL|macro|snarf_region
mdefine_line|#define snarf_region(addr, size)&t;do ; while(0)
macro_line|#endif
macro_line|#ifndef HAVE_ALLOC_SKB
DECL|macro|alloc_skb
mdefine_line|#define alloc_skb(size, priority) (struct sk_buff *) kmalloc(size,priority)
DECL|macro|kfree_skbmem
mdefine_line|#define kfree_skbmem(buff, size) kfree_s(buff,size)
macro_line|#endif
r_struct
id|device
op_star
id|init_etherdev
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_int
id|sizeof_private
comma
r_int
r_int
op_star
id|mem_start
)paren
suffix:semicolon
DECL|macro|APRICOT_DEBUG
mdefine_line|#define APRICOT_DEBUG 1
macro_line|#ifdef APRICOT_DEBUG
DECL|variable|i596_debug
r_int
id|i596_debug
op_assign
id|APRICOT_DEBUG
suffix:semicolon
macro_line|#else
DECL|variable|i596_debug
r_int
id|i596_debug
op_assign
l_int|1
suffix:semicolon
macro_line|#endif
DECL|macro|APRICOT_TOTAL_SIZE
mdefine_line|#define APRICOT_TOTAL_SIZE 17
DECL|macro|CMD_EOL
mdefine_line|#define CMD_EOL&t;&t;0x8000&t;/* The last command of the list, stop. */
DECL|macro|CMD_SUSP
mdefine_line|#define CMD_SUSP&t;0x4000&t;/* Suspend after doing cmd. */
DECL|macro|CMD_INTR
mdefine_line|#define CMD_INTR&t;0x2000&t;/* Interrupt after doing cmd. */
DECL|macro|CMD_FLEX
mdefine_line|#define CMD_FLEX&t;0x0008&t;/* Enable flexible memory model */
DECL|enum|commands
r_enum
id|commands
(brace
DECL|enumerator|CmdNOp
DECL|enumerator|CmdSASetup
DECL|enumerator|CmdConfigure
DECL|enumerator|CmdMulticastList
id|CmdNOp
op_assign
l_int|0
comma
id|CmdSASetup
op_assign
l_int|1
comma
id|CmdConfigure
op_assign
l_int|2
comma
id|CmdMulticastList
op_assign
l_int|3
comma
DECL|enumerator|CmdTx
DECL|enumerator|CmdTDR
DECL|enumerator|CmdDump
DECL|enumerator|CmdDiagnose
id|CmdTx
op_assign
l_int|4
comma
id|CmdTDR
op_assign
l_int|5
comma
id|CmdDump
op_assign
l_int|6
comma
id|CmdDiagnose
op_assign
l_int|7
)brace
suffix:semicolon
DECL|macro|STAT_C
mdefine_line|#define STAT_C&t;&t;0x8000&t;/* Set to 0 after execution */
DECL|macro|STAT_B
mdefine_line|#define STAT_B&t;&t;0x4000&t;/* Command being executed */
DECL|macro|STAT_OK
mdefine_line|#define STAT_OK&t;&t;0x2000&t;/* Command executed ok */
DECL|macro|STAT_A
mdefine_line|#define STAT_A&t;&t;0x1000&t;/* Command aborted */
DECL|macro|CUC_START
mdefine_line|#define&t; CUC_START&t;0x0100
DECL|macro|CUC_RESUME
mdefine_line|#define&t; CUC_RESUME&t;0x0200
DECL|macro|CUC_SUSPEND
mdefine_line|#define&t; CUC_SUSPEND    0x0300
DECL|macro|CUC_ABORT
mdefine_line|#define&t; CUC_ABORT&t;0x0400
DECL|macro|RX_START
mdefine_line|#define&t; RX_START&t;0x0010
DECL|macro|RX_RESUME
mdefine_line|#define&t; RX_RESUME&t;0x0020
DECL|macro|RX_SUSPEND
mdefine_line|#define&t; RX_SUSPEND&t;0x0030
DECL|macro|RX_ABORT
mdefine_line|#define&t; RX_ABORT&t;0x0040
DECL|struct|i596_cmd
r_struct
id|i596_cmd
(brace
DECL|member|status
r_int
r_int
id|status
suffix:semicolon
DECL|member|command
r_int
r_int
id|command
suffix:semicolon
DECL|member|next
r_struct
id|i596_cmd
op_star
id|next
suffix:semicolon
)brace
suffix:semicolon
DECL|macro|EOF
mdefine_line|#define EOF&t;&t;0x8000
DECL|macro|SIZE_MASK
mdefine_line|#define SIZE_MASK&t;0x3fff
DECL|struct|i596_tbd
r_struct
id|i596_tbd
(brace
DECL|member|size
r_int
r_int
id|size
suffix:semicolon
DECL|member|pad
r_int
r_int
id|pad
suffix:semicolon
DECL|member|next
r_struct
id|i596_tbd
op_star
id|next
suffix:semicolon
DECL|member|data
r_char
op_star
id|data
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|tx_cmd
r_struct
id|tx_cmd
(brace
DECL|member|cmd
r_struct
id|i596_cmd
id|cmd
suffix:semicolon
DECL|member|tbd
r_struct
id|i596_tbd
op_star
id|tbd
suffix:semicolon
DECL|member|size
r_int
r_int
id|size
suffix:semicolon
DECL|member|pad
r_int
r_int
id|pad
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|i596_rfd
r_struct
id|i596_rfd
(brace
DECL|member|stat
r_int
r_int
id|stat
suffix:semicolon
DECL|member|cmd
r_int
r_int
id|cmd
suffix:semicolon
DECL|member|next
r_struct
id|i596_rfd
op_star
id|next
suffix:semicolon
DECL|member|rbd
r_int
id|rbd
suffix:semicolon
DECL|member|count
r_int
r_int
id|count
suffix:semicolon
DECL|member|size
r_int
r_int
id|size
suffix:semicolon
DECL|member|data
r_char
id|data
(braket
l_int|1532
)braket
suffix:semicolon
)brace
suffix:semicolon
DECL|macro|RX_RING_SIZE
mdefine_line|#define RX_RING_SIZE 16
DECL|struct|i596_scb
r_struct
id|i596_scb
(brace
DECL|member|status
r_int
r_int
id|status
suffix:semicolon
DECL|member|command
r_int
r_int
id|command
suffix:semicolon
DECL|member|cmd
r_struct
id|i596_cmd
op_star
id|cmd
suffix:semicolon
DECL|member|rfd
r_struct
id|i596_rfd
op_star
id|rfd
suffix:semicolon
DECL|member|crc_err
r_int
r_int
id|crc_err
suffix:semicolon
DECL|member|align_err
r_int
r_int
id|align_err
suffix:semicolon
DECL|member|resource_err
r_int
r_int
id|resource_err
suffix:semicolon
DECL|member|over_err
r_int
r_int
id|over_err
suffix:semicolon
DECL|member|rcvdt_err
r_int
r_int
id|rcvdt_err
suffix:semicolon
DECL|member|short_err
r_int
r_int
id|short_err
suffix:semicolon
DECL|member|t_on
r_int
r_int
id|t_on
suffix:semicolon
DECL|member|t_off
r_int
r_int
id|t_off
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|i596_iscp
r_struct
id|i596_iscp
(brace
DECL|member|stat
r_int
r_int
id|stat
suffix:semicolon
DECL|member|scb
r_struct
id|i596_scb
op_star
id|scb
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|i596_scp
r_struct
id|i596_scp
(brace
DECL|member|sysbus
r_int
r_int
id|sysbus
suffix:semicolon
DECL|member|pad
r_int
r_int
id|pad
suffix:semicolon
DECL|member|iscp
r_struct
id|i596_iscp
op_star
id|iscp
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|i596_private
r_struct
id|i596_private
(brace
DECL|member|scp
r_struct
id|i596_scp
id|scp
suffix:semicolon
DECL|member|iscp
r_struct
id|i596_iscp
id|iscp
suffix:semicolon
DECL|member|scb
r_struct
id|i596_scb
id|scb
suffix:semicolon
DECL|member|set_add
r_struct
id|i596_cmd
id|set_add
suffix:semicolon
DECL|member|eth_addr
r_char
id|eth_addr
(braket
l_int|8
)braket
suffix:semicolon
DECL|member|set_conf
r_struct
id|i596_cmd
id|set_conf
suffix:semicolon
DECL|member|i596_config
r_char
id|i596_config
(braket
l_int|16
)braket
suffix:semicolon
DECL|member|tdr
r_struct
id|i596_cmd
id|tdr
suffix:semicolon
DECL|member|stat
r_int
r_int
id|stat
suffix:semicolon
DECL|member|rx
r_struct
id|i596_rfd
id|rx
(braket
id|RX_RING_SIZE
)braket
suffix:semicolon
DECL|member|last_restart
r_int
id|last_restart
suffix:semicolon
DECL|member|rx_tail
r_struct
id|i596_rfd
op_star
id|rx_tail
suffix:semicolon
DECL|member|cmd_tail
r_struct
id|i596_cmd
op_star
id|cmd_tail
suffix:semicolon
DECL|member|cmd_head
r_struct
id|i596_cmd
op_star
id|cmd_head
suffix:semicolon
DECL|member|cmd_backlog
r_int
id|cmd_backlog
suffix:semicolon
DECL|member|last_cmd
r_int
r_int
id|last_cmd
suffix:semicolon
DECL|member|stats
r_struct
id|enet_statistics
id|stats
suffix:semicolon
)brace
suffix:semicolon
DECL|variable|init_setup
r_char
id|init_setup
(braket
)braket
op_assign
(brace
l_int|0x8E
comma
multiline_comment|/* length, prefetch on */
l_int|0xC8
comma
multiline_comment|/* fifo to 8, monitor off */
l_int|0x80
comma
multiline_comment|/* don&squot;t save bad frames */
l_int|0x2E
comma
multiline_comment|/* No source address insertion, 8 byte preamble */
l_int|0x00
comma
multiline_comment|/* priority and backoff defaults */
l_int|0x60
comma
multiline_comment|/* interframe spacing */
l_int|0x00
comma
multiline_comment|/* slot time LSB */
l_int|0xf2
comma
multiline_comment|/* slot time and retries */
l_int|0x00
comma
multiline_comment|/* promiscuous mode */
l_int|0x00
comma
multiline_comment|/* collision detect */
l_int|0x40
comma
multiline_comment|/* minimum frame length */
l_int|0xff
comma
l_int|0x00
comma
l_int|0x7f
multiline_comment|/*  *multi IA */
)brace
suffix:semicolon
DECL|variable|adds
r_char
id|adds
(braket
)braket
op_assign
(brace
l_int|0x00
comma
l_int|0x00
comma
l_int|0x49
comma
l_int|0x20
comma
l_int|0x54
comma
l_int|0xDA
comma
l_int|0x80
comma
l_int|0x00
comma
l_int|0x4e
comma
l_int|0x02
comma
l_int|0xb7
comma
l_int|0xb8
)brace
suffix:semicolon
r_static
r_int
id|i596_open
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
suffix:semicolon
r_static
r_int
id|i596_start_xmit
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|device
op_star
id|dev
)paren
suffix:semicolon
r_static
r_void
id|i596_interrupt
c_func
(paren
r_int
id|reg_ptr
)paren
suffix:semicolon
r_static
r_int
id|i596_close
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
suffix:semicolon
r_static
r_struct
id|enet_statistics
op_star
id|i596_get_stats
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
suffix:semicolon
r_static
r_void
id|i596_add_cmd
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_struct
id|i596_cmd
op_star
id|cmd
)paren
suffix:semicolon
r_static
r_void
id|print_eth
c_func
(paren
r_char
op_star
)paren
suffix:semicolon
macro_line|#ifdef HAVE_MULTICAST
r_static
r_void
id|set_multicast_list
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_int
id|num_addrs
comma
r_void
op_star
id|addrs
)paren
suffix:semicolon
macro_line|#endif
"&f;"
r_static
r_inline
r_void
DECL|function|init_rx_bufs
id|init_rx_bufs
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
(brace
r_struct
id|i596_private
op_star
id|lp
op_assign
(paren
r_struct
id|i596_private
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_int
id|i
suffix:semicolon
r_int
id|boguscnt
op_assign
l_int|100
suffix:semicolon
r_int
id|ioaddr
op_assign
id|dev-&gt;base_addr
suffix:semicolon
r_if
c_cond
(paren
id|i596_debug
OG
l_int|1
)paren
id|printk
(paren
l_string|&quot;%s: init_rx_bufs.&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|RX_RING_SIZE
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|i
op_eq
l_int|0
)paren
(brace
id|lp-&gt;scb.rfd
op_assign
op_amp
id|lp-&gt;rx
(braket
l_int|0
)braket
suffix:semicolon
)brace
r_if
c_cond
(paren
id|i
op_eq
(paren
id|RX_RING_SIZE
op_minus
l_int|1
)paren
)paren
(brace
id|lp-&gt;rx_tail
op_assign
op_amp
(paren
id|lp-&gt;rx
(braket
id|i
)braket
)paren
suffix:semicolon
id|lp-&gt;rx
(braket
id|i
)braket
dot
id|next
op_assign
op_amp
id|lp-&gt;rx
(braket
l_int|0
)braket
suffix:semicolon
id|lp-&gt;rx
(braket
id|i
)braket
dot
id|cmd
op_assign
id|CMD_EOL
suffix:semicolon
)brace
r_else
(brace
id|lp-&gt;rx
(braket
id|i
)braket
dot
id|next
op_assign
op_amp
id|lp-&gt;rx
(braket
id|i
op_plus
l_int|1
)braket
suffix:semicolon
id|lp-&gt;rx
(braket
id|i
)braket
dot
id|cmd
op_assign
l_int|0x0000
suffix:semicolon
)brace
id|lp-&gt;rx
(braket
id|i
)braket
dot
id|stat
op_assign
l_int|0x0000
suffix:semicolon
id|lp-&gt;rx
(braket
id|i
)braket
dot
id|rbd
op_assign
l_int|0xffffffff
suffix:semicolon
id|lp-&gt;rx
(braket
id|i
)braket
dot
id|count
op_assign
l_int|0
suffix:semicolon
id|lp-&gt;rx
(braket
id|i
)braket
dot
id|size
op_assign
l_int|1532
suffix:semicolon
)brace
r_while
c_loop
(paren
id|lp-&gt;scb.status
comma
id|lp-&gt;scb.command
)paren
r_if
c_cond
(paren
op_decrement
id|boguscnt
op_eq
l_int|0
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: init_rx_bufs timed out with status %4.4x, cmd %4.4x.&bslash;n&quot;
comma
id|dev-&gt;name
comma
id|lp-&gt;scb.status
comma
id|lp-&gt;scb.command
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|lp-&gt;scb.command
op_assign
id|RX_START
suffix:semicolon
id|outw
c_func
(paren
l_int|0
comma
id|ioaddr
op_plus
l_int|4
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_static
r_inline
r_void
DECL|function|init_i596_mem
id|init_i596_mem
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
(brace
r_struct
id|i596_private
op_star
id|lp
op_assign
(paren
r_struct
id|i596_private
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_int
id|ioaddr
op_assign
id|dev-&gt;base_addr
suffix:semicolon
r_int
id|boguscnt
op_assign
l_int|100
suffix:semicolon
multiline_comment|/* change the scp address */
id|outw
c_func
(paren
l_int|0
comma
id|ioaddr
)paren
suffix:semicolon
id|outw
c_func
(paren
l_int|0
comma
id|ioaddr
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|4
comma
id|ioaddr
op_plus
l_int|0xf
)paren
suffix:semicolon
id|outw
c_func
(paren
(paren
(paren
(paren
(paren
r_int
)paren
op_amp
id|lp-&gt;scp
)paren
op_amp
l_int|0xffff
)paren
op_or
l_int|2
)paren
comma
id|ioaddr
)paren
suffix:semicolon
id|outw
c_func
(paren
(paren
(paren
(paren
r_int
)paren
op_amp
id|lp-&gt;scp
)paren
op_rshift
l_int|16
)paren
op_amp
l_int|0xffff
comma
id|ioaddr
)paren
suffix:semicolon
id|lp-&gt;last_cmd
op_assign
id|jiffies
suffix:semicolon
id|lp-&gt;scp.sysbus
op_assign
l_int|0x00440000
suffix:semicolon
id|lp-&gt;scp.iscp
op_assign
op_amp
(paren
id|lp-&gt;iscp
)paren
suffix:semicolon
id|lp-&gt;iscp.scb
op_assign
op_amp
(paren
id|lp-&gt;scb
)paren
suffix:semicolon
id|lp-&gt;iscp.stat
op_assign
l_int|0x0001
suffix:semicolon
id|lp-&gt;cmd_backlog
op_assign
l_int|0
suffix:semicolon
id|lp-&gt;cmd_head
op_assign
id|lp-&gt;scb.cmd
op_assign
(paren
r_struct
id|i596_cmd
op_star
)paren
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|i596_debug
OG
l_int|2
)paren
id|printk
c_func
(paren
l_string|&quot;%s: starting i82596.&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
(paren
r_void
)paren
id|inb
(paren
id|ioaddr
op_plus
l_int|0x10
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|4
comma
id|ioaddr
op_plus
l_int|0xf
)paren
suffix:semicolon
id|outw
c_func
(paren
l_int|0
comma
id|ioaddr
op_plus
l_int|4
)paren
suffix:semicolon
r_while
c_loop
(paren
id|lp-&gt;iscp.stat
)paren
r_if
c_cond
(paren
op_decrement
id|boguscnt
op_eq
l_int|0
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: i82596 initialization timed out with status %4.4x, cmd %4.4x.&bslash;n&quot;
comma
id|dev-&gt;name
comma
id|lp-&gt;scb.status
comma
id|lp-&gt;scb.command
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|memcpy
(paren
id|lp-&gt;i596_config
comma
id|init_setup
comma
l_int|14
)paren
suffix:semicolon
id|lp-&gt;set_conf.command
op_assign
id|CmdConfigure
suffix:semicolon
id|i596_add_cmd
c_func
(paren
id|dev
comma
op_amp
id|lp-&gt;set_conf
)paren
suffix:semicolon
id|memcpy
(paren
id|lp-&gt;eth_addr
comma
id|dev-&gt;dev_addr
comma
l_int|6
)paren
suffix:semicolon
id|lp-&gt;set_add.command
op_assign
id|CmdSASetup
suffix:semicolon
id|i596_add_cmd
c_func
(paren
id|dev
comma
op_amp
id|lp-&gt;set_add
)paren
suffix:semicolon
id|lp-&gt;tdr.command
op_assign
id|CmdTDR
suffix:semicolon
id|i596_add_cmd
c_func
(paren
id|dev
comma
op_amp
id|lp-&gt;tdr
)paren
suffix:semicolon
id|init_rx_bufs
c_func
(paren
id|dev
)paren
suffix:semicolon
id|boguscnt
op_assign
l_int|200
suffix:semicolon
r_while
c_loop
(paren
id|lp-&gt;scb.status
comma
id|lp-&gt;scb.command
)paren
r_if
c_cond
(paren
op_decrement
id|boguscnt
op_eq
l_int|0
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;i82596 init timed out with status %4.4x, cmd %4.4x.&bslash;n&quot;
comma
id|lp-&gt;scb.status
comma
id|lp-&gt;scb.command
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_return
suffix:semicolon
)brace
r_static
r_inline
r_int
DECL|function|i596_rx
id|i596_rx
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
(brace
r_struct
id|i596_private
op_star
id|lp
op_assign
(paren
r_struct
id|i596_private
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_int
id|frames
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|i596_debug
OG
l_int|3
)paren
id|printk
(paren
l_string|&quot;i596_rx()&bslash;n&quot;
)paren
suffix:semicolon
r_while
c_loop
(paren
(paren
id|lp-&gt;scb.rfd-&gt;stat
)paren
op_amp
id|STAT_C
)paren
(brace
r_if
c_cond
(paren
id|i596_debug
OG
l_int|2
)paren
id|print_eth
c_func
(paren
id|lp-&gt;scb.rfd-&gt;data
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|lp-&gt;scb.rfd-&gt;stat
)paren
op_amp
id|STAT_OK
)paren
(brace
multiline_comment|/* a good frame */
r_int
id|pkt_len
op_assign
id|lp-&gt;scb.rfd-&gt;count
op_amp
l_int|0x3fff
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|alloc_skb
c_func
(paren
id|pkt_len
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
id|frames
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|skb
op_eq
l_int|NULL
)paren
(brace
id|printk
(paren
l_string|&quot;%s: i596_rx Memory squeeze, dropping packet.&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
id|lp-&gt;stats.rx_dropped
op_increment
suffix:semicolon
r_break
suffix:semicolon
)brace
id|skb-&gt;len
op_assign
id|pkt_len
suffix:semicolon
id|skb-&gt;dev
op_assign
id|dev
suffix:semicolon
id|memcpy
c_func
(paren
id|skb-&gt;data
comma
id|lp-&gt;scb.rfd-&gt;data
comma
id|pkt_len
)paren
suffix:semicolon
id|netif_rx
c_func
(paren
id|skb
)paren
suffix:semicolon
id|lp-&gt;stats.rx_packets
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|i596_debug
OG
l_int|4
)paren
id|print_eth
c_func
(paren
id|skb-&gt;data
)paren
suffix:semicolon
)brace
r_else
(brace
id|lp-&gt;stats.rx_errors
op_increment
suffix:semicolon
r_if
c_cond
(paren
(paren
id|lp-&gt;scb.rfd-&gt;stat
)paren
op_amp
l_int|0x0001
)paren
id|lp-&gt;stats.collisions
op_increment
suffix:semicolon
r_if
c_cond
(paren
(paren
id|lp-&gt;scb.rfd-&gt;stat
)paren
op_amp
l_int|0x0080
)paren
id|lp-&gt;stats.rx_length_errors
op_increment
suffix:semicolon
r_if
c_cond
(paren
(paren
id|lp-&gt;scb.rfd-&gt;stat
)paren
op_amp
l_int|0x0100
)paren
id|lp-&gt;stats.rx_over_errors
op_increment
suffix:semicolon
r_if
c_cond
(paren
(paren
id|lp-&gt;scb.rfd-&gt;stat
)paren
op_amp
l_int|0x0200
)paren
id|lp-&gt;stats.rx_fifo_errors
op_increment
suffix:semicolon
r_if
c_cond
(paren
(paren
id|lp-&gt;scb.rfd-&gt;stat
)paren
op_amp
l_int|0x0400
)paren
id|lp-&gt;stats.rx_frame_errors
op_increment
suffix:semicolon
r_if
c_cond
(paren
(paren
id|lp-&gt;scb.rfd-&gt;stat
)paren
op_amp
l_int|0x0800
)paren
id|lp-&gt;stats.rx_crc_errors
op_increment
suffix:semicolon
r_if
c_cond
(paren
(paren
id|lp-&gt;scb.rfd-&gt;stat
)paren
op_amp
l_int|0x1000
)paren
id|lp-&gt;stats.rx_length_errors
op_increment
suffix:semicolon
)brace
id|lp-&gt;scb.rfd-&gt;stat
op_assign
l_int|0
suffix:semicolon
id|lp-&gt;rx_tail-&gt;cmd
op_assign
l_int|0
suffix:semicolon
id|lp-&gt;rx_tail
op_assign
id|lp-&gt;scb.rfd
suffix:semicolon
id|lp-&gt;scb.rfd
op_assign
id|lp-&gt;scb.rfd-&gt;next
suffix:semicolon
id|lp-&gt;rx_tail-&gt;count
op_assign
l_int|0
suffix:semicolon
id|lp-&gt;rx_tail-&gt;cmd
op_assign
id|CMD_EOL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|i596_debug
OG
l_int|3
)paren
id|printk
(paren
l_string|&quot;frames %d&bslash;n&quot;
comma
id|frames
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_inline
r_void
DECL|function|i596_cleanup_cmd
id|i596_cleanup_cmd
c_func
(paren
r_struct
id|i596_private
op_star
id|lp
)paren
(brace
r_struct
id|i596_cmd
op_star
id|ptr
suffix:semicolon
r_int
id|boguscnt
op_assign
l_int|100
suffix:semicolon
r_if
c_cond
(paren
id|i596_debug
OG
l_int|4
)paren
id|printk
(paren
l_string|&quot;i596_cleanup_cmd&bslash;n&quot;
)paren
suffix:semicolon
r_while
c_loop
(paren
id|lp-&gt;cmd_head
op_ne
(paren
r_struct
id|i596_cmd
op_star
)paren
op_minus
l_int|1
)paren
(brace
id|ptr
op_assign
id|lp-&gt;cmd_head
suffix:semicolon
id|lp-&gt;cmd_head
op_assign
id|lp-&gt;cmd_head-&gt;next
suffix:semicolon
id|lp-&gt;cmd_backlog
op_decrement
suffix:semicolon
r_switch
c_cond
(paren
(paren
id|ptr-&gt;command
)paren
op_amp
l_int|0x7
)paren
(brace
r_case
id|CmdTx
suffix:colon
(brace
r_struct
id|tx_cmd
op_star
id|tx_cmd
op_assign
(paren
r_struct
id|tx_cmd
op_star
)paren
id|ptr
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
(paren
(paren
r_struct
id|sk_buff
op_star
)paren
(paren
id|tx_cmd-&gt;tbd-&gt;data
)paren
)paren
op_minus
l_int|1
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
comma
id|FREE_WRITE
)paren
suffix:semicolon
id|lp-&gt;stats.tx_errors
op_increment
suffix:semicolon
id|lp-&gt;stats.tx_aborted_errors
op_increment
suffix:semicolon
id|ptr-&gt;next
op_assign
(paren
r_struct
id|i596_cmd
op_star
)paren
op_minus
l_int|1
suffix:semicolon
id|kfree_s
c_func
(paren
(paren
r_int
r_char
op_star
)paren
id|tx_cmd
comma
(paren
r_sizeof
(paren
r_struct
id|tx_cmd
)paren
op_plus
r_sizeof
(paren
r_struct
id|i596_tbd
)paren
)paren
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|CmdMulticastList
suffix:colon
(brace
r_int
r_int
id|count
op_assign
op_star
(paren
(paren
r_int
r_int
op_star
)paren
(paren
id|ptr
op_plus
l_int|1
)paren
)paren
suffix:semicolon
id|ptr-&gt;next
op_assign
(paren
r_struct
id|i596_cmd
op_star
)paren
op_minus
l_int|1
suffix:semicolon
id|kfree_s
c_func
(paren
(paren
r_int
r_char
op_star
)paren
id|ptr
comma
(paren
r_sizeof
(paren
r_struct
id|i596_cmd
)paren
op_plus
id|count
op_plus
l_int|2
)paren
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_default
suffix:colon
id|ptr-&gt;next
op_assign
(paren
r_struct
id|i596_cmd
op_star
)paren
op_minus
l_int|1
suffix:semicolon
)brace
)brace
r_while
c_loop
(paren
id|lp-&gt;scb.status
comma
id|lp-&gt;scb.command
)paren
r_if
c_cond
(paren
op_decrement
id|boguscnt
op_eq
l_int|0
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;i596_cleanup_cmd timed out with status %4.4x, cmd %4.4x.&bslash;n&quot;
comma
id|lp-&gt;scb.status
comma
id|lp-&gt;scb.command
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|lp-&gt;scb.cmd
op_assign
id|lp-&gt;cmd_head
suffix:semicolon
)brace
r_static
r_inline
r_void
DECL|function|i596_reset
id|i596_reset
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_struct
id|i596_private
op_star
id|lp
comma
r_int
id|ioaddr
)paren
(brace
r_int
id|boguscnt
op_assign
l_int|100
suffix:semicolon
r_if
c_cond
(paren
id|i596_debug
OG
l_int|4
)paren
id|printk
(paren
l_string|&quot;i596_reset&bslash;n&quot;
)paren
suffix:semicolon
r_while
c_loop
(paren
id|lp-&gt;scb.status
comma
id|lp-&gt;scb.command
)paren
r_if
c_cond
(paren
op_decrement
id|boguscnt
op_eq
l_int|0
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;i596_reset timed out with status %4.4x, cmd %4.4x.&bslash;n&quot;
comma
id|lp-&gt;scb.status
comma
id|lp-&gt;scb.command
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|dev-&gt;start
op_assign
l_int|0
suffix:semicolon
id|dev-&gt;tbusy
op_assign
l_int|1
suffix:semicolon
id|lp-&gt;scb.command
op_assign
id|CUC_ABORT
op_or
id|RX_ABORT
suffix:semicolon
id|outw
c_func
(paren
l_int|0
comma
id|ioaddr
op_plus
l_int|4
)paren
suffix:semicolon
multiline_comment|/* wait for shutdown */
id|boguscnt
op_assign
l_int|400
suffix:semicolon
r_while
c_loop
(paren
(paren
id|lp-&gt;scb.status
comma
id|lp-&gt;scb.command
)paren
op_logical_or
id|lp-&gt;scb.command
)paren
r_if
c_cond
(paren
op_decrement
id|boguscnt
op_eq
l_int|0
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;i596_reset 2 timed out with status %4.4x, cmd %4.4x.&bslash;n&quot;
comma
id|lp-&gt;scb.status
comma
id|lp-&gt;scb.command
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|i596_cleanup_cmd
c_func
(paren
id|lp
)paren
suffix:semicolon
id|i596_rx
c_func
(paren
id|dev
)paren
suffix:semicolon
id|dev-&gt;start
op_assign
l_int|1
suffix:semicolon
id|dev-&gt;tbusy
op_assign
l_int|0
suffix:semicolon
id|dev-&gt;interrupt
op_assign
l_int|0
suffix:semicolon
id|init_i596_mem
c_func
(paren
id|dev
)paren
suffix:semicolon
)brace
DECL|function|i596_add_cmd
r_static
r_void
id|i596_add_cmd
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_struct
id|i596_cmd
op_star
id|cmd
)paren
(brace
r_struct
id|i596_private
op_star
id|lp
op_assign
(paren
r_struct
id|i596_private
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_int
id|ioaddr
op_assign
id|dev-&gt;base_addr
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|boguscnt
op_assign
l_int|100
suffix:semicolon
r_if
c_cond
(paren
id|i596_debug
OG
l_int|4
)paren
id|printk
(paren
l_string|&quot;i596_add_cmd&bslash;n&quot;
)paren
suffix:semicolon
id|cmd-&gt;status
op_assign
l_int|0
suffix:semicolon
id|cmd-&gt;command
op_or_assign
(paren
id|CMD_EOL
op_or
id|CMD_INTR
)paren
suffix:semicolon
id|cmd-&gt;next
op_assign
(paren
r_struct
id|i596_cmd
op_star
)paren
op_minus
l_int|1
suffix:semicolon
id|save_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
id|cli
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|lp-&gt;cmd_head
op_ne
(paren
r_struct
id|i596_cmd
op_star
)paren
op_minus
l_int|1
)paren
id|lp-&gt;cmd_tail-&gt;next
op_assign
id|cmd
suffix:semicolon
r_else
(brace
id|lp-&gt;cmd_head
op_assign
id|cmd
suffix:semicolon
r_while
c_loop
(paren
id|lp-&gt;scb.status
comma
id|lp-&gt;scb.command
)paren
r_if
c_cond
(paren
op_decrement
id|boguscnt
op_eq
l_int|0
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;i596_add_cmd timed out with status %4.4x, cmd %4.4x.&bslash;n&quot;
comma
id|lp-&gt;scb.status
comma
id|lp-&gt;scb.command
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|lp-&gt;scb.cmd
op_assign
id|cmd
suffix:semicolon
id|lp-&gt;scb.command
op_assign
id|CUC_START
suffix:semicolon
id|outw
(paren
l_int|0
comma
id|ioaddr
op_plus
l_int|4
)paren
suffix:semicolon
)brace
id|lp-&gt;cmd_tail
op_assign
id|cmd
suffix:semicolon
id|lp-&gt;cmd_backlog
op_increment
suffix:semicolon
id|lp-&gt;cmd_head
op_assign
id|lp-&gt;scb.cmd
suffix:semicolon
id|restore_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|lp-&gt;cmd_backlog
OG
l_int|16
)paren
(brace
r_int
id|tickssofar
op_assign
id|jiffies
op_minus
id|lp-&gt;last_cmd
suffix:semicolon
r_if
c_cond
(paren
id|tickssofar
OL
l_int|25
)paren
r_return
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s: command unit timed out, status resetting.&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
id|i596_reset
c_func
(paren
id|dev
comma
id|lp
comma
id|ioaddr
)paren
suffix:semicolon
)brace
)brace
r_static
r_int
DECL|function|i596_open
id|i596_open
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
(brace
r_if
c_cond
(paren
id|request_irq
c_func
(paren
id|dev-&gt;irq
comma
op_amp
id|i596_interrupt
comma
l_int|0
comma
l_string|&quot;apricot&quot;
)paren
)paren
(brace
r_return
op_minus
id|EAGAIN
suffix:semicolon
)brace
id|irq2dev_map
(braket
id|dev-&gt;irq
)braket
op_assign
id|dev
suffix:semicolon
r_if
c_cond
(paren
id|i596_debug
OG
l_int|1
)paren
id|printk
c_func
(paren
l_string|&quot;%s: i596_open() irq %d.&bslash;n&quot;
comma
id|dev-&gt;name
comma
id|dev-&gt;irq
)paren
suffix:semicolon
id|dev-&gt;tbusy
op_assign
l_int|0
suffix:semicolon
id|dev-&gt;interrupt
op_assign
l_int|0
suffix:semicolon
id|dev-&gt;start
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* Initialize the 82596 memory */
id|init_i596_mem
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
multiline_comment|/* Always succeed */
)brace
r_static
r_int
DECL|function|i596_start_xmit
id|i596_start_xmit
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|device
op_star
id|dev
)paren
(brace
r_struct
id|i596_private
op_star
id|lp
op_assign
(paren
r_struct
id|i596_private
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_int
id|ioaddr
op_assign
id|dev-&gt;base_addr
suffix:semicolon
r_struct
id|tx_cmd
op_star
id|tx_cmd
suffix:semicolon
r_if
c_cond
(paren
id|i596_debug
OG
l_int|2
)paren
id|printk
(paren
l_string|&quot;%s: Apricot start xmit&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
multiline_comment|/* Transmitter timeout, serious problems. */
r_if
c_cond
(paren
id|dev-&gt;tbusy
)paren
(brace
r_int
id|tickssofar
op_assign
id|jiffies
op_minus
id|dev-&gt;trans_start
suffix:semicolon
r_if
c_cond
(paren
id|tickssofar
OL
l_int|5
)paren
r_return
l_int|1
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s: transmit timed out, status resetting.&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
id|lp-&gt;stats.tx_errors
op_increment
suffix:semicolon
multiline_comment|/* Try to restart the adaptor */
r_if
c_cond
(paren
id|lp-&gt;last_restart
op_eq
id|lp-&gt;stats.tx_packets
)paren
(brace
r_if
c_cond
(paren
id|i596_debug
OG
l_int|1
)paren
id|printk
(paren
l_string|&quot;Resetting board.&bslash;n&quot;
)paren
suffix:semicolon
multiline_comment|/* Shutdown and restart */
id|i596_reset
c_func
(paren
id|dev
comma
id|lp
comma
id|ioaddr
)paren
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* Issue a channel attention signal */
r_if
c_cond
(paren
id|i596_debug
OG
l_int|1
)paren
id|printk
(paren
l_string|&quot;Kicking board.&bslash;n&quot;
)paren
suffix:semicolon
id|lp-&gt;scb.command
op_assign
id|CUC_START
op_or
id|RX_START
suffix:semicolon
id|outw
c_func
(paren
l_int|0
comma
id|ioaddr
op_plus
l_int|4
)paren
suffix:semicolon
id|lp-&gt;last_restart
op_assign
id|lp-&gt;stats.tx_packets
suffix:semicolon
)brace
id|dev-&gt;tbusy
op_assign
l_int|0
suffix:semicolon
id|dev-&gt;trans_start
op_assign
id|jiffies
suffix:semicolon
)brace
multiline_comment|/* If some higher level thinks we&squot;ve misses a tx-done interrupt&n;       we are passed NULL. n.b. dev_tint handles the cli()/sti()&n;       itself. */
r_if
c_cond
(paren
id|skb
op_eq
l_int|NULL
)paren
(brace
id|dev_tint
c_func
(paren
id|dev
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* shouldn&squot;t happen */
r_if
c_cond
(paren
id|skb-&gt;len
op_le
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|i596_debug
OG
l_int|3
)paren
id|printk
c_func
(paren
l_string|&quot;%s: i596_start_xmit() called&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
multiline_comment|/* Block a timer-based transmit from overlapping.  This could better be&n;       done with atomic_swap(1, dev-&gt;tbusy), but set_bit() works as well. */
r_if
c_cond
(paren
id|set_bit
c_func
(paren
l_int|0
comma
(paren
r_void
op_star
)paren
op_amp
id|dev-&gt;tbusy
)paren
op_ne
l_int|0
)paren
id|printk
c_func
(paren
l_string|&quot;%s: Transmitter access conflict.&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
r_else
(brace
r_int
id|length
op_assign
id|ETH_ZLEN
OL
id|skb-&gt;len
ques
c_cond
id|skb-&gt;len
suffix:colon
id|ETH_ZLEN
suffix:semicolon
id|dev-&gt;trans_start
op_assign
id|jiffies
suffix:semicolon
id|tx_cmd
op_assign
(paren
r_struct
id|tx_cmd
op_star
)paren
id|kmalloc
(paren
(paren
r_sizeof
(paren
r_struct
id|tx_cmd
)paren
op_plus
r_sizeof
(paren
r_struct
id|i596_tbd
)paren
)paren
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tx_cmd
op_eq
l_int|NULL
)paren
(brace
id|printk
(paren
l_string|&quot;%s: i596_xmit Memory squeeze, dropping packet.&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
id|lp-&gt;stats.tx_dropped
op_increment
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
comma
id|FREE_WRITE
)paren
suffix:semicolon
)brace
r_else
(brace
id|tx_cmd-&gt;tbd
op_assign
(paren
r_struct
id|i596_tbd
op_star
)paren
(paren
id|tx_cmd
op_plus
l_int|1
)paren
suffix:semicolon
id|tx_cmd-&gt;tbd-&gt;next
op_assign
(paren
r_struct
id|i596_tbd
op_star
)paren
op_minus
l_int|1
suffix:semicolon
id|tx_cmd-&gt;cmd.command
op_assign
id|CMD_FLEX
op_or
id|CmdTx
suffix:semicolon
id|tx_cmd-&gt;pad
op_assign
l_int|0
suffix:semicolon
id|tx_cmd-&gt;size
op_assign
l_int|0
suffix:semicolon
id|tx_cmd-&gt;tbd-&gt;pad
op_assign
l_int|0
suffix:semicolon
id|tx_cmd-&gt;tbd-&gt;size
op_assign
id|EOF
op_or
id|length
suffix:semicolon
id|tx_cmd-&gt;tbd-&gt;data
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
id|i596_debug
OG
l_int|3
)paren
id|print_eth
c_func
(paren
id|skb-&gt;data
)paren
suffix:semicolon
id|i596_add_cmd
c_func
(paren
id|dev
comma
(paren
r_struct
id|i596_cmd
op_star
)paren
id|tx_cmd
)paren
suffix:semicolon
id|lp-&gt;stats.tx_packets
op_increment
suffix:semicolon
)brace
)brace
id|dev-&gt;tbusy
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
"&f;"
DECL|function|print_eth
r_static
r_void
id|print_eth
c_func
(paren
r_char
op_star
id|add
)paren
(brace
r_int
id|i
suffix:semicolon
id|printk
(paren
l_string|&quot;Dest  &quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|6
suffix:semicolon
id|i
op_increment
)paren
id|printk
c_func
(paren
l_string|&quot; %2.2X&quot;
comma
(paren
r_int
r_char
)paren
id|add
(braket
id|i
)braket
)paren
suffix:semicolon
id|printk
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|printk
(paren
l_string|&quot;Source&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|6
suffix:semicolon
id|i
op_increment
)paren
id|printk
c_func
(paren
l_string|&quot; %2.2X&quot;
comma
(paren
r_int
r_char
)paren
id|add
(braket
id|i
op_plus
l_int|6
)braket
)paren
suffix:semicolon
id|printk
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|printk
(paren
l_string|&quot;type %2.2X%2.2X&bslash;n&quot;
comma
(paren
r_int
r_char
)paren
id|add
(braket
l_int|12
)braket
comma
(paren
r_int
r_char
)paren
id|add
(braket
l_int|13
)braket
)paren
suffix:semicolon
)brace
DECL|function|apricot_init
r_int
r_int
id|apricot_init
c_func
(paren
r_int
r_int
id|mem_start
comma
r_int
r_int
id|mem_end
)paren
(brace
r_struct
id|device
op_star
id|dev
suffix:semicolon
r_int
id|i
suffix:semicolon
r_int
id|checksum
op_assign
l_int|0
suffix:semicolon
r_int
id|ioaddr
op_assign
l_int|0x300
suffix:semicolon
r_char
id|eth_addr
(braket
l_int|6
)braket
suffix:semicolon
multiline_comment|/* this is easy the ethernet interface can only be at 0x300 */
multiline_comment|/* first check nothing is already registered here */
r_if
c_cond
(paren
id|check_region
c_func
(paren
id|ioaddr
comma
id|APRICOT_TOTAL_SIZE
)paren
)paren
r_return
id|mem_start
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|8
suffix:semicolon
id|i
op_increment
)paren
id|checksum
op_add_assign
id|inb
c_func
(paren
id|ioaddr
op_plus
l_int|8
op_plus
id|i
)paren
suffix:semicolon
multiline_comment|/* checksum is a multiple of 0x100, got this wrong first time&n;       some machines have 0x100, some 0x200. The DOS driver doesn&squot;t&n;       even bother with the checksum */
r_if
c_cond
(paren
id|checksum
op_mod
l_int|0x100
)paren
r_return
id|mem_start
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|6
suffix:semicolon
id|i
op_increment
)paren
(brace
id|eth_addr
(braket
id|i
)braket
op_assign
id|inb
c_func
(paren
id|ioaddr
op_plus
l_int|8
op_plus
id|i
)paren
suffix:semicolon
)brace
multiline_comment|/* Some other boards trip the checksum.. but then appear as ether&n;       address 0. Trap these - AC */
r_if
c_cond
(paren
id|memcmp
c_func
(paren
id|eth_addr
comma
l_string|&quot;&bslash;x00&bslash;x00&bslash;x00&bslash;x00&bslash;x00&bslash;x00&quot;
comma
l_int|6
)paren
op_eq
l_int|0
)paren
(brace
r_return
id|mem_start
suffix:semicolon
)brace
id|dev
op_assign
id|init_etherdev
c_func
(paren
l_int|0
comma
(paren
r_sizeof
(paren
r_struct
id|i596_private
)paren
op_plus
l_int|0xf
)paren
comma
op_amp
id|mem_start
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s: Apricot 82596 at %#3x,&quot;
comma
id|dev-&gt;name
comma
id|ioaddr
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|6
suffix:semicolon
id|i
op_increment
)paren
id|printk
c_func
(paren
l_string|&quot; %2.2X&quot;
comma
id|dev-&gt;dev_addr
(braket
id|i
)braket
op_assign
id|eth_addr
(braket
id|i
)braket
)paren
suffix:semicolon
id|dev-&gt;base_addr
op_assign
id|ioaddr
suffix:semicolon
id|dev-&gt;irq
op_assign
l_int|10
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; IRQ %d.&bslash;n&quot;
comma
id|dev-&gt;irq
)paren
suffix:semicolon
id|snarf_region
c_func
(paren
id|ioaddr
comma
id|APRICOT_TOTAL_SIZE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|i596_debug
OG
l_int|0
)paren
id|printk
c_func
(paren
id|version
)paren
suffix:semicolon
multiline_comment|/* The APRICOT-specific entries in the device structure. */
id|dev-&gt;open
op_assign
op_amp
id|i596_open
suffix:semicolon
id|dev-&gt;stop
op_assign
op_amp
id|i596_close
suffix:semicolon
id|dev-&gt;hard_start_xmit
op_assign
op_amp
id|i596_start_xmit
suffix:semicolon
id|dev-&gt;get_stats
op_assign
op_amp
id|i596_get_stats
suffix:semicolon
macro_line|#ifdef HAVE_MULTICAST
id|dev-&gt;set_multicast_list
op_assign
op_amp
id|set_multicast_list
suffix:semicolon
macro_line|#endif
multiline_comment|/* align for scp */
id|dev-&gt;priv
op_assign
(paren
r_void
op_star
)paren
(paren
(paren
(paren
r_int
)paren
id|dev-&gt;priv
op_plus
l_int|0xf
)paren
op_amp
l_int|0xfffffff0
)paren
suffix:semicolon
r_return
id|mem_start
suffix:semicolon
)brace
r_static
r_void
DECL|function|i596_interrupt
id|i596_interrupt
c_func
(paren
r_int
id|reg_ptr
)paren
(brace
r_int
id|irq
op_assign
op_minus
(paren
(paren
(paren
r_struct
id|pt_regs
op_star
)paren
id|reg_ptr
)paren
op_member_access_from_pointer
id|orig_eax
op_plus
l_int|2
)paren
suffix:semicolon
r_struct
id|device
op_star
id|dev
op_assign
(paren
r_struct
id|device
op_star
)paren
(paren
id|irq2dev_map
(braket
id|irq
)braket
)paren
suffix:semicolon
r_struct
id|i596_private
op_star
id|lp
suffix:semicolon
r_int
id|ioaddr
suffix:semicolon
r_int
id|boguscnt
op_assign
l_int|200
suffix:semicolon
r_int
r_int
id|status
comma
id|ack_cmd
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|dev
op_eq
l_int|NULL
)paren
(brace
id|printk
(paren
l_string|&quot;i596_interrupt(): irq %d for unknown device.&bslash;n&quot;
comma
id|irq
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|i596_debug
OG
l_int|3
)paren
id|printk
(paren
l_string|&quot;%s: i596_interrupt(): irq %d&bslash;n&quot;
comma
id|dev-&gt;name
comma
id|irq
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dev-&gt;interrupt
)paren
id|printk
c_func
(paren
l_string|&quot;%s: Re-entering the interrupt handler.&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
id|dev-&gt;interrupt
op_assign
l_int|1
suffix:semicolon
id|ioaddr
op_assign
id|dev-&gt;base_addr
suffix:semicolon
id|lp
op_assign
(paren
r_struct
id|i596_private
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_while
c_loop
(paren
id|lp-&gt;scb.status
comma
id|lp-&gt;scb.command
)paren
r_if
c_cond
(paren
op_decrement
id|boguscnt
op_eq
l_int|0
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: i596 interrupt, timeout status %4.4x command %4.4x.&bslash;n&quot;
comma
id|dev-&gt;name
comma
id|lp-&gt;scb.status
comma
id|lp-&gt;scb.command
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|status
op_assign
id|lp-&gt;scb.status
suffix:semicolon
r_if
c_cond
(paren
id|i596_debug
OG
l_int|4
)paren
id|printk
c_func
(paren
l_string|&quot;%s: i596 interrupt, status %4.4x.&bslash;n&quot;
comma
id|dev-&gt;name
comma
id|status
)paren
suffix:semicolon
id|ack_cmd
op_assign
id|status
op_amp
l_int|0xf000
suffix:semicolon
r_if
c_cond
(paren
(paren
id|status
op_amp
l_int|0x8000
)paren
op_logical_or
(paren
id|status
op_amp
l_int|0x2000
)paren
)paren
(brace
r_struct
id|i596_cmd
op_star
id|ptr
suffix:semicolon
r_if
c_cond
(paren
(paren
id|i596_debug
OG
l_int|4
)paren
op_logical_and
(paren
id|status
op_amp
l_int|0x8000
)paren
)paren
id|printk
c_func
(paren
l_string|&quot;%s: i596 interrupt completed command.&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|i596_debug
OG
l_int|4
)paren
op_logical_and
(paren
id|status
op_amp
l_int|0x2000
)paren
)paren
id|printk
c_func
(paren
l_string|&quot;%s: i596 interrupt command unit inactive %x.&bslash;n&quot;
comma
id|dev-&gt;name
comma
id|status
op_amp
l_int|0x0700
)paren
suffix:semicolon
r_while
c_loop
(paren
(paren
id|lp-&gt;cmd_head
op_ne
(paren
r_struct
id|i596_cmd
op_star
)paren
op_minus
l_int|1
)paren
op_logical_and
(paren
id|lp-&gt;cmd_head-&gt;status
op_amp
id|STAT_C
)paren
)paren
(brace
id|ptr
op_assign
id|lp-&gt;cmd_head
suffix:semicolon
id|lp-&gt;cmd_head
op_assign
id|lp-&gt;cmd_head-&gt;next
suffix:semicolon
id|lp-&gt;cmd_backlog
op_decrement
suffix:semicolon
r_switch
c_cond
(paren
(paren
id|ptr-&gt;command
)paren
op_amp
l_int|0x7
)paren
(brace
r_case
id|CmdTx
suffix:colon
(brace
r_struct
id|tx_cmd
op_star
id|tx_cmd
op_assign
(paren
r_struct
id|tx_cmd
op_star
)paren
id|ptr
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
(paren
(paren
r_struct
id|sk_buff
op_star
)paren
(paren
id|tx_cmd-&gt;tbd-&gt;data
)paren
)paren
op_minus
l_int|1
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
comma
id|FREE_WRITE
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ptr-&gt;status
)paren
op_amp
id|STAT_OK
)paren
(brace
r_if
c_cond
(paren
id|i596_debug
OG
l_int|2
)paren
id|print_eth
c_func
(paren
id|skb-&gt;data
)paren
suffix:semicolon
)brace
r_else
(brace
id|lp-&gt;stats.tx_errors
op_increment
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ptr-&gt;status
)paren
op_amp
l_int|0x0020
)paren
id|lp-&gt;stats.collisions
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
(paren
id|ptr-&gt;status
)paren
op_amp
l_int|0x0040
)paren
)paren
id|lp-&gt;stats.tx_heartbeat_errors
op_increment
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ptr-&gt;status
)paren
op_amp
l_int|0x0400
)paren
id|lp-&gt;stats.tx_carrier_errors
op_increment
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ptr-&gt;status
)paren
op_amp
l_int|0x0800
)paren
id|lp-&gt;stats.collisions
op_increment
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ptr-&gt;status
)paren
op_amp
l_int|0x1000
)paren
id|lp-&gt;stats.tx_aborted_errors
op_increment
suffix:semicolon
)brace
id|ptr-&gt;next
op_assign
(paren
r_struct
id|i596_cmd
op_star
)paren
op_minus
l_int|1
suffix:semicolon
id|kfree_s
c_func
(paren
(paren
r_int
r_char
op_star
)paren
id|tx_cmd
comma
(paren
r_sizeof
(paren
r_struct
id|tx_cmd
)paren
op_plus
r_sizeof
(paren
r_struct
id|i596_tbd
)paren
)paren
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|CmdMulticastList
suffix:colon
(brace
r_int
r_int
id|count
op_assign
op_star
(paren
(paren
r_int
r_int
op_star
)paren
(paren
id|ptr
op_plus
l_int|1
)paren
)paren
suffix:semicolon
id|ptr-&gt;next
op_assign
(paren
r_struct
id|i596_cmd
op_star
)paren
op_minus
l_int|1
suffix:semicolon
id|kfree_s
c_func
(paren
(paren
r_int
r_char
op_star
)paren
id|ptr
comma
(paren
r_sizeof
(paren
r_struct
id|i596_cmd
)paren
op_plus
id|count
op_plus
l_int|2
)paren
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_case
id|CmdTDR
suffix:colon
(brace
r_int
r_int
id|status
op_assign
op_star
(paren
(paren
r_int
r_int
op_star
)paren
(paren
id|ptr
op_plus
l_int|1
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|status
op_amp
l_int|0x8000
)paren
(brace
r_if
c_cond
(paren
id|i596_debug
OG
l_int|3
)paren
id|printk
c_func
(paren
l_string|&quot;%s: link ok.&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|status
op_amp
l_int|0x4000
)paren
id|printk
c_func
(paren
l_string|&quot;%s: Transceiver problem.&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
r_if
c_cond
(paren
id|status
op_amp
l_int|0x2000
)paren
id|printk
c_func
(paren
l_string|&quot;%s: Termination problem.&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
r_if
c_cond
(paren
id|status
op_amp
l_int|0x1000
)paren
id|printk
c_func
(paren
l_string|&quot;%s: Short circuit.&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s: Time %ld.&bslash;n&quot;
comma
id|dev-&gt;name
comma
id|status
op_amp
l_int|0x07ff
)paren
suffix:semicolon
)brace
)brace
r_default
suffix:colon
id|ptr-&gt;next
op_assign
(paren
r_struct
id|i596_cmd
op_star
)paren
op_minus
l_int|1
suffix:semicolon
id|lp-&gt;last_cmd
op_assign
id|jiffies
suffix:semicolon
)brace
)brace
id|ptr
op_assign
id|lp-&gt;cmd_head
suffix:semicolon
r_while
c_loop
(paren
(paren
id|ptr
op_ne
(paren
r_struct
id|i596_cmd
op_star
)paren
op_minus
l_int|1
)paren
op_logical_and
(paren
id|ptr
op_ne
id|lp-&gt;cmd_tail
)paren
)paren
(brace
id|ptr-&gt;command
op_and_assign
l_int|0x1fff
suffix:semicolon
id|ptr
op_assign
id|ptr-&gt;next
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|lp-&gt;cmd_head
op_ne
(paren
r_struct
id|i596_cmd
op_star
)paren
op_minus
l_int|1
)paren
op_logical_and
(paren
id|dev-&gt;start
)paren
)paren
id|ack_cmd
op_or_assign
id|CUC_START
suffix:semicolon
id|lp-&gt;scb.cmd
op_assign
id|lp-&gt;cmd_head
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|status
op_amp
l_int|0x1000
)paren
op_logical_or
(paren
id|status
op_amp
l_int|0x4000
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
id|i596_debug
OG
l_int|4
)paren
op_logical_and
(paren
id|status
op_amp
l_int|0x4000
)paren
)paren
id|printk
c_func
(paren
l_string|&quot;%s: i596 interrupt received a frame.&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|i596_debug
OG
l_int|4
)paren
op_logical_and
(paren
id|status
op_amp
l_int|0x1000
)paren
)paren
id|printk
c_func
(paren
l_string|&quot;%s: i596 interrupt receive unit inactive %x.&bslash;n&quot;
comma
id|dev-&gt;name
comma
id|status
op_amp
l_int|0x0070
)paren
suffix:semicolon
id|i596_rx
c_func
(paren
id|dev
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dev-&gt;start
)paren
id|ack_cmd
op_or_assign
id|RX_START
suffix:semicolon
)brace
multiline_comment|/* acknowledge the interrupt */
multiline_comment|/*&n;    if ((lp-&gt;scb.cmd != (struct i596_cmd *) -1) &amp;&amp; (dev-&gt;start)) ack_cmd |= CUC_START;&n;*/
id|boguscnt
op_assign
l_int|100
suffix:semicolon
r_while
c_loop
(paren
id|lp-&gt;scb.status
comma
id|lp-&gt;scb.command
)paren
r_if
c_cond
(paren
op_decrement
id|boguscnt
op_eq
l_int|0
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%s: i596 interrupt, timeout status %4.4x command %4.4x.&bslash;n&quot;
comma
id|dev-&gt;name
comma
id|lp-&gt;scb.status
comma
id|lp-&gt;scb.command
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|lp-&gt;scb.command
op_assign
id|ack_cmd
suffix:semicolon
(paren
r_void
)paren
id|inb
(paren
id|ioaddr
op_plus
l_int|0x10
)paren
suffix:semicolon
id|outb
(paren
l_int|4
comma
id|ioaddr
op_plus
l_int|0xf
)paren
suffix:semicolon
id|outw
(paren
l_int|0
comma
id|ioaddr
op_plus
l_int|4
)paren
suffix:semicolon
r_if
c_cond
(paren
id|i596_debug
OG
l_int|4
)paren
id|printk
c_func
(paren
l_string|&quot;%s: exiting interrupt.&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
id|dev-&gt;interrupt
op_assign
l_int|0
suffix:semicolon
r_return
suffix:semicolon
)brace
r_static
r_int
DECL|function|i596_close
id|i596_close
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
(brace
r_int
id|ioaddr
op_assign
id|dev-&gt;base_addr
suffix:semicolon
r_struct
id|i596_private
op_star
id|lp
op_assign
(paren
r_struct
id|i596_private
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
id|dev-&gt;start
op_assign
l_int|0
suffix:semicolon
id|dev-&gt;tbusy
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|i596_debug
OG
l_int|1
)paren
id|printk
c_func
(paren
l_string|&quot;%s: Shutting down ethercard, status was %4.4x.&bslash;n&quot;
comma
id|dev-&gt;name
comma
id|lp-&gt;scb.status
)paren
suffix:semicolon
id|lp-&gt;scb.command
op_assign
id|CUC_ABORT
op_or
id|RX_ABORT
suffix:semicolon
id|outw
c_func
(paren
l_int|0
comma
id|ioaddr
op_plus
l_int|4
)paren
suffix:semicolon
id|i596_cleanup_cmd
c_func
(paren
id|lp
)paren
suffix:semicolon
id|free_irq
c_func
(paren
id|dev-&gt;irq
)paren
suffix:semicolon
id|irq2dev_map
(braket
id|dev-&gt;irq
)braket
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_struct
id|enet_statistics
op_star
DECL|function|i596_get_stats
id|i596_get_stats
c_func
(paren
r_struct
id|device
op_star
id|dev
)paren
(brace
r_struct
id|i596_private
op_star
id|lp
op_assign
(paren
r_struct
id|i596_private
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_return
op_amp
id|lp-&gt;stats
suffix:semicolon
)brace
macro_line|#ifdef HAVE_MULTICAST
multiline_comment|/* Set or clear the multicast filter for this adaptor.&n;   num_addrs == -1&t;Promiscuous mode, receive all packets&n;   num_addrs == 0&t;Normal mode, clear multicast list&n;   num_addrs &gt; 0&t;Multicast mode, receive normal and MC packets, and do&n;   &t;&t;&t;best-effort filtering.&n; */
r_static
r_void
DECL|function|set_multicast_list
id|set_multicast_list
c_func
(paren
r_struct
id|device
op_star
id|dev
comma
r_int
id|num_addrs
comma
r_void
op_star
id|addrs
)paren
(brace
r_struct
id|i596_private
op_star
id|lp
op_assign
(paren
r_struct
id|i596_private
op_star
)paren
id|dev-&gt;priv
suffix:semicolon
r_struct
id|i596_cmd
op_star
id|cmd
suffix:semicolon
r_if
c_cond
(paren
id|i596_debug
OG
l_int|1
)paren
id|printk
(paren
l_string|&quot;%s: set multicast list %d&bslash;n&quot;
comma
id|dev-&gt;name
comma
id|num_addrs
)paren
suffix:semicolon
r_if
c_cond
(paren
id|num_addrs
OG
l_int|0
)paren
(brace
id|cmd
op_assign
(paren
r_struct
id|i596_cmd
op_star
)paren
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|i596_cmd
)paren
op_plus
l_int|2
op_plus
id|num_addrs
op_star
l_int|6
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
id|cmd
op_eq
l_int|NULL
)paren
(brace
id|printk
(paren
l_string|&quot;%s: set_multicast Memory squeeze.&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|cmd-&gt;command
op_assign
id|CmdMulticastList
suffix:semicolon
op_star
(paren
(paren
r_int
r_int
op_star
)paren
(paren
id|cmd
op_plus
l_int|1
)paren
)paren
op_assign
id|num_addrs
op_star
l_int|6
suffix:semicolon
id|memcpy
(paren
(paren
(paren
r_char
op_star
)paren
(paren
id|cmd
op_plus
l_int|1
)paren
)paren
op_plus
l_int|2
comma
id|addrs
comma
id|num_addrs
op_star
l_int|6
)paren
suffix:semicolon
id|print_eth
(paren
(paren
(paren
r_char
op_star
)paren
(paren
id|cmd
op_plus
l_int|1
)paren
)paren
op_plus
l_int|2
)paren
suffix:semicolon
id|i596_add_cmd
c_func
(paren
id|dev
comma
id|cmd
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|lp-&gt;set_conf.next
op_ne
(paren
r_struct
id|i596_cmd
op_star
)paren
op_minus
l_int|1
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|num_addrs
op_eq
l_int|0
)paren
id|lp-&gt;i596_config
(braket
l_int|8
)braket
op_and_assign
op_complement
l_int|0x01
suffix:semicolon
r_else
id|lp-&gt;i596_config
(braket
l_int|8
)braket
op_or_assign
l_int|0x01
suffix:semicolon
id|i596_add_cmd
c_func
(paren
id|dev
comma
op_amp
id|lp-&gt;set_conf
)paren
suffix:semicolon
)brace
)brace
macro_line|#endif
macro_line|#ifdef HAVE_DEVLIST
DECL|variable|apricot_portlist
r_static
r_int
r_int
id|apricot_portlist
(braket
)braket
op_assign
(brace
l_int|0x300
comma
l_int|0
)brace
suffix:semicolon
DECL|variable|apricot_drv
r_struct
id|netdev_entry
id|apricot_drv
op_assign
(brace
l_string|&quot;apricot&quot;
comma
id|apricot_init
comma
id|APRICOT_TOTAL_SIZE
comma
id|apricot_portlist
)brace
suffix:semicolon
macro_line|#endif
"&f;"
multiline_comment|/*&n; * Local variables:&n; *  compile-command: &quot;gcc -D__KERNEL__ -I/usr/src/linux/net/inet -Wall -Wstrict-prototypes -O6 -m486 -c apricot.c&quot;&n; * End:&n; */
eof
