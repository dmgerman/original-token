multiline_comment|/******************************************************************************&n; *&n; *&t;(C)Copyright 1998,1999 SysKonnect,&n; *&t;a business unit of Schneider &amp; Koch &amp; Co. Datensysteme GmbH.&n; *&n; *&t;See the file &quot;skfddi.c&quot; for further information.&n; *&n; *&t;This program is free software; you can redistribute it and/or modify&n; *&t;it under the terms of the GNU General Public License as published by&n; *&t;the Free Software Foundation; either version 2 of the License, or&n; *&t;(at your option) any later version.&n; *&n; *&t;The information in this file is provided &quot;AS IS&quot; without warranty.&n; *&n; ******************************************************************************/
multiline_comment|/*&n;&t;IBM FDDI read error log function&n;*/
macro_line|#include &quot;h/types.h&quot;
macro_line|#include &quot;h/fddi.h&quot;
macro_line|#include &quot;h/smc.h&quot;
macro_line|#include &quot;h/lnkstat.h&quot;
macro_line|#ifndef&t;lint
DECL|variable|ID_sccs
r_static
r_const
r_char
id|ID_sccs
(braket
)braket
op_assign
l_string|&quot;@(#)lnkstat.c&t;1.8 97/04/11 (C) SK &quot;
suffix:semicolon
macro_line|#endif
macro_line|#ifdef&t;sun
DECL|macro|_far
mdefine_line|#define _far
macro_line|#endif
DECL|macro|EL_IS_OK
mdefine_line|#define EL_IS_OK(x,l)&t;((((int)&amp;(((struct s_error_log *)0)-&gt;x)) + &bslash;&n;&t;&t;&t;sizeof(er-&gt;x)) &lt;= l)
multiline_comment|/*&n;&t;BEGIN_MANUAL_ENTRY(if,func;others;11)&n;&n;&t;u_long smt_get_error_word(smc)&n;&t;struct s_smc *smc ;&n;&n;Function&t;DOWNCALL&t;(SMT, lnkstat.c)&n;&t;&t;This functions returns the SMT error work for AIX events.&n;&n;Return&t;smt_error_word&t;These bits are supported:&n;&n;&t;&t;SMT_ERL_ALC&t;== &t;[PS/PA].fddiPORTLerFlag&n;&t;&t;SMT_ERL_BLC&t;==&t;[PB].fddiPORTLerFlag&n;&t;&t;SMT_ERL_NCC&t;==&t;fddiMACNotCopiedFlag&n;&t;&t;SMT_ERL_FEC&t;==&t;fddiMACFrameErrorFlag&n;&n;&t;END_MANUAL_ENTRY()&n; */
DECL|function|smt_get_error_word
id|u_long
id|smt_get_error_word
c_func
(paren
id|smc
)paren
r_struct
id|s_smc
op_star
id|smc
suffix:semicolon
(brace
id|u_long
id|st
suffix:semicolon
multiline_comment|/*&n;&t; * smt error word low&n;&t; */
id|st
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|smc-&gt;s.sas
op_eq
id|SMT_SAS
)paren
(brace
r_if
c_cond
(paren
id|smc-&gt;mib.p
(braket
id|PS
)braket
dot
id|fddiPORTLerFlag
)paren
id|st
op_or_assign
id|SMT_ERL_ALC
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|smc-&gt;mib.p
(braket
id|PA
)braket
dot
id|fddiPORTLerFlag
)paren
id|st
op_or_assign
id|SMT_ERL_ALC
suffix:semicolon
r_if
c_cond
(paren
id|smc-&gt;mib.p
(braket
id|PB
)braket
dot
id|fddiPORTLerFlag
)paren
id|st
op_or_assign
id|SMT_ERL_BLC
suffix:semicolon
)brace
r_if
c_cond
(paren
id|smc-&gt;mib.m
(braket
id|MAC0
)braket
dot
id|fddiMACNotCopiedFlag
)paren
id|st
op_or_assign
id|SMT_ERL_NCC
suffix:semicolon
multiline_comment|/* not copied condition */
r_if
c_cond
(paren
id|smc-&gt;mib.m
(braket
id|MAC0
)braket
dot
id|fddiMACFrameErrorFlag
)paren
id|st
op_or_assign
id|SMT_ERL_FEC
suffix:semicolon
multiline_comment|/* frame error condition */
r_return
id|st
suffix:semicolon
)brace
multiline_comment|/*&n;&t;BEGIN_MANUAL_ENTRY(if,func;others;11)&n;&n;&t;u_long smt_get_event_word(smc)&n;&t;struct s_smc *smc ;&n;&n;Function&t;DOWNCALL&t;(SMT, lnkstat.c)&n;&t;&t;This functions returns the SMT event work for AIX events.&n;&n;Return&t;smt_event_word&t;always 0&n;&n;&t;END_MANUAL_ENTRY()&n; */
DECL|function|smt_get_event_word
id|u_long
id|smt_get_event_word
c_func
(paren
id|smc
)paren
r_struct
id|s_smc
op_star
id|smc
suffix:semicolon
(brace
r_return
(paren
id|u_long
)paren
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n;&t;BEGIN_MANUAL_ENTRY(if,func;others;11)&n;&n;&t;u_long smt_get_port_event_word(smc)&n;&t;struct s_smc *smc ;&n;&n;Function&t;DOWNCALL&t;(SMT, lnkstat.c)&n;&t;&t;This functions returns the SMT port event work for AIX events.&n;&n;Return&t;smt_port_event_word&t;always 0&n;&n;&t;END_MANUAL_ENTRY()&n; */
DECL|function|smt_get_port_event_word
id|u_long
id|smt_get_port_event_word
c_func
(paren
id|smc
)paren
r_struct
id|s_smc
op_star
id|smc
suffix:semicolon
(brace
r_return
(paren
id|u_long
)paren
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n;&t;BEGIN_MANUAL_ENTRY(if,func;others;11)&n;&n;&t;u_long smt_read_errorlog(smc,p,len)&n;&t;struct s_smc *smc ;&n;&t;char _far *p ;&n;&t;int len ;&n;&n;Function&t;DOWNCALL&t;(SMT, lnkstat.c)&n;&t;&t;This functions returns the SMT error log field for AIX events.&n;&n;Para&t;p&t;pointer to the error log field&n;&t;len&t;len of the error log field&n;&n;Return&t;len&t;used len of the error log field&n;&n;&t;END_MANUAL_ENTRY()&n; */
DECL|function|smt_read_errorlog
r_int
id|smt_read_errorlog
c_func
(paren
id|smc
comma
id|p
comma
id|len
)paren
r_struct
id|s_smc
op_star
id|smc
suffix:semicolon
r_char
id|_far
op_star
id|p
suffix:semicolon
r_int
id|len
suffix:semicolon
(brace
r_int
id|i
suffix:semicolon
r_int
id|st
suffix:semicolon
r_struct
id|s_error_log
id|_far
op_star
id|er
suffix:semicolon
id|er
op_assign
(paren
r_struct
id|s_error_log
id|_far
op_star
)paren
id|p
suffix:semicolon
r_if
c_cond
(paren
id|len
OG
r_sizeof
(paren
r_struct
id|s_error_log
)paren
)paren
id|len
op_assign
r_sizeof
(paren
r_struct
id|s_error_log
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|len
suffix:semicolon
id|i
op_increment
)paren
op_star
id|p
op_increment
op_assign
l_int|0
suffix:semicolon
multiline_comment|/*&n;&t; * set count&n;&t; */
r_if
c_cond
(paren
id|EL_IS_OK
c_func
(paren
id|set_count_high
comma
id|len
)paren
)paren
(brace
id|er-&gt;set_count_low
op_assign
(paren
id|u_short
)paren
id|smc-&gt;mib.fddiSMTSetCount.count
suffix:semicolon
id|er-&gt;set_count_high
op_assign
(paren
id|u_short
)paren
(paren
id|smc-&gt;mib.fddiSMTSetCount.count
op_rshift
l_int|16L
)paren
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * aci&n;&t; */
r_if
c_cond
(paren
id|EL_IS_OK
c_func
(paren
id|aci_id_code
comma
id|len
)paren
)paren
(brace
id|er-&gt;aci_id_code
op_assign
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * purge counter is missed frames; 16 bits only&n;&t; */
r_if
c_cond
(paren
id|EL_IS_OK
c_func
(paren
id|purge_frame_counter
comma
id|len
)paren
)paren
(brace
r_if
c_cond
(paren
id|smc-&gt;mib.m
(braket
id|MAC0
)braket
dot
id|fddiMACCopied_Ct
OG
l_int|0xffff
)paren
id|er-&gt;purge_frame_counter
op_assign
l_int|0xffff
suffix:semicolon
r_else
id|er-&gt;purge_frame_counter
op_assign
(paren
id|u_short
)paren
id|smc-&gt;mib.m
(braket
id|MAC0
)braket
dot
id|fddiMACCopied_Ct
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * CMT and RMT state machines&n;&t; */
r_if
c_cond
(paren
id|EL_IS_OK
c_func
(paren
id|ecm_state
comma
id|len
)paren
)paren
id|er-&gt;ecm_state
op_assign
id|smc-&gt;mib.fddiSMTECMState
suffix:semicolon
r_if
c_cond
(paren
id|EL_IS_OK
c_func
(paren
id|pcm_b_state
comma
id|len
)paren
)paren
(brace
r_if
c_cond
(paren
id|smc-&gt;s.sas
op_eq
id|SMT_SAS
)paren
(brace
id|er-&gt;pcm_a_state
op_assign
id|smc-&gt;y
(braket
id|PS
)braket
dot
id|mib-&gt;fddiPORTPCMState
suffix:semicolon
id|er-&gt;pcm_b_state
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|er-&gt;pcm_a_state
op_assign
id|smc-&gt;y
(braket
id|PA
)braket
dot
id|mib-&gt;fddiPORTPCMState
suffix:semicolon
id|er-&gt;pcm_b_state
op_assign
id|smc-&gt;y
(braket
id|PB
)braket
dot
id|mib-&gt;fddiPORTPCMState
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|EL_IS_OK
c_func
(paren
id|cfm_state
comma
id|len
)paren
)paren
id|er-&gt;cfm_state
op_assign
id|smc-&gt;mib.fddiSMTCF_State
suffix:semicolon
r_if
c_cond
(paren
id|EL_IS_OK
c_func
(paren
id|rmt_state
comma
id|len
)paren
)paren
id|er-&gt;rmt_state
op_assign
id|smc-&gt;mib.m
(braket
id|MAC0
)braket
dot
id|fddiMACRMTState
suffix:semicolon
multiline_comment|/*&n;&t; * smt error word low (we only need the low order 16 bits.)&n;&t; */
id|st
op_assign
id|smt_get_error_word
c_func
(paren
id|smc
)paren
op_amp
l_int|0xffff
suffix:semicolon
r_if
c_cond
(paren
id|EL_IS_OK
c_func
(paren
id|smt_error_low
comma
id|len
)paren
)paren
id|er-&gt;smt_error_low
op_assign
id|st
suffix:semicolon
r_if
c_cond
(paren
id|EL_IS_OK
c_func
(paren
id|ucode_version_level
comma
id|len
)paren
)paren
id|er-&gt;ucode_version_level
op_assign
l_int|0x0101
suffix:semicolon
r_return
(paren
id|len
)paren
suffix:semicolon
)brace
eof
