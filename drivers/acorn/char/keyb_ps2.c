multiline_comment|/*&n; *  linux/drivers/acorn/char/keyb_ps2.c&n; *&n; *  Copyright (C) 2000 Russell King&n; *&n; * This program is free software; you can redistribute it and/or modify&n; * it under the terms of the GNU General Public License version 2 as&n; * published by the Free Software Foundation.&n; *&n; *  Keyboard driver for RiscPC ARM Linux.&n; *&n; *  Note!!! This driver talks directly to the keyboard.&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/interrupt.h&gt;
macro_line|#include &lt;linux/tty.h&gt;
macro_line|#include &lt;linux/tty_flip.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/malloc.h&gt;
macro_line|#include &lt;linux/ptrace.h&gt;
macro_line|#include &lt;linux/signal.h&gt;
macro_line|#include &lt;linux/timer.h&gt;
macro_line|#include &lt;linux/random.h&gt;
macro_line|#include &lt;linux/ctype.h&gt;
macro_line|#include &lt;linux/kbd_ll.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;asm/bitops.h&gt;
macro_line|#include &lt;asm/irq.h&gt;
macro_line|#include &lt;asm/hardware.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;asm/hardware/iomd.h&gt;
macro_line|#include &lt;asm/system.h&gt;
r_extern
r_struct
id|tasklet_struct
id|keyboard_tasklet
suffix:semicolon
r_extern
r_void
id|kbd_reset_kdown
c_func
(paren
r_void
)paren
suffix:semicolon
DECL|variable|kbd_read_mask
r_int
id|kbd_read_mask
suffix:semicolon
DECL|macro|VERSION
mdefine_line|#define VERSION 100
DECL|macro|KBD_REPORT_ERR
mdefine_line|#define KBD_REPORT_ERR
DECL|macro|KBD_REPORT_UNKN
mdefine_line|#define KBD_REPORT_UNKN
DECL|macro|KBD_ESCAPEE0
mdefine_line|#define KBD_ESCAPEE0&t;0xe0&t;&t;/* in */
DECL|macro|KBD_ESCAPEE1
mdefine_line|#define KBD_ESCAPEE1&t;0xe1&t;&t;/* in */
DECL|macro|ESCE0
mdefine_line|#define ESCE0(x)&t;(0xe000|(x))
DECL|macro|ESCE1
mdefine_line|#define ESCE1(x)&t;(0xe100|(x))
DECL|macro|KBD_BAT
mdefine_line|#define KBD_BAT&t;&t;0xaa&t;&t;/* in */
DECL|macro|KBD_SETLEDS
mdefine_line|#define KBD_SETLEDS&t;0xed&t;&t;/* out */
DECL|macro|KBD_ECHO
mdefine_line|#define KBD_ECHO&t;0xee&t;&t;/* in/out */
DECL|macro|KBD_BREAK
mdefine_line|#define KBD_BREAK&t;0xf0&t;&t;/* in */
DECL|macro|KBD_TYPRATEDLY
mdefine_line|#define KBD_TYPRATEDLY&t;0xf3&t;&t;/* out */
DECL|macro|KBD_SCANENABLE
mdefine_line|#define KBD_SCANENABLE&t;0xf4&t;&t;/* out */
DECL|macro|KBD_DEFDISABLE
mdefine_line|#define KBD_DEFDISABLE&t;0xf5&t;&t;/* out */
DECL|macro|KBD_DEFAULT
mdefine_line|#define KBD_DEFAULT&t;0xf6&t;&t;/* out */
DECL|macro|KBD_ACK
mdefine_line|#define KBD_ACK&t;&t;0xfa&t;&t;/* in */
DECL|macro|KBD_DIAGFAIL
mdefine_line|#define KBD_DIAGFAIL&t;0xfd&t;&t;/* in */
DECL|macro|KBD_RESEND
mdefine_line|#define KBD_RESEND&t;0xfe&t;&t;/* in/out */
DECL|macro|KBD_RESET
mdefine_line|#define KBD_RESET&t;0xff&t;&t;/* out */
DECL|macro|CODE_BREAK
mdefine_line|#define CODE_BREAK&t;1
DECL|macro|CODE_ESCAPEE0
mdefine_line|#define CODE_ESCAPEE0&t;2
DECL|macro|CODE_ESCAPEE1
mdefine_line|#define CODE_ESCAPEE1&t;4
DECL|macro|CODE_ESCAPE12
mdefine_line|#define CODE_ESCAPE12&t;8
DECL|macro|K_NONE
mdefine_line|#define K_NONE&t;&t;0x7f
DECL|macro|K_ESC
mdefine_line|#define K_ESC&t;&t;0x00
DECL|macro|K_F1
mdefine_line|#define K_F1&t;&t;0x01
DECL|macro|K_F2
mdefine_line|#define K_F2&t;&t;0x02
DECL|macro|K_F3
mdefine_line|#define K_F3&t;&t;0x03
DECL|macro|K_F4
mdefine_line|#define K_F4&t;&t;0x04
DECL|macro|K_F5
mdefine_line|#define K_F5&t;&t;0x05
DECL|macro|K_F6
mdefine_line|#define K_F6&t;&t;0x06
DECL|macro|K_F7
mdefine_line|#define K_F7&t;&t;0x07
DECL|macro|K_F8
mdefine_line|#define K_F8&t;&t;0x08
DECL|macro|K_F9
mdefine_line|#define K_F9&t;&t;0x09
DECL|macro|K_F10
mdefine_line|#define K_F10&t;&t;0x0a
DECL|macro|K_F11
mdefine_line|#define K_F11&t;&t;0x0b
DECL|macro|K_F12
mdefine_line|#define K_F12&t;&t;0x0c
DECL|macro|K_PRNT
mdefine_line|#define K_PRNT&t;&t;0x0d
DECL|macro|K_SCRL
mdefine_line|#define K_SCRL&t;&t;0x0e
DECL|macro|K_BRK
mdefine_line|#define K_BRK&t;&t;0x0f
DECL|macro|K_AGR
mdefine_line|#define K_AGR&t;&t;0x10
DECL|macro|K_1
mdefine_line|#define K_1&t;&t;0x11
DECL|macro|K_2
mdefine_line|#define K_2&t;&t;0x12
DECL|macro|K_3
mdefine_line|#define K_3&t;&t;0x13
DECL|macro|K_4
mdefine_line|#define K_4&t;&t;0x14
DECL|macro|K_5
mdefine_line|#define K_5&t;&t;0x15
DECL|macro|K_6
mdefine_line|#define K_6&t;&t;0x16
DECL|macro|K_7
mdefine_line|#define K_7&t;&t;0x17
DECL|macro|K_8
mdefine_line|#define K_8&t;&t;0x18
DECL|macro|K_9
mdefine_line|#define K_9&t;&t;0x19
DECL|macro|K_0
mdefine_line|#define K_0&t;&t;0x1a
DECL|macro|K_MINS
mdefine_line|#define K_MINS&t;&t;0x1b
DECL|macro|K_EQLS
mdefine_line|#define K_EQLS&t;&t;0x1c
DECL|macro|K_BKSP
mdefine_line|#define K_BKSP&t;&t;0x1e
DECL|macro|K_INS
mdefine_line|#define K_INS&t;&t;0x1f
DECL|macro|K_HOME
mdefine_line|#define K_HOME&t;&t;0x20
DECL|macro|K_PGUP
mdefine_line|#define K_PGUP&t;&t;0x21
DECL|macro|K_NUML
mdefine_line|#define K_NUML&t;&t;0x22
DECL|macro|KP_SLH
mdefine_line|#define KP_SLH&t;&t;0x23
DECL|macro|KP_STR
mdefine_line|#define KP_STR&t;&t;0x24
DECL|macro|KP_MNS
mdefine_line|#define KP_MNS&t;&t;0x3a
DECL|macro|K_TAB
mdefine_line|#define K_TAB&t;&t;0x26
DECL|macro|K_Q
mdefine_line|#define K_Q&t;&t;0x27
DECL|macro|K_W
mdefine_line|#define K_W&t;&t;0x28
DECL|macro|K_E
mdefine_line|#define K_E&t;&t;0x29
DECL|macro|K_R
mdefine_line|#define K_R&t;&t;0x2a
DECL|macro|K_T
mdefine_line|#define K_T&t;&t;0x2b
DECL|macro|K_Y
mdefine_line|#define K_Y&t;&t;0x2c
DECL|macro|K_U
mdefine_line|#define K_U&t;&t;0x2d
DECL|macro|K_I
mdefine_line|#define K_I&t;&t;0x2e
DECL|macro|K_O
mdefine_line|#define K_O&t;&t;0x2f
DECL|macro|K_P
mdefine_line|#define K_P&t;&t;0x30
DECL|macro|K_LSBK
mdefine_line|#define K_LSBK&t;&t;0x31
DECL|macro|K_RSBK
mdefine_line|#define K_RSBK&t;&t;0x32
DECL|macro|K_ENTR
mdefine_line|#define K_ENTR&t;&t;0x47
DECL|macro|K_DEL
mdefine_line|#define K_DEL&t;&t;0x34
DECL|macro|K_END
mdefine_line|#define K_END&t;&t;0x35
DECL|macro|K_PGDN
mdefine_line|#define K_PGDN&t;&t;0x36
DECL|macro|KP_7
mdefine_line|#define KP_7&t;&t;0x37
DECL|macro|KP_8
mdefine_line|#define KP_8&t;&t;0x38
DECL|macro|KP_9
mdefine_line|#define KP_9&t;&t;0x39
DECL|macro|KP_PLS
mdefine_line|#define KP_PLS&t;&t;0x4b
DECL|macro|K_CAPS
mdefine_line|#define K_CAPS&t;&t;0x5d
DECL|macro|K_A
mdefine_line|#define K_A&t;&t;0x3c
DECL|macro|K_S
mdefine_line|#define K_S&t;&t;0x3d
DECL|macro|K_D
mdefine_line|#define K_D&t;&t;0x3e
DECL|macro|K_F
mdefine_line|#define K_F&t;&t;0x3f
DECL|macro|K_G
mdefine_line|#define K_G&t;&t;0x40
DECL|macro|K_H
mdefine_line|#define K_H&t;&t;0x41
DECL|macro|K_J
mdefine_line|#define K_J&t;&t;0x42
DECL|macro|K_K
mdefine_line|#define K_K&t;&t;0x43
DECL|macro|K_L
mdefine_line|#define K_L&t;&t;0x44
DECL|macro|K_SEMI
mdefine_line|#define K_SEMI&t;&t;0x45
DECL|macro|K_SQOT
mdefine_line|#define K_SQOT&t;&t;0x46
DECL|macro|K_HASH
mdefine_line|#define K_HASH&t;&t;0x1d
DECL|macro|KP_4
mdefine_line|#define KP_4&t;&t;0x48
DECL|macro|KP_5
mdefine_line|#define KP_5&t;&t;0x49
DECL|macro|KP_6
mdefine_line|#define KP_6&t;&t;0x4a
DECL|macro|K_LSFT
mdefine_line|#define K_LSFT&t;&t;0x4c
DECL|macro|K_BSLH
mdefine_line|#define K_BSLH&t;&t;0x33
DECL|macro|K_Z
mdefine_line|#define K_Z&t;&t;0x4e
DECL|macro|K_X
mdefine_line|#define K_X&t;&t;0x4f
DECL|macro|K_C
mdefine_line|#define K_C&t;&t;0x50
DECL|macro|K_V
mdefine_line|#define K_V&t;&t;0x51
DECL|macro|K_B
mdefine_line|#define K_B&t;&t;0x52
DECL|macro|K_N
mdefine_line|#define K_N&t;&t;0x53
DECL|macro|K_M
mdefine_line|#define K_M&t;&t;0x54
DECL|macro|K_COMA
mdefine_line|#define K_COMA&t;&t;0x55
DECL|macro|K_DOT
mdefine_line|#define K_DOT&t;&t;0x56
DECL|macro|K_FSLH
mdefine_line|#define K_FSLH&t;&t;0x57
DECL|macro|K_RSFT
mdefine_line|#define K_RSFT&t;&t;0x58
DECL|macro|K_UP
mdefine_line|#define K_UP&t;&t;0x59
DECL|macro|KP_1
mdefine_line|#define KP_1&t;&t;0x5a
DECL|macro|KP_2
mdefine_line|#define KP_2&t;&t;0x5b
DECL|macro|KP_3
mdefine_line|#define KP_3&t;&t;0x5c
DECL|macro|KP_ENT
mdefine_line|#define KP_ENT&t;&t;0x67
DECL|macro|K_LCTL
mdefine_line|#define K_LCTL&t;&t;0x3b
DECL|macro|K_LALT
mdefine_line|#define K_LALT&t;&t;0x5e
DECL|macro|K_SPCE
mdefine_line|#define K_SPCE&t;&t;0x5f
DECL|macro|K_RALT
mdefine_line|#define K_RALT&t;&t;0x60
DECL|macro|K_RCTL
mdefine_line|#define K_RCTL&t;&t;0x61
DECL|macro|K_LEFT
mdefine_line|#define K_LEFT&t;&t;0x62
DECL|macro|K_DOWN
mdefine_line|#define K_DOWN&t;&t;0x63
DECL|macro|K_RGHT
mdefine_line|#define K_RGHT&t;&t;0x64
DECL|macro|KP_0
mdefine_line|#define KP_0&t;&t;0x65
DECL|macro|KP_DOT
mdefine_line|#define KP_DOT&t;&t;0x66
DECL|variable|keycode_translate
r_static
r_int
r_char
id|keycode_translate
(braket
l_int|256
)braket
op_assign
(brace
multiline_comment|/* 00 */
id|K_NONE
comma
id|K_F9
comma
id|K_NONE
comma
id|K_F5
comma
id|K_F3
comma
id|K_F1
comma
id|K_F2
comma
id|K_F12
comma
multiline_comment|/* 08 */
id|K_NONE
comma
id|K_F10
comma
id|K_F8
comma
id|K_F6
comma
id|K_F4
comma
id|K_TAB
comma
id|K_AGR
comma
id|K_NONE
comma
multiline_comment|/* 10 */
id|K_NONE
comma
id|K_LALT
comma
id|K_LSFT
comma
id|K_NONE
comma
id|K_LCTL
comma
id|K_Q
comma
id|K_1
comma
id|K_NONE
comma
multiline_comment|/* 18 */
id|K_NONE
comma
id|K_NONE
comma
id|K_Z
comma
id|K_S
comma
id|K_A
comma
id|K_W
comma
id|K_2
comma
id|K_NONE
comma
multiline_comment|/* 20 */
id|K_NONE
comma
id|K_C
comma
id|K_X
comma
id|K_D
comma
id|K_E
comma
id|K_4
comma
id|K_3
comma
id|K_NONE
comma
multiline_comment|/* 28 */
id|K_NONE
comma
id|K_SPCE
comma
id|K_V
comma
id|K_F
comma
id|K_T
comma
id|K_R
comma
id|K_5
comma
id|K_NONE
comma
multiline_comment|/* 30 */
id|K_NONE
comma
id|K_N
comma
id|K_B
comma
id|K_H
comma
id|K_G
comma
id|K_Y
comma
id|K_6
comma
id|K_NONE
comma
multiline_comment|/* 38 */
id|K_NONE
comma
id|K_NONE
comma
id|K_M
comma
id|K_J
comma
id|K_U
comma
id|K_7
comma
id|K_8
comma
id|K_NONE
comma
multiline_comment|/* 40 */
id|K_NONE
comma
id|K_COMA
comma
id|K_K
comma
id|K_I
comma
id|K_O
comma
id|K_0
comma
id|K_9
comma
id|K_NONE
comma
multiline_comment|/* 48 */
id|K_NONE
comma
id|K_DOT
comma
id|K_FSLH
comma
id|K_L
comma
id|K_SEMI
comma
id|K_P
comma
id|K_MINS
comma
id|K_NONE
comma
multiline_comment|/* 50 */
id|K_NONE
comma
id|K_NONE
comma
id|K_SQOT
comma
id|K_NONE
comma
id|K_LSBK
comma
id|K_EQLS
comma
id|K_NONE
comma
id|K_NONE
comma
multiline_comment|/* 58 */
id|K_CAPS
comma
id|K_RSFT
comma
id|K_ENTR
comma
id|K_RSBK
comma
id|K_NONE
comma
id|K_HASH
comma
id|K_NONE
comma
id|K_NONE
comma
multiline_comment|/* 60 */
id|K_NONE
comma
id|K_BSLH
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_BKSP
comma
id|K_NONE
comma
multiline_comment|/* 68 */
id|K_NONE
comma
id|KP_1
comma
id|K_NONE
comma
id|KP_4
comma
id|KP_7
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
multiline_comment|/* 70 */
id|KP_0
comma
id|KP_DOT
comma
id|KP_2
comma
id|KP_5
comma
id|KP_6
comma
id|KP_8
comma
id|K_ESC
comma
id|K_NUML
comma
multiline_comment|/* 78 */
id|K_F11
comma
id|KP_PLS
comma
id|KP_3
comma
id|KP_MNS
comma
id|KP_STR
comma
id|KP_9
comma
id|K_SCRL
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_F7
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
comma
id|K_NONE
)brace
suffix:semicolon
macro_line|#ifdef CONFIG_MAGIC_SYSRQ
DECL|variable|ps2kbd_sysrq_xlate
r_int
r_char
id|ps2kbd_sysrq_xlate
(braket
)braket
op_assign
(brace
l_int|27
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_char|&squot;`&squot;
comma
l_char|&squot;1&squot;
comma
l_char|&squot;2&squot;
comma
l_char|&squot;3&squot;
comma
l_char|&squot;4&squot;
comma
l_char|&squot;5&squot;
comma
l_char|&squot;6&squot;
comma
l_char|&squot;7&squot;
comma
l_char|&squot;8&squot;
comma
l_char|&squot;9&squot;
comma
l_char|&squot;0&squot;
comma
l_char|&squot;-&squot;
comma
l_char|&squot;=&squot;
comma
l_char|&squot;&#xfffd;&squot;
comma
l_int|127
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_char|&squot;/&squot;
comma
l_char|&squot;*&squot;
comma
l_char|&squot;#&squot;
comma
l_int|9
comma
l_char|&squot;q&squot;
comma
l_char|&squot;w&squot;
comma
l_char|&squot;e&squot;
comma
l_char|&squot;r&squot;
comma
l_char|&squot;t&squot;
comma
l_char|&squot;y&squot;
comma
l_char|&squot;u&squot;
comma
l_char|&squot;i&squot;
comma
l_char|&squot;o&squot;
comma
l_char|&squot;p&squot;
comma
l_char|&squot;[&squot;
comma
l_char|&squot;]&squot;
comma
l_char|&squot;&bslash;&bslash;&squot;
comma
l_int|22
comma
l_int|23
comma
l_int|25
comma
l_char|&squot;7&squot;
comma
l_char|&squot;8&squot;
comma
l_char|&squot;9&squot;
comma
l_char|&squot;-&squot;
comma
l_int|0
comma
l_char|&squot;a&squot;
comma
l_char|&squot;s&squot;
comma
l_char|&squot;d&squot;
comma
l_char|&squot;f&squot;
comma
l_char|&squot;g&squot;
comma
l_char|&squot;h&squot;
comma
l_char|&squot;j&squot;
comma
l_char|&squot;k&squot;
comma
l_char|&squot;l&squot;
comma
l_char|&squot;;&squot;
comma
l_char|&squot;&bslash;&squot;&squot;
comma
l_int|13
comma
l_char|&squot;4&squot;
comma
l_char|&squot;5&squot;
comma
l_char|&squot;6&squot;
comma
l_char|&squot;+&squot;
comma
l_int|0
comma
l_int|0
comma
l_char|&squot;z&squot;
comma
l_char|&squot;x&squot;
comma
l_char|&squot;c&squot;
comma
l_char|&squot;v&squot;
comma
l_char|&squot;b&squot;
comma
l_char|&squot;n&squot;
comma
l_char|&squot;m&squot;
comma
l_char|&squot;,&squot;
comma
l_char|&squot;.&squot;
comma
l_char|&squot;/&squot;
comma
l_int|0
comma
l_int|0
comma
l_char|&squot;1&squot;
comma
l_char|&squot;2&squot;
comma
l_char|&squot;3&squot;
comma
l_int|0
comma
l_int|0
comma
l_char|&squot; &squot;
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_char|&squot;0&squot;
comma
l_char|&squot;.&squot;
comma
l_int|10
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
)brace
suffix:semicolon
macro_line|#endif
DECL|function|ps2kbd_key
r_static
r_inline
r_void
id|ps2kbd_key
c_func
(paren
r_int
r_int
id|keycode
comma
r_int
r_int
id|up_flag
)paren
(brace
id|handle_scancode
c_func
(paren
id|keycode
comma
op_logical_neg
id|up_flag
)paren
suffix:semicolon
)brace
DECL|function|ps2kbd_sendbyte
r_static
r_inline
r_void
id|ps2kbd_sendbyte
c_func
(paren
r_int
r_char
id|val
)paren
(brace
r_while
c_loop
(paren
op_logical_neg
(paren
id|inb
c_func
(paren
id|IOMD_KCTRL
)paren
op_amp
(paren
l_int|1
op_lshift
l_int|7
)paren
)paren
)paren
(brace
suffix:semicolon
)brace
id|outb
c_func
(paren
id|val
comma
id|IOMD_KARTTX
)paren
suffix:semicolon
)brace
DECL|variable|status
r_static
r_int
r_char
id|status
suffix:semicolon
DECL|variable|ncodes
r_static
r_int
r_char
id|ncodes
suffix:semicolon
DECL|variable|bi
r_static
r_int
r_char
id|bi
suffix:semicolon
DECL|variable|buffer
r_static
r_int
r_char
id|buffer
(braket
l_int|4
)braket
suffix:semicolon
DECL|function|ps2kbd_reset
r_static
r_inline
r_void
id|ps2kbd_reset
c_func
(paren
r_void
)paren
(brace
id|status
op_assign
l_int|0
suffix:semicolon
id|kbd_reset_kdown
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|function|handle_rawcode
r_static
r_void
id|handle_rawcode
c_func
(paren
r_int
id|keyval
)paren
(brace
r_int
id|keysym
suffix:semicolon
r_if
c_cond
(paren
id|keyval
OG
l_int|0x83
)paren
(brace
r_switch
c_cond
(paren
id|keyval
)paren
(brace
r_case
id|KBD_ESCAPEE0
suffix:colon
id|ncodes
op_assign
l_int|2
suffix:semicolon
id|bi
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
id|KBD_ESCAPEE1
suffix:colon
id|ncodes
op_assign
l_int|3
suffix:semicolon
id|bi
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
id|KBD_BREAK
suffix:colon
id|status
op_or_assign
id|CODE_BREAK
suffix:semicolon
r_default
suffix:colon
r_return
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|ncodes
)paren
(brace
id|buffer
(braket
id|bi
op_increment
)braket
op_assign
id|keyval
suffix:semicolon
id|ncodes
op_sub_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|ncodes
)paren
r_return
suffix:semicolon
id|keysym
op_assign
id|K_NONE
suffix:semicolon
r_switch
c_cond
(paren
id|buffer
(braket
l_int|0
)braket
op_lshift
l_int|8
op_or
id|buffer
(braket
l_int|1
)braket
)paren
(brace
r_case
id|ESCE0
c_func
(paren
l_int|0x11
)paren
suffix:colon
id|keysym
op_assign
id|K_RALT
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ESCE0
c_func
(paren
l_int|0x14
)paren
suffix:colon
id|keysym
op_assign
id|K_RCTL
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ESCE0
c_func
(paren
l_int|0x4a
)paren
suffix:colon
id|keysym
op_assign
id|KP_SLH
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ESCE0
c_func
(paren
l_int|0x5a
)paren
suffix:colon
id|keysym
op_assign
id|KP_ENT
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ESCE0
c_func
(paren
l_int|0x69
)paren
suffix:colon
id|keysym
op_assign
id|K_END
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ESCE0
c_func
(paren
l_int|0x6b
)paren
suffix:colon
id|keysym
op_assign
id|K_LEFT
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ESCE0
c_func
(paren
l_int|0x6c
)paren
suffix:colon
id|keysym
op_assign
id|K_HOME
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ESCE0
c_func
(paren
l_int|0x70
)paren
suffix:colon
id|keysym
op_assign
id|K_INS
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ESCE0
c_func
(paren
l_int|0x71
)paren
suffix:colon
id|keysym
op_assign
id|K_DEL
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ESCE0
c_func
(paren
l_int|0x72
)paren
suffix:colon
id|keysym
op_assign
id|K_DOWN
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ESCE0
c_func
(paren
l_int|0x74
)paren
suffix:colon
id|keysym
op_assign
id|K_RGHT
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ESCE0
c_func
(paren
l_int|0x75
)paren
suffix:colon
id|keysym
op_assign
id|K_UP
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ESCE0
c_func
(paren
l_int|0x7a
)paren
suffix:colon
id|keysym
op_assign
id|K_PGDN
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ESCE0
c_func
(paren
l_int|0x7c
)paren
suffix:colon
id|keysym
op_assign
id|K_PRNT
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ESCE0
c_func
(paren
l_int|0x7d
)paren
suffix:colon
id|keysym
op_assign
id|K_PGUP
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ESCE1
c_func
(paren
l_int|0x14
)paren
suffix:colon
r_if
c_cond
(paren
id|buffer
(braket
l_int|2
)braket
op_eq
l_int|0x77
)paren
id|keysym
op_assign
id|K_BRK
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ESCE0
c_func
(paren
l_int|0x12
)paren
suffix:colon
multiline_comment|/* ignore escaped shift key */
id|status
op_assign
l_int|0
suffix:semicolon
r_return
suffix:semicolon
)brace
)brace
r_else
(brace
id|bi
op_assign
l_int|0
suffix:semicolon
id|keysym
op_assign
id|keycode_translate
(braket
id|keyval
)braket
suffix:semicolon
)brace
r_if
c_cond
(paren
id|keysym
op_ne
id|K_NONE
)paren
id|ps2kbd_key
c_func
(paren
id|keysym
comma
id|status
op_amp
id|CODE_BREAK
)paren
suffix:semicolon
id|status
op_assign
l_int|0
suffix:semicolon
)brace
DECL|function|ps2kbd_leds
r_void
id|ps2kbd_leds
c_func
(paren
r_int
r_int
id|leds
)paren
(brace
id|ps2kbd_sendbyte
c_func
(paren
id|KBD_SETLEDS
)paren
suffix:semicolon
id|ps2kbd_sendbyte
c_func
(paren
id|leds
)paren
suffix:semicolon
id|ps2kbd_sendbyte
c_func
(paren
id|KBD_SCANENABLE
)paren
suffix:semicolon
)brace
DECL|function|ps2kbd_rx
r_static
r_void
id|ps2kbd_rx
c_func
(paren
r_int
id|irq
comma
r_void
op_star
id|dev_id
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|kbd_pt_regs
op_assign
id|regs
suffix:semicolon
r_while
c_loop
(paren
id|inb
c_func
(paren
id|IOMD_KCTRL
)paren
op_amp
(paren
l_int|1
op_lshift
l_int|5
)paren
)paren
id|handle_rawcode
c_func
(paren
id|inb
c_func
(paren
id|IOMD_KARTRX
)paren
)paren
suffix:semicolon
id|tasklet_schedule
c_func
(paren
op_amp
id|keyboard_tasklet
)paren
suffix:semicolon
)brace
DECL|function|ps2kbd_tx
r_static
r_void
id|ps2kbd_tx
c_func
(paren
r_int
id|irq
comma
r_void
op_star
id|dev_id
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
)brace
DECL|function|ps2kbd_init_hw
r_int
id|__init
id|ps2kbd_init_hw
c_func
(paren
r_void
)paren
(brace
multiline_comment|/* Reset the keyboard state machine. */
id|outb
c_func
(paren
l_int|0
comma
id|IOMD_KCTRL
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|8
comma
id|IOMD_KCTRL
)paren
suffix:semicolon
(paren
r_void
)paren
id|IOMD_KARTRX
suffix:semicolon
r_if
c_cond
(paren
id|request_irq
(paren
id|IRQ_KEYBOARDRX
comma
id|ps2kbd_rx
comma
l_int|0
comma
l_string|&quot;keyboard&quot;
comma
l_int|NULL
)paren
op_ne
l_int|0
)paren
id|panic
c_func
(paren
l_string|&quot;Could not allocate keyboard receive IRQ!&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|request_irq
(paren
id|IRQ_KEYBOARDTX
comma
id|ps2kbd_tx
comma
l_int|0
comma
l_string|&quot;keyboard&quot;
comma
l_int|NULL
)paren
op_ne
l_int|0
)paren
id|panic
c_func
(paren
l_string|&quot;Could not allocate keyboard transmit IRQ!&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
eof
