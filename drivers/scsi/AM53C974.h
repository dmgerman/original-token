multiline_comment|/* AM53/79C974 (PCscsi) driver release 0.5&n; *&n; * The architecture and much of the code of this device&n; * driver was originally developed by Drew Eckhardt for&n; * the NCR5380. The following copyrights apply:&n; *  For the architecture and all parts similar to the NCR5380:&n; *    Copyright 1993, Drew Eckhardt&n; *&t;Visionary Computing &n; *&t;(Unix and Linux consulting and custom programming)&n; * &t;drew@colorado.edu&n; *&t;+1 (303) 666-5836&n; *&n; *  The AM53C974_nobios_detect code was originally developed by&n; *   Robin Cutshaw (robin@xfree86.org) and is used here in a &n; *   modified form.&n; *&n; *  For the other parts:&n; *    Copyright 1994, D. Frieauff&n; *    EMail: fri@rsx42sun0.dofn.de&n; *    Phone: x49-7545-8-2256 , x49-7541-42305&n; */
multiline_comment|/*&n; * $Log: AM53C974.h,v $&n; */
macro_line|#ifndef AM53C974_H
DECL|macro|AM53C974_H
mdefine_line|#define AM53C974_H
macro_line|#include &lt;scsi/scsicam.h&gt;
DECL|struct|AM53C974_hostdata
r_struct
id|AM53C974_hostdata
(brace
DECL|member|in_reset
r_volatile
r_int
id|in_reset
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/* flag, says bus reset pending */
DECL|member|aborted
r_volatile
r_int
id|aborted
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/* flag, says aborted */
DECL|member|selecting
r_volatile
r_int
id|selecting
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/* selection started, but not yet finished */
DECL|member|disconnecting
r_volatile
r_int
id|disconnecting
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/* disconnection started, but not yet finished */
DECL|member|dma_busy
r_volatile
r_int
id|dma_busy
suffix:colon
l_int|1
suffix:semicolon
multiline_comment|/* dma busy when service request for info transfer received */
DECL|member|msgout
r_volatile
r_int
r_char
id|msgout
(braket
l_int|10
)braket
suffix:semicolon
multiline_comment|/* message to output in MSGOUT_PHASE */
DECL|member|last_message
r_volatile
r_int
r_char
id|last_message
(braket
l_int|10
)braket
suffix:semicolon
multiline_comment|/* last message OUT */
DECL|member|issue_queue
r_volatile
id|Scsi_Cmnd
op_star
id|issue_queue
suffix:semicolon
multiline_comment|/* waiting to be issued */
DECL|member|disconnected_queue
r_volatile
id|Scsi_Cmnd
op_star
id|disconnected_queue
suffix:semicolon
multiline_comment|/* waiting for reconnect */
DECL|member|sel_cmd
r_volatile
id|Scsi_Cmnd
op_star
id|sel_cmd
suffix:semicolon
multiline_comment|/* command for selection */
DECL|member|connected
r_volatile
id|Scsi_Cmnd
op_star
id|connected
suffix:semicolon
multiline_comment|/* currently connected command */
DECL|member|busy
r_volatile
r_int
r_char
id|busy
(braket
l_int|8
)braket
suffix:semicolon
multiline_comment|/* index = target, bit = lun */
DECL|member|sync_per
r_int
r_char
id|sync_per
(braket
l_int|8
)braket
suffix:semicolon
multiline_comment|/* synchronous transfer period (in effect) */
DECL|member|sync_off
r_int
r_char
id|sync_off
(braket
l_int|8
)braket
suffix:semicolon
multiline_comment|/* synchronous offset (in effect) */
DECL|member|sync_neg
r_int
r_char
id|sync_neg
(braket
l_int|8
)braket
suffix:semicolon
multiline_comment|/* sync. negotiation performed (in effect) */
DECL|member|sync_en
r_int
r_char
id|sync_en
(braket
l_int|8
)braket
suffix:semicolon
multiline_comment|/* sync. negotiation performed (in effect) */
DECL|member|max_rate
r_int
r_char
id|max_rate
(braket
l_int|8
)braket
suffix:semicolon
multiline_comment|/* max. transfer rate (setup) */
DECL|member|max_offset
r_int
r_char
id|max_offset
(braket
l_int|8
)braket
suffix:semicolon
multiline_comment|/* max. sync. offset (setup), only valid if corresponding sync_en is nonzero */
)brace
suffix:semicolon
r_extern
r_struct
id|proc_dir_entry
id|proc_scsi_am53c974
suffix:semicolon
DECL|macro|AM53C974
mdefine_line|#define AM53C974 { &bslash;&n;    NULL,              &t;&t;/* pointer to next in list                      */  &bslash;&n;    NULL,&t;&t;&t;/* struct module *module&t;&t;&t;*/  &bslash;&n;    &amp;proc_scsi_am53c974,        /* struct proc_dir_entry *proc_dir              */ &bslash;&n;    NULL,                       /* int (*proc_info)(char *, char **, off_t, int, int, int); */ &bslash;&n;    &quot;AM53C974&quot;,        &t;&t;/* name                                         */  &bslash;&n;    AM53C974_detect,   &t;&t;/* int (* detect)(struct SHT *)                 */  &bslash;&n;    AM53C974_release,&t;&t;/* int (*release)(struct Scsi_Host *)           */  &bslash;&n;    AM53C974_info,     &t;&t;/* const char *(* info)(struct Scsi_Host *)     */  &bslash;&n;    AM53C974_command,  &t;&t;/* int (* command)(Scsi_Cmnd *)                 */  &bslash;&n;    AM53C974_queue_command,&t;/* int (* queuecommand)(Scsi_Cmnd *,                &bslash;&n;                                           void (*done)(Scsi_Cmnd *))           */  &bslash;&n;    AM53C974_abort,    &t;&t;/* int (* abort)(Scsi_Cmnd *)                   */  &bslash;&n;    AM53C974_reset,    &t;&t;/* int (* reset)(Scsi_Cmnd *)                   */  &bslash;&n;    NULL,                 &t;/* int (* slave_attach)(int, int)               */  &bslash;&n;    scsicam_bios_param,&t;&t;/* int (* bios_param)(Disk *, int, int[])       */  &bslash;&n;    12,                 &t;/* can_queue                                    */  &bslash;&n;    -1,                         /* this_id                                      */  &bslash;&n;    SG_ALL,            &t;&t;/* sg_tablesize                                 */  &bslash;&n;    1,                 &t;&t;/* cmd_per_lun                                  */  &bslash;&n;    0,                 &t;&t;/* present, i.e. how many adapters of this kind */  &bslash;&n;    0,                 &t;&t;/* unchecked_isa_dma                            */  &bslash;&n;    DISABLE_CLUSTERING &t;&t;/* use_clustering                               */  &bslash;&n;    }
r_void
id|AM53C974_setup
c_func
(paren
r_char
op_star
id|str
comma
r_int
op_star
id|ints
)paren
suffix:semicolon
r_int
id|AM53C974_detect
c_func
(paren
id|Scsi_Host_Template
op_star
id|tpnt
)paren
suffix:semicolon
r_int
id|AM53C974_release
c_func
(paren
r_struct
id|Scsi_Host
op_star
id|shp
)paren
suffix:semicolon
r_int
id|AM53C974_biosparm
c_func
(paren
id|Disk
op_star
id|disk
comma
r_int
id|dev
comma
r_int
op_star
id|info_array
)paren
suffix:semicolon
r_const
r_char
op_star
id|AM53C974_info
c_func
(paren
r_struct
id|Scsi_Host
op_star
)paren
suffix:semicolon
r_int
id|AM53C974_command
c_func
(paren
id|Scsi_Cmnd
op_star
id|SCpnt
)paren
suffix:semicolon
r_int
id|AM53C974_queue_command
c_func
(paren
id|Scsi_Cmnd
op_star
id|cmd
comma
r_void
(paren
op_star
id|done
)paren
(paren
id|Scsi_Cmnd
op_star
)paren
)paren
suffix:semicolon
r_int
id|AM53C974_abort
c_func
(paren
id|Scsi_Cmnd
op_star
id|cmd
)paren
suffix:semicolon
r_int
id|AM53C974_reset
(paren
id|Scsi_Cmnd
op_star
id|cmd
)paren
suffix:semicolon
macro_line|#endif /* AM53C974_H */
eof
