multiline_comment|/* $Id: advansys.c,v 1.15 1996/08/12 17:20:23 bobf Exp bobf $ */
multiline_comment|/*&n; * advansys.c - Linux Host Driver for AdvanSys SCSI Adapters&n; * &n; * Copyright (c) 1995-1996 Advanced System Products, Inc.&n; * All Rights Reserved.&n; *&n; * Redistribution and use in source and binary forms, with or without&n; * modification, are permitted provided that redistributions of source&n; * code retain the above copyright notice and this comment without&n; * modification.&n; *&n; * The latest version of this driver is available at the AdvanSys&n; * FTP and BBS sites listed below.&n; *&n; * Please send questions, comments, bug reports to:&n; * bobf@advansys.com (Bob Frey)&n; */
multiline_comment|/*&n; * The driver has been run with the v1.2.13, v1.3.57, and v2.0.11 kernels.&n; */
DECL|macro|ASC_VERSION
mdefine_line|#define ASC_VERSION &quot;1.5&quot;    /* AdvanSys Driver Version */
multiline_comment|/*&n;&n;  Documentation for the AdvanSys Driver&n;&n;  A. Adapters Supported by this Driver&n;  B. Linux v1.2.X - Directions for Adding the AdvanSys Driver&n;  C. Linux v1.3.X, v2.X.X - Directions for Adding the AdvanSys Driver&n;  D. Source Comments&n;  E. Driver Compile Time Options and Debugging&n;  F. Driver LILO Option&n;  G. Release History&n;  H. Known Problems or Issues&n;  I. Credits&n;  J. AdvanSys Contact Information&n;&n;  A. Adapters Supported by this Driver&n; &n;     AdvanSys (Advanced System Products, Inc.) manufactures the following&n;     Bus-Mastering SCSI-2 Host Adapters for the ISA, EISA, VL, and PCI&n;     buses. This Linux driver supports all of these adapters.&n;     &n;     The CDB counts below indicate the number of SCSI CDB (Command&n;     Descriptor Block) requests that can be stored in the RISC chip&n;     cache and board LRAM. A CDB is a single SCSI command. The driver&n;     detect routine will display the number of CDBs available for each&n;     adapter detected. This value can be lowered in the BIOS by changing&n;     the &squot;Host Queue Size&squot; adapter setting.&n;&n;     Connectivity Products:&n;        ABP510/5150 - Bus-Master ISA (240 CDB) (Footnote 1)&n;        ABP5140 - Bus-Master ISA PnP (16 CDB) (Footnote 1)&n;        ABP5142 - Bus-Master ISA PnP with floppy (16 CDB)&n;        ABP920 - Bus-Master PCI (16 CDB)&n;        ABP930 - Bus-Master PCI (16 CDB)&n;        ABP960 - Bus-Master PCI MAC/PC (16 CDB) (Footnote 2)&n;  &n;     Single Channel Products:&n;        ABP542 - Bus-Master ISA with floppy (240 CDB)&n;        ABP742 - Bus-Master EISA (240 CDB)&n;        ABP842 - Bus-Master VL (240 CDB)&n;        ABP940 - Bus-Master PCI (240 CDB)&n;        ABP940U - Bus-Master PCI Ultra (240 CDB)&n;        ABP970 - Bus-Master PCI MAC/PC (240 CDB)&n;     &n;     Dual Channel Products:&n;        ABP752 - Dual Channel Bus-Master EISA (240 CDB Per Channel)&n;        ABP852 - Dual Channel Bus-Master VL (240 CDB Per Channel)&n;        ABP950 - Dual Channel Bus-Master PCI (240 CDB Per Channel)&n;     &n;     Footnotes:&n;       1. These boards have been shipped by HP with the 4020i CD-R drive.&n;          They have no BIOS so they cannot control a boot device, but they&n;          can control secondary devices.&n;   &n;       2. This board has been shipped by Iomega with the Jaz Jet drive.&n;  &n;  B. Linux v1.2.X - Directions for Adding the AdvanSys Driver&n;&n;     These directions apply to v1.2.13. For versions that follow v1.2.13.&n;     but precede v1.3.57 some of the changes for Linux v1.3.X listed&n;     below may need to be modified or included.&n; &n;     There are two source files: advansys.h and advansys.c. Copy&n;     both of these files to the directory /usr/src/linux/drivers/scsi.&n;    &n;     1. Add the following line to /usr/src/linux/arch/i386/config.in&n;        after &quot;comment &squot;SCSI low-level drivers&squot;&quot;:&n;    &n;          bool &squot;AdvanSys SCSI support&squot; CONFIG_SCSI_ADVANSYS y&n;    &n;     2. Add the following lines to /usr/src/linux/drivers/scsi/hosts.c&n;        after &quot;#include &quot;hosts.h&quot;&quot;:&n;    &n;          #ifdef CONFIG_SCSI_ADVANSYS&n;          #include &quot;advansys.h&quot;&n;          #endif&n;    &n;        and after &quot;static Scsi_Host_Template builtin_scsi_hosts[] =&quot;:&n;    &n;          #ifdef CONFIG_SCSI_ADVANSYS&n;          ADVANSYS,&n;          #endif&n;    &n;     3. Add the following lines to /usr/src/linux/drivers/scsi/Makefile:&n;    &n;          ifdef CONFIG_SCSI_ADVANSYS&n;          SCSI_SRCS := $(SCSI_SRCS) advansys.c&n;          SCSI_OBJS := $(SCSI_OBJS) advansys.o&n;          else&n;          SCSI_MODULE_OBJS := $(SCSI_MODULE_OBJS) advansys.o&n;          endif&n;&n;     4. (Optional) If you would like to enable the LILO command line&n;        and /etc/lilo.conf &squot;advansys&squot; option, make the following changes.&n;        This option can be used to disable I/O port scanning or to limit&n;        I/O port scanning to specific addresses. Refer to the &squot;Driver&n;        LILO Option&squot; section below. Add the following lines to&n;        /usr/src/linux/init/main.c in the prototype section:&n;&n;          extern void advansys_setup(char *str, int *ints);&n;&n;        and add the following lines to the bootsetups[] array.&n;&n;          #ifdef CONFIG_SCSI_ADVANSYS&n;             { &quot;advansys=&quot;, advansys_setup },&n;          #endif&n;&n;     5. If you have the HP 4020i CD-R driver and Linux v1.2.X you should&n;        add a fix to the CD-ROM target driver. This fix will allow&n;        you to mount CDs with the iso9660 file system. Linux v1.3.X&n;        already has this fix. In the file /usr/src/linux/drivers/scsi/sr.c&n;        and function get_sectorsize() after the line:&n;&n;        if(scsi_CDs[i].sector_size == 0) scsi_CDs[i].sector_size = 2048;&n;&n;        add the following line:&n;&n;        if(scsi_CDs[i].sector_size == 2340) scsi_CDs[i].sector_size = 2048;&n;&n;     6. In the directory /usr/src/linux run &squot;make config&squot; to configure&n;        the AdvanSys driver, then run &squot;make vmlinux&squot; or &squot;make zlilo&squot; to&n;        make the kernel. If the AdvanSys driver is not configured, then&n;        a loadable module can be built by running &squot;make modules&squot; and&n;        &squot;make modules_install&squot;. Use &squot;insmod&squot; and &squot;rmmod&squot; to install&n;        and remove advansys.o.&n; &n;  C. Linux v1.3.X, v2.X.X - Directions for Adding the AdvanSys Driver&n;&n;     These directions apply to v1.3.57. For versions that precede v1.3.57&n;     some of these changes may need to be modified or eliminated. Beginning&n;     with v1.3.58 this driver is included with the Linux distribution.&n;&n;     There are two source files: advansys.h and advansys.c. Copy&n;     both of these files to the directory /usr/src/linux/drivers/scsi.&n;   &n;     1. Add the following line to /usr/src/linux/drivers/scsi/Config.in&n;        after &quot;comment &squot;SCSI low-level drivers&squot;&quot;:&n;   &n;          dep_tristate &squot;AdvanSys SCSI support&squot; CONFIG_SCSI_ADVANSYS $CONFIG_SCSI&n;   &n;     2. Add the following lines to /usr/src/linux/drivers/scsi/hosts.c&n;        after &quot;#include &quot;hosts.h&quot;&quot;:&n;   &n;          #ifdef CONFIG_SCSI_ADVANSYS&n;          #include &quot;advansys.h&quot;&n;          #endif&n;   &n;        and after &quot;static Scsi_Host_Template builtin_scsi_hosts[] =&quot;:&n;   &n;          #ifdef CONFIG_SCSI_ADVANSYS&n;          ADVANSYS,&n;          #endif&n;   &n;     3. Add the following lines to /usr/src/linux/drivers/scsi/Makefile:&n;   &n;          ifeq ($(CONFIG_SCSI_ADVANSYS),y)&n;          L_OBJS += advansys.o&n;          else&n;            ifeq ($(CONFIG_SCSI_ADVANSYS),m)&n;            M_OBJS += advansys.o&n;            endif&n;          endif&n;   &n;     4. Add the following line to /usr/src/linux/include/linux/proc_fs.h&n;        in the enum scsi_directory_inos array:&n;   &n;          PROC_SCSI_ADVANSYS,&n;   &n;     5. (Optional) If you would like to enable the LILO command line&n;        and /etc/lilo.conf &squot;advansys&squot; option, make the following changes.&n;        This option can be used to disable I/O port scanning or to limit&n;        I/O port scanning to specific addresses. Refer to the &squot;Driver&n;        LILO Option&squot; section below. Add the following lines to&n;        /usr/src/linux/init/main.c in the prototype section:&n;   &n;          extern void advansys_setup(char *str, int *ints);&n;   &n;        and add the following lines to the bootsetups[] array.&n;   &n;          #ifdef CONFIG_SCSI_ADVANSYS&n;             { &quot;advansys=&quot;, advansys_setup },&n;          #endif&n;   &n;     6. In the directory /usr/src/linux run &squot;make config&squot; to configure&n;        the AdvanSys driver, then run &squot;make vmlinux&squot; or &squot;make zlilo&squot; to&n;        make the kernel. If the AdvanSys driver is not configured, then&n;        a loadable module can be built by running &squot;make modules&squot; and&n;        &squot;make modules_install&squot;. Use &squot;insmod&squot; and &squot;rmmod&squot; to install&n;        and remove advansys.o.&n;&n;  D. Source Comments&n; &n;     1. Use tab stops set to 4 for the source files. For vi use &squot;se tabstops=4&squot;.&n; &n;     2. This driver should be maintained in multiple files. But to make&n;        it easier to include with Linux and to follow Linux conventions,&n;        the whole driver is maintained in the source files advansys.h and&n;        advansys.c. In this file logical sections of the driver begin with&n;        a comment that contains &squot;---&squot;. The following are the logical sections&n;        of the driver below.&n; &n;           --- Linux Version&n;           --- Linux Include Files &n;           --- Driver Options&n;           --- Asc Library Constants and Macros&n;           --- Debugging Header&n;           --- Driver Constants and Macros&n;           --- Driver Structures&n;           --- Driver Data&n;           --- Driver Function Prototypes&n;           --- Linux &squot;Scsi_Host_Template&squot; and advansys_setup() Functions&n;           --- Loadable Driver Support&n;           --- Miscellaneous Driver Functions&n;           --- Functions Required by the Asc Library&n;           --- Tracing and Debugging Functions&n;           --- Asc Library Functions&n; &n;     3. The string &squot;XXX&squot; is used to flag code that needs to be re-written&n;        or that contains a problem that needs to be addressed.&n; &n;     4. I have stripped comments from and reformatted the source for the&n;        Asc Library which is included in this file. I haven&squot;t done this&n;        to obfuscate the code. Actually I have done this to deobfuscate&n;        the code. The Asc Library source can be found under the following&n;        headings.&n; &n;           --- Asc Library Constants and Macros&n;           --- Asc Library Functions&n; &n;  E. Driver Compile Time Options and Debugging&n; &n;     In this source file the following constants can be defined. They are&n;     defined in the source below. Both of these options are enabled by&n;     default.&n; &n;     1. ADVANSYS_DEBUG - enable for debugging and assertions&n; &n;        The amount of debugging output can be controlled with the global&n;        variable &squot;asc_dbglvl&squot;. The higher the number the more output. By&n;        default the debug level is 0.&n;        &n;        If the driver is loaded at boot time and the LILO Driver Option&n;        is included in the system, the debug level can be changed by&n;        specifying a 5th (ASC_NUM_BOARD_SUPPORTED + 1) I/O Port. The&n;        first three hex digits of the pseudo I/O Port must be set to&n;        &squot;deb&squot; and the fourth hex digit specifies the debug level: 0 - F.&n;        The following command line will look for an adapter at 0x330&n;        and set the debug level to 2.&n;&n;           linux advansys=0x330,0,0,0,0xdeb2&n;&n;        If the driver is built as a loadable module this variable can be&n;        defined when the driver is loaded. The following insmod command&n;        will set the debug level to one.&n;  &n;           insmod advansys.o asc_dbglvl=1&n; &n;        Debugging Message Levels:&n;           0: Errors Only&n;           1: High-Level Tracing&n;           2-N: Verbose Tracing&n; &n;        I don&squot;t know the approved way for turning on printk()s to the&n;        console. Here&squot;s a program I use to do this. Debug output is&n;        logged in /var/adm/messages.&n; &n;          main()&n;          {&n;                  syscall(103, 7, 0, 0);&n;          }&n; &n;        I found that increasing LOG_BUF_LEN to 40960 in kernel/printk.c&n;        prevents most level 1 debug messages from being lost.&n; &n;     2. ADVANSYS_STATS - enable statistics&n; &n;        Statistics are maintained on a per adapter basis. Driver entry&n;        point call counts and tranfer size counts are maintained.&n;        Statistics are only available for kernels greater than or equal&n;        to v1.3.0 with the CONFIG_PROC_FS (/proc) file system configured.&n;&n;        AdvanSys SCSI adapter files have the following path name format:&n;&n;           /proc/scsi/advansys/[0-(ASC_NUM_BOARD_SUPPORTED-1)]&n;&n;        This information can be displayed with cat. For example:&n;&n;           cat /proc/scsi/advansys/0&n;&n;        When ADVANSYS_STATS is not defined the AdvanSys /proc files only&n;        contain adapter and device configuration information.&n;&n;&n;  F. Driver LILO Option&n; &n;     If init/main.c is modified as described in the &squot;Directions for Adding&n;     the AdvanSys Driver to Linux&squot; section (B.4.) above, the driver will&n;     recognize the &squot;advansys&squot; LILO command line and /etc/lilo.conf option.&n;     This option can be used to either disable I/O port scanning or to limit&n;     scanning to 1 - 4 I/O ports. Regardless of the option setting EISA and&n;     PCI boards will still be searched for and detected. This option only&n;     affects searching for ISA and VL boards.&n;&n;     Examples:&n;       1. Eliminate I/O port scanning:&n;            boot: linux advansys=&n;              or&n;            boot: linux advansys=0x0&n;       2. Limit I/O port scanning to one I/O port:&n;            boot: linux advansys=0x110&n;       3. Limit I/O port scanning to four I/O ports:&n;            boot: linux advansys=0x110,0x210,0x230,0x330&n;&n;     For a loadable module the same effect can be achieved by setting&n;     the &squot;asc_iopflag&squot; variable and &squot;asc_ioport&squot; array when loading&n;     the driver, e.g.&n;&n;           insmod advansys.o asc_iopflag=1 asc_ioport=0x110,0x330&n;&n;     If ADVANSYS_DEBUG is defined a 5th (ASC_NUM_BOARD_SUPPORTED + 1)&n;     I/O Port may be added to specify the driver debug level. Refer to&n;     the &squot;Driver Compile Time Options and Debugging&squot; section above for&n;     more information.&n;&n;  G. Release History&n;&n;     BETA-1.0 (12/23/95): &n;         First Release&n;&n;     BETA-1.1 (12/28/95):&n;         1. Prevent advansys_detect() from being called twice.&n;         2. Add LILO 0xdeb[0-f] option to set &squot;asc_dbglvl&squot;.&n;&n;     1.2 (1/12/96):&n;         1. Prevent re-entrancy in the interrupt handler which&n;            resulted in the driver hanging Linux.&n;         2. Fix problem that prevented ABP-940 cards from being&n;            recognized on some PCI motherboards.&n;         3. Add support for the ABP-5140 PnP ISA card.&n;         4. Fix check condition return status.&n;         5. Add conditionally compiled code for Linux v1.3.X.&n;&n;     1.3 (2/23/96):&n;         1. Fix problem in advansys_biosparam() that resulted in the&n;            wrong drive geometry being returned for drives &gt; 1GB with&n;            extended translation enabled.&n;         2. Add additional tracing during device initialization.&n;         3. Change code that only applies to ISA PnP adapter.&n;         4. Eliminate &squot;make dep&squot; warning.&n;         5. Try to fix problem with handling resets by increasing their&n;            timeout value.&n;&n;     1.4 (5/8/96):&n;         1. Change definitions to eliminate conflicts with other subsystems.&n;         2. Add versioning code for the shared interrupt changes.&n;         3. Eliminate problem in asc_rmqueue() with iterating after removing&n;            a request.&n;         4. Remove reset request loop problem from the &quot;Known Problems or&n;            Issues&quot; section. This problem was isolated and fixed in the&n;            mid-level SCSI driver.&n;        &n;     1.5 (8/8/96):&n;         1. Add support for ABP-940U (PCI Ultra) adapter.&n;         2. Add support for IRQ sharing by setting the SA_SHIRQ flag for&n;            request_irq and supplying a dev_id pointer to both request_irq()&n;            and free_irq().&n;         3. In AscSearchIOPortAddr11() restore a call to check_region() which&n;            should be used before any I/O port probing.&n;         4. Fix bug in asc_prt_hex() which resulted in the displaying&n;            the wrong data.&n;         5. Incorporate miscellaneous Asc Library bug fixes and new microcode.&n;         6. Change driver versioning to be specific to each Linux sub-level.&n;         7. Change statistics gathering to be per adapter instead of global&n;            to the driver.&n;         8. Add more information and statistics to the adapter /proc file:&n;            /proc/scsi/advansys[0...].&n;         9. Remove &squot;cmd_per_lun&squot; from the &quot;Known Problems or Issues&quot; list.&n;            This problem has been addressed with the SCSI mid-level changes&n;            made in v1.3.89. The advansys_select_queue_depths() function&n;            was added for the v1.3.89 changes.&n;&n;  H. Known Problems or Issues&n;&n;     1. For the first scsi command sent to a device the driver increases&n;        the timeout value. This gives the driver more time to perform&n;        its own initialization for the board and each device. The timeout&n;        value is only changed on the first scsi command for each device&n;        and never thereafter. The same change is made for reset commands.&n;&n;  I. Credits&n;&n;     Nathan Hartwell &lt;mage@cdc3.cdc.net&gt; provided the directions and&n;     basis for the Linux v1.3.X changes which were included in the&n;     1.2 release.&n;&n;     Thomas E Zerucha &lt;zerucha@shell.portal.com&gt; pointed out a bug&n;     in advansys_biosparam() which was fixed in the 1.3 release.&n;&n;  J. AdvanSys Contact Information&n; &n;     Mail:                   Advanced System Products, Inc.&n;                             1150 Ringwood Court&n;                             San Jose, CA 95131&n;     Operator:               1-408-383-9400&n;     FAX:                    1-408-383-9612&n;     Tech Support:           1-800-525-7440/1-408-467-2930&n;     BBS:                    1-408-383-9540 (14400,N,8,1)&n;     Interactive FAX:        1-408-383-9753&n;     Customer Direct Sales:  1-800-883-1099/1-408-383-5777&n;     Tech Support E-Mail:    support@advansys.com&n;     FTP Site:               ftp.advansys.com (login: anonymous)&n;     Web Site:               http://www.advansys.com&n;*/
multiline_comment|/*&n; * --- Linux Version&n; */
multiline_comment|/* Convert Linux Version, Patch-level, Sub-level to LINUX_VERSION_CODE. */
DECL|macro|ASC_LINUX_VERSION
mdefine_line|#define ASC_LINUX_VERSION(V, P, S)&t;(((V) * 65536) + ((P) * 256) + (S))
macro_line|#ifndef LINUX_VERSION_CODE
macro_line|#include &lt;linux/version.h&gt;
macro_line|#endif /* LINUX_VERSION_CODE */
multiline_comment|/*&n; * --- Linux Include Files &n; */
macro_line|#if LINUX_VERSION_CODE &gt;= ASC_LINUX_VERSION(1,3,0)
macro_line|#ifdef MODULE
macro_line|#include &lt;linux/module.h&gt;
macro_line|#endif /* MODULE */
macro_line|#endif /* version &gt;= v1.3.0 */
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/head.h&gt;
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/ioport.h&gt;
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/malloc.h&gt;
macro_line|#if LINUX_VERSION_CODE &gt;= ASC_LINUX_VERSION(1,3,0)
macro_line|#include &lt;linux/proc_fs.h&gt;
macro_line|#endif /* version &gt;= v1.3.0 */
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;asm/system.h&gt;
macro_line|#include &lt;asm/dma.h&gt;
macro_line|#if LINUX_VERSION_CODE &lt; ASC_LINUX_VERSION(1,3,0)
macro_line|#include &quot;../block/blk.h&quot;
macro_line|#else /* version &gt;= v1.3.0 */
macro_line|#include &lt;linux/blk.h&gt;
macro_line|#include &lt;linux/stat.h&gt;
macro_line|#endif /* version &gt;= v1.3.0 */
macro_line|#include &quot;scsi.h&quot;
macro_line|#include &quot;hosts.h&quot;
macro_line|#include &quot;sd.h&quot;
macro_line|#include &quot;advansys.h&quot;
multiline_comment|/*&n; * --- Driver Options&n; */
DECL|macro|ADVANSYS_DEBUG
mdefine_line|#define ADVANSYS_DEBUG /* Enable assertions and tracing. */
multiline_comment|/*&n; * Because of no /proc to display them, statistics are disabled&n; * for version prior to v1.3.0.&n; */
macro_line|#if LINUX_VERSION_CODE &lt; ASC_LINUX_VERSION(1,3,0)
DECL|macro|ADVANSYS_STATS
macro_line|#undef ADVANSYS_STATS /* Disable statistics */
macro_line|#else /* version &gt;= v1.3.0 */
DECL|macro|ADVANSYS_STATS
mdefine_line|#define ADVANSYS_STATS /* Enable statistics. */
macro_line|#endif /* version &gt;= v1.3.0 */
multiline_comment|/*&n; * --- Asc Library Constants and Macros&n; */
DECL|macro|ASC_LIB_VERSION_MAJOR
mdefine_line|#define ASC_LIB_VERSION_MAJOR  1
DECL|macro|ASC_LIB_VERSION_MINOR
mdefine_line|#define ASC_LIB_VERSION_MINOR  21
DECL|macro|ASC_LIB_SERIAL_NUMBER
mdefine_line|#define ASC_LIB_SERIAL_NUMBER  88
DECL|typedef|uchar
r_typedef
r_int
r_char
id|uchar
suffix:semicolon
macro_line|#ifndef NULL
DECL|macro|NULL
mdefine_line|#define NULL     (0)
macro_line|#endif
macro_line|#ifndef TRUE
DECL|macro|TRUE
mdefine_line|#define TRUE     (1)
macro_line|#endif
macro_line|#ifndef FALSE
DECL|macro|FALSE
mdefine_line|#define FALSE    (0)
macro_line|#endif
DECL|macro|REG
mdefine_line|#define  REG     register
DECL|macro|rchar
mdefine_line|#define rchar    REG __s8
DECL|macro|rshort
mdefine_line|#define rshort   REG __s16
DECL|macro|rint
mdefine_line|#define rint     REG __s32
DECL|macro|rlong
mdefine_line|#define rlong    REG __s32
DECL|macro|ruchar
mdefine_line|#define ruchar   REG __u8
DECL|macro|rushort
mdefine_line|#define rushort  REG __u16
DECL|macro|ruint
mdefine_line|#define ruint    REG __u32
DECL|macro|rulong
mdefine_line|#define rulong   REG __u32
DECL|macro|NULLPTR
mdefine_line|#define NULLPTR   ( void *)0
DECL|macro|FNULLPTR
mdefine_line|#define FNULLPTR  ( void dosfar *)0UL
DECL|macro|EOF
mdefine_line|#define EOF      (-1)
DECL|macro|EOS
mdefine_line|#define EOS      &squot;&bslash;0&squot;
DECL|macro|ERR
mdefine_line|#define ERR      (-1)
DECL|macro|UB_ERR
mdefine_line|#define UB_ERR   (uchar)(0xFF)
DECL|macro|UW_ERR
mdefine_line|#define UW_ERR   (uint)(0xFFFF)
DECL|macro|UL_ERR
mdefine_line|#define UL_ERR   (ulong)(0xFFFFFFFFUL)
DECL|macro|iseven_word
mdefine_line|#define iseven_word( val )  ( ( ( ( uint )val) &amp; ( uint )0x0001 ) == 0 )
DECL|macro|isodd_word
mdefine_line|#define isodd_word( val )   ( ( ( ( uint )val) &amp; ( uint )0x0001 ) != 0 )
DECL|macro|toeven_word
mdefine_line|#define toeven_word( val )  ( ( ( uint )val ) &amp; ( uint )0xFFFE )
DECL|macro|biton
mdefine_line|#define biton( val, bits )   ((( uint )( val &gt;&gt; bits ) &amp; (uint)0x0001 ) != 0 )
DECL|macro|bitoff
mdefine_line|#define bitoff( val, bits )  ((( uint )( val &gt;&gt; bits ) &amp; (uint)0x0001 ) == 0 )
DECL|macro|lbiton
mdefine_line|#define lbiton( val, bits )  ((( ulong )( val &gt;&gt; bits ) &amp; (ulong)0x00000001UL ) != 0 )
DECL|macro|lbitoff
mdefine_line|#define lbitoff( val, bits ) ((( ulong )( val &gt;&gt; bits ) &amp; (ulong)0x00000001UL ) == 0 )
DECL|macro|absh
mdefine_line|#define  absh( val )    ( ( val ) &lt; 0 ? -( val ) : ( val ) )
DECL|macro|swapbyte
mdefine_line|#define  swapbyte( ch )  ( ( ( (ch) &lt;&lt; 4 ) | ( (ch) &gt;&gt; 4 ) ) )
macro_line|#ifndef GBYTE
DECL|macro|GBYTE
mdefine_line|#define GBYTE       (0x40000000UL)
macro_line|#endif
macro_line|#ifndef MBYTE
DECL|macro|MBYTE
mdefine_line|#define MBYTE       (0x100000UL)
macro_line|#endif
macro_line|#ifndef KBYTE
DECL|macro|KBYTE
mdefine_line|#define KBYTE       (0x400)
macro_line|#endif
DECL|macro|HI_BYTE
mdefine_line|#define HI_BYTE(x) ( *( ( __u8 *)(&amp;x)+1 ) )
DECL|macro|LO_BYTE
mdefine_line|#define LO_BYTE(x) ( *( ( __u8 *)&amp;x ) )
DECL|macro|HI_WORD
mdefine_line|#define HI_WORD(x) ( *( ( __u16 *)(&amp;x)+1 ) )
DECL|macro|LO_WORD
mdefine_line|#define LO_WORD(x) ( *( ( __u16 *)&amp;x ) )
macro_line|#ifndef MAKEWORD
DECL|macro|MAKEWORD
mdefine_line|#define MAKEWORD(lo, hi)    ((__u16) (((__u16) lo) | ((__u16) hi &lt;&lt; 8)))
macro_line|#endif
macro_line|#ifndef MAKELONG
DECL|macro|MAKELONG
mdefine_line|#define MAKELONG(lo, hi)    ((__u32) (((__u32) lo) | ((__u32) hi &lt;&lt; 16)))
macro_line|#endif
DECL|macro|SwapWords
mdefine_line|#define SwapWords(dWord)        ((__u32) ((dWord &gt;&gt; 16) | (dWord &lt;&lt; 16)))
DECL|macro|SwapBytes
mdefine_line|#define SwapBytes(word)         ((__u16) ((word &gt;&gt; 8) | (word &lt;&lt; 8)))
DECL|macro|BigToLittle
mdefine_line|#define BigToLittle(dWord) ((__u32) (SwapWords(MAKELONG(SwapBytes(LO_WORD(dWord)), SwapBytes(HI_WORD(dWord))))))
DECL|macro|LittleToBig
mdefine_line|#define LittleToBig(dWord)      BigToLittle(dWord)
DECL|macro|AscPCICmdRegBits_BusMastering
mdefine_line|#define AscPCICmdRegBits_BusMastering     0x0007
DECL|macro|AscPCIConfigVendorIDRegister
mdefine_line|#define AscPCIConfigVendorIDRegister      0x0000
DECL|macro|AscPCIConfigDeviceIDRegister
mdefine_line|#define AscPCIConfigDeviceIDRegister      0x0002
DECL|macro|AscPCIConfigCommandRegister
mdefine_line|#define AscPCIConfigCommandRegister       0x0004
DECL|macro|AscPCIConfigStatusRegister
mdefine_line|#define AscPCIConfigStatusRegister        0x0006
DECL|macro|AscPCIConfigCacheSize
mdefine_line|#define AscPCIConfigCacheSize             0x000C
DECL|macro|AscPCIConfigLatencyTimer
mdefine_line|#define AscPCIConfigLatencyTimer          0x000D
DECL|macro|AscPCIIOBaseRegister
mdefine_line|#define AscPCIIOBaseRegister              0x0010
DECL|macro|ASC_PCI_ID2BUS
mdefine_line|#define ASC_PCI_ID2BUS( id )    ((id) &amp; 0xFF)
DECL|macro|ASC_PCI_ID2DEV
mdefine_line|#define ASC_PCI_ID2DEV( id )    (((id) &gt;&gt; 11) &amp; 0x1F)
DECL|macro|ASC_PCI_ID2FUNC
mdefine_line|#define ASC_PCI_ID2FUNC( id )   (((id) &gt;&gt; 8) &amp; 0x7)
DECL|macro|ASC_PCI_MKID
mdefine_line|#define ASC_PCI_MKID( bus, dev, func ) ((((dev) &amp; 0x1F) &lt;&lt; 11) | (((func) &amp; 0x7) &lt;&lt; 8) | ((bus) &amp; 0xFF))
DECL|macro|Lptr
mdefine_line|#define Lptr
DECL|macro|dosfar
mdefine_line|#define dosfar
DECL|macro|far
mdefine_line|#define far
DECL|macro|PortAddr
mdefine_line|#define PortAddr  unsigned short&t;/* port address size  */
DECL|macro|Ptr2Func
mdefine_line|#define Ptr2Func&t;ulong
DECL|macro|inp
mdefine_line|#define inp(port)           inb(port)
DECL|macro|inpw
mdefine_line|#define inpw(port)          inw(port)
DECL|macro|inpl
mdefine_line|#define inpl(port)    &t;&t;inl(port)
DECL|macro|outp
mdefine_line|#define outp(port, byte)    outb((byte), (port))
DECL|macro|outpw
mdefine_line|#define outpw(port, word)   outw((word), (port))
DECL|macro|outpl
mdefine_line|#define outpl(port, long)   outl((long), (port))
DECL|macro|ASC_MAX_SG_QUEUE
mdefine_line|#define ASC_MAX_SG_QUEUE&t;5
DECL|macro|ASC_MAX_SG_LIST
mdefine_line|#define ASC_MAX_SG_LIST&t;&t;(1 + ((ASC_SG_LIST_PER_Q) * (ASC_MAX_SG_QUEUE)))
DECL|macro|CC_INIT_INQ_DISPLAY
mdefine_line|#define CC_INIT_INQ_DISPLAY     FALSE
DECL|macro|CC_CLEAR_LRAM_SRB_PTR
mdefine_line|#define CC_CLEAR_LRAM_SRB_PTR   FALSE
DECL|macro|CC_VERIFY_LRAM_COPY
mdefine_line|#define CC_VERIFY_LRAM_COPY     FALSE
DECL|macro|CC_DEBUG_SG_LIST
mdefine_line|#define CC_DEBUG_SG_LIST        FALSE
DECL|macro|CC_FAST_STRING_IO
mdefine_line|#define CC_FAST_STRING_IO       FALSE
DECL|macro|CC_WRITE_IO_COUNT
mdefine_line|#define CC_WRITE_IO_COUNT       FALSE
DECL|macro|CC_CLEAR_DMA_REMAIN
mdefine_line|#define CC_CLEAR_DMA_REMAIN     FALSE
DECL|macro|CC_DISABLE_PCI_PARITY_INT
mdefine_line|#define CC_DISABLE_PCI_PARITY_INT TRUE
DECL|macro|CC_LINK_BUSY_Q
mdefine_line|#define CC_LINK_BUSY_Q         FALSE
DECL|macro|CC_LITTLE_ENDIAN_HOST
mdefine_line|#define CC_LITTLE_ENDIAN_HOST  TRUE
DECL|macro|CC_STRUCT_ALIGNED
mdefine_line|#define CC_STRUCT_ALIGNED      TRUE
DECL|macro|CC_MEMORY_MAPPED_IO
mdefine_line|#define CC_MEMORY_MAPPED_IO    FALSE
DECL|macro|CC_INCLUDE_EEP_CONFIG
mdefine_line|#define CC_INCLUDE_EEP_CONFIG  TRUE
DECL|macro|CC_PCI_ULTRA
mdefine_line|#define CC_PCI_ULTRA           TRUE
DECL|macro|CC_INIT_TARGET_READ_CAPACITY
mdefine_line|#define CC_INIT_TARGET_READ_CAPACITY    TRUE
DECL|macro|CC_INIT_TARGET_TEST_UNIT_READY
mdefine_line|#define CC_INIT_TARGET_TEST_UNIT_READY  TRUE
DECL|macro|CC_ASC_SCSI_Q_USRDEF
mdefine_line|#define CC_ASC_SCSI_Q_USRDEF         FALSE
DECL|macro|CC_ASC_SCSI_REQ_Q_USRDEF
mdefine_line|#define CC_ASC_SCSI_REQ_Q_USRDEF     FALSE
DECL|macro|CC_ASCISR_CHECK_INT_PENDING
mdefine_line|#define CC_ASCISR_CHECK_INT_PENDING  TRUE
DECL|macro|CC_CHK_FIX_EEP_CONTENT
mdefine_line|#define CC_CHK_FIX_EEP_CONTENT       TRUE
DECL|macro|CC_CHK_AND_COALESCE_SG_LIST
mdefine_line|#define CC_CHK_AND_COALESCE_SG_LIST  FALSE
DECL|macro|CC_DISABLE_PCI_PARITY_INT
mdefine_line|#define CC_DISABLE_PCI_PARITY_INT    TRUE
DECL|macro|CC_INCLUDE_EEP_CONFIG
mdefine_line|#define CC_INCLUDE_EEP_CONFIG        TRUE
DECL|macro|CC_INIT_INQ_DISPLAY
mdefine_line|#define CC_INIT_INQ_DISPLAY          FALSE
DECL|macro|CC_INIT_TARGET_TEST_UNIT_READY
mdefine_line|#define CC_INIT_TARGET_TEST_UNIT_READY  TRUE
DECL|macro|CC_INIT_TARGET_START_UNIT
mdefine_line|#define CC_INIT_TARGET_START_UNIT       TRUE
DECL|macro|CC_PLEXTOR_VL
mdefine_line|#define CC_PLEXTOR_VL                FALSE
DECL|macro|CC_TMP_USE_EEP_SDTR
mdefine_line|#define CC_TMP_USE_EEP_SDTR          FALSE
DECL|macro|CC_CHK_COND_REDO_SDTR
mdefine_line|#define CC_CHK_COND_REDO_SDTR        TRUE
DECL|macro|CC_SET_PCI_LATENCY_TIMER_ZERO
mdefine_line|#define CC_SET_PCI_LATENCY_TIMER_ZERO  TRUE
DECL|macro|CC_FIX_QUANTUM_XP34301_1071
mdefine_line|#define CC_FIX_QUANTUM_XP34301_1071  FALSE
DECL|macro|CC_DISABLE_ASYN_FIX_WANGTEK_TAPE
mdefine_line|#define CC_DISABLE_ASYN_FIX_WANGTEK_TAPE  TRUE
DECL|macro|ASC_CS_TYPE
mdefine_line|#define ASC_CS_TYPE  unsigned short
macro_line|#ifndef asc_ptr_type
DECL|macro|asc_ptr_type
mdefine_line|#define asc_ptr_type
macro_line|#endif
macro_line|#ifndef ASC_GET_PTR2FUNC
DECL|macro|ASC_GET_PTR2FUNC
mdefine_line|#define ASC_GET_PTR2FUNC( fun )  ( Ptr2Func )( fun )
macro_line|#endif
DECL|macro|FLIP_BYTE_NIBBLE
mdefine_line|#define FLIP_BYTE_NIBBLE( x )    ( ((x&lt;&lt;4)&amp; 0xFF) | (x&gt;&gt;4) )
DECL|macro|ASC_IS_ISA
mdefine_line|#define ASC_IS_ISA          (0x0001)
DECL|macro|ASC_IS_ISAPNP
mdefine_line|#define ASC_IS_ISAPNP       (0x0081)
DECL|macro|ASC_IS_EISA
mdefine_line|#define ASC_IS_EISA         (0x0002)
DECL|macro|ASC_IS_PCI
mdefine_line|#define ASC_IS_PCI          (0x0004)
DECL|macro|ASC_IS_PCI_ULTRA
mdefine_line|#define ASC_IS_PCI_ULTRA    (0x0104)
DECL|macro|ASC_IS_PCMCIA
mdefine_line|#define ASC_IS_PCMCIA       (0x0008)
DECL|macro|ASC_IS_MCA
mdefine_line|#define ASC_IS_MCA          (0x0020)
DECL|macro|ASC_IS_VL
mdefine_line|#define ASC_IS_VL           (0x0040)
DECL|macro|ASC_ISA_PNP_PORT_ADDR
mdefine_line|#define ASC_ISA_PNP_PORT_ADDR  (0x279)
DECL|macro|ASC_ISA_PNP_PORT_WRITE
mdefine_line|#define ASC_ISA_PNP_PORT_WRITE (ASC_ISA_PNP_PORT_ADDR+0x800)
DECL|macro|ASC_IS_WIDESCSI_16
mdefine_line|#define ASC_IS_WIDESCSI_16  (0x0100)
DECL|macro|ASC_IS_WIDESCSI_32
mdefine_line|#define ASC_IS_WIDESCSI_32  (0x0200)
DECL|macro|ASC_IS_BIG_ENDIAN
mdefine_line|#define ASC_IS_BIG_ENDIAN   (0x8000)
DECL|macro|ASC_CHIP_MIN_VER_VL
mdefine_line|#define ASC_CHIP_MIN_VER_VL      (0x01)
DECL|macro|ASC_CHIP_MAX_VER_VL
mdefine_line|#define ASC_CHIP_MAX_VER_VL      (0x07)
DECL|macro|ASC_CHIP_MIN_VER_PCI
mdefine_line|#define ASC_CHIP_MIN_VER_PCI     (0x09)
DECL|macro|ASC_CHIP_MAX_VER_PCI
mdefine_line|#define ASC_CHIP_MAX_VER_PCI     (0x0F)
DECL|macro|ASC_CHIP_VER_PCI_BIT
mdefine_line|#define ASC_CHIP_VER_PCI_BIT     (0x08)
DECL|macro|ASC_CHIP_MIN_VER_ISA
mdefine_line|#define ASC_CHIP_MIN_VER_ISA     (0x11)
DECL|macro|ASC_CHIP_MIN_VER_ISA_PNP
mdefine_line|#define ASC_CHIP_MIN_VER_ISA_PNP (0x21)
DECL|macro|ASC_CHIP_MAX_VER_ISA
mdefine_line|#define ASC_CHIP_MAX_VER_ISA     (0x27)
DECL|macro|ASC_CHIP_VER_ISA_BIT
mdefine_line|#define ASC_CHIP_VER_ISA_BIT     (0x30)
DECL|macro|ASC_CHIP_VER_ISAPNP_BIT
mdefine_line|#define ASC_CHIP_VER_ISAPNP_BIT  (0x20)
DECL|macro|ASC_CHIP_VER_ASYN_BUG
mdefine_line|#define ASC_CHIP_VER_ASYN_BUG    (0x21)
DECL|macro|ASC_CHIP_VER_1ST_PCI_ULTRA
mdefine_line|#define ASC_CHIP_VER_1ST_PCI_ULTRA   (0x0A)
DECL|macro|ASC_CHIP_MIN_VER_EISA
mdefine_line|#define ASC_CHIP_MIN_VER_EISA (0x41)
DECL|macro|ASC_CHIP_MAX_VER_EISA
mdefine_line|#define ASC_CHIP_MAX_VER_EISA (0x47)
DECL|macro|ASC_CHIP_VER_EISA_BIT
mdefine_line|#define ASC_CHIP_VER_EISA_BIT (0x40)
DECL|macro|ASC_CHIP_LATEST_VER_EISA
mdefine_line|#define ASC_CHIP_LATEST_VER_EISA   ( ( ASC_CHIP_MIN_VER_EISA - 1 ) + 3 )
DECL|macro|ASC_MAX_VL_DMA_ADDR
mdefine_line|#define ASC_MAX_VL_DMA_ADDR     (0x07FFFFFFL)
DECL|macro|ASC_MAX_VL_DMA_COUNT
mdefine_line|#define ASC_MAX_VL_DMA_COUNT    (0x07FFFFFFL)
DECL|macro|ASC_MAX_PCI_DMA_ADDR
mdefine_line|#define ASC_MAX_PCI_DMA_ADDR    (0xFFFFFFFFL)
DECL|macro|ASC_MAX_PCI_DMA_COUNT
mdefine_line|#define ASC_MAX_PCI_DMA_COUNT   (0xFFFFFFFFL)
DECL|macro|ASC_MAX_ISA_DMA_ADDR
mdefine_line|#define ASC_MAX_ISA_DMA_ADDR    (0x00FFFFFFL)
DECL|macro|ASC_MAX_ISA_DMA_COUNT
mdefine_line|#define ASC_MAX_ISA_DMA_COUNT   (0x00FFFFFFL)
DECL|macro|ASC_MAX_EISA_DMA_ADDR
mdefine_line|#define ASC_MAX_EISA_DMA_ADDR   (0x07FFFFFFL)
DECL|macro|ASC_MAX_EISA_DMA_COUNT
mdefine_line|#define ASC_MAX_EISA_DMA_COUNT  (0x07FFFFFFL)
macro_line|#if !CC_STRUCT_ALIGNED
DECL|macro|DvcGetQinfo
mdefine_line|#define DvcGetQinfo( iop_base, s_addr, outbuf, words)  &bslash;&n;AscMemWordCopyFromLram(iop_base, s_addr, outbuf, words)
DECL|macro|DvcPutScsiQ
mdefine_line|#define DvcPutScsiQ( iop_base, s_addr, outbuf, words) &bslash;&n;AscMemWordCopyToLram(iop_base, s_addr, outbuf, words)
macro_line|#endif
macro_line|#ifdef ASC_CHIP_VERSION
macro_line|#endif
macro_line|#if CC_MEMORY_MAPPED_IO
DECL|macro|inp
mdefine_line|#define inp( port )            *( (uchar *)(port) )
DECL|macro|outp
mdefine_line|#define outp( port, data )     *( (uchar *)(port) ) = ( uchar )( data )
macro_line|#if CC_LITTLE_ENDIAN_HOST
DECL|macro|inpw
mdefine_line|#define inpw( port )              *( (ushort *)(port) )
DECL|macro|outpw
mdefine_line|#define outpw( port, data )       *( (ushort *)(port) ) = ( ushort )( data )
macro_line|#else
DECL|macro|inpw
mdefine_line|#define inpw( port )             EndianSwap16Bit( (*((ushort *)(port))) )
DECL|macro|outpw
mdefine_line|#define outpw( port, data )      *( (ushort *)(port) ) = EndianSwap16Bit( (ushort)(data) )
DECL|macro|inpw_noswap
mdefine_line|#define inpw_noswap( port )          *( (ushort *)(port) )
DECL|macro|outpw_noswap
mdefine_line|#define outpw_noswap( port, data )   *( (ushort *)(port) ) = ( ushort )( data )
macro_line|#endif
macro_line|#endif
macro_line|#ifndef inpw_noswap
DECL|macro|inpw_noswap
mdefine_line|#define inpw_noswap( port )         inpw( port )
macro_line|#endif
macro_line|#ifndef outpw_noswap
DECL|macro|outpw_noswap
mdefine_line|#define outpw_noswap( port, data )  outpw( port, data )
macro_line|#endif
DECL|macro|ASC_SCSI_ID_BITS
mdefine_line|#define ASC_SCSI_ID_BITS  3
DECL|macro|ASC_SCSI_TIX_TYPE
mdefine_line|#define ASC_SCSI_TIX_TYPE     uchar
DECL|macro|ASC_ALL_DEVICE_BIT_SET
mdefine_line|#define ASC_ALL_DEVICE_BIT_SET  0xFF
macro_line|#ifdef ASC_WIDESCSI_16
DECL|macro|ASC_SCSI_ID_BITS
macro_line|#undef  ASC_SCSI_ID_BITS
DECL|macro|ASC_SCSI_ID_BITS
mdefine_line|#define ASC_SCSI_ID_BITS  4
DECL|macro|ASC_ALL_DEVICE_BIT_SET
mdefine_line|#define ASC_ALL_DEVICE_BIT_SET  0xFFFF
macro_line|#endif
macro_line|#ifdef ASC_WIDESCSI_32
DECL|macro|ASC_SCSI_ID_BITS
macro_line|#undef  ASC_SCSI_ID_BITS
DECL|macro|ASC_SCSI_ID_BITS
mdefine_line|#define ASC_SCSI_ID_BITS  5
DECL|macro|ASC_ALL_DEVICE_BIT_SET
mdefine_line|#define ASC_ALL_DEVICE_BIT_SET  0xFFFFFFFFL
macro_line|#endif
macro_line|#if ASC_SCSI_ID_BITS == 3
DECL|macro|ASC_SCSI_BIT_ID_TYPE
mdefine_line|#define ASC_SCSI_BIT_ID_TYPE  uchar
DECL|macro|ASC_MAX_TID
mdefine_line|#define ASC_MAX_TID       7
DECL|macro|ASC_MAX_LUN
mdefine_line|#define ASC_MAX_LUN       7
DECL|macro|ASC_SCSI_WIDTH_BIT_SET
mdefine_line|#define ASC_SCSI_WIDTH_BIT_SET  0xFF
macro_line|#elif ASC_SCSI_ID_BITS == 4
DECL|macro|ASC_SCSI_BIT_ID_TYPE
mdefine_line|#define ASC_SCSI_BIT_ID_TYPE   ushort
DECL|macro|ASC_MAX_TID
mdefine_line|#define ASC_MAX_TID         15
DECL|macro|ASC_MAX_LUN
mdefine_line|#define ASC_MAX_LUN         7
DECL|macro|ASC_SCSI_WIDTH_BIT_SET
mdefine_line|#define ASC_SCSI_WIDTH_BIT_SET  0xFFFF
macro_line|#elif ASC_SCSI_ID_BITS == 5
DECL|macro|ASC_SCSI_BIT_ID_TYPE
mdefine_line|#define ASC_SCSI_BIT_ID_TYPE    ulong
DECL|macro|ASC_MAX_TID
mdefine_line|#define ASC_MAX_TID         31
DECL|macro|ASC_MAX_LUN
mdefine_line|#define ASC_MAX_LUN         7
DECL|macro|ASC_SCSI_WIDTH_BIT_SET
mdefine_line|#define ASC_SCSI_WIDTH_BIT_SET  0xFFFFFFFF
macro_line|#else
macro_line|#error  ASC_SCSI_ID_BITS definition is wrong
macro_line|#endif
DECL|macro|ASC_MAX_SENSE_LEN
mdefine_line|#define ASC_MAX_SENSE_LEN   32
DECL|macro|ASC_MIN_SENSE_LEN
mdefine_line|#define ASC_MIN_SENSE_LEN   14
DECL|macro|ASC_MAX_CDB_LEN
mdefine_line|#define ASC_MAX_CDB_LEN     12
DECL|macro|SCSICMD_TestUnitReady
mdefine_line|#define SCSICMD_TestUnitReady     0x00
DECL|macro|SCSICMD_Rewind
mdefine_line|#define SCSICMD_Rewind            0x01
DECL|macro|SCSICMD_Rezero
mdefine_line|#define SCSICMD_Rezero            0x01
DECL|macro|SCSICMD_RequestSense
mdefine_line|#define SCSICMD_RequestSense      0x03
DECL|macro|SCSICMD_Format
mdefine_line|#define SCSICMD_Format            0x04
DECL|macro|SCSICMD_FormatUnit
mdefine_line|#define SCSICMD_FormatUnit        0x04
DECL|macro|SCSICMD_Read6
mdefine_line|#define SCSICMD_Read6             0x08
DECL|macro|SCSICMD_Write6
mdefine_line|#define SCSICMD_Write6            0x0A
DECL|macro|SCSICMD_Seek6
mdefine_line|#define SCSICMD_Seek6             0x0B
DECL|macro|SCSICMD_Inquiry
mdefine_line|#define SCSICMD_Inquiry           0x12
DECL|macro|SCSICMD_Verify6
mdefine_line|#define SCSICMD_Verify6           0x13
DECL|macro|SCSICMD_ModeSelect6
mdefine_line|#define SCSICMD_ModeSelect6       0x15
DECL|macro|SCSICMD_ModeSense6
mdefine_line|#define SCSICMD_ModeSense6        0x1A
DECL|macro|SCSICMD_StartStopUnit
mdefine_line|#define SCSICMD_StartStopUnit     0x1B
DECL|macro|SCSICMD_LoadUnloadTape
mdefine_line|#define SCSICMD_LoadUnloadTape    0x1B
DECL|macro|SCSICMD_ReadCapacity
mdefine_line|#define SCSICMD_ReadCapacity      0x25
DECL|macro|SCSICMD_Read10
mdefine_line|#define SCSICMD_Read10            0x28
DECL|macro|SCSICMD_Write10
mdefine_line|#define SCSICMD_Write10           0x2A
DECL|macro|SCSICMD_Seek10
mdefine_line|#define SCSICMD_Seek10            0x2B
DECL|macro|SCSICMD_Erase10
mdefine_line|#define SCSICMD_Erase10           0x2C
DECL|macro|SCSICMD_WriteAndVerify10
mdefine_line|#define SCSICMD_WriteAndVerify10  0x2E
DECL|macro|SCSICMD_Verify10
mdefine_line|#define SCSICMD_Verify10          0x2F
DECL|macro|SCSICMD_WriteBuffer
mdefine_line|#define SCSICMD_WriteBuffer       0x3B
DECL|macro|SCSICMD_ReadBuffer
mdefine_line|#define SCSICMD_ReadBuffer        0x3C
DECL|macro|SCSICMD_ReadLong
mdefine_line|#define SCSICMD_ReadLong          0x3E
DECL|macro|SCSICMD_WriteLong
mdefine_line|#define SCSICMD_WriteLong         0x3F
DECL|macro|SCSICMD_ReadTOC
mdefine_line|#define SCSICMD_ReadTOC           0x43
DECL|macro|SCSICMD_ReadHeader
mdefine_line|#define SCSICMD_ReadHeader        0x44
DECL|macro|SCSICMD_ModeSelect10
mdefine_line|#define SCSICMD_ModeSelect10      0x55
DECL|macro|SCSICMD_ModeSense10
mdefine_line|#define SCSICMD_ModeSense10       0x5A
DECL|macro|SCSI_TYPE_DASD
mdefine_line|#define SCSI_TYPE_DASD     0x00
DECL|macro|SCSI_TYPE_SASD
mdefine_line|#define SCSI_TYPE_SASD     0x01
DECL|macro|SCSI_TYPE_PRN
mdefine_line|#define SCSI_TYPE_PRN      0x02
DECL|macro|SCSI_TYPE_PROC
mdefine_line|#define SCSI_TYPE_PROC     0x03
DECL|macro|SCSI_TYPE_WORM
mdefine_line|#define SCSI_TYPE_WORM     0x04
DECL|macro|SCSI_TYPE_CDROM
mdefine_line|#define SCSI_TYPE_CDROM    0x05
DECL|macro|SCSI_TYPE_SCANNER
mdefine_line|#define SCSI_TYPE_SCANNER  0x06
DECL|macro|SCSI_TYPE_OPTMEM
mdefine_line|#define SCSI_TYPE_OPTMEM   0x07
DECL|macro|SCSI_TYPE_MED_CHG
mdefine_line|#define SCSI_TYPE_MED_CHG  0x08
DECL|macro|SCSI_TYPE_COMM
mdefine_line|#define SCSI_TYPE_COMM     0x09
DECL|macro|SCSI_TYPE_UNKNOWN
mdefine_line|#define SCSI_TYPE_UNKNOWN  0x1F
DECL|macro|SCSI_TYPE_NO_DVC
mdefine_line|#define SCSI_TYPE_NO_DVC   0xFF
DECL|macro|ASC_SCSIDIR_NOCHK
mdefine_line|#define ASC_SCSIDIR_NOCHK    0x00
DECL|macro|ASC_SCSIDIR_T2H
mdefine_line|#define ASC_SCSIDIR_T2H      0x08
DECL|macro|ASC_SCSIDIR_H2T
mdefine_line|#define ASC_SCSIDIR_H2T      0x10
DECL|macro|ASC_SCSIDIR_NODATA
mdefine_line|#define ASC_SCSIDIR_NODATA   0x18
DECL|macro|SCSI_SENKEY_NO_SENSE
mdefine_line|#define SCSI_SENKEY_NO_SENSE      0x00
DECL|macro|SCSI_SENKEY_UNDEFINED
mdefine_line|#define SCSI_SENKEY_UNDEFINED     0x01
DECL|macro|SCSI_SENKEY_NOT_READY
mdefine_line|#define SCSI_SENKEY_NOT_READY     0x02
DECL|macro|SCSI_SENKEY_MEDIUM_ERR
mdefine_line|#define SCSI_SENKEY_MEDIUM_ERR    0x03
DECL|macro|SCSI_SENKEY_HW_ERR
mdefine_line|#define SCSI_SENKEY_HW_ERR        0x04
DECL|macro|SCSI_SENKEY_ILLEGAL
mdefine_line|#define SCSI_SENKEY_ILLEGAL       0x05
DECL|macro|SCSI_SENKEY_ATTENSION
mdefine_line|#define SCSI_SENKEY_ATTENSION     0x06
DECL|macro|SCSI_SENKEY_PROTECTED
mdefine_line|#define SCSI_SENKEY_PROTECTED     0x07
DECL|macro|SCSI_SENKEY_BLANK
mdefine_line|#define SCSI_SENKEY_BLANK         0x08
DECL|macro|SCSI_SENKEY_V_UNIQUE
mdefine_line|#define SCSI_SENKEY_V_UNIQUE      0x09
DECL|macro|SCSI_SENKEY_CPY_ABORT
mdefine_line|#define SCSI_SENKEY_CPY_ABORT     0x0A
DECL|macro|SCSI_SENKEY_ABORT
mdefine_line|#define SCSI_SENKEY_ABORT         0x0B
DECL|macro|SCSI_SENKEY_EQUAL
mdefine_line|#define SCSI_SENKEY_EQUAL         0x0C
DECL|macro|SCSI_SENKEY_VOL_OVERFLOW
mdefine_line|#define SCSI_SENKEY_VOL_OVERFLOW  0x0D
DECL|macro|SCSI_SENKEY_MISCOMP
mdefine_line|#define SCSI_SENKEY_MISCOMP       0x0E
DECL|macro|SCSI_SENKEY_RESERVED
mdefine_line|#define SCSI_SENKEY_RESERVED      0x0F
DECL|macro|ASC_SRB_HOST
mdefine_line|#define ASC_SRB_HOST( x )  ( ( uchar )( ( uchar )( x ) &gt;&gt; 4 ) )
DECL|macro|ASC_SRB_TID
mdefine_line|#define ASC_SRB_TID( x )   ( ( uchar )( ( uchar )( x ) &amp; ( uchar )0x0F ) )
DECL|macro|ASC_SRB_LUN
mdefine_line|#define ASC_SRB_LUN( x )   ( ( uchar )( ( uint )( x ) &gt;&gt; 13 ) )
DECL|macro|PUT_CDB1
mdefine_line|#define PUT_CDB1( x )   ( ( uchar )( ( uint )( x ) &gt;&gt; 8 ) )
DECL|macro|SS_GOOD
mdefine_line|#define SS_GOOD              0x00
DECL|macro|SS_CHK_CONDITION
mdefine_line|#define SS_CHK_CONDITION     0x02
DECL|macro|SS_CONDITION_MET
mdefine_line|#define SS_CONDITION_MET     0x04
DECL|macro|SS_TARGET_BUSY
mdefine_line|#define SS_TARGET_BUSY       0x08
DECL|macro|SS_INTERMID
mdefine_line|#define SS_INTERMID          0x10
DECL|macro|SS_INTERMID_COND_MET
mdefine_line|#define SS_INTERMID_COND_MET 0x14
DECL|macro|SS_RSERV_CONFLICT
mdefine_line|#define SS_RSERV_CONFLICT    0x18
DECL|macro|SS_CMD_TERMINATED
mdefine_line|#define SS_CMD_TERMINATED    0x22
DECL|macro|SS_QUEUE_FULL
mdefine_line|#define SS_QUEUE_FULL        0x28
DECL|macro|MS_CMD_DONE
mdefine_line|#define MS_CMD_DONE    0x00
DECL|macro|MS_EXTEND
mdefine_line|#define MS_EXTEND      0x01
DECL|macro|MS_SDTR_LEN
mdefine_line|#define MS_SDTR_LEN    0x03
DECL|macro|MS_SDTR_CODE
mdefine_line|#define MS_SDTR_CODE   0x01
DECL|macro|M1_SAVE_DATA_PTR
mdefine_line|#define M1_SAVE_DATA_PTR        0x02
DECL|macro|M1_RESTORE_PTRS
mdefine_line|#define M1_RESTORE_PTRS         0x03
DECL|macro|M1_DISCONNECT
mdefine_line|#define M1_DISCONNECT           0x04
DECL|macro|M1_INIT_DETECTED_ERR
mdefine_line|#define M1_INIT_DETECTED_ERR    0x05
DECL|macro|M1_ABORT
mdefine_line|#define M1_ABORT                0x06
DECL|macro|M1_MSG_REJECT
mdefine_line|#define M1_MSG_REJECT           0x07
DECL|macro|M1_NO_OP
mdefine_line|#define M1_NO_OP                0x08
DECL|macro|M1_MSG_PARITY_ERR
mdefine_line|#define M1_MSG_PARITY_ERR       0x09
DECL|macro|M1_LINK_CMD_DONE
mdefine_line|#define M1_LINK_CMD_DONE        0x0A
DECL|macro|M1_LINK_CMD_DONE_WFLAG
mdefine_line|#define M1_LINK_CMD_DONE_WFLAG  0x0B
DECL|macro|M1_BUS_DVC_RESET
mdefine_line|#define M1_BUS_DVC_RESET        0x0C
DECL|macro|M1_ABORT_TAG
mdefine_line|#define M1_ABORT_TAG            0x0D
DECL|macro|M1_CLR_QUEUE
mdefine_line|#define M1_CLR_QUEUE            0x0E
DECL|macro|M1_INIT_RECOVERY
mdefine_line|#define M1_INIT_RECOVERY        0x0F
DECL|macro|M1_RELEASE_RECOVERY
mdefine_line|#define M1_RELEASE_RECOVERY     0x10
DECL|macro|M1_KILL_IO_PROC
mdefine_line|#define M1_KILL_IO_PROC         0x11
DECL|macro|M2_QTAG_MSG_SIMPLE
mdefine_line|#define M2_QTAG_MSG_SIMPLE      0x20
DECL|macro|M2_QTAG_MSG_HEAD
mdefine_line|#define M2_QTAG_MSG_HEAD        0x21
DECL|macro|M2_QTAG_MSG_ORDERED
mdefine_line|#define M2_QTAG_MSG_ORDERED     0x22
DECL|macro|M2_IGNORE_WIDE_RESIDUE
mdefine_line|#define M2_IGNORE_WIDE_RESIDUE  0x23
macro_line|#if CC_LITTLE_ENDIAN_HOST
r_typedef
r_struct
(brace
DECL|member|peri_dvc_type
id|uchar
id|peri_dvc_type
suffix:colon
l_int|5
suffix:semicolon
DECL|member|peri_qualifier
id|uchar
id|peri_qualifier
suffix:colon
l_int|3
suffix:semicolon
DECL|typedef|ASC_SCSI_INQ0
)brace
id|ASC_SCSI_INQ0
suffix:semicolon
macro_line|#else
r_typedef
r_struct
(brace
DECL|member|peri_qualifier
id|uchar
id|peri_qualifier
suffix:colon
l_int|3
suffix:semicolon
DECL|member|peri_dvc_type
id|uchar
id|peri_dvc_type
suffix:colon
l_int|5
suffix:semicolon
DECL|typedef|ASC_SCSI_INQ0
)brace
id|ASC_SCSI_INQ0
suffix:semicolon
macro_line|#endif
macro_line|#if CC_LITTLE_ENDIAN_HOST
r_typedef
r_struct
(brace
DECL|member|dvc_type_modifier
id|uchar
id|dvc_type_modifier
suffix:colon
l_int|7
suffix:semicolon
DECL|member|rmb
id|uchar
id|rmb
suffix:colon
l_int|1
suffix:semicolon
DECL|typedef|ASC_SCSI_INQ1
)brace
id|ASC_SCSI_INQ1
suffix:semicolon
macro_line|#else
r_typedef
r_struct
(brace
DECL|member|rmb
id|uchar
id|rmb
suffix:colon
l_int|1
suffix:semicolon
DECL|member|dvc_type_modifier
id|uchar
id|dvc_type_modifier
suffix:colon
l_int|7
suffix:semicolon
DECL|typedef|ASC_SCSI_INQ1
)brace
id|ASC_SCSI_INQ1
suffix:semicolon
macro_line|#endif
macro_line|#if CC_LITTLE_ENDIAN_HOST
r_typedef
r_struct
(brace
DECL|member|ansi_apr_ver
id|uchar
id|ansi_apr_ver
suffix:colon
l_int|3
suffix:semicolon
DECL|member|ecma_ver
id|uchar
id|ecma_ver
suffix:colon
l_int|3
suffix:semicolon
DECL|member|iso_ver
id|uchar
id|iso_ver
suffix:colon
l_int|2
suffix:semicolon
DECL|typedef|ASC_SCSI_INQ2
)brace
id|ASC_SCSI_INQ2
suffix:semicolon
macro_line|#else
r_typedef
r_struct
(brace
DECL|member|iso_ver
id|uchar
id|iso_ver
suffix:colon
l_int|2
suffix:semicolon
DECL|member|ecma_ver
id|uchar
id|ecma_ver
suffix:colon
l_int|3
suffix:semicolon
DECL|member|ansi_apr_ver
id|uchar
id|ansi_apr_ver
suffix:colon
l_int|3
suffix:semicolon
DECL|typedef|ASC_SCSI_INQ2
)brace
id|ASC_SCSI_INQ2
suffix:semicolon
macro_line|#endif
macro_line|#if CC_LITTLE_ENDIAN_HOST
r_typedef
r_struct
(brace
DECL|member|rsp_data_fmt
id|uchar
id|rsp_data_fmt
suffix:colon
l_int|4
suffix:semicolon
DECL|member|res
id|uchar
id|res
suffix:colon
l_int|2
suffix:semicolon
DECL|member|TemIOP
id|uchar
id|TemIOP
suffix:colon
l_int|1
suffix:semicolon
DECL|member|aenc
id|uchar
id|aenc
suffix:colon
l_int|1
suffix:semicolon
DECL|typedef|ASC_SCSI_INQ3
)brace
id|ASC_SCSI_INQ3
suffix:semicolon
macro_line|#else
r_typedef
r_struct
(brace
DECL|member|aenc
id|uchar
id|aenc
suffix:colon
l_int|1
suffix:semicolon
DECL|member|TemIOP
id|uchar
id|TemIOP
suffix:colon
l_int|1
suffix:semicolon
DECL|member|res
id|uchar
id|res
suffix:colon
l_int|2
suffix:semicolon
DECL|member|rsp_data_fmt
id|uchar
id|rsp_data_fmt
suffix:colon
l_int|4
suffix:semicolon
DECL|typedef|ASC_SCSI_INQ3
)brace
id|ASC_SCSI_INQ3
suffix:semicolon
macro_line|#endif
macro_line|#if CC_LITTLE_ENDIAN_HOST
r_typedef
r_struct
(brace
DECL|member|StfRe
id|uchar
id|StfRe
suffix:colon
l_int|1
suffix:semicolon
DECL|member|CmdQue
id|uchar
id|CmdQue
suffix:colon
l_int|1
suffix:semicolon
DECL|member|Reserved
id|uchar
id|Reserved
suffix:colon
l_int|1
suffix:semicolon
DECL|member|Linked
id|uchar
id|Linked
suffix:colon
l_int|1
suffix:semicolon
DECL|member|Sync
id|uchar
id|Sync
suffix:colon
l_int|1
suffix:semicolon
DECL|member|WBus16
id|uchar
id|WBus16
suffix:colon
l_int|1
suffix:semicolon
DECL|member|WBus32
id|uchar
id|WBus32
suffix:colon
l_int|1
suffix:semicolon
DECL|member|RelAdr
id|uchar
id|RelAdr
suffix:colon
l_int|1
suffix:semicolon
DECL|typedef|ASC_SCSI_INQ7
)brace
id|ASC_SCSI_INQ7
suffix:semicolon
macro_line|#else
r_typedef
r_struct
(brace
DECL|member|RelAdr
id|uchar
id|RelAdr
suffix:colon
l_int|1
suffix:semicolon
DECL|member|WBus32
id|uchar
id|WBus32
suffix:colon
l_int|1
suffix:semicolon
DECL|member|WBus16
id|uchar
id|WBus16
suffix:colon
l_int|1
suffix:semicolon
DECL|member|Sync
id|uchar
id|Sync
suffix:colon
l_int|1
suffix:semicolon
DECL|member|Linked
id|uchar
id|Linked
suffix:colon
l_int|1
suffix:semicolon
DECL|member|Reserved
id|uchar
id|Reserved
suffix:colon
l_int|1
suffix:semicolon
DECL|member|CmdQue
id|uchar
id|CmdQue
suffix:colon
l_int|1
suffix:semicolon
DECL|member|StfRe
id|uchar
id|StfRe
suffix:colon
l_int|1
suffix:semicolon
DECL|typedef|ASC_SCSI_INQ7
)brace
id|ASC_SCSI_INQ7
suffix:semicolon
macro_line|#endif
r_typedef
r_struct
(brace
DECL|member|byte0
id|ASC_SCSI_INQ0
id|byte0
suffix:semicolon
DECL|member|byte1
id|ASC_SCSI_INQ1
id|byte1
suffix:semicolon
DECL|member|byte2
id|ASC_SCSI_INQ2
id|byte2
suffix:semicolon
DECL|member|byte3
id|ASC_SCSI_INQ3
id|byte3
suffix:semicolon
DECL|member|add_len
id|uchar
id|add_len
suffix:semicolon
DECL|member|res1
id|uchar
id|res1
suffix:semicolon
DECL|member|res2
id|uchar
id|res2
suffix:semicolon
DECL|member|byte7
id|ASC_SCSI_INQ7
id|byte7
suffix:semicolon
DECL|member|vendor_id
id|uchar
id|vendor_id
(braket
l_int|8
)braket
suffix:semicolon
DECL|member|product_id
id|uchar
id|product_id
(braket
l_int|16
)braket
suffix:semicolon
DECL|member|product_rev_level
id|uchar
id|product_rev_level
(braket
l_int|4
)braket
suffix:semicolon
DECL|typedef|ASC_SCSI_INQUIRY
)brace
id|ASC_SCSI_INQUIRY
suffix:semicolon
macro_line|#if CC_LITTLE_ENDIAN_HOST
DECL|struct|asc_req_sense
r_typedef
r_struct
id|asc_req_sense
(brace
DECL|member|err_code
id|uchar
id|err_code
suffix:colon
l_int|7
suffix:semicolon
DECL|member|info_valid
id|uchar
id|info_valid
suffix:colon
l_int|1
suffix:semicolon
DECL|member|segment_no
id|uchar
id|segment_no
suffix:semicolon
DECL|member|sense_key
id|uchar
id|sense_key
suffix:colon
l_int|4
suffix:semicolon
DECL|member|reserved_bit
id|uchar
id|reserved_bit
suffix:colon
l_int|1
suffix:semicolon
DECL|member|sense_ILI
id|uchar
id|sense_ILI
suffix:colon
l_int|1
suffix:semicolon
DECL|member|sense_EOM
id|uchar
id|sense_EOM
suffix:colon
l_int|1
suffix:semicolon
DECL|member|file_mark
id|uchar
id|file_mark
suffix:colon
l_int|1
suffix:semicolon
DECL|member|info1
id|uchar
id|info1
(braket
l_int|4
)braket
suffix:semicolon
DECL|member|add_sense_len
id|uchar
id|add_sense_len
suffix:semicolon
DECL|member|cmd_sp_info
id|uchar
id|cmd_sp_info
(braket
l_int|4
)braket
suffix:semicolon
DECL|member|asc
id|uchar
id|asc
suffix:semicolon
DECL|member|ascq
id|uchar
id|ascq
suffix:semicolon
DECL|member|fruc
id|uchar
id|fruc
suffix:semicolon
DECL|member|sks_byte0
id|uchar
id|sks_byte0
suffix:colon
l_int|7
suffix:semicolon
DECL|member|sks_valid
id|uchar
id|sks_valid
suffix:colon
l_int|1
suffix:semicolon
DECL|member|sks_bytes
id|uchar
id|sks_bytes
(braket
l_int|2
)braket
suffix:semicolon
DECL|member|notused
id|uchar
id|notused
(braket
l_int|2
)braket
suffix:semicolon
DECL|member|ex_sense_code
id|uchar
id|ex_sense_code
suffix:semicolon
DECL|member|info2
id|uchar
id|info2
(braket
l_int|4
)braket
suffix:semicolon
DECL|typedef|ASC_REQ_SENSE
)brace
id|ASC_REQ_SENSE
suffix:semicolon
macro_line|#else
DECL|struct|asc_req_sense
r_typedef
r_struct
id|asc_req_sense
(brace
DECL|member|info_valid
id|uchar
id|info_valid
suffix:colon
l_int|1
suffix:semicolon
DECL|member|err_code
id|uchar
id|err_code
suffix:colon
l_int|7
suffix:semicolon
DECL|member|segment_no
id|uchar
id|segment_no
suffix:semicolon
DECL|member|file_mark
id|uchar
id|file_mark
suffix:colon
l_int|1
suffix:semicolon
DECL|member|sense_EOM
id|uchar
id|sense_EOM
suffix:colon
l_int|1
suffix:semicolon
DECL|member|sense_ILI
id|uchar
id|sense_ILI
suffix:colon
l_int|1
suffix:semicolon
DECL|member|reserved_bit
id|uchar
id|reserved_bit
suffix:colon
l_int|1
suffix:semicolon
DECL|member|sense_key
id|uchar
id|sense_key
suffix:colon
l_int|4
suffix:semicolon
DECL|member|info1
id|uchar
id|info1
(braket
l_int|4
)braket
suffix:semicolon
DECL|member|add_sense_len
id|uchar
id|add_sense_len
suffix:semicolon
DECL|member|cmd_sp_info
id|uchar
id|cmd_sp_info
(braket
l_int|4
)braket
suffix:semicolon
DECL|member|asc
id|uchar
id|asc
suffix:semicolon
DECL|member|ascq
id|uchar
id|ascq
suffix:semicolon
DECL|member|fruc
id|uchar
id|fruc
suffix:semicolon
DECL|member|sks_valid
id|uchar
id|sks_valid
suffix:colon
l_int|1
suffix:semicolon
DECL|member|sks_byte0
id|uchar
id|sks_byte0
suffix:colon
l_int|7
suffix:semicolon
DECL|member|sks_bytes
id|uchar
id|sks_bytes
(braket
l_int|2
)braket
suffix:semicolon
DECL|member|notused
id|uchar
id|notused
(braket
l_int|2
)braket
suffix:semicolon
DECL|member|ex_sense_code
id|uchar
id|ex_sense_code
suffix:semicolon
DECL|member|info2
id|uchar
id|info2
(braket
l_int|4
)braket
suffix:semicolon
DECL|typedef|ASC_REQ_SENSE
)brace
id|ASC_REQ_SENSE
suffix:semicolon
macro_line|#endif
DECL|macro|ASC_SG_LIST_PER_Q
mdefine_line|#define ASC_SG_LIST_PER_Q   7
DECL|macro|QS_FREE
mdefine_line|#define QS_FREE        0x00
DECL|macro|QS_READY
mdefine_line|#define QS_READY       0x01
DECL|macro|QS_DISC1
mdefine_line|#define QS_DISC1       0x02
DECL|macro|QS_DISC2
mdefine_line|#define QS_DISC2       0x04
DECL|macro|QS_BUSY
mdefine_line|#define QS_BUSY        0x08
DECL|macro|QS_ABORTED
mdefine_line|#define QS_ABORTED     0x40
DECL|macro|QS_DONE
mdefine_line|#define QS_DONE        0x80
DECL|macro|QC_NO_CALLBACK
mdefine_line|#define QC_NO_CALLBACK   0x01
DECL|macro|QC_SG_SWAP_QUEUE
mdefine_line|#define QC_SG_SWAP_QUEUE 0x02
DECL|macro|QC_SG_HEAD
mdefine_line|#define QC_SG_HEAD       0x04
DECL|macro|QC_DATA_IN
mdefine_line|#define QC_DATA_IN       0x08
DECL|macro|QC_DATA_OUT
mdefine_line|#define QC_DATA_OUT      0x10
DECL|macro|QC_URGENT
mdefine_line|#define QC_URGENT        0x20
DECL|macro|QC_MSG_OUT
mdefine_line|#define QC_MSG_OUT       0x40
DECL|macro|QC_REQ_SENSE
mdefine_line|#define QC_REQ_SENSE     0x80
DECL|macro|QCSG_SG_XFER_LIST
mdefine_line|#define QCSG_SG_XFER_LIST  0x02
DECL|macro|QCSG_SG_XFER_MORE
mdefine_line|#define QCSG_SG_XFER_MORE  0x04
DECL|macro|QCSG_SG_XFER_END
mdefine_line|#define QCSG_SG_XFER_END   0x08
DECL|macro|QD_IN_PROGRESS
mdefine_line|#define QD_IN_PROGRESS       0x00
DECL|macro|QD_NO_ERROR
mdefine_line|#define QD_NO_ERROR          0x01
DECL|macro|QD_ABORTED_BY_HOST
mdefine_line|#define QD_ABORTED_BY_HOST   0x02
DECL|macro|QD_WITH_ERROR
mdefine_line|#define QD_WITH_ERROR        0x04
DECL|macro|QD_INVALID_REQUEST
mdefine_line|#define QD_INVALID_REQUEST   0x80
DECL|macro|QD_INVALID_HOST_NUM
mdefine_line|#define QD_INVALID_HOST_NUM  0x81
DECL|macro|QD_INVALID_DEVICE
mdefine_line|#define QD_INVALID_DEVICE    0x82
DECL|macro|QD_ERR_INTERNAL
mdefine_line|#define QD_ERR_INTERNAL      0xFF
DECL|macro|QHSTA_NO_ERROR
mdefine_line|#define QHSTA_NO_ERROR               0x00
DECL|macro|QHSTA_M_SEL_TIMEOUT
mdefine_line|#define QHSTA_M_SEL_TIMEOUT          0x11
DECL|macro|QHSTA_M_DATA_OVER_RUN
mdefine_line|#define QHSTA_M_DATA_OVER_RUN        0x12
DECL|macro|QHSTA_M_DATA_UNDER_RUN
mdefine_line|#define QHSTA_M_DATA_UNDER_RUN       0x12
DECL|macro|QHSTA_M_UNEXPECTED_BUS_FREE
mdefine_line|#define QHSTA_M_UNEXPECTED_BUS_FREE  0x13
DECL|macro|QHSTA_M_BAD_BUS_PHASE_SEQ
mdefine_line|#define QHSTA_M_BAD_BUS_PHASE_SEQ    0x14
DECL|macro|QHSTA_D_QDONE_SG_LIST_CORRUPTED
mdefine_line|#define QHSTA_D_QDONE_SG_LIST_CORRUPTED 0x21
DECL|macro|QHSTA_D_ASC_DVC_ERROR_CODE_SET
mdefine_line|#define QHSTA_D_ASC_DVC_ERROR_CODE_SET  0x22
DECL|macro|QHSTA_D_HOST_ABORT_FAILED
mdefine_line|#define QHSTA_D_HOST_ABORT_FAILED       0x23
DECL|macro|QHSTA_D_EXE_SCSI_Q_FAILED
mdefine_line|#define QHSTA_D_EXE_SCSI_Q_FAILED       0x24
DECL|macro|QHSTA_D_EXE_SCSI_Q_BUSY_TIMEOUT
mdefine_line|#define QHSTA_D_EXE_SCSI_Q_BUSY_TIMEOUT 0x25
DECL|macro|QHSTA_D_ASPI_NO_BUF_POOL
mdefine_line|#define QHSTA_D_ASPI_NO_BUF_POOL        0x26
DECL|macro|QHSTA_M_WTM_TIMEOUT
mdefine_line|#define QHSTA_M_WTM_TIMEOUT         0x41
DECL|macro|QHSTA_M_BAD_CMPL_STATUS_IN
mdefine_line|#define QHSTA_M_BAD_CMPL_STATUS_IN  0x42
DECL|macro|QHSTA_M_NO_AUTO_REQ_SENSE
mdefine_line|#define QHSTA_M_NO_AUTO_REQ_SENSE   0x43
DECL|macro|QHSTA_M_AUTO_REQ_SENSE_FAIL
mdefine_line|#define QHSTA_M_AUTO_REQ_SENSE_FAIL 0x44
DECL|macro|QHSTA_M_TARGET_STATUS_BUSY
mdefine_line|#define QHSTA_M_TARGET_STATUS_BUSY  0x45
DECL|macro|QHSTA_M_BAD_TAG_CODE
mdefine_line|#define QHSTA_M_BAD_TAG_CODE        0x46
DECL|macro|QHSTA_M_BAD_QUEUE_FULL_OR_BUSY
mdefine_line|#define QHSTA_M_BAD_QUEUE_FULL_OR_BUSY  0x47
DECL|macro|QHSTA_M_HUNG_REQ_SCSI_BUS_RESET
mdefine_line|#define QHSTA_M_HUNG_REQ_SCSI_BUS_RESET 0x48
DECL|macro|QHSTA_D_LRAM_CMP_ERROR
mdefine_line|#define QHSTA_D_LRAM_CMP_ERROR        0x81
DECL|macro|QHSTA_M_MICRO_CODE_ERROR_HALT
mdefine_line|#define QHSTA_M_MICRO_CODE_ERROR_HALT 0xA1
DECL|macro|ASC_FLAG_SCSIQ_REQ
mdefine_line|#define ASC_FLAG_SCSIQ_REQ        0x01
DECL|macro|ASC_FLAG_BIOS_SCSIQ_REQ
mdefine_line|#define ASC_FLAG_BIOS_SCSIQ_REQ   0x02
DECL|macro|ASC_FLAG_BIOS_ASYNC_IO
mdefine_line|#define ASC_FLAG_BIOS_ASYNC_IO    0x04
DECL|macro|ASC_FLAG_SRB_LINEAR_ADDR
mdefine_line|#define ASC_FLAG_SRB_LINEAR_ADDR  0x08
DECL|macro|ASC_FLAG_WIN16
mdefine_line|#define ASC_FLAG_WIN16            0x10
DECL|macro|ASC_FLAG_WIN32
mdefine_line|#define ASC_FLAG_WIN32            0x20
DECL|macro|ASC_FLAG_ISA_OVER_16MB
mdefine_line|#define ASC_FLAG_ISA_OVER_16MB    0x40
DECL|macro|ASC_FLAG_DOS_VM_CALLBACK
mdefine_line|#define ASC_FLAG_DOS_VM_CALLBACK  0x80
DECL|macro|ASC_TAG_FLAG_EXTRA_BYTES
mdefine_line|#define ASC_TAG_FLAG_EXTRA_BYTES               0x10
DECL|macro|ASC_TAG_FLAG_DISABLE_DISCONNECT
mdefine_line|#define ASC_TAG_FLAG_DISABLE_DISCONNECT        0x04
DECL|macro|ASC_TAG_FLAG_DISABLE_ASYN_USE_SYN_FIX
mdefine_line|#define ASC_TAG_FLAG_DISABLE_ASYN_USE_SYN_FIX  0x08
DECL|macro|ASC_TAG_FLAG_DISABLE_CHK_COND_INT_HOST
mdefine_line|#define ASC_TAG_FLAG_DISABLE_CHK_COND_INT_HOST 0x40
DECL|macro|ASC_SCSIQ_CPY_BEG
mdefine_line|#define ASC_SCSIQ_CPY_BEG              4
DECL|macro|ASC_SCSIQ_SGHD_CPY_BEG
mdefine_line|#define ASC_SCSIQ_SGHD_CPY_BEG         2
DECL|macro|ASC_SCSIQ_B_FWD
mdefine_line|#define ASC_SCSIQ_B_FWD                0
DECL|macro|ASC_SCSIQ_B_BWD
mdefine_line|#define ASC_SCSIQ_B_BWD                1
DECL|macro|ASC_SCSIQ_B_STATUS
mdefine_line|#define ASC_SCSIQ_B_STATUS             2
DECL|macro|ASC_SCSIQ_B_QNO
mdefine_line|#define ASC_SCSIQ_B_QNO                3
DECL|macro|ASC_SCSIQ_B_CNTL
mdefine_line|#define ASC_SCSIQ_B_CNTL               4
DECL|macro|ASC_SCSIQ_B_SG_QUEUE_CNT
mdefine_line|#define ASC_SCSIQ_B_SG_QUEUE_CNT       5
DECL|macro|ASC_SCSIQ_D_DATA_ADDR
mdefine_line|#define ASC_SCSIQ_D_DATA_ADDR          8
DECL|macro|ASC_SCSIQ_D_DATA_CNT
mdefine_line|#define ASC_SCSIQ_D_DATA_CNT          12
DECL|macro|ASC_SCSIQ_B_SENSE_LEN
mdefine_line|#define ASC_SCSIQ_B_SENSE_LEN         20
DECL|macro|ASC_SCSIQ_DONE_INFO_BEG
mdefine_line|#define ASC_SCSIQ_DONE_INFO_BEG       22
DECL|macro|ASC_SCSIQ_D_SRBPTR
mdefine_line|#define ASC_SCSIQ_D_SRBPTR            22
DECL|macro|ASC_SCSIQ_B_TARGET_IX
mdefine_line|#define ASC_SCSIQ_B_TARGET_IX         26
DECL|macro|ASC_SCSIQ_B_CDB_LEN
mdefine_line|#define ASC_SCSIQ_B_CDB_LEN           28
DECL|macro|ASC_SCSIQ_B_TAG_CODE
mdefine_line|#define ASC_SCSIQ_B_TAG_CODE          29
DECL|macro|ASC_SCSIQ_W_VM_ID
mdefine_line|#define ASC_SCSIQ_W_VM_ID             30
DECL|macro|ASC_SCSIQ_DONE_STATUS
mdefine_line|#define ASC_SCSIQ_DONE_STATUS         32
DECL|macro|ASC_SCSIQ_HOST_STATUS
mdefine_line|#define ASC_SCSIQ_HOST_STATUS         33
DECL|macro|ASC_SCSIQ_SCSI_STATUS
mdefine_line|#define ASC_SCSIQ_SCSI_STATUS         34
DECL|macro|ASC_SCSIQ_CDB_BEG
mdefine_line|#define ASC_SCSIQ_CDB_BEG             36
DECL|macro|ASC_SCSIQ_DW_REMAIN_XFER_ADDR
mdefine_line|#define ASC_SCSIQ_DW_REMAIN_XFER_ADDR 56
DECL|macro|ASC_SCSIQ_DW_REMAIN_XFER_CNT
mdefine_line|#define ASC_SCSIQ_DW_REMAIN_XFER_CNT  60
DECL|macro|ASC_SCSIQ_B_SG_WK_QP
mdefine_line|#define ASC_SCSIQ_B_SG_WK_QP          49
DECL|macro|ASC_SCSIQ_B_SG_WK_IX
mdefine_line|#define ASC_SCSIQ_B_SG_WK_IX          50
DECL|macro|ASC_SCSIQ_W_REQ_COUNT
mdefine_line|#define ASC_SCSIQ_W_REQ_COUNT         52
DECL|macro|ASC_SCSIQ_B_LIST_CNT
mdefine_line|#define ASC_SCSIQ_B_LIST_CNT          6
DECL|macro|ASC_SCSIQ_B_CUR_LIST_CNT
mdefine_line|#define ASC_SCSIQ_B_CUR_LIST_CNT      7
DECL|macro|ASC_SGQ_B_SG_CNTL
mdefine_line|#define ASC_SGQ_B_SG_CNTL             4
DECL|macro|ASC_SGQ_B_SG_HEAD_QP
mdefine_line|#define ASC_SGQ_B_SG_HEAD_QP          5
DECL|macro|ASC_SGQ_B_SG_LIST_CNT
mdefine_line|#define ASC_SGQ_B_SG_LIST_CNT         6
DECL|macro|ASC_SGQ_B_SG_CUR_LIST_CNT
mdefine_line|#define ASC_SGQ_B_SG_CUR_LIST_CNT     7
DECL|macro|ASC_SGQ_LIST_BEG
mdefine_line|#define ASC_SGQ_LIST_BEG              8
DECL|macro|ASC_DEF_SCSI1_QNG
mdefine_line|#define ASC_DEF_SCSI1_QNG    4
DECL|macro|ASC_MAX_SCSI1_QNG
mdefine_line|#define ASC_MAX_SCSI1_QNG    4
DECL|macro|ASC_DEF_SCSI2_QNG
mdefine_line|#define ASC_DEF_SCSI2_QNG    16
DECL|macro|ASC_MAX_SCSI2_QNG
mdefine_line|#define ASC_MAX_SCSI2_QNG    32
DECL|macro|ASC_TAG_CODE_MASK
mdefine_line|#define ASC_TAG_CODE_MASK    0x23
DECL|macro|ASC_STOP_REQ_RISC_STOP
mdefine_line|#define ASC_STOP_REQ_RISC_STOP      0x01
DECL|macro|ASC_STOP_ACK_RISC_STOP
mdefine_line|#define ASC_STOP_ACK_RISC_STOP      0x03
DECL|macro|ASC_STOP_CLEAN_UP_BUSY_Q
mdefine_line|#define ASC_STOP_CLEAN_UP_BUSY_Q    0x10
DECL|macro|ASC_STOP_CLEAN_UP_DISC_Q
mdefine_line|#define ASC_STOP_CLEAN_UP_DISC_Q    0x20
DECL|macro|ASC_STOP_HOST_REQ_RISC_HALT
mdefine_line|#define ASC_STOP_HOST_REQ_RISC_HALT 0x40
DECL|macro|ASC_TIDLUN_TO_IX
mdefine_line|#define ASC_TIDLUN_TO_IX( tid, lun )  ( ASC_SCSI_TIX_TYPE )( (tid) + ((lun)&lt;&lt;ASC_SCSI_ID_BITS) )
DECL|macro|ASC_TID_TO_TARGET_ID
mdefine_line|#define ASC_TID_TO_TARGET_ID( tid )   ( ASC_SCSI_BIT_ID_TYPE )( 0x01 &lt;&lt; (tid) )
DECL|macro|ASC_TIX_TO_TARGET_ID
mdefine_line|#define ASC_TIX_TO_TARGET_ID( tix )   ( 0x01 &lt;&lt; ( (tix) &amp; ASC_MAX_TID ) )
DECL|macro|ASC_TIX_TO_TID
mdefine_line|#define ASC_TIX_TO_TID( tix )         ( (tix) &amp; ASC_MAX_TID )
DECL|macro|ASC_TID_TO_TIX
mdefine_line|#define ASC_TID_TO_TIX( tid )         ( (tid) &amp; ASC_MAX_TID )
DECL|macro|ASC_TIX_TO_LUN
mdefine_line|#define ASC_TIX_TO_LUN( tix )         ( ( (tix) &gt;&gt; ASC_SCSI_ID_BITS ) &amp; ASC_MAX_LUN )
DECL|macro|ASC_QNO_TO_QADDR
mdefine_line|#define ASC_QNO_TO_QADDR( q_no )      ( (ASC_QADR_BEG)+( ( int )(q_no) &lt;&lt; 6 ) )
DECL|struct|asc_scisq_1
r_typedef
r_struct
id|asc_scisq_1
(brace
DECL|member|status
id|uchar
id|status
suffix:semicolon
DECL|member|q_no
id|uchar
id|q_no
suffix:semicolon
DECL|member|cntl
id|uchar
id|cntl
suffix:semicolon
DECL|member|sg_queue_cnt
id|uchar
id|sg_queue_cnt
suffix:semicolon
DECL|member|target_id
id|uchar
id|target_id
suffix:semicolon
DECL|member|target_lun
id|uchar
id|target_lun
suffix:semicolon
DECL|member|data_addr
id|ulong
id|data_addr
suffix:semicolon
DECL|member|data_cnt
id|ulong
id|data_cnt
suffix:semicolon
DECL|member|sense_addr
id|ulong
id|sense_addr
suffix:semicolon
DECL|member|sense_len
id|uchar
id|sense_len
suffix:semicolon
DECL|member|extra_bytes
id|uchar
id|extra_bytes
suffix:semicolon
DECL|typedef|ASC_SCSIQ_1
)brace
id|ASC_SCSIQ_1
suffix:semicolon
DECL|struct|asc_scisq_2
r_typedef
r_struct
id|asc_scisq_2
(brace
DECL|member|srb_ptr
id|ulong
id|srb_ptr
suffix:semicolon
DECL|member|target_ix
id|uchar
id|target_ix
suffix:semicolon
DECL|member|flag
id|uchar
id|flag
suffix:semicolon
DECL|member|cdb_len
id|uchar
id|cdb_len
suffix:semicolon
DECL|member|tag_code
id|uchar
id|tag_code
suffix:semicolon
DECL|member|vm_id
id|ushort
id|vm_id
suffix:semicolon
DECL|typedef|ASC_SCSIQ_2
)brace
id|ASC_SCSIQ_2
suffix:semicolon
DECL|struct|asc_scsiq_3
r_typedef
r_struct
id|asc_scsiq_3
(brace
DECL|member|done_stat
id|uchar
id|done_stat
suffix:semicolon
DECL|member|host_stat
id|uchar
id|host_stat
suffix:semicolon
DECL|member|scsi_stat
id|uchar
id|scsi_stat
suffix:semicolon
DECL|member|scsi_msg
id|uchar
id|scsi_msg
suffix:semicolon
DECL|typedef|ASC_SCSIQ_3
)brace
id|ASC_SCSIQ_3
suffix:semicolon
DECL|struct|asc_scsiq_4
r_typedef
r_struct
id|asc_scsiq_4
(brace
DECL|member|cdb
id|uchar
id|cdb
(braket
id|ASC_MAX_CDB_LEN
)braket
suffix:semicolon
DECL|member|y_first_sg_list_qp
id|uchar
id|y_first_sg_list_qp
suffix:semicolon
DECL|member|y_working_sg_qp
id|uchar
id|y_working_sg_qp
suffix:semicolon
DECL|member|y_working_sg_ix
id|uchar
id|y_working_sg_ix
suffix:semicolon
DECL|member|y_res
id|uchar
id|y_res
suffix:semicolon
DECL|member|x_req_count
id|ushort
id|x_req_count
suffix:semicolon
DECL|member|x_reconnect_rtn
id|ushort
id|x_reconnect_rtn
suffix:semicolon
DECL|member|x_saved_data_addr
id|ulong
id|x_saved_data_addr
suffix:semicolon
DECL|member|x_saved_data_cnt
id|ulong
id|x_saved_data_cnt
suffix:semicolon
DECL|typedef|ASC_SCSIQ_4
)brace
id|ASC_SCSIQ_4
suffix:semicolon
DECL|struct|asc_q_done_info
r_typedef
r_struct
id|asc_q_done_info
(brace
DECL|member|d2
id|ASC_SCSIQ_2
id|d2
suffix:semicolon
DECL|member|d3
id|ASC_SCSIQ_3
id|d3
suffix:semicolon
DECL|member|q_status
id|uchar
id|q_status
suffix:semicolon
DECL|member|q_no
id|uchar
id|q_no
suffix:semicolon
DECL|member|cntl
id|uchar
id|cntl
suffix:semicolon
DECL|member|sense_len
id|uchar
id|sense_len
suffix:semicolon
DECL|member|extra_bytes
id|uchar
id|extra_bytes
suffix:semicolon
DECL|member|res
id|uchar
id|res
suffix:semicolon
DECL|member|remain_bytes
id|ulong
id|remain_bytes
suffix:semicolon
DECL|typedef|ASC_QDONE_INFO
)brace
id|ASC_QDONE_INFO
suffix:semicolon
DECL|struct|asc_sg_list
r_typedef
r_struct
id|asc_sg_list
(brace
DECL|member|addr
id|ulong
id|addr
suffix:semicolon
DECL|member|bytes
id|ulong
id|bytes
suffix:semicolon
DECL|typedef|ASC_SG_LIST
)brace
id|ASC_SG_LIST
suffix:semicolon
DECL|struct|asc_sg_head
r_typedef
r_struct
id|asc_sg_head
(brace
DECL|member|entry_cnt
id|ushort
id|entry_cnt
suffix:semicolon
DECL|member|queue_cnt
id|ushort
id|queue_cnt
suffix:semicolon
DECL|member|entry_to_copy
id|ushort
id|entry_to_copy
suffix:semicolon
DECL|member|res
id|ushort
id|res
suffix:semicolon
DECL|member|sg_list
id|ASC_SG_LIST
id|sg_list
(braket
id|ASC_MAX_SG_LIST
)braket
suffix:semicolon
DECL|typedef|ASC_SG_HEAD
)brace
id|ASC_SG_HEAD
suffix:semicolon
DECL|macro|ASC_MIN_SG_LIST
mdefine_line|#define ASC_MIN_SG_LIST   2
DECL|struct|asc_min_sg_head
r_typedef
r_struct
id|asc_min_sg_head
(brace
DECL|member|entry_cnt
id|ushort
id|entry_cnt
suffix:semicolon
DECL|member|queue_cnt
id|ushort
id|queue_cnt
suffix:semicolon
DECL|member|entry_to_copy
id|ushort
id|entry_to_copy
suffix:semicolon
DECL|member|res
id|ushort
id|res
suffix:semicolon
DECL|member|sg_list
id|ASC_SG_LIST
id|sg_list
(braket
id|ASC_MIN_SG_LIST
)braket
suffix:semicolon
DECL|typedef|ASC_MIN_SG_HEAD
)brace
id|ASC_MIN_SG_HEAD
suffix:semicolon
DECL|macro|QCX_SORT
mdefine_line|#define QCX_SORT        (0x0001)
DECL|macro|QCX_COALEASE
mdefine_line|#define QCX_COALEASE    (0x0002)
macro_line|#if CC_LINK_BUSY_Q
DECL|struct|asc_ext_scsi_q
r_typedef
r_struct
id|asc_ext_scsi_q
(brace
DECL|member|lba
id|ulong
id|lba
suffix:semicolon
DECL|member|lba_len
id|ushort
id|lba_len
suffix:semicolon
DECL|member|next
r_struct
id|asc_scsi_q
id|dosfar
op_star
id|next
suffix:semicolon
DECL|member|join
r_struct
id|asc_scsi_q
id|dosfar
op_star
id|join
suffix:semicolon
DECL|member|cntl
id|ushort
id|cntl
suffix:semicolon
DECL|member|buffer_id
id|ushort
id|buffer_id
suffix:semicolon
DECL|member|q_required
id|uchar
id|q_required
suffix:semicolon
DECL|member|res
id|uchar
id|res
suffix:semicolon
DECL|typedef|ASC_EXT_SCSI_Q
)brace
id|ASC_EXT_SCSI_Q
suffix:semicolon
macro_line|#endif
DECL|struct|asc_scsi_q
r_typedef
r_struct
id|asc_scsi_q
(brace
DECL|member|q1
id|ASC_SCSIQ_1
id|q1
suffix:semicolon
DECL|member|q2
id|ASC_SCSIQ_2
id|q2
suffix:semicolon
DECL|member|cdbptr
id|uchar
id|dosfar
op_star
id|cdbptr
suffix:semicolon
DECL|member|sg_head
id|ASC_SG_HEAD
id|dosfar
op_star
id|sg_head
suffix:semicolon
macro_line|#if CC_LINK_BUSY_Q
DECL|member|ext
id|ASC_EXT_SCSI_Q
id|ext
suffix:semicolon
macro_line|#endif
macro_line|#if CC_ASC_SCSI_Q_USRDEF
DECL|member|usr
id|ASC_SCSI_Q_USR
id|usr
suffix:semicolon
macro_line|#endif
DECL|typedef|ASC_SCSI_Q
)brace
id|ASC_SCSI_Q
suffix:semicolon
DECL|struct|asc_scsi_req_q
r_typedef
r_struct
id|asc_scsi_req_q
(brace
DECL|member|r1
id|ASC_SCSIQ_1
id|r1
suffix:semicolon
DECL|member|r2
id|ASC_SCSIQ_2
id|r2
suffix:semicolon
DECL|member|cdbptr
id|uchar
id|dosfar
op_star
id|cdbptr
suffix:semicolon
DECL|member|sg_head
id|ASC_SG_HEAD
id|dosfar
op_star
id|sg_head
suffix:semicolon
macro_line|#if CC_LINK_BUSY_Q
DECL|member|ext
id|ASC_EXT_SCSI_Q
id|ext
suffix:semicolon
macro_line|#endif
DECL|member|sense_ptr
id|uchar
id|dosfar
op_star
id|sense_ptr
suffix:semicolon
DECL|member|r3
id|ASC_SCSIQ_3
id|r3
suffix:semicolon
DECL|member|cdb
id|uchar
id|cdb
(braket
id|ASC_MAX_CDB_LEN
)braket
suffix:semicolon
DECL|member|sense
id|uchar
id|sense
(braket
id|ASC_MIN_SENSE_LEN
)braket
suffix:semicolon
macro_line|#if CC_ASC_SCSI_REQ_Q_USRDEF
DECL|member|usr
id|ASC_SCSI_REQ_Q_USR
id|usr
suffix:semicolon
macro_line|#endif
DECL|typedef|ASC_SCSI_REQ_Q
)brace
id|ASC_SCSI_REQ_Q
suffix:semicolon
DECL|struct|asc_scsi_bios_req_q
r_typedef
r_struct
id|asc_scsi_bios_req_q
(brace
DECL|member|r1
id|ASC_SCSIQ_1
id|r1
suffix:semicolon
DECL|member|r2
id|ASC_SCSIQ_2
id|r2
suffix:semicolon
DECL|member|cdbptr
id|uchar
id|dosfar
op_star
id|cdbptr
suffix:semicolon
DECL|member|sg_head
id|ASC_SG_HEAD
id|dosfar
op_star
id|sg_head
suffix:semicolon
DECL|member|sense_ptr
id|uchar
id|dosfar
op_star
id|sense_ptr
suffix:semicolon
DECL|member|r3
id|ASC_SCSIQ_3
id|r3
suffix:semicolon
DECL|member|cdb
id|uchar
id|cdb
(braket
id|ASC_MAX_CDB_LEN
)braket
suffix:semicolon
DECL|member|sense
id|uchar
id|sense
(braket
id|ASC_MIN_SENSE_LEN
)braket
suffix:semicolon
DECL|typedef|ASC_SCSI_BIOS_REQ_Q
)brace
id|ASC_SCSI_BIOS_REQ_Q
suffix:semicolon
DECL|struct|asc_risc_q
r_typedef
r_struct
id|asc_risc_q
(brace
DECL|member|fwd
id|uchar
id|fwd
suffix:semicolon
DECL|member|bwd
id|uchar
id|bwd
suffix:semicolon
DECL|member|i1
id|ASC_SCSIQ_1
id|i1
suffix:semicolon
DECL|member|i2
id|ASC_SCSIQ_2
id|i2
suffix:semicolon
DECL|member|i3
id|ASC_SCSIQ_3
id|i3
suffix:semicolon
DECL|member|i4
id|ASC_SCSIQ_4
id|i4
suffix:semicolon
DECL|typedef|ASC_RISC_Q
)brace
id|ASC_RISC_Q
suffix:semicolon
DECL|struct|asc_sg_list_q
r_typedef
r_struct
id|asc_sg_list_q
(brace
DECL|member|seq_no
id|uchar
id|seq_no
suffix:semicolon
DECL|member|q_no
id|uchar
id|q_no
suffix:semicolon
DECL|member|cntl
id|uchar
id|cntl
suffix:semicolon
DECL|member|sg_head_qp
id|uchar
id|sg_head_qp
suffix:semicolon
DECL|member|sg_list_cnt
id|uchar
id|sg_list_cnt
suffix:semicolon
DECL|member|sg_cur_list_cnt
id|uchar
id|sg_cur_list_cnt
suffix:semicolon
DECL|typedef|ASC_SG_LIST_Q
)brace
id|ASC_SG_LIST_Q
suffix:semicolon
DECL|struct|asc_risc_sg_list_q
r_typedef
r_struct
id|asc_risc_sg_list_q
(brace
DECL|member|fwd
id|uchar
id|fwd
suffix:semicolon
DECL|member|bwd
id|uchar
id|bwd
suffix:semicolon
DECL|member|sg
id|ASC_SG_LIST_Q
id|sg
suffix:semicolon
DECL|member|sg_list
id|ASC_SG_LIST
id|sg_list
(braket
l_int|7
)braket
suffix:semicolon
DECL|typedef|ASC_RISC_SG_LIST_Q
)brace
id|ASC_RISC_SG_LIST_Q
suffix:semicolon
DECL|macro|ASC_EXE_SCSI_IO_MAX_IDLE_LOOP
mdefine_line|#define ASC_EXE_SCSI_IO_MAX_IDLE_LOOP  0x1000000UL
DECL|macro|ASC_EXE_SCSI_IO_MAX_WAIT_LOOP
mdefine_line|#define ASC_EXE_SCSI_IO_MAX_WAIT_LOOP  1024
DECL|macro|ASCQ_ERR_NO_ERROR
mdefine_line|#define ASCQ_ERR_NO_ERROR             0
DECL|macro|ASCQ_ERR_IO_NOT_FOUND
mdefine_line|#define ASCQ_ERR_IO_NOT_FOUND         1
DECL|macro|ASCQ_ERR_LOCAL_MEM
mdefine_line|#define ASCQ_ERR_LOCAL_MEM            2
DECL|macro|ASCQ_ERR_CHKSUM
mdefine_line|#define ASCQ_ERR_CHKSUM               3
DECL|macro|ASCQ_ERR_START_CHIP
mdefine_line|#define ASCQ_ERR_START_CHIP           4
DECL|macro|ASCQ_ERR_INT_TARGET_ID
mdefine_line|#define ASCQ_ERR_INT_TARGET_ID        5
DECL|macro|ASCQ_ERR_INT_LOCAL_MEM
mdefine_line|#define ASCQ_ERR_INT_LOCAL_MEM        6
DECL|macro|ASCQ_ERR_HALT_RISC
mdefine_line|#define ASCQ_ERR_HALT_RISC            7
DECL|macro|ASCQ_ERR_GET_ASPI_ENTRY
mdefine_line|#define ASCQ_ERR_GET_ASPI_ENTRY       8
DECL|macro|ASCQ_ERR_CLOSE_ASPI
mdefine_line|#define ASCQ_ERR_CLOSE_ASPI           9
DECL|macro|ASCQ_ERR_HOST_INQUIRY
mdefine_line|#define ASCQ_ERR_HOST_INQUIRY         0x0A
DECL|macro|ASCQ_ERR_SAVED_SRB_BAD
mdefine_line|#define ASCQ_ERR_SAVED_SRB_BAD        0x0B
DECL|macro|ASCQ_ERR_QCNTL_SG_LIST
mdefine_line|#define ASCQ_ERR_QCNTL_SG_LIST        0x0C
DECL|macro|ASCQ_ERR_Q_STATUS
mdefine_line|#define ASCQ_ERR_Q_STATUS             0x0D
DECL|macro|ASCQ_ERR_WR_SCSIQ
mdefine_line|#define ASCQ_ERR_WR_SCSIQ             0x0E
DECL|macro|ASCQ_ERR_PC_ADDR
mdefine_line|#define ASCQ_ERR_PC_ADDR              0x0F
DECL|macro|ASCQ_ERR_SYN_OFFSET
mdefine_line|#define ASCQ_ERR_SYN_OFFSET           0x10
DECL|macro|ASCQ_ERR_SYN_XFER_TIME
mdefine_line|#define ASCQ_ERR_SYN_XFER_TIME        0x11
DECL|macro|ASCQ_ERR_LOCK_DMA
mdefine_line|#define ASCQ_ERR_LOCK_DMA             0x12
DECL|macro|ASCQ_ERR_UNLOCK_DMA
mdefine_line|#define ASCQ_ERR_UNLOCK_DMA           0x13
DECL|macro|ASCQ_ERR_VDS_CHK_INSTALL
mdefine_line|#define ASCQ_ERR_VDS_CHK_INSTALL      0x14
DECL|macro|ASCQ_ERR_MICRO_CODE_HALT
mdefine_line|#define ASCQ_ERR_MICRO_CODE_HALT      0x15
DECL|macro|ASCQ_ERR_SET_LRAM_ADDR
mdefine_line|#define ASCQ_ERR_SET_LRAM_ADDR        0x16
DECL|macro|ASCQ_ERR_CUR_QNG
mdefine_line|#define ASCQ_ERR_CUR_QNG              0x17
DECL|macro|ASCQ_ERR_SG_Q_LINKS
mdefine_line|#define ASCQ_ERR_SG_Q_LINKS           0x18
DECL|macro|ASCQ_ERR_SCSIQ_PTR
mdefine_line|#define ASCQ_ERR_SCSIQ_PTR            0x19
DECL|macro|ASCQ_ERR_ISR_RE_ENTRY
mdefine_line|#define ASCQ_ERR_ISR_RE_ENTRY         0x1A
DECL|macro|ASCQ_ERR_CRITICAL_RE_ENTRY
mdefine_line|#define ASCQ_ERR_CRITICAL_RE_ENTRY    0x1B
DECL|macro|ASCQ_ERR_ISR_ON_CRITICAL
mdefine_line|#define ASCQ_ERR_ISR_ON_CRITICAL      0x1C
DECL|macro|ASCQ_ERR_SG_LIST_ODD_ADDRESS
mdefine_line|#define ASCQ_ERR_SG_LIST_ODD_ADDRESS  0x1D
DECL|macro|ASCQ_ERR_XFER_ADDRESS_TOO_BIG
mdefine_line|#define ASCQ_ERR_XFER_ADDRESS_TOO_BIG 0x1E
DECL|macro|ASCQ_ERR_SCSIQ_NULL_PTR
mdefine_line|#define ASCQ_ERR_SCSIQ_NULL_PTR       0x1F
DECL|macro|ASCQ_ERR_SCSIQ_BAD_NEXT_PTR
mdefine_line|#define ASCQ_ERR_SCSIQ_BAD_NEXT_PTR   0x20
DECL|macro|ASCQ_ERR_GET_NUM_OF_FREE_Q
mdefine_line|#define ASCQ_ERR_GET_NUM_OF_FREE_Q    0x21
DECL|macro|ASCQ_ERR_SEND_SCSI_Q
mdefine_line|#define ASCQ_ERR_SEND_SCSI_Q          0x22
DECL|macro|ASCQ_ERR_HOST_REQ_RISC_HALT
mdefine_line|#define ASCQ_ERR_HOST_REQ_RISC_HALT   0x23
DECL|macro|ASCQ_ERR_RESET_SDTR
mdefine_line|#define ASCQ_ERR_RESET_SDTR           0x24
DECL|macro|ASC_WARN_NO_ERROR
mdefine_line|#define ASC_WARN_NO_ERROR             0x0000
DECL|macro|ASC_WARN_IO_PORT_ROTATE
mdefine_line|#define ASC_WARN_IO_PORT_ROTATE       0x0001
DECL|macro|ASC_WARN_EEPROM_CHKSUM
mdefine_line|#define ASC_WARN_EEPROM_CHKSUM        0x0002
DECL|macro|ASC_WARN_IRQ_MODIFIED
mdefine_line|#define ASC_WARN_IRQ_MODIFIED         0x0004
DECL|macro|ASC_WARN_AUTO_CONFIG
mdefine_line|#define ASC_WARN_AUTO_CONFIG          0x0008
DECL|macro|ASC_WARN_CMD_QNG_CONFLICT
mdefine_line|#define ASC_WARN_CMD_QNG_CONFLICT     0x0010
DECL|macro|ASC_WARN_EEPROM_RECOVER
mdefine_line|#define ASC_WARN_EEPROM_RECOVER       0x0020
DECL|macro|ASC_WARN_CFG_MSW_RECOVER
mdefine_line|#define ASC_WARN_CFG_MSW_RECOVER      0x0040
DECL|macro|ASC_WARN_SET_PCI_CONFIG_SPACE
mdefine_line|#define ASC_WARN_SET_PCI_CONFIG_SPACE 0x0080
DECL|macro|ASC_IERR_WRITE_EEPROM
mdefine_line|#define ASC_IERR_WRITE_EEPROM         0x0001
DECL|macro|ASC_IERR_MCODE_CHKSUM
mdefine_line|#define ASC_IERR_MCODE_CHKSUM         0x0002
DECL|macro|ASC_IERR_SET_PC_ADDR
mdefine_line|#define ASC_IERR_SET_PC_ADDR          0x0004
DECL|macro|ASC_IERR_START_STOP_CHIP
mdefine_line|#define ASC_IERR_START_STOP_CHIP      0x0008
DECL|macro|ASC_IERR_IRQ_NO
mdefine_line|#define ASC_IERR_IRQ_NO               0x0010
DECL|macro|ASC_IERR_SET_IRQ_NO
mdefine_line|#define ASC_IERR_SET_IRQ_NO           0x0020
DECL|macro|ASC_IERR_CHIP_VERSION
mdefine_line|#define ASC_IERR_CHIP_VERSION         0x0040
DECL|macro|ASC_IERR_SET_SCSI_ID
mdefine_line|#define ASC_IERR_SET_SCSI_ID          0x0080
DECL|macro|ASC_IERR_GET_PHY_ADDR
mdefine_line|#define ASC_IERR_GET_PHY_ADDR         0x0100
DECL|macro|ASC_IERR_BAD_SIGNATURE
mdefine_line|#define ASC_IERR_BAD_SIGNATURE        0x0200
DECL|macro|ASC_IERR_NO_BUS_TYPE
mdefine_line|#define ASC_IERR_NO_BUS_TYPE          0x0400
DECL|macro|ASC_IERR_SCAM
mdefine_line|#define ASC_IERR_SCAM                 0x0800
DECL|macro|ASC_IERR_SET_SDTR
mdefine_line|#define ASC_IERR_SET_SDTR             0x1000
DECL|macro|ASC_IERR_RW_LRAM
mdefine_line|#define ASC_IERR_RW_LRAM              0x8000
DECL|macro|ASC_DEF_IRQ_NO
mdefine_line|#define ASC_DEF_IRQ_NO  10
DECL|macro|ASC_MAX_IRQ_NO
mdefine_line|#define ASC_MAX_IRQ_NO  15
DECL|macro|ASC_MIN_IRQ_NO
mdefine_line|#define ASC_MIN_IRQ_NO  10
DECL|macro|ASC_MIN_REMAIN_Q
mdefine_line|#define ASC_MIN_REMAIN_Q        (0x02)
DECL|macro|ASC_DEF_MAX_TOTAL_QNG
mdefine_line|#define ASC_DEF_MAX_TOTAL_QNG   (0xF0)
DECL|macro|ASC_MIN_TAG_Q_PER_DVC
mdefine_line|#define ASC_MIN_TAG_Q_PER_DVC   (0x04)
DECL|macro|ASC_DEF_TAG_Q_PER_DVC
mdefine_line|#define ASC_DEF_TAG_Q_PER_DVC   (0x04)
DECL|macro|ASC_MIN_FREE_Q
mdefine_line|#define ASC_MIN_FREE_Q        ASC_MIN_REMAIN_Q
DECL|macro|ASC_MIN_TOTAL_QNG
mdefine_line|#define ASC_MIN_TOTAL_QNG     (( ASC_MAX_SG_QUEUE )+( ASC_MIN_FREE_Q ))
DECL|macro|ASC_MAX_TOTAL_QNG
mdefine_line|#define ASC_MAX_TOTAL_QNG 240
DECL|macro|ASC_MAX_PCI_ULTRA_INRAM_TOTAL_QNG
mdefine_line|#define ASC_MAX_PCI_ULTRA_INRAM_TOTAL_QNG 16
DECL|macro|ASC_MAX_PCI_ULTRA_INRAM_TAG_QNG
mdefine_line|#define ASC_MAX_PCI_ULTRA_INRAM_TAG_QNG   8
DECL|macro|ASC_MAX_PCI_INRAM_TOTAL_QNG
mdefine_line|#define ASC_MAX_PCI_INRAM_TOTAL_QNG  20
DECL|macro|ASC_MAX_INRAM_TAG_QNG
mdefine_line|#define ASC_MAX_INRAM_TAG_QNG   16
DECL|macro|ASC_IOADR_TABLE_MAX_IX
mdefine_line|#define ASC_IOADR_TABLE_MAX_IX  11
DECL|macro|ASC_IOADR_GAP
mdefine_line|#define ASC_IOADR_GAP   0x10
DECL|macro|ASC_SEARCH_IOP_GAP
mdefine_line|#define ASC_SEARCH_IOP_GAP 0x10
DECL|macro|ASC_MIN_IOP_ADDR
mdefine_line|#define ASC_MIN_IOP_ADDR   ( PortAddr )0x0100
DECL|macro|ASC_MAX_IOP_ADDR
mdefine_line|#define ASC_MAX_IOP_ADDR   ( PortAddr )0x3F0
DECL|macro|ASC_IOADR_1
mdefine_line|#define ASC_IOADR_1     ( PortAddr )0x0110
DECL|macro|ASC_IOADR_2
mdefine_line|#define ASC_IOADR_2     ( PortAddr )0x0130
DECL|macro|ASC_IOADR_3
mdefine_line|#define ASC_IOADR_3     ( PortAddr )0x0150
DECL|macro|ASC_IOADR_4
mdefine_line|#define ASC_IOADR_4     ( PortAddr )0x0190
DECL|macro|ASC_IOADR_5
mdefine_line|#define ASC_IOADR_5     ( PortAddr )0x0210
DECL|macro|ASC_IOADR_6
mdefine_line|#define ASC_IOADR_6     ( PortAddr )0x0230
DECL|macro|ASC_IOADR_7
mdefine_line|#define ASC_IOADR_7     ( PortAddr )0x0250
DECL|macro|ASC_IOADR_8
mdefine_line|#define ASC_IOADR_8     ( PortAddr )0x0330
DECL|macro|ASC_IOADR_DEF
mdefine_line|#define ASC_IOADR_DEF   ASC_IOADR_8
DECL|macro|ASC_LIB_SCSIQ_WK_SP
mdefine_line|#define ASC_LIB_SCSIQ_WK_SP        256
DECL|macro|ASC_MAX_SYN_XFER_NO
mdefine_line|#define ASC_MAX_SYN_XFER_NO        16
DECL|macro|ASC_SYN_XFER_NO
mdefine_line|#define ASC_SYN_XFER_NO            8
DECL|macro|ASC_SYN_MAX_OFFSET
mdefine_line|#define ASC_SYN_MAX_OFFSET         0x0F
DECL|macro|ASC_DEF_SDTR_OFFSET
mdefine_line|#define ASC_DEF_SDTR_OFFSET        0x0F
DECL|macro|ASC_DEF_SDTR_INDEX
mdefine_line|#define ASC_DEF_SDTR_INDEX         0x00
DECL|macro|SYN_XFER_NS_0
mdefine_line|#define SYN_XFER_NS_0  25
DECL|macro|SYN_XFER_NS_1
mdefine_line|#define SYN_XFER_NS_1  30
DECL|macro|SYN_XFER_NS_2
mdefine_line|#define SYN_XFER_NS_2  35
DECL|macro|SYN_XFER_NS_3
mdefine_line|#define SYN_XFER_NS_3  40
DECL|macro|SYN_XFER_NS_4
mdefine_line|#define SYN_XFER_NS_4  50
DECL|macro|SYN_XFER_NS_5
mdefine_line|#define SYN_XFER_NS_5  60
DECL|macro|SYN_XFER_NS_6
mdefine_line|#define SYN_XFER_NS_6  70
DECL|macro|SYN_XFER_NS_7
mdefine_line|#define SYN_XFER_NS_7  85
DECL|macro|SYN_ULTRA_XFER_NS_0
mdefine_line|#define SYN_ULTRA_XFER_NS_0    12
DECL|macro|SYN_ULTRA_XFER_NS_1
mdefine_line|#define SYN_ULTRA_XFER_NS_1    19
DECL|macro|SYN_ULTRA_XFER_NS_2
mdefine_line|#define SYN_ULTRA_XFER_NS_2    25
DECL|macro|SYN_ULTRA_XFER_NS_3
mdefine_line|#define SYN_ULTRA_XFER_NS_3    32
DECL|macro|SYN_ULTRA_XFER_NS_4
mdefine_line|#define SYN_ULTRA_XFER_NS_4    38
DECL|macro|SYN_ULTRA_XFER_NS_5
mdefine_line|#define SYN_ULTRA_XFER_NS_5    44
DECL|macro|SYN_ULTRA_XFER_NS_6
mdefine_line|#define SYN_ULTRA_XFER_NS_6    50
DECL|macro|SYN_ULTRA_XFER_NS_7
mdefine_line|#define SYN_ULTRA_XFER_NS_7    57
DECL|macro|SYN_ULTRA_XFER_NS_8
mdefine_line|#define SYN_ULTRA_XFER_NS_8    63
DECL|macro|SYN_ULTRA_XFER_NS_9
mdefine_line|#define SYN_ULTRA_XFER_NS_9    69
DECL|macro|SYN_ULTRA_XFER_NS_10
mdefine_line|#define SYN_ULTRA_XFER_NS_10   75
DECL|macro|SYN_ULTRA_XFER_NS_11
mdefine_line|#define SYN_ULTRA_XFER_NS_11   82
DECL|macro|SYN_ULTRA_XFER_NS_12
mdefine_line|#define SYN_ULTRA_XFER_NS_12   88
DECL|macro|SYN_ULTRA_XFER_NS_13
mdefine_line|#define SYN_ULTRA_XFER_NS_13   94
DECL|macro|SYN_ULTRA_XFER_NS_14
mdefine_line|#define SYN_ULTRA_XFER_NS_14  100
DECL|macro|SYN_ULTRA_XFER_NS_15
mdefine_line|#define SYN_ULTRA_XFER_NS_15  107
DECL|macro|SYN_XMSG_WLEN
mdefine_line|#define SYN_XMSG_WLEN  3
DECL|struct|sdtr_xmsg
r_typedef
r_struct
id|sdtr_xmsg
(brace
DECL|member|msg_type
id|uchar
id|msg_type
suffix:semicolon
DECL|member|msg_len
id|uchar
id|msg_len
suffix:semicolon
DECL|member|msg_req
id|uchar
id|msg_req
suffix:semicolon
DECL|member|xfer_period
id|uchar
id|xfer_period
suffix:semicolon
DECL|member|req_ack_offset
id|uchar
id|req_ack_offset
suffix:semicolon
DECL|member|res
id|uchar
id|res
suffix:semicolon
DECL|typedef|SDTR_XMSG
)brace
id|SDTR_XMSG
suffix:semicolon
DECL|struct|asc_dvc_cfg
r_typedef
r_struct
id|asc_dvc_cfg
(brace
DECL|member|can_tagged_qng
id|ASC_SCSI_BIT_ID_TYPE
id|can_tagged_qng
suffix:semicolon
DECL|member|cmd_qng_enabled
id|ASC_SCSI_BIT_ID_TYPE
id|cmd_qng_enabled
suffix:semicolon
DECL|member|disc_enable
id|ASC_SCSI_BIT_ID_TYPE
id|disc_enable
suffix:semicolon
DECL|member|res
id|uchar
id|res
suffix:semicolon
DECL|member|chip_scsi_id
id|uchar
id|chip_scsi_id
suffix:colon
l_int|4
suffix:semicolon
DECL|member|isa_dma_speed
id|uchar
id|isa_dma_speed
suffix:colon
l_int|4
suffix:semicolon
DECL|member|isa_dma_channel
id|uchar
id|isa_dma_channel
suffix:semicolon
DECL|member|chip_version
id|uchar
id|chip_version
suffix:semicolon
DECL|member|pci_device_id
id|ushort
id|pci_device_id
suffix:semicolon
DECL|member|lib_serial_no
id|ushort
id|lib_serial_no
suffix:semicolon
DECL|member|lib_version
id|ushort
id|lib_version
suffix:semicolon
DECL|member|mcode_date
id|ushort
id|mcode_date
suffix:semicolon
DECL|member|mcode_version
id|ushort
id|mcode_version
suffix:semicolon
DECL|member|max_tag_qng
id|uchar
id|max_tag_qng
(braket
id|ASC_MAX_TID
op_plus
l_int|1
)braket
suffix:semicolon
DECL|member|overrun_buf
id|uchar
id|dosfar
op_star
id|overrun_buf
suffix:semicolon
DECL|member|sdtr_period_offset
id|uchar
id|sdtr_period_offset
(braket
id|ASC_MAX_TID
op_plus
l_int|1
)braket
suffix:semicolon
DECL|member|pci_slot_info
id|ushort
id|pci_slot_info
suffix:semicolon
DECL|typedef|ASC_DVC_CFG
)brace
id|ASC_DVC_CFG
suffix:semicolon
DECL|macro|ASC_DEF_DVC_CNTL
mdefine_line|#define ASC_DEF_DVC_CNTL       0xFFFF
DECL|macro|ASC_DEF_CHIP_SCSI_ID
mdefine_line|#define ASC_DEF_CHIP_SCSI_ID   7
DECL|macro|ASC_DEF_ISA_DMA_SPEED
mdefine_line|#define ASC_DEF_ISA_DMA_SPEED  4
DECL|macro|ASC_INIT_STATE_NULL
mdefine_line|#define ASC_INIT_STATE_NULL          0x0000
DECL|macro|ASC_INIT_STATE_BEG_GET_CFG
mdefine_line|#define ASC_INIT_STATE_BEG_GET_CFG   0x0001
DECL|macro|ASC_INIT_STATE_END_GET_CFG
mdefine_line|#define ASC_INIT_STATE_END_GET_CFG   0x0002
DECL|macro|ASC_INIT_STATE_BEG_SET_CFG
mdefine_line|#define ASC_INIT_STATE_BEG_SET_CFG   0x0004
DECL|macro|ASC_INIT_STATE_END_SET_CFG
mdefine_line|#define ASC_INIT_STATE_END_SET_CFG   0x0008
DECL|macro|ASC_INIT_STATE_BEG_LOAD_MC
mdefine_line|#define ASC_INIT_STATE_BEG_LOAD_MC   0x0010
DECL|macro|ASC_INIT_STATE_END_LOAD_MC
mdefine_line|#define ASC_INIT_STATE_END_LOAD_MC   0x0020
DECL|macro|ASC_INIT_STATE_BEG_INQUIRY
mdefine_line|#define ASC_INIT_STATE_BEG_INQUIRY   0x0040
DECL|macro|ASC_INIT_STATE_END_INQUIRY
mdefine_line|#define ASC_INIT_STATE_END_INQUIRY   0x0080
DECL|macro|ASC_INIT_RESET_SCSI_DONE
mdefine_line|#define ASC_INIT_RESET_SCSI_DONE     0x0100
DECL|macro|ASC_INIT_STATE_WITHOUT_EEP
mdefine_line|#define ASC_INIT_STATE_WITHOUT_EEP   0x8000
DECL|macro|ASC_PCI_DEVICE_ID_REV_A
mdefine_line|#define ASC_PCI_DEVICE_ID_REV_A      0x1100
DECL|macro|ASC_PCI_DEVICE_ID_REV_B
mdefine_line|#define ASC_PCI_DEVICE_ID_REV_B      0x1200
DECL|macro|ASC_BUG_FIX_IF_NOT_DWB
mdefine_line|#define ASC_BUG_FIX_IF_NOT_DWB       0x0001
DECL|macro|ASC_BUG_FIX_ASYN_USE_SYN
mdefine_line|#define ASC_BUG_FIX_ASYN_USE_SYN     0x0002
DECL|macro|ASYN_SDTR_DATA_FIX_PCI_REV_AB
mdefine_line|#define ASYN_SDTR_DATA_FIX_PCI_REV_AB 0x41
DECL|macro|ASC_MIN_TAGGED_CMD
mdefine_line|#define ASC_MIN_TAGGED_CMD  7
DECL|macro|ASC_MAX_SCSI_RESET_WAIT
mdefine_line|#define ASC_MAX_SCSI_RESET_WAIT      30
DECL|struct|asc_dvc_var
r_typedef
r_struct
id|asc_dvc_var
(brace
DECL|member|iop_base
id|PortAddr
id|iop_base
suffix:semicolon
DECL|member|err_code
id|ushort
id|err_code
suffix:semicolon
DECL|member|dvc_cntl
id|ushort
id|dvc_cntl
suffix:semicolon
DECL|member|bug_fix_cntl
id|ushort
id|bug_fix_cntl
suffix:semicolon
DECL|member|bus_type
id|ushort
id|bus_type
suffix:semicolon
DECL|member|isr_callback
id|Ptr2Func
id|isr_callback
suffix:semicolon
DECL|member|exe_callback
id|Ptr2Func
id|exe_callback
suffix:semicolon
DECL|member|init_sdtr
id|ASC_SCSI_BIT_ID_TYPE
id|init_sdtr
suffix:semicolon
DECL|member|sdtr_done
id|ASC_SCSI_BIT_ID_TYPE
id|sdtr_done
suffix:semicolon
DECL|member|use_tagged_qng
id|ASC_SCSI_BIT_ID_TYPE
id|use_tagged_qng
suffix:semicolon
DECL|member|unit_not_ready
id|ASC_SCSI_BIT_ID_TYPE
id|unit_not_ready
suffix:semicolon
DECL|member|queue_full_or_busy
id|ASC_SCSI_BIT_ID_TYPE
id|queue_full_or_busy
suffix:semicolon
DECL|member|start_motor
id|ASC_SCSI_BIT_ID_TYPE
id|start_motor
suffix:semicolon
DECL|member|scsi_reset_wait
id|uchar
id|scsi_reset_wait
suffix:semicolon
DECL|member|chip_no
id|uchar
id|chip_no
suffix:semicolon
DECL|member|is_in_int
r_char
id|is_in_int
suffix:semicolon
DECL|member|max_total_qng
id|uchar
id|max_total_qng
suffix:semicolon
DECL|member|cur_total_qng
id|uchar
id|cur_total_qng
suffix:semicolon
DECL|member|in_critical_cnt
id|uchar
id|in_critical_cnt
suffix:semicolon
DECL|member|irq_no
id|uchar
id|irq_no
suffix:semicolon
DECL|member|last_q_shortage
id|uchar
id|last_q_shortage
suffix:semicolon
DECL|member|init_state
id|ushort
id|init_state
suffix:semicolon
DECL|member|cur_dvc_qng
id|uchar
id|cur_dvc_qng
(braket
id|ASC_MAX_TID
op_plus
l_int|1
)braket
suffix:semicolon
DECL|member|max_dvc_qng
id|uchar
id|max_dvc_qng
(braket
id|ASC_MAX_TID
op_plus
l_int|1
)braket
suffix:semicolon
DECL|member|scsiq_busy_head
id|ASC_SCSI_Q
id|dosfar
op_star
id|scsiq_busy_head
(braket
id|ASC_MAX_TID
op_plus
l_int|1
)braket
suffix:semicolon
DECL|member|scsiq_busy_tail
id|ASC_SCSI_Q
id|dosfar
op_star
id|scsiq_busy_tail
(braket
id|ASC_MAX_TID
op_plus
l_int|1
)braket
suffix:semicolon
DECL|member|sdtr_period_tbl
id|uchar
id|sdtr_period_tbl
(braket
id|ASC_MAX_SYN_XFER_NO
)braket
suffix:semicolon
DECL|member|cfg
id|ASC_DVC_CFG
id|dosfar
op_star
id|cfg
suffix:semicolon
DECL|member|saved_ptr2func
id|Ptr2Func
id|saved_ptr2func
suffix:semicolon
DECL|member|pci_fix_asyn_xfer_always
id|ASC_SCSI_BIT_ID_TYPE
id|pci_fix_asyn_xfer_always
suffix:semicolon
DECL|member|redo_scam
r_char
id|redo_scam
suffix:semicolon
DECL|member|res2
id|ushort
id|res2
suffix:semicolon
DECL|member|dos_int13_table
id|uchar
id|dos_int13_table
(braket
id|ASC_MAX_TID
op_plus
l_int|1
)braket
suffix:semicolon
DECL|member|max_dma_count
id|ulong
id|max_dma_count
suffix:semicolon
DECL|member|no_scam
id|ASC_SCSI_BIT_ID_TYPE
id|no_scam
suffix:semicolon
DECL|member|pci_fix_asyn_xfer
id|ASC_SCSI_BIT_ID_TYPE
id|pci_fix_asyn_xfer
suffix:semicolon
DECL|member|max_sdtr_index
id|uchar
id|max_sdtr_index
suffix:semicolon
DECL|member|res4
id|uchar
id|res4
suffix:semicolon
DECL|member|drv_ptr
id|ulong
id|drv_ptr
suffix:semicolon
DECL|member|res6
id|ulong
id|res6
suffix:semicolon
DECL|member|res7
id|ulong
id|res7
suffix:semicolon
DECL|member|res8
id|ulong
id|res8
suffix:semicolon
DECL|typedef|ASC_DVC_VAR
)brace
id|ASC_DVC_VAR
suffix:semicolon
DECL|typedef|ASC_ISR_CALLBACK
r_typedef
r_int
(paren
id|dosfar
op_star
id|ASC_ISR_CALLBACK
)paren
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ASC_QDONE_INFO
id|dosfar
op_star
)paren
suffix:semicolon
DECL|typedef|ASC_EXE_CALLBACK
r_typedef
r_int
(paren
id|dosfar
op_star
id|ASC_EXE_CALLBACK
)paren
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
suffix:semicolon
DECL|struct|asc_dvc_inq_info
r_typedef
r_struct
id|asc_dvc_inq_info
(brace
DECL|member|type
id|uchar
id|type
(braket
id|ASC_MAX_TID
op_plus
l_int|1
)braket
(braket
id|ASC_MAX_LUN
op_plus
l_int|1
)braket
suffix:semicolon
DECL|typedef|ASC_DVC_INQ_INFO
)brace
id|ASC_DVC_INQ_INFO
suffix:semicolon
DECL|struct|asc_cap_info
r_typedef
r_struct
id|asc_cap_info
(brace
DECL|member|lba
id|ulong
id|lba
suffix:semicolon
DECL|member|blk_size
id|ulong
id|blk_size
suffix:semicolon
DECL|typedef|ASC_CAP_INFO
)brace
id|ASC_CAP_INFO
suffix:semicolon
DECL|struct|asc_cap_info_array
r_typedef
r_struct
id|asc_cap_info_array
(brace
DECL|member|cap_info
id|ASC_CAP_INFO
id|cap_info
(braket
id|ASC_MAX_TID
op_plus
l_int|1
)braket
(braket
id|ASC_MAX_LUN
op_plus
l_int|1
)braket
suffix:semicolon
DECL|typedef|ASC_CAP_INFO_ARRAY
)brace
id|ASC_CAP_INFO_ARRAY
suffix:semicolon
DECL|macro|ASC_MCNTL_NO_SEL_TIMEOUT
mdefine_line|#define ASC_MCNTL_NO_SEL_TIMEOUT  ( ushort )0x0001
DECL|macro|ASC_MCNTL_NULL_TARGET
mdefine_line|#define ASC_MCNTL_NULL_TARGET     ( ushort )0x0002
DECL|macro|ASC_CNTL_INITIATOR
mdefine_line|#define ASC_CNTL_INITIATOR         ( ushort )0x0001
DECL|macro|ASC_CNTL_BIOS_GT_1GB
mdefine_line|#define ASC_CNTL_BIOS_GT_1GB       ( ushort )0x0002
DECL|macro|ASC_CNTL_BIOS_GT_2_DISK
mdefine_line|#define ASC_CNTL_BIOS_GT_2_DISK    ( ushort )0x0004
DECL|macro|ASC_CNTL_BIOS_REMOVABLE
mdefine_line|#define ASC_CNTL_BIOS_REMOVABLE    ( ushort )0x0008
DECL|macro|ASC_CNTL_NO_SCAM
mdefine_line|#define ASC_CNTL_NO_SCAM           ( ushort )0x0010
DECL|macro|ASC_CNTL_INT_MULTI_Q
mdefine_line|#define ASC_CNTL_INT_MULTI_Q       ( ushort )0x0080
DECL|macro|ASC_CNTL_NO_LUN_SUPPORT
mdefine_line|#define ASC_CNTL_NO_LUN_SUPPORT    ( ushort )0x0040
DECL|macro|ASC_CNTL_NO_VERIFY_COPY
mdefine_line|#define ASC_CNTL_NO_VERIFY_COPY    ( ushort )0x0100
DECL|macro|ASC_CNTL_RESET_SCSI
mdefine_line|#define ASC_CNTL_RESET_SCSI        ( ushort )0x0200
DECL|macro|ASC_CNTL_INIT_INQUIRY
mdefine_line|#define ASC_CNTL_INIT_INQUIRY      ( ushort )0x0400
DECL|macro|ASC_CNTL_INIT_VERBOSE
mdefine_line|#define ASC_CNTL_INIT_VERBOSE      ( ushort )0x0800
DECL|macro|ASC_CNTL_SCSI_PARITY
mdefine_line|#define ASC_CNTL_SCSI_PARITY       ( ushort )0x1000
DECL|macro|ASC_CNTL_BURST_MODE
mdefine_line|#define ASC_CNTL_BURST_MODE        ( ushort )0x2000
DECL|macro|ASC_CNTL_USE_8_IOP_BASE
mdefine_line|#define ASC_CNTL_USE_8_IOP_BASE    ( ushort )0x4000
DECL|macro|ASC_EEP_DVC_CFG_BEG_VL
mdefine_line|#define ASC_EEP_DVC_CFG_BEG_VL    2
DECL|macro|ASC_EEP_MAX_DVC_ADDR_VL
mdefine_line|#define ASC_EEP_MAX_DVC_ADDR_VL   15
DECL|macro|ASC_EEP_DVC_CFG_BEG
mdefine_line|#define ASC_EEP_DVC_CFG_BEG      32
DECL|macro|ASC_EEP_MAX_DVC_ADDR
mdefine_line|#define ASC_EEP_MAX_DVC_ADDR     45
DECL|macro|ASC_EEP_DEFINED_WORDS
mdefine_line|#define ASC_EEP_DEFINED_WORDS    10
DECL|macro|ASC_EEP_MAX_ADDR
mdefine_line|#define ASC_EEP_MAX_ADDR         63
DECL|macro|ASC_EEP_RES_WORDS
mdefine_line|#define ASC_EEP_RES_WORDS         0
DECL|macro|ASC_EEP_MAX_RETRY
mdefine_line|#define ASC_EEP_MAX_RETRY        20
DECL|macro|ASC_MAX_INIT_BUSY_RETRY
mdefine_line|#define ASC_MAX_INIT_BUSY_RETRY   8
DECL|macro|ASC_EEP_ISA_PNP_WSIZE
mdefine_line|#define ASC_EEP_ISA_PNP_WSIZE    16
DECL|struct|asceep_config
r_typedef
r_struct
id|asceep_config
(brace
DECL|member|cfg_lsw
id|ushort
id|cfg_lsw
suffix:semicolon
DECL|member|cfg_msw
id|ushort
id|cfg_msw
suffix:semicolon
DECL|member|init_sdtr
id|uchar
id|init_sdtr
suffix:semicolon
DECL|member|disc_enable
id|uchar
id|disc_enable
suffix:semicolon
DECL|member|use_cmd_qng
id|uchar
id|use_cmd_qng
suffix:semicolon
DECL|member|start_motor
id|uchar
id|start_motor
suffix:semicolon
DECL|member|max_total_qng
id|uchar
id|max_total_qng
suffix:semicolon
DECL|member|max_tag_qng
id|uchar
id|max_tag_qng
suffix:semicolon
DECL|member|bios_scan
id|uchar
id|bios_scan
suffix:semicolon
DECL|member|power_up_wait
id|uchar
id|power_up_wait
suffix:semicolon
DECL|member|no_scam
id|uchar
id|no_scam
suffix:semicolon
DECL|member|chip_scsi_id
id|uchar
id|chip_scsi_id
suffix:colon
l_int|4
suffix:semicolon
DECL|member|isa_dma_speed
id|uchar
id|isa_dma_speed
suffix:colon
l_int|4
suffix:semicolon
DECL|member|dos_int13_table
id|uchar
id|dos_int13_table
(braket
id|ASC_MAX_TID
op_plus
l_int|1
)braket
suffix:semicolon
DECL|member|adapter_info
id|uchar
id|adapter_info
(braket
l_int|6
)braket
suffix:semicolon
DECL|member|cntl
id|ushort
id|cntl
suffix:semicolon
DECL|member|chksum
id|ushort
id|chksum
suffix:semicolon
DECL|typedef|ASCEEP_CONFIG
)brace
id|ASCEEP_CONFIG
suffix:semicolon
DECL|macro|ASC_EEP_CMD_READ
mdefine_line|#define ASC_EEP_CMD_READ          0x80
DECL|macro|ASC_EEP_CMD_WRITE
mdefine_line|#define ASC_EEP_CMD_WRITE         0x40
DECL|macro|ASC_EEP_CMD_WRITE_ABLE
mdefine_line|#define ASC_EEP_CMD_WRITE_ABLE    0x30
DECL|macro|ASC_EEP_CMD_WRITE_DISABLE
mdefine_line|#define ASC_EEP_CMD_WRITE_DISABLE 0x00
DECL|macro|ASC_OVERRUN_BSIZE
mdefine_line|#define ASC_OVERRUN_BSIZE  0x00000048UL
DECL|macro|ASCV_MSGOUT_BEG
mdefine_line|#define ASCV_MSGOUT_BEG         0x0000
DECL|macro|ASCV_MSGOUT_SDTR_PERIOD
mdefine_line|#define ASCV_MSGOUT_SDTR_PERIOD (ASCV_MSGOUT_BEG+3)
DECL|macro|ASCV_MSGOUT_SDTR_OFFSET
mdefine_line|#define ASCV_MSGOUT_SDTR_OFFSET (ASCV_MSGOUT_BEG+4)
DECL|macro|ASCV_MSGIN_BEG
mdefine_line|#define ASCV_MSGIN_BEG          (ASCV_MSGOUT_BEG+8)
DECL|macro|ASCV_MSGIN_SDTR_PERIOD
mdefine_line|#define ASCV_MSGIN_SDTR_PERIOD  (ASCV_MSGIN_BEG+3)
DECL|macro|ASCV_MSGIN_SDTR_OFFSET
mdefine_line|#define ASCV_MSGIN_SDTR_OFFSET  (ASCV_MSGIN_BEG+4)
DECL|macro|ASCV_SDTR_DATA_BEG
mdefine_line|#define ASCV_SDTR_DATA_BEG      (ASCV_MSGIN_BEG+8)
DECL|macro|ASCV_SDTR_DONE_BEG
mdefine_line|#define ASCV_SDTR_DONE_BEG      (ASCV_SDTR_DATA_BEG+8)
DECL|macro|ASCV_MAX_DVC_QNG_BEG
mdefine_line|#define ASCV_MAX_DVC_QNG_BEG    ( ushort )0x0020
DECL|macro|ASCV_ASCDVC_ERR_CODE_W
mdefine_line|#define ASCV_ASCDVC_ERR_CODE_W  ( ushort )0x0030
DECL|macro|ASCV_MCODE_CHKSUM_W
mdefine_line|#define ASCV_MCODE_CHKSUM_W   ( ushort )0x0032
DECL|macro|ASCV_MCODE_SIZE_W
mdefine_line|#define ASCV_MCODE_SIZE_W     ( ushort )0x0034
DECL|macro|ASCV_STOP_CODE_B
mdefine_line|#define ASCV_STOP_CODE_B      ( ushort )0x0036
DECL|macro|ASCV_DVC_ERR_CODE_B
mdefine_line|#define ASCV_DVC_ERR_CODE_B   ( ushort )0x0037
DECL|macro|ASCV_OVERRUN_PADDR_D
mdefine_line|#define ASCV_OVERRUN_PADDR_D  ( ushort )0x0038
DECL|macro|ASCV_OVERRUN_BSIZE_D
mdefine_line|#define ASCV_OVERRUN_BSIZE_D  ( ushort )0x003C
DECL|macro|ASCV_HALTCODE_W
mdefine_line|#define ASCV_HALTCODE_W       ( ushort )0x0040
DECL|macro|ASCV_CHKSUM_W
mdefine_line|#define ASCV_CHKSUM_W         ( ushort )0x0042
DECL|macro|ASCV_MC_DATE_W
mdefine_line|#define ASCV_MC_DATE_W        ( ushort )0x0044
DECL|macro|ASCV_MC_VER_W
mdefine_line|#define ASCV_MC_VER_W         ( ushort )0x0046
DECL|macro|ASCV_NEXTRDY_B
mdefine_line|#define ASCV_NEXTRDY_B        ( ushort )0x0048
DECL|macro|ASCV_DONENEXT_B
mdefine_line|#define ASCV_DONENEXT_B       ( ushort )0x0049
DECL|macro|ASCV_USE_TAGGED_QNG_B
mdefine_line|#define ASCV_USE_TAGGED_QNG_B ( ushort )0x004A
DECL|macro|ASCV_SCSIBUSY_B
mdefine_line|#define ASCV_SCSIBUSY_B       ( ushort )0x004B
DECL|macro|ASCV_Q_DONE_IN_PROGRESS_B
mdefine_line|#define ASCV_Q_DONE_IN_PROGRESS_B  ( ushort )0x004C
DECL|macro|ASCV_CURCDB_B
mdefine_line|#define ASCV_CURCDB_B         ( ushort )0x004D
DECL|macro|ASCV_RCLUN_B
mdefine_line|#define ASCV_RCLUN_B          ( ushort )0x004E
DECL|macro|ASCV_BUSY_QHEAD_B
mdefine_line|#define ASCV_BUSY_QHEAD_B     ( ushort )0x004F
DECL|macro|ASCV_DISC1_QHEAD_B
mdefine_line|#define ASCV_DISC1_QHEAD_B    ( ushort )0x0050
DECL|macro|ASCV_DISC_ENABLE_B
mdefine_line|#define ASCV_DISC_ENABLE_B    ( ushort )0x0052
DECL|macro|ASCV_CAN_TAGGED_QNG_B
mdefine_line|#define ASCV_CAN_TAGGED_QNG_B ( ushort )0x0053
DECL|macro|ASCV_HOSTSCSI_ID_B
mdefine_line|#define ASCV_HOSTSCSI_ID_B    ( ushort )0x0055
DECL|macro|ASCV_MCODE_CNTL_B
mdefine_line|#define ASCV_MCODE_CNTL_B     ( ushort )0x0056
DECL|macro|ASCV_NULL_TARGET_B
mdefine_line|#define ASCV_NULL_TARGET_B    ( ushort )0x0057
DECL|macro|ASCV_FREE_Q_HEAD_W
mdefine_line|#define ASCV_FREE_Q_HEAD_W    ( ushort )0x0058
DECL|macro|ASCV_DONE_Q_TAIL_W
mdefine_line|#define ASCV_DONE_Q_TAIL_W    ( ushort )0x005A
DECL|macro|ASCV_FREE_Q_HEAD_B
mdefine_line|#define ASCV_FREE_Q_HEAD_B    ( ushort )(ASCV_FREE_Q_HEAD_W+1)
DECL|macro|ASCV_DONE_Q_TAIL_B
mdefine_line|#define ASCV_DONE_Q_TAIL_B    ( ushort )(ASCV_DONE_Q_TAIL_W+1)
DECL|macro|ASCV_HOST_FLAG_B
mdefine_line|#define ASCV_HOST_FLAG_B      ( ushort )0x005D
DECL|macro|ASCV_TOTAL_READY_Q_B
mdefine_line|#define ASCV_TOTAL_READY_Q_B  ( ushort )0x0064
DECL|macro|ASCV_VER_SERIAL_B
mdefine_line|#define ASCV_VER_SERIAL_B     ( ushort )0x0065
DECL|macro|ASCV_HALTCODE_SAVED_W
mdefine_line|#define ASCV_HALTCODE_SAVED_W ( ushort )0x0066
DECL|macro|ASCV_WTM_FLAG_B
mdefine_line|#define ASCV_WTM_FLAG_B       ( ushort )0x0068
DECL|macro|ASCV_RISC_FLAG_B
mdefine_line|#define ASCV_RISC_FLAG_B      ( ushort )0x006A
DECL|macro|ASCV_REQ_SG_LIST_QP
mdefine_line|#define ASCV_REQ_SG_LIST_QP   ( ushort )0x006B
DECL|macro|ASC_HOST_FLAG_IN_ISR
mdefine_line|#define ASC_HOST_FLAG_IN_ISR        0x01
DECL|macro|ASC_HOST_FLAG_ACK_INT
mdefine_line|#define ASC_HOST_FLAG_ACK_INT       0x02
DECL|macro|ASC_RISC_FLAG_GEN_INT
mdefine_line|#define ASC_RISC_FLAG_GEN_INT      0x01
DECL|macro|ASC_RISC_FLAG_REQ_SG_LIST
mdefine_line|#define ASC_RISC_FLAG_REQ_SG_LIST  0x02
DECL|macro|IOP_CTRL
mdefine_line|#define IOP_CTRL         (0x0F)
DECL|macro|IOP_STATUS
mdefine_line|#define IOP_STATUS       (0x0E)
DECL|macro|IOP_INT_ACK
mdefine_line|#define IOP_INT_ACK      IOP_STATUS
DECL|macro|IOP_REG_IFC
mdefine_line|#define IOP_REG_IFC      (0x0D)
DECL|macro|IOP_SYN_OFFSET
mdefine_line|#define IOP_SYN_OFFSET    (0x0B)
DECL|macro|IOP_EXTRA_CONTROL
mdefine_line|#define IOP_EXTRA_CONTROL (0x0D)
DECL|macro|IOP_REG_PC
mdefine_line|#define IOP_REG_PC        (0x0C)
DECL|macro|IOP_RAM_ADDR
mdefine_line|#define IOP_RAM_ADDR      (0x0A)
DECL|macro|IOP_RAM_DATA
mdefine_line|#define IOP_RAM_DATA      (0x08)
DECL|macro|IOP_EEP_DATA
mdefine_line|#define IOP_EEP_DATA      (0x06)
DECL|macro|IOP_EEP_CMD
mdefine_line|#define IOP_EEP_CMD       (0x07)
DECL|macro|IOP_VERSION
mdefine_line|#define IOP_VERSION       (0x03)
DECL|macro|IOP_CONFIG_HIGH
mdefine_line|#define IOP_CONFIG_HIGH   (0x04)
DECL|macro|IOP_CONFIG_LOW
mdefine_line|#define IOP_CONFIG_LOW    (0x02)
DECL|macro|IOP_SIG_BYTE
mdefine_line|#define IOP_SIG_BYTE      (0x01)
DECL|macro|IOP_SIG_WORD
mdefine_line|#define IOP_SIG_WORD      (0x00)
DECL|macro|IOP_REG_DC1
mdefine_line|#define IOP_REG_DC1      (0x0E)
DECL|macro|IOP_REG_DC0
mdefine_line|#define IOP_REG_DC0      (0x0C)
DECL|macro|IOP_REG_SB
mdefine_line|#define IOP_REG_SB       (0x0B)
DECL|macro|IOP_REG_DA1
mdefine_line|#define IOP_REG_DA1      (0x0A)
DECL|macro|IOP_REG_DA0
mdefine_line|#define IOP_REG_DA0      (0x08)
DECL|macro|IOP_REG_SC
mdefine_line|#define IOP_REG_SC       (0x09)
DECL|macro|IOP_DMA_SPEED
mdefine_line|#define IOP_DMA_SPEED    (0x07)
DECL|macro|IOP_REG_FLAG
mdefine_line|#define IOP_REG_FLAG     (0x07)
DECL|macro|IOP_FIFO_H
mdefine_line|#define IOP_FIFO_H       (0x06)
DECL|macro|IOP_FIFO_L
mdefine_line|#define IOP_FIFO_L       (0x04)
DECL|macro|IOP_REG_ID
mdefine_line|#define IOP_REG_ID       (0x05)
DECL|macro|IOP_REG_QP
mdefine_line|#define IOP_REG_QP       (0x03)
DECL|macro|IOP_REG_IH
mdefine_line|#define IOP_REG_IH       (0x02)
DECL|macro|IOP_REG_IX
mdefine_line|#define IOP_REG_IX       (0x01)
DECL|macro|IOP_REG_AX
mdefine_line|#define IOP_REG_AX       (0x00)
DECL|macro|IFC_REG_LOCK
mdefine_line|#define IFC_REG_LOCK      (0x00)
DECL|macro|IFC_REG_UNLOCK
mdefine_line|#define IFC_REG_UNLOCK    (0x09)
DECL|macro|IFC_WR_EN_FILTER
mdefine_line|#define IFC_WR_EN_FILTER  (0x10)
DECL|macro|IFC_RD_NO_EEPROM
mdefine_line|#define IFC_RD_NO_EEPROM  (0x10)
DECL|macro|IFC_SLEW_RATE
mdefine_line|#define IFC_SLEW_RATE     (0x20)
DECL|macro|IFC_ACT_NEG
mdefine_line|#define IFC_ACT_NEG       (0x40)
DECL|macro|IFC_INP_FILTER
mdefine_line|#define IFC_INP_FILTER    (0x80)
DECL|macro|IFC_INIT_DEFAULT
mdefine_line|#define IFC_INIT_DEFAULT  ( IFC_ACT_NEG | IFC_REG_UNLOCK )
DECL|macro|SC_SEL
mdefine_line|#define SC_SEL   ( uchar )(0x80)
DECL|macro|SC_BSY
mdefine_line|#define SC_BSY   ( uchar )(0x40)
DECL|macro|SC_ACK
mdefine_line|#define SC_ACK   ( uchar )(0x20)
DECL|macro|SC_REQ
mdefine_line|#define SC_REQ   ( uchar )(0x10)
DECL|macro|SC_ATN
mdefine_line|#define SC_ATN   ( uchar )(0x08)
DECL|macro|SC_IO
mdefine_line|#define SC_IO    ( uchar )(0x04)
DECL|macro|SC_CD
mdefine_line|#define SC_CD    ( uchar )(0x02)
DECL|macro|SC_MSG
mdefine_line|#define SC_MSG   ( uchar )(0x01)
DECL|macro|SEC_ACTIVE_NEGATE
mdefine_line|#define SEC_ACTIVE_NEGATE    ( uchar )( 0x40 )
DECL|macro|SEC_SLEW_RATE
mdefine_line|#define SEC_SLEW_RATE        ( uchar )( 0x20 )
DECL|macro|ASC_HALT_EXTMSG_IN
mdefine_line|#define ASC_HALT_EXTMSG_IN     ( ushort )0x8000
DECL|macro|ASC_HALT_CHK_CONDITION
mdefine_line|#define ASC_HALT_CHK_CONDITION ( ushort )0x8100
DECL|macro|ASC_HALT_SS_QUEUE_FULL
mdefine_line|#define ASC_HALT_SS_QUEUE_FULL ( ushort )0x8200
DECL|macro|ASC_HALT_DISABLE_ASYN_USE_SYN_FIX
mdefine_line|#define ASC_HALT_DISABLE_ASYN_USE_SYN_FIX  ( ushort )0x8300
DECL|macro|ASC_HALT_ENABLE_ASYN_USE_SYN_FIX
mdefine_line|#define ASC_HALT_ENABLE_ASYN_USE_SYN_FIX   ( ushort )0x8400
DECL|macro|ASC_HALT_SDTR_REJECTED
mdefine_line|#define ASC_HALT_SDTR_REJECTED ( ushort )0x4000
DECL|macro|ASC_MAX_QNO
mdefine_line|#define ASC_MAX_QNO        0xF8
DECL|macro|ASC_DATA_SEC_BEG
mdefine_line|#define ASC_DATA_SEC_BEG   ( ushort )0x0080
DECL|macro|ASC_DATA_SEC_END
mdefine_line|#define ASC_DATA_SEC_END   ( ushort )0x0080
DECL|macro|ASC_CODE_SEC_BEG
mdefine_line|#define ASC_CODE_SEC_BEG   ( ushort )0x0080
DECL|macro|ASC_CODE_SEC_END
mdefine_line|#define ASC_CODE_SEC_END   ( ushort )0x0080
DECL|macro|ASC_QADR_BEG
mdefine_line|#define ASC_QADR_BEG       (0x4000)
DECL|macro|ASC_QADR_USED
mdefine_line|#define ASC_QADR_USED      ( ushort )( ASC_MAX_QNO * 64 )
DECL|macro|ASC_QADR_END
mdefine_line|#define ASC_QADR_END       ( ushort )0x7FFF
DECL|macro|ASC_QLAST_ADR
mdefine_line|#define ASC_QLAST_ADR      ( ushort )0x7FC0
DECL|macro|ASC_QBLK_SIZE
mdefine_line|#define ASC_QBLK_SIZE      0x40
DECL|macro|ASC_BIOS_DATA_QBEG
mdefine_line|#define ASC_BIOS_DATA_QBEG 0xF8
DECL|macro|ASC_MIN_ACTIVE_QNO
mdefine_line|#define ASC_MIN_ACTIVE_QNO 0x01
DECL|macro|ASC_QLINK_END
mdefine_line|#define ASC_QLINK_END      0xFF
DECL|macro|ASC_EEPROM_WORDS
mdefine_line|#define ASC_EEPROM_WORDS   0x10
DECL|macro|ASC_MAX_MGS_LEN
mdefine_line|#define ASC_MAX_MGS_LEN    0x10
DECL|macro|ASC_BIOS_ADDR_DEF
mdefine_line|#define ASC_BIOS_ADDR_DEF  0xDC00
DECL|macro|ASC_BIOS_SIZE
mdefine_line|#define ASC_BIOS_SIZE      0x3800
DECL|macro|ASC_BIOS_RAM_OFF
mdefine_line|#define ASC_BIOS_RAM_OFF   0x3800
DECL|macro|ASC_BIOS_RAM_SIZE
mdefine_line|#define ASC_BIOS_RAM_SIZE  0x800
DECL|macro|ASC_BIOS_MIN_ADDR
mdefine_line|#define ASC_BIOS_MIN_ADDR  0xC000
DECL|macro|ASC_BIOS_MAX_ADDR
mdefine_line|#define ASC_BIOS_MAX_ADDR  0xEC00
DECL|macro|ASC_BIOS_BANK_SIZE
mdefine_line|#define ASC_BIOS_BANK_SIZE 0x0400
DECL|macro|ASC_MCODE_START_ADDR
mdefine_line|#define ASC_MCODE_START_ADDR  0x0080
DECL|macro|ASC_CFG0_HOST_INT_ON
mdefine_line|#define ASC_CFG0_HOST_INT_ON    0x0020
DECL|macro|ASC_CFG0_BIOS_ON
mdefine_line|#define ASC_CFG0_BIOS_ON        0x0040
DECL|macro|ASC_CFG0_VERA_BURST_ON
mdefine_line|#define ASC_CFG0_VERA_BURST_ON  0x0080
DECL|macro|ASC_CFG0_SCSI_PARITY_ON
mdefine_line|#define ASC_CFG0_SCSI_PARITY_ON 0x0800
DECL|macro|ASC_CFG1_SCSI_TARGET_ON
mdefine_line|#define ASC_CFG1_SCSI_TARGET_ON 0x0080
DECL|macro|ASC_CFG1_LRAM_8BITS_ON
mdefine_line|#define ASC_CFG1_LRAM_8BITS_ON  0x0800
DECL|macro|ASC_CFG_MSW_CLR_MASK
mdefine_line|#define ASC_CFG_MSW_CLR_MASK    0x30C0
DECL|macro|CSW_TEST1
mdefine_line|#define CSW_TEST1             ( ASC_CS_TYPE )0x8000
DECL|macro|CSW_AUTO_CONFIG
mdefine_line|#define CSW_AUTO_CONFIG       ( ASC_CS_TYPE )0x4000
DECL|macro|CSW_RESERVED1
mdefine_line|#define CSW_RESERVED1         ( ASC_CS_TYPE )0x2000
DECL|macro|CSW_IRQ_WRITTEN
mdefine_line|#define CSW_IRQ_WRITTEN       ( ASC_CS_TYPE )0x1000
DECL|macro|CSW_33MHZ_SELECTED
mdefine_line|#define CSW_33MHZ_SELECTED    ( ASC_CS_TYPE )0x0800
DECL|macro|CSW_TEST2
mdefine_line|#define CSW_TEST2             ( ASC_CS_TYPE )0x0400
DECL|macro|CSW_TEST3
mdefine_line|#define CSW_TEST3             ( ASC_CS_TYPE )0x0200
DECL|macro|CSW_RESERVED2
mdefine_line|#define CSW_RESERVED2         ( ASC_CS_TYPE )0x0100
DECL|macro|CSW_DMA_DONE
mdefine_line|#define CSW_DMA_DONE          ( ASC_CS_TYPE )0x0080
DECL|macro|CSW_FIFO_RDY
mdefine_line|#define CSW_FIFO_RDY          ( ASC_CS_TYPE )0x0040
DECL|macro|CSW_EEP_READ_DONE
mdefine_line|#define CSW_EEP_READ_DONE     ( ASC_CS_TYPE )0x0020
DECL|macro|CSW_HALTED
mdefine_line|#define CSW_HALTED            ( ASC_CS_TYPE )0x0010
DECL|macro|CSW_SCSI_RESET_ACTIVE
mdefine_line|#define CSW_SCSI_RESET_ACTIVE ( ASC_CS_TYPE )0x0008
DECL|macro|CSW_PARITY_ERR
mdefine_line|#define CSW_PARITY_ERR        ( ASC_CS_TYPE )0x0004
DECL|macro|CSW_SCSI_RESET_LATCH
mdefine_line|#define CSW_SCSI_RESET_LATCH  ( ASC_CS_TYPE )0x0002
DECL|macro|CSW_INT_PENDING
mdefine_line|#define CSW_INT_PENDING       ( ASC_CS_TYPE )0x0001
DECL|macro|CIW_CLR_SCSI_RESET_INT
mdefine_line|#define CIW_CLR_SCSI_RESET_INT ( ASC_CS_TYPE )0x1000
DECL|macro|CIW_INT_ACK
mdefine_line|#define CIW_INT_ACK      ( ASC_CS_TYPE )0x0100
DECL|macro|CIW_TEST1
mdefine_line|#define CIW_TEST1        ( ASC_CS_TYPE )0x0200
DECL|macro|CIW_TEST2
mdefine_line|#define CIW_TEST2        ( ASC_CS_TYPE )0x0400
DECL|macro|CIW_SEL_33MHZ
mdefine_line|#define CIW_SEL_33MHZ    ( ASC_CS_TYPE )0x0800
DECL|macro|CIW_IRQ_ACT
mdefine_line|#define CIW_IRQ_ACT      ( ASC_CS_TYPE )0x1000
DECL|macro|CC_CHIP_RESET
mdefine_line|#define CC_CHIP_RESET   ( uchar )0x80
DECL|macro|CC_SCSI_RESET
mdefine_line|#define CC_SCSI_RESET   ( uchar )0x40
DECL|macro|CC_HALT
mdefine_line|#define CC_HALT         ( uchar )0x20
DECL|macro|CC_SINGLE_STEP
mdefine_line|#define CC_SINGLE_STEP  ( uchar )0x10
DECL|macro|CC_DMA_ABLE
mdefine_line|#define CC_DMA_ABLE     ( uchar )0x08
DECL|macro|CC_TEST
mdefine_line|#define CC_TEST         ( uchar )0x04
DECL|macro|CC_BANK_ONE
mdefine_line|#define CC_BANK_ONE     ( uchar )0x02
DECL|macro|CC_DIAG
mdefine_line|#define CC_DIAG         ( uchar )0x01
DECL|macro|ASC_1000_ID0W
mdefine_line|#define ASC_1000_ID0W      0x04C1
DECL|macro|ASC_1000_ID0W_FIX
mdefine_line|#define ASC_1000_ID0W_FIX  0x00C1
DECL|macro|ASC_1000_ID1B
mdefine_line|#define ASC_1000_ID1B      0x25
DECL|macro|ASC_EISA_BIG_IOP_GAP
mdefine_line|#define ASC_EISA_BIG_IOP_GAP   (0x1C30-0x0C50)
DECL|macro|ASC_EISA_SMALL_IOP_GAP
mdefine_line|#define ASC_EISA_SMALL_IOP_GAP (0x0020)
DECL|macro|ASC_EISA_MIN_IOP_ADDR
mdefine_line|#define ASC_EISA_MIN_IOP_ADDR  (0x0C30)
DECL|macro|ASC_EISA_MAX_IOP_ADDR
mdefine_line|#define ASC_EISA_MAX_IOP_ADDR  (0xFC50)
DECL|macro|ASC_EISA_REV_IOP_MASK
mdefine_line|#define ASC_EISA_REV_IOP_MASK  (0x0C83)
DECL|macro|ASC_EISA_PID_IOP_MASK
mdefine_line|#define ASC_EISA_PID_IOP_MASK  (0x0C80)
DECL|macro|ASC_EISA_CFG_IOP_MASK
mdefine_line|#define ASC_EISA_CFG_IOP_MASK  (0x0C86)
DECL|macro|ASC_GET_EISA_SLOT
mdefine_line|#define ASC_GET_EISA_SLOT( iop )  ( PortAddr )( (iop) &amp; 0xF000 )
DECL|macro|ASC_EISA_ID_740
mdefine_line|#define ASC_EISA_ID_740    0x01745004UL
DECL|macro|ASC_EISA_ID_750
mdefine_line|#define ASC_EISA_ID_750    0x01755004UL
DECL|macro|INS_HALTINT
mdefine_line|#define INS_HALTINT        ( ushort )0x6281
DECL|macro|INS_HALT
mdefine_line|#define INS_HALT           ( ushort )0x6280
DECL|macro|INS_SINT
mdefine_line|#define INS_SINT           ( ushort )0x6200
DECL|macro|INS_RFLAG_WTM
mdefine_line|#define INS_RFLAG_WTM      ( ushort )0x7380
DECL|macro|ASC_MC_SAVE_CODE_WSIZE
mdefine_line|#define ASC_MC_SAVE_CODE_WSIZE  0x500
DECL|macro|ASC_MC_SAVE_DATA_WSIZE
mdefine_line|#define ASC_MC_SAVE_DATA_WSIZE  0x40
DECL|struct|asc_mc_saved
r_typedef
r_struct
id|asc_mc_saved
(brace
DECL|member|data
id|ushort
id|data
(braket
id|ASC_MC_SAVE_DATA_WSIZE
)braket
suffix:semicolon
DECL|member|code
id|ushort
id|code
(braket
id|ASC_MC_SAVE_CODE_WSIZE
)braket
suffix:semicolon
DECL|typedef|ASC_MC_SAVED
)brace
id|ASC_MC_SAVED
suffix:semicolon
DECL|macro|AscGetQDoneInProgress
mdefine_line|#define AscGetQDoneInProgress( port )         AscReadLramByte( (port), ASCV_Q_DONE_IN_PROGRESS_B )
DECL|macro|AscPutQDoneInProgress
mdefine_line|#define AscPutQDoneInProgress( port, val )    AscWriteLramByte( (port), ASCV_Q_DONE_IN_PROGRESS_B, val )
DECL|macro|AscGetVarFreeQHead
mdefine_line|#define AscGetVarFreeQHead( port )            AscReadLramWord( (port), ASCV_FREE_Q_HEAD_W )
DECL|macro|AscGetVarDoneQTail
mdefine_line|#define AscGetVarDoneQTail( port )            AscReadLramWord( (port), ASCV_DONE_Q_TAIL_W )
DECL|macro|AscPutVarFreeQHead
mdefine_line|#define AscPutVarFreeQHead( port, val )       AscWriteLramWord( (port), ASCV_FREE_Q_HEAD_W, val )
DECL|macro|AscPutVarDoneQTail
mdefine_line|#define AscPutVarDoneQTail( port, val )       AscWriteLramWord( (port), ASCV_DONE_Q_TAIL_W, val )
DECL|macro|AscGetRiscVarFreeQHead
mdefine_line|#define AscGetRiscVarFreeQHead( port )        AscReadLramByte( (port), ASCV_NEXTRDY_B )
DECL|macro|AscGetRiscVarDoneQTail
mdefine_line|#define AscGetRiscVarDoneQTail( port )        AscReadLramByte( (port), ASCV_DONENEXT_B )
DECL|macro|AscPutRiscVarFreeQHead
mdefine_line|#define AscPutRiscVarFreeQHead( port, val )   AscWriteLramByte( (port), ASCV_NEXTRDY_B, val )
DECL|macro|AscPutRiscVarDoneQTail
mdefine_line|#define AscPutRiscVarDoneQTail( port, val )   AscWriteLramByte( (port), ASCV_DONENEXT_B, val )
DECL|macro|AscPutMCodeSDTRDoneAtID
mdefine_line|#define AscPutMCodeSDTRDoneAtID( port, id, data )  AscWriteLramByte( (port), ( ushort )( ( ushort )ASCV_SDTR_DONE_BEG+( ushort )id ), (data) ) ;
DECL|macro|AscGetMCodeSDTRDoneAtID
mdefine_line|#define AscGetMCodeSDTRDoneAtID( port, id )        AscReadLramByte( (port), ( ushort )( ( ushort )ASCV_SDTR_DONE_BEG+( ushort )id ) ) ;
DECL|macro|AscPutMCodeInitSDTRAtID
mdefine_line|#define AscPutMCodeInitSDTRAtID( port, id, data )  AscWriteLramByte( (port), ( ushort )( ( ushort )ASCV_SDTR_DATA_BEG+( ushort )id ), data ) ;
DECL|macro|AscGetMCodeInitSDTRAtID
mdefine_line|#define AscGetMCodeInitSDTRAtID( port, id )        AscReadLramByte( (port), ( ushort )( ( ushort )ASCV_SDTR_DATA_BEG+( ushort )id ) ) ;
DECL|macro|AscSynIndexToPeriod
mdefine_line|#define AscSynIndexToPeriod( index )        ( uchar )( asc_dvc-&gt;sdtr_period_tbl[ (index) ] )
DECL|macro|AscGetChipSignatureByte
mdefine_line|#define AscGetChipSignatureByte( port )     ( uchar )inp( (port)+IOP_SIG_BYTE )
DECL|macro|AscGetChipSignatureWord
mdefine_line|#define AscGetChipSignatureWord( port )     ( ushort )inpw( (port)+IOP_SIG_WORD )
DECL|macro|AscGetChipVerNo
mdefine_line|#define AscGetChipVerNo( port )             ( uchar )inp( (port)+IOP_VERSION )
DECL|macro|AscGetChipCfgLsw
mdefine_line|#define AscGetChipCfgLsw( port )            ( ushort )inpw( (port)+IOP_CONFIG_LOW )
DECL|macro|AscGetChipCfgMsw
mdefine_line|#define AscGetChipCfgMsw( port )            ( ushort )inpw( (port)+IOP_CONFIG_HIGH )
DECL|macro|AscSetChipCfgLsw
mdefine_line|#define AscSetChipCfgLsw( port, data )      outpw( (port)+IOP_CONFIG_LOW, data )
DECL|macro|AscSetChipCfgMsw
mdefine_line|#define AscSetChipCfgMsw( port, data )      outpw( (port)+IOP_CONFIG_HIGH, data )
DECL|macro|AscGetChipEEPCmd
mdefine_line|#define AscGetChipEEPCmd( port )            ( uchar )inp( (port)+IOP_EEP_CMD )
DECL|macro|AscSetChipEEPCmd
mdefine_line|#define AscSetChipEEPCmd( port, data )      outp( (port)+IOP_EEP_CMD, data )
DECL|macro|AscGetChipEEPData
mdefine_line|#define AscGetChipEEPData( port )           ( ushort )inpw( (port)+IOP_EEP_DATA )
DECL|macro|AscSetChipEEPData
mdefine_line|#define AscSetChipEEPData( port, data )     outpw( (port)+IOP_EEP_DATA, data )
DECL|macro|AscGetChipLramAddr
mdefine_line|#define AscGetChipLramAddr( port )          ( ushort )inpw( ( PortAddr )((port)+IOP_RAM_ADDR) )
DECL|macro|AscSetChipLramAddr
mdefine_line|#define AscSetChipLramAddr( port, addr )    outpw( ( PortAddr )( (port)+IOP_RAM_ADDR ), addr )
DECL|macro|AscGetChipLramData
mdefine_line|#define AscGetChipLramData( port )          ( ushort )inpw( (port)+IOP_RAM_DATA )
DECL|macro|AscSetChipLramData
mdefine_line|#define AscSetChipLramData( port, data )    outpw( (port)+IOP_RAM_DATA, data )
DECL|macro|AscGetChipLramDataNoSwap
mdefine_line|#define AscGetChipLramDataNoSwap( port )         ( ushort )inpw_noswap( (port)+IOP_RAM_DATA )
DECL|macro|AscSetChipLramDataNoSwap
mdefine_line|#define AscSetChipLramDataNoSwap( port, data )   outpw_noswap( (port)+IOP_RAM_DATA, data )
DECL|macro|AscGetChipIFC
mdefine_line|#define AscGetChipIFC( port )               ( uchar )inp( (port)+IOP_REG_IFC )
DECL|macro|AscSetChipIFC
mdefine_line|#define AscSetChipIFC( port, data )          outp( (port)+IOP_REG_IFC, data )
DECL|macro|AscGetChipStatus
mdefine_line|#define AscGetChipStatus( port )            ( ASC_CS_TYPE )inpw( (port)+IOP_STATUS )
DECL|macro|AscSetChipStatus
mdefine_line|#define AscSetChipStatus( port, cs_val )    outpw( (port)+IOP_STATUS, cs_val )
DECL|macro|AscGetChipControl
mdefine_line|#define AscGetChipControl( port )           ( uchar )inp( (port)+IOP_CTRL )
DECL|macro|AscSetChipControl
mdefine_line|#define AscSetChipControl( port, cc_val )   outp( (port)+IOP_CTRL, cc_val )
DECL|macro|AscGetChipSyn
mdefine_line|#define AscGetChipSyn( port )               ( uchar )inp( (port)+IOP_SYN_OFFSET )
DECL|macro|AscSetChipSyn
mdefine_line|#define AscSetChipSyn( port, data )         outp( (port)+IOP_SYN_OFFSET, data )
DECL|macro|AscSetPCAddr
mdefine_line|#define AscSetPCAddr( port, data )          outpw( (port)+IOP_REG_PC, data )
DECL|macro|AscGetPCAddr
mdefine_line|#define AscGetPCAddr( port )                ( ushort )inpw( (port)+IOP_REG_PC )
DECL|macro|AscIsIntPending
mdefine_line|#define AscIsIntPending( port )             ( AscGetChipStatus(port) &amp; ( CSW_INT_PENDING | CSW_SCSI_RESET_LATCH ) )
DECL|macro|AscGetChipScsiID
mdefine_line|#define AscGetChipScsiID( port )            ( ( AscGetChipCfgLsw(port) &gt;&gt; 8 ) &amp; ASC_MAX_TID )
DECL|macro|AscGetExtraControl
mdefine_line|#define AscGetExtraControl( port )          ( uchar )inp( (port)+IOP_EXTRA_CONTROL )
DECL|macro|AscSetExtraControl
mdefine_line|#define AscSetExtraControl( port, data )    outp( (port)+IOP_EXTRA_CONTROL, data )
DECL|macro|AscReadChipAX
mdefine_line|#define AscReadChipAX( port )               ( ushort )inpw( (port)+IOP_REG_AX )
DECL|macro|AscWriteChipAX
mdefine_line|#define AscWriteChipAX( port, data )        outpw( (port)+IOP_REG_AX, data )
DECL|macro|AscReadChipIX
mdefine_line|#define AscReadChipIX( port )               ( uchar )inp( (port)+IOP_REG_IX )
DECL|macro|AscWriteChipIX
mdefine_line|#define AscWriteChipIX( port, data )        outp( (port)+IOP_REG_IX, data )
DECL|macro|AscReadChipIH
mdefine_line|#define AscReadChipIH( port )               ( ushort )inpw( (port)+IOP_REG_IH )
DECL|macro|AscWriteChipIH
mdefine_line|#define AscWriteChipIH( port, data )        outpw( (port)+IOP_REG_IH, data )
DECL|macro|AscReadChipQP
mdefine_line|#define AscReadChipQP( port )               ( uchar )inp( (port)+IOP_REG_QP )
DECL|macro|AscWriteChipQP
mdefine_line|#define AscWriteChipQP( port, data )        outp( (port)+IOP_REG_QP, data )
DECL|macro|AscReadChipFIFO_L
mdefine_line|#define AscReadChipFIFO_L( port )           ( ushort )inpw( (port)+IOP_REG_FIFO_L )
DECL|macro|AscWriteChipFIFO_L
mdefine_line|#define AscWriteChipFIFO_L( port, data )    outpw( (port)+IOP_REG_FIFO_L, data )
DECL|macro|AscReadChipFIFO_H
mdefine_line|#define AscReadChipFIFO_H( port )           ( ushort )inpw( (port)+IOP_REG_FIFO_H )
DECL|macro|AscWriteChipFIFO_H
mdefine_line|#define AscWriteChipFIFO_H( port, data )    outpw( (port)+IOP_REG_FIFO_H, data )
DECL|macro|AscReadChipDmaSpeed
mdefine_line|#define AscReadChipDmaSpeed( port )         ( uchar )inp( (port)+IOP_DMA_SPEED )
DECL|macro|AscWriteChipDmaSpeed
mdefine_line|#define AscWriteChipDmaSpeed( port, data )  outp( (port)+IOP_DMA_SPEED, data )
DECL|macro|AscReadChipDA0
mdefine_line|#define AscReadChipDA0( port )              ( ushort )inpw( (port)+IOP_REG_DA0 )
DECL|macro|AscWriteChipDA0
mdefine_line|#define AscWriteChipDA0( port )             outpw( (port)+IOP_REG_DA0, data )
DECL|macro|AscReadChipDA1
mdefine_line|#define AscReadChipDA1( port )              ( ushort )inpw( (port)+IOP_REG_DA1 )
DECL|macro|AscWriteChipDA1
mdefine_line|#define AscWriteChipDA1( port )             outpw( (port)+IOP_REG_DA1, data )
DECL|macro|AscReadChipDC0
mdefine_line|#define AscReadChipDC0( port )              ( ushort )inpw( (port)+IOP_REG_DC0 )
DECL|macro|AscWriteChipDC0
mdefine_line|#define AscWriteChipDC0( port )             outpw( (port)+IOP_REG_DC0, data )
DECL|macro|AscReadChipDC1
mdefine_line|#define AscReadChipDC1( port )              ( ushort )inpw( (port)+IOP_REG_DC1 )
DECL|macro|AscWriteChipDC1
mdefine_line|#define AscWriteChipDC1( port )             outpw( (port)+IOP_REG_DC1, data )
DECL|macro|AscReadChipDvcID
mdefine_line|#define AscReadChipDvcID( port )            ( uchar )inp( (port)+IOP_REG_ID )
DECL|macro|AscWriteChipDvcID
mdefine_line|#define AscWriteChipDvcID( port, data )     outp( (port)+IOP_REG_ID, data )
r_int
id|AscWriteEEPCmdReg
c_func
(paren
id|PortAddr
id|iop_base
comma
id|uchar
id|cmd_reg
)paren
suffix:semicolon
r_int
id|AscWriteEEPDataReg
c_func
(paren
id|PortAddr
id|iop_base
comma
id|ushort
id|data_reg
)paren
suffix:semicolon
r_void
id|AscWaitEEPRead
c_func
(paren
r_void
)paren
suffix:semicolon
r_void
id|AscWaitEEPWrite
c_func
(paren
r_void
)paren
suffix:semicolon
id|ushort
id|AscReadEEPWord
c_func
(paren
id|PortAddr
comma
id|uchar
)paren
suffix:semicolon
id|ushort
id|AscWriteEEPWord
c_func
(paren
id|PortAddr
comma
id|uchar
comma
id|ushort
)paren
suffix:semicolon
id|ushort
id|AscGetEEPConfig
c_func
(paren
id|PortAddr
comma
id|ASCEEP_CONFIG
id|dosfar
op_star
comma
id|ushort
)paren
suffix:semicolon
r_int
id|AscSetEEPConfigOnce
c_func
(paren
id|PortAddr
comma
id|ASCEEP_CONFIG
id|dosfar
op_star
comma
id|ushort
)paren
suffix:semicolon
r_int
id|AscSetEEPConfig
c_func
(paren
id|PortAddr
comma
id|ASCEEP_CONFIG
id|dosfar
op_star
comma
id|ushort
)paren
suffix:semicolon
id|ushort
id|AscEEPSum
c_func
(paren
id|PortAddr
comma
id|uchar
comma
id|uchar
)paren
suffix:semicolon
r_int
id|AscStartChip
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
r_int
id|AscStopChip
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
r_void
id|AscSetChipIH
c_func
(paren
id|PortAddr
comma
id|ushort
)paren
suffix:semicolon
r_int
id|AscIsChipHalted
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
r_void
id|AscResetScsiBus
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
r_int
id|AscResetChip
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
r_void
id|AscSetChipCfgDword
c_func
(paren
id|PortAddr
comma
id|ulong
)paren
suffix:semicolon
id|ulong
id|AscGetChipCfgDword
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
r_void
id|AscAckInterrupt
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
r_void
id|AscDisableInterrupt
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
r_void
id|AscEnableInterrupt
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
r_void
id|AscSetBank
c_func
(paren
id|PortAddr
comma
id|uchar
)paren
suffix:semicolon
id|uchar
id|AscGetBank
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
r_int
id|AscResetChipAndScsiBus
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
id|ushort
id|AscGetIsaDmaChannel
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
id|ushort
id|AscSetIsaDmaChannel
c_func
(paren
id|PortAddr
comma
id|ushort
)paren
suffix:semicolon
id|uchar
id|AscSetIsaDmaSpeed
c_func
(paren
id|PortAddr
comma
id|uchar
)paren
suffix:semicolon
id|uchar
id|AscGetIsaDmaSpeed
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
id|uchar
id|AscReadLramByte
c_func
(paren
id|PortAddr
comma
id|ushort
)paren
suffix:semicolon
id|ushort
id|AscReadLramWord
c_func
(paren
id|PortAddr
comma
id|ushort
)paren
suffix:semicolon
id|ulong
id|AscReadLramDWord
c_func
(paren
id|PortAddr
comma
id|ushort
)paren
suffix:semicolon
r_void
id|AscWriteLramWord
c_func
(paren
id|PortAddr
comma
id|ushort
comma
id|ushort
)paren
suffix:semicolon
r_void
id|AscWriteLramDWord
c_func
(paren
id|PortAddr
comma
id|ushort
comma
id|ulong
)paren
suffix:semicolon
r_void
id|AscWriteLramByte
c_func
(paren
id|PortAddr
comma
id|ushort
comma
id|uchar
)paren
suffix:semicolon
r_int
id|AscVerWriteLramDWord
c_func
(paren
id|PortAddr
comma
id|ushort
comma
id|ulong
)paren
suffix:semicolon
r_int
id|AscVerWriteLramWord
c_func
(paren
id|PortAddr
comma
id|ushort
comma
id|ushort
)paren
suffix:semicolon
r_int
id|AscVerWriteLramByte
c_func
(paren
id|PortAddr
comma
id|ushort
comma
id|uchar
)paren
suffix:semicolon
id|ulong
id|AscMemSumLramWord
c_func
(paren
id|PortAddr
comma
id|ushort
comma
id|rint
)paren
suffix:semicolon
r_void
id|AscMemWordSetLram
c_func
(paren
id|PortAddr
comma
id|ushort
comma
id|ushort
comma
id|rint
)paren
suffix:semicolon
r_void
id|AscMemWordCopyToLram
c_func
(paren
id|PortAddr
comma
id|ushort
comma
id|ushort
id|dosfar
op_star
comma
r_int
)paren
suffix:semicolon
r_void
id|AscMemDWordCopyToLram
c_func
(paren
id|PortAddr
comma
id|ushort
comma
id|ulong
id|dosfar
op_star
comma
r_int
)paren
suffix:semicolon
r_void
id|AscMemWordCopyFromLram
c_func
(paren
id|PortAddr
comma
id|ushort
comma
id|ushort
id|dosfar
op_star
comma
r_int
)paren
suffix:semicolon
r_int
id|AscMemWordCmpToLram
c_func
(paren
id|PortAddr
comma
id|ushort
comma
id|ushort
id|dosfar
op_star
comma
r_int
)paren
suffix:semicolon
id|ushort
id|AscInitAscDvcVar
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
)paren
suffix:semicolon
id|ushort
id|AscInitFromEEP
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
)paren
suffix:semicolon
id|ushort
id|AscInitWithoutEEP
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
)paren
suffix:semicolon
id|ushort
id|AscInitFromAscDvcVar
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
)paren
suffix:semicolon
id|ushort
id|AscInitMicroCodeVar
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
)paren
suffix:semicolon
r_void
id|dosfar
id|AscInitPollIsrCallBack
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ASC_QDONE_INFO
id|dosfar
op_star
)paren
suffix:semicolon
r_int
id|AscTestExternalLram
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
)paren
suffix:semicolon
id|ushort
id|AscTestLramEndian
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
id|uchar
id|AscMsgOutSDTR
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|uchar
comma
id|uchar
)paren
suffix:semicolon
id|uchar
id|AscCalSDTRData
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|uchar
comma
id|uchar
)paren
suffix:semicolon
r_void
id|AscSetChipSDTR
c_func
(paren
id|PortAddr
comma
id|uchar
comma
id|uchar
)paren
suffix:semicolon
r_int
id|AscInitChipAllSynReg
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|uchar
)paren
suffix:semicolon
id|uchar
id|AscGetSynPeriodIndex
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ruchar
)paren
suffix:semicolon
id|uchar
id|AscAllocFreeQueue
c_func
(paren
id|PortAddr
comma
id|uchar
)paren
suffix:semicolon
id|uchar
id|AscAllocMultipleFreeQueue
c_func
(paren
id|PortAddr
comma
id|uchar
comma
id|uchar
)paren
suffix:semicolon
r_int
id|AscRiscHaltedAbortSRB
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ulong
)paren
suffix:semicolon
r_int
id|AscRiscHaltedAbortTIX
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|uchar
)paren
suffix:semicolon
r_int
id|AscRiscHaltedAbortALL
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
)paren
suffix:semicolon
r_int
id|AscHostReqRiscHalt
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
r_int
id|AscStopQueueExe
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
r_int
id|AscStartQueueExe
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
r_int
id|AscCleanUpDiscQueue
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
r_int
id|AscCleanUpBusyQueue
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
r_int
id|_AscAbortTidBusyQueue
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ASC_QDONE_INFO
id|dosfar
op_star
comma
id|uchar
)paren
suffix:semicolon
r_int
id|_AscAbortSrbBusyQueue
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ASC_QDONE_INFO
id|dosfar
op_star
comma
id|ulong
)paren
suffix:semicolon
r_int
id|AscWaitTixISRDone
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|uchar
)paren
suffix:semicolon
r_int
id|AscWaitISRDone
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
)paren
suffix:semicolon
id|ulong
id|AscGetOnePhyAddr
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|uchar
id|dosfar
op_star
comma
id|ulong
)paren
suffix:semicolon
r_int
id|AscSendScsiQueue
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|ASC_SCSI_Q
id|dosfar
op_star
id|scsiq
comma
id|uchar
id|n_q_required
)paren
suffix:semicolon
r_int
id|AscPutReadyQueue
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ASC_SCSI_Q
id|dosfar
op_star
comma
id|uchar
)paren
suffix:semicolon
r_int
id|AscPutReadySgListQueue
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ASC_SCSI_Q
id|dosfar
op_star
comma
id|uchar
)paren
suffix:semicolon
r_int
id|AscAbortScsiIO
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
suffix:semicolon
r_void
id|AscExeScsiIO
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
suffix:semicolon
r_int
id|AscSetChipSynRegAtID
c_func
(paren
id|PortAddr
comma
id|uchar
comma
id|uchar
)paren
suffix:semicolon
r_int
id|AscSetRunChipSynRegAtID
c_func
(paren
id|PortAddr
comma
id|uchar
comma
id|uchar
)paren
suffix:semicolon
id|ushort
id|AscInitLram
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
)paren
suffix:semicolon
r_int
id|AscReInitLram
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
)paren
suffix:semicolon
id|ushort
id|AscInitQLinkVar
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
)paren
suffix:semicolon
r_int
id|AscSetLibErrorCode
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ushort
)paren
suffix:semicolon
r_int
id|_AscWaitQDone
c_func
(paren
id|PortAddr
comma
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
suffix:semicolon
r_int
id|AscEnterCritical
c_func
(paren
r_void
)paren
suffix:semicolon
r_void
id|AscLeaveCritical
c_func
(paren
r_int
)paren
suffix:semicolon
r_int
id|AscIsrChipHalted
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
)paren
suffix:semicolon
id|uchar
id|_AscCopyLramScsiDoneQ
c_func
(paren
id|PortAddr
comma
id|ushort
comma
id|ASC_QDONE_INFO
id|dosfar
op_star
comma
id|ulong
)paren
suffix:semicolon
r_int
id|AscIsrQDone
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
)paren
suffix:semicolon
id|ushort
id|AscIsrExeBusyQueue
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|uchar
)paren
suffix:semicolon
r_int
id|AscScsiSetupCmdQ
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
comma
id|uchar
id|dosfar
op_star
comma
id|ulong
)paren
suffix:semicolon
r_int
id|AscScsiInquiry
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
comma
id|uchar
id|dosfar
op_star
comma
r_int
)paren
suffix:semicolon
r_int
id|AscScsiTestUnitReady
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
)paren
suffix:semicolon
r_int
id|AscScsiStartStopUnit
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
comma
id|uchar
)paren
suffix:semicolon
r_int
id|AscScsiReadCapacity
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
comma
id|uchar
id|dosfar
op_star
)paren
suffix:semicolon
id|ulong
id|dosfar
op_star
id|swapfarbuf4
c_func
(paren
id|uchar
id|dosfar
op_star
)paren
suffix:semicolon
r_int
id|PollQueueDone
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
comma
r_int
)paren
suffix:semicolon
r_int
id|PollScsiReadCapacity
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
comma
id|ASC_CAP_INFO
id|dosfar
op_star
)paren
suffix:semicolon
r_int
id|PollScsiInquiry
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
comma
id|uchar
id|dosfar
op_star
comma
r_int
)paren
suffix:semicolon
r_int
id|PollScsiTestUnitReady
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
)paren
suffix:semicolon
r_int
id|PollScsiStartUnit
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
)paren
suffix:semicolon
r_int
id|InitTestUnitReady
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
)paren
suffix:semicolon
r_void
id|AscDispInquiry
c_func
(paren
id|uchar
comma
id|uchar
comma
id|ASC_SCSI_INQUIRY
id|dosfar
op_star
)paren
suffix:semicolon
r_int
id|AscPollQDone
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
comma
r_int
)paren
suffix:semicolon
r_int
id|AscCompareString
c_func
(paren
id|uchar
op_star
comma
id|uchar
op_star
comma
r_int
)paren
suffix:semicolon
r_int
id|AscSetBIOSBank
c_func
(paren
id|PortAddr
comma
r_int
comma
id|ushort
)paren
suffix:semicolon
r_int
id|AscSetVlBIOSBank
c_func
(paren
id|PortAddr
comma
r_int
)paren
suffix:semicolon
r_int
id|AscSetEisaBIOSBank
c_func
(paren
id|PortAddr
comma
r_int
)paren
suffix:semicolon
r_int
id|AscSetIsaBIOSBank
c_func
(paren
id|PortAddr
comma
r_int
)paren
suffix:semicolon
id|ushort
id|AscGetEisaChipCfg
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
id|ushort
id|AscGetEisaChipGpReg
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
id|ushort
id|AscSetEisaChipCfg
c_func
(paren
id|PortAddr
comma
id|ushort
)paren
suffix:semicolon
id|ushort
id|AscSetEisaChipGpReg
c_func
(paren
id|PortAddr
comma
id|ushort
)paren
suffix:semicolon
id|ulong
id|AscGetEisaProductID
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
id|PortAddr
id|AscSearchIOPortAddrEISA
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
r_void
id|AscClrResetScsiBus
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
id|uchar
id|AscGetChipScsiCtrl
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
id|uchar
id|AscSetChipScsiID
c_func
(paren
id|PortAddr
comma
id|uchar
)paren
suffix:semicolon
id|uchar
id|AscGetChipVersion
c_func
(paren
id|PortAddr
comma
id|ushort
)paren
suffix:semicolon
id|ushort
id|AscGetChipBusType
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
id|ulong
id|AscLoadMicroCode
c_func
(paren
id|PortAddr
comma
id|ushort
comma
id|ushort
id|dosfar
op_star
comma
id|ushort
)paren
suffix:semicolon
r_int
id|AscFindSignature
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
id|PortAddr
id|AscSearchIOPortAddr11
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
id|PortAddr
id|AscSearchIOPortAddr100
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
r_void
id|AscToggleIRQAct
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
r_void
id|AscClrResetChip
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
r_int
id|itos
c_func
(paren
id|ushort
comma
id|uchar
id|dosfar
op_star
comma
r_int
comma
r_int
)paren
suffix:semicolon
r_int
id|insnchar
c_func
(paren
id|uchar
id|dosfar
op_star
comma
r_int
comma
r_int
comma
id|ruchar
comma
r_int
)paren
suffix:semicolon
r_void
id|itoh
c_func
(paren
id|ushort
comma
id|ruchar
id|dosfar
op_star
)paren
suffix:semicolon
r_void
id|btoh
c_func
(paren
id|uchar
comma
id|ruchar
id|dosfar
op_star
)paren
suffix:semicolon
r_void
id|ltoh
c_func
(paren
id|ulong
comma
id|ruchar
id|dosfar
op_star
)paren
suffix:semicolon
id|uchar
id|dosfar
op_star
id|todstr
c_func
(paren
id|ushort
comma
id|uchar
id|dosfar
op_star
)paren
suffix:semicolon
id|uchar
id|dosfar
op_star
id|tohstr
c_func
(paren
id|ushort
comma
id|uchar
id|dosfar
op_star
)paren
suffix:semicolon
id|uchar
id|dosfar
op_star
id|tobhstr
c_func
(paren
id|uchar
comma
id|uchar
id|dosfar
op_star
)paren
suffix:semicolon
id|uchar
id|dosfar
op_star
id|tolhstr
c_func
(paren
id|ulong
comma
id|uchar
id|dosfar
op_star
)paren
suffix:semicolon
r_void
id|AscSetISAPNPWaitForKey
c_func
(paren
r_void
)paren
suffix:semicolon
id|uchar
id|AscGetChipIRQ
c_func
(paren
id|PortAddr
comma
id|ushort
)paren
suffix:semicolon
id|uchar
id|AscSetChipIRQ
c_func
(paren
id|PortAddr
comma
id|uchar
comma
id|ushort
)paren
suffix:semicolon
r_int
id|AscIsBiosEnabled
c_func
(paren
id|PortAddr
comma
id|ushort
)paren
suffix:semicolon
r_int
id|AscEnableBios
c_func
(paren
id|PortAddr
comma
id|ushort
)paren
suffix:semicolon
id|ushort
id|AscGetChipBiosAddress
c_func
(paren
id|PortAddr
comma
id|ushort
)paren
suffix:semicolon
id|ushort
id|AscSetChipBiosAddress
c_func
(paren
id|PortAddr
comma
id|ushort
comma
id|ushort
)paren
suffix:semicolon
r_void
id|AscSingleStepChip
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
r_int
id|AscPollQTailSync
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
r_int
id|AscPollQHeadSync
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
r_int
id|AscWaitQTailSync
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
r_int
id|_AscRestoreMicroCode
c_func
(paren
id|PortAddr
comma
id|ASC_MC_SAVED
id|dosfar
op_star
)paren
suffix:semicolon
r_int
id|AscSCAM
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
)paren
suffix:semicolon
id|ushort
id|SwapByteOfWord
c_func
(paren
id|ushort
id|word_val
)paren
suffix:semicolon
id|ulong
id|SwapWordOfDWord
c_func
(paren
id|ulong
id|dword_val
)paren
suffix:semicolon
id|ulong
id|AdjEndianDword
c_func
(paren
id|ulong
id|dword_val
)paren
suffix:semicolon
r_int
id|AscAdjEndianScsiQ
c_func
(paren
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
suffix:semicolon
r_int
id|AscAdjEndianQDoneInfo
c_func
(paren
id|ASC_QDONE_INFO
id|dosfar
op_star
)paren
suffix:semicolon
r_int
id|AscCoalesceSgList
c_func
(paren
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
suffix:semicolon
r_extern
r_int
id|DvcEnterCritical
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_void
id|DvcLeaveCritical
c_func
(paren
r_int
)paren
suffix:semicolon
r_extern
r_void
id|DvcSetMemory
c_func
(paren
id|uchar
id|dosfar
op_star
comma
id|uint
comma
id|uchar
)paren
suffix:semicolon
r_extern
r_void
id|DvcCopyMemory
c_func
(paren
id|uchar
id|dosfar
op_star
comma
id|uchar
id|dosfar
op_star
comma
id|uint
)paren
suffix:semicolon
r_extern
r_void
id|DvcInPortWords
c_func
(paren
id|PortAddr
comma
id|ushort
id|dosfar
op_star
comma
r_int
)paren
suffix:semicolon
r_extern
r_void
id|DvcOutPortWords
c_func
(paren
id|PortAddr
comma
id|ushort
id|dosfar
op_star
comma
r_int
)paren
suffix:semicolon
r_extern
r_void
id|DvcOutPortDWords
c_func
(paren
id|PortAddr
comma
id|ulong
id|dosfar
op_star
comma
r_int
)paren
suffix:semicolon
r_extern
id|uchar
id|DvcReadPCIConfigByte
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ushort
)paren
suffix:semicolon
r_extern
r_void
id|DvcWritePCIConfigByte
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ushort
comma
id|uchar
)paren
suffix:semicolon
id|ushort
id|AscGetChipBiosAddress
c_func
(paren
id|PortAddr
comma
id|ushort
)paren
suffix:semicolon
r_extern
r_void
id|DvcSleepMilliSecond
c_func
(paren
id|ulong
)paren
suffix:semicolon
r_extern
r_void
id|DvcDelayNanoSecond
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ulong
)paren
suffix:semicolon
r_extern
r_void
id|DvcDisplayString
c_func
(paren
id|uchar
id|dosfar
op_star
)paren
suffix:semicolon
r_extern
id|ulong
id|DvcGetPhyAddr
c_func
(paren
id|uchar
id|dosfar
op_star
id|buf_addr
comma
id|ulong
id|buf_len
)paren
suffix:semicolon
r_extern
id|ulong
id|DvcGetSGList
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|uchar
id|dosfar
op_star
comma
id|ulong
comma
id|ASC_SG_HEAD
id|dosfar
op_star
)paren
suffix:semicolon
r_extern
r_void
id|DvcSCAMDelayMS
c_func
(paren
id|ulong
)paren
suffix:semicolon
r_extern
r_int
id|DvcDisableCPUInterrupt
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_void
id|DvcRestoreCPUInterrupt
c_func
(paren
r_int
)paren
suffix:semicolon
r_void
id|DvcPutScsiQ
c_func
(paren
id|PortAddr
comma
id|ushort
comma
id|ushort
id|dosfar
op_star
comma
r_int
)paren
suffix:semicolon
r_void
id|DvcGetQinfo
c_func
(paren
id|PortAddr
comma
id|ushort
comma
id|ushort
id|dosfar
op_star
comma
r_int
)paren
suffix:semicolon
id|PortAddr
id|AscSearchIOPortAddr
c_func
(paren
id|PortAddr
comma
id|ushort
)paren
suffix:semicolon
id|ushort
id|AscInitGetConfig
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
)paren
suffix:semicolon
id|ushort
id|AscInitSetConfig
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
)paren
suffix:semicolon
id|ushort
id|AscInitAsc1000Driver
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
)paren
suffix:semicolon
r_int
id|AscInitScsiTarget
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ASC_DVC_INQ_INFO
id|dosfar
op_star
comma
id|uchar
id|dosfar
op_star
comma
id|ASC_CAP_INFO_ARRAY
id|dosfar
op_star
comma
id|ushort
)paren
suffix:semicolon
r_int
id|AscInitPollBegin
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
)paren
suffix:semicolon
r_int
id|AscInitPollEnd
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
)paren
suffix:semicolon
r_int
id|AscInitPollTarget
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
comma
id|ASC_SCSI_INQUIRY
id|dosfar
op_star
comma
id|ASC_CAP_INFO
id|dosfar
op_star
)paren
suffix:semicolon
r_int
id|AscExeScsiQueue
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
suffix:semicolon
r_int
id|AscISR
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
)paren
suffix:semicolon
r_void
id|AscISR_AckInterrupt
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
)paren
suffix:semicolon
r_int
id|AscISR_CheckQDone
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ASC_QDONE_INFO
id|dosfar
op_star
comma
id|uchar
id|dosfar
op_star
)paren
suffix:semicolon
r_int
id|AscStartUnit
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ASC_SCSI_TIX_TYPE
)paren
suffix:semicolon
r_int
id|AscStopUnit
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|ASC_SCSI_TIX_TYPE
id|target_ix
)paren
suffix:semicolon
id|uint
id|AscGetNumOfFreeQueue
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|uchar
comma
id|uchar
)paren
suffix:semicolon
r_int
id|AscSgListToQueue
c_func
(paren
r_int
)paren
suffix:semicolon
r_int
id|AscQueueToSgList
c_func
(paren
r_int
)paren
suffix:semicolon
r_int
id|AscSetDvcErrorCode
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|uchar
)paren
suffix:semicolon
r_int
id|AscAbortSRB
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ulong
)paren
suffix:semicolon
r_int
id|AscResetDevice
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|uchar
)paren
suffix:semicolon
r_int
id|AscResetSB
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
)paren
suffix:semicolon
r_void
id|AscEnableIsaDma
c_func
(paren
id|uchar
)paren
suffix:semicolon
r_void
id|AscDisableIsaDma
c_func
(paren
id|uchar
)paren
suffix:semicolon
id|ulong
id|AscGetMaxDmaAddress
c_func
(paren
id|ushort
)paren
suffix:semicolon
id|ulong
id|AscGetMaxDmaCount
c_func
(paren
id|ushort
)paren
suffix:semicolon
r_int
id|AscSaveMicroCode
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ASC_MC_SAVED
id|dosfar
op_star
)paren
suffix:semicolon
r_int
id|AscRestoreOldMicroCode
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ASC_MC_SAVED
id|dosfar
op_star
)paren
suffix:semicolon
r_int
id|AscRestoreNewMicroCode
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
comma
id|ASC_MC_SAVED
id|dosfar
op_star
)paren
suffix:semicolon
multiline_comment|/*&n; * --- Debugging Header&n; */
macro_line|#ifdef ADVANSYS_DEBUG
DECL|macro|STATIC
mdefine_line|#define STATIC
macro_line|#else /* ADVANSYS_DEBUG */
DECL|macro|STATIC
mdefine_line|#define STATIC static
macro_line|#endif /* ADVANSYS_DEBUG */
multiline_comment|/*&n; * --- Driver Constants and Macros&n; */
DECL|macro|ASC_NUM_BOARD_SUPPORTED
mdefine_line|#define ASC_NUM_BOARD_SUPPORTED 4
DECL|macro|ASC_NUM_BUS
mdefine_line|#define ASC_NUM_BUS&t;&t;&t;&t;4
multiline_comment|/* Reference Scsi_Host hostdata */
DECL|macro|ASC_BOARDP
mdefine_line|#define ASC_BOARDP(host) ((struct asc_board *) &amp;((host)-&gt;hostdata))
DECL|macro|NO_ISA_DMA
mdefine_line|#define NO_ISA_DMA&t;&t;&t;&t;0xff&t;&t;/* No ISA DMA Channel Used */
DECL|macro|ASC_INFO_SIZE
mdefine_line|#define ASC_INFO_SIZE&t;&t;&t;128&t;&t;&t;/* advansys_info() line size */
multiline_comment|/* /proc/scsi/advansys/[0...] related definitions */
DECL|macro|ASC_PRTBUF_SIZE
mdefine_line|#define ASC_PRTBUF_SIZE&t;&t;&t;1024
DECL|macro|ASC_PRTLINE_SIZE
mdefine_line|#define ASC_PRTLINE_SIZE&t;&t;160
DECL|macro|ASC_PRT_NEXT
mdefine_line|#define ASC_PRT_NEXT() &bslash;&n;&t;if (cp) { &bslash;&n;&t;&t;totlen += len; &bslash;&n;&t;&t;leftlen -= len; &bslash;&n;&t;&t;if (leftlen == 0) { &bslash;&n;&t;&t;&t;return totlen; &bslash;&n;&t;&t;} &bslash;&n;&t;&t;cp += len; &bslash;&n;&t;}
DECL|macro|ASC_MIN
mdefine_line|#define ASC_MIN(a, b) (((a) &lt; (b)) ? (a) : (b))
multiline_comment|/* Asc Library return codes */
DECL|macro|ASC_TRUE
mdefine_line|#define ASC_TRUE&t;&t;1
DECL|macro|ASC_FALSE
mdefine_line|#define ASC_FALSE&t;&t;0
DECL|macro|ASC_NOERROR
mdefine_line|#define ASC_NOERROR&t;&t;1
DECL|macro|ASC_BUSY
mdefine_line|#define ASC_BUSY&t;&t;0
DECL|macro|ASC_ERROR
mdefine_line|#define ASC_ERROR&t;&t;(-1)
multiline_comment|/* Scsi_Cmnd function return codes */
DECL|macro|STATUS_BYTE
mdefine_line|#define STATUS_BYTE(byte)&t;(byte)
DECL|macro|MSG_BYTE
mdefine_line|#define MSG_BYTE(byte)&t;&t;((byte) &lt;&lt; 8)
DECL|macro|HOST_BYTE
mdefine_line|#define HOST_BYTE(byte)&t;&t;((byte) &lt;&lt; 16)
DECL|macro|DRIVER_BYTE
mdefine_line|#define DRIVER_BYTE(byte)&t;((byte) &lt;&lt; 24)
multiline_comment|/*&n; * REQ and REQP are the generic name for a SCSI request block and pointer.&n; * REQPTID(reqp) returns reqp&squot;s target id.&n; * REQPNEXT(reqp) returns reqp&squot;s next pointer.&n; * REQPNEXTP(reqp) returns a pointer to reqp&squot;s next pointer.&n; */
DECL|typedef|REQ
DECL|typedef|REQP
r_typedef
id|Scsi_Cmnd
id|REQ
comma
op_star
id|REQP
suffix:semicolon
DECL|macro|REQPNEXT
mdefine_line|#define REQPNEXT(reqp)&t;&t;((REQP) ((reqp)-&gt;host_scribble))
DECL|macro|REQPNEXTP
mdefine_line|#define REQPNEXTP(reqp)&t;&t;((REQP *) &amp;((reqp)-&gt;host_scribble))
DECL|macro|REQPTID
mdefine_line|#define REQPTID(reqp)&t;&t;((reqp)-&gt;target)
multiline_comment|/* asc_enqueue() flags */
DECL|macro|ASC_FRONT
mdefine_line|#define ASC_FRONT&t;&t;1
DECL|macro|ASC_BACK
mdefine_line|#define ASC_BACK&t;&t;2
multiline_comment|/* PCI configuration declarations */
DECL|macro|PCI_BASE_CLASS_PREDEFINED
mdefine_line|#define PCI_BASE_CLASS_PREDEFINED&t;&t;&t;0x00
DECL|macro|PCI_BASE_CLASS_MASS_STORAGE
mdefine_line|#define PCI_BASE_CLASS_MASS_STORAGE&t;&t;&t;0x01
DECL|macro|PCI_BASE_CLASS_NETWORK
mdefine_line|#define PCI_BASE_CLASS_NETWORK&t;&t;&t;&t;0x02
DECL|macro|PCI_BASE_CLASS_DISPLAY
mdefine_line|#define PCI_BASE_CLASS_DISPLAY&t;&t;&t;&t;0x03
DECL|macro|PCI_BASE_CLASS_MULTIMEDIA
mdefine_line|#define PCI_BASE_CLASS_MULTIMEDIA&t;&t;&t;0x04
DECL|macro|PCI_BASE_CLASS_MEMORY_CONTROLLER
mdefine_line|#define PCI_BASE_CLASS_MEMORY_CONTROLLER&t;0x05
DECL|macro|PCI_BASE_CLASS_BRIDGE_DEVICE
mdefine_line|#define PCI_BASE_CLASS_BRIDGE_DEVICE&t;&t;0x06
multiline_comment|/* MASS STORAGE */
DECL|macro|PCI_SUB_CLASS_SCSI_CONTROLLER
mdefine_line|#define PCI_SUB_CLASS_SCSI_CONTROLLER&t;&t;&t;0x00
DECL|macro|PCI_SUB_CLASS_IDE_CONTROLLER
mdefine_line|#define PCI_SUB_CLASS_IDE_CONTROLLER&t;&t;&t;0x01
DECL|macro|PCI_SUB_CLASS_FLOPPY_DISK_CONTROLLER
mdefine_line|#define PCI_SUB_CLASS_FLOPPY_DISK_CONTROLLER&t;0x02
DECL|macro|PCI_SUB_CLASS_IPI_BUS_CONTROLLER
mdefine_line|#define PCI_SUB_CLASS_IPI_BUS_CONTROLLER&t;&t;0x03
DECL|macro|PCI_SUB_CLASS_OTHER_MASS_CONTROLLER
mdefine_line|#define PCI_SUB_CLASS_OTHER_MASS_CONTROLLER&t;&t;0x80
multiline_comment|/* NETWORK CONTROLLER */
DECL|macro|PCI_SUB_CLASS_ETHERNET_CONTROLLER
mdefine_line|#define PCI_SUB_CLASS_ETHERNET_CONTROLLER&t;&t;0x00
DECL|macro|PCI_SUB_CLASS_TOKEN_RING_CONTROLLER
mdefine_line|#define PCI_SUB_CLASS_TOKEN_RING_CONTROLLER&t;&t;0x01
DECL|macro|PCI_SUB_CLASS_FDDI_CONTROLLER
mdefine_line|#define PCI_SUB_CLASS_FDDI_CONTROLLER&t;&t;&t;0x02
DECL|macro|PCI_SUB_CLASS_OTHER_NETWORK_CONTROLLER
mdefine_line|#define PCI_SUB_CLASS_OTHER_NETWORK_CONTROLLER&t;0x80
multiline_comment|/* DISPLAY CONTROLLER */
DECL|macro|PCI_SUB_CLASS_VGA_CONTROLLER
mdefine_line|#define PCI_SUB_CLASS_VGA_CONTROLLER&t;&t;&t;0x00
DECL|macro|PCI_SUB_CLASS_XGA_CONTROLLER
mdefine_line|#define PCI_SUB_CLASS_XGA_CONTROLLER&t;&t;&t;0x01
DECL|macro|PCI_SUB_CLASS_OTHER_DISPLAY_CONTROLLER
mdefine_line|#define PCI_SUB_CLASS_OTHER_DISPLAY_CONTROLLER&t;0x80
multiline_comment|/* MULTIMEDIA CONTROLLER */
DECL|macro|PCI_SUB_CLASS_VIDEO_DEVICE
mdefine_line|#define PCI_SUB_CLASS_VIDEO_DEVICE&t;&t;&t;&t;0x00
DECL|macro|PCI_SUB_CLASS_AUDIO_DEVICE
mdefine_line|#define PCI_SUB_CLASS_AUDIO_DEVICE&t;&t;&t;&t;0x01
DECL|macro|PCI_SUB_CLASS_OTHER_MULTIMEDIA_DEVICE
mdefine_line|#define PCI_SUB_CLASS_OTHER_MULTIMEDIA_DEVICE&t;0x80
multiline_comment|/* MEMORY CONTROLLER */
DECL|macro|PCI_SUB_CLASS_RAM_CONTROLLER
mdefine_line|#define PCI_SUB_CLASS_RAM_CONTROLLER&t;&t;&t;0x00
DECL|macro|PCI_SUB_CLASS_FLASH_CONTROLLER
mdefine_line|#define PCI_SUB_CLASS_FLASH_CONTROLLER&t;&t;&t;0x01
DECL|macro|PCI_SUB_CLASS_OTHER_MEMORY_CONTROLLER
mdefine_line|#define PCI_SUB_CLASS_OTHER_MEMORY_CONTROLLER&t;0x80
multiline_comment|/* BRIDGE CONTROLLER */
DECL|macro|PCI_SUB_CLASS_HOST_BRIDGE_CONTROLLER
mdefine_line|#define PCI_SUB_CLASS_HOST_BRIDGE_CONTROLLER&t;&t;0x00
DECL|macro|PCI_SUB_CLASS_ISA_BRIDGE_CONTROLLER
mdefine_line|#define PCI_SUB_CLASS_ISA_BRIDGE_CONTROLLER&t;&t;&t;0x01
DECL|macro|PCI_SUB_CLASS_EISA_BRIDGE_CONTROLLER
mdefine_line|#define PCI_SUB_CLASS_EISA_BRIDGE_CONTROLLER&t;&t;0x02
DECL|macro|PCI_SUB_CLASS_MC_BRIDGE_CONTROLLER
mdefine_line|#define PCI_SUB_CLASS_MC_BRIDGE_CONTROLLER&t;&t;&t;0x03
DECL|macro|PCI_SUB_CLASS_PCI_TO_PCI_BRIDGE_CONTROLLER
mdefine_line|#define PCI_SUB_CLASS_PCI_TO_PCI_BRIDGE_CONTROLLER&t;0x04
DECL|macro|PCI_SUB_CLASS_PCMCIA_BRIDGE_CONTROLLER
mdefine_line|#define PCI_SUB_CLASS_PCMCIA_BRIDGE_CONTROLLER&t;&t;0x05
DECL|macro|PCI_SUB_CLASS_OTHER_BRIDGE_CONTROLLER
mdefine_line|#define PCI_SUB_CLASS_OTHER_BRIDGE_CONTROLLER&t;&t;0x80
DECL|macro|PCI_MAX_SLOT
mdefine_line|#define PCI_MAX_SLOT&t;&t;&t;0x1F
DECL|macro|PCI_MAX_BUS
mdefine_line|#define PCI_MAX_BUS&t;&t;&t;&t;0xFF
DECL|macro|PCI_IOADDRESS_MASK
mdefine_line|#define PCI_IOADDRESS_MASK&t;&t;0xFFFE
DECL|macro|ASC_PCI_VENDORID
mdefine_line|#define ASC_PCI_VENDORID&t;&t;0x10CD
DECL|macro|ASC_PCI_DEVICE_ID_1100
mdefine_line|#define ASC_PCI_DEVICE_ID_1100&t;0x1100
DECL|macro|ASC_PCI_DEVICE_ID_1200
mdefine_line|#define ASC_PCI_DEVICE_ID_1200&t;0x1200
DECL|macro|ASC_PCI_DEVICE_ID_1300
mdefine_line|#define ASC_PCI_DEVICE_ID_1300&t;0x1300
multiline_comment|/* PCI IO Port Addresses to generate special cycle */
DECL|macro|PCI_CONFIG_ADDRESS_MECH1
mdefine_line|#define PCI_CONFIG_ADDRESS_MECH1&t;&t;0x0CF8
DECL|macro|PCI_CONFIG_DATA_MECH1
mdefine_line|#define PCI_CONFIG_DATA_MECH1&t;&t;&t;0x0CFC
DECL|macro|PCI_CONFIG_FORWARD_REGISTER
mdefine_line|#define PCI_CONFIG_FORWARD_REGISTER&t;&t;0x0CFA&t;/* 0=type 0; 1=type 1; */
DECL|macro|PCI_CONFIG_BUS_NUMBER_MASK
mdefine_line|#define PCI_CONFIG_BUS_NUMBER_MASK&t;&t;0x00FF0000
DECL|macro|PCI_CONFIG_DEVICE_FUNCTION_MASK
mdefine_line|#define PCI_CONFIG_DEVICE_FUNCTION_MASK&t;0x0000FF00
DECL|macro|PCI_CONFIG_REGISTER_NUMBER_MASK
mdefine_line|#define PCI_CONFIG_REGISTER_NUMBER_MASK&t;0x000000F8
DECL|macro|PCI_DEVICE_FOUND
mdefine_line|#define PCI_DEVICE_FOUND&t;&t;&t;&t;0x0000
DECL|macro|PCI_DEVICE_NOT_FOUND
mdefine_line|#define PCI_DEVICE_NOT_FOUND&t;&t;&t;0xffff
DECL|macro|SUBCLASS_OFFSET
mdefine_line|#define SUBCLASS_OFFSET &t;0x0A
DECL|macro|CLASSCODE_OFFSET
mdefine_line|#define CLASSCODE_OFFSET&t;0x0B
DECL|macro|VENDORID_OFFSET
mdefine_line|#define VENDORID_OFFSET&t;&t;0x00
DECL|macro|DEVICEID_OFFSET
mdefine_line|#define DEVICEID_OFFSET&t;&t;0x02
macro_line|#ifndef ADVANSYS_STATS
DECL|macro|ASC_STATS
mdefine_line|#define ASC_STATS(shp, counter)
DECL|macro|ASC_STATS_ADD
mdefine_line|#define ASC_STATS_ADD(shp, counter, count)
macro_line|#else /* ADVANSYS_STATS */
DECL|macro|ASC_STATS
mdefine_line|#define ASC_STATS(shp, counter) &bslash;&n;&t;(ASC_BOARDP(shp)-&gt;asc_stats.counter++)
DECL|macro|ASC_STATS_ADD
mdefine_line|#define ASC_STATS_ADD(shp, counter, count) &bslash;&n;&t;(ASC_BOARDP(shp)-&gt;asc_stats.counter += (count))
macro_line|#endif /* ADVANSYS_STATS */
DECL|macro|ASC_CEILING
mdefine_line|#define ASC_CEILING(val, unit) (((val) + ((unit) - 1))/(unit))
DECL|macro|ASC_TENTHS
mdefine_line|#define ASC_TENTHS(num, den) ((((num) * 10)/(den)) - (10 * ((num)/(den))))
multiline_comment|/*&n; * Display a message to the console.&n; */
DECL|macro|ASC_PRINT
mdefine_line|#define ASC_PRINT(s) &bslash;&n;&t;{ &bslash;&n;&t;&t;printk(&quot;advansys: &quot;); &bslash;&n;&t;&t;printk(s); &bslash;&n;&t;}
DECL|macro|ASC_PRINT1
mdefine_line|#define ASC_PRINT1(s, a1) &bslash;&n;&t;{ &bslash;&n;&t;&t;printk(&quot;advansys: &quot;); &bslash;&n;&t;&t;printk((s), (a1)); &bslash;&n;&t;}
DECL|macro|ASC_PRINT2
mdefine_line|#define ASC_PRINT2(s, a1, a2) &bslash;&n;&t;{ &bslash;&n;&t;&t;printk(&quot;advansys: &quot;); &bslash;&n;&t;&t;printk((s), (a1), (a2)); &bslash;&n;&t;}
DECL|macro|ASC_PRINT3
mdefine_line|#define ASC_PRINT3(s, a1, a2, a3) &bslash;&n;&t;{ &bslash;&n;&t;&t;printk(&quot;advansys: &quot;); &bslash;&n;&t;&t;printk((s), (a1), (a2), (a3)); &bslash;&n;&t;}
DECL|macro|ASC_PRINT4
mdefine_line|#define ASC_PRINT4(s, a1, a2, a3, a4) &bslash;&n;&t;{ &bslash;&n;&t;&t;printk(&quot;advansys: &quot;); &bslash;&n;&t;&t;printk((s), (a1), (a2), (a3), (a4)); &bslash;&n;&t;}
macro_line|#ifndef ADVANSYS_DEBUG
DECL|macro|ASC_DBG
mdefine_line|#define&t;ASC_DBG(lvl, s)
DECL|macro|ASC_DBG1
mdefine_line|#define&t;ASC_DBG1(lvl, s, a1)
DECL|macro|ASC_DBG2
mdefine_line|#define&t;ASC_DBG2(lvl, s, a1, a2)
DECL|macro|ASC_DBG3
mdefine_line|#define&t;ASC_DBG3(lvl, s, a1, a2, a3)
DECL|macro|ASC_DBG4
mdefine_line|#define&t;ASC_DBG4(lvl, s, a1, a2, a3, a4)
DECL|macro|ASC_DBG_PRT_SCSI_HOST
mdefine_line|#define&t;ASC_DBG_PRT_SCSI_HOST(lvl, s)
DECL|macro|ASC_DBG_PRT_DVC_VAR
mdefine_line|#define&t;ASC_DBG_PRT_DVC_VAR(lvl, v)
DECL|macro|ASC_DBG_PRT_DVC_CFG
mdefine_line|#define&t;ASC_DBG_PRT_DVC_CFG(lvl, c)
DECL|macro|ASC_DBG_PRT_SCSI_Q
mdefine_line|#define&t;ASC_DBG_PRT_SCSI_Q(lvl, scsiqp)
DECL|macro|ASC_DBG_PRT_QDONE_INFO
mdefine_line|#define&t;ASC_DBG_PRT_QDONE_INFO(lvl, qdone)
DECL|macro|ASC_DBG_PRT_HEX
mdefine_line|#define&t;ASC_DBG_PRT_HEX(lvl, name, start, length)
DECL|macro|ASC_DBG_PRT_CDB
mdefine_line|#define&t;ASC_DBG_PRT_CDB(lvl, cdb, len)
DECL|macro|ASC_DBG_PRT_SENSE
mdefine_line|#define&t;ASC_DBG_PRT_SENSE(lvl, sense, len)
DECL|macro|ASC_DBG_PRT_INQUIRY
mdefine_line|#define ASC_DBG_PRT_INQUIRY(lvl, inq, len)
DECL|macro|ASC_ASSERT
mdefine_line|#define ASC_ASSERT(a)
macro_line|#else /* ADVANSYS_DEBUG */
multiline_comment|/*&n; * Debugging Message Levels:&n; * 0: Errors Only&n; * 1: High-Level Tracing&n; * 2-N: Verbose Tracing&n; */
DECL|macro|ASC_DBG
mdefine_line|#define&t;ASC_DBG(lvl, s) &bslash;&n;&t;{ &bslash;&n;&t;&t;if (asc_dbglvl &gt;= (lvl)) { &bslash;&n;&t;&t;&t;printk(s); &bslash;&n;&t;&t;} &bslash;&n;&t;}
DECL|macro|ASC_DBG1
mdefine_line|#define&t;ASC_DBG1(lvl, s, a1) &bslash;&n;&t;{ &bslash;&n;&t;&t;if (asc_dbglvl &gt;= (lvl)) { &bslash;&n;&t;&t;&t;printk((s), (a1)); &bslash;&n;&t;&t;} &bslash;&n;&t;}
DECL|macro|ASC_DBG2
mdefine_line|#define&t;ASC_DBG2(lvl, s, a1, a2) &bslash;&n;&t;{ &bslash;&n;&t;&t;if (asc_dbglvl &gt;= (lvl)) { &bslash;&n;&t;&t;&t;printk((s), (a1), (a2)); &bslash;&n;&t;&t;} &bslash;&n;&t;}
DECL|macro|ASC_DBG3
mdefine_line|#define&t;ASC_DBG3(lvl, s, a1, a2, a3) &bslash;&n;&t;{ &bslash;&n;&t;&t;if (asc_dbglvl &gt;= (lvl)) { &bslash;&n;&t;&t;&t;printk((s), (a1), (a2), (a3)); &bslash;&n;&t;&t;} &bslash;&n;&t;}
DECL|macro|ASC_DBG4
mdefine_line|#define&t;ASC_DBG4(lvl, s, a1, a2, a3, a4) &bslash;&n;&t;{ &bslash;&n;&t;&t;if (asc_dbglvl &gt;= (lvl)) { &bslash;&n;&t;&t;&t;printk((s), (a1), (a2), (a3), (a4)); &bslash;&n;&t;&t;} &bslash;&n;&t;}
DECL|macro|ASC_DBG_PRT_SCSI_HOST
mdefine_line|#define&t;ASC_DBG_PRT_SCSI_HOST(lvl, s) &bslash;&n;&t;{ &bslash;&n;&t;&t;if (asc_dbglvl &gt;= (lvl)) { &bslash;&n;&t;&t;&t;asc_prt_scsi_host(s); &bslash;&n;&t;&t;} &bslash;&n;&t;}
DECL|macro|ASC_DBG_PRT_DVC_VAR
mdefine_line|#define&t;ASC_DBG_PRT_DVC_VAR(lvl, v) &bslash;&n;&t;{ &bslash;&n;&t;&t;if (asc_dbglvl &gt;= (lvl)) { &bslash;&n;&t;&t;&t;asc_prt_dvc_var(v); &bslash;&n;&t;&t;} &bslash;&n;&t;}
DECL|macro|ASC_DBG_PRT_DVC_CFG
mdefine_line|#define&t;ASC_DBG_PRT_DVC_CFG(lvl, c) &bslash;&n;&t;{ &bslash;&n;&t;&t;if (asc_dbglvl &gt;= (lvl)) { &bslash;&n;&t;&t;&t;asc_prt_dvc_cfg(c); &bslash;&n;&t;&t;} &bslash;&n;&t;}
DECL|macro|ASC_DBG_PRT_SCSI_Q
mdefine_line|#define&t;ASC_DBG_PRT_SCSI_Q(lvl, scsiqp) &bslash;&n;&t;{ &bslash;&n;&t;&t;if (asc_dbglvl &gt;= (lvl)) { &bslash;&n;&t;&t;&t;asc_prt_scsi_q(scsiqp); &bslash;&n;&t;&t;} &bslash;&n;&t;}
DECL|macro|ASC_DBG_PRT_QDONE_INFO
mdefine_line|#define&t;ASC_DBG_PRT_QDONE_INFO(lvl, qdone) &bslash;&n;&t;{ &bslash;&n;&t;&t;if (asc_dbglvl &gt;= (lvl)) { &bslash;&n;&t;&t;&t;asc_prt_qdone_info(qdone); &bslash;&n;&t;&t;} &bslash;&n;&t;}
DECL|macro|ASC_DBG_PRT_HEX
mdefine_line|#define&t;ASC_DBG_PRT_HEX(lvl, name, start, length) &bslash;&n;&t;{ &bslash;&n;&t;&t;if (asc_dbglvl &gt;= (lvl)) { &bslash;&n;&t;&t;&t;asc_prt_hex((name), (start), (length)); &bslash;&n;&t;&t;} &bslash;&n;&t;}
DECL|macro|ASC_DBG_PRT_CDB
mdefine_line|#define&t;ASC_DBG_PRT_CDB(lvl, cdb, len) &bslash;&n;&t;&t;ASC_DBG_PRT_HEX((lvl), &quot;CDB&quot;, (uchar *) (cdb), (len));
DECL|macro|ASC_DBG_PRT_SENSE
mdefine_line|#define&t;ASC_DBG_PRT_SENSE(lvl, sense, len) &bslash;&n;&t;&t;ASC_DBG_PRT_HEX((lvl), &quot;SENSE&quot;, (uchar *) (sense), (len));
DECL|macro|ASC_DBG_PRT_INQUIRY
mdefine_line|#define ASC_DBG_PRT_INQUIRY(lvl, inq, len) &bslash;&n;&t;&t;ASC_DBG_PRT_HEX((lvl), &quot;INQUIRY&quot;, (uchar *) (inq), (len));
DECL|macro|ASC_ASSERT
mdefine_line|#define ASC_ASSERT(a) &bslash;&n;&t;{ &bslash;&n;&t;&t;if (!(a)) { &bslash;&n;&t;&t;&t;printk(&quot;ASC_ASSERT() Failure: file %s, line %d&bslash;n&quot;, &bslash;&n;&t;&t;&t;&t;__FILE__, __LINE__); &bslash;&n;&t;&t;} &bslash;&n;&t;}
macro_line|#endif /* ADVANSYS_DEBUG */
multiline_comment|/*&n; * --- Driver Structures&n; */
macro_line|#ifdef ADVANSYS_STATS
multiline_comment|/* Per board statistics structure */
DECL|struct|asc_stats
r_struct
id|asc_stats
(brace
multiline_comment|/* Driver Entrypoint Statistics */
DECL|member|command
id|ulong
id|command
suffix:semicolon
multiline_comment|/* # calls to advansys_command() */
DECL|member|queuecommand
id|ulong
id|queuecommand
suffix:semicolon
multiline_comment|/* # calls to advansys_queuecommand() */
DECL|member|abort
id|ulong
m_abort
suffix:semicolon
multiline_comment|/* # calls to advansys_abort() */
DECL|member|reset
id|ulong
id|reset
suffix:semicolon
multiline_comment|/* # calls to advansys_reset() */
DECL|member|biosparam
id|ulong
id|biosparam
suffix:semicolon
multiline_comment|/* # calls to advansys_biosparam() */
DECL|member|check_interrupt
id|ulong
id|check_interrupt
suffix:semicolon
multiline_comment|/* # advansys_interrupt() check pending calls */
DECL|member|interrupt
id|ulong
id|interrupt
suffix:semicolon
multiline_comment|/* # advansys_interrupt() interrupts */
DECL|member|callback
id|ulong
id|callback
suffix:semicolon
multiline_comment|/* # calls asc_isr_callback() */
multiline_comment|/* AscExeScsiQueue() Statistics */
DECL|member|asc_noerror
id|ulong
id|asc_noerror
suffix:semicolon
multiline_comment|/* # AscExeScsiQueue() ASC_NOERROR returns. */
DECL|member|asc_busy
id|ulong
id|asc_busy
suffix:semicolon
multiline_comment|/* # AscExeScsiQueue() ASC_BUSY returns. */
DECL|member|asc_error
id|ulong
id|asc_error
suffix:semicolon
multiline_comment|/* # AscExeScsiQueue() ASC_ERROR returns. */
DECL|member|asc_unknown
id|ulong
id|asc_unknown
suffix:semicolon
multiline_comment|/* # AscExeScsiQueue() unknown returns. */
multiline_comment|/* Data Transfer Statistics */
DECL|member|cont_cnt
id|ulong
id|cont_cnt
suffix:semicolon
multiline_comment|/* # non-scatter-gather I/O requests received */
DECL|member|cont_xfer
id|ulong
id|cont_xfer
suffix:semicolon
multiline_comment|/* # contiguous transfer 512-bytes */
DECL|member|sg_cnt
id|ulong
id|sg_cnt
suffix:semicolon
multiline_comment|/* # scatter-gather I/O requests received */
DECL|member|sg_elem
id|ulong
id|sg_elem
suffix:semicolon
multiline_comment|/* # scatter-gather elements */
DECL|member|sg_xfer
id|ulong
id|sg_xfer
suffix:semicolon
multiline_comment|/* # scatter-gather tranfer 512-bytes */
multiline_comment|/* Device SCSI Command Queuing Statistics */
DECL|member|queue_full
id|ASC_SCSI_BIT_ID_TYPE
id|queue_full
suffix:semicolon
DECL|member|queue_full_cnt
id|ushort
id|queue_full_cnt
(braket
id|ASC_MAX_TID
op_plus
l_int|1
)braket
suffix:semicolon
)brace
suffix:semicolon
macro_line|#endif /* ADVANSYS_STATS */
multiline_comment|/*&n; * Request queuing structure&n; */
DECL|struct|asc_queue
r_typedef
r_struct
id|asc_queue
(brace
DECL|member|tidmask
id|ASC_SCSI_BIT_ID_TYPE
id|tidmask
suffix:semicolon
multiline_comment|/* queue mask */
DECL|member|queue
id|REQP
id|queue
(braket
id|ASC_MAX_TID
op_plus
l_int|1
)braket
suffix:semicolon
multiline_comment|/* queue linked list */
macro_line|#ifdef ADVANSYS_STATS
DECL|member|cur_count
r_int
id|cur_count
(braket
id|ASC_MAX_TID
op_plus
l_int|1
)braket
suffix:semicolon
multiline_comment|/* current queue count */
DECL|member|max_count
r_int
id|max_count
(braket
id|ASC_MAX_TID
op_plus
l_int|1
)braket
suffix:semicolon
multiline_comment|/* maximum queue count */
macro_line|#endif /* ADVANSYS_STATS */
DECL|typedef|asc_queue_t
)brace
id|asc_queue_t
suffix:semicolon
multiline_comment|/*&n; * Structure allocated for each board.&n; *&n; * This structure is allocated by scsi_register() at the end&n; * of the &squot;Scsi_Host&squot; structure starting at the &squot;hostdata&squot;&n; * field. It is guaranteed to be allocated from DMA-able memory.&n; */
DECL|struct|asc_board
r_struct
id|asc_board
(brace
DECL|member|id
r_int
id|id
suffix:semicolon
multiline_comment|/* Board Id */
multiline_comment|/* Asc Library */
DECL|member|asc_dvc_var
id|ASC_DVC_VAR
id|asc_dvc_var
suffix:semicolon
multiline_comment|/* Board configuration */
DECL|member|asc_dvc_cfg
id|ASC_DVC_CFG
id|asc_dvc_cfg
suffix:semicolon
multiline_comment|/* Device configuration */
multiline_comment|/* Queued Commands */
DECL|member|active
id|asc_queue_t
id|active
suffix:semicolon
multiline_comment|/* Active command queue */
DECL|member|pending
id|asc_queue_t
id|pending
suffix:semicolon
multiline_comment|/* Pending command queue */
multiline_comment|/* Target Initialization */
DECL|member|init_tidmask
id|ASC_SCSI_BIT_ID_TYPE
id|init_tidmask
suffix:semicolon
multiline_comment|/* Target initialized mask */
DECL|member|scsireqq
id|ASC_SCSI_REQ_Q
id|scsireqq
suffix:semicolon
DECL|member|cap_info
id|ASC_CAP_INFO
id|cap_info
suffix:semicolon
DECL|member|inquiry
id|ASC_SCSI_INQUIRY
id|inquiry
suffix:semicolon
DECL|member|eep_config
id|ASCEEP_CONFIG
id|eep_config
suffix:semicolon
multiline_comment|/* EEPROM configuration */
macro_line|#if LINUX_VERSION_CODE &gt;= ASC_LINUX_VERSION(1,3,0)
multiline_comment|/* /proc/scsi/advansys/[0...] */
DECL|member|prtbuf
r_char
op_star
id|prtbuf
suffix:semicolon
multiline_comment|/* Statistics Print Buffer */
macro_line|#endif /* version &gt;= v1.3.0 */
macro_line|#ifdef ADVANSYS_STATS
DECL|member|asc_stats
r_struct
id|asc_stats
id|asc_stats
suffix:semicolon
multiline_comment|/* Board statistics */
macro_line|#endif /* ADVANSYS_STATS */
)brace
suffix:semicolon
multiline_comment|/*&n; * PCI configuration structures&n; */
DECL|struct|_PCI_DATA_
r_typedef
r_struct
id|_PCI_DATA_
(brace
DECL|member|type
id|uchar
id|type
suffix:semicolon
DECL|member|bus
id|uchar
id|bus
suffix:semicolon
DECL|member|slot
id|uchar
id|slot
suffix:semicolon
DECL|member|func
id|uchar
id|func
suffix:semicolon
DECL|member|offset
id|uchar
id|offset
suffix:semicolon
DECL|typedef|PCI_DATA
)brace
id|PCI_DATA
suffix:semicolon
DECL|struct|_PCI_DEVICE_
r_typedef
r_struct
id|_PCI_DEVICE_
(brace
DECL|member|vendorID
id|ushort
id|vendorID
suffix:semicolon
DECL|member|deviceID
id|ushort
id|deviceID
suffix:semicolon
DECL|member|slotNumber
id|ushort
id|slotNumber
suffix:semicolon
DECL|member|slotFound
id|ushort
id|slotFound
suffix:semicolon
DECL|member|busNumber
id|uchar
id|busNumber
suffix:semicolon
DECL|member|maxBusNumber
id|uchar
id|maxBusNumber
suffix:semicolon
DECL|member|devFunc
id|uchar
id|devFunc
suffix:semicolon
DECL|member|startSlot
id|ushort
id|startSlot
suffix:semicolon
DECL|member|endSlot
id|ushort
id|endSlot
suffix:semicolon
DECL|member|bridge
id|uchar
id|bridge
suffix:semicolon
DECL|member|type
id|uchar
id|type
suffix:semicolon
DECL|typedef|PCI_DEVICE
)brace
id|PCI_DEVICE
suffix:semicolon
DECL|struct|_PCI_CONFIG_SPACE_
r_typedef
r_struct
id|_PCI_CONFIG_SPACE_
(brace
DECL|member|vendorID
id|ushort
id|vendorID
suffix:semicolon
DECL|member|deviceID
id|ushort
id|deviceID
suffix:semicolon
DECL|member|command
id|ushort
id|command
suffix:semicolon
DECL|member|status
id|ushort
id|status
suffix:semicolon
DECL|member|revision
id|uchar
id|revision
suffix:semicolon
DECL|member|classCode
id|uchar
id|classCode
(braket
l_int|3
)braket
suffix:semicolon
DECL|member|cacheSize
id|uchar
id|cacheSize
suffix:semicolon
DECL|member|latencyTimer
id|uchar
id|latencyTimer
suffix:semicolon
DECL|member|headerType
id|uchar
id|headerType
suffix:semicolon
DECL|member|bist
id|uchar
id|bist
suffix:semicolon
DECL|member|baseAddress
id|ulong
id|baseAddress
(braket
l_int|6
)braket
suffix:semicolon
DECL|member|reserved
id|ushort
id|reserved
(braket
l_int|4
)braket
suffix:semicolon
DECL|member|optionRomAddr
id|ulong
id|optionRomAddr
suffix:semicolon
DECL|member|reserved2
id|ushort
id|reserved2
(braket
l_int|4
)braket
suffix:semicolon
DECL|member|irqLine
id|uchar
id|irqLine
suffix:semicolon
DECL|member|irqPin
id|uchar
id|irqPin
suffix:semicolon
DECL|member|minGnt
id|uchar
id|minGnt
suffix:semicolon
DECL|member|maxLatency
id|uchar
id|maxLatency
suffix:semicolon
DECL|typedef|PCI_CONFIG_SPACE
)brace
id|PCI_CONFIG_SPACE
suffix:semicolon
multiline_comment|/*&n; * --- Driver Data&n; */
multiline_comment|/* Note: All driver global data should be initialized. */
macro_line|#if LINUX_VERSION_CODE &gt;= ASC_LINUX_VERSION(1,3,0)
DECL|variable|proc_scsi_advansys
r_struct
id|proc_dir_entry
id|proc_scsi_advansys
op_assign
(brace
id|PROC_SCSI_ADVANSYS
comma
multiline_comment|/* unsigned short low_ino */
l_int|8
comma
multiline_comment|/* unsigned short namelen */
l_string|&quot;advansys&quot;
comma
multiline_comment|/* const char *name */
id|S_IFDIR
op_or
id|S_IRUGO
op_or
id|S_IXUGO
comma
multiline_comment|/* mode_t mode */
l_int|2
multiline_comment|/* nlink_t nlink */
)brace
suffix:semicolon
macro_line|#endif /* version &gt;= v1.3.0 */
multiline_comment|/* Number of boards detected in system. */
DECL|variable|asc_board_count
id|STATIC
r_int
id|asc_board_count
op_assign
l_int|0
suffix:semicolon
DECL|variable|asc_host
id|STATIC
r_struct
id|Scsi_Host
op_star
id|asc_host
(braket
id|ASC_NUM_BOARD_SUPPORTED
)braket
op_assign
(brace
l_int|0
)brace
suffix:semicolon
multiline_comment|/* Global list of commands needing done function. */
DECL|variable|asc_scsi_done
id|STATIC
id|Scsi_Cmnd
op_star
id|asc_scsi_done
op_assign
l_int|NULL
suffix:semicolon
multiline_comment|/* Overrun buffer shared between all boards. */
DECL|variable|overrun_buf
id|STATIC
id|uchar
id|overrun_buf
(braket
id|ASC_OVERRUN_BSIZE
)braket
op_assign
(brace
l_int|0
)brace
suffix:semicolon
multiline_comment|/* List of supported bus types. */
DECL|variable|asc_bus
id|STATIC
id|ushort
id|asc_bus
(braket
id|ASC_NUM_BUS
)braket
op_assign
(brace
id|ASC_IS_ISA
comma
id|ASC_IS_VL
comma
id|ASC_IS_EISA
comma
id|ASC_IS_PCI
comma
)brace
suffix:semicolon
DECL|variable|pci_scan_method
id|STATIC
r_int
id|pci_scan_method
op_assign
op_minus
l_int|1
suffix:semicolon
multiline_comment|/*&n; * Used with the LILO &squot;advansys&squot; option to eliminate or&n; * limit I/O port probing at boot time, cf. advansys_setup().&n; */
DECL|variable|asc_iopflag
r_int
id|asc_iopflag
op_assign
id|ASC_FALSE
suffix:semicolon
DECL|variable|asc_ioport
r_int
id|asc_ioport
(braket
id|ASC_NUM_BOARD_SUPPORTED
)braket
op_assign
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
suffix:semicolon
macro_line|#ifdef ADVANSYS_DEBUG
r_char
op_star
DECL|variable|asc_bus_name
id|asc_bus_name
(braket
id|ASC_NUM_BUS
)braket
op_assign
(brace
l_string|&quot;ASC_IS_ISA&quot;
comma
l_string|&quot;ASC_IS_VL&quot;
comma
l_string|&quot;ASC_IS_EISA&quot;
comma
l_string|&quot;ASC_IS_PCI&quot;
comma
)brace
suffix:semicolon
DECL|variable|asc_dbglvl
r_int
id|asc_dbglvl
op_assign
l_int|0
suffix:semicolon
macro_line|#endif /* ADVANSYS_DEBUG */
multiline_comment|/*&n; * --- Driver Function Prototypes&n; *&n; * advansys.h contains function prototypes for functions global to Linux.&n; */
macro_line|#if LINUX_VERSION_CODE &gt;= ASC_LINUX_VERSION(1,3,0)
id|STATIC
r_int
id|asc_proc_copy
c_func
(paren
id|off_t
comma
id|off_t
comma
r_char
op_star
comma
r_int
comma
r_char
op_star
comma
r_int
)paren
suffix:semicolon
macro_line|#endif /* version &gt;= v1.3.0 */
macro_line|#if LINUX_VERSION_CODE &lt; ASC_LINUX_VERSION(1,3,70)
id|STATIC
r_void
id|advansys_interrupt
c_func
(paren
r_int
comma
r_struct
id|pt_regs
op_star
)paren
suffix:semicolon
macro_line|#else /* version &gt;= v1.3.70 */
id|STATIC
r_void
id|advansys_interrupt
c_func
(paren
r_int
comma
r_void
op_star
comma
r_struct
id|pt_regs
op_star
)paren
suffix:semicolon
macro_line|#endif /* version &gt;= v1.3.70 */
macro_line|#if LINUX_VERSION_CODE &gt;= ASC_LINUX_VERSION(1,3,89)
id|STATIC
r_void
id|advansys_select_queue_depths
c_func
(paren
r_struct
id|Scsi_Host
op_star
comma
id|Scsi_Device
op_star
)paren
suffix:semicolon
macro_line|#endif /* version &gt;= v1.3.89 */
id|STATIC
r_void
id|advansys_command_done
c_func
(paren
id|Scsi_Cmnd
op_star
)paren
suffix:semicolon
id|STATIC
r_int
id|asc_execute_scsi_cmnd
c_func
(paren
id|Scsi_Cmnd
op_star
)paren
suffix:semicolon
id|STATIC
r_void
id|asc_isr_callback
c_func
(paren
id|ASC_DVC_VAR
op_star
comma
id|ASC_QDONE_INFO
op_star
)paren
suffix:semicolon
id|STATIC
r_int
id|asc_init_dev
c_func
(paren
id|ASC_DVC_VAR
op_star
comma
id|Scsi_Cmnd
op_star
)paren
suffix:semicolon
id|STATIC
r_int
id|asc_srch_pci_dev
c_func
(paren
id|PCI_DEVICE
op_star
)paren
suffix:semicolon
id|STATIC
id|uchar
id|asc_scan_method
c_func
(paren
r_void
)paren
suffix:semicolon
id|STATIC
r_int
id|asc_pci_find_dev
c_func
(paren
id|PCI_DEVICE
op_star
)paren
suffix:semicolon
id|STATIC
r_void
id|asc_get_pci_cfg
c_func
(paren
id|PCI_DEVICE
op_star
comma
id|PCI_CONFIG_SPACE
op_star
)paren
suffix:semicolon
id|STATIC
id|ushort
id|asc_get_cfg_word
c_func
(paren
id|PCI_DATA
op_star
)paren
suffix:semicolon
id|STATIC
id|uchar
id|asc_get_cfg_byte
c_func
(paren
id|PCI_DATA
op_star
)paren
suffix:semicolon
id|STATIC
r_void
id|asc_put_cfg_byte
c_func
(paren
id|PCI_DATA
op_star
comma
id|uchar
)paren
suffix:semicolon
r_void
id|asc_enqueue
c_func
(paren
id|asc_queue_t
op_star
comma
id|REQP
comma
r_int
)paren
suffix:semicolon
id|REQP
id|asc_dequeue
c_func
(paren
id|asc_queue_t
op_star
comma
r_int
)paren
suffix:semicolon
r_int
id|asc_rmqueue
c_func
(paren
id|asc_queue_t
op_star
comma
id|REQP
)paren
suffix:semicolon
r_int
id|asc_isqueued
c_func
(paren
id|asc_queue_t
op_star
comma
id|REQP
)paren
suffix:semicolon
r_void
id|asc_execute_queue
c_func
(paren
id|asc_queue_t
op_star
)paren
suffix:semicolon
id|STATIC
r_int
id|asc_prt_board_devices
c_func
(paren
r_struct
id|Scsi_Host
op_star
comma
r_char
op_star
comma
r_int
)paren
suffix:semicolon
id|STATIC
r_int
id|asc_prt_board_eeprom
c_func
(paren
r_struct
id|Scsi_Host
op_star
comma
r_char
op_star
comma
r_int
)paren
suffix:semicolon
id|STATIC
r_int
id|asc_prt_board_info
c_func
(paren
r_struct
id|Scsi_Host
op_star
comma
r_char
op_star
comma
r_int
)paren
suffix:semicolon
id|STATIC
r_int
id|asc_proc_copy
c_func
(paren
id|off_t
comma
id|off_t
comma
r_char
op_star
comma
r_int
comma
r_char
op_star
comma
r_int
)paren
suffix:semicolon
id|STATIC
r_int
id|asc_prt_line
c_func
(paren
r_char
op_star
comma
r_int
comma
r_char
op_star
id|fmt
comma
dot
dot
dot
)paren
suffix:semicolon
multiline_comment|/* XXX - Asc Library Routines not supposed to be used directly */
r_int
id|AscFindSignature
c_func
(paren
id|PortAddr
)paren
suffix:semicolon
id|ushort
id|AscGetEEPConfig
c_func
(paren
id|PortAddr
comma
id|ASCEEP_CONFIG
op_star
comma
id|ushort
)paren
suffix:semicolon
macro_line|#ifdef ADVANSYS_STATS
id|STATIC
r_int
id|asc_prt_board_stats
c_func
(paren
r_struct
id|Scsi_Host
op_star
comma
r_char
op_star
comma
r_int
)paren
suffix:semicolon
macro_line|#endif /* ADVANSYS_STATS */
macro_line|#ifdef ADVANSYS_DEBUG
id|STATIC
r_void
id|asc_prt_scsi_host
c_func
(paren
r_struct
id|Scsi_Host
op_star
)paren
suffix:semicolon
id|STATIC
r_void
id|asc_prt_dvc_cfg
c_func
(paren
id|ASC_DVC_CFG
op_star
)paren
suffix:semicolon
id|STATIC
r_void
id|asc_prt_dvc_var
c_func
(paren
id|ASC_DVC_VAR
op_star
)paren
suffix:semicolon
id|STATIC
r_void
id|asc_prt_scsi_q
c_func
(paren
id|ASC_SCSI_Q
op_star
)paren
suffix:semicolon
id|STATIC
r_void
id|asc_prt_qdone_info
c_func
(paren
id|ASC_QDONE_INFO
op_star
)paren
suffix:semicolon
id|STATIC
r_void
id|asc_prt_hex
c_func
(paren
r_char
op_star
id|f
comma
id|uchar
op_star
comma
r_int
)paren
suffix:semicolon
id|STATIC
r_int
id|interrupts_enabled
c_func
(paren
r_void
)paren
suffix:semicolon
macro_line|#endif /* ADVANSYS_DEBUG */
multiline_comment|/*&n; * --- Linux &squot;Scsi_Host_Template&squot; and advansys_setup() Functions&n; */
macro_line|#if LINUX_VERSION_CODE &gt;= ASC_LINUX_VERSION(1,3,0)
multiline_comment|/*&n; * advansys_proc_info() - /proc/scsi/advansys/[0-(ASC_NUM_BOARD_SUPPORTED-1)]&n; *&n; * *buffer: I/O buffer&n; * **start: if inout == FALSE pointer into buffer where user read should start&n; * offset: current offset into a /proc/scsi/advansys/[0...] file&n; * length: length of buffer&n; * hostno: Scsi_Host host_no&n; * inout: TRUE - user is writing; FALSE - user is reading&n; *&n; * Return the number of bytes read from or written to a&n; * /proc/scsi/advansys/[0...] file.&n; *&n; * Note: This function uses the per board buffer &squot;prtbuf&squot; which is&n; * allocated when the board is initialized in advansys_detect(). The&n; * buffer is ASC_PRTBUF_SIZE bytes. The function asc_proc_copy() is&n; * used to write to the buffer. The way asc_proc_copy() is written&n; * if &squot;prtbuf&squot; is too small it will not be overwritten. Instead the&n; * user just won&squot;t get all the available statistics.&n; */
r_int
DECL|function|advansys_proc_info
id|advansys_proc_info
c_func
(paren
r_char
op_star
id|buffer
comma
r_char
op_star
op_star
id|start
comma
id|off_t
id|offset
comma
r_int
id|length
comma
r_int
id|hostno
comma
r_int
id|inout
)paren
(brace
r_struct
id|Scsi_Host
op_star
id|shp
suffix:semicolon
r_struct
id|asc_board
op_star
id|boardp
suffix:semicolon
r_int
id|i
suffix:semicolon
r_char
op_star
id|cp
suffix:semicolon
r_int
id|cplen
suffix:semicolon
r_int
id|cnt
suffix:semicolon
r_int
id|totcnt
suffix:semicolon
r_int
id|leftlen
suffix:semicolon
r_char
op_star
id|curbuf
suffix:semicolon
id|off_t
id|advoffset
suffix:semicolon
id|Scsi_Device
op_star
id|scd
suffix:semicolon
id|ASC_DBG
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_proc_info: begin&bslash;n&quot;
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * User write not supported.&n;&t; */
r_if
c_cond
(paren
id|inout
op_eq
id|TRUE
)paren
(brace
r_return
op_minus
id|ENOSYS
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * User read of /proc/scsi/advansys/[0...] file.&n;&t; */
multiline_comment|/* Find the specified board. */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|asc_board_count
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|asc_host
(braket
id|i
)braket
op_member_access_from_pointer
id|host_no
op_eq
id|hostno
)paren
(brace
r_break
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|i
op_eq
id|asc_board_count
)paren
(brace
r_return
op_minus
id|ENOENT
suffix:semicolon
)brace
id|shp
op_assign
id|asc_host
(braket
id|i
)braket
suffix:semicolon
id|boardp
op_assign
id|ASC_BOARDP
c_func
(paren
id|shp
)paren
suffix:semicolon
multiline_comment|/* Copy read data starting at the beginning of the buffer. */
op_star
id|start
op_assign
id|buffer
suffix:semicolon
id|curbuf
op_assign
id|buffer
suffix:semicolon
id|advoffset
op_assign
l_int|0
suffix:semicolon
id|totcnt
op_assign
l_int|0
suffix:semicolon
id|leftlen
op_assign
id|length
suffix:semicolon
multiline_comment|/*&n;&t; * Get board configuration information.&n;&t; *&n;&t; * advansys_info() returns the board string from its own static buffer.&n;&t; */
id|cp
op_assign
(paren
r_char
op_star
)paren
id|advansys_info
c_func
(paren
id|shp
)paren
suffix:semicolon
id|strcat
c_func
(paren
id|cp
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|cplen
op_assign
id|strlen
c_func
(paren
id|cp
)paren
suffix:semicolon
multiline_comment|/* Copy board information. */
id|cnt
op_assign
id|asc_proc_copy
c_func
(paren
id|advoffset
comma
id|offset
comma
id|curbuf
comma
id|leftlen
comma
id|cp
comma
id|cplen
)paren
suffix:semicolon
id|totcnt
op_add_assign
id|cnt
suffix:semicolon
id|leftlen
op_sub_assign
id|cnt
suffix:semicolon
r_if
c_cond
(paren
id|leftlen
op_eq
l_int|0
)paren
(brace
id|ASC_DBG1
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_proc_info: totcnt %d&bslash;n&quot;
comma
id|totcnt
)paren
suffix:semicolon
r_return
id|totcnt
suffix:semicolon
)brace
id|advoffset
op_add_assign
id|cplen
suffix:semicolon
id|curbuf
op_add_assign
id|cnt
suffix:semicolon
multiline_comment|/*&n;&t; * Display driver information for each device attached to the board.&n;&t; */
id|cp
op_assign
id|boardp-&gt;prtbuf
suffix:semicolon
id|cplen
op_assign
id|asc_prt_board_devices
c_func
(paren
id|shp
comma
id|cp
comma
id|ASC_PRTBUF_SIZE
)paren
suffix:semicolon
id|ASC_ASSERT
c_func
(paren
id|cplen
OL
id|ASC_PRTBUF_SIZE
)paren
suffix:semicolon
id|cnt
op_assign
id|asc_proc_copy
c_func
(paren
id|advoffset
comma
id|offset
comma
id|curbuf
comma
id|leftlen
comma
id|cp
comma
id|cplen
)paren
suffix:semicolon
id|totcnt
op_add_assign
id|cnt
suffix:semicolon
id|leftlen
op_sub_assign
id|cnt
suffix:semicolon
r_if
c_cond
(paren
id|leftlen
op_eq
l_int|0
)paren
(brace
id|ASC_DBG1
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_proc_info: totcnt %d&bslash;n&quot;
comma
id|totcnt
)paren
suffix:semicolon
r_return
id|totcnt
suffix:semicolon
)brace
id|advoffset
op_add_assign
id|cplen
suffix:semicolon
id|curbuf
op_add_assign
id|cnt
suffix:semicolon
multiline_comment|/*&n;&t; * Display target driver information for each device attached&n;&t; * to the board.&n;&t; */
r_for
c_loop
(paren
id|scd
op_assign
id|scsi_devices
suffix:semicolon
id|scd
suffix:semicolon
id|scd
op_assign
id|scd-&gt;next
)paren
(brace
r_if
c_cond
(paren
id|scd-&gt;host
op_eq
id|shp
)paren
(brace
id|cp
op_assign
id|boardp-&gt;prtbuf
suffix:semicolon
multiline_comment|/*&n;&t;&t;&t; * Note: If proc_print_scsidevice() writes more than&n;&t;&t;&t; * ASC_PRTBUF_SIZE bytes, it will overrun &squot;prtbuf&squot;.&n;&t;&t;&t; */
id|proc_print_scsidevice
c_func
(paren
id|scd
comma
id|cp
comma
op_amp
id|cplen
comma
l_int|0
)paren
suffix:semicolon
id|ASC_ASSERT
c_func
(paren
id|cplen
OL
id|ASC_PRTBUF_SIZE
)paren
suffix:semicolon
id|cnt
op_assign
id|asc_proc_copy
c_func
(paren
id|advoffset
comma
id|offset
comma
id|curbuf
comma
id|leftlen
comma
id|cp
comma
id|cplen
)paren
suffix:semicolon
id|totcnt
op_add_assign
id|cnt
suffix:semicolon
id|leftlen
op_sub_assign
id|cnt
suffix:semicolon
r_if
c_cond
(paren
id|leftlen
op_eq
l_int|0
)paren
(brace
id|ASC_DBG1
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_proc_info: totcnt %d&bslash;n&quot;
comma
id|totcnt
)paren
suffix:semicolon
r_return
id|totcnt
suffix:semicolon
)brace
id|advoffset
op_add_assign
id|cplen
suffix:semicolon
id|curbuf
op_add_assign
id|cnt
suffix:semicolon
)brace
)brace
multiline_comment|/*&n;&t; * Display EEPROM configuration for the board.&n;&t; */
id|cp
op_assign
id|boardp-&gt;prtbuf
suffix:semicolon
id|cplen
op_assign
id|asc_prt_board_eeprom
c_func
(paren
id|shp
comma
id|cp
comma
id|ASC_PRTBUF_SIZE
)paren
suffix:semicolon
id|ASC_ASSERT
c_func
(paren
id|cplen
OL
id|ASC_PRTBUF_SIZE
)paren
suffix:semicolon
id|cnt
op_assign
id|asc_proc_copy
c_func
(paren
id|advoffset
comma
id|offset
comma
id|curbuf
comma
id|leftlen
comma
id|cp
comma
id|cplen
)paren
suffix:semicolon
id|totcnt
op_add_assign
id|cnt
suffix:semicolon
id|leftlen
op_sub_assign
id|cnt
suffix:semicolon
r_if
c_cond
(paren
id|leftlen
op_eq
l_int|0
)paren
(brace
id|ASC_DBG1
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_proc_info: totcnt %d&bslash;n&quot;
comma
id|totcnt
)paren
suffix:semicolon
r_return
id|totcnt
suffix:semicolon
)brace
id|advoffset
op_add_assign
id|cplen
suffix:semicolon
id|curbuf
op_add_assign
id|cnt
suffix:semicolon
macro_line|#ifdef ADVANSYS_STATS
multiline_comment|/*&n;&t; * Display driver statistics for the board.&n;&t; */
id|cp
op_assign
id|boardp-&gt;prtbuf
suffix:semicolon
id|cplen
op_assign
id|asc_prt_board_stats
c_func
(paren
id|shp
comma
id|cp
comma
id|ASC_PRTBUF_SIZE
)paren
suffix:semicolon
id|ASC_ASSERT
c_func
(paren
id|cplen
OL
id|ASC_PRTBUF_SIZE
)paren
suffix:semicolon
id|cnt
op_assign
id|asc_proc_copy
c_func
(paren
id|advoffset
comma
id|offset
comma
id|curbuf
comma
id|leftlen
comma
id|cp
comma
id|cplen
)paren
suffix:semicolon
id|totcnt
op_add_assign
id|cnt
suffix:semicolon
id|leftlen
op_sub_assign
id|cnt
suffix:semicolon
r_if
c_cond
(paren
id|leftlen
op_eq
l_int|0
)paren
(brace
id|ASC_DBG1
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_proc_info: totcnt %d&bslash;n&quot;
comma
id|totcnt
)paren
suffix:semicolon
r_return
id|totcnt
suffix:semicolon
)brace
id|advoffset
op_add_assign
id|cplen
suffix:semicolon
id|curbuf
op_add_assign
id|cnt
suffix:semicolon
macro_line|#endif /* ADVANSYS_STATS */
multiline_comment|/*&n;&t; * Display Asc Library dynamic configuration information&n;&t; * for the board.&n;&t; */
id|cp
op_assign
id|boardp-&gt;prtbuf
suffix:semicolon
id|cplen
op_assign
id|asc_prt_board_info
c_func
(paren
id|shp
comma
id|cp
comma
id|ASC_PRTBUF_SIZE
)paren
suffix:semicolon
id|ASC_ASSERT
c_func
(paren
id|cplen
OL
id|ASC_PRTBUF_SIZE
)paren
suffix:semicolon
id|cnt
op_assign
id|asc_proc_copy
c_func
(paren
id|advoffset
comma
id|offset
comma
id|curbuf
comma
id|leftlen
comma
id|cp
comma
id|cplen
)paren
suffix:semicolon
id|totcnt
op_add_assign
id|cnt
suffix:semicolon
id|leftlen
op_sub_assign
id|cnt
suffix:semicolon
r_if
c_cond
(paren
id|leftlen
op_eq
l_int|0
)paren
(brace
id|ASC_DBG1
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_proc_info: totcnt %d&bslash;n&quot;
comma
id|totcnt
)paren
suffix:semicolon
r_return
id|totcnt
suffix:semicolon
)brace
id|advoffset
op_add_assign
id|cplen
suffix:semicolon
id|curbuf
op_add_assign
id|cnt
suffix:semicolon
id|ASC_DBG1
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_proc_info: totcnt %d&bslash;n&quot;
comma
id|totcnt
)paren
suffix:semicolon
r_return
id|totcnt
suffix:semicolon
)brace
macro_line|#endif /* version &gt;= v1.3.0 */
multiline_comment|/*&n; * advansys_detect()&n; *&n; * Detect function for AdvanSys adapters.&n; *&n; * Argument is a pointer to the host driver&squot;s scsi_hosts entry.&n; *&n; * Return number of adapters found.&n; *&n; * Note: Because this function is called during system initialization&n; * it must not call SCSI mid-level functions including scsi_malloc()&n; * and scsi_free().&n; */
r_int
DECL|function|advansys_detect
id|advansys_detect
c_func
(paren
id|Scsi_Host_Template
op_star
id|tpnt
)paren
(brace
r_static
r_int
id|detect_called
op_assign
id|ASC_FALSE
suffix:semicolon
r_int
id|iop
suffix:semicolon
r_int
id|bus
suffix:semicolon
r_struct
id|Scsi_Host
op_star
id|shp
suffix:semicolon
r_struct
id|asc_board
op_star
id|boardp
suffix:semicolon
id|ASC_DVC_VAR
op_star
id|asc_dvc_varp
suffix:semicolon
r_int
id|ioport
op_assign
l_int|0
suffix:semicolon
r_int
id|share_irq
op_assign
id|FALSE
suffix:semicolon
id|PCI_DEVICE
id|pciDevice
suffix:semicolon
id|PCI_CONFIG_SPACE
id|pciConfig
suffix:semicolon
r_int
id|ret
suffix:semicolon
r_extern
id|PortAddr
id|_asc_def_iop_base
(braket
id|ASC_IOADR_TABLE_MAX_IX
)braket
suffix:semicolon
r_if
c_cond
(paren
id|detect_called
op_eq
id|ASC_FALSE
)paren
(brace
id|detect_called
op_assign
id|ASC_TRUE
suffix:semicolon
)brace
r_else
(brace
id|printk
c_func
(paren
l_string|&quot;AdvanSys SCSI: advansys_detect() mulitple calls ignored&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|ASC_DBG
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_detect: begin&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#if LINUX_VERSION_CODE &gt;= ASC_LINUX_VERSION(1,3,0)
id|tpnt-&gt;proc_dir
op_assign
op_amp
id|proc_scsi_advansys
suffix:semicolon
macro_line|#endif /* version &gt;= v1.3.0 */
id|asc_board_count
op_assign
l_int|0
suffix:semicolon
multiline_comment|/*&n;&t; * If I/O port probing has been modified, then verify and&n;&t; * clean-up the &squot;asc_ioport&squot; list.&n;&t; */
r_if
c_cond
(paren
id|asc_iopflag
op_eq
id|ASC_TRUE
)paren
(brace
r_for
c_loop
(paren
id|ioport
op_assign
l_int|0
suffix:semicolon
id|ioport
OL
id|ASC_NUM_BOARD_SUPPORTED
suffix:semicolon
id|ioport
op_increment
)paren
(brace
id|ASC_DBG2
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_detect: asc_ioport[%d] %x&bslash;n&quot;
comma
id|ioport
comma
id|asc_ioport
(braket
id|ioport
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|asc_ioport
(braket
id|ioport
)braket
op_ne
l_int|0
)paren
(brace
r_for
c_loop
(paren
id|iop
op_assign
l_int|0
suffix:semicolon
id|iop
OL
id|ASC_IOADR_TABLE_MAX_IX
suffix:semicolon
id|iop
op_increment
)paren
(brace
r_if
c_cond
(paren
id|_asc_def_iop_base
(braket
id|iop
)braket
op_eq
id|asc_ioport
(braket
id|ioport
)braket
)paren
(brace
r_break
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|iop
op_eq
id|ASC_IOADR_TABLE_MAX_IX
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;AdvanSys SCSI: specified I/O Port 0x%X is invalid&bslash;n&quot;
comma
id|asc_ioport
(braket
id|ioport
)braket
)paren
suffix:semicolon
id|asc_ioport
(braket
id|ioport
)braket
op_assign
l_int|0
suffix:semicolon
)brace
)brace
)brace
id|ioport
op_assign
l_int|0
suffix:semicolon
)brace
id|memset
c_func
(paren
op_amp
id|pciDevice
comma
l_int|0
comma
r_sizeof
(paren
id|PCI_DEVICE
)paren
)paren
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|pciConfig
comma
l_int|0
comma
r_sizeof
(paren
id|PCI_CONFIG_SPACE
)paren
)paren
suffix:semicolon
id|pciDevice.maxBusNumber
op_assign
id|PCI_MAX_BUS
suffix:semicolon
id|pciDevice.endSlot
op_assign
id|PCI_MAX_SLOT
suffix:semicolon
r_for
c_loop
(paren
id|bus
op_assign
l_int|0
suffix:semicolon
id|bus
OL
id|ASC_NUM_BUS
suffix:semicolon
id|bus
op_increment
)paren
(brace
id|ASC_DBG2
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_detect: bus search type %d (%s)&bslash;n&quot;
comma
id|bus
comma
id|asc_bus_name
(braket
id|bus
)braket
)paren
suffix:semicolon
id|iop
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|asc_board_count
OL
id|ASC_NUM_BOARD_SUPPORTED
)paren
(brace
id|ASC_DBG1
c_func
(paren
l_int|2
comma
l_string|&quot;advansys_detect: asc_board_count %d&bslash;n&quot;
comma
id|asc_board_count
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|asc_bus
(braket
id|bus
)braket
)paren
(brace
r_case
id|ASC_IS_ISA
suffix:colon
r_case
id|ASC_IS_VL
suffix:colon
r_if
c_cond
(paren
id|asc_iopflag
op_eq
id|ASC_FALSE
)paren
(brace
id|iop
op_assign
id|AscSearchIOPortAddr
c_func
(paren
id|iop
comma
id|asc_bus
(braket
id|bus
)braket
)paren
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/*&n;&t;&t;&t;&t;&t; * ISA and VL I/O port scanning has either been&n;&t;&t;&t;&t;&t; * eliminated or limited to selected ports on&n;&t;&t;&t;&t;&t; * the LILO command line, /etc/lilo.conf, or&n;&t;&t;&t;&t;&t; * by setting variables when the module was loaded.&n;&t;&t;&t;&t;&t; */
id|ASC_DBG
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_detect: I/O port scanning modified&bslash;n&quot;
)paren
suffix:semicolon
id|ioport_try_again
suffix:colon
id|iop
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
id|ioport
OL
id|ASC_NUM_BOARD_SUPPORTED
suffix:semicolon
id|ioport
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|iop
op_assign
id|asc_ioport
(braket
id|ioport
)braket
)paren
op_ne
l_int|0
)paren
(brace
r_break
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|iop
)paren
(brace
id|ASC_DBG1
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_detect: probing I/O port %x...&bslash;n&quot;
comma
id|iop
)paren
suffix:semicolon
r_if
c_cond
(paren
id|check_region
c_func
(paren
id|iop
comma
id|ASC_IOADR_GAP
)paren
op_ne
l_int|0
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;AdvanSys SCSI: specified I/O Port 0x%X is busy&bslash;n&quot;
comma
id|iop
)paren
suffix:semicolon
multiline_comment|/* Don&squot;t try this I/O port twice. */
id|asc_ioport
(braket
id|ioport
)braket
op_assign
l_int|0
suffix:semicolon
r_goto
id|ioport_try_again
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|AscFindSignature
c_func
(paren
id|iop
)paren
op_eq
id|ASC_FALSE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;AdvanSys SCSI: specified I/O Port 0x%X has no adapter&bslash;n&quot;
comma
id|iop
)paren
suffix:semicolon
multiline_comment|/* Don&squot;t try this I/O port twice. */
id|asc_ioport
(braket
id|ioport
)braket
op_assign
l_int|0
suffix:semicolon
r_goto
id|ioport_try_again
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/*&n;&t;&t;&t;&t;&t;&t;&t; * If this isn&squot;t an ISA board, then it must be&n;&t;&t;&t;&t;&t;&t;&t; * a VL board. If currently looking an ISA&n;&t;&t;&t;&t;&t;&t;&t; * board is being looked for then try for&n;&t;&t;&t;&t;&t;&t;&t; * another ISA board in &squot;asc_ioport&squot;.&n;&t;&t;&t;&t;&t;&t;&t; */
r_if
c_cond
(paren
id|asc_bus
(braket
id|bus
)braket
op_eq
id|ASC_IS_ISA
op_logical_and
(paren
id|AscGetChipVersion
c_func
(paren
id|iop
comma
id|ASC_IS_ISA
)paren
op_amp
id|ASC_CHIP_VER_ISA_BIT
)paren
op_eq
l_int|0
)paren
(brace
multiline_comment|/*&n;&t;&t;&t;&t;&t;&t;&t;&t; * Don&squot;t clear &squot;asc_ioport[ioport]&squot;. Try&n;&t;&t;&t;&t;&t;&t;&t;&t; * this board again for VL. Increment&n;&t;&t;&t;&t;&t;&t;&t;&t; * &squot;ioport&squot; past this board.&n;&t;&t;&t;&t;&t;&t;&t;&t; */
id|ioport
op_increment
suffix:semicolon
r_goto
id|ioport_try_again
suffix:semicolon
)brace
)brace
multiline_comment|/*&n;&t;&t;&t;&t;&t;&t; * This board appears good, don&squot;t try the I/O port&n;&t;&t;&t;&t;&t;&t; * again by clearing its value. Increment &squot;ioport&squot;&n;&t;&t;&t;&t;&t;&t; * for the next iteration.&n;&t;&t;&t;&t;&t;&t; */
id|asc_ioport
(braket
id|ioport
op_increment
)braket
op_assign
l_int|0
suffix:semicolon
)brace
)brace
r_break
suffix:semicolon
r_case
id|ASC_IS_EISA
suffix:colon
id|iop
op_assign
id|AscSearchIOPortAddr
c_func
(paren
id|iop
comma
id|asc_bus
(braket
id|bus
)braket
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ASC_IS_PCI
suffix:colon
r_if
c_cond
(paren
id|asc_srch_pci_dev
c_func
(paren
op_amp
id|pciDevice
)paren
op_ne
id|PCI_DEVICE_FOUND
)paren
(brace
id|iop
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|ASC_DBG2
c_func
(paren
l_int|2
comma
l_string|&quot;advansys_detect: slotFound %d, busNumber %d&bslash;n&quot;
comma
id|pciDevice.slotFound
comma
id|pciDevice.busNumber
)paren
suffix:semicolon
id|asc_get_pci_cfg
c_func
(paren
op_amp
id|pciDevice
comma
op_amp
id|pciConfig
)paren
suffix:semicolon
id|iop
op_assign
id|pciConfig.baseAddress
(braket
l_int|0
)braket
op_amp
id|PCI_IOADDRESS_MASK
suffix:semicolon
id|ASC_DBG2
c_func
(paren
l_int|2
comma
l_string|&quot;advansys_detect: iop %x, irqLine %d&bslash;n&quot;
comma
id|iop
comma
id|pciConfig.irqLine
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_default
suffix:colon
id|ASC_PRINT1
c_func
(paren
l_string|&quot;advansys_detect: unknown bus type: %d&bslash;n&quot;
comma
id|asc_bus
(braket
id|bus
)braket
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|ASC_DBG1
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_detect: iop %x&bslash;n&quot;
comma
id|iop
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t;&t; * Adapter not found, try next bus type.&n;&t;&t;&t; */
r_if
c_cond
(paren
id|iop
op_eq
l_int|0
)paren
(brace
r_break
suffix:semicolon
)brace
multiline_comment|/*&n;&t;&t;&t; * Adapter found.&n;&t;&t;&t; *&n;&t;&t;&t; * Register the adapter, get its configuration, and&n;&t;&t;&t; * initialize it.&n;&t;&t;&t; */
id|ASC_DBG
c_func
(paren
l_int|2
comma
l_string|&quot;advansys_detect: scsi_register()&bslash;n&quot;
)paren
suffix:semicolon
id|shp
op_assign
id|scsi_register
c_func
(paren
id|tpnt
comma
r_sizeof
(paren
r_struct
id|asc_board
)paren
)paren
suffix:semicolon
multiline_comment|/* Save a pointer to the Scsi_host of each board found. */
id|asc_host
(braket
id|asc_board_count
op_increment
)braket
op_assign
id|shp
suffix:semicolon
multiline_comment|/* Initialize private per board data */
id|boardp
op_assign
id|ASC_BOARDP
c_func
(paren
id|shp
)paren
suffix:semicolon
id|memset
c_func
(paren
id|boardp
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|asc_board
)paren
)paren
suffix:semicolon
id|boardp-&gt;id
op_assign
id|asc_board_count
op_minus
l_int|1
suffix:semicolon
id|asc_dvc_varp
op_assign
op_amp
id|boardp-&gt;asc_dvc_var
suffix:semicolon
id|asc_dvc_varp-&gt;cfg
op_assign
op_amp
id|boardp-&gt;asc_dvc_cfg
suffix:semicolon
id|asc_dvc_varp-&gt;cfg-&gt;overrun_buf
op_assign
op_amp
id|overrun_buf
(braket
l_int|0
)braket
suffix:semicolon
id|asc_dvc_varp-&gt;iop_base
op_assign
id|iop
suffix:semicolon
macro_line|#if LINUX_VERSION_CODE &gt;= ASC_LINUX_VERSION(1,3,0)
r_if
c_cond
(paren
(paren
id|boardp-&gt;prtbuf
op_assign
id|kmalloc
c_func
(paren
id|ASC_PRTBUF_SIZE
comma
id|GFP_ATOMIC
)paren
)paren
op_eq
l_int|NULL
)paren
(brace
id|ASC_PRINT3
c_func
(paren
l_string|&quot;advansys_detect: Board %d: kmalloc(%d, %d) returned NULL&bslash;n&quot;
comma
id|boardp-&gt;id
comma
id|ASC_PRTBUF_SIZE
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
id|scsi_unregister
c_func
(paren
id|shp
)paren
suffix:semicolon
id|asc_board_count
op_decrement
suffix:semicolon
r_continue
suffix:semicolon
)brace
macro_line|#endif /* version &gt;= v1.3.0 */
multiline_comment|/*&n;&t;&t;&t; * Set the board bus type and PCI IRQ for AscInitGetConfig().&n;&t;&t;&t; */
id|asc_dvc_varp-&gt;bus_type
op_assign
id|asc_bus
(braket
id|bus
)braket
suffix:semicolon
r_switch
c_cond
(paren
id|asc_dvc_varp-&gt;bus_type
)paren
(brace
r_case
id|ASC_IS_ISA
suffix:colon
id|shp-&gt;unchecked_isa_dma
op_assign
id|TRUE
suffix:semicolon
id|share_irq
op_assign
id|FALSE
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ASC_IS_VL
suffix:colon
id|shp-&gt;unchecked_isa_dma
op_assign
id|FALSE
suffix:semicolon
id|share_irq
op_assign
id|FALSE
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ASC_IS_EISA
suffix:colon
id|shp-&gt;unchecked_isa_dma
op_assign
id|FALSE
suffix:semicolon
id|share_irq
op_assign
id|TRUE
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ASC_IS_PCI
suffix:colon
id|shp-&gt;irq
op_assign
id|asc_dvc_varp-&gt;irq_no
op_assign
id|pciConfig.irqLine
suffix:semicolon
id|asc_dvc_varp-&gt;cfg-&gt;pci_device_id
op_assign
id|pciConfig.deviceID
suffix:semicolon
id|asc_dvc_varp-&gt;cfg-&gt;pci_slot_info
op_assign
id|ASC_PCI_MKID
c_func
(paren
id|pciDevice.busNumber
comma
id|pciDevice.slotFound
comma
id|pciDevice.devFunc
)paren
suffix:semicolon
id|shp-&gt;unchecked_isa_dma
op_assign
id|FALSE
suffix:semicolon
id|share_irq
op_assign
id|TRUE
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|ASC_PRINT2
c_func
(paren
l_string|&quot;advansys_detect: Board %d: unknown adapter type: %d&quot;
comma
id|boardp-&gt;id
comma
id|asc_dvc_varp-&gt;bus_type
)paren
suffix:semicolon
id|shp-&gt;unchecked_isa_dma
op_assign
id|TRUE
suffix:semicolon
id|share_irq
op_assign
id|FALSE
suffix:semicolon
r_break
suffix:semicolon
)brace
multiline_comment|/*&n;&t;&t;&t; * Get the board configuration.&n;&t;&t;&t; *&n;&t;&t;&t; * AscInitGetConfig() may change the board&squot;s bus_type value.&n;&t;&t;&t; * The asc_bus[bus] value should no longer be used. If the&n;&t;&t;&t; * bus_type field must be referenced only use the bit-wise&n;&t;&t;&t; * AND operator &quot;&amp;&quot;.&n;&t;&t;&t; */
id|ASC_DBG
c_func
(paren
l_int|2
comma
l_string|&quot;advansys_detect: AscInitGetConfig()&bslash;n&quot;
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|ret
op_assign
id|AscInitGetConfig
c_func
(paren
id|asc_dvc_varp
)paren
)paren
(brace
r_case
l_int|0
suffix:colon
multiline_comment|/* No error */
r_break
suffix:semicolon
r_case
id|ASC_WARN_IO_PORT_ROTATE
suffix:colon
id|ASC_PRINT1
c_func
(paren
l_string|&quot;AscInitGetConfig: Board: %d: I/O port address modified&bslash;n&quot;
comma
id|boardp-&gt;id
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ASC_WARN_AUTO_CONFIG
suffix:colon
id|ASC_PRINT1
c_func
(paren
l_string|&quot;AscInitGetConfig: Board %d: I/O port increment switch enabled&bslash;n&quot;
comma
id|boardp-&gt;id
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ASC_WARN_EEPROM_CHKSUM
suffix:colon
id|ASC_PRINT1
c_func
(paren
l_string|&quot;AscInitGetConfig: Board %d: EEPROM checksum error&bslash;n&quot;
comma
id|boardp-&gt;id
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ASC_WARN_IRQ_MODIFIED
suffix:colon
id|ASC_PRINT1
c_func
(paren
l_string|&quot;AscInitGetConfig: Board %d: IRQ modified&bslash;n&quot;
comma
id|boardp-&gt;id
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ASC_WARN_CMD_QNG_CONFLICT
suffix:colon
id|ASC_PRINT1
c_func
(paren
l_string|&quot;AscInitGetConfig: Board %d: tag queuing enabled w/o disconnects&bslash;n&quot;
comma
id|boardp-&gt;id
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|ASC_PRINT2
c_func
(paren
l_string|&quot;AscInitGetConfig: Board %d: unknown warning: %x&bslash;n&quot;
comma
id|boardp-&gt;id
comma
id|ret
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|asc_dvc_varp-&gt;err_code
op_ne
l_int|0
)paren
(brace
id|ASC_PRINT3
c_func
(paren
l_string|&quot;AscInitGetConfig: Board %d error: init_state %x, err_code %x&bslash;n&quot;
comma
id|boardp-&gt;id
comma
id|asc_dvc_varp-&gt;init_state
comma
id|asc_dvc_varp-&gt;err_code
)paren
suffix:semicolon
macro_line|#if LINUX_VERSION_CODE &gt;= ASC_LINUX_VERSION(1,3,0)
id|kfree
c_func
(paren
id|boardp-&gt;prtbuf
)paren
suffix:semicolon
macro_line|#endif /* version &gt;= v1.3.0 */
id|scsi_unregister
c_func
(paren
id|shp
)paren
suffix:semicolon
id|asc_board_count
op_decrement
suffix:semicolon
r_continue
suffix:semicolon
)brace
multiline_comment|/*&n;&t;&t;&t; * Set the adapter&squot;s target id bit in the init_tidmask field.&n;&t;&t;&t; */
id|boardp-&gt;init_tidmask
op_or_assign
id|ASC_TIX_TO_TARGET_ID
c_func
(paren
id|asc_dvc_varp-&gt;cfg-&gt;chip_scsi_id
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t;&t; * Save EEPROM settings for the board.&n;&t;&t;&t; */
id|boardp-&gt;eep_config.init_sdtr
op_assign
id|asc_dvc_varp-&gt;init_sdtr
suffix:semicolon
id|boardp-&gt;eep_config.disc_enable
op_assign
id|asc_dvc_varp-&gt;cfg-&gt;disc_enable
suffix:semicolon
id|boardp-&gt;eep_config.use_cmd_qng
op_assign
id|asc_dvc_varp-&gt;cfg-&gt;cmd_qng_enabled
suffix:semicolon
id|boardp-&gt;eep_config.isa_dma_speed
op_assign
id|asc_dvc_varp-&gt;cfg-&gt;isa_dma_speed
suffix:semicolon
id|boardp-&gt;eep_config.start_motor
op_assign
id|asc_dvc_varp-&gt;start_motor
suffix:semicolon
id|boardp-&gt;eep_config.cntl
op_assign
id|asc_dvc_varp-&gt;dvc_cntl
suffix:semicolon
id|boardp-&gt;eep_config.no_scam
op_assign
id|asc_dvc_varp-&gt;no_scam
suffix:semicolon
id|boardp-&gt;eep_config.max_total_qng
op_assign
id|asc_dvc_varp-&gt;max_total_qng
suffix:semicolon
id|boardp-&gt;eep_config.chip_scsi_id
op_assign
id|asc_dvc_varp-&gt;cfg-&gt;chip_scsi_id
suffix:semicolon
multiline_comment|/* &squot;max_tag_qng&squot; is set to the same value for every device. */
id|boardp-&gt;eep_config.max_tag_qng
op_assign
id|asc_dvc_varp-&gt;cfg-&gt;max_tag_qng
(braket
l_int|0
)braket
suffix:semicolon
multiline_comment|/*&n;&t;&t;&t; * Modify board configuration.&n;&t;&t;&t; */
id|asc_dvc_varp-&gt;isr_callback
op_assign
(paren
id|Ptr2Func
)paren
id|asc_isr_callback
suffix:semicolon
id|asc_dvc_varp-&gt;exe_callback
op_assign
(paren
id|Ptr2Func
)paren
l_int|NULL
suffix:semicolon
id|ASC_DBG
c_func
(paren
l_int|2
comma
l_string|&quot;advansys_detect: AscInitSetConfig()&bslash;n&quot;
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|ret
op_assign
id|AscInitSetConfig
c_func
(paren
id|asc_dvc_varp
)paren
)paren
(brace
r_case
l_int|0
suffix:colon
multiline_comment|/* No error. */
r_break
suffix:semicolon
r_case
id|ASC_WARN_IO_PORT_ROTATE
suffix:colon
id|ASC_PRINT1
c_func
(paren
l_string|&quot;AscInitSetConfig: Board %d: I/O port address modified&bslash;n&quot;
comma
id|boardp-&gt;id
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ASC_WARN_AUTO_CONFIG
suffix:colon
id|ASC_PRINT1
c_func
(paren
l_string|&quot;AscInitSetConfig: Board %d: I/O port increment switch enabled&bslash;n&quot;
comma
id|boardp-&gt;id
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ASC_WARN_EEPROM_CHKSUM
suffix:colon
id|ASC_PRINT1
c_func
(paren
l_string|&quot;AscInitSetConfig: Board %d: EEPROM checksum error&bslash;n&quot;
comma
id|boardp-&gt;id
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ASC_WARN_IRQ_MODIFIED
suffix:colon
id|ASC_PRINT1
c_func
(paren
l_string|&quot;AscInitSetConfig: Board %d: IRQ modified&bslash;n&quot;
comma
id|boardp-&gt;id
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ASC_WARN_CMD_QNG_CONFLICT
suffix:colon
id|ASC_PRINT1
c_func
(paren
l_string|&quot;AscInitSetConfig: Board %d: tag queuing w/o disconnects&bslash;n&quot;
comma
id|boardp-&gt;id
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|ASC_PRINT2
c_func
(paren
l_string|&quot;AscInitSetConfig: Board %d: unknown warning: %x&bslash;n&quot;
comma
id|boardp-&gt;id
comma
id|ret
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|asc_dvc_varp-&gt;err_code
op_ne
l_int|0
)paren
(brace
id|ASC_PRINT3
c_func
(paren
l_string|&quot;AscInitSetConfig: Board %d error: init_state %x, err_code %x&bslash;n&quot;
comma
id|boardp-&gt;id
comma
id|asc_dvc_varp-&gt;init_state
comma
id|asc_dvc_varp-&gt;err_code
)paren
suffix:semicolon
macro_line|#if LINUX_VERSION_CODE &gt;= ASC_LINUX_VERSION(1,3,0)
id|kfree
c_func
(paren
id|boardp-&gt;prtbuf
)paren
suffix:semicolon
macro_line|#endif /* version &gt;= v1.3.0 */
id|scsi_unregister
c_func
(paren
id|shp
)paren
suffix:semicolon
id|asc_board_count
op_decrement
suffix:semicolon
r_continue
suffix:semicolon
)brace
multiline_comment|/*&n;&t;&t;&t; * Finish initializing the &squot;Scsi_Host&squot; structure.&n;&t;&t;&t; */
multiline_comment|/* AscInitSetConfig() will set the IRQ for non-PCI boards. */
r_if
c_cond
(paren
id|asc_dvc_varp-&gt;bus_type
op_ne
id|ASC_IS_PCI
)paren
(brace
id|shp-&gt;irq
op_assign
id|asc_dvc_varp-&gt;irq_no
suffix:semicolon
)brace
id|shp-&gt;io_port
op_assign
id|asc_dvc_varp-&gt;iop_base
suffix:semicolon
id|shp-&gt;n_io_port
op_assign
id|ASC_IOADR_GAP
suffix:semicolon
id|shp-&gt;this_id
op_assign
id|asc_dvc_varp-&gt;cfg-&gt;chip_scsi_id
suffix:semicolon
multiline_comment|/* Maximum number of queues this adapter can handle. */
id|shp-&gt;can_queue
op_assign
id|asc_dvc_varp-&gt;max_total_qng
suffix:semicolon
macro_line|#if LINUX_VERSION_CODE &lt; ASC_LINUX_VERSION(1,3,89)
multiline_comment|/*&n;&t;&t;&t; * Set a conservative &squot;cmd_per_lun&squot; value to prevent memory&n;&t;&t;&t; * allocation failures.&n;&t;&t;&t; */
macro_line|#ifdef MODULE
id|shp-&gt;cmd_per_lun
op_assign
l_int|1
suffix:semicolon
macro_line|#else /* MODULE */
id|shp-&gt;cmd_per_lun
op_assign
l_int|4
suffix:semicolon
macro_line|#endif /* MODULE */
id|ASC_DBG1
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_detect: cmd_per_lun: %d&bslash;n&quot;
comma
id|shp-&gt;cmd_per_lun
)paren
suffix:semicolon
macro_line|#else /* version &gt;= v1.3.89 */
multiline_comment|/*&n;&t;&t;&t; * Use the host &squot;select_queue_depths&squot; function to determine&n;&t;&t;&t; * the number of commands to queue per device.&n;&t;&t;&t; */
id|shp-&gt;select_queue_depths
op_assign
id|advansys_select_queue_depths
suffix:semicolon
id|shp-&gt;cmd_per_lun
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* &squot;cmd_per_lun&squot; is no longer used. */
macro_line|#endif /* version &gt;= v1.3.89 */
multiline_comment|/*&n;&t;&t;&t; * Maximum number of scatter-gather elements adapter can handle.&n;&t;&t;&t; *&n;&t;&t;&t; * Set a conservative &squot;sg_tablesize&squot; value to prevent memory&n;&t;&t;&t; * allocation failures.&n;&t;&t;&t; */
macro_line|#ifdef MODULE
id|shp-&gt;sg_tablesize
op_assign
l_int|8
suffix:semicolon
macro_line|#else /* MODULE */
id|shp-&gt;sg_tablesize
op_assign
id|ASC_MAX_SG_LIST
suffix:semicolon
macro_line|#endif /* MODULE */
id|ASC_DBG1
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_detect: sg_tablesize: %d&bslash;n&quot;
comma
id|shp-&gt;sg_tablesize
)paren
suffix:semicolon
multiline_comment|/* BIOS start address. */
id|shp-&gt;base
op_assign
(paren
r_char
op_star
)paren
(paren
(paren
id|ulong
)paren
id|AscGetChipBiosAddress
c_func
(paren
id|asc_dvc_varp-&gt;iop_base
comma
id|asc_dvc_varp-&gt;bus_type
)paren
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t;&t; * Register Board Resources - I/O Port, DMA, IRQ&n;&t;&t;&t; */
multiline_comment|/* Register I/O port range */
id|ASC_DBG
c_func
(paren
l_int|2
comma
l_string|&quot;advansys_detect: request_region()&bslash;n&quot;
)paren
suffix:semicolon
id|request_region
c_func
(paren
id|shp-&gt;io_port
comma
id|shp-&gt;n_io_port
comma
l_string|&quot;advansys&quot;
)paren
suffix:semicolon
multiline_comment|/* Register DMA channel for ISA bus. */
r_if
c_cond
(paren
(paren
id|asc_dvc_varp-&gt;bus_type
op_amp
id|ASC_IS_ISA
)paren
op_eq
l_int|0
)paren
(brace
id|shp-&gt;dma_channel
op_assign
id|NO_ISA_DMA
suffix:semicolon
)brace
r_else
(brace
id|shp-&gt;dma_channel
op_assign
id|asc_dvc_varp-&gt;cfg-&gt;isa_dma_channel
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ret
op_assign
id|request_dma
c_func
(paren
id|shp-&gt;dma_channel
comma
l_string|&quot;advansys&quot;
)paren
)paren
op_ne
l_int|0
)paren
(brace
id|ASC_PRINT3
c_func
(paren
l_string|&quot;advansys_detect: Board %d: request_dma() %d failed %d&bslash;n&quot;
comma
id|boardp-&gt;id
comma
id|shp-&gt;dma_channel
comma
id|ret
)paren
suffix:semicolon
id|release_region
c_func
(paren
id|shp-&gt;io_port
comma
id|shp-&gt;n_io_port
)paren
suffix:semicolon
macro_line|#if LINUX_VERSION_CODE &gt;= ASC_LINUX_VERSION(1,3,0)
id|kfree
c_func
(paren
id|boardp-&gt;prtbuf
)paren
suffix:semicolon
macro_line|#endif /* version &gt;= v1.3.0 */
id|scsi_unregister
c_func
(paren
id|shp
)paren
suffix:semicolon
id|asc_board_count
op_decrement
suffix:semicolon
r_continue
suffix:semicolon
)brace
id|AscEnableIsaDma
c_func
(paren
id|shp-&gt;dma_channel
)paren
suffix:semicolon
)brace
multiline_comment|/* Register IRQ Number. */
id|ASC_DBG1
c_func
(paren
l_int|2
comma
l_string|&quot;advansys_detect: request_irq() %d&bslash;n&quot;
comma
id|shp-&gt;irq
)paren
suffix:semicolon
macro_line|#if LINUX_VERSION_CODE &lt; ASC_LINUX_VERSION(1,3,70)
r_if
c_cond
(paren
(paren
id|ret
op_assign
id|request_irq
c_func
(paren
id|shp-&gt;irq
comma
id|advansys_interrupt
comma
id|SA_INTERRUPT
comma
l_string|&quot;advansys&quot;
)paren
)paren
op_ne
l_int|0
)paren
(brace
macro_line|#else /* version &gt;= v1.3.70 */
r_if
c_cond
(paren
(paren
id|ret
op_assign
id|request_irq
c_func
(paren
id|shp-&gt;irq
comma
id|advansys_interrupt
comma
id|SA_INTERRUPT
op_or
(paren
id|share_irq
op_eq
id|TRUE
ques
c_cond
id|SA_SHIRQ
suffix:colon
l_int|0
)paren
comma
l_string|&quot;advansys&quot;
comma
id|boardp
)paren
)paren
op_ne
l_int|0
)paren
(brace
macro_line|#endif /* version &gt;= v1.3.70 */
id|ASC_PRINT2
c_func
(paren
l_string|&quot;advansys_detect: Board %d: request_irq() failed %d&bslash;n&quot;
comma
id|boardp-&gt;id
comma
id|ret
)paren
suffix:semicolon
id|release_region
c_func
(paren
id|shp-&gt;io_port
comma
id|shp-&gt;n_io_port
)paren
suffix:semicolon
r_if
c_cond
(paren
id|shp-&gt;dma_channel
op_ne
id|NO_ISA_DMA
)paren
(brace
id|free_dma
c_func
(paren
id|shp-&gt;dma_channel
)paren
suffix:semicolon
)brace
macro_line|#if LINUX_VERSION_CODE &gt;= ASC_LINUX_VERSION(1,3,0)
id|kfree
c_func
(paren
id|boardp-&gt;prtbuf
)paren
suffix:semicolon
macro_line|#endif /* version &gt;= v1.3.0 */
id|scsi_unregister
c_func
(paren
id|shp
)paren
suffix:semicolon
id|asc_board_count
op_decrement
suffix:semicolon
r_continue
suffix:semicolon
)brace
multiline_comment|/*&n;&t;&t;&t; * Initialize board RISC chip and enable interrupts.&n;&t;&t;&t; */
id|ASC_DBG
c_func
(paren
l_int|2
comma
l_string|&quot;advansys_detect: AscInitAsc1000Driver()&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|AscInitAsc1000Driver
c_func
(paren
id|asc_dvc_varp
)paren
)paren
(brace
id|ASC_PRINT3
c_func
(paren
l_string|&quot;AscInitAsc1000Driver: Board %d error: init_state %x, err_code %x&bslash;n&quot;
comma
id|boardp-&gt;id
comma
id|asc_dvc_varp-&gt;init_state
comma
id|asc_dvc_varp-&gt;err_code
)paren
suffix:semicolon
id|release_region
c_func
(paren
id|shp-&gt;io_port
comma
id|shp-&gt;n_io_port
)paren
suffix:semicolon
r_if
c_cond
(paren
id|shp-&gt;dma_channel
op_ne
id|NO_ISA_DMA
)paren
(brace
id|free_dma
c_func
(paren
id|shp-&gt;dma_channel
)paren
suffix:semicolon
)brace
macro_line|#if LINUX_VERSION_CODE &gt;= ASC_LINUX_VERSION(1,3,0)
id|kfree
c_func
(paren
id|boardp-&gt;prtbuf
)paren
suffix:semicolon
macro_line|#endif /* version &gt;= v1.3.0 */
macro_line|#if LINUX_VERSION_CODE &lt; ASC_LINUX_VERSION(1,3,70)
id|free_irq
c_func
(paren
id|shp-&gt;irq
)paren
suffix:semicolon
macro_line|#else /* version &gt;= v1.3.70 */
id|free_irq
c_func
(paren
id|shp-&gt;irq
comma
id|boardp
)paren
suffix:semicolon
macro_line|#endif /* version &gt;= v1.3.70 */
id|scsi_unregister
c_func
(paren
id|shp
)paren
suffix:semicolon
id|asc_board_count
op_decrement
suffix:semicolon
r_continue
suffix:semicolon
)brace
id|ASC_DBG_PRT_SCSI_HOST
c_func
(paren
l_int|2
comma
id|shp
)paren
suffix:semicolon
)brace
)brace
id|ASC_DBG1
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_detect: done: asc_board_count %d&bslash;n&quot;
comma
id|asc_board_count
)paren
suffix:semicolon
r_return
id|asc_board_count
suffix:semicolon
)brace
multiline_comment|/*&n; * advansys_release()&n; *&n; * Release resources allocated for a single AdvanSys adapter.&n; */
r_int
DECL|function|advansys_release
id|advansys_release
c_func
(paren
r_struct
id|Scsi_Host
op_star
id|shp
)paren
(brace
r_struct
id|asc_board
op_star
id|boardp
suffix:semicolon
id|ASC_DBG
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_release: begin&bslash;n&quot;
)paren
suffix:semicolon
id|boardp
op_assign
id|ASC_BOARDP
c_func
(paren
id|shp
)paren
suffix:semicolon
macro_line|#if LINUX_VERSION_CODE &lt; ASC_LINUX_VERSION(1,3,70)
id|free_irq
c_func
(paren
id|shp-&gt;irq
)paren
suffix:semicolon
macro_line|#else /* version &gt;= v1.3.70 */
id|free_irq
c_func
(paren
id|shp-&gt;irq
comma
id|boardp
)paren
suffix:semicolon
macro_line|#endif /* version &gt;= v1.3.70 */
r_if
c_cond
(paren
id|shp-&gt;dma_channel
op_ne
id|NO_ISA_DMA
)paren
(brace
id|ASC_DBG
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_release: free_dma()&bslash;n&quot;
)paren
suffix:semicolon
id|free_dma
c_func
(paren
id|shp-&gt;dma_channel
)paren
suffix:semicolon
)brace
id|release_region
c_func
(paren
id|shp-&gt;io_port
comma
id|shp-&gt;n_io_port
)paren
suffix:semicolon
macro_line|#if LINUX_VERSION_CODE &gt;= ASC_LINUX_VERSION(1,3,0)
id|ASC_ASSERT
c_func
(paren
id|boardp-&gt;prtbuf
op_ne
l_int|NULL
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|boardp-&gt;prtbuf
)paren
suffix:semicolon
macro_line|#endif /* version &gt;= v1.3.0 */
id|scsi_unregister
c_func
(paren
id|shp
)paren
suffix:semicolon
id|ASC_DBG
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_release: end&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * advansys_info()&n; *&n; * Return suitable for printing on the console with the argument&n; * adapter&squot;s configuration information.&n; *&n; * Note: The information line should not exceed ASC_INFO_SIZE bytes,&n; * otherwise the static &squot;info&squot; array will be overrun.&n; */
r_const
r_char
op_star
DECL|function|advansys_info
id|advansys_info
c_func
(paren
r_struct
id|Scsi_Host
op_star
id|shp
)paren
(brace
r_static
r_char
id|info
(braket
id|ASC_INFO_SIZE
)braket
suffix:semicolon
r_struct
id|asc_board
op_star
id|boardp
suffix:semicolon
id|ASC_DVC_VAR
op_star
id|asc_dvc_varp
suffix:semicolon
r_char
op_star
id|busname
suffix:semicolon
id|boardp
op_assign
id|ASC_BOARDP
c_func
(paren
id|shp
)paren
suffix:semicolon
id|asc_dvc_varp
op_assign
op_amp
id|boardp-&gt;asc_dvc_var
suffix:semicolon
id|ASC_DBG
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_info: begin&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|asc_dvc_varp-&gt;bus_type
op_amp
id|ASC_IS_ISA
)paren
(brace
id|sprintf
c_func
(paren
id|info
comma
l_string|&quot;AdvanSys SCSI %s: ISA (%u CDB): BIOS %X, IO %X-%X, IRQ %u, DMA %u&quot;
comma
id|ASC_VERSION
comma
id|boardp-&gt;asc_dvc_var.max_total_qng
comma
(paren
r_int
)paren
id|shp-&gt;base
comma
id|shp-&gt;io_port
comma
id|shp-&gt;io_port
op_plus
(paren
id|shp-&gt;n_io_port
op_minus
l_int|1
)paren
comma
id|shp-&gt;irq
comma
id|shp-&gt;dma_channel
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|asc_dvc_varp-&gt;bus_type
op_amp
id|ASC_IS_VL
)paren
(brace
id|busname
op_assign
l_string|&quot;VL&quot;
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|asc_dvc_varp-&gt;bus_type
op_amp
id|ASC_IS_EISA
)paren
(brace
id|busname
op_assign
l_string|&quot;EISA&quot;
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|asc_dvc_varp-&gt;bus_type
op_amp
id|ASC_IS_PCI
)paren
(brace
id|busname
op_assign
l_string|&quot;PCI&quot;
suffix:semicolon
)brace
r_else
(brace
id|busname
op_assign
l_string|&quot;?&quot;
suffix:semicolon
id|ASC_PRINT2
c_func
(paren
l_string|&quot;advansys_info: Board %d: unknown bus type %d&bslash;n&quot;
comma
id|boardp-&gt;id
comma
id|asc_dvc_varp-&gt;bus_type
)paren
suffix:semicolon
)brace
multiline_comment|/* No DMA channel for non-ISA busses. */
id|sprintf
c_func
(paren
id|info
comma
l_string|&quot;AdvanSys SCSI %s: %s (%u CDB): BIOS %X, IO %X-%X, IRQ %u&quot;
comma
id|ASC_VERSION
comma
id|busname
comma
id|boardp-&gt;asc_dvc_var.max_total_qng
comma
(paren
r_int
)paren
id|shp-&gt;base
comma
id|shp-&gt;io_port
comma
id|shp-&gt;io_port
op_plus
(paren
id|shp-&gt;n_io_port
op_minus
l_int|1
)paren
comma
id|shp-&gt;irq
)paren
suffix:semicolon
)brace
macro_line|#ifdef ADVANSYS_DEBUG
id|ASC_ASSERT
c_func
(paren
id|strlen
c_func
(paren
id|info
)paren
OL
id|ASC_INFO_SIZE
)paren
suffix:semicolon
macro_line|#endif /* ADVANSYS_DEBUG */
id|ASC_DBG
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_info: end&bslash;n&quot;
)paren
suffix:semicolon
r_return
id|info
suffix:semicolon
)brace
multiline_comment|/*&n; * advansys_command()&n; *&n; * Polled-I/O. Apparently host drivers shouldn&squot;t return until&n; * command is finished.&n; *&n; * XXX - Can host drivers block here instead of spinning on command status?&n; */
r_int
DECL|function|advansys_command
id|advansys_command
c_func
(paren
id|Scsi_Cmnd
op_star
id|scp
)paren
(brace
id|ASC_DBG1
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_command: scp %x&bslash;n&quot;
comma
(paren
r_int
)paren
id|scp
)paren
suffix:semicolon
id|ASC_STATS
c_func
(paren
id|scp-&gt;host
comma
id|command
)paren
suffix:semicolon
id|scp-&gt;SCp.Status
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* Set to a known state */
id|advansys_queuecommand
c_func
(paren
id|scp
comma
id|advansys_command_done
)paren
suffix:semicolon
r_while
c_loop
(paren
id|scp-&gt;SCp.Status
op_eq
l_int|0
)paren
(brace
r_continue
suffix:semicolon
)brace
id|ASC_DBG1
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_command: result %x&bslash;n&quot;
comma
id|scp-&gt;result
)paren
suffix:semicolon
r_return
id|scp-&gt;result
suffix:semicolon
)brace
multiline_comment|/*&n; * advansys_queuecommand()&n; *&n; * This function always returns 0. Command return status is saved&n; * in the &squot;scp&squot; result field.&n; */
r_int
DECL|function|advansys_queuecommand
id|advansys_queuecommand
c_func
(paren
id|Scsi_Cmnd
op_star
id|scp
comma
r_void
(paren
op_star
id|done
)paren
(paren
id|Scsi_Cmnd
op_star
)paren
)paren
(brace
r_struct
id|Scsi_Host
op_star
id|shp
suffix:semicolon
r_struct
id|asc_board
op_star
id|boardp
suffix:semicolon
r_int
id|flags
op_assign
l_int|0
suffix:semicolon
r_int
id|interrupts_disabled
suffix:semicolon
id|shp
op_assign
id|scp-&gt;host
suffix:semicolon
id|boardp
op_assign
id|ASC_BOARDP
c_func
(paren
id|shp
)paren
suffix:semicolon
id|ASC_STATS
c_func
(paren
id|shp
comma
id|queuecommand
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * If there are any pending commands for this board before trying&n;&t; * to execute them, disable interrupts to preserve request ordering.&n;&t; *&n;&t; * The typical case will be no pending commands and interrupts&n;&t; * not disabled.&n;&t; */
r_if
c_cond
(paren
id|boardp-&gt;pending.tidmask
op_eq
l_int|0
)paren
(brace
id|interrupts_disabled
op_assign
id|ASC_FALSE
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* Disable interrupts */
id|interrupts_disabled
op_assign
id|ASC_TRUE
suffix:semicolon
id|save_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
id|cli
c_func
(paren
)paren
suffix:semicolon
id|ASC_DBG1
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_queuecommand: asc_execute_queue() %x&bslash;n&quot;
comma
id|boardp-&gt;pending.tidmask
)paren
suffix:semicolon
id|asc_execute_queue
c_func
(paren
op_amp
id|boardp-&gt;pending
)paren
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * Save the function pointer to Linux mid-level &squot;done&squot; function and&n;&t; * execute the command.&n;&t; */
id|scp-&gt;scsi_done
op_assign
id|done
suffix:semicolon
r_if
c_cond
(paren
id|asc_execute_scsi_cmnd
c_func
(paren
id|scp
)paren
op_eq
id|ASC_BUSY
)paren
(brace
r_if
c_cond
(paren
id|interrupts_disabled
op_eq
id|ASC_FALSE
)paren
(brace
id|save_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
id|cli
c_func
(paren
)paren
suffix:semicolon
id|interrupts_disabled
op_assign
id|ASC_TRUE
suffix:semicolon
)brace
id|asc_enqueue
c_func
(paren
op_amp
id|boardp-&gt;pending
comma
id|scp
comma
id|ASC_BACK
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|interrupts_disabled
op_eq
id|ASC_TRUE
)paren
(brace
id|restore_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * advansys_abort()&n; *&n; * Abort the command specified by &squot;scp&squot;.&n; */
r_int
DECL|function|advansys_abort
id|advansys_abort
c_func
(paren
id|Scsi_Cmnd
op_star
id|scp
)paren
(brace
r_struct
id|asc_board
op_star
id|boardp
suffix:semicolon
id|ASC_DVC_VAR
op_star
id|asc_dvc_varp
suffix:semicolon
r_int
id|flags
suffix:semicolon
r_int
m_abort
suffix:semicolon
r_int
id|ret
suffix:semicolon
id|ASC_DBG1
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_abort: scp %x&bslash;n&quot;
comma
(paren
r_int
)paren
id|scp
)paren
suffix:semicolon
id|ASC_STATS
c_func
(paren
id|scp-&gt;host
comma
m_abort
)paren
suffix:semicolon
multiline_comment|/* Save current flags and disable interrupts. */
id|save_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
id|cli
c_func
(paren
)paren
suffix:semicolon
macro_line|#if LINUX_VERSION_CODE &gt;= ASC_LINUX_VERSION(1,3,89)
r_if
c_cond
(paren
id|scp-&gt;serial_number
op_ne
id|scp-&gt;serial_number_at_timeout
)paren
(brace
id|ret
op_assign
id|SCSI_ABORT_NOT_RUNNING
suffix:semicolon
)brace
r_else
macro_line|#endif /* version &gt;= v1.3.89 */
r_if
c_cond
(paren
id|scp-&gt;host
op_eq
l_int|NULL
)paren
(brace
id|scp-&gt;result
op_assign
id|HOST_BYTE
c_func
(paren
id|DID_ERROR
)paren
suffix:semicolon
id|ret
op_assign
id|SCSI_ABORT_ERROR
suffix:semicolon
)brace
r_else
(brace
id|boardp
op_assign
id|ASC_BOARDP
c_func
(paren
id|scp-&gt;host
)paren
suffix:semicolon
r_if
c_cond
(paren
id|asc_rmqueue
c_func
(paren
op_amp
id|boardp-&gt;pending
comma
id|scp
)paren
op_eq
id|ASC_TRUE
)paren
(brace
multiline_comment|/*&n;&t;&t; &t; * If asc_rmqueue() found the command on the pending&n;&t;&t;&t; * queue, it had not been sent to the Asc Library.&n;&t;&t;&t; * After the queue is removed, no other handling is required.&n;&t;&t; &t; */
id|scp-&gt;result
op_assign
id|HOST_BYTE
c_func
(paren
id|DID_ABORT
)paren
suffix:semicolon
id|ret
op_assign
id|SCSI_ABORT_SUCCESS
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|asc_isqueued
c_func
(paren
op_amp
id|boardp-&gt;active
comma
id|scp
)paren
op_eq
id|ASC_TRUE
)paren
(brace
multiline_comment|/*&n;&t;&t; &t; * If asc_isqueued() found the command on the active&n;&t;&t;&t; * queue, it has been sent to the Asc Library. The&n;&t;&t;&t; * command should be returned through the interrupt&n;&t;&t;&t; * handler after calling AscAbortSRB().&n;&t;&t; &t; */
id|asc_dvc_varp
op_assign
op_amp
id|boardp-&gt;asc_dvc_var
suffix:semicolon
id|scp-&gt;result
op_assign
id|HOST_BYTE
c_func
(paren
id|DID_ABORT
)paren
suffix:semicolon
multiline_comment|/* Must enable interrupts for AscAbortSRB() */
id|sti
c_func
(paren
)paren
suffix:semicolon
r_switch
c_cond
(paren
m_abort
op_assign
id|AscAbortSRB
c_func
(paren
id|asc_dvc_varp
comma
(paren
id|ulong
)paren
id|scp
)paren
)paren
(brace
r_case
id|ASC_TRUE
suffix:colon
multiline_comment|/* asc_isr_callback() will be called */
id|ASC_DBG
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_abort: AscAbortSRB() TRUE&bslash;n&quot;
)paren
suffix:semicolon
id|ret
op_assign
id|SCSI_ABORT_PENDING
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ASC_FALSE
suffix:colon
multiline_comment|/* Request has apparently already completed. */
id|ASC_DBG
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_abort: AscAbortSRB() FALSE&bslash;n&quot;
)paren
suffix:semicolon
id|ret
op_assign
id|SCSI_ABORT_NOT_RUNNING
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ASC_ERROR
suffix:colon
r_default
suffix:colon
id|ASC_DBG
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_abort: AscAbortSRB() ERROR&bslash;n&quot;
)paren
suffix:semicolon
id|ret
op_assign
id|SCSI_ABORT_ERROR
suffix:semicolon
r_break
suffix:semicolon
)brace
id|cli
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t;&t; * If the abort failed, remove the request from the&n;&t;&t;&t; * active list and complete it.&n;&t;&t;&t; */
r_if
c_cond
(paren
m_abort
op_ne
id|ASC_TRUE
)paren
(brace
r_if
c_cond
(paren
id|asc_rmqueue
c_func
(paren
op_amp
id|boardp-&gt;active
comma
id|scp
)paren
op_eq
id|ASC_TRUE
)paren
(brace
id|scp-&gt;result
op_assign
id|HOST_BYTE
c_func
(paren
id|DID_ABORT
)paren
suffix:semicolon
id|scp
op_member_access_from_pointer
id|scsi_done
c_func
(paren
id|scp
)paren
suffix:semicolon
)brace
)brace
)brace
r_else
(brace
multiline_comment|/*&n;&t;&t;&t; * The command was not found on the active or pending queues.&n;&t;&t;&t; */
id|ret
op_assign
id|SCSI_ABORT_NOT_RUNNING
suffix:semicolon
)brace
)brace
id|restore_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
id|ASC_DBG1
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_abort: ret %d&bslash;n&quot;
comma
id|ret
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
multiline_comment|/*&n; * advansys_reset()&n; *&n; * Reset the device associated with the command &squot;scp&squot;.&n; */
r_int
macro_line|#if LINUX_VERSION_CODE &lt; ASC_LINUX_VERSION(1,3,89)
DECL|function|advansys_reset
id|advansys_reset
c_func
(paren
id|Scsi_Cmnd
op_star
id|scp
)paren
macro_line|#else /* version &gt;= v1.3.89 */
id|advansys_reset
c_func
(paren
id|Scsi_Cmnd
op_star
id|scp
comma
r_int
r_int
id|reset_flags
)paren
macro_line|#endif /* version &gt;= v1.3.89 */
(brace
r_struct
id|asc_board
op_star
id|boardp
suffix:semicolon
id|ASC_DVC_VAR
op_star
id|asc_dvc_varp
suffix:semicolon
r_int
id|flags
suffix:semicolon
id|Scsi_Cmnd
op_star
id|tscp
suffix:semicolon
macro_line|#if LINUX_VERSION_CODE &gt;= ASC_LINUX_VERSION(1,3,89)
r_int
id|scp_found
op_assign
id|ASC_FALSE
suffix:semicolon
macro_line|#endif /* version &gt;= v1.3.89 */
r_int
id|i
suffix:semicolon
r_int
id|ret
suffix:semicolon
id|ASC_DBG1
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_reset: %x&bslash;n&quot;
comma
(paren
r_int
)paren
id|scp
)paren
suffix:semicolon
id|ASC_STATS
c_func
(paren
id|scp-&gt;host
comma
id|reset
)paren
suffix:semicolon
multiline_comment|/* Save current flags and disable interrupts. */
id|save_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
id|cli
c_func
(paren
)paren
suffix:semicolon
macro_line|#if LINUX_VERSION_CODE &gt;= ASC_LINUX_VERSION(1,3,89)
r_if
c_cond
(paren
id|scp-&gt;serial_number
op_ne
id|scp-&gt;serial_number_at_timeout
)paren
(brace
id|ret
op_assign
id|SCSI_RESET_NOT_RUNNING
suffix:semicolon
)brace
r_else
macro_line|#endif /* version &gt;= v1.3.89 */
r_if
c_cond
(paren
id|scp-&gt;host
op_eq
l_int|NULL
)paren
(brace
id|scp-&gt;result
op_assign
id|HOST_BYTE
c_func
(paren
id|DID_ERROR
)paren
suffix:semicolon
id|ret
op_assign
id|SCSI_RESET_ERROR
suffix:semicolon
)brace
r_else
(brace
id|boardp
op_assign
id|ASC_BOARDP
c_func
(paren
id|scp-&gt;host
)paren
suffix:semicolon
macro_line|#if LINUX_VERSION_CODE &gt;= ASC_LINUX_VERSION(1,3,89)
multiline_comment|/*&n;&t; &t; * If the request is on the target pending or active queue,&n;&t;&t; * note that it was found.&n;&t;&t; */
r_if
c_cond
(paren
(paren
id|asc_isqueued
c_func
(paren
op_amp
id|boardp-&gt;pending
comma
id|scp
)paren
op_eq
id|ASC_TRUE
)paren
op_logical_or
(paren
id|asc_isqueued
c_func
(paren
op_amp
id|boardp-&gt;active
comma
id|scp
)paren
op_eq
id|ASC_TRUE
)paren
)paren
(brace
id|scp_found
op_assign
id|ASC_TRUE
suffix:semicolon
)brace
macro_line|#endif /* version &gt;= v1.3.89 */
multiline_comment|/*&n;&t;&t; * If the suggest reset bus flags are set, reset the bus.&n;&t;&t; * Otherwise only reset the device.&n;&t;&t; */
id|asc_dvc_varp
op_assign
op_amp
id|boardp-&gt;asc_dvc_var
suffix:semicolon
macro_line|#if LINUX_VERSION_CODE &gt;= ASC_LINUX_VERSION(1,3,89)
r_if
c_cond
(paren
id|reset_flags
op_amp
(paren
id|SCSI_RESET_SUGGEST_BUS_RESET
op_or
id|SCSI_RESET_SUGGEST_HOST_RESET
)paren
)paren
(brace
macro_line|#endif /* version &gt;= v1.3.89 */
multiline_comment|/*&n;&t;&t;&t; * Done all pending requests for all targets with DID_RESET.&n;&t;&t;&t; */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
id|ASC_MAX_TID
suffix:semicolon
id|i
op_increment
)paren
(brace
r_while
c_loop
(paren
(paren
id|tscp
op_assign
id|asc_dequeue
c_func
(paren
op_amp
id|boardp-&gt;pending
comma
id|i
)paren
)paren
op_ne
l_int|NULL
)paren
(brace
id|tscp-&gt;result
op_assign
id|HOST_BYTE
c_func
(paren
id|DID_RESET
)paren
suffix:semicolon
id|tscp
op_member_access_from_pointer
id|scsi_done
c_func
(paren
id|tscp
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/*&n;&t;&t;&t; * Reset the target&squot;s SCSI bus.&n;&t;&t;&t; */
id|sti
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* Enable interrupts for AscResetSB(). */
r_switch
c_cond
(paren
id|AscResetSB
c_func
(paren
id|asc_dvc_varp
)paren
)paren
(brace
r_case
id|ASC_TRUE
suffix:colon
id|ASC_DBG
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_reset: AscResetSB() TRUE&bslash;n&quot;
)paren
suffix:semicolon
id|ret
op_assign
id|SCSI_RESET_SUCCESS
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ASC_ERROR
suffix:colon
r_default
suffix:colon
id|ASC_DBG
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_reset: AscResetSB() ERROR&bslash;n&quot;
)paren
suffix:semicolon
id|ret
op_assign
id|SCSI_RESET_ERROR
suffix:semicolon
r_break
suffix:semicolon
)brace
id|cli
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t;&t; * Done all active requests for all targets with DID_RESET.&n;&t;&t;&t; */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
id|ASC_MAX_TID
suffix:semicolon
id|i
op_increment
)paren
(brace
r_while
c_loop
(paren
(paren
id|tscp
op_assign
id|asc_dequeue
c_func
(paren
op_amp
id|boardp-&gt;active
comma
id|i
)paren
)paren
op_ne
l_int|NULL
)paren
(brace
id|tscp-&gt;result
op_assign
id|HOST_BYTE
c_func
(paren
id|DID_RESET
)paren
suffix:semicolon
id|tscp
op_member_access_from_pointer
id|scsi_done
c_func
(paren
id|tscp
)paren
suffix:semicolon
)brace
)brace
macro_line|#if LINUX_VERSION_CODE &gt;= ASC_LINUX_VERSION(1,3,89)
)brace
r_else
(brace
multiline_comment|/*&n;&t;&t;&t; * Done all pending requests for the target with DID_RESET.&n;&t;&t;&t; */
r_while
c_loop
(paren
(paren
id|tscp
op_assign
id|asc_dequeue
c_func
(paren
op_amp
id|boardp-&gt;pending
comma
id|scp-&gt;target
)paren
)paren
op_ne
l_int|NULL
)paren
(brace
id|tscp-&gt;result
op_assign
id|HOST_BYTE
c_func
(paren
id|DID_RESET
)paren
suffix:semicolon
id|tscp
op_member_access_from_pointer
id|scsi_done
c_func
(paren
id|tscp
)paren
suffix:semicolon
)brace
id|sti
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* Enabled interrupts for AscResetDevice(). */
id|ASC_DBG
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_reset: AscResetDevice()&bslash;n&quot;
)paren
suffix:semicolon
(paren
r_void
)paren
id|AscResetDevice
c_func
(paren
id|asc_dvc_varp
comma
id|scp-&gt;target
)paren
suffix:semicolon
id|cli
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t;&t; * Done all active requests for the target with DID_RESET.&n;&t;&t;&t; */
r_while
c_loop
(paren
(paren
id|tscp
op_assign
id|asc_dequeue
c_func
(paren
op_amp
id|boardp-&gt;active
comma
id|scp-&gt;target
)paren
)paren
op_ne
l_int|NULL
)paren
(brace
id|tscp-&gt;result
op_assign
id|HOST_BYTE
c_func
(paren
id|DID_RESET
)paren
suffix:semicolon
id|tscp
op_member_access_from_pointer
id|scsi_done
c_func
(paren
id|tscp
)paren
suffix:semicolon
)brace
)brace
macro_line|#endif /* version &gt;= v1.3.89 */
macro_line|#if LINUX_VERSION_CODE &gt;= ASC_LINUX_VERSION(1,3,89)
multiline_comment|/*&n;&t;&t; * If the command was not on the active or pending request&n;&t;&t; * queues and the SCSI_RESET_SYNCHRONOUS flag is set, then&n;&t;&t; * done the command now. If the command had been on the&n;&t;&t; * active or pending request queues it would have already&n;&t;&t; * been completed.&n;&t;&t; */
r_if
c_cond
(paren
id|scp_found
op_eq
id|ASC_FALSE
op_logical_and
(paren
id|reset_flags
op_amp
id|SCSI_RESET_SYNCHRONOUS
)paren
)paren
(brace
id|scp-&gt;result
op_assign
id|HOST_BYTE
c_func
(paren
id|DID_RESET
)paren
suffix:semicolon
id|scp
op_member_access_from_pointer
id|scsi_done
c_func
(paren
id|tscp
)paren
suffix:semicolon
)brace
macro_line|#endif /* version &gt;= v1.3.89 */
id|ret
op_assign
id|SCSI_RESET_SUCCESS
suffix:semicolon
)brace
id|restore_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
id|ASC_DBG1
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_reset: ret %d&quot;
comma
id|ret
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
multiline_comment|/*&n; * advansys_biosparam()&n; *&n; * Translate disk drive geometry if the &quot;BIOS greater than 1 GB&quot;&n; * support is enabled for a drive.&n; *&n; * ip (information pointer) is an int array with the following definition:&n; * ip[0]: heads&n; * ip[1]: sectors&n; * ip[2]: cylinders&n; */
r_int
macro_line|#if LINUX_VERSION_CODE &lt; ASC_LINUX_VERSION(1,3,0)
DECL|function|advansys_biosparam
id|advansys_biosparam
c_func
(paren
id|Disk
op_star
id|dp
comma
r_int
id|dep
comma
r_int
id|ip
(braket
)braket
)paren
macro_line|#else /* version &gt;= v1.3.0 */
id|advansys_biosparam
c_func
(paren
id|Disk
op_star
id|dp
comma
id|kdev_t
id|dep
comma
r_int
id|ip
(braket
)braket
)paren
macro_line|#endif /* version &gt;= v1.3.0 */
(brace
id|ASC_DBG
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_biosparam: begin&bslash;n&quot;
)paren
suffix:semicolon
id|ASC_STATS
c_func
(paren
id|dp-&gt;device-&gt;host
comma
id|biosparam
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ASC_BOARDP
c_func
(paren
id|dp-&gt;device-&gt;host
)paren
op_member_access_from_pointer
id|asc_dvc_var.dvc_cntl
op_amp
id|ASC_CNTL_BIOS_GT_1GB
)paren
op_logical_and
id|dp-&gt;capacity
OG
l_int|0x200000
)paren
(brace
id|ip
(braket
l_int|0
)braket
op_assign
l_int|255
suffix:semicolon
id|ip
(braket
l_int|1
)braket
op_assign
l_int|63
suffix:semicolon
)brace
r_else
(brace
id|ip
(braket
l_int|0
)braket
op_assign
l_int|64
suffix:semicolon
id|ip
(braket
l_int|1
)braket
op_assign
l_int|32
suffix:semicolon
)brace
id|ip
(braket
l_int|2
)braket
op_assign
id|dp-&gt;capacity
op_div
(paren
id|ip
(braket
l_int|0
)braket
op_star
id|ip
(braket
l_int|1
)braket
)paren
suffix:semicolon
id|ASC_DBG
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_biosparam: end&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * advansys_setup()&n; *&n; * This function is called from init/main.c at boot time.&n; * It it passed LILO parameters that can be set from the&n; * LILO command line or in /etc/lilo.conf.&n; *&n; * It is used by the AdvanSys driver to either disable I/O&n; * port scanning or to limit scanning to 1 - 4 I/O ports.&n; * Regardless of the option setting EISA and PCI boards&n; * will still be searched for and detected. This option&n; * only affects searching for ISA and VL boards.&n; *&n; * If ADVANSYS_DEBUG is defined the driver debug level may&n; * be set using the 5th (ASC_NUM_BOARD_SUPPORTED + 1) I/O Port.&n; *&n; * Examples:&n; * 1. Eliminate I/O port scanning:&n; * &t;&t;boot: linux advansys=&n; *       or&n; * &t;&t;boot: linux advansys=0x0&n; * 2. Limit I/O port scanning to one I/O port:&n; *&t;&t;boot: linux advansys=0x110&n; * 3. Limit I/O port scanning to four I/O ports:&n; *&t;&t;boot: linux advansys=0x110,0x210,0x230,0x330&n; * 4. If ADVANSYS_DEBUG, limit I/O port scanning to four I/O ports and&n; *    set the driver debug level to 2.&n; *&t;&t;boot: linux advansys=0x110,0x210,0x230,0x330,0xdeb2&n; *&n; * ints[0] - number of arguments&n; * ints[1] - first argument&n; * ints[2] - second argument&n; * ...&n; */
r_void
DECL|function|advansys_setup
id|advansys_setup
c_func
(paren
r_char
op_star
id|str
comma
r_int
op_star
id|ints
)paren
(brace
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
id|asc_iopflag
op_eq
id|ASC_TRUE
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;AdvanSys SCSI: &squot;advansys&squot; LILO option may appear only once&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|asc_iopflag
op_assign
id|ASC_TRUE
suffix:semicolon
r_if
c_cond
(paren
id|ints
(braket
l_int|0
)braket
OG
id|ASC_NUM_BOARD_SUPPORTED
)paren
(brace
macro_line|#ifdef ADVANSYS_DEBUG
r_if
c_cond
(paren
(paren
id|ints
(braket
l_int|0
)braket
op_eq
id|ASC_NUM_BOARD_SUPPORTED
op_plus
l_int|1
)paren
op_logical_and
(paren
id|ints
(braket
id|ASC_NUM_BOARD_SUPPORTED
op_plus
l_int|1
)braket
op_rshift
l_int|4
op_eq
l_int|0xdeb
)paren
)paren
(brace
id|asc_dbglvl
op_assign
id|ints
(braket
id|ASC_NUM_BOARD_SUPPORTED
op_plus
l_int|1
)braket
op_amp
l_int|0xf
suffix:semicolon
)brace
r_else
(brace
macro_line|#endif /* ADVANSYS_DEBUG */
id|printk
c_func
(paren
l_string|&quot;AdvanSys SCSI: only %d I/O ports accepted&bslash;n&quot;
comma
id|ASC_NUM_BOARD_SUPPORTED
)paren
suffix:semicolon
macro_line|#ifdef ADVANSYS_DEBUG
)brace
macro_line|#endif /* ADVANSYS_DEBUG */
)brace
macro_line|#ifdef ADVANSYS_DEBUG
id|ASC_DBG1
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_setup: ints[0] %d&bslash;n&quot;
comma
id|ints
(braket
l_int|0
)braket
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|1
suffix:semicolon
id|i
OL
id|ints
(braket
l_int|0
)braket
suffix:semicolon
id|i
op_increment
)paren
(brace
id|ASC_DBG2
c_func
(paren
l_int|1
comma
l_string|&quot; ints[%d] %x&quot;
comma
id|i
comma
id|ints
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
id|ASC_DBG
c_func
(paren
l_int|1
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#endif /* ADVANSYS_DEBUG */
r_for
c_loop
(paren
id|i
op_assign
l_int|1
suffix:semicolon
id|i
op_le
id|ints
(braket
l_int|0
)braket
op_logical_and
id|i
op_le
id|ASC_NUM_BOARD_SUPPORTED
suffix:semicolon
id|i
op_increment
)paren
(brace
id|asc_ioport
(braket
id|i
op_minus
l_int|1
)braket
op_assign
id|ints
(braket
id|i
)braket
suffix:semicolon
id|ASC_DBG2
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_setup: asc_ioport[%d] %x&bslash;n&quot;
comma
id|i
op_minus
l_int|1
comma
id|asc_ioport
(braket
id|i
op_minus
l_int|1
)braket
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/*&n; * --- Loadable Driver Support&n; */
macro_line|#ifdef MODULE
DECL|variable|driver_template
id|Scsi_Host_Template
id|driver_template
op_assign
id|ADVANSYS
suffix:semicolon
macro_line|# include &quot;scsi_module.c&quot;
macro_line|#endif /* MODULE */
multiline_comment|/*&n; * --- Miscellaneous Driver Functions&n; */
multiline_comment|/*&n; * First-level interrupt handler.&n; *&n; * For versions &gt; v1.3.70, &squot;dev_id&squot; is a pointer to the interrupting&n; * adapter&squot;s struct asc_board. Because all boards are currently checked&n; * for interrupts on each interrupt, &squot;dev_id&squot; is not referenced. &squot;dev_id&squot;&n; * could be used to identify an interrupt passed to the AdvanSys driver&n; * but actually for a device sharing an interrupt with an AdvanSys adapter.&n; */
id|STATIC
r_void
macro_line|#if LINUX_VERSION_CODE &lt; ASC_LINUX_VERSION(1,3,70)
DECL|function|advansys_interrupt
id|advansys_interrupt
c_func
(paren
r_int
id|irq
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
macro_line|#else /* version &gt;= v1.3.70 */
id|advansys_interrupt
c_func
(paren
r_int
id|irq
comma
r_void
op_star
id|dev_id
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
macro_line|#endif /* version &gt;= v1.3.70 */
(brace
r_int
id|i
suffix:semicolon
r_int
id|flags
suffix:semicolon
id|Scsi_Cmnd
op_star
id|scp
suffix:semicolon
id|Scsi_Cmnd
op_star
id|tscp
suffix:semicolon
multiline_comment|/* Disable interrupts, if the aren&squot;t already disabled. */
id|save_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
id|cli
c_func
(paren
)paren
suffix:semicolon
id|ASC_DBG
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_interrupt: begin&bslash;n&quot;
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Check for interrupts on all boards.&n;&t; * AscISR() will call asc_isr_callback().&n;&t; */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|asc_board_count
suffix:semicolon
id|i
op_increment
)paren
(brace
id|ASC_STATS
c_func
(paren
id|asc_host
(braket
id|i
)braket
comma
id|check_interrupt
)paren
suffix:semicolon
r_while
c_loop
(paren
id|AscIsIntPending
c_func
(paren
id|asc_host
(braket
id|i
)braket
op_member_access_from_pointer
id|io_port
)paren
)paren
(brace
id|ASC_STATS
c_func
(paren
id|asc_host
(braket
id|i
)braket
comma
id|interrupt
)paren
suffix:semicolon
id|ASC_DBG
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_interrupt: before AscISR()&bslash;n&quot;
)paren
suffix:semicolon
id|AscISR
c_func
(paren
op_amp
id|ASC_BOARDP
c_func
(paren
id|asc_host
(braket
id|i
)braket
)paren
op_member_access_from_pointer
id|asc_dvc_var
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/*&n;&t; * While interrupts are still disabled save the list of requests that&n;&t; * need their done function called. After re-enabling interrupts call&n;&t; * the done function which may re-enable interrupts anyway.&n;&t; */
r_if
c_cond
(paren
(paren
id|scp
op_assign
id|asc_scsi_done
)paren
op_ne
l_int|NULL
)paren
(brace
id|asc_scsi_done
op_assign
l_int|NULL
suffix:semicolon
)brace
multiline_comment|/* Re-enable interrupts, if they were enabled on entry. */
id|restore_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
r_while
c_loop
(paren
id|scp
)paren
(brace
id|tscp
op_assign
(paren
id|Scsi_Cmnd
op_star
)paren
id|scp-&gt;host_scribble
suffix:semicolon
id|scp
op_member_access_from_pointer
id|scsi_done
c_func
(paren
id|scp
)paren
suffix:semicolon
id|scp
op_assign
id|tscp
suffix:semicolon
)brace
id|ASC_DBG
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_interrupt: end&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
macro_line|#if LINUX_VERSION_CODE &gt;= ASC_LINUX_VERSION(1,3,89)
multiline_comment|/*&n; * Set the number of commands to queue per device for the&n; * specified host adapter.&n; */
id|STATIC
r_void
DECL|function|advansys_select_queue_depths
id|advansys_select_queue_depths
c_func
(paren
r_struct
id|Scsi_Host
op_star
id|shp
comma
id|Scsi_Device
op_star
id|devicelist
)paren
(brace
id|Scsi_Device
op_star
id|device
suffix:semicolon
r_struct
id|asc_board
op_star
id|boardp
suffix:semicolon
id|boardp
op_assign
id|ASC_BOARDP
c_func
(paren
id|shp
)paren
suffix:semicolon
r_for
c_loop
(paren
id|device
op_assign
id|devicelist
suffix:semicolon
id|device
op_ne
l_int|NULL
suffix:semicolon
id|device
op_assign
id|device-&gt;next
)paren
(brace
r_if
c_cond
(paren
id|device-&gt;host
op_ne
id|shp
)paren
(brace
r_continue
suffix:semicolon
)brace
id|device-&gt;queue_depth
op_assign
id|boardp-&gt;asc_dvc_var.max_dvc_qng
(braket
id|device-&gt;id
)braket
suffix:semicolon
id|ASC_DBG3
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_select_queue_depths: shp %x, id %d, depth %d&bslash;n&quot;
comma
(paren
r_int
)paren
id|shp
comma
id|device-&gt;id
comma
id|device-&gt;queue_depth
)paren
suffix:semicolon
)brace
)brace
macro_line|#endif /* version &gt;= v1.3.89 */
multiline_comment|/*&n; * Function used only with polled I/O requests that are initiated by&n; * advansys_command().&n; */
id|STATIC
r_void
DECL|function|advansys_command_done
id|advansys_command_done
c_func
(paren
id|Scsi_Cmnd
op_star
id|scp
)paren
(brace
id|ASC_DBG1
c_func
(paren
l_int|1
comma
l_string|&quot;advansys_command_done: scp %x&bslash;n&quot;
comma
(paren
r_int
)paren
id|scp
)paren
suffix:semicolon
id|scp-&gt;SCp.Status
op_assign
l_int|1
suffix:semicolon
)brace
multiline_comment|/*&n; * Execute a single &squot;Scsi_Cmnd&squot;.&n; *&n; * The function &squot;done&squot; is called when the request has been completed.&n; *&n; * Scsi_Cmnd:&n; *&n; *  host - board controlling device&n; *  device - device to send command&n; *  target - target of device&n; *  lun - lun of device&n; *  cmd_len - length of SCSI CDB&n; *&t;cmnd - buffer for SCSI 8, 10, or 12 byte CDB&n; *  use_sg - if non-zero indicates scatter-gather request with use_sg elements&n; *&n; *  if (use_sg == 0)&n; *&t;&t;request_buffer - buffer address for request&n; *&t;&t;request_bufflen - length of request buffer&n; *  else&n; *&t;&t;request_buffer - pointer to scatterlist structure&n; *&n; *  sense_buffer - sense command buffer&n; *&n; *  result (4 bytes of an int):&n; *   Byte Meaning&n; *   0&t;  SCSI Status Byte Code&n; *   1&t;  SCSI One Byte Message Code&n; *   2 &t;  Host Error Code&n; *   3&t;  Mid-Level Error Code&n; *&n; *  host driver fields:&n; *  SCp - Scsi_Pointer used for command processing status&n; *  scsi_done - used to save caller&squot;s done function&n; * &t;host_scribble - used for pointer to another Scsi_Cmnd&n; *&n; * If this function returns ASC_NOERROR or ASC_ERROR the done&n; * function has been called. If ASC_BUSY is returned the request&n; * must be enqueued by the caller and re-tried later.&n; */
id|STATIC
r_int
DECL|function|asc_execute_scsi_cmnd
id|asc_execute_scsi_cmnd
c_func
(paren
id|Scsi_Cmnd
op_star
id|scp
)paren
(brace
r_struct
id|asc_board
op_star
id|boardp
suffix:semicolon
id|ASC_DVC_VAR
op_star
id|asc_dvc_varp
suffix:semicolon
id|ASC_SCSI_Q
id|scsiq
suffix:semicolon
id|ASC_SG_HEAD
id|sghead
suffix:semicolon
r_int
id|flags
suffix:semicolon
r_int
id|ret
suffix:semicolon
id|ASC_DBG2
c_func
(paren
l_int|1
comma
l_string|&quot;asc_execute_scsi_cmnd: scp %x, done %x&bslash;n&quot;
comma
(paren
r_int
)paren
id|scp
comma
(paren
r_int
)paren
id|scp-&gt;scsi_done
)paren
suffix:semicolon
id|boardp
op_assign
id|ASC_BOARDP
c_func
(paren
id|scp-&gt;host
)paren
suffix:semicolon
id|asc_dvc_varp
op_assign
op_amp
id|boardp-&gt;asc_dvc_var
suffix:semicolon
multiline_comment|/*&n;&t; * If this is the first command, then initialize the device. If&n;&t; * no device is found set &squot;DID_BAD_TARGET&squot; and return.&n;&t; */
r_if
c_cond
(paren
(paren
id|boardp-&gt;init_tidmask
op_amp
id|ASC_TIX_TO_TARGET_ID
c_func
(paren
id|scp-&gt;target
)paren
)paren
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|asc_init_dev
c_func
(paren
id|asc_dvc_varp
comma
id|scp
)paren
op_eq
id|ASC_FALSE
)paren
(brace
id|scp-&gt;result
op_assign
id|HOST_BYTE
c_func
(paren
id|DID_BAD_TARGET
)paren
suffix:semicolon
id|scp
op_member_access_from_pointer
id|scsi_done
c_func
(paren
id|scp
)paren
suffix:semicolon
r_return
id|ASC_ERROR
suffix:semicolon
)brace
id|boardp-&gt;init_tidmask
op_or_assign
id|ASC_TIX_TO_TARGET_ID
c_func
(paren
id|scp-&gt;target
)paren
suffix:semicolon
)brace
id|memset
c_func
(paren
op_amp
id|scsiq
comma
l_int|0
comma
r_sizeof
(paren
id|ASC_SCSI_Q
)paren
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Point the ASC_SCSI_Q to the &squot;Scsi_Cmnd&squot;.&n;&t; */
id|scsiq.q2.srb_ptr
op_assign
(paren
id|ulong
)paren
id|scp
suffix:semicolon
multiline_comment|/*&n;&t; * Build the ASC_SCSI_Q request.&n;&t; */
id|scsiq.cdbptr
op_assign
op_amp
id|scp-&gt;cmnd
(braket
l_int|0
)braket
suffix:semicolon
id|scsiq.q2.cdb_len
op_assign
id|scp-&gt;cmd_len
suffix:semicolon
id|scsiq.q1.target_id
op_assign
id|ASC_TID_TO_TARGET_ID
c_func
(paren
id|scp-&gt;target
)paren
suffix:semicolon
id|scsiq.q1.target_lun
op_assign
id|scp-&gt;lun
suffix:semicolon
id|scsiq.q2.target_ix
op_assign
id|ASC_TIDLUN_TO_IX
c_func
(paren
id|scp-&gt;target
comma
id|scp-&gt;lun
)paren
suffix:semicolon
id|scsiq.q1.sense_addr
op_assign
(paren
id|ulong
)paren
op_amp
id|scp-&gt;sense_buffer
(braket
l_int|0
)braket
suffix:semicolon
id|scsiq.q1.sense_len
op_assign
r_sizeof
(paren
id|scp-&gt;sense_buffer
)paren
suffix:semicolon
id|scsiq.q2.tag_code
op_assign
id|M2_QTAG_MSG_SIMPLE
suffix:semicolon
multiline_comment|/*&n;&t; * Build ASC_SCSI_Q for a contiguous buffer or a scatter-gather&n;&t; * buffer command.&n;&t; */
r_if
c_cond
(paren
id|scp-&gt;use_sg
op_eq
l_int|0
)paren
(brace
multiline_comment|/*&n;&t;&t; * CDB request of single contiguous buffer.&n;&t;&t; */
id|ASC_STATS
c_func
(paren
id|scp-&gt;host
comma
id|cont_cnt
)paren
suffix:semicolon
multiline_comment|/* request_buffer is already a real address. */
id|scsiq.q1.data_addr
op_assign
(paren
id|ulong
)paren
id|scp-&gt;request_buffer
suffix:semicolon
id|scsiq.q1.data_cnt
op_assign
id|scp-&gt;request_bufflen
suffix:semicolon
id|ASC_STATS_ADD
c_func
(paren
id|scp-&gt;host
comma
id|cont_xfer
comma
id|ASC_CEILING
c_func
(paren
id|scp-&gt;request_bufflen
comma
l_int|512
)paren
)paren
suffix:semicolon
id|scsiq.q1.sg_queue_cnt
op_assign
l_int|0
suffix:semicolon
id|scsiq.sg_head
op_assign
l_int|NULL
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/*&n;&t;&t; * CDB scatter-gather request list.&n;&t;&t; */
r_int
id|sgcnt
suffix:semicolon
r_struct
id|scatterlist
op_star
id|slp
suffix:semicolon
r_if
c_cond
(paren
id|scp-&gt;use_sg
OG
id|ASC_MAX_SG_LIST
)paren
(brace
id|ASC_PRINT3
c_func
(paren
l_string|&quot;asc_execute_scsi_cmnd: Board %d: use_sg %d &gt; %d&bslash;n&quot;
comma
id|boardp-&gt;id
comma
id|scp-&gt;use_sg
comma
id|ASC_MAX_SG_LIST
)paren
suffix:semicolon
id|scp-&gt;result
op_assign
id|HOST_BYTE
c_func
(paren
id|DID_ERROR
)paren
suffix:semicolon
id|scp
op_member_access_from_pointer
id|scsi_done
c_func
(paren
id|scp
)paren
suffix:semicolon
r_return
id|ASC_ERROR
suffix:semicolon
)brace
id|ASC_STATS
c_func
(paren
id|scp-&gt;host
comma
id|sg_cnt
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t; * Allocate a ASC_SG_HEAD structure and set the ASC_SCSI_Q&n;&t;&t; * to point to it.&n;&t;&t; */
id|memset
c_func
(paren
op_amp
id|sghead
comma
l_int|0
comma
r_sizeof
(paren
id|ASC_SG_HEAD
)paren
)paren
suffix:semicolon
id|scsiq.q1.cntl
op_or_assign
id|QC_SG_HEAD
suffix:semicolon
id|scsiq.sg_head
op_assign
op_amp
id|sghead
suffix:semicolon
id|scsiq.q1.data_cnt
op_assign
l_int|0
suffix:semicolon
id|scsiq.q1.data_addr
op_assign
l_int|0
suffix:semicolon
id|sghead.entry_cnt
op_assign
id|scsiq.q1.sg_queue_cnt
op_assign
id|scp-&gt;use_sg
suffix:semicolon
id|ASC_STATS_ADD
c_func
(paren
id|scp-&gt;host
comma
id|sg_elem
comma
id|sghead.entry_cnt
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t; * Convert scatter-gather list into ASC_SG_HEAD list.&n;&t;&t; */
id|slp
op_assign
(paren
r_struct
id|scatterlist
op_star
)paren
id|scp-&gt;request_buffer
suffix:semicolon
r_for
c_loop
(paren
id|sgcnt
op_assign
l_int|0
suffix:semicolon
id|sgcnt
OL
id|scp-&gt;use_sg
suffix:semicolon
id|sgcnt
op_increment
comma
id|slp
op_increment
)paren
(brace
id|sghead.sg_list
(braket
id|sgcnt
)braket
dot
id|addr
op_assign
(paren
id|ulong
)paren
id|slp-&gt;address
suffix:semicolon
id|sghead.sg_list
(braket
id|sgcnt
)braket
dot
id|bytes
op_assign
id|slp-&gt;length
suffix:semicolon
id|ASC_STATS_ADD
c_func
(paren
id|scp-&gt;host
comma
id|sg_xfer
comma
id|ASC_CEILING
c_func
(paren
id|slp-&gt;length
comma
l_int|512
)paren
)paren
suffix:semicolon
)brace
)brace
id|ASC_DBG_PRT_SCSI_Q
c_func
(paren
l_int|2
comma
op_amp
id|scsiq
)paren
suffix:semicolon
id|ASC_DBG_PRT_CDB
c_func
(paren
l_int|1
comma
id|scp-&gt;cmnd
comma
id|scp-&gt;cmd_len
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Disable interrupts to issue the command and add the&n;&t; * command to the active queue if it is started.&n;&t; */
id|save_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
id|cli
c_func
(paren
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|ret
op_assign
id|AscExeScsiQueue
c_func
(paren
id|asc_dvc_varp
comma
op_amp
id|scsiq
)paren
)paren
(brace
r_case
id|ASC_NOERROR
suffix:colon
id|asc_enqueue
c_func
(paren
op_amp
id|boardp-&gt;active
comma
id|scp
comma
id|ASC_BACK
)paren
suffix:semicolon
id|ASC_STATS
c_func
(paren
id|scp-&gt;host
comma
id|asc_noerror
)paren
suffix:semicolon
id|ASC_DBG
c_func
(paren
l_int|1
comma
l_string|&quot;asc_execute_scsi_cmnd: AscExeScsiQueue(), ASC_NOERROR&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ASC_BUSY
suffix:colon
multiline_comment|/* Caller must enqueue request and retry later. */
id|ASC_STATS
c_func
(paren
id|scp-&gt;host
comma
id|asc_busy
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ASC_ERROR
suffix:colon
id|ASC_PRINT2
c_func
(paren
l_string|&quot;asc_execute_scsi_cmnd: Board %d: AscExeScsiQueue() ASC_ERROR, err_code %x&bslash;n&quot;
comma
id|boardp-&gt;id
comma
id|asc_dvc_varp-&gt;err_code
)paren
suffix:semicolon
id|ASC_STATS
c_func
(paren
id|scp-&gt;host
comma
id|asc_error
)paren
suffix:semicolon
id|scp-&gt;result
op_assign
id|HOST_BYTE
c_func
(paren
id|DID_ERROR
)paren
suffix:semicolon
id|scp
op_member_access_from_pointer
id|scsi_done
c_func
(paren
id|scp
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|ASC_PRINT2
c_func
(paren
l_string|&quot;asc_execute_scsi_cmnd: Board %d: AscExeScsiQueue() unknown, err_code %x&bslash;n&quot;
comma
id|boardp-&gt;id
comma
id|asc_dvc_varp-&gt;err_code
)paren
suffix:semicolon
id|ASC_STATS
c_func
(paren
id|scp-&gt;host
comma
id|asc_unknown
)paren
suffix:semicolon
id|scp-&gt;result
op_assign
id|HOST_BYTE
c_func
(paren
id|DID_ERROR
)paren
suffix:semicolon
id|scp
op_member_access_from_pointer
id|scsi_done
c_func
(paren
id|scp
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|restore_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
id|ASC_DBG
c_func
(paren
l_int|1
comma
l_string|&quot;asc_execute_scsi_cmnd: end&bslash;n&quot;
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
multiline_comment|/*&n; * asc_isr_callback() - Second Level Interrupt Handler called by AscISR().&n; */
r_void
DECL|function|asc_isr_callback
id|asc_isr_callback
c_func
(paren
id|ASC_DVC_VAR
op_star
id|asc_dvc_varp
comma
id|ASC_QDONE_INFO
op_star
id|qdonep
)paren
(brace
r_struct
id|asc_board
op_star
id|boardp
suffix:semicolon
id|Scsi_Cmnd
op_star
id|scp
suffix:semicolon
r_struct
id|Scsi_Host
op_star
id|shp
suffix:semicolon
id|Scsi_Cmnd
op_star
op_star
id|scpp
suffix:semicolon
id|ASC_ASSERT
c_func
(paren
id|interrupts_enabled
c_func
(paren
)paren
op_eq
id|ASC_FALSE
)paren
suffix:semicolon
id|ASC_DBG2
c_func
(paren
l_int|1
comma
l_string|&quot;asc_isr_callback: asc_dvc_varp %x, qdonep %x&bslash;n&quot;
comma
(paren
r_int
)paren
id|asc_dvc_varp
comma
(paren
r_int
)paren
id|qdonep
)paren
suffix:semicolon
id|ASC_DBG_PRT_QDONE_INFO
c_func
(paren
l_int|2
comma
id|qdonep
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Get the Scsi_Cmnd structure and Scsi_Host structure for the&n;&t; * command that has been completed.&n;&t; */
id|scp
op_assign
(paren
id|Scsi_Cmnd
op_star
)paren
id|qdonep-&gt;d2.srb_ptr
suffix:semicolon
id|ASC_DBG1
c_func
(paren
l_int|1
comma
l_string|&quot;asc_isr_callback: scp %x&bslash;n&quot;
comma
(paren
r_int
)paren
id|scp
)paren
suffix:semicolon
id|ASC_DBG_PRT_CDB
c_func
(paren
l_int|2
comma
id|scp-&gt;cmnd
comma
id|scp-&gt;cmd_len
)paren
suffix:semicolon
id|shp
op_assign
id|scp-&gt;host
suffix:semicolon
id|ASC_ASSERT
c_func
(paren
id|shp
)paren
suffix:semicolon
id|ASC_STATS
c_func
(paren
id|shp
comma
id|callback
)paren
suffix:semicolon
id|ASC_DBG1
c_func
(paren
l_int|1
comma
l_string|&quot;asc_isr_callback: shp %x&bslash;n&quot;
comma
(paren
r_int
)paren
id|shp
)paren
suffix:semicolon
id|boardp
op_assign
id|ASC_BOARDP
c_func
(paren
id|shp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|asc_rmqueue
c_func
(paren
op_amp
id|boardp-&gt;active
comma
id|scp
)paren
op_eq
id|ASC_FALSE
)paren
(brace
id|ASC_PRINT2
c_func
(paren
l_string|&quot;asc_isr_callback: Board %d: scp %x not on active queue&bslash;n&quot;
comma
id|boardp-&gt;id
comma
(paren
r_int
)paren
id|scp
)paren
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * &squot;qdonep&squot; contains the command&squot;s ending status.&n;&t; */
r_switch
c_cond
(paren
id|qdonep-&gt;d3.done_stat
)paren
(brace
r_case
id|QD_NO_ERROR
suffix:colon
id|ASC_DBG
c_func
(paren
l_int|2
comma
l_string|&quot;asc_isr_callback: QD_NO_ERROR&bslash;n&quot;
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|qdonep-&gt;d3.host_stat
)paren
(brace
r_case
id|QHSTA_NO_ERROR
suffix:colon
id|scp-&gt;result
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
multiline_comment|/* QHSTA error occurred */
id|scp-&gt;result
op_assign
id|HOST_BYTE
c_func
(paren
id|DID_ERROR
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|QD_WITH_ERROR
suffix:colon
id|ASC_DBG
c_func
(paren
l_int|2
comma
l_string|&quot;asc_isr_callback: QD_WITH_ERROR&bslash;n&quot;
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|qdonep-&gt;d3.host_stat
)paren
(brace
r_case
id|QHSTA_NO_ERROR
suffix:colon
r_if
c_cond
(paren
id|qdonep-&gt;d3.scsi_stat
op_eq
id|SS_CHK_CONDITION
)paren
(brace
id|ASC_DBG
c_func
(paren
l_int|2
comma
l_string|&quot;asc_isr_callback: SS_CHK_CONDITION&bslash;n&quot;
)paren
suffix:semicolon
id|ASC_DBG_PRT_SENSE
c_func
(paren
l_int|2
comma
id|scp-&gt;sense_buffer
comma
r_sizeof
(paren
id|scp-&gt;sense_buffer
)paren
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t;&t;&t; * Note: The &squot;status_byte()&squot; macro used by target drivers&n;&t;&t;&t;&t; * defined in scsi.h shifts the status byte returned by&n;&t;&t;&t;&t; * host drivers right by 1 bit. This is why target drivers&n;&t;&t;&t;&t; * also use right shifted status byte definitions. For&n;&t;&t;&t;&t; * instance target drivers use CHECK_CONDITION, defined to&n;&t;&t;&t;&t; * 0x1, instead of the SCSI defined check condition value&n;&t;&t;&t;&t; * of 0x2. Host drivers are supposed to return the status&n;&t;&t;&t;&t; * byte as it is defined by SCSI.&n;&t;&t;&t;&t; */
id|scp-&gt;result
op_assign
id|DRIVER_BYTE
c_func
(paren
id|DRIVER_SENSE
)paren
op_or
id|STATUS_BYTE
c_func
(paren
id|qdonep-&gt;d3.scsi_stat
)paren
suffix:semicolon
)brace
r_else
(brace
id|scp-&gt;result
op_assign
id|STATUS_BYTE
c_func
(paren
id|qdonep-&gt;d3.scsi_stat
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_default
suffix:colon
multiline_comment|/* QHSTA error occurred */
id|ASC_DBG1
c_func
(paren
l_int|2
comma
l_string|&quot;asc_isr_callback: host_stat %x&bslash;n&quot;
comma
id|qdonep-&gt;d3.host_stat
)paren
suffix:semicolon
id|scp-&gt;result
op_assign
id|HOST_BYTE
c_func
(paren
id|DID_ERROR
)paren
op_or
id|MSG_BYTE
c_func
(paren
id|qdonep-&gt;d3.scsi_msg
)paren
op_or
id|STATUS_BYTE
c_func
(paren
id|qdonep-&gt;d3.scsi_stat
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|QD_ABORTED_BY_HOST
suffix:colon
id|ASC_DBG
c_func
(paren
l_int|1
comma
l_string|&quot;asc_isr_callback: QD_ABORTED_BY_HOST&bslash;n&quot;
)paren
suffix:semicolon
id|scp-&gt;result
op_assign
id|HOST_BYTE
c_func
(paren
id|DID_ABORT
)paren
op_or
id|MSG_BYTE
c_func
(paren
id|qdonep-&gt;d3.scsi_msg
)paren
op_or
id|STATUS_BYTE
c_func
(paren
id|qdonep-&gt;d3.scsi_stat
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|ASC_PRINT1
c_func
(paren
l_string|&quot;asc_isr_callback: done_stat %x&bslash;n&quot;
comma
id|qdonep-&gt;d3.done_stat
)paren
suffix:semicolon
id|scp-&gt;result
op_assign
id|HOST_BYTE
c_func
(paren
id|DID_ERROR
)paren
op_or
id|MSG_BYTE
c_func
(paren
id|qdonep-&gt;d3.scsi_msg
)paren
op_or
id|STATUS_BYTE
c_func
(paren
id|qdonep-&gt;d3.scsi_stat
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * Before calling &squot;scsi_done&squot; for the current &squot;Scsi_Cmnd&squot; and possibly&n;&t; * triggering more commands to be issued, try to start any pending&n;&t; * commands.&n;&t; */
r_if
c_cond
(paren
id|boardp-&gt;pending.tidmask
op_ne
l_int|0
)paren
(brace
multiline_comment|/*&n;&t;&t; * If there are any pending commands for this board before trying&n;&t; &t; * to execute them, disable interrupts to preserve request ordering.&n;&t;&t; */
id|ASC_ASSERT
c_func
(paren
id|interrupts_enabled
c_func
(paren
)paren
op_eq
id|ASC_FALSE
)paren
suffix:semicolon
id|ASC_DBG1
c_func
(paren
l_int|1
comma
l_string|&quot;asc_isr_callback: asc_execute_queue() %x&bslash;n&quot;
comma
id|boardp-&gt;pending.tidmask
)paren
suffix:semicolon
id|asc_execute_queue
c_func
(paren
op_amp
id|boardp-&gt;pending
)paren
suffix:semicolon
)brace
multiline_comment|/* &n;&t; * Because interrupts may be enabled by the &squot;Scsi_Cmnd&squot; done function,&n;&t; * add the command to the end of the global done list. The done function&n;&t; * for the command will be called in advansys_interrupt().&n;&t; */
r_for
c_loop
(paren
id|scpp
op_assign
op_amp
id|asc_scsi_done
suffix:semicolon
op_star
id|scpp
suffix:semicolon
id|scpp
op_assign
(paren
id|Scsi_Cmnd
op_star
op_star
)paren
op_amp
(paren
op_star
id|scpp
)paren
op_member_access_from_pointer
id|host_scribble
)paren
(brace
suffix:semicolon
)brace
op_star
id|scpp
op_assign
id|scp
suffix:semicolon
id|scp-&gt;host_scribble
op_assign
l_int|NULL
suffix:semicolon
r_return
suffix:semicolon
)brace
multiline_comment|/*&n; * asc_init_dev()&n; *&n; * Perform one-time initialization of a device.&n; */
id|STATIC
r_int
DECL|function|asc_init_dev
id|asc_init_dev
c_func
(paren
id|ASC_DVC_VAR
op_star
id|asc_dvc_varp
comma
id|Scsi_Cmnd
op_star
id|scp
)paren
(brace
r_struct
id|asc_board
op_star
id|boardp
suffix:semicolon
id|ASC_SCSI_REQ_Q
op_star
id|scsireqq
suffix:semicolon
id|ASC_CAP_INFO
op_star
id|cap_info
suffix:semicolon
id|ASC_SCSI_INQUIRY
op_star
id|inquiry
suffix:semicolon
r_int
id|found
suffix:semicolon
id|ASC_SCSI_BIT_ID_TYPE
id|save_use_tagged_qng
suffix:semicolon
id|ASC_SCSI_BIT_ID_TYPE
id|save_can_tagged_qng
suffix:semicolon
r_int
id|ret
suffix:semicolon
macro_line|#ifdef ADVANSYS_DEBUG
id|ASC_SCSI_BIT_ID_TYPE
id|tidmask
suffix:semicolon
multiline_comment|/* target id bit mask: 1 - 128 */
macro_line|#endif /* ADVANSYS_DEBUG */
id|ASC_DBG1
c_func
(paren
l_int|1
comma
l_string|&quot;asc_init_dev: target %d&bslash;n&quot;
comma
(paren
r_int
)paren
id|scp-&gt;target
)paren
suffix:semicolon
multiline_comment|/* The hosts&squot;s target id is set in init_tidmask during initialization. */
id|ASC_ASSERT
c_func
(paren
id|asc_dvc_varp-&gt;cfg-&gt;chip_scsi_id
op_ne
id|scp-&gt;target
)paren
suffix:semicolon
id|boardp
op_assign
id|ASC_BOARDP
c_func
(paren
id|scp-&gt;host
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * XXX - Host drivers should not modify the timeout field.&n;&t; * But on the first command only add some extra time to&n;&t; * allow the driver to complete its initialization for the&n;&t; * device.&n;&t; */
id|scp-&gt;timeout
op_add_assign
l_int|2000
suffix:semicolon
multiline_comment|/* Add 5 seconds to the request timeout. */
multiline_comment|/* Set-up AscInitPollTarget() arguments. */
id|scsireqq
op_assign
op_amp
id|boardp-&gt;scsireqq
suffix:semicolon
id|memset
c_func
(paren
id|scsireqq
comma
l_int|0
comma
r_sizeof
(paren
id|ASC_SCSI_REQ_Q
)paren
)paren
suffix:semicolon
id|cap_info
op_assign
op_amp
id|boardp-&gt;cap_info
suffix:semicolon
id|memset
c_func
(paren
id|cap_info
comma
l_int|0
comma
r_sizeof
(paren
id|ASC_CAP_INFO
)paren
)paren
suffix:semicolon
id|inquiry
op_assign
op_amp
id|boardp-&gt;inquiry
suffix:semicolon
id|memset
c_func
(paren
id|inquiry
comma
l_int|0
comma
r_sizeof
(paren
id|ASC_SCSI_INQUIRY
)paren
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * XXX - AscInitPollBegin() re-initializes these fields to&n;&t; * zero. &squot;Or&squot; in the new values and restore them before calling &n;&t; * AscInitPollEnd(). Normally all targets are initialized within&n;&t; * a call to AscInitPollBegin() and AscInitPollEnd().&n;&t; */
id|save_use_tagged_qng
op_assign
id|asc_dvc_varp-&gt;use_tagged_qng
suffix:semicolon
id|save_can_tagged_qng
op_assign
id|asc_dvc_varp-&gt;cfg-&gt;can_tagged_qng
suffix:semicolon
id|ASC_DBG
c_func
(paren
l_int|2
comma
l_string|&quot;asc_init_dev: AscInitPollBegin()&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|AscInitPollBegin
c_func
(paren
id|asc_dvc_varp
)paren
)paren
(brace
id|ASC_PRINT1
c_func
(paren
l_string|&quot;asc_init_dev: Board %d: AscInitPollBegin() failed&bslash;n&quot;
comma
id|boardp-&gt;id
)paren
suffix:semicolon
r_return
id|ASC_FALSE
suffix:semicolon
)brace
id|scsireqq-&gt;sense_ptr
op_assign
op_amp
id|scsireqq-&gt;sense
(braket
l_int|0
)braket
suffix:semicolon
id|scsireqq-&gt;r1.sense_len
op_assign
id|ASC_MIN_SENSE_LEN
suffix:semicolon
id|scsireqq-&gt;r1.target_id
op_assign
id|ASC_TID_TO_TARGET_ID
c_func
(paren
id|scp-&gt;target
)paren
suffix:semicolon
id|scsireqq-&gt;r1.target_lun
op_assign
l_int|0
suffix:semicolon
id|scsireqq-&gt;r2.target_ix
op_assign
id|ASC_TIDLUN_TO_IX
c_func
(paren
id|scp-&gt;target
comma
l_int|0
)paren
suffix:semicolon
id|found
op_assign
id|ASC_FALSE
suffix:semicolon
id|ASC_DBG
c_func
(paren
l_int|2
comma
l_string|&quot;asc_init_dev: AscInitPollTarget()&bslash;n&quot;
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|ret
op_assign
id|AscInitPollTarget
c_func
(paren
id|asc_dvc_varp
comma
id|scsireqq
comma
id|inquiry
comma
id|cap_info
)paren
)paren
(brace
r_case
id|ASC_TRUE
suffix:colon
id|found
op_assign
id|ASC_TRUE
suffix:semicolon
macro_line|#ifdef ADVANSYS_DEBUG
id|tidmask
op_assign
id|ASC_TIX_TO_TARGET_ID
c_func
(paren
id|scp-&gt;target
)paren
suffix:semicolon
id|ASC_DBG2
c_func
(paren
l_int|1
comma
l_string|&quot;asc_init_dev: lba %lu, blk_size %lu&bslash;n&quot;
comma
id|cap_info-&gt;lba
comma
id|cap_info-&gt;blk_size
)paren
suffix:semicolon
id|ASC_DBG1
c_func
(paren
l_int|1
comma
l_string|&quot;asc_init_dev: peri_dvc_type %x&bslash;n&quot;
comma
id|inquiry-&gt;byte0.peri_dvc_type
)paren
suffix:semicolon
r_if
c_cond
(paren
id|asc_dvc_varp-&gt;use_tagged_qng
op_amp
id|tidmask
)paren
(brace
id|ASC_DBG1
c_func
(paren
l_int|1
comma
l_string|&quot;asc_init_dev: command queuing enabled: %d&bslash;n&quot;
comma
id|asc_dvc_varp-&gt;max_dvc_qng
(braket
id|scp-&gt;target
)braket
)paren
suffix:semicolon
)brace
r_else
(brace
id|ASC_DBG
c_func
(paren
l_int|1
comma
l_string|&quot;asc_init_dev: command queuing disabled&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|asc_dvc_varp-&gt;init_sdtr
op_amp
id|tidmask
)paren
(brace
id|ASC_DBG
c_func
(paren
l_int|1
comma
l_string|&quot;asc_init_dev: synchronous transfers enabled&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|ASC_DBG
c_func
(paren
l_int|1
comma
l_string|&quot;asc_init_dev: synchronous transfers disabled&bslash;n&quot;
)paren
suffix:semicolon
)brace
multiline_comment|/* Set bit means fix disabled. */
r_if
c_cond
(paren
id|asc_dvc_varp-&gt;pci_fix_asyn_xfer
op_amp
id|tidmask
)paren
(brace
id|ASC_DBG
c_func
(paren
l_int|1
comma
l_string|&quot;asc_init_dev: synchronous transfer fix disabled&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|ASC_DBG
c_func
(paren
l_int|1
comma
l_string|&quot;asc_init_dev: synchronous transfer fix enabled&bslash;n&quot;
)paren
suffix:semicolon
)brace
macro_line|#endif /* ADVANSYS_DEBUG */
r_break
suffix:semicolon
r_case
id|ASC_FALSE
suffix:colon
id|ASC_DBG
c_func
(paren
l_int|1
comma
l_string|&quot;asc_init_dev: no device found&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ASC_ERROR
suffix:colon
id|ASC_PRINT1
c_func
(paren
l_string|&quot;asc_init_dev: Board %d: AscInitPollTarget() ASC_ERROR&bslash;n&quot;
comma
id|boardp-&gt;id
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|ASC_PRINT2
c_func
(paren
l_string|&quot;asc_init_dev: Board %d: AscInitPollTarget() unknown ret %d&bslash;n&quot;
comma
id|boardp-&gt;id
comma
id|ret
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
multiline_comment|/* XXX - &squot;Or&squot; in original tag bits. */
id|asc_dvc_varp-&gt;use_tagged_qng
op_or_assign
id|save_use_tagged_qng
suffix:semicolon
id|asc_dvc_varp-&gt;cfg-&gt;can_tagged_qng
op_or_assign
id|save_can_tagged_qng
suffix:semicolon
id|ASC_DBG
c_func
(paren
l_int|2
comma
l_string|&quot;asc_init_dev: AscInitPollEnd()&bslash;n&quot;
)paren
suffix:semicolon
id|AscInitPollEnd
c_func
(paren
id|asc_dvc_varp
)paren
suffix:semicolon
r_return
id|found
suffix:semicolon
)brace
multiline_comment|/*&n; * Search for an AdvanSys PCI device in the PCI configuration space.&n; */
id|STATIC
r_int
DECL|function|asc_srch_pci_dev
id|asc_srch_pci_dev
c_func
(paren
id|PCI_DEVICE
op_star
id|pciDevice
)paren
(brace
r_int
id|ret
suffix:semicolon
id|ASC_DBG
c_func
(paren
l_int|2
comma
l_string|&quot;asc_srch_pci_dev: begin&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pci_scan_method
op_eq
op_minus
l_int|1
)paren
(brace
id|pci_scan_method
op_assign
id|asc_scan_method
c_func
(paren
)paren
suffix:semicolon
)brace
id|pciDevice-&gt;type
op_assign
id|pci_scan_method
suffix:semicolon
id|ASC_DBG1
c_func
(paren
l_int|2
comma
l_string|&quot;asc_srch_pci_dev: type %d&bslash;n&quot;
comma
id|pciDevice-&gt;type
)paren
suffix:semicolon
id|ret
op_assign
id|asc_pci_find_dev
c_func
(paren
id|pciDevice
)paren
suffix:semicolon
id|ASC_DBG1
c_func
(paren
l_int|2
comma
l_string|&quot;asc_srch_pci_dev: asc_pci_find_dev() return %d&bslash;n&quot;
comma
id|ret
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
op_eq
id|PCI_DEVICE_FOUND
)paren
(brace
id|pciDevice-&gt;slotNumber
op_assign
id|pciDevice-&gt;slotFound
op_plus
l_int|1
suffix:semicolon
id|pciDevice-&gt;startSlot
op_assign
id|pciDevice-&gt;slotFound
op_plus
l_int|1
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|pciDevice-&gt;bridge
OG
id|pciDevice-&gt;busNumber
)paren
(brace
id|ASC_DBG2
c_func
(paren
l_int|2
comma
l_string|&quot;asc_srch_pci_dev: bridge %x, busNumber %x&bslash;n&quot;
comma
id|pciDevice-&gt;bridge
comma
id|pciDevice-&gt;busNumber
)paren
suffix:semicolon
id|pciDevice-&gt;busNumber
op_increment
suffix:semicolon
id|pciDevice-&gt;slotNumber
op_assign
l_int|0
suffix:semicolon
id|pciDevice-&gt;startSlot
op_assign
l_int|0
suffix:semicolon
id|pciDevice-&gt;endSlot
op_assign
l_int|0x0f
suffix:semicolon
id|ret
op_assign
id|asc_srch_pci_dev
c_func
(paren
id|pciDevice
)paren
suffix:semicolon
id|ASC_DBG1
c_func
(paren
l_int|2
comma
l_string|&quot;asc_srch_pci_dev: recursive call return %d&bslash;n&quot;
comma
id|ret
)paren
suffix:semicolon
)brace
)brace
id|ASC_DBG1
c_func
(paren
l_int|2
comma
l_string|&quot;asc_srch_pci_dev: return %d&bslash;n&quot;
comma
id|ret
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
multiline_comment|/*&n; * Determine the access method to be used for &squot;pciDevice&squot;.&n; */
id|STATIC
id|uchar
DECL|function|asc_scan_method
id|asc_scan_method
c_func
(paren
r_void
)paren
(brace
id|ushort
id|data
suffix:semicolon
id|PCI_DATA
id|pciData
suffix:semicolon
id|uchar
id|type
suffix:semicolon
id|uchar
id|slot
suffix:semicolon
id|ASC_DBG
c_func
(paren
l_int|2
comma
l_string|&quot;asc_scan_method: begin&bslash;n&quot;
)paren
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|pciData
comma
l_int|0
comma
r_sizeof
(paren
id|pciData
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|type
op_assign
l_int|1
suffix:semicolon
id|type
OL
l_int|3
suffix:semicolon
id|type
op_increment
)paren
(brace
id|pciData.type
op_assign
id|type
suffix:semicolon
r_for
c_loop
(paren
id|slot
op_assign
l_int|0
suffix:semicolon
id|slot
OL
id|PCI_MAX_SLOT
suffix:semicolon
id|slot
op_increment
)paren
(brace
id|pciData.slot
op_assign
id|slot
suffix:semicolon
id|data
op_assign
id|asc_get_cfg_word
c_func
(paren
op_amp
id|pciData
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|data
op_ne
l_int|0xFFFF
)paren
op_logical_and
(paren
id|data
op_ne
l_int|0x0000
)paren
)paren
(brace
id|ASC_DBG2
c_func
(paren
l_int|4
comma
l_string|&quot;asc_scan_method: data %x, type %d&bslash;n&quot;
comma
id|data
comma
id|type
)paren
suffix:semicolon
r_return
(paren
id|type
)paren
suffix:semicolon
)brace
)brace
)brace
id|ASC_DBG1
c_func
(paren
l_int|4
comma
l_string|&quot;asc_scan_method: type %d&bslash;n&quot;
comma
id|type
)paren
suffix:semicolon
r_return
(paren
id|type
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Check for an AdvanSys PCI device in &squot;pciDevice&squot;.&n; *&n; * Return PCI_DEVICE_FOUND if found, otherwise return PCI_DEVICE_NOT_FOUND.&n; */
id|STATIC
r_int
DECL|function|asc_pci_find_dev
id|asc_pci_find_dev
c_func
(paren
id|PCI_DEVICE
op_star
id|pciDevice
)paren
(brace
id|PCI_DATA
id|pciData
suffix:semicolon
id|ushort
id|vendorid
comma
id|deviceid
suffix:semicolon
id|uchar
id|classcode
comma
id|subclass
suffix:semicolon
id|uchar
id|lslot
suffix:semicolon
id|ASC_DBG
c_func
(paren
l_int|3
comma
l_string|&quot;asc_pci_find_dev: begin&bslash;n&quot;
)paren
suffix:semicolon
id|pciData.type
op_assign
id|pciDevice-&gt;type
suffix:semicolon
id|pciData.bus
op_assign
id|pciDevice-&gt;busNumber
suffix:semicolon
id|pciData.func
op_assign
id|pciDevice-&gt;devFunc
suffix:semicolon
id|lslot
op_assign
id|pciDevice-&gt;startSlot
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
id|lslot
OL
id|pciDevice-&gt;endSlot
suffix:semicolon
id|lslot
op_increment
)paren
(brace
id|pciData.slot
op_assign
id|lslot
suffix:semicolon
id|pciData.offset
op_assign
id|VENDORID_OFFSET
suffix:semicolon
id|vendorid
op_assign
id|asc_get_cfg_word
c_func
(paren
op_amp
id|pciData
)paren
suffix:semicolon
id|ASC_DBG1
c_func
(paren
l_int|3
comma
l_string|&quot;asc_pci_find_dev: vendorid %x&bslash;n&quot;
comma
id|vendorid
)paren
suffix:semicolon
r_if
c_cond
(paren
id|vendorid
op_ne
l_int|0xffff
)paren
(brace
id|pciData.offset
op_assign
id|DEVICEID_OFFSET
suffix:semicolon
id|deviceid
op_assign
id|asc_get_cfg_word
c_func
(paren
op_amp
id|pciData
)paren
suffix:semicolon
id|ASC_DBG1
c_func
(paren
l_int|3
comma
l_string|&quot;asc_pci_find_dev: deviceid %x&bslash;n&quot;
comma
id|deviceid
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|vendorid
op_eq
id|ASC_PCI_VENDORID
)paren
op_logical_and
(paren
(paren
id|deviceid
op_eq
id|ASC_PCI_DEVICE_ID_1100
)paren
op_logical_or
(paren
id|deviceid
op_eq
id|ASC_PCI_DEVICE_ID_1200
)paren
op_logical_or
(paren
id|deviceid
op_eq
id|ASC_PCI_DEVICE_ID_1300
)paren
)paren
)paren
(brace
id|pciDevice-&gt;slotFound
op_assign
id|lslot
suffix:semicolon
id|ASC_DBG
c_func
(paren
l_int|3
comma
l_string|&quot;asc_pci_find_dev: PCI_DEVICE_FOUND&bslash;n&quot;
)paren
suffix:semicolon
r_return
id|PCI_DEVICE_FOUND
suffix:semicolon
)brace
r_else
(brace
id|pciData.offset
op_assign
id|SUBCLASS_OFFSET
suffix:semicolon
id|subclass
op_assign
id|asc_get_cfg_byte
c_func
(paren
op_amp
id|pciData
)paren
suffix:semicolon
id|pciData.offset
op_assign
id|CLASSCODE_OFFSET
suffix:semicolon
id|classcode
op_assign
id|asc_get_cfg_byte
c_func
(paren
op_amp
id|pciData
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|classcode
op_amp
id|PCI_BASE_CLASS_BRIDGE_DEVICE
)paren
op_logical_and
(paren
id|subclass
op_amp
id|PCI_SUB_CLASS_PCI_TO_PCI_BRIDGE_CONTROLLER
)paren
)paren
(brace
id|pciDevice-&gt;bridge
op_increment
suffix:semicolon
)brace
id|ASC_DBG2
c_func
(paren
l_int|3
comma
l_string|&quot;asc_pci_find_dev: subclass %x, classcode %x&bslash;n&quot;
comma
id|subclass
comma
id|classcode
)paren
suffix:semicolon
)brace
)brace
)brace
r_return
id|PCI_DEVICE_NOT_FOUND
suffix:semicolon
)brace
multiline_comment|/*&n; * Read PCI configuration data into &squot;pciConfig&squot;.&n; */
id|STATIC
r_void
DECL|function|asc_get_pci_cfg
id|asc_get_pci_cfg
c_func
(paren
id|PCI_DEVICE
op_star
id|pciDevice
comma
id|PCI_CONFIG_SPACE
op_star
id|pciConfig
)paren
(brace
id|PCI_DATA
id|pciData
suffix:semicolon
id|uchar
id|counter
suffix:semicolon
id|uchar
op_star
id|localConfig
suffix:semicolon
id|ASC_DBG1
c_func
(paren
l_int|4
comma
l_string|&quot;asc_get_pci_cfg: slot found - %d&bslash;n &quot;
comma
id|pciDevice-&gt;slotFound
)paren
suffix:semicolon
id|pciData.type
op_assign
id|pciDevice-&gt;type
suffix:semicolon
id|pciData.bus
op_assign
id|pciDevice-&gt;busNumber
suffix:semicolon
id|pciData.slot
op_assign
id|pciDevice-&gt;slotFound
suffix:semicolon
id|pciData.func
op_assign
id|pciDevice-&gt;devFunc
suffix:semicolon
id|localConfig
op_assign
(paren
id|uchar
op_star
)paren
id|pciConfig
suffix:semicolon
r_for
c_loop
(paren
id|counter
op_assign
l_int|0
suffix:semicolon
id|counter
OL
r_sizeof
(paren
id|PCI_CONFIG_SPACE
)paren
suffix:semicolon
id|counter
op_increment
)paren
(brace
id|pciData.offset
op_assign
id|counter
suffix:semicolon
op_star
id|localConfig
op_assign
id|asc_get_cfg_byte
c_func
(paren
op_amp
id|pciData
)paren
suffix:semicolon
id|ASC_DBG1
c_func
(paren
l_int|4
comma
l_string|&quot;asc_get_pci_cfg: byte %x&bslash;n&quot;
comma
op_star
id|localConfig
)paren
suffix:semicolon
id|localConfig
op_increment
suffix:semicolon
)brace
id|ASC_DBG1
c_func
(paren
l_int|4
comma
l_string|&quot;asc_get_pci_cfg: counter %d&bslash;n&quot;
comma
id|counter
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Read a word (16 bits) from the PCI configuration space.&n; *&n; * The configuration mechanism is checked for the correct access method.&n; */
id|STATIC
id|ushort
DECL|function|asc_get_cfg_word
id|asc_get_cfg_word
c_func
(paren
id|PCI_DATA
op_star
id|pciData
)paren
(brace
id|ushort
id|tmp
suffix:semicolon
id|ulong
id|address
suffix:semicolon
id|ulong
id|lbus
op_assign
id|pciData-&gt;bus
suffix:semicolon
id|ulong
id|lslot
op_assign
id|pciData-&gt;slot
suffix:semicolon
id|ulong
id|lfunc
op_assign
id|pciData-&gt;func
suffix:semicolon
id|uchar
id|t2CFA
comma
id|t2CF8
suffix:semicolon
id|ulong
id|t1CF8
comma
id|t1CFC
suffix:semicolon
id|ASC_DBG4
c_func
(paren
l_int|4
comma
l_string|&quot;asc_get_cfg_word: type %d, bus %lu, slot %lu, func %lu&bslash;n&quot;
comma
id|pciData-&gt;type
comma
id|lbus
comma
id|lslot
comma
id|lfunc
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Check type of configuration mechanism.&n;&t; */
r_if
c_cond
(paren
id|pciData-&gt;type
op_eq
l_int|2
)paren
(brace
multiline_comment|/*&n;&t;&t; * Save registers to be restored later.&n;&t;&t; */
id|t2CFA
op_assign
id|inp
c_func
(paren
l_int|0xCFA
)paren
suffix:semicolon
multiline_comment|/* save PCI bus register */
id|t2CF8
op_assign
id|inp
c_func
(paren
l_int|0xCF8
)paren
suffix:semicolon
multiline_comment|/* save config space enable register */
multiline_comment|/*&n;&t;&t; * Write the bus and enable registers.&n;&t;&t; */
multiline_comment|/* set for type 1 cycle, if needed */
id|outp
c_func
(paren
l_int|0xCFA
comma
id|pciData-&gt;bus
)paren
suffix:semicolon
multiline_comment|/* set the function number */
id|outp
c_func
(paren
l_int|0xCF8
comma
l_int|0x10
op_or
(paren
id|pciData-&gt;func
op_lshift
l_int|1
)paren
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t; * Read the configuration space type 2 locations.&n;&t;&t; */
id|tmp
op_assign
(paren
id|ushort
)paren
id|inpw
c_func
(paren
l_int|0xC000
op_or
(paren
(paren
id|pciData-&gt;slot
op_lshift
l_int|8
)paren
op_plus
id|pciData-&gt;offset
)paren
)paren
suffix:semicolon
id|outp
c_func
(paren
l_int|0xCFA
comma
id|t2CFA
)paren
suffix:semicolon
multiline_comment|/* save PCI bus register */
id|outp
c_func
(paren
l_int|0xCF8
comma
id|t2CF8
)paren
suffix:semicolon
multiline_comment|/* save config space enable register */
)brace
r_else
(brace
multiline_comment|/*&n;&t;&t; * Type 1 or 3 configuration mechanism.&n;&t;&t; *&n;&t;&t; * Save the CONFIG_ADDRESS and CONFIG_DATA register values.&n;&t;&t; */
id|t1CF8
op_assign
id|inpl
c_func
(paren
l_int|0xCF8
)paren
suffix:semicolon
id|t1CFC
op_assign
id|inpl
c_func
(paren
l_int|0xCFC
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t; * enable &lt;31&gt;, bus = &lt;23:16&gt;, slot = &lt;15:11&gt;,&n;&t;&t; * func = &lt;10:8&gt;, reg = &lt;7:2&gt;&n;&t;&t; */
id|address
op_assign
(paren
id|ulong
)paren
(paren
(paren
id|lbus
op_lshift
l_int|16
)paren
op_or
(paren
id|lslot
op_lshift
l_int|11
)paren
op_or
(paren
id|lfunc
op_lshift
l_int|8
)paren
op_or
(paren
id|pciData-&gt;offset
op_amp
l_int|0xFC
)paren
op_or
l_int|0x80000000L
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t; * Write out the address to CONFIG_ADDRESS.&n;&t;&t; */
id|outpl
c_func
(paren
l_int|0xCF8
comma
id|address
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t; * Read in word from CONFIG_DATA.&n;&t;&t; */
id|tmp
op_assign
(paren
id|ushort
)paren
(paren
(paren
id|inpl
c_func
(paren
l_int|0xCFC
)paren
op_rshift
(paren
(paren
id|pciData-&gt;offset
op_amp
l_int|2
)paren
op_star
l_int|8
)paren
)paren
op_amp
l_int|0xFFFF
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t; * Restore registers.&n;&t;&t; */
id|outpl
c_func
(paren
l_int|0xCF8
comma
id|t1CF8
)paren
suffix:semicolon
id|outpl
c_func
(paren
l_int|0xCFC
comma
id|t1CFC
)paren
suffix:semicolon
)brace
id|ASC_DBG1
c_func
(paren
l_int|4
comma
l_string|&quot;asc_get_cfg_word: config data: %x&bslash;n&quot;
comma
id|tmp
)paren
suffix:semicolon
r_return
id|tmp
suffix:semicolon
)brace
multiline_comment|/*&n; * Reads a byte from the PCI configuration space.&n; *&n; * The configuration mechanism is checked for the correct access method.&n; */
id|STATIC
id|uchar
DECL|function|asc_get_cfg_byte
id|asc_get_cfg_byte
c_func
(paren
id|PCI_DATA
op_star
id|pciData
)paren
(brace
id|uchar
id|tmp
suffix:semicolon
id|ulong
id|address
suffix:semicolon
id|ulong
id|lbus
op_assign
id|pciData-&gt;bus
comma
id|lslot
op_assign
id|pciData-&gt;slot
comma
id|lfunc
op_assign
id|pciData-&gt;func
suffix:semicolon
id|uchar
id|t2CFA
comma
id|t2CF8
suffix:semicolon
id|ulong
id|t1CF8
comma
id|t1CFC
suffix:semicolon
id|ASC_DBG1
c_func
(paren
l_int|4
comma
l_string|&quot;asc_get_cfg_byte: type: %d&bslash;n&quot;
comma
id|pciData-&gt;type
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Check type of configuration mechanism.&n;&t; */
r_if
c_cond
(paren
id|pciData-&gt;type
op_eq
l_int|2
)paren
(brace
multiline_comment|/*&n;&t;&t; * Save registers to be restored later.&n;&t;&t; */
id|t2CFA
op_assign
id|inp
c_func
(paren
l_int|0xCFA
)paren
suffix:semicolon
multiline_comment|/* save PCI bus register */
id|t2CF8
op_assign
id|inp
c_func
(paren
l_int|0xCF8
)paren
suffix:semicolon
multiline_comment|/* save config space enable register */
multiline_comment|/*&n;&t;&t; * Write the bus and enable registers.&n;&t;&t; */
multiline_comment|/* set for type 1 cycle, if needed */
id|outp
c_func
(paren
l_int|0xCFA
comma
id|pciData-&gt;bus
)paren
suffix:semicolon
multiline_comment|/* set the function number */
id|outp
c_func
(paren
l_int|0xCF8
comma
l_int|0x10
op_or
(paren
id|pciData-&gt;func
op_lshift
l_int|1
)paren
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t; * Read configuration space type 2 locations.&n;&t;&t; */
id|tmp
op_assign
id|inp
c_func
(paren
l_int|0xC000
op_or
(paren
(paren
id|pciData-&gt;slot
op_lshift
l_int|8
)paren
op_plus
id|pciData-&gt;offset
)paren
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t; * Restore registers.&n;&t;&t; */
id|outp
c_func
(paren
l_int|0xCF8
comma
id|t2CF8
)paren
suffix:semicolon
multiline_comment|/* restore the enable register */
id|outp
c_func
(paren
l_int|0xCFA
comma
id|t2CFA
)paren
suffix:semicolon
multiline_comment|/* restore PCI bus register */
)brace
r_else
(brace
multiline_comment|/*&n;&t;&t; * Type 1 or 3 configuration mechanism.&n;&t;&t; *&n;&t;&t; * Save CONFIG_ADDRESS and CONFIG_DATA register values.&n;&t;&t; */
id|t1CF8
op_assign
id|inpl
c_func
(paren
l_int|0xCF8
)paren
suffix:semicolon
id|t1CFC
op_assign
id|inpl
c_func
(paren
l_int|0xCFC
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t; * enable &lt;31&gt;, bus = &lt;23:16&gt;, slot = &lt;15:11&gt;, func = &lt;10:8&gt;,&n;&t;&t; * reg = &lt;7:2&gt;&n;&t;&t; */
id|address
op_assign
(paren
id|ulong
)paren
(paren
(paren
id|lbus
op_lshift
l_int|16
)paren
op_or
(paren
id|lslot
op_lshift
l_int|11
)paren
op_or
(paren
id|lfunc
op_lshift
l_int|8
)paren
op_or
(paren
id|pciData-&gt;offset
op_amp
l_int|0xFC
)paren
op_or
l_int|0x80000000L
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t; * Write out address to CONFIG_ADDRESS.&n;&t;&t; */
id|outpl
c_func
(paren
l_int|0xCF8
comma
id|address
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t; * Read in word from CONFIG_DATA.&n;&t;&t; */
id|tmp
op_assign
(paren
id|uchar
)paren
(paren
(paren
id|inpl
c_func
(paren
l_int|0xCFC
)paren
op_rshift
(paren
(paren
id|pciData-&gt;offset
op_amp
l_int|3
)paren
op_star
l_int|8
)paren
)paren
op_amp
l_int|0xFF
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t; * Restore registers.&n;&t;&t; */
id|outpl
c_func
(paren
l_int|0xCF8
comma
id|t1CF8
)paren
suffix:semicolon
id|outpl
c_func
(paren
l_int|0xCFC
comma
id|t1CFC
)paren
suffix:semicolon
)brace
id|ASC_DBG1
c_func
(paren
l_int|4
comma
l_string|&quot;asc_get_cfg_byte: config data: %x&bslash;n&quot;
comma
id|tmp
)paren
suffix:semicolon
r_return
id|tmp
suffix:semicolon
)brace
multiline_comment|/*&n; * Write a byte to the PCI configuration space.&n; */
r_void
DECL|function|asc_put_cfg_byte
id|asc_put_cfg_byte
c_func
(paren
id|PCI_DATA
op_star
id|pciData
comma
id|uchar
id|byte_data
)paren
(brace
id|ulong
id|tmpl
suffix:semicolon
id|ulong
id|address
suffix:semicolon
id|ulong
id|lbus
op_assign
id|pciData-&gt;bus
comma
id|lslot
op_assign
id|pciData-&gt;slot
comma
id|lfunc
op_assign
id|pciData-&gt;func
suffix:semicolon
id|uchar
id|t2CFA
comma
id|t2CF8
suffix:semicolon
id|ulong
id|t1CF8
comma
id|t1CFC
suffix:semicolon
id|ASC_DBG2
c_func
(paren
l_int|4
comma
l_string|&quot;asc_put_cfg_byte: type: %d, byte_data %x&bslash;n&quot;
comma
id|pciData-&gt;type
comma
id|byte_data
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Check type of configuration mechanism.&n;&t; */
r_if
c_cond
(paren
id|pciData-&gt;type
op_eq
l_int|2
)paren
(brace
multiline_comment|/*&n;&t;&t; * Save registers to be restored later.&n;&t;&t; */
id|t2CFA
op_assign
id|inp
c_func
(paren
l_int|0xCFA
)paren
suffix:semicolon
multiline_comment|/* save PCI bus register */
id|t2CF8
op_assign
id|inp
c_func
(paren
l_int|0xCF8
)paren
suffix:semicolon
multiline_comment|/* save config space enable register */
multiline_comment|/*&n;&t;&t; * Write bus and enable registers.&n;&t;&t; */
id|outp
c_func
(paren
l_int|0xCFA
comma
id|pciData-&gt;bus
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t; * Set the function number.&n;&t;&t; */
id|outp
c_func
(paren
l_int|0xCF8
comma
l_int|0x10
op_or
(paren
id|pciData-&gt;func
op_lshift
l_int|1
)paren
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t; * Write the configuration space type 2 locations.&n;&t;&t; */
id|outp
c_func
(paren
l_int|0xC000
op_or
(paren
(paren
id|pciData-&gt;slot
op_lshift
l_int|8
)paren
op_plus
id|pciData-&gt;offset
)paren
comma
id|byte_data
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t; * Restore registers.&n;&t;&t; */
id|outp
c_func
(paren
l_int|0xCF8
comma
id|t2CF8
)paren
suffix:semicolon
multiline_comment|/* restore the enable register */
id|outp
c_func
(paren
l_int|0xCFA
comma
id|t2CFA
)paren
suffix:semicolon
multiline_comment|/* restore PCI bus register&t;*/
)brace
r_else
(brace
multiline_comment|/*&n;&t;&t; * Type 1 or 3 configuration mechanism.&n;&t;&t; *&n;&t;&t; * Save the CONFIG_ADDRESS and CONFIG_DATA register values.&n;&t;&t; */
id|t1CF8
op_assign
id|inpl
c_func
(paren
l_int|0xCF8
)paren
suffix:semicolon
id|t1CFC
op_assign
id|inpl
c_func
(paren
l_int|0xCFC
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t; * enable &lt;31&gt;, bus = &lt;23:16&gt;, slot = &lt;15:11&gt;, func = &lt;10:8&gt;,&n;&t;&t; * reg = &lt;7:2&gt;&n;&t;&t; */
id|address
op_assign
(paren
id|ulong
)paren
(paren
(paren
id|lbus
op_lshift
l_int|16
)paren
op_or
(paren
id|lslot
op_lshift
l_int|11
)paren
op_or
(paren
id|lfunc
op_lshift
l_int|8
)paren
op_or
(paren
id|pciData-&gt;offset
op_amp
l_int|0xFC
)paren
op_or
l_int|0x80000000L
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t; * Write out address to CONFIG_ADDRESS.&n;&t;&t; */
id|outpl
c_func
(paren
l_int|0xCF8
comma
id|address
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t; * Write double word to CONFIG_DATA preserving the bytes&n;&t;&t; * in the double not written.&n;&t;&t; */
id|tmpl
op_assign
id|inpl
c_func
(paren
l_int|0xCFC
)paren
op_amp
op_complement
(paren
l_int|0xFF
op_lshift
(paren
(paren
id|pciData-&gt;offset
op_amp
l_int|3
)paren
op_star
l_int|8
)paren
)paren
suffix:semicolon
id|outpl
c_func
(paren
l_int|0xCFC
comma
id|tmpl
op_or
(paren
id|byte_data
op_lshift
(paren
(paren
id|pciData-&gt;offset
op_amp
l_int|3
)paren
op_star
l_int|8
)paren
)paren
)paren
suffix:semicolon
multiline_comment|/*&n;&t;&t; * Restore registers.&n;&t;&t; */
id|outpl
c_func
(paren
l_int|0xCF8
comma
id|t1CF8
)paren
suffix:semicolon
id|outpl
c_func
(paren
l_int|0xCFC
comma
id|t1CFC
)paren
suffix:semicolon
)brace
id|ASC_DBG
c_func
(paren
l_int|4
comma
l_string|&quot;asc_put_cfg_byte: end&bslash;n&quot;
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Add a &squot;REQP&squot; to the end of specified queue. Set &squot;tidmask&squot;&n; * to indicate a command is queued for the device.&n; *&n; * &squot;flag&squot; may be either ASC_FRONT or ASC_BACK.&n; *&n; * &squot;REQPNEXT(reqp)&squot; returns reqp&squot;s next pointer.&n; */
r_void
DECL|function|asc_enqueue
id|asc_enqueue
c_func
(paren
id|asc_queue_t
op_star
id|ascq
comma
id|REQP
id|reqp
comma
r_int
id|flag
)paren
(brace
id|REQP
op_star
id|reqpp
suffix:semicolon
r_int
id|tid
suffix:semicolon
id|ASC_ASSERT
c_func
(paren
id|interrupts_enabled
c_func
(paren
)paren
op_eq
id|ASC_FALSE
)paren
suffix:semicolon
id|ASC_DBG3
c_func
(paren
l_int|2
comma
l_string|&quot;asc_enqueue: ascq %x, reqp %x, flag %d&bslash;n&quot;
comma
(paren
r_int
)paren
id|ascq
comma
(paren
r_int
)paren
id|reqp
comma
id|flag
)paren
suffix:semicolon
id|tid
op_assign
id|REQPTID
c_func
(paren
id|reqp
)paren
suffix:semicolon
id|ASC_ASSERT
c_func
(paren
id|flag
op_eq
id|ASC_FRONT
op_logical_or
id|flag
op_eq
id|ASC_BACK
)paren
suffix:semicolon
r_if
c_cond
(paren
id|flag
op_eq
id|ASC_FRONT
)paren
(brace
id|REQPNEXT
c_func
(paren
id|reqp
)paren
op_assign
id|ascq-&gt;queue
(braket
id|tid
)braket
suffix:semicolon
id|ascq-&gt;queue
(braket
id|tid
)braket
op_assign
id|reqp
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* ASC_BACK */
r_for
c_loop
(paren
id|reqpp
op_assign
op_amp
id|ascq-&gt;queue
(braket
id|tid
)braket
suffix:semicolon
op_star
id|reqpp
suffix:semicolon
id|reqpp
op_assign
id|REQPNEXTP
c_func
(paren
op_star
id|reqpp
)paren
)paren
(brace
id|ASC_ASSERT
c_func
(paren
id|ascq-&gt;tidmask
op_amp
id|ASC_TIX_TO_TARGET_ID
c_func
(paren
id|tid
)paren
)paren
suffix:semicolon
suffix:semicolon
)brace
op_star
id|reqpp
op_assign
id|reqp
suffix:semicolon
id|REQPNEXT
c_func
(paren
id|reqp
)paren
op_assign
l_int|NULL
suffix:semicolon
)brace
multiline_comment|/* The queue has at least one entry, set its bit. */
id|ascq-&gt;tidmask
op_or_assign
id|ASC_TIX_TO_TARGET_ID
c_func
(paren
id|tid
)paren
suffix:semicolon
macro_line|#ifdef ADVANSYS_STATS
multiline_comment|/*&n;&t; * Maintain request queue statistics.&n;&t; */
id|ascq-&gt;cur_count
(braket
id|tid
)braket
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|ascq-&gt;cur_count
(braket
id|tid
)braket
OG
id|ascq-&gt;max_count
(braket
id|tid
)braket
)paren
(brace
id|ascq-&gt;max_count
(braket
id|tid
)braket
op_assign
id|ascq-&gt;cur_count
(braket
id|tid
)braket
suffix:semicolon
id|ASC_DBG2
c_func
(paren
l_int|1
comma
l_string|&quot;asc_enqueue: new max_count[%d] %d&bslash;n&quot;
comma
id|tid
comma
id|ascq-&gt;max_count
(braket
id|tid
)braket
)paren
suffix:semicolon
)brace
macro_line|#endif /* ADVANSYS_STATS */
id|ASC_DBG1
c_func
(paren
l_int|1
comma
l_string|&quot;asc_enqueue: reqp %x&bslash;n&quot;
comma
(paren
r_int
)paren
id|reqp
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
multiline_comment|/*&n; * Return first queued &squot;REQP&squot; on the specified queue for&n; * the specified target device. Clear the &squot;tidmask&squot; bit for&n; * the device if no more commands are left queued for it.&n; *&n; * &squot;REQPNEXT(reqp)&squot; returns reqp&squot;s next pointer.&n; */
id|REQP
DECL|function|asc_dequeue
id|asc_dequeue
c_func
(paren
id|asc_queue_t
op_star
id|ascq
comma
r_int
id|tid
)paren
(brace
id|REQP
id|reqp
suffix:semicolon
id|ASC_ASSERT
c_func
(paren
id|interrupts_enabled
c_func
(paren
)paren
op_eq
id|ASC_FALSE
)paren
suffix:semicolon
id|ASC_DBG2
c_func
(paren
l_int|1
comma
l_string|&quot;asc_dequeue: ascq %x, tid %d&bslash;n&quot;
comma
(paren
r_int
)paren
id|ascq
comma
id|tid
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|reqp
op_assign
id|ascq-&gt;queue
(braket
id|tid
)braket
)paren
op_ne
l_int|NULL
)paren
(brace
id|ASC_ASSERT
c_func
(paren
id|ascq-&gt;tidmask
op_amp
id|ASC_TIX_TO_TARGET_ID
c_func
(paren
id|tid
)paren
)paren
suffix:semicolon
id|ascq-&gt;queue
(braket
id|tid
)braket
op_assign
id|REQPNEXT
c_func
(paren
id|reqp
)paren
suffix:semicolon
multiline_comment|/* If the queue is empty, clear its bit. */
r_if
c_cond
(paren
id|ascq-&gt;queue
(braket
id|tid
)braket
op_eq
l_int|NULL
)paren
(brace
id|ascq-&gt;tidmask
op_and_assign
op_complement
id|ASC_TIX_TO_TARGET_ID
c_func
(paren
id|tid
)paren
suffix:semicolon
)brace
)brace
macro_line|#ifdef ADVANSYS_STATS
multiline_comment|/*&n;&t; * Maintain request queue statistics.&n;&t; */
r_if
c_cond
(paren
id|reqp
op_ne
l_int|NULL
)paren
(brace
id|ascq-&gt;cur_count
(braket
id|tid
)braket
op_decrement
suffix:semicolon
)brace
id|ASC_ASSERT
c_func
(paren
id|ascq-&gt;cur_count
(braket
id|tid
)braket
op_ge
l_int|0
)paren
suffix:semicolon
macro_line|#endif /* ADVANSYS_STATS */
id|ASC_DBG1
c_func
(paren
l_int|1
comma
l_string|&quot;asc_dequeue: reqp %x&bslash;n&quot;
comma
(paren
r_int
)paren
id|reqp
)paren
suffix:semicolon
r_return
id|reqp
suffix:semicolon
)brace
multiline_comment|/*&n; * Remove the specified &squot;REQP&squot; from the specified queue for&n; * the specified target device. Clear the &squot;tidmask&squot; bit for the&n; * device if no more commands are left queued for it.&n; *&n; * &squot;REQPNEXT(reqp)&squot; returns reqp&squot;s the next pointer.&n; *&n; * Return ASC_TRUE if the command was found and removed,&n; * otherwise return ASC_FALSE.&n; */
r_int
DECL|function|asc_rmqueue
id|asc_rmqueue
c_func
(paren
id|asc_queue_t
op_star
id|ascq
comma
id|REQP
id|reqp
)paren
(brace
id|REQP
op_star
id|reqpp
suffix:semicolon
r_int
id|tid
suffix:semicolon
r_int
id|ret
suffix:semicolon
id|ASC_ASSERT
c_func
(paren
id|interrupts_enabled
c_func
(paren
)paren
op_eq
id|ASC_FALSE
)paren
suffix:semicolon
id|ret
op_assign
id|ASC_FALSE
suffix:semicolon
id|tid
op_assign
id|REQPTID
c_func
(paren
id|reqp
)paren
suffix:semicolon
r_for
c_loop
(paren
id|reqpp
op_assign
op_amp
id|ascq-&gt;queue
(braket
id|tid
)braket
suffix:semicolon
op_star
id|reqpp
suffix:semicolon
id|reqpp
op_assign
id|REQPNEXTP
c_func
(paren
op_star
id|reqpp
)paren
)paren
(brace
id|ASC_ASSERT
c_func
(paren
id|ascq-&gt;tidmask
op_amp
id|ASC_TIX_TO_TARGET_ID
c_func
(paren
id|tid
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|reqpp
op_eq
id|reqp
)paren
(brace
id|ret
op_assign
id|ASC_TRUE
suffix:semicolon
op_star
id|reqpp
op_assign
id|REQPNEXT
c_func
(paren
id|reqp
)paren
suffix:semicolon
id|REQPNEXT
c_func
(paren
id|reqp
)paren
op_assign
l_int|NULL
suffix:semicolon
multiline_comment|/* If the queue is now empty, clear its bit. */
r_if
c_cond
(paren
id|ascq-&gt;queue
(braket
id|tid
)braket
op_eq
l_int|NULL
)paren
(brace
id|ascq-&gt;tidmask
op_and_assign
op_complement
id|ASC_TIX_TO_TARGET_ID
c_func
(paren
id|tid
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
multiline_comment|/* Note: *reqpp may now be NULL, don&squot;t iterate. */
)brace
)brace
macro_line|#ifdef ADVANSYS_STATS
multiline_comment|/*&n;&t; * Maintain request queue statistics.&n;&t; */
r_if
c_cond
(paren
id|ret
op_eq
id|ASC_TRUE
)paren
(brace
id|ascq-&gt;cur_count
(braket
id|tid
)braket
op_decrement
suffix:semicolon
)brace
id|ASC_ASSERT
c_func
(paren
id|ascq-&gt;cur_count
(braket
id|tid
)braket
op_ge
l_int|0
)paren
suffix:semicolon
macro_line|#endif /* ADVANSYS_STATS */
id|ASC_DBG2
c_func
(paren
l_int|1
comma
l_string|&quot;asc_rmqueue: reqp %x, ret %d&bslash;n&quot;
comma
(paren
r_int
)paren
id|reqp
comma
id|ret
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
multiline_comment|/*&n; * If the specified &squot;REQP&squot; is queued on the specified queue for&n; * the specified target device, return ASC_TRUE.&n; */
r_int
DECL|function|asc_isqueued
id|asc_isqueued
c_func
(paren
id|asc_queue_t
op_star
id|ascq
comma
id|REQP
id|reqp
)paren
(brace
id|REQP
op_star
id|reqpp
suffix:semicolon
r_int
id|tid
suffix:semicolon
r_int
id|ret
suffix:semicolon
id|ASC_ASSERT
c_func
(paren
id|interrupts_enabled
c_func
(paren
)paren
op_eq
id|ASC_FALSE
)paren
suffix:semicolon
id|ret
op_assign
id|ASC_FALSE
suffix:semicolon
id|tid
op_assign
id|REQPTID
c_func
(paren
id|reqp
)paren
suffix:semicolon
r_for
c_loop
(paren
id|reqpp
op_assign
op_amp
id|ascq-&gt;queue
(braket
id|tid
)braket
suffix:semicolon
op_star
id|reqpp
suffix:semicolon
id|reqpp
op_assign
id|REQPNEXTP
c_func
(paren
op_star
id|reqpp
)paren
)paren
(brace
id|ASC_ASSERT
c_func
(paren
id|ascq-&gt;tidmask
op_amp
id|ASC_TIX_TO_TARGET_ID
c_func
(paren
id|tid
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|reqpp
op_eq
id|reqp
)paren
(brace
id|ret
op_assign
id|ASC_TRUE
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_return
id|ret
suffix:semicolon
)brace
multiline_comment|/*&n; * Execute as many queued requests as possible for the specified queue.&n; *&n; * Calls asc_execute_scsi_cmnd() to execute a REQP/Scsi_Cmnd.&n; */
r_void
DECL|function|asc_execute_queue
id|asc_execute_queue
c_func
(paren
id|asc_queue_t
op_star
id|ascq
)paren
(brace
id|ASC_SCSI_BIT_ID_TYPE
id|scan_tidmask
suffix:semicolon
id|REQP
id|reqp
suffix:semicolon
r_int
id|i
suffix:semicolon
id|ASC_ASSERT
c_func
(paren
id|interrupts_enabled
c_func
(paren
)paren
op_eq
id|ASC_FALSE
)paren
suffix:semicolon
id|ASC_DBG1
c_func
(paren
l_int|1
comma
l_string|&quot;asc_execute_queue: ascq %x&bslash;n&quot;
comma
(paren
r_int
)paren
id|ascq
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Execute queued commands for devices attached to&n;&t; * the current board in round-robin fashion.&n;&t; */
id|scan_tidmask
op_assign
id|ascq-&gt;tidmask
suffix:semicolon
r_do
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
id|ASC_MAX_TID
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|scan_tidmask
op_amp
id|ASC_TIX_TO_TARGET_ID
c_func
(paren
id|i
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
id|reqp
op_assign
id|asc_dequeue
c_func
(paren
id|ascq
comma
id|i
)paren
)paren
op_eq
l_int|NULL
)paren
(brace
id|scan_tidmask
op_and_assign
op_complement
id|ASC_TIX_TO_TARGET_ID
c_func
(paren
id|i
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|asc_execute_scsi_cmnd
c_func
(paren
(paren
id|Scsi_Cmnd
op_star
)paren
id|reqp
)paren
op_eq
id|ASC_BUSY
)paren
(brace
id|scan_tidmask
op_and_assign
op_complement
id|ASC_TIX_TO_TARGET_ID
c_func
(paren
id|i
)paren
suffix:semicolon
multiline_comment|/* Put the request back at front of the list. */
id|asc_enqueue
c_func
(paren
id|ascq
comma
id|reqp
comma
id|ASC_FRONT
)paren
suffix:semicolon
)brace
)brace
)brace
)brace
r_while
c_loop
(paren
id|scan_tidmask
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
multiline_comment|/*&n; * asc_prt_board_devices()&n; *&n; * Print driver information for devices attached to the board.&n; *&n; * Note: no single line should be greater than ASC_PRTLINE_SIZE,&n; * cf. asc_prt_line().&n; *&n; * Return the number of characters copied into &squot;cp&squot;. No more than&n; * &squot;cplen&squot; characters will be copied to &squot;cp&squot;.&n; */
id|STATIC
r_int
DECL|function|asc_prt_board_devices
id|asc_prt_board_devices
c_func
(paren
r_struct
id|Scsi_Host
op_star
id|shp
comma
r_char
op_star
id|cp
comma
r_int
id|cplen
)paren
(brace
r_struct
id|asc_board
op_star
id|boardp
suffix:semicolon
r_int
id|leftlen
suffix:semicolon
r_int
id|totlen
suffix:semicolon
r_int
id|len
suffix:semicolon
r_int
id|i
suffix:semicolon
id|boardp
op_assign
id|ASC_BOARDP
c_func
(paren
id|shp
)paren
suffix:semicolon
id|leftlen
op_assign
id|cplen
suffix:semicolon
id|totlen
op_assign
id|len
op_assign
l_int|0
suffix:semicolon
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot;&bslash;nDevice Information for AdvanSys SCSI Host %d:&bslash;n&quot;
comma
id|shp-&gt;host_no
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot;Target Ids Detected:&quot;
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
id|ASC_MAX_TID
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|boardp-&gt;asc_dvc_cfg.chip_scsi_id
op_eq
id|i
)paren
(brace
r_continue
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|boardp-&gt;init_tidmask
op_amp
(paren
l_int|1
op_lshift
id|i
)paren
)paren
(brace
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot; %d,&quot;
comma
id|i
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
)brace
)brace
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot; (%d=Host Adapter)&bslash;n&quot;
comma
id|boardp-&gt;asc_dvc_cfg.chip_scsi_id
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
r_return
id|totlen
suffix:semicolon
)brace
multiline_comment|/*&n; * asc_prt_board_eeprom()&n; *&n; * Print board EEPROM configuration.&n; *&n; * Note: no single line should be greater than ASC_PRTLINE_SIZE,&n; * cf. asc_prt_line().&n; *&n; * Return the number of characters copied into &squot;cp&squot;. No more than&n; * &squot;cplen&squot; characters will be copied to &squot;cp&squot;.&n; */
id|STATIC
r_int
DECL|function|asc_prt_board_eeprom
id|asc_prt_board_eeprom
c_func
(paren
r_struct
id|Scsi_Host
op_star
id|shp
comma
r_char
op_star
id|cp
comma
r_int
id|cplen
)paren
(brace
r_struct
id|asc_board
op_star
id|boardp
suffix:semicolon
id|ASC_DVC_VAR
op_star
id|asc_dvc_varp
suffix:semicolon
r_int
id|leftlen
suffix:semicolon
r_int
id|totlen
suffix:semicolon
r_int
id|len
suffix:semicolon
id|ASCEEP_CONFIG
op_star
id|ep
suffix:semicolon
r_int
id|i
suffix:semicolon
r_int
id|isa_dma_speed
(braket
)braket
op_assign
(brace
l_int|10
comma
l_int|8
comma
l_int|7
comma
l_int|6
comma
l_int|5
comma
l_int|4
comma
l_int|3
comma
l_int|2
)brace
suffix:semicolon
id|boardp
op_assign
id|ASC_BOARDP
c_func
(paren
id|shp
)paren
suffix:semicolon
id|asc_dvc_varp
op_assign
op_amp
id|boardp-&gt;asc_dvc_var
suffix:semicolon
id|ep
op_assign
op_amp
id|boardp-&gt;eep_config
suffix:semicolon
id|leftlen
op_assign
id|cplen
suffix:semicolon
id|totlen
op_assign
id|len
op_assign
l_int|0
suffix:semicolon
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot;&bslash;nEEPROM Settings for AdvanSys SCSI Host %d:&bslash;n&quot;
comma
id|shp-&gt;host_no
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot; Host SCSI ID: %u, Host Queue Size: %u, Device Queue Size: %u&bslash;n&quot;
comma
id|ep-&gt;chip_scsi_id
comma
id|ep-&gt;max_total_qng
comma
id|ep-&gt;max_tag_qng
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot; Disconnects:         &quot;
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
id|ASC_MAX_TID
suffix:semicolon
id|i
op_increment
)paren
(brace
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot; %d:%c&quot;
comma
id|i
comma
(paren
id|ep-&gt;disc_enable
op_amp
(paren
l_int|1
op_lshift
id|i
)paren
)paren
ques
c_cond
l_char|&squot;Y&squot;
suffix:colon
l_char|&squot;N&squot;
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
)brace
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot; Command Queuing:     &quot;
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
id|ASC_MAX_TID
suffix:semicolon
id|i
op_increment
)paren
(brace
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot; %d:%c&quot;
comma
id|i
comma
(paren
id|ep-&gt;use_cmd_qng
op_amp
(paren
l_int|1
op_lshift
id|i
)paren
)paren
ques
c_cond
l_char|&squot;Y&squot;
suffix:colon
l_char|&squot;N&squot;
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
)brace
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot; Start Motor:         &quot;
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
id|ASC_MAX_TID
suffix:semicolon
id|i
op_increment
)paren
(brace
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot; %d:%c&quot;
comma
id|i
comma
(paren
id|ep-&gt;start_motor
op_amp
(paren
l_int|1
op_lshift
id|i
)paren
)paren
ques
c_cond
l_char|&squot;Y&squot;
suffix:colon
l_char|&squot;N&squot;
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
)brace
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot; Synchronous Transfer:&quot;
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
id|ASC_MAX_TID
suffix:semicolon
id|i
op_increment
)paren
(brace
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot; %d:%c&quot;
comma
id|i
comma
(paren
id|ep-&gt;init_sdtr
op_amp
(paren
l_int|1
op_lshift
id|i
)paren
)paren
ques
c_cond
l_char|&squot;Y&squot;
suffix:colon
l_char|&squot;N&squot;
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
)brace
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|asc_dvc_varp-&gt;bus_type
op_amp
id|ASC_IS_ISA
)paren
(brace
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot; Host ISA DMA speed:   %d MB/S&bslash;n&quot;
comma
id|isa_dma_speed
(braket
id|ep-&gt;isa_dma_speed
)braket
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
)brace
r_return
id|totlen
suffix:semicolon
)brace
multiline_comment|/*&n; * asc_prt_board_info()&n; *&n; * Print dynamic board configuration information.&n; *&n; * Note: no single line should be greater than ASC_PRTLINE_SIZE,&n; * cf. asc_prt_line().&n; *&n; * Return the number of characters copied into &squot;cp&squot;. No more than&n; * &squot;cplen&squot; characters will be copied to &squot;cp&squot;.&n; */
id|STATIC
r_int
DECL|function|asc_prt_board_info
id|asc_prt_board_info
c_func
(paren
r_struct
id|Scsi_Host
op_star
id|shp
comma
r_char
op_star
id|cp
comma
r_int
id|cplen
)paren
(brace
r_struct
id|asc_board
op_star
id|boardp
suffix:semicolon
r_int
id|leftlen
suffix:semicolon
r_int
id|totlen
suffix:semicolon
r_int
id|len
suffix:semicolon
id|ASC_DVC_VAR
op_star
id|v
suffix:semicolon
id|ASC_DVC_CFG
op_star
id|c
suffix:semicolon
r_int
id|i
suffix:semicolon
macro_line|#ifdef ADVANSYS_STATS
r_struct
id|asc_stats
op_star
id|s
suffix:semicolon
macro_line|#endif /* ADVANSYS_STATS */
id|boardp
op_assign
id|ASC_BOARDP
c_func
(paren
id|shp
)paren
suffix:semicolon
id|v
op_assign
op_amp
id|boardp-&gt;asc_dvc_var
suffix:semicolon
id|c
op_assign
op_amp
id|boardp-&gt;asc_dvc_cfg
suffix:semicolon
id|leftlen
op_assign
id|cplen
suffix:semicolon
id|totlen
op_assign
id|len
op_assign
l_int|0
suffix:semicolon
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot;&bslash;nAsc Library Configuration and Statistics for AdvanSys SCSI Host %d:&bslash;n&quot;
comma
id|shp-&gt;host_no
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot; chip_version %u, lib_version %u, lib_serial_no %u mcode_date %u&bslash;n&quot;
comma
id|c-&gt;chip_version
comma
id|c-&gt;lib_version
comma
id|c-&gt;lib_serial_no
comma
id|c-&gt;mcode_date
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot; mcode_version %u, err_code %u&bslash;n&quot;
comma
id|c-&gt;mcode_version
comma
id|v-&gt;err_code
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* Current number of commands pending for the host. */
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot; Total Command Pending:    %d&bslash;n&quot;
comma
id|v-&gt;cur_total_qng
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot; Synchronous Transfer:    &quot;
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
id|ASC_MAX_TID
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|boardp-&gt;asc_dvc_cfg.chip_scsi_id
op_eq
id|i
)paren
op_logical_or
(paren
(paren
id|boardp-&gt;init_tidmask
op_amp
(paren
l_int|1
op_lshift
id|i
)paren
)paren
op_eq
l_int|0
)paren
)paren
(brace
r_continue
suffix:semicolon
)brace
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot; %d:%c&quot;
comma
id|i
comma
(paren
id|v-&gt;sdtr_done
op_amp
(paren
l_int|1
op_lshift
id|i
)paren
)paren
ques
c_cond
l_char|&squot;Y&squot;
suffix:colon
l_char|&squot;N&squot;
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
)brace
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot; Command Queuing:         &quot;
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
id|ASC_MAX_TID
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|boardp-&gt;asc_dvc_cfg.chip_scsi_id
op_eq
id|i
)paren
op_logical_or
(paren
(paren
id|boardp-&gt;init_tidmask
op_amp
(paren
l_int|1
op_lshift
id|i
)paren
)paren
op_eq
l_int|0
)paren
)paren
(brace
r_continue
suffix:semicolon
)brace
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot; %d:%c&quot;
comma
id|i
comma
(paren
id|v-&gt;use_tagged_qng
op_amp
(paren
l_int|1
op_lshift
id|i
)paren
)paren
ques
c_cond
l_char|&squot;Y&squot;
suffix:colon
l_char|&squot;N&squot;
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
)brace
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* Current number of commands pending for a device. */
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot; Command Queue Pending:   &quot;
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
id|ASC_MAX_TID
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|boardp-&gt;asc_dvc_cfg.chip_scsi_id
op_eq
id|i
)paren
op_logical_or
(paren
(paren
id|boardp-&gt;init_tidmask
op_amp
(paren
l_int|1
op_lshift
id|i
)paren
)paren
op_eq
l_int|0
)paren
)paren
(brace
r_continue
suffix:semicolon
)brace
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot; %d:%u&quot;
comma
id|i
comma
id|v-&gt;cur_dvc_qng
(braket
id|i
)braket
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
)brace
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* Current limit on number of commands that can be sent to a device. */
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot; Command Queue Limit:     &quot;
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
id|ASC_MAX_TID
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|boardp-&gt;asc_dvc_cfg.chip_scsi_id
op_eq
id|i
)paren
op_logical_or
(paren
(paren
id|boardp-&gt;init_tidmask
op_amp
(paren
l_int|1
op_lshift
id|i
)paren
)paren
op_eq
l_int|0
)paren
)paren
(brace
r_continue
suffix:semicolon
)brace
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot; %d:%u&quot;
comma
id|i
comma
id|v-&gt;max_dvc_qng
(braket
id|i
)braket
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
)brace
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
macro_line|#ifdef ADVANSYS_STATS
id|s
op_assign
op_amp
id|boardp-&gt;asc_stats
suffix:semicolon
multiline_comment|/* Indicate whether the device has returned queue full status. */
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot; Command Queue Full:      &quot;
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
id|ASC_MAX_TID
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|boardp-&gt;asc_dvc_cfg.chip_scsi_id
op_eq
id|i
)paren
op_logical_or
(paren
(paren
id|boardp-&gt;init_tidmask
op_amp
(paren
l_int|1
op_lshift
id|i
)paren
)paren
op_eq
l_int|0
)paren
)paren
(brace
r_continue
suffix:semicolon
)brace
r_if
c_cond
(paren
id|s-&gt;queue_full
op_amp
(paren
l_int|1
op_lshift
id|i
)paren
)paren
(brace
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot; %d:Y-%d&quot;
comma
id|i
comma
id|s-&gt;queue_full_cnt
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
r_else
(brace
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot; %d:N&quot;
comma
id|i
)paren
suffix:semicolon
)brace
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
)brace
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
macro_line|#endif /* ADVANSYS_STATS */
r_return
id|totlen
suffix:semicolon
)brace
macro_line|#if LINUX_VERSION_CODE &gt;= ASC_LINUX_VERSION(1,3,0)
multiline_comment|/*&n; * asc_proc_copy() &n; *&n; * Copy proc information to a read buffer taking into account the current&n; * read offset in the file and the remaining space in the read buffer.&n; */
id|STATIC
r_int
DECL|function|asc_proc_copy
id|asc_proc_copy
c_func
(paren
id|off_t
id|advoffset
comma
id|off_t
id|offset
comma
r_char
op_star
id|curbuf
comma
r_int
id|leftlen
comma
r_char
op_star
id|cp
comma
r_int
id|cplen
)paren
(brace
r_int
id|cnt
op_assign
l_int|0
suffix:semicolon
id|ASC_DBG3
c_func
(paren
l_int|2
comma
l_string|&quot;asc_proc_copy: offset %d, advoffset %d, cplen %d&bslash;n&quot;
comma
(paren
r_int
)paren
id|offset
comma
(paren
r_int
)paren
id|advoffset
comma
id|cplen
)paren
suffix:semicolon
r_if
c_cond
(paren
id|offset
op_le
id|advoffset
)paren
(brace
multiline_comment|/* Read offset below current offset, copy everything. */
id|cnt
op_assign
id|ASC_MIN
c_func
(paren
id|cplen
comma
id|leftlen
)paren
suffix:semicolon
id|ASC_DBG3
c_func
(paren
l_int|2
comma
l_string|&quot;asc_proc_copy: curbuf %x, cp %x, cnt %d&bslash;n&quot;
comma
(paren
r_int
)paren
id|curbuf
comma
(paren
r_int
)paren
id|cp
comma
id|cnt
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|curbuf
comma
id|cp
comma
id|cnt
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|offset
OL
id|advoffset
op_plus
id|cplen
)paren
(brace
multiline_comment|/* Read offset within current range, partial copy. */
id|cnt
op_assign
(paren
id|advoffset
op_plus
id|cplen
)paren
op_minus
id|offset
suffix:semicolon
id|cp
op_assign
(paren
id|cp
op_plus
id|cplen
)paren
op_minus
id|cnt
suffix:semicolon
id|cnt
op_assign
id|ASC_MIN
c_func
(paren
id|cnt
comma
id|leftlen
)paren
suffix:semicolon
id|ASC_DBG3
c_func
(paren
l_int|2
comma
l_string|&quot;asc_proc_copy: curbuf %x, cp %x, cnt %d&bslash;n&quot;
comma
(paren
r_int
)paren
id|curbuf
comma
(paren
r_int
)paren
id|cp
comma
id|cnt
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|curbuf
comma
id|cp
comma
id|cnt
)paren
suffix:semicolon
)brace
r_return
id|cnt
suffix:semicolon
)brace
macro_line|#endif /* version &gt;= v1.3.0 */
multiline_comment|/*&n; * asc_prt_line()&n; *&n; * If &squot;cp&squot; is NULL print to the console, otherwise print to a buffer.&n; *&n; * Return 0 if printing to the console, otherwise return the number of&n; * bytes written to the buffer.&n; *&n; * Note: If any single line is greater than ASC_PRTLINE_SIZE bytes the stack&n; * will be corrupted. &squot;s[]&squot; is defined to be ASC_PRTLINE_SIZE bytes.&n; */
r_int
DECL|function|asc_prt_line
id|asc_prt_line
c_func
(paren
r_char
op_star
id|buf
comma
r_int
id|buflen
comma
r_char
op_star
id|fmt
comma
dot
dot
dot
)paren
(brace
id|va_list
id|args
suffix:semicolon
r_int
id|ret
suffix:semicolon
r_char
id|s
(braket
id|ASC_PRTLINE_SIZE
)braket
suffix:semicolon
id|va_start
c_func
(paren
id|args
comma
id|fmt
)paren
suffix:semicolon
id|ret
op_assign
id|vsprintf
c_func
(paren
id|s
comma
id|fmt
comma
id|args
)paren
suffix:semicolon
id|ASC_ASSERT
c_func
(paren
id|ret
OL
id|ASC_PRTLINE_SIZE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|buf
op_eq
l_int|NULL
)paren
(brace
(paren
r_void
)paren
id|printk
c_func
(paren
id|s
)paren
suffix:semicolon
id|ret
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|ret
op_assign
id|ASC_MIN
c_func
(paren
id|buflen
comma
id|ret
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|buf
comma
id|s
comma
id|ret
)paren
suffix:semicolon
)brace
id|va_end
c_func
(paren
id|args
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
multiline_comment|/*&n; * --- Functions Required by the Asc Library&n; */
multiline_comment|/*&n; * Delay for &squot;n&squot; milliseconds. Don&squot;t use the &squot;jiffies&squot;&n; * global variable which is incremented once every 5 ms&n; * from a timer interrupt, because this function may be&n; * called when interrupts are disabled.&n; */
r_void
DECL|function|DvcSleepMilliSecond
id|DvcSleepMilliSecond
c_func
(paren
id|ulong
id|n
)paren
(brace
id|ulong
id|i
suffix:semicolon
id|ASC_DBG1
c_func
(paren
l_int|4
comma
l_string|&quot;DvcSleepMilliSecond: %lu&bslash;n&quot;
comma
id|n
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|n
suffix:semicolon
id|i
op_increment
)paren
(brace
id|udelay
c_func
(paren
l_int|1000
)paren
suffix:semicolon
)brace
)brace
r_void
DECL|function|DvcDisplayString
id|DvcDisplayString
c_func
(paren
id|uchar
op_star
id|s
)paren
(brace
id|printk
c_func
(paren
id|s
)paren
suffix:semicolon
)brace
r_int
DECL|function|DvcEnterCritical
id|DvcEnterCritical
c_func
(paren
r_void
)paren
(brace
r_int
id|flags
suffix:semicolon
id|save_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
id|cli
c_func
(paren
)paren
suffix:semicolon
r_return
id|flags
suffix:semicolon
)brace
r_void
DECL|function|DvcLeaveCritical
id|DvcLeaveCritical
c_func
(paren
r_int
id|flags
)paren
(brace
id|restore_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Convert a virtual address to a virtual address.&n; *&n; * Apparently Linux is loaded V=R (virtual equals real). Just return&n; * the virtual address.&n; */
id|ulong
DECL|function|DvcGetPhyAddr
id|DvcGetPhyAddr
c_func
(paren
id|uchar
op_star
id|buf_addr
comma
id|ulong
id|buf_len
)paren
(brace
id|ulong
id|phys_addr
suffix:semicolon
id|phys_addr
op_assign
(paren
id|ulong
)paren
id|buf_addr
suffix:semicolon
r_return
id|phys_addr
suffix:semicolon
)brace
id|ulong
DECL|function|DvcGetSGList
id|DvcGetSGList
c_func
(paren
id|ASC_DVC_VAR
op_star
id|asc_dvc_sg
comma
id|uchar
op_star
id|buf_addr
comma
id|ulong
id|buf_len
comma
id|ASC_SG_HEAD
op_star
id|asc_sg_head_ptr
)paren
(brace
id|ulong
id|buf_size
suffix:semicolon
id|buf_size
op_assign
id|buf_len
suffix:semicolon
id|asc_sg_head_ptr-&gt;entry_cnt
op_assign
l_int|1
suffix:semicolon
id|asc_sg_head_ptr-&gt;sg_list
(braket
l_int|0
)braket
dot
id|addr
op_assign
(paren
id|ulong
)paren
id|buf_addr
suffix:semicolon
id|asc_sg_head_ptr-&gt;sg_list
(braket
l_int|0
)braket
dot
id|bytes
op_assign
id|buf_size
suffix:semicolon
r_return
id|buf_size
suffix:semicolon
)brace
multiline_comment|/*&n; * void&n; * DvcPutScsiQ(PortAddr iop_base, ushort s_addr, ushort *outbuf, int words)&n; *&n; * Calling/Exit State:&n; *&t;none&n; *&n; * Description:&n; * &t;Output an ASC_SCSI_Q structure to the chip&n; */
r_void
DECL|function|DvcPutScsiQ
id|DvcPutScsiQ
c_func
(paren
id|PortAddr
id|iop_base
comma
id|ushort
id|s_addr
comma
id|ushort
op_star
id|outbuf
comma
r_int
id|words
)paren
(brace
r_int
id|i
suffix:semicolon
id|ASC_DBG_PRT_HEX
c_func
(paren
l_int|2
comma
l_string|&quot;DvcPutScsiQ&quot;
comma
(paren
id|uchar
op_star
)paren
id|outbuf
comma
l_int|2
op_star
id|words
)paren
suffix:semicolon
id|AscSetChipLramAddr
c_func
(paren
id|iop_base
comma
id|s_addr
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|words
suffix:semicolon
id|i
op_increment
comma
id|outbuf
op_increment
)paren
(brace
r_if
c_cond
(paren
id|i
op_eq
l_int|2
op_logical_or
id|i
op_eq
l_int|10
)paren
(brace
r_continue
suffix:semicolon
)brace
id|AscSetChipLramDataNoSwap
c_func
(paren
id|iop_base
comma
op_star
id|outbuf
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/*&n; * void&n; * DvcGetQinfo(PortAddr iop_base, ushort s_addr, ushort *inbuf, int words)&n; *&n; * Calling/Exit State:&n; *&t;none&n; *&n; * Description:&n; * &t;Input an ASC_QDONE_INFO structure from the chip&n; */
r_void
DECL|function|DvcGetQinfo
id|DvcGetQinfo
c_func
(paren
id|PortAddr
id|iop_base
comma
id|ushort
id|s_addr
comma
id|ushort
op_star
id|inbuf
comma
r_int
id|words
)paren
(brace
r_int
id|i
suffix:semicolon
id|AscSetChipLramAddr
c_func
(paren
id|iop_base
comma
id|s_addr
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|words
suffix:semicolon
id|i
op_increment
comma
id|inbuf
op_increment
)paren
(brace
r_if
c_cond
(paren
id|i
op_eq
l_int|5
)paren
(brace
r_continue
suffix:semicolon
)brace
op_star
id|inbuf
op_assign
id|AscGetChipLramDataNoSwap
c_func
(paren
id|iop_base
)paren
suffix:semicolon
)brace
id|ASC_DBG_PRT_HEX
c_func
(paren
l_int|2
comma
l_string|&quot;DvcGetQinfo&quot;
comma
(paren
id|uchar
op_star
)paren
id|inbuf
comma
l_int|2
op_star
id|words
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * void&t;DvcOutPortWords(ushort iop_base, ushort &amp;outbuf, int words)&n; *&n; * Calling/Exit State:&n; *&t;none&n; *&n; * Description:&n; * &t;output a buffer to an i/o port address&n; */
r_void
DECL|function|DvcOutPortWords
id|DvcOutPortWords
c_func
(paren
id|ushort
id|iop_base
comma
id|ushort
op_star
id|outbuf
comma
r_int
id|words
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|words
suffix:semicolon
id|i
op_increment
comma
id|outbuf
op_increment
)paren
id|outpw
c_func
(paren
id|iop_base
comma
op_star
id|outbuf
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * void&t;DvcInPortWords(ushort iop_base, ushort &amp;outbuf, int words)&n; *&n; * Calling/Exit State:&n; *&t;none&n; *&n; * Description:&n; * &t;input a buffer from an i/o port address&n; */
r_void
DECL|function|DvcInPortWords
id|DvcInPortWords
c_func
(paren
id|ushort
id|iop_base
comma
id|ushort
op_star
id|inbuf
comma
r_int
id|words
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|words
suffix:semicolon
id|i
op_increment
comma
id|inbuf
op_increment
)paren
op_star
id|inbuf
op_assign
id|inpw
c_func
(paren
id|iop_base
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * void DvcOutPortDWords(PortAddr port, ulong *pdw, int dwords)&n; *&n; * Calling/Exit State:&n; *&t;none&n; *&n; * Description:&n; * &t;output a buffer of 32-bit integers to an i/o port address in&n; *  16 bit integer units&n; */
r_void
DECL|function|DvcOutPortDWords
id|DvcOutPortDWords
c_func
(paren
id|PortAddr
id|port
comma
id|ulong
op_star
id|pdw
comma
r_int
id|dwords
)paren
(brace
r_int
id|i
suffix:semicolon
r_int
id|words
suffix:semicolon
id|ushort
op_star
id|pw
suffix:semicolon
id|pw
op_assign
(paren
id|ushort
op_star
)paren
id|pdw
suffix:semicolon
id|words
op_assign
id|dwords
op_lshift
l_int|1
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|words
suffix:semicolon
id|i
op_increment
comma
id|pw
op_increment
)paren
(brace
id|outpw
c_func
(paren
id|port
comma
op_star
id|pw
)paren
suffix:semicolon
)brace
r_return
suffix:semicolon
)brace
multiline_comment|/*&n; * Read a PCI configuration byte.&n; */
id|uchar
DECL|function|DvcReadPCIConfigByte
id|DvcReadPCIConfigByte
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|ushort
id|offset
)paren
(brace
id|PCI_DATA
id|pciData
suffix:semicolon
id|pciData.bus
op_assign
id|ASC_PCI_ID2BUS
c_func
(paren
id|asc_dvc-&gt;cfg-&gt;pci_slot_info
)paren
suffix:semicolon
id|pciData.slot
op_assign
id|ASC_PCI_ID2DEV
c_func
(paren
id|asc_dvc-&gt;cfg-&gt;pci_slot_info
)paren
suffix:semicolon
id|pciData.func
op_assign
id|ASC_PCI_ID2FUNC
c_func
(paren
id|asc_dvc-&gt;cfg-&gt;pci_slot_info
)paren
suffix:semicolon
id|pciData.offset
op_assign
id|offset
suffix:semicolon
id|pciData.type
op_assign
id|pci_scan_method
suffix:semicolon
r_return
id|asc_get_cfg_byte
c_func
(paren
op_amp
id|pciData
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Write a PCI configuration byte.&n; */
r_void
DECL|function|DvcWritePCIConfigByte
id|DvcWritePCIConfigByte
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|ushort
id|offset
comma
id|uchar
id|byte_data
)paren
(brace
id|PCI_DATA
id|pciData
suffix:semicolon
id|pciData.bus
op_assign
id|ASC_PCI_ID2BUS
c_func
(paren
id|asc_dvc-&gt;cfg-&gt;pci_slot_info
)paren
suffix:semicolon
id|pciData.slot
op_assign
id|ASC_PCI_ID2DEV
c_func
(paren
id|asc_dvc-&gt;cfg-&gt;pci_slot_info
)paren
suffix:semicolon
id|pciData.func
op_assign
id|ASC_PCI_ID2FUNC
c_func
(paren
id|asc_dvc-&gt;cfg-&gt;pci_slot_info
)paren
suffix:semicolon
id|pciData.offset
op_assign
id|offset
suffix:semicolon
id|pciData.type
op_assign
id|pci_scan_method
suffix:semicolon
id|asc_put_cfg_byte
c_func
(paren
op_amp
id|pciData
comma
id|byte_data
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Return the BIOS address of the adatper at the specified&n; * I/O port and with the specified bus type.&n; *&n; * This function was formerly supplied by the library.&n; */
id|ushort
DECL|function|AscGetChipBiosAddress
id|AscGetChipBiosAddress
c_func
(paren
id|PortAddr
id|iop_base
comma
id|ushort
id|bus_type
)paren
(brace
id|ushort
id|cfg_lsw
suffix:semicolon
id|ushort
id|bios_addr
suffix:semicolon
multiline_comment|/*&n;     *   We can&squot;t get the BIOS address for PCI&n;     */
r_if
c_cond
(paren
id|bus_type
op_amp
id|ASC_IS_PCI
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|bus_type
op_amp
id|ASC_IS_EISA
)paren
op_ne
l_int|0
)paren
(brace
id|cfg_lsw
op_assign
id|AscGetEisaChipCfg
c_func
(paren
id|iop_base
)paren
suffix:semicolon
id|cfg_lsw
op_and_assign
l_int|0x000F
suffix:semicolon
id|bios_addr
op_assign
(paren
id|ushort
)paren
(paren
id|ASC_BIOS_MIN_ADDR
op_plus
(paren
id|cfg_lsw
op_star
id|ASC_BIOS_BANK_SIZE
)paren
)paren
suffix:semicolon
r_return
(paren
id|bios_addr
)paren
suffix:semicolon
)brace
multiline_comment|/* if */
id|cfg_lsw
op_assign
id|AscGetChipCfgLsw
c_func
(paren
id|iop_base
)paren
suffix:semicolon
multiline_comment|/*&n;    *  ISA PnP uses the top bit as the 32K BIOS flag&n;    */
r_if
c_cond
(paren
id|bus_type
op_eq
id|ASC_IS_ISAPNP
)paren
(brace
id|cfg_lsw
op_and_assign
l_int|0x7FFF
suffix:semicolon
)brace
multiline_comment|/* if */
id|bios_addr
op_assign
(paren
id|ushort
)paren
(paren
(paren
(paren
id|cfg_lsw
op_rshift
l_int|12
)paren
op_star
id|ASC_BIOS_BANK_SIZE
)paren
op_plus
id|ASC_BIOS_MIN_ADDR
)paren
suffix:semicolon
r_return
(paren
id|bios_addr
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * --- Tracing and Debugging Functions&n; */
macro_line|#ifdef ADVANSYS_STATS
multiline_comment|/*&n; * asc_prt_board_stats()&n; *&n; * Note: no single line should be greater than ASC_PRTLINE_SIZE,&n; * cf. asc_prt_line().&n; *&n; * Return the number of characters copied into &squot;cp&squot;. No more than&n; * &squot;cplen&squot; characters will be copied to &squot;cp&squot;.&n; */
id|STATIC
r_int
DECL|function|asc_prt_board_stats
id|asc_prt_board_stats
c_func
(paren
r_struct
id|Scsi_Host
op_star
id|shp
comma
r_char
op_star
id|cp
comma
r_int
id|cplen
)paren
(brace
r_int
id|leftlen
suffix:semicolon
r_int
id|totlen
suffix:semicolon
r_int
id|len
suffix:semicolon
r_struct
id|asc_stats
op_star
id|s
suffix:semicolon
r_int
id|i
suffix:semicolon
id|asc_queue_t
op_star
id|active
suffix:semicolon
id|asc_queue_t
op_star
id|pending
suffix:semicolon
id|leftlen
op_assign
id|cplen
suffix:semicolon
id|totlen
op_assign
id|len
op_assign
l_int|0
suffix:semicolon
id|s
op_assign
op_amp
id|ASC_BOARDP
c_func
(paren
id|shp
)paren
op_member_access_from_pointer
id|asc_stats
suffix:semicolon
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot;&bslash;nLinux Driver Statistics for AdvanSys SCSI Host %d:&bslash;n&quot;
comma
id|shp-&gt;host_no
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot; command %lu, queuecommand %lu, abort %lu, reset %lu, biosparam %lu&bslash;n&quot;
comma
id|s-&gt;command
comma
id|s-&gt;queuecommand
comma
id|s
op_member_access_from_pointer
m_abort
comma
id|s-&gt;reset
comma
id|s-&gt;biosparam
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot; check_interrupt %lu, interrupt %lu, callback %lu&bslash;n&quot;
comma
id|s-&gt;check_interrupt
comma
id|s-&gt;interrupt
comma
id|s-&gt;callback
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot; asc_noerror %lu, asc_busy %lu, asc_error %lu, asc_unknown %lu&bslash;n&quot;
comma
id|s-&gt;asc_noerror
comma
id|s-&gt;asc_busy
comma
id|s-&gt;asc_error
comma
id|s-&gt;asc_unknown
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Display request queuing statistics.&n;&t; */
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot; Active and Pending Request Queues:&bslash;n&quot;
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
id|active
op_assign
op_amp
id|ASC_BOARDP
c_func
(paren
id|shp
)paren
op_member_access_from_pointer
id|active
suffix:semicolon
id|pending
op_assign
op_amp
id|ASC_BOARDP
c_func
(paren
id|shp
)paren
op_member_access_from_pointer
id|pending
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ASC_MAX_TID
op_plus
l_int|1
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|active-&gt;max_count
(braket
id|i
)braket
OG
l_int|0
op_logical_or
id|pending-&gt;max_count
(braket
id|i
)braket
OG
l_int|0
)paren
(brace
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot;  target %d: active [cur %d, max %d], pending [cur %d, max %d]&bslash;n&quot;
comma
id|i
comma
id|active-&gt;cur_count
(braket
id|i
)braket
comma
id|active-&gt;max_count
(braket
id|i
)braket
comma
id|pending-&gt;cur_count
(braket
id|i
)braket
comma
id|pending-&gt;max_count
(braket
id|i
)braket
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/*&n;&t; * Display data transfer statistics.&n;&t; */
r_if
c_cond
(paren
id|s-&gt;cont_cnt
OG
l_int|0
)paren
(brace
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot; cont_cnt %lu, &quot;
comma
id|s-&gt;cont_cnt
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot;cont_xfer %lu.%01lu kb &quot;
comma
id|s-&gt;cont_xfer
op_div
l_int|2
comma
id|ASC_TENTHS
c_func
(paren
id|s-&gt;cont_xfer
comma
l_int|2
)paren
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* Contiguous transfer average size */
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot;avg_xfer %lu.%01lu kb&bslash;n&quot;
comma
(paren
id|s-&gt;cont_xfer
op_div
l_int|2
)paren
op_div
id|s-&gt;cont_cnt
comma
id|ASC_TENTHS
c_func
(paren
(paren
id|s-&gt;cont_xfer
op_div
l_int|2
)paren
comma
id|s-&gt;cont_cnt
)paren
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|s-&gt;sg_cnt
OG
l_int|0
)paren
(brace
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot; sg_cnt %lu, sg_elem %lu, &quot;
comma
id|s-&gt;sg_cnt
comma
id|s-&gt;sg_elem
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot;sg_xfer %lu.%01lu kb&bslash;n&quot;
comma
id|s-&gt;sg_xfer
op_div
l_int|2
comma
id|ASC_TENTHS
c_func
(paren
id|s-&gt;sg_xfer
comma
l_int|2
)paren
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* Scatter gather transfer statistics */
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot; avg_num_elem %lu.%01lu, &quot;
comma
id|s-&gt;sg_elem
op_div
id|s-&gt;sg_cnt
comma
id|ASC_TENTHS
c_func
(paren
id|s-&gt;sg_elem
comma
id|s-&gt;sg_cnt
)paren
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot;avg_elem_size %lu.%01lu kb, &quot;
comma
(paren
id|s-&gt;sg_xfer
op_div
l_int|2
)paren
op_div
id|s-&gt;sg_elem
comma
id|ASC_TENTHS
c_func
(paren
(paren
id|s-&gt;sg_xfer
op_div
l_int|2
)paren
comma
id|s-&gt;sg_elem
)paren
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
id|len
op_assign
id|asc_prt_line
c_func
(paren
id|cp
comma
id|leftlen
comma
l_string|&quot;avg_xfer_size %lu.%01lu kb&bslash;n&quot;
comma
(paren
id|s-&gt;sg_xfer
op_div
l_int|2
)paren
op_div
id|s-&gt;sg_cnt
comma
id|ASC_TENTHS
c_func
(paren
(paren
id|s-&gt;sg_xfer
op_div
l_int|2
)paren
comma
id|s-&gt;sg_cnt
)paren
)paren
suffix:semicolon
id|ASC_PRT_NEXT
c_func
(paren
)paren
suffix:semicolon
)brace
r_return
id|totlen
suffix:semicolon
)brace
macro_line|#endif /* ADVANSYS_STATS */
macro_line|#ifdef ADVANSYS_DEBUG
multiline_comment|/*&n; * asc_prt_scsi_host()&n; */
id|STATIC
r_void
DECL|function|asc_prt_scsi_host
id|asc_prt_scsi_host
c_func
(paren
r_struct
id|Scsi_Host
op_star
id|s
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;Scsi_Host at addr %x&bslash;n&quot;
comma
(paren
r_int
)paren
id|s
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; next %x, extra_bytes %u, host_busy %u, host_no %d, last_reset %d,&bslash;n&quot;
comma
(paren
r_int
)paren
id|s-&gt;next
comma
id|s-&gt;extra_bytes
comma
id|s-&gt;host_busy
comma
id|s-&gt;host_no
comma
(paren
r_int
)paren
id|s-&gt;last_reset
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; host_wait %x, host_queue %x, hostt %x, block %x,&bslash;n&quot;
comma
(paren
r_int
)paren
id|s-&gt;host_wait
comma
(paren
r_int
)paren
id|s-&gt;host_queue
comma
(paren
r_int
)paren
id|s-&gt;hostt
comma
(paren
r_int
)paren
id|s-&gt;block
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; wish_block %d, base %x, io_port %d, n_io_port %d, irq %d, dma_channel %d,&bslash;n&quot;
comma
id|s-&gt;wish_block
comma
(paren
r_int
)paren
id|s-&gt;base
comma
id|s-&gt;io_port
comma
id|s-&gt;n_io_port
comma
id|s-&gt;irq
comma
id|s-&gt;dma_channel
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; this_id %d, can_queue %d,&bslash;n&quot;
comma
id|s-&gt;this_id
comma
id|s-&gt;can_queue
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; cmd_per_lun %d, sg_tablesize %d, unchecked_isa_dma %d, loaded_as_module %d&bslash;n&quot;
comma
id|s-&gt;cmd_per_lun
comma
id|s-&gt;sg_tablesize
comma
id|s-&gt;unchecked_isa_dma
comma
id|s-&gt;loaded_as_module
)paren
suffix:semicolon
id|asc_prt_dvc_var
c_func
(paren
op_amp
id|ASC_BOARDP
c_func
(paren
id|s
)paren
op_member_access_from_pointer
id|asc_dvc_var
)paren
suffix:semicolon
id|asc_prt_dvc_cfg
c_func
(paren
op_amp
id|ASC_BOARDP
c_func
(paren
id|s
)paren
op_member_access_from_pointer
id|asc_dvc_cfg
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * asc_prt_dvc_var()&n; */
id|STATIC
r_void
DECL|function|asc_prt_dvc_var
id|asc_prt_dvc_var
c_func
(paren
id|ASC_DVC_VAR
op_star
id|h
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;ASC_DVC_VAR at addr %x&bslash;n&quot;
comma
(paren
r_int
)paren
id|h
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; iop_base %x, err_code %x, dvc_cntl %x, bug_fix_cntl %d,&bslash;n&quot;
comma
id|h-&gt;iop_base
comma
id|h-&gt;err_code
comma
id|h-&gt;dvc_cntl
comma
id|h-&gt;bug_fix_cntl
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; bus_type %d, isr_callback %x, exe_callback %x, init_sdtr %x,&bslash;n&quot;
comma
id|h-&gt;bus_type
comma
(paren
r_int
)paren
id|h-&gt;isr_callback
comma
(paren
r_int
)paren
id|h-&gt;exe_callback
comma
(paren
r_int
)paren
id|h-&gt;init_sdtr
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; sdtr_done %x, use_tagged_qng %x, unit_not_ready %x, chip_no %x,&bslash;n&quot;
comma
(paren
r_int
)paren
id|h-&gt;sdtr_done
comma
(paren
r_int
)paren
id|h-&gt;use_tagged_qng
comma
(paren
r_int
)paren
id|h-&gt;unit_not_ready
comma
(paren
r_int
)paren
id|h-&gt;chip_no
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; queue_full_or_busy %x, start_motor %x, scsi_reset_wait %x, irq_no %x,&bslash;n&quot;
comma
(paren
r_int
)paren
id|h-&gt;queue_full_or_busy
comma
(paren
r_int
)paren
id|h-&gt;start_motor
comma
(paren
r_int
)paren
id|h-&gt;scsi_reset_wait
comma
(paren
r_int
)paren
id|h-&gt;irq_no
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; is_in_int %x, max_total_qng %x, cur_total_qng %x, in_critical_cnt %x,&bslash;n&quot;
comma
(paren
r_int
)paren
id|h-&gt;is_in_int
comma
(paren
r_int
)paren
id|h-&gt;max_total_qng
comma
(paren
r_int
)paren
id|h-&gt;cur_total_qng
comma
(paren
r_int
)paren
id|h-&gt;in_critical_cnt
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; last_q_shortage %x, init_state %x, no_scam %x, pci_fix_asyn_xfer %x,&bslash;n&quot;
comma
(paren
r_int
)paren
id|h-&gt;last_q_shortage
comma
(paren
r_int
)paren
id|h-&gt;init_state
comma
(paren
r_int
)paren
id|h-&gt;no_scam
comma
(paren
r_int
)paren
id|h-&gt;pci_fix_asyn_xfer
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; cfg %x, saved_ptr2func %x&bslash;n&quot;
comma
(paren
r_int
)paren
id|h-&gt;cfg
comma
(paren
r_int
)paren
id|h-&gt;saved_ptr2func
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * asc_prt_dvc_cfg()&n; */
id|STATIC
r_void
DECL|function|asc_prt_dvc_cfg
id|asc_prt_dvc_cfg
c_func
(paren
id|ASC_DVC_CFG
op_star
id|h
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;ASC_DVC_CFG at addr %x&bslash;n&quot;
comma
(paren
r_int
)paren
id|h
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; can_tagged_qng %x, cmd_qng_enabled %x, disc_enable %x, res %x,&bslash;n&quot;
comma
id|h-&gt;can_tagged_qng
comma
id|h-&gt;cmd_qng_enabled
comma
id|h-&gt;disc_enable
comma
id|h-&gt;res
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; chip_scsi_id %d, isa_dma_speed %d, isa_dma_channel %d, chip_version %d,&bslash;n&quot;
comma
id|h-&gt;chip_scsi_id
comma
id|h-&gt;isa_dma_speed
comma
id|h-&gt;isa_dma_channel
comma
id|h-&gt;chip_version
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; pci_device_id %d, lib_serial_no %d, lib_version %d, mcode_date %d,&bslash;n&quot;
comma
id|h-&gt;pci_device_id
comma
id|h-&gt;lib_serial_no
comma
id|h-&gt;lib_version
comma
id|h-&gt;mcode_date
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; mcode_version %d, overrun_buf %x&bslash;n&quot;
comma
id|h-&gt;mcode_version
comma
(paren
r_int
)paren
id|h-&gt;overrun_buf
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * asc_prt_scsi_q()&n; */
id|STATIC
r_void
DECL|function|asc_prt_scsi_q
id|asc_prt_scsi_q
c_func
(paren
id|ASC_SCSI_Q
op_star
id|q
)paren
(brace
id|ASC_SG_HEAD
op_star
id|sgp
suffix:semicolon
r_int
id|i
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;ASC_SCSI_Q at addr %x&bslash;n&quot;
comma
(paren
r_int
)paren
id|q
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; target_ix %u, target_lun %u, srb_ptr %x, tag_code %u,&bslash;n&quot;
comma
id|q-&gt;q2.target_ix
comma
id|q-&gt;q1.target_lun
comma
(paren
r_int
)paren
id|q-&gt;q2.srb_ptr
comma
id|q-&gt;q2.tag_code
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; data_addr %x, data_cnt %lu, sense_addr %x, sense_len %u,&bslash;n&quot;
comma
(paren
r_int
)paren
id|q-&gt;q1.data_addr
comma
id|q-&gt;q1.data_cnt
comma
(paren
r_int
)paren
id|q-&gt;q1.sense_addr
comma
id|q-&gt;q1.sense_len
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; cdbptr %x, cdb_len %u, sg_head %x, sg_queue_cnt %u&bslash;n&quot;
comma
(paren
r_int
)paren
id|q-&gt;cdbptr
comma
id|q-&gt;q2.cdb_len
comma
(paren
r_int
)paren
id|q-&gt;sg_head
comma
id|q-&gt;q1.sg_queue_cnt
)paren
suffix:semicolon
r_if
c_cond
(paren
id|q-&gt;sg_head
)paren
(brace
id|sgp
op_assign
id|q-&gt;sg_head
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;ASC_SG_HEAD at addr %x&bslash;n&quot;
comma
(paren
r_int
)paren
id|sgp
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; entry_cnt %u, queue_cnt %u&bslash;n&quot;
comma
id|sgp-&gt;entry_cnt
comma
id|sgp-&gt;queue_cnt
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|sgp-&gt;entry_cnt
suffix:semicolon
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot; [%u]: addr %x, bytes %lu&bslash;n&quot;
comma
id|i
comma
(paren
r_int
)paren
id|sgp-&gt;sg_list
(braket
id|i
)braket
dot
id|addr
comma
id|sgp-&gt;sg_list
(braket
id|i
)braket
dot
id|bytes
)paren
suffix:semicolon
)brace
)brace
)brace
multiline_comment|/*&n; * asc_prt_qdone_info()&n; */
id|STATIC
r_void
DECL|function|asc_prt_qdone_info
id|asc_prt_qdone_info
c_func
(paren
id|ASC_QDONE_INFO
op_star
id|q
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;ASC_QDONE_INFO at addr %x&bslash;n&quot;
comma
(paren
r_int
)paren
id|q
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; srb_ptr %x, target_ix %u, cdb_len %u, tag_code %u, done_stat %x&bslash;n&quot;
comma
(paren
r_int
)paren
id|q-&gt;d2.srb_ptr
comma
id|q-&gt;d2.target_ix
comma
id|q-&gt;d2.cdb_len
comma
id|q-&gt;d2.tag_code
comma
id|q-&gt;d3.done_stat
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot; host_stat %x, scsi_stat %x, scsi_msg %x&bslash;n&quot;
comma
id|q-&gt;d3.host_stat
comma
id|q-&gt;d3.scsi_stat
comma
id|q-&gt;d3.scsi_msg
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * asc_prt_hex()&n; *&n; * Print hexadecimal output in 4 byte groupings 32 bytes &n; * or 8 double-words per line.&n; */
id|STATIC
r_void
DECL|function|asc_prt_hex
id|asc_prt_hex
c_func
(paren
r_char
op_star
id|f
comma
id|uchar
op_star
id|s
comma
r_int
id|l
)paren
(brace
r_int
id|i
suffix:semicolon
r_int
id|j
suffix:semicolon
r_int
id|k
suffix:semicolon
r_int
id|m
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%s: (%d bytes)&bslash;n&quot;
comma
id|f
comma
id|l
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|l
suffix:semicolon
id|i
op_add_assign
l_int|32
)paren
(brace
multiline_comment|/* Display a maximum of 8 double-words per line. */
r_if
c_cond
(paren
(paren
id|k
op_assign
(paren
id|l
op_minus
id|i
)paren
op_div
l_int|4
)paren
op_ge
l_int|8
)paren
(brace
id|k
op_assign
l_int|8
suffix:semicolon
id|m
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|m
op_assign
(paren
id|l
op_minus
id|i
)paren
op_mod
l_int|4
suffix:semicolon
)brace
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
id|k
suffix:semicolon
id|j
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot; %2.2X%2.2X%2.2X%2.2X&quot;
comma
(paren
r_int
)paren
id|s
(braket
id|i
op_plus
(paren
id|j
op_star
l_int|4
)paren
)braket
comma
(paren
r_int
)paren
id|s
(braket
id|i
op_plus
(paren
id|j
op_star
l_int|4
)paren
op_plus
l_int|1
)braket
comma
(paren
r_int
)paren
id|s
(braket
id|i
op_plus
(paren
id|j
op_star
l_int|4
)paren
op_plus
l_int|2
)braket
comma
(paren
r_int
)paren
id|s
(braket
id|i
op_plus
(paren
id|j
op_star
l_int|4
)paren
op_plus
l_int|3
)braket
)paren
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|m
)paren
(brace
r_case
l_int|0
suffix:colon
r_default
suffix:colon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|printk
c_func
(paren
l_string|&quot; %2.2X&quot;
comma
(paren
r_int
)paren
id|s
(braket
id|i
op_plus
(paren
id|j
op_star
l_int|4
)paren
)braket
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|printk
c_func
(paren
l_string|&quot; %2.2X%2.2X&quot;
comma
(paren
r_int
)paren
id|s
(braket
id|i
op_plus
(paren
id|j
op_star
l_int|4
)paren
)braket
comma
(paren
r_int
)paren
id|s
(braket
id|i
op_plus
(paren
id|j
op_star
l_int|4
)paren
op_plus
l_int|1
)braket
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|printk
c_func
(paren
l_string|&quot; %2.2X%2.2X%2.2X&quot;
comma
(paren
r_int
)paren
id|s
(braket
id|i
op_plus
(paren
id|j
op_star
l_int|4
)paren
op_plus
l_int|1
)braket
comma
(paren
r_int
)paren
id|s
(braket
id|i
op_plus
(paren
id|j
op_star
l_int|4
)paren
op_plus
l_int|2
)braket
comma
(paren
r_int
)paren
id|s
(braket
id|i
op_plus
(paren
id|j
op_star
l_int|4
)paren
op_plus
l_int|3
)braket
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/*&n; * interrupts_enabled()&n; *&n; * Return 1 if interrupts are enabled, otherwise return 0.&n; */
id|STATIC
r_int
DECL|function|interrupts_enabled
id|interrupts_enabled
c_func
(paren
r_void
)paren
(brace
r_int
id|flags
suffix:semicolon
id|save_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|flags
op_amp
l_int|0x0200
)paren
(brace
r_return
id|ASC_TRUE
suffix:semicolon
)brace
r_else
(brace
r_return
id|ASC_FALSE
suffix:semicolon
)brace
)brace
macro_line|#endif /* ADVANSYS_DEBUG */
multiline_comment|/*&n; * --- Asc Library Functions&n; */
id|ushort
DECL|function|AscGetEisaChipCfg
id|AscGetEisaChipCfg
c_func
(paren
id|PortAddr
id|iop_base
)paren
(brace
id|PortAddr
id|eisa_cfg_iop
suffix:semicolon
id|eisa_cfg_iop
op_assign
(paren
id|PortAddr
)paren
id|ASC_GET_EISA_SLOT
c_func
(paren
id|iop_base
)paren
op_or
(paren
id|PortAddr
)paren
(paren
id|ASC_EISA_CFG_IOP_MASK
)paren
suffix:semicolon
r_return
(paren
id|inpw
c_func
(paren
id|eisa_cfg_iop
)paren
)paren
suffix:semicolon
)brace
id|uchar
DECL|function|AscSetChipScsiID
id|AscSetChipScsiID
c_func
(paren
id|PortAddr
id|iop_base
comma
id|uchar
id|new_host_id
)paren
(brace
id|ushort
id|cfg_lsw
suffix:semicolon
r_if
c_cond
(paren
id|AscGetChipScsiID
c_func
(paren
id|iop_base
)paren
op_eq
id|new_host_id
)paren
(brace
r_return
(paren
id|new_host_id
)paren
suffix:semicolon
)brace
id|cfg_lsw
op_assign
id|AscGetChipCfgLsw
c_func
(paren
id|iop_base
)paren
suffix:semicolon
id|cfg_lsw
op_and_assign
l_int|0xF8FF
suffix:semicolon
id|cfg_lsw
op_or_assign
(paren
id|ushort
)paren
(paren
(paren
id|new_host_id
op_amp
id|ASC_MAX_TID
)paren
op_lshift
l_int|8
)paren
suffix:semicolon
id|AscSetChipCfgLsw
c_func
(paren
id|iop_base
comma
id|cfg_lsw
)paren
suffix:semicolon
r_return
(paren
id|AscGetChipScsiID
c_func
(paren
id|iop_base
)paren
)paren
suffix:semicolon
)brace
id|uchar
DECL|function|AscGetChipScsiCtrl
id|AscGetChipScsiCtrl
c_func
(paren
id|PortAddr
id|iop_base
)paren
(brace
id|uchar
id|sc
suffix:semicolon
id|AscSetBank
c_func
(paren
id|iop_base
comma
l_int|1
)paren
suffix:semicolon
id|sc
op_assign
id|inp
c_func
(paren
id|iop_base
op_plus
id|IOP_REG_SC
)paren
suffix:semicolon
id|AscSetBank
c_func
(paren
id|iop_base
comma
l_int|0
)paren
suffix:semicolon
r_return
(paren
id|sc
)paren
suffix:semicolon
)brace
id|uchar
DECL|function|AscGetChipVersion
id|AscGetChipVersion
c_func
(paren
id|PortAddr
id|iop_base
comma
id|ushort
id|bus_type
)paren
(brace
r_if
c_cond
(paren
(paren
id|bus_type
op_amp
id|ASC_IS_EISA
)paren
op_ne
l_int|0
)paren
(brace
id|PortAddr
id|eisa_iop
suffix:semicolon
id|uchar
id|revision
suffix:semicolon
id|eisa_iop
op_assign
(paren
id|PortAddr
)paren
id|ASC_GET_EISA_SLOT
c_func
(paren
id|iop_base
)paren
op_or
(paren
id|PortAddr
)paren
id|ASC_EISA_REV_IOP_MASK
suffix:semicolon
id|revision
op_assign
id|inp
c_func
(paren
id|eisa_iop
)paren
suffix:semicolon
r_return
(paren
(paren
id|uchar
)paren
(paren
(paren
id|ASC_CHIP_MIN_VER_EISA
op_minus
l_int|1
)paren
op_plus
id|revision
)paren
)paren
suffix:semicolon
)brace
r_return
(paren
id|AscGetChipVerNo
c_func
(paren
id|iop_base
)paren
)paren
suffix:semicolon
)brace
id|ushort
DECL|function|AscGetChipBusType
id|AscGetChipBusType
c_func
(paren
id|PortAddr
id|iop_base
)paren
(brace
id|ushort
id|chip_ver
suffix:semicolon
id|chip_ver
op_assign
id|AscGetChipVerNo
c_func
(paren
id|iop_base
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|chip_ver
op_ge
id|ASC_CHIP_MIN_VER_VL
)paren
op_logical_and
(paren
id|chip_ver
op_le
id|ASC_CHIP_MAX_VER_VL
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
(paren
id|iop_base
op_amp
l_int|0x0C30
)paren
op_eq
l_int|0x0C30
)paren
op_logical_or
(paren
(paren
id|iop_base
op_amp
l_int|0x0C50
)paren
op_eq
l_int|0x0C50
)paren
)paren
(brace
r_return
(paren
id|ASC_IS_EISA
)paren
suffix:semicolon
)brace
r_return
(paren
id|ASC_IS_VL
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|chip_ver
op_ge
id|ASC_CHIP_MIN_VER_ISA
)paren
op_logical_and
(paren
id|chip_ver
op_le
id|ASC_CHIP_MAX_VER_ISA
)paren
)paren
(brace
r_if
c_cond
(paren
id|chip_ver
op_ge
id|ASC_CHIP_MIN_VER_ISA_PNP
)paren
(brace
r_return
(paren
id|ASC_IS_ISAPNP
)paren
suffix:semicolon
)brace
r_return
(paren
id|ASC_IS_ISA
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
id|chip_ver
op_ge
id|ASC_CHIP_MIN_VER_PCI
)paren
op_logical_and
(paren
id|chip_ver
op_le
id|ASC_CHIP_MAX_VER_PCI
)paren
)paren
(brace
r_return
(paren
id|ASC_IS_PCI
)paren
suffix:semicolon
)brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
id|ulong
DECL|function|AscLoadMicroCode
id|AscLoadMicroCode
c_func
(paren
id|PortAddr
id|iop_base
comma
id|ushort
id|s_addr
comma
id|ushort
id|dosfar
op_star
id|mcode_buf
comma
id|ushort
id|mcode_size
)paren
(brace
id|ulong
id|chksum
suffix:semicolon
id|ushort
id|mcode_word_size
suffix:semicolon
id|ushort
id|mcode_chksum
suffix:semicolon
id|mcode_word_size
op_assign
(paren
id|ushort
)paren
(paren
id|mcode_size
op_rshift
l_int|1
)paren
suffix:semicolon
id|AscMemWordSetLram
c_func
(paren
id|iop_base
comma
id|s_addr
comma
l_int|0
comma
id|mcode_word_size
)paren
suffix:semicolon
id|AscMemWordCopyToLram
c_func
(paren
id|iop_base
comma
id|s_addr
comma
id|mcode_buf
comma
id|mcode_word_size
)paren
suffix:semicolon
id|chksum
op_assign
id|AscMemSumLramWord
c_func
(paren
id|iop_base
comma
id|s_addr
comma
id|mcode_word_size
)paren
suffix:semicolon
id|mcode_chksum
op_assign
(paren
id|ushort
)paren
id|AscMemSumLramWord
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
id|ASC_CODE_SEC_BEG
comma
(paren
id|ushort
)paren
(paren
(paren
id|mcode_size
op_minus
id|s_addr
op_minus
(paren
id|ushort
)paren
id|ASC_CODE_SEC_BEG
)paren
op_div
l_int|2
)paren
)paren
suffix:semicolon
id|AscWriteLramWord
c_func
(paren
id|iop_base
comma
id|ASCV_MCODE_CHKSUM_W
comma
id|mcode_chksum
)paren
suffix:semicolon
id|AscWriteLramWord
c_func
(paren
id|iop_base
comma
id|ASCV_MCODE_SIZE_W
comma
id|mcode_size
)paren
suffix:semicolon
r_return
(paren
id|chksum
)paren
suffix:semicolon
)brace
r_int
DECL|function|AscFindSignature
id|AscFindSignature
c_func
(paren
id|PortAddr
id|iop_base
)paren
(brace
id|ushort
id|sig_word
suffix:semicolon
r_if
c_cond
(paren
id|AscGetChipSignatureByte
c_func
(paren
id|iop_base
)paren
op_eq
(paren
id|uchar
)paren
id|ASC_1000_ID1B
)paren
(brace
id|sig_word
op_assign
id|AscGetChipSignatureWord
c_func
(paren
id|iop_base
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|sig_word
op_eq
(paren
id|ushort
)paren
id|ASC_1000_ID0W
)paren
op_logical_or
(paren
id|sig_word
op_eq
(paren
id|ushort
)paren
id|ASC_1000_ID0W_FIX
)paren
)paren
(brace
r_return
(paren
l_int|1
)paren
suffix:semicolon
)brace
)brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
DECL|variable|_isa_pnp_inited
id|uchar
id|_isa_pnp_inited
op_assign
l_int|0
suffix:semicolon
DECL|variable|_asc_def_iop_base
id|PortAddr
id|_asc_def_iop_base
(braket
id|ASC_IOADR_TABLE_MAX_IX
)braket
op_assign
(brace
l_int|0x100
comma
id|ASC_IOADR_1
comma
l_int|0x120
comma
id|ASC_IOADR_2
comma
l_int|0x140
comma
id|ASC_IOADR_3
comma
id|ASC_IOADR_4
comma
id|ASC_IOADR_5
comma
id|ASC_IOADR_6
comma
id|ASC_IOADR_7
comma
id|ASC_IOADR_8
)brace
suffix:semicolon
id|PortAddr
DECL|function|AscSearchIOPortAddr
id|AscSearchIOPortAddr
c_func
(paren
id|PortAddr
id|iop_beg
comma
id|ushort
id|bus_type
)paren
(brace
r_if
c_cond
(paren
id|bus_type
op_amp
id|ASC_IS_VL
)paren
(brace
r_while
c_loop
(paren
(paren
id|iop_beg
op_assign
id|AscSearchIOPortAddr11
c_func
(paren
id|iop_beg
)paren
)paren
op_ne
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|AscGetChipVersion
c_func
(paren
id|iop_beg
comma
id|bus_type
)paren
op_le
id|ASC_CHIP_MAX_VER_VL
)paren
(brace
r_return
(paren
id|iop_beg
)paren
suffix:semicolon
)brace
)brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|bus_type
op_amp
id|ASC_IS_ISA
)paren
(brace
r_if
c_cond
(paren
id|_isa_pnp_inited
op_eq
l_int|0
)paren
(brace
id|AscSetISAPNPWaitForKey
c_func
(paren
)paren
suffix:semicolon
id|_isa_pnp_inited
op_increment
suffix:semicolon
)brace
r_while
c_loop
(paren
(paren
id|iop_beg
op_assign
id|AscSearchIOPortAddr11
c_func
(paren
id|iop_beg
)paren
)paren
op_ne
l_int|0
)paren
(brace
r_if
c_cond
(paren
(paren
id|AscGetChipVersion
c_func
(paren
id|iop_beg
comma
id|bus_type
)paren
op_amp
id|ASC_CHIP_VER_ISA_BIT
)paren
op_ne
l_int|0
)paren
(brace
r_return
(paren
id|iop_beg
)paren
suffix:semicolon
)brace
)brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|bus_type
op_amp
id|ASC_IS_EISA
)paren
(brace
r_if
c_cond
(paren
(paren
id|iop_beg
op_assign
id|AscSearchIOPortAddrEISA
c_func
(paren
id|iop_beg
)paren
)paren
op_ne
l_int|0
)paren
(brace
r_return
(paren
id|iop_beg
)paren
suffix:semicolon
)brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
id|PortAddr
DECL|function|AscSearchIOPortAddr11
id|AscSearchIOPortAddr11
c_func
(paren
id|PortAddr
id|s_addr
)paren
(brace
r_int
id|i
suffix:semicolon
id|PortAddr
id|iop_base
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ASC_IOADR_TABLE_MAX_IX
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|_asc_def_iop_base
(braket
id|i
)braket
OG
id|s_addr
)paren
(brace
r_break
suffix:semicolon
)brace
)brace
r_for
c_loop
(paren
suffix:semicolon
id|i
OL
id|ASC_IOADR_TABLE_MAX_IX
suffix:semicolon
id|i
op_increment
)paren
(brace
id|iop_base
op_assign
id|_asc_def_iop_base
(braket
id|i
)braket
suffix:semicolon
r_if
c_cond
(paren
id|check_region
c_func
(paren
id|iop_base
comma
id|ASC_IOADR_GAP
)paren
op_ne
l_int|0
)paren
(brace
id|ASC_DBG1
c_func
(paren
l_int|1
comma
l_string|&quot;AscSearchIOPortAddr11: check_region() failed I/O port %x&bslash;n&quot;
comma
id|iop_base
)paren
suffix:semicolon
r_continue
suffix:semicolon
)brace
id|ASC_DBG1
c_func
(paren
l_int|1
comma
l_string|&quot;AscSearchIOPortAddr11: probing I/O port %x&bslash;n&quot;
comma
id|iop_base
)paren
suffix:semicolon
r_if
c_cond
(paren
id|AscFindSignature
c_func
(paren
id|iop_base
)paren
)paren
(brace
r_return
(paren
id|iop_base
)paren
suffix:semicolon
)brace
)brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_void
DECL|function|AscToggleIRQAct
id|AscToggleIRQAct
c_func
(paren
id|PortAddr
id|iop_base
)paren
(brace
id|AscSetChipStatus
c_func
(paren
id|iop_base
comma
id|CIW_IRQ_ACT
)paren
suffix:semicolon
id|AscSetChipStatus
c_func
(paren
id|iop_base
comma
l_int|0
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
macro_line|#if CC_INIT_INQ_DISPLAY
DECL|variable|_hextbl_
id|uchar
id|_hextbl_
(braket
l_int|16
)braket
op_assign
(brace
l_char|&squot;0&squot;
comma
l_char|&squot;1&squot;
comma
l_char|&squot;2&squot;
comma
l_char|&squot;3&squot;
comma
l_char|&squot;4&squot;
comma
l_char|&squot;5&squot;
comma
l_char|&squot;6&squot;
comma
l_char|&squot;7&squot;
comma
l_char|&squot;8&squot;
comma
l_char|&squot;9&squot;
comma
l_char|&squot;A&squot;
comma
l_char|&squot;B&squot;
comma
l_char|&squot;C&squot;
comma
l_char|&squot;D&squot;
comma
l_char|&squot;E&squot;
comma
l_char|&squot;F&squot;
)brace
suffix:semicolon
macro_line|#endif
r_void
DECL|function|AscSetISAPNPWaitForKey
id|AscSetISAPNPWaitForKey
c_func
(paren
r_void
)paren
(brace
id|outp
c_func
(paren
id|ASC_ISA_PNP_PORT_ADDR
comma
l_int|0x02
)paren
suffix:semicolon
id|outp
c_func
(paren
id|ASC_ISA_PNP_PORT_WRITE
comma
l_int|0x02
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|uchar
DECL|function|AscGetChipIRQ
id|AscGetChipIRQ
c_func
(paren
id|PortAddr
id|iop_base
comma
id|ushort
id|bus_type
)paren
(brace
id|ushort
id|cfg_lsw
suffix:semicolon
id|uchar
id|chip_irq
suffix:semicolon
r_if
c_cond
(paren
(paren
id|bus_type
op_amp
id|ASC_IS_EISA
)paren
op_ne
l_int|0
)paren
(brace
id|cfg_lsw
op_assign
id|AscGetEisaChipCfg
c_func
(paren
id|iop_base
)paren
suffix:semicolon
id|chip_irq
op_assign
(paren
id|uchar
)paren
(paren
(paren
(paren
id|cfg_lsw
op_rshift
l_int|8
)paren
op_amp
l_int|0x07
)paren
op_plus
l_int|10
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|chip_irq
op_eq
l_int|13
)paren
op_logical_or
(paren
id|chip_irq
OG
l_int|15
)paren
)paren
(brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_return
(paren
id|chip_irq
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|bus_type
op_amp
id|ASC_IS_VL
)paren
op_ne
l_int|0
)paren
(brace
id|cfg_lsw
op_assign
id|AscGetChipCfgLsw
c_func
(paren
id|iop_base
)paren
suffix:semicolon
id|chip_irq
op_assign
(paren
id|uchar
)paren
(paren
(paren
(paren
id|cfg_lsw
op_rshift
l_int|2
)paren
op_amp
l_int|0x07
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|chip_irq
op_eq
l_int|0
)paren
op_logical_or
(paren
id|chip_irq
op_eq
l_int|4
)paren
op_logical_or
(paren
id|chip_irq
op_eq
l_int|7
)paren
)paren
(brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
macro_line|#if CC_PLEXTOR_VL
r_if
c_cond
(paren
id|chip_irq
op_eq
l_int|5
)paren
(brace
r_return
(paren
l_int|9
)paren
suffix:semicolon
)brace
macro_line|#endif
r_return
(paren
(paren
id|uchar
)paren
(paren
id|chip_irq
op_plus
(paren
id|ASC_MIN_IRQ_NO
op_minus
l_int|1
)paren
)paren
)paren
suffix:semicolon
)brace
id|cfg_lsw
op_assign
id|AscGetChipCfgLsw
c_func
(paren
id|iop_base
)paren
suffix:semicolon
id|chip_irq
op_assign
(paren
id|uchar
)paren
(paren
(paren
(paren
id|cfg_lsw
op_rshift
l_int|2
)paren
op_amp
l_int|0x03
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chip_irq
op_eq
l_int|3
)paren
id|chip_irq
op_add_assign
(paren
id|uchar
)paren
l_int|2
suffix:semicolon
r_return
(paren
(paren
id|uchar
)paren
(paren
id|chip_irq
op_plus
id|ASC_MIN_IRQ_NO
)paren
)paren
suffix:semicolon
)brace
id|uchar
DECL|function|AscSetChipIRQ
id|AscSetChipIRQ
c_func
(paren
id|PortAddr
id|iop_base
comma
id|uchar
id|irq_no
comma
id|ushort
id|bus_type
)paren
(brace
id|ushort
id|cfg_lsw
suffix:semicolon
r_if
c_cond
(paren
(paren
id|bus_type
op_amp
id|ASC_IS_VL
)paren
op_ne
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|irq_no
op_ne
l_int|0
)paren
(brace
macro_line|#if CC_PLEXTOR_VL
r_if
c_cond
(paren
id|irq_no
op_eq
l_int|9
)paren
(brace
id|irq_no
op_assign
l_int|14
suffix:semicolon
)brace
macro_line|#endif
r_if
c_cond
(paren
(paren
id|irq_no
OL
id|ASC_MIN_IRQ_NO
)paren
op_logical_or
(paren
id|irq_no
OG
id|ASC_MAX_IRQ_NO
)paren
)paren
(brace
id|irq_no
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|irq_no
op_sub_assign
(paren
id|uchar
)paren
(paren
(paren
id|ASC_MIN_IRQ_NO
op_minus
l_int|1
)paren
)paren
suffix:semicolon
)brace
)brace
id|cfg_lsw
op_assign
(paren
id|ushort
)paren
(paren
id|AscGetChipCfgLsw
c_func
(paren
id|iop_base
)paren
op_amp
l_int|0xFFE3
)paren
suffix:semicolon
id|cfg_lsw
op_or_assign
(paren
id|ushort
)paren
l_int|0x0010
suffix:semicolon
id|AscSetChipCfgLsw
c_func
(paren
id|iop_base
comma
id|cfg_lsw
)paren
suffix:semicolon
id|AscToggleIRQAct
c_func
(paren
id|iop_base
)paren
suffix:semicolon
id|cfg_lsw
op_assign
(paren
id|ushort
)paren
(paren
id|AscGetChipCfgLsw
c_func
(paren
id|iop_base
)paren
op_amp
l_int|0xFFE0
)paren
suffix:semicolon
id|cfg_lsw
op_or_assign
(paren
id|ushort
)paren
(paren
(paren
id|irq_no
op_amp
l_int|0x07
)paren
op_lshift
l_int|2
)paren
suffix:semicolon
id|AscSetChipCfgLsw
c_func
(paren
id|iop_base
comma
id|cfg_lsw
)paren
suffix:semicolon
id|AscToggleIRQAct
c_func
(paren
id|iop_base
)paren
suffix:semicolon
r_return
(paren
id|AscGetChipIRQ
c_func
(paren
id|iop_base
comma
id|bus_type
)paren
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|bus_type
op_amp
(paren
id|ASC_IS_ISA
)paren
)paren
op_ne
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|irq_no
op_eq
l_int|15
)paren
id|irq_no
op_sub_assign
(paren
id|uchar
)paren
l_int|2
suffix:semicolon
id|irq_no
op_sub_assign
(paren
id|uchar
)paren
id|ASC_MIN_IRQ_NO
suffix:semicolon
id|cfg_lsw
op_assign
(paren
id|ushort
)paren
(paren
id|AscGetChipCfgLsw
c_func
(paren
id|iop_base
)paren
op_amp
l_int|0xFFF3
)paren
suffix:semicolon
id|cfg_lsw
op_or_assign
(paren
id|ushort
)paren
(paren
(paren
id|irq_no
op_amp
l_int|0x03
)paren
op_lshift
l_int|2
)paren
suffix:semicolon
id|AscSetChipCfgLsw
c_func
(paren
id|iop_base
comma
id|cfg_lsw
)paren
suffix:semicolon
r_return
(paren
id|AscGetChipIRQ
c_func
(paren
id|iop_base
comma
id|bus_type
)paren
)paren
suffix:semicolon
)brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_void
DECL|function|AscEnableIsaDma
id|AscEnableIsaDma
c_func
(paren
id|uchar
id|dma_channel
)paren
(brace
r_if
c_cond
(paren
id|dma_channel
OL
l_int|4
)paren
(brace
id|outp
c_func
(paren
l_int|0x000B
comma
(paren
id|ushort
)paren
(paren
l_int|0xC0
op_or
id|dma_channel
)paren
)paren
suffix:semicolon
id|outp
c_func
(paren
l_int|0x000A
comma
id|dma_channel
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|dma_channel
OL
l_int|8
)paren
(brace
id|outp
c_func
(paren
l_int|0x00D6
comma
(paren
id|ushort
)paren
(paren
l_int|0xC0
op_or
(paren
id|dma_channel
op_minus
l_int|4
)paren
)paren
)paren
suffix:semicolon
id|outp
c_func
(paren
l_int|0x00D4
comma
(paren
id|ushort
)paren
(paren
id|dma_channel
op_minus
l_int|4
)paren
)paren
suffix:semicolon
)brace
r_return
suffix:semicolon
)brace
r_int
DECL|function|AscIsrChipHalted
id|AscIsrChipHalted
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
)paren
(brace
id|SDTR_XMSG
id|sdtr_xmsg
suffix:semicolon
id|SDTR_XMSG
id|out_msg
suffix:semicolon
id|ushort
id|halt_q_addr
suffix:semicolon
r_int
id|sdtr_accept
suffix:semicolon
id|ushort
id|int_halt_code
suffix:semicolon
id|ASC_SCSI_BIT_ID_TYPE
id|scsi_busy
suffix:semicolon
id|ASC_SCSI_BIT_ID_TYPE
id|target_id
suffix:semicolon
id|PortAddr
id|iop_base
suffix:semicolon
id|uchar
id|tag_code
suffix:semicolon
id|uchar
id|q_status
suffix:semicolon
id|uchar
id|halt_qp
suffix:semicolon
id|uchar
id|sdtr_data
op_assign
l_int|0
suffix:semicolon
id|uchar
id|target_ix
suffix:semicolon
id|uchar
id|q_cntl
comma
id|tid_no
suffix:semicolon
id|uchar
id|cur_dvc_qng
suffix:semicolon
id|uchar
id|asyn_sdtr
suffix:semicolon
id|uchar
id|scsi_status
suffix:semicolon
id|iop_base
op_assign
id|asc_dvc-&gt;iop_base
suffix:semicolon
id|int_halt_code
op_assign
id|AscReadLramWord
c_func
(paren
id|iop_base
comma
id|ASCV_HALTCODE_W
)paren
suffix:semicolon
id|halt_qp
op_assign
id|AscReadLramByte
c_func
(paren
id|iop_base
comma
id|ASCV_CURCDB_B
)paren
suffix:semicolon
id|halt_q_addr
op_assign
id|ASC_QNO_TO_QADDR
c_func
(paren
id|halt_qp
)paren
suffix:semicolon
id|target_ix
op_assign
id|AscReadLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|halt_q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_B_TARGET_IX
)paren
)paren
suffix:semicolon
id|q_cntl
op_assign
id|AscReadLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|halt_q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_B_CNTL
)paren
)paren
suffix:semicolon
id|tid_no
op_assign
id|ASC_TIX_TO_TID
c_func
(paren
id|target_ix
)paren
suffix:semicolon
id|target_id
op_assign
(paren
id|uchar
)paren
id|ASC_TID_TO_TARGET_ID
c_func
(paren
id|tid_no
)paren
suffix:semicolon
r_if
c_cond
(paren
id|asc_dvc-&gt;pci_fix_asyn_xfer
op_amp
id|target_id
)paren
(brace
id|asyn_sdtr
op_assign
id|ASYN_SDTR_DATA_FIX_PCI_REV_AB
suffix:semicolon
)brace
r_else
(brace
id|asyn_sdtr
op_assign
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|int_halt_code
op_eq
id|ASC_HALT_DISABLE_ASYN_USE_SYN_FIX
)paren
(brace
r_if
c_cond
(paren
id|asc_dvc-&gt;pci_fix_asyn_xfer
op_amp
id|target_id
)paren
(brace
id|AscSetChipSDTR
c_func
(paren
id|iop_base
comma
l_int|0
comma
id|tid_no
)paren
suffix:semicolon
)brace
id|AscWriteLramWord
c_func
(paren
id|iop_base
comma
id|ASCV_HALTCODE_W
comma
l_int|0
)paren
suffix:semicolon
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|int_halt_code
op_eq
id|ASC_HALT_ENABLE_ASYN_USE_SYN_FIX
)paren
(brace
r_if
c_cond
(paren
id|asc_dvc-&gt;pci_fix_asyn_xfer
op_amp
id|target_id
)paren
(brace
id|AscSetChipSDTR
c_func
(paren
id|iop_base
comma
id|asyn_sdtr
comma
id|tid_no
)paren
suffix:semicolon
)brace
id|AscWriteLramWord
c_func
(paren
id|iop_base
comma
id|ASCV_HALTCODE_W
comma
l_int|0
)paren
suffix:semicolon
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|int_halt_code
op_eq
id|ASC_HALT_EXTMSG_IN
)paren
(brace
id|AscMemWordCopyFromLram
c_func
(paren
id|iop_base
comma
id|ASCV_MSGIN_BEG
comma
(paren
id|ushort
id|dosfar
op_star
)paren
op_amp
id|sdtr_xmsg
comma
(paren
id|ushort
)paren
(paren
r_sizeof
(paren
id|SDTR_XMSG
)paren
op_rshift
l_int|1
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|sdtr_xmsg.msg_type
op_eq
id|MS_EXTEND
)paren
op_logical_and
(paren
id|sdtr_xmsg.msg_len
op_eq
id|MS_SDTR_LEN
)paren
)paren
(brace
id|sdtr_accept
op_assign
id|TRUE
suffix:semicolon
r_if
c_cond
(paren
id|sdtr_xmsg.msg_req
op_eq
id|MS_SDTR_CODE
)paren
(brace
r_if
c_cond
(paren
(paren
id|sdtr_xmsg.req_ack_offset
OG
id|ASC_SYN_MAX_OFFSET
)paren
)paren
(brace
id|sdtr_accept
op_assign
id|FALSE
suffix:semicolon
id|sdtr_xmsg.req_ack_offset
op_assign
id|ASC_SYN_MAX_OFFSET
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|sdtr_xmsg.xfer_period
OL
id|asc_dvc-&gt;sdtr_period_tbl
(braket
l_int|0
)braket
)paren
op_logical_or
(paren
id|sdtr_xmsg.xfer_period
OG
id|asc_dvc-&gt;sdtr_period_tbl
(braket
id|asc_dvc-&gt;max_sdtr_index
)braket
)paren
)paren
(brace
id|sdtr_accept
op_assign
id|FALSE
suffix:semicolon
)brace
r_if
c_cond
(paren
id|sdtr_accept
)paren
(brace
id|sdtr_data
op_assign
id|AscCalSDTRData
c_func
(paren
id|asc_dvc
comma
id|sdtr_xmsg.xfer_period
comma
id|sdtr_xmsg.req_ack_offset
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|sdtr_data
op_eq
l_int|0xFF
)paren
)paren
(brace
id|q_cntl
op_or_assign
id|QC_MSG_OUT
suffix:semicolon
id|asc_dvc-&gt;init_sdtr
op_and_assign
op_complement
id|target_id
suffix:semicolon
id|asc_dvc-&gt;sdtr_done
op_and_assign
op_complement
id|target_id
suffix:semicolon
id|AscSetChipSDTR
c_func
(paren
id|iop_base
comma
id|asyn_sdtr
comma
id|tid_no
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|sdtr_xmsg.req_ack_offset
op_eq
l_int|0
)paren
(brace
id|q_cntl
op_and_assign
op_complement
id|QC_MSG_OUT
suffix:semicolon
id|asc_dvc-&gt;init_sdtr
op_and_assign
op_complement
id|target_id
suffix:semicolon
id|asc_dvc-&gt;sdtr_done
op_and_assign
op_complement
id|target_id
suffix:semicolon
id|AscSetChipSDTR
c_func
(paren
id|iop_base
comma
id|asyn_sdtr
comma
id|tid_no
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|sdtr_accept
op_logical_and
(paren
id|q_cntl
op_amp
id|QC_MSG_OUT
)paren
)paren
(brace
id|q_cntl
op_and_assign
op_complement
id|QC_MSG_OUT
suffix:semicolon
id|asc_dvc-&gt;sdtr_done
op_or_assign
id|target_id
suffix:semicolon
id|asc_dvc-&gt;init_sdtr
op_or_assign
id|target_id
suffix:semicolon
id|asc_dvc-&gt;pci_fix_asyn_xfer
op_and_assign
op_complement
id|target_id
suffix:semicolon
id|AscSetChipSDTR
c_func
(paren
id|iop_base
comma
id|sdtr_data
comma
id|tid_no
)paren
suffix:semicolon
)brace
r_else
(brace
id|q_cntl
op_or_assign
id|QC_MSG_OUT
suffix:semicolon
id|AscMsgOutSDTR
c_func
(paren
id|asc_dvc
comma
id|sdtr_xmsg.xfer_period
comma
id|sdtr_xmsg.req_ack_offset
)paren
suffix:semicolon
id|asc_dvc-&gt;pci_fix_asyn_xfer
op_and_assign
op_complement
id|target_id
suffix:semicolon
id|AscSetChipSDTR
c_func
(paren
id|iop_base
comma
id|sdtr_data
comma
id|tid_no
)paren
suffix:semicolon
id|asc_dvc-&gt;sdtr_done
op_or_assign
id|target_id
suffix:semicolon
id|asc_dvc-&gt;init_sdtr
op_or_assign
id|target_id
suffix:semicolon
)brace
)brace
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|halt_q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_B_CNTL
)paren
comma
id|q_cntl
)paren
suffix:semicolon
id|AscWriteLramWord
c_func
(paren
id|iop_base
comma
id|ASCV_HALTCODE_W
comma
l_int|0
)paren
suffix:semicolon
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
)brace
)brace
r_else
r_if
c_cond
(paren
id|int_halt_code
op_eq
id|ASC_HALT_CHK_CONDITION
)paren
(brace
id|q_cntl
op_or_assign
id|QC_REQ_SENSE
suffix:semicolon
macro_line|#if CC_CHK_COND_REDO_SDTR
r_if
c_cond
(paren
(paren
(paren
id|asc_dvc-&gt;init_sdtr
op_amp
id|target_id
)paren
op_ne
l_int|0
)paren
op_logical_and
(paren
(paren
id|asc_dvc-&gt;sdtr_done
op_amp
id|target_id
)paren
op_ne
l_int|0
)paren
)paren
(brace
id|asc_dvc-&gt;sdtr_done
op_and_assign
op_complement
id|target_id
suffix:semicolon
id|sdtr_data
op_assign
id|AscGetMCodeInitSDTRAtID
c_func
(paren
id|iop_base
comma
id|tid_no
)paren
suffix:semicolon
id|q_cntl
op_or_assign
id|QC_MSG_OUT
suffix:semicolon
id|AscMsgOutSDTR
c_func
(paren
id|asc_dvc
comma
id|asc_dvc-&gt;sdtr_period_tbl
(braket
(paren
id|sdtr_data
op_rshift
l_int|4
)paren
op_amp
(paren
id|uchar
)paren
(paren
id|ASC_SYN_XFER_NO
op_minus
l_int|1
)paren
)braket
comma
(paren
id|uchar
)paren
(paren
id|sdtr_data
op_amp
(paren
id|uchar
)paren
id|ASC_SYN_MAX_OFFSET
)paren
)paren
suffix:semicolon
)brace
macro_line|#endif
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|halt_q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_B_CNTL
)paren
comma
id|q_cntl
)paren
suffix:semicolon
id|tag_code
op_assign
id|AscReadLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|halt_q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_B_TAG_CODE
)paren
)paren
suffix:semicolon
id|tag_code
op_and_assign
l_int|0xDC
suffix:semicolon
r_if
c_cond
(paren
(paren
id|asc_dvc-&gt;pci_fix_asyn_xfer
op_amp
id|target_id
)paren
op_logical_and
op_logical_neg
(paren
id|asc_dvc-&gt;pci_fix_asyn_xfer_always
op_amp
id|target_id
)paren
)paren
(brace
id|tag_code
op_or_assign
(paren
id|ASC_TAG_FLAG_DISABLE_DISCONNECT
op_or
id|ASC_TAG_FLAG_DISABLE_ASYN_USE_SYN_FIX
)paren
suffix:semicolon
)brace
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|halt_q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_B_TAG_CODE
)paren
comma
id|tag_code
)paren
suffix:semicolon
id|q_status
op_assign
id|AscReadLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|halt_q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_B_STATUS
)paren
)paren
suffix:semicolon
id|q_status
op_or_assign
(paren
id|QS_READY
op_or
id|QS_BUSY
)paren
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|halt_q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_B_STATUS
)paren
comma
id|q_status
)paren
suffix:semicolon
id|scsi_busy
op_assign
id|AscReadLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
id|ASCV_SCSIBUSY_B
)paren
suffix:semicolon
id|scsi_busy
op_and_assign
op_complement
id|target_id
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
id|ASCV_SCSIBUSY_B
comma
id|scsi_busy
)paren
suffix:semicolon
id|AscWriteLramWord
c_func
(paren
id|iop_base
comma
id|ASCV_HALTCODE_W
comma
l_int|0
)paren
suffix:semicolon
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|int_halt_code
op_eq
id|ASC_HALT_SDTR_REJECTED
)paren
(brace
id|AscMemWordCopyFromLram
c_func
(paren
id|iop_base
comma
id|ASCV_MSGOUT_BEG
comma
(paren
id|ushort
id|dosfar
op_star
)paren
op_amp
id|out_msg
comma
(paren
id|ushort
)paren
(paren
r_sizeof
(paren
id|SDTR_XMSG
)paren
op_rshift
l_int|1
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|out_msg.msg_type
op_eq
id|MS_EXTEND
)paren
op_logical_and
(paren
id|out_msg.msg_len
op_eq
id|MS_SDTR_LEN
)paren
op_logical_and
(paren
id|out_msg.msg_req
op_eq
id|MS_SDTR_CODE
)paren
)paren
(brace
id|asc_dvc-&gt;init_sdtr
op_and_assign
op_complement
id|target_id
suffix:semicolon
id|asc_dvc-&gt;sdtr_done
op_and_assign
op_complement
id|target_id
suffix:semicolon
id|AscSetChipSDTR
c_func
(paren
id|iop_base
comma
id|asyn_sdtr
comma
id|tid_no
)paren
suffix:semicolon
)brace
r_else
(brace
)brace
id|q_cntl
op_and_assign
op_complement
id|QC_MSG_OUT
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|halt_q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_B_CNTL
)paren
comma
id|q_cntl
)paren
suffix:semicolon
id|AscWriteLramWord
c_func
(paren
id|iop_base
comma
id|ASCV_HALTCODE_W
comma
l_int|0
)paren
suffix:semicolon
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|int_halt_code
op_eq
id|ASC_HALT_SS_QUEUE_FULL
)paren
(brace
id|scsi_status
op_assign
id|AscReadLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
(paren
id|ushort
)paren
id|halt_q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_SCSI_STATUS
)paren
)paren
suffix:semicolon
id|cur_dvc_qng
op_assign
id|AscReadLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
(paren
id|ushort
)paren
id|ASC_QADR_BEG
op_plus
(paren
id|ushort
)paren
id|target_ix
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|cur_dvc_qng
OG
l_int|0
)paren
op_logical_and
(paren
id|asc_dvc-&gt;cur_dvc_qng
(braket
id|tid_no
)braket
OG
l_int|0
)paren
)paren
(brace
id|scsi_busy
op_assign
id|AscReadLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
id|ASCV_SCSIBUSY_B
)paren
suffix:semicolon
id|scsi_busy
op_or_assign
id|target_id
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
id|ASCV_SCSIBUSY_B
comma
id|scsi_busy
)paren
suffix:semicolon
id|asc_dvc-&gt;queue_full_or_busy
op_or_assign
id|target_id
suffix:semicolon
r_if
c_cond
(paren
id|scsi_status
op_eq
id|SS_QUEUE_FULL
)paren
(brace
r_if
c_cond
(paren
id|cur_dvc_qng
OG
id|ASC_MIN_TAGGED_CMD
)paren
(brace
id|cur_dvc_qng
op_sub_assign
l_int|1
suffix:semicolon
id|asc_dvc-&gt;max_dvc_qng
(braket
id|tid_no
)braket
op_assign
id|cur_dvc_qng
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
(paren
id|ushort
)paren
id|ASCV_MAX_DVC_QNG_BEG
op_plus
(paren
id|ushort
)paren
id|tid_no
)paren
comma
id|cur_dvc_qng
)paren
suffix:semicolon
)brace
macro_line|#ifdef ADVANSYS_STATS
(brace
r_struct
id|asc_board
op_star
id|boardp
suffix:semicolon
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ASC_NUM_BOARD_SUPPORTED
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|asc_host
(braket
id|i
)braket
op_eq
l_int|NULL
)paren
(brace
r_continue
suffix:semicolon
)brace
id|boardp
op_assign
id|ASC_BOARDP
c_func
(paren
id|asc_host
(braket
id|i
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
op_amp
id|boardp-&gt;asc_dvc_var
op_eq
id|asc_dvc
)paren
(brace
id|boardp-&gt;asc_stats.queue_full
op_or_assign
id|target_id
suffix:semicolon
id|boardp-&gt;asc_stats.queue_full_cnt
(braket
id|tid_no
)braket
op_assign
id|cur_dvc_qng
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
)brace
macro_line|#endif
)brace
)brace
id|AscWriteLramWord
c_func
(paren
id|iop_base
comma
id|ASCV_HALTCODE_W
comma
l_int|0
)paren
suffix:semicolon
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
id|uchar
DECL|function|_AscCopyLramScsiDoneQ
id|_AscCopyLramScsiDoneQ
c_func
(paren
id|PortAddr
id|iop_base
comma
id|ushort
id|q_addr
comma
id|REG
id|ASC_QDONE_INFO
id|dosfar
op_star
id|scsiq
comma
id|ulong
id|max_dma_count
)paren
(brace
id|ushort
id|_val
suffix:semicolon
id|uchar
id|sg_queue_cnt
suffix:semicolon
id|DvcGetQinfo
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_DONE_INFO_BEG
)paren
comma
(paren
id|ushort
id|dosfar
op_star
)paren
id|scsiq
comma
(paren
id|ushort
)paren
(paren
(paren
r_sizeof
(paren
id|ASC_SCSIQ_2
)paren
op_plus
r_sizeof
(paren
id|ASC_SCSIQ_3
)paren
)paren
op_div
l_int|2
)paren
)paren
suffix:semicolon
macro_line|#if !CC_LITTLE_ENDIAN_HOST
id|AscAdjEndianQDoneInfo
c_func
(paren
id|scsiq
)paren
suffix:semicolon
macro_line|#endif
id|_val
op_assign
id|AscReadLramWord
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_B_STATUS
)paren
)paren
suffix:semicolon
id|scsiq-&gt;q_status
op_assign
(paren
id|uchar
)paren
id|_val
suffix:semicolon
id|scsiq-&gt;q_no
op_assign
(paren
id|uchar
)paren
(paren
id|_val
op_rshift
l_int|8
)paren
suffix:semicolon
id|_val
op_assign
id|AscReadLramWord
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_B_CNTL
)paren
)paren
suffix:semicolon
id|scsiq-&gt;cntl
op_assign
(paren
id|uchar
)paren
id|_val
suffix:semicolon
id|sg_queue_cnt
op_assign
(paren
id|uchar
)paren
(paren
id|_val
op_rshift
l_int|8
)paren
suffix:semicolon
id|_val
op_assign
id|AscReadLramWord
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_B_SENSE_LEN
)paren
)paren
suffix:semicolon
id|scsiq-&gt;sense_len
op_assign
(paren
id|uchar
)paren
id|_val
suffix:semicolon
id|scsiq-&gt;extra_bytes
op_assign
(paren
id|uchar
)paren
(paren
id|_val
op_rshift
l_int|8
)paren
suffix:semicolon
id|scsiq-&gt;remain_bytes
op_assign
id|AscReadLramDWord
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_DW_REMAIN_XFER_CNT
)paren
)paren
suffix:semicolon
id|scsiq-&gt;remain_bytes
op_and_assign
id|max_dma_count
suffix:semicolon
r_return
(paren
id|sg_queue_cnt
)paren
suffix:semicolon
)brace
r_int
DECL|function|AscIsrQDone
id|AscIsrQDone
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
)paren
(brace
id|uchar
id|next_qp
suffix:semicolon
id|uchar
id|n_q_used
suffix:semicolon
id|uchar
id|sg_list_qp
suffix:semicolon
id|uchar
id|sg_queue_cnt
suffix:semicolon
id|uchar
id|q_cnt
suffix:semicolon
id|uchar
id|done_q_tail
suffix:semicolon
id|uchar
id|tid_no
suffix:semicolon
macro_line|#if CC_LINK_BUSY_Q
id|uchar
id|exe_tid_no
suffix:semicolon
macro_line|#endif
id|ASC_SCSI_BIT_ID_TYPE
id|scsi_busy
suffix:semicolon
id|ASC_SCSI_BIT_ID_TYPE
id|target_id
suffix:semicolon
id|PortAddr
id|iop_base
suffix:semicolon
id|ushort
id|q_addr
suffix:semicolon
id|ushort
id|sg_q_addr
suffix:semicolon
id|uchar
id|cur_target_qng
suffix:semicolon
id|ASC_QDONE_INFO
id|scsiq_buf
suffix:semicolon
id|REG
id|ASC_QDONE_INFO
id|dosfar
op_star
id|scsiq
suffix:semicolon
r_int
id|false_overrun
suffix:semicolon
id|ASC_ISR_CALLBACK
id|asc_isr_callback
suffix:semicolon
macro_line|#if CC_LINK_BUSY_Q
id|ushort
id|n_busy_q_done
suffix:semicolon
macro_line|#endif
id|iop_base
op_assign
id|asc_dvc-&gt;iop_base
suffix:semicolon
id|asc_isr_callback
op_assign
(paren
id|ASC_ISR_CALLBACK
)paren
id|asc_dvc-&gt;isr_callback
suffix:semicolon
id|n_q_used
op_assign
l_int|1
suffix:semicolon
id|scsiq
op_assign
(paren
id|ASC_QDONE_INFO
id|dosfar
op_star
)paren
op_amp
id|scsiq_buf
suffix:semicolon
id|done_q_tail
op_assign
(paren
id|uchar
)paren
id|AscGetVarDoneQTail
c_func
(paren
id|iop_base
)paren
suffix:semicolon
id|q_addr
op_assign
id|ASC_QNO_TO_QADDR
c_func
(paren
id|done_q_tail
)paren
suffix:semicolon
id|next_qp
op_assign
id|AscReadLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_B_FWD
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|next_qp
op_ne
id|ASC_QLINK_END
)paren
(brace
id|AscPutVarDoneQTail
c_func
(paren
id|iop_base
comma
id|next_qp
)paren
suffix:semicolon
id|q_addr
op_assign
id|ASC_QNO_TO_QADDR
c_func
(paren
id|next_qp
)paren
suffix:semicolon
id|sg_queue_cnt
op_assign
id|_AscCopyLramScsiDoneQ
c_func
(paren
id|iop_base
comma
id|q_addr
comma
id|scsiq
comma
id|asc_dvc-&gt;max_dma_count
)paren
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_B_STATUS
)paren
comma
(paren
id|uchar
)paren
(paren
id|scsiq-&gt;q_status
op_amp
(paren
id|uchar
)paren
op_complement
(paren
id|QS_READY
op_or
id|QS_ABORTED
)paren
)paren
)paren
suffix:semicolon
id|tid_no
op_assign
id|ASC_TIX_TO_TID
c_func
(paren
id|scsiq-&gt;d2.target_ix
)paren
suffix:semicolon
id|target_id
op_assign
id|ASC_TIX_TO_TARGET_ID
c_func
(paren
id|scsiq-&gt;d2.target_ix
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|scsiq-&gt;cntl
op_amp
id|QC_SG_HEAD
)paren
op_ne
l_int|0
)paren
(brace
id|sg_q_addr
op_assign
id|q_addr
suffix:semicolon
id|sg_list_qp
op_assign
id|next_qp
suffix:semicolon
r_for
c_loop
(paren
id|q_cnt
op_assign
l_int|0
suffix:semicolon
id|q_cnt
OL
id|sg_queue_cnt
suffix:semicolon
id|q_cnt
op_increment
)paren
(brace
id|sg_list_qp
op_assign
id|AscReadLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|sg_q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_B_FWD
)paren
)paren
suffix:semicolon
id|sg_q_addr
op_assign
id|ASC_QNO_TO_QADDR
c_func
(paren
id|sg_list_qp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|sg_list_qp
op_eq
id|ASC_QLINK_END
)paren
(brace
id|AscSetLibErrorCode
c_func
(paren
id|asc_dvc
comma
id|ASCQ_ERR_SG_Q_LINKS
)paren
suffix:semicolon
id|scsiq-&gt;d3.done_stat
op_assign
id|QD_WITH_ERROR
suffix:semicolon
id|scsiq-&gt;d3.host_stat
op_assign
id|QHSTA_D_QDONE_SG_LIST_CORRUPTED
suffix:semicolon
r_goto
id|FATAL_ERR_QDONE
suffix:semicolon
)brace
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|sg_q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_B_STATUS
)paren
comma
id|QS_FREE
)paren
suffix:semicolon
)brace
id|n_q_used
op_assign
id|sg_queue_cnt
op_plus
l_int|1
suffix:semicolon
id|AscPutVarDoneQTail
c_func
(paren
id|iop_base
comma
id|sg_list_qp
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|asc_dvc-&gt;queue_full_or_busy
op_amp
id|target_id
)paren
(brace
id|cur_target_qng
op_assign
id|AscReadLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
(paren
id|ushort
)paren
id|ASC_QADR_BEG
op_plus
(paren
id|ushort
)paren
id|scsiq-&gt;d2.target_ix
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|cur_target_qng
OL
id|asc_dvc-&gt;max_dvc_qng
(braket
id|tid_no
)braket
)paren
(brace
id|scsi_busy
op_assign
id|AscReadLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
id|ASCV_SCSIBUSY_B
)paren
suffix:semicolon
id|scsi_busy
op_and_assign
op_complement
id|target_id
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
id|ASCV_SCSIBUSY_B
comma
id|scsi_busy
)paren
suffix:semicolon
id|asc_dvc-&gt;queue_full_or_busy
op_and_assign
op_complement
id|target_id
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|asc_dvc-&gt;cur_total_qng
op_ge
id|n_q_used
)paren
(brace
id|asc_dvc-&gt;cur_total_qng
op_sub_assign
id|n_q_used
suffix:semicolon
r_if
c_cond
(paren
id|asc_dvc-&gt;cur_dvc_qng
(braket
id|tid_no
)braket
op_ne
l_int|0
)paren
(brace
id|asc_dvc-&gt;cur_dvc_qng
(braket
id|tid_no
)braket
op_decrement
suffix:semicolon
)brace
)brace
r_else
(brace
id|AscSetLibErrorCode
c_func
(paren
id|asc_dvc
comma
id|ASCQ_ERR_CUR_QNG
)paren
suffix:semicolon
id|scsiq-&gt;d3.done_stat
op_assign
id|QD_WITH_ERROR
suffix:semicolon
r_goto
id|FATAL_ERR_QDONE
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|scsiq-&gt;d2.srb_ptr
op_eq
l_int|0UL
)paren
op_logical_or
(paren
(paren
id|scsiq-&gt;q_status
op_amp
id|QS_ABORTED
)paren
op_ne
l_int|0
)paren
)paren
(brace
r_return
(paren
l_int|0x11
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|scsiq-&gt;q_status
op_eq
id|QS_DONE
)paren
(brace
id|false_overrun
op_assign
id|FALSE
suffix:semicolon
r_if
c_cond
(paren
id|scsiq-&gt;extra_bytes
op_ne
l_int|0
)paren
(brace
id|scsiq-&gt;remain_bytes
op_add_assign
(paren
id|ulong
)paren
id|scsiq-&gt;extra_bytes
suffix:semicolon
)brace
r_if
c_cond
(paren
id|scsiq-&gt;d3.done_stat
op_eq
id|QD_WITH_ERROR
)paren
(brace
r_if
c_cond
(paren
id|scsiq-&gt;d3.host_stat
op_eq
id|QHSTA_M_DATA_OVER_RUN
)paren
(brace
r_if
c_cond
(paren
(paren
id|scsiq-&gt;cntl
op_amp
(paren
id|QC_DATA_IN
op_or
id|QC_DATA_OUT
)paren
)paren
op_eq
l_int|0
)paren
(brace
id|scsiq-&gt;d3.done_stat
op_assign
id|QD_NO_ERROR
suffix:semicolon
id|scsiq-&gt;d3.host_stat
op_assign
id|QHSTA_NO_ERROR
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|false_overrun
)paren
(brace
id|scsiq-&gt;d3.done_stat
op_assign
id|QD_NO_ERROR
suffix:semicolon
id|scsiq-&gt;d3.host_stat
op_assign
id|QHSTA_NO_ERROR
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|scsiq-&gt;d3.host_stat
op_eq
id|QHSTA_M_HUNG_REQ_SCSI_BUS_RESET
)paren
(brace
id|AscStopChip
c_func
(paren
id|iop_base
)paren
suffix:semicolon
id|AscSetChipControl
c_func
(paren
id|iop_base
comma
(paren
id|uchar
)paren
(paren
id|CC_SCSI_RESET
op_or
id|CC_HALT
)paren
)paren
suffix:semicolon
id|DvcDelayNanoSecond
c_func
(paren
id|asc_dvc
comma
l_int|30000
)paren
suffix:semicolon
id|AscSetChipControl
c_func
(paren
id|iop_base
comma
id|CC_HALT
)paren
suffix:semicolon
id|AscSetChipStatus
c_func
(paren
id|iop_base
comma
id|CIW_CLR_SCSI_RESET_INT
)paren
suffix:semicolon
id|AscSetChipStatus
c_func
(paren
id|iop_base
comma
l_int|0
)paren
suffix:semicolon
id|AscSetChipControl
c_func
(paren
id|iop_base
comma
l_int|0
)paren
suffix:semicolon
)brace
)brace
macro_line|#if CC_CLEAR_LRAM_SRB_PTR
id|AscWriteLramDWord
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_D_SRBPTR
)paren
comma
id|asc_dvc-&gt;int_count
)paren
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
(paren
id|scsiq-&gt;cntl
op_amp
id|QC_NO_CALLBACK
)paren
op_eq
l_int|0
)paren
(brace
(paren
op_star
id|asc_isr_callback
)paren
(paren
id|asc_dvc
comma
id|scsiq
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
(paren
id|AscReadLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_CDB_BEG
)paren
)paren
op_eq
id|SCSICMD_StartStopUnit
)paren
)paren
(brace
id|asc_dvc-&gt;unit_not_ready
op_and_assign
op_complement
id|target_id
suffix:semicolon
r_if
c_cond
(paren
id|scsiq-&gt;d3.done_stat
op_ne
id|QD_NO_ERROR
)paren
(brace
id|asc_dvc-&gt;start_motor
op_and_assign
op_complement
id|target_id
suffix:semicolon
)brace
)brace
)brace
macro_line|#if CC_LINK_BUSY_Q
id|n_busy_q_done
op_assign
id|AscIsrExeBusyQueue
c_func
(paren
id|asc_dvc
comma
id|tid_no
)paren
suffix:semicolon
r_if
c_cond
(paren
id|n_busy_q_done
op_eq
l_int|0
)paren
(brace
id|exe_tid_no
op_assign
(paren
id|uint
)paren
id|tid_no
op_plus
l_int|1
suffix:semicolon
r_while
c_loop
(paren
id|TRUE
)paren
(brace
r_if
c_cond
(paren
id|exe_tid_no
OG
id|ASC_MAX_TID
)paren
id|exe_tid_no
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|exe_tid_no
op_eq
(paren
id|uint
)paren
id|tid_no
)paren
r_break
suffix:semicolon
id|n_busy_q_done
op_assign
id|AscIsrExeBusyQueue
c_func
(paren
id|asc_dvc
comma
id|exe_tid_no
)paren
suffix:semicolon
r_if
c_cond
(paren
id|n_busy_q_done
op_ne
l_int|0
)paren
r_break
suffix:semicolon
id|exe_tid_no
op_increment
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|n_busy_q_done
op_eq
l_int|0xFFFF
)paren
r_return
(paren
l_int|0x80
)paren
suffix:semicolon
macro_line|#endif
r_return
(paren
l_int|1
)paren
suffix:semicolon
)brace
r_else
(brace
id|AscSetLibErrorCode
c_func
(paren
id|asc_dvc
comma
id|ASCQ_ERR_Q_STATUS
)paren
suffix:semicolon
id|FATAL_ERR_QDONE
suffix:colon
r_if
c_cond
(paren
(paren
id|scsiq-&gt;cntl
op_amp
id|QC_NO_CALLBACK
)paren
op_eq
l_int|0
)paren
(brace
(paren
op_star
id|asc_isr_callback
)paren
(paren
id|asc_dvc
comma
id|scsiq
)paren
suffix:semicolon
)brace
r_return
(paren
l_int|0x80
)paren
suffix:semicolon
)brace
)brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
macro_line|#if CC_LINK_BUSY_Q
macro_line|#endif
r_int
DECL|function|AscISR
id|AscISR
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
)paren
(brace
id|ASC_CS_TYPE
id|chipstat
suffix:semicolon
id|PortAddr
id|iop_base
suffix:semicolon
id|ushort
id|saved_ram_addr
suffix:semicolon
id|uchar
id|ctrl_reg
suffix:semicolon
id|uchar
id|saved_ctrl_reg
suffix:semicolon
r_int
id|int_pending
suffix:semicolon
r_int
id|status
suffix:semicolon
id|uchar
id|host_flag
suffix:semicolon
id|iop_base
op_assign
id|asc_dvc-&gt;iop_base
suffix:semicolon
id|int_pending
op_assign
id|FALSE
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
id|asc_dvc-&gt;init_state
op_amp
id|ASC_INIT_STATE_END_LOAD_MC
)paren
op_eq
l_int|0
)paren
op_logical_or
(paren
id|asc_dvc-&gt;isr_callback
op_eq
l_int|0
)paren
)paren
(brace
r_return
(paren
id|ERR
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|asc_dvc-&gt;in_critical_cnt
op_ne
l_int|0
)paren
(brace
id|AscSetLibErrorCode
c_func
(paren
id|asc_dvc
comma
id|ASCQ_ERR_ISR_ON_CRITICAL
)paren
suffix:semicolon
r_return
(paren
id|ERR
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|asc_dvc-&gt;is_in_int
)paren
(brace
id|AscSetLibErrorCode
c_func
(paren
id|asc_dvc
comma
id|ASCQ_ERR_ISR_RE_ENTRY
)paren
suffix:semicolon
r_return
(paren
id|ERR
)paren
suffix:semicolon
)brace
id|asc_dvc-&gt;is_in_int
op_assign
id|TRUE
suffix:semicolon
id|ctrl_reg
op_assign
id|AscGetChipControl
c_func
(paren
id|iop_base
)paren
suffix:semicolon
id|saved_ctrl_reg
op_assign
id|ctrl_reg
op_amp
(paren
op_complement
(paren
id|CC_SCSI_RESET
op_or
id|CC_CHIP_RESET
op_or
id|CC_SINGLE_STEP
op_or
id|CC_DIAG
op_or
id|CC_TEST
)paren
)paren
suffix:semicolon
id|chipstat
op_assign
id|AscGetChipStatus
c_func
(paren
id|iop_base
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chipstat
op_amp
id|CSW_SCSI_RESET_LATCH
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|asc_dvc-&gt;bus_type
op_amp
(paren
id|ASC_IS_VL
op_or
id|ASC_IS_EISA
)paren
)paren
)paren
(brace
id|int_pending
op_assign
id|TRUE
suffix:semicolon
id|asc_dvc-&gt;sdtr_done
op_assign
l_int|0
suffix:semicolon
id|saved_ctrl_reg
op_and_assign
(paren
id|uchar
)paren
(paren
op_complement
id|CC_HALT
)paren
suffix:semicolon
r_while
c_loop
(paren
id|AscGetChipStatus
c_func
(paren
id|iop_base
)paren
op_amp
id|CSW_SCSI_RESET_ACTIVE
)paren
suffix:semicolon
id|AscSetChipControl
c_func
(paren
id|iop_base
comma
(paren
id|CC_CHIP_RESET
op_or
id|CC_HALT
)paren
)paren
suffix:semicolon
id|AscSetChipControl
c_func
(paren
id|iop_base
comma
id|CC_HALT
)paren
suffix:semicolon
id|AscSetChipStatus
c_func
(paren
id|iop_base
comma
id|CIW_CLR_SCSI_RESET_INT
)paren
suffix:semicolon
id|AscSetChipStatus
c_func
(paren
id|iop_base
comma
l_int|0
)paren
suffix:semicolon
id|chipstat
op_assign
id|AscGetChipStatus
c_func
(paren
id|iop_base
)paren
suffix:semicolon
)brace
)brace
id|saved_ram_addr
op_assign
id|AscGetChipLramAddr
c_func
(paren
id|iop_base
)paren
suffix:semicolon
id|host_flag
op_assign
id|AscReadLramByte
c_func
(paren
id|iop_base
comma
id|ASCV_HOST_FLAG_B
)paren
op_amp
(paren
id|uchar
)paren
(paren
op_complement
id|ASC_HOST_FLAG_IN_ISR
)paren
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
id|ASCV_HOST_FLAG_B
comma
(paren
id|uchar
)paren
(paren
id|host_flag
op_or
(paren
id|uchar
)paren
id|ASC_HOST_FLAG_IN_ISR
)paren
)paren
suffix:semicolon
macro_line|#if CC_ASCISR_CHECK_INT_PENDING
r_if
c_cond
(paren
(paren
id|chipstat
op_amp
id|CSW_INT_PENDING
)paren
op_logical_or
(paren
id|int_pending
)paren
)paren
(brace
id|AscAckInterrupt
c_func
(paren
id|iop_base
)paren
suffix:semicolon
macro_line|#endif
id|int_pending
op_assign
id|TRUE
suffix:semicolon
r_if
c_cond
(paren
(paren
id|chipstat
op_amp
id|CSW_HALTED
)paren
op_logical_and
(paren
id|ctrl_reg
op_amp
id|CC_SINGLE_STEP
)paren
)paren
(brace
r_if
c_cond
(paren
id|AscIsrChipHalted
c_func
(paren
id|asc_dvc
)paren
op_eq
id|ERR
)paren
(brace
r_goto
id|ISR_REPORT_QDONE_FATAL_ERROR
suffix:semicolon
)brace
r_else
(brace
id|saved_ctrl_reg
op_and_assign
(paren
id|uchar
)paren
(paren
op_complement
id|CC_HALT
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
id|ISR_REPORT_QDONE_FATAL_ERROR
suffix:colon
r_if
c_cond
(paren
(paren
id|asc_dvc-&gt;dvc_cntl
op_amp
id|ASC_CNTL_INT_MULTI_Q
)paren
op_ne
l_int|0
)paren
(brace
r_while
c_loop
(paren
(paren
(paren
id|status
op_assign
id|AscIsrQDone
c_func
(paren
id|asc_dvc
)paren
)paren
op_amp
l_int|0x01
)paren
op_ne
l_int|0
)paren
(brace
)brace
)brace
r_else
(brace
r_do
(brace
r_if
c_cond
(paren
(paren
id|status
op_assign
id|AscIsrQDone
c_func
(paren
id|asc_dvc
)paren
)paren
op_eq
l_int|1
)paren
(brace
r_break
suffix:semicolon
)brace
)brace
r_while
c_loop
(paren
id|status
op_eq
l_int|0x11
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|status
op_amp
l_int|0x80
)paren
op_ne
l_int|0
)paren
id|int_pending
op_assign
id|ERR
suffix:semicolon
)brace
macro_line|#if CC_ASCISR_CHECK_INT_PENDING
)brace
macro_line|#endif
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
id|ASCV_HOST_FLAG_B
comma
id|host_flag
)paren
suffix:semicolon
id|AscSetChipLramAddr
c_func
(paren
id|iop_base
comma
id|saved_ram_addr
)paren
suffix:semicolon
id|AscSetChipControl
c_func
(paren
id|iop_base
comma
id|saved_ctrl_reg
)paren
suffix:semicolon
id|asc_dvc-&gt;is_in_int
op_assign
id|FALSE
suffix:semicolon
r_return
(paren
id|int_pending
)paren
suffix:semicolon
)brace
r_int
DECL|function|AscScsiSetupCmdQ
id|AscScsiSetupCmdQ
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|REG
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
id|scsiq
comma
id|uchar
id|dosfar
op_star
id|buf_addr
comma
id|ulong
id|buf_len
)paren
(brace
id|ulong
id|phy_addr
suffix:semicolon
id|scsiq-&gt;r1.cntl
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;r1.sg_queue_cnt
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;r1.q_no
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;r1.extra_bytes
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;r3.scsi_stat
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;r3.scsi_msg
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;r3.host_stat
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;r3.done_stat
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;r2.vm_id
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;cdbptr
op_assign
(paren
id|uchar
id|dosfar
op_star
)paren
id|scsiq-&gt;cdb
suffix:semicolon
id|scsiq-&gt;r1.data_cnt
op_assign
id|buf_len
suffix:semicolon
id|scsiq-&gt;r2.tag_code
op_assign
(paren
id|uchar
)paren
id|M2_QTAG_MSG_SIMPLE
suffix:semicolon
id|scsiq-&gt;r2.flag
op_assign
(paren
id|uchar
)paren
id|ASC_FLAG_SCSIQ_REQ
suffix:semicolon
id|scsiq-&gt;r2.srb_ptr
op_assign
(paren
id|ulong
)paren
id|scsiq
suffix:semicolon
id|scsiq-&gt;r1.status
op_assign
(paren
id|uchar
)paren
id|QS_READY
suffix:semicolon
id|scsiq-&gt;r1.data_addr
op_assign
l_int|0L
suffix:semicolon
r_if
c_cond
(paren
id|buf_len
op_ne
l_int|0L
)paren
(brace
r_if
c_cond
(paren
(paren
id|phy_addr
op_assign
id|AscGetOnePhyAddr
c_func
(paren
id|asc_dvc
comma
(paren
id|uchar
id|dosfar
op_star
)paren
id|buf_addr
comma
id|scsiq-&gt;r1.data_cnt
)paren
)paren
op_eq
l_int|0L
)paren
(brace
r_return
(paren
id|ERR
)paren
suffix:semicolon
)brace
id|scsiq-&gt;r1.data_addr
op_assign
id|phy_addr
suffix:semicolon
)brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
DECL|variable|_mcode_buf
id|uchar
id|_mcode_buf
(braket
)braket
op_assign
(brace
l_int|0x01
comma
l_int|0x03
comma
l_int|0x01
comma
l_int|0x19
comma
l_int|0x0F
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x0F
comma
l_int|0x0F
comma
l_int|0x0F
comma
l_int|0x0F
comma
l_int|0x0F
comma
l_int|0x0F
comma
l_int|0x0F
comma
l_int|0x0F
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0xC4
comma
l_int|0x0C
comma
l_int|0x08
comma
l_int|0x05
comma
l_int|0x01
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0xFF
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0xFF
comma
l_int|0x80
comma
l_int|0xFF
comma
l_int|0xFF
comma
l_int|0x01
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x23
comma
l_int|0x00
comma
l_int|0x20
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x07
comma
l_int|0x00
comma
l_int|0xFF
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0xFF
comma
l_int|0xFF
comma
l_int|0xFF
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0xE4
comma
l_int|0x88
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x80
comma
l_int|0x73
comma
l_int|0x48
comma
l_int|0x04
comma
l_int|0x36
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0xA2
comma
l_int|0xC6
comma
l_int|0x00
comma
l_int|0x80
comma
l_int|0x73
comma
l_int|0x03
comma
l_int|0x23
comma
l_int|0x36
comma
l_int|0x40
comma
l_int|0xB6
comma
l_int|0x00
comma
l_int|0x36
comma
l_int|0x00
comma
l_int|0x05
comma
l_int|0xD6
comma
l_int|0x0C
comma
l_int|0xD2
comma
l_int|0x12
comma
l_int|0xDA
comma
l_int|0x00
comma
l_int|0xA2
comma
l_int|0xC6
comma
l_int|0x00
comma
l_int|0x92
comma
l_int|0x80
comma
l_int|0x20
comma
l_int|0x98
comma
l_int|0x50
comma
l_int|0x00
comma
l_int|0xF5
comma
l_int|0x00
comma
l_int|0x4A
comma
l_int|0x98
comma
l_int|0xDF
comma
l_int|0x23
comma
l_int|0x36
comma
l_int|0x60
comma
l_int|0xB6
comma
l_int|0x00
comma
l_int|0x92
comma
l_int|0x80
comma
l_int|0x4F
comma
l_int|0x00
comma
l_int|0xF5
comma
l_int|0x00
comma
l_int|0x4A
comma
l_int|0x98
comma
l_int|0xEF
comma
l_int|0x23
comma
l_int|0x36
comma
l_int|0x60
comma
l_int|0xB6
comma
l_int|0x00
comma
l_int|0x92
comma
l_int|0x80
comma
l_int|0x80
comma
l_int|0x62
comma
l_int|0x92
comma
l_int|0x80
comma
l_int|0x00
comma
l_int|0x62
comma
l_int|0x92
comma
l_int|0x80
comma
l_int|0x00
comma
l_int|0x46
comma
l_int|0x17
comma
l_int|0xEE
comma
l_int|0x13
comma
l_int|0xEA
comma
l_int|0x02
comma
l_int|0x01
comma
l_int|0x09
comma
l_int|0xD8
comma
l_int|0xCD
comma
l_int|0x04
comma
l_int|0x4D
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0xA3
comma
l_int|0xDA
comma
l_int|0x00
comma
l_int|0xA8
comma
l_int|0x97
comma
l_int|0x7F
comma
l_int|0x23
comma
l_int|0x04
comma
l_int|0x61
comma
l_int|0x84
comma
l_int|0x01
comma
l_int|0xD2
comma
l_int|0x84
comma
l_int|0xD0
comma
l_int|0xC1
comma
l_int|0x80
comma
l_int|0x73
comma
l_int|0xCD
comma
l_int|0x04
comma
l_int|0x4D
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0xA3
comma
l_int|0xE6
comma
l_int|0x01
comma
l_int|0xA8
comma
l_int|0x97
comma
l_int|0xD2
comma
l_int|0x81
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x02
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0x80
comma
l_int|0x73
comma
l_int|0x80
comma
l_int|0x77
comma
l_int|0x00
comma
l_int|0x01
comma
l_int|0x01
comma
l_int|0xA1
comma
l_int|0x06
comma
l_int|0x01
comma
l_int|0x4F
comma
l_int|0x00
comma
l_int|0x86
comma
l_int|0x97
comma
l_int|0x07
comma
l_int|0xA6
comma
l_int|0x10
comma
l_int|0x01
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x03
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0x03
comma
l_int|0x03
comma
l_int|0x03
comma
l_int|0xDE
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x05
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0xCE
comma
l_int|0x00
comma
l_int|0x69
comma
l_int|0x60
comma
l_int|0xCE
comma
l_int|0x00
comma
l_int|0x02
comma
l_int|0x03
comma
l_int|0x4A
comma
l_int|0x60
comma
l_int|0x00
comma
l_int|0xA2
comma
l_int|0x84
comma
l_int|0x01
comma
l_int|0x80
comma
l_int|0x63
comma
l_int|0x07
comma
l_int|0xA6
comma
l_int|0x30
comma
l_int|0x01
comma
l_int|0x84
comma
l_int|0x81
comma
l_int|0x03
comma
l_int|0x03
comma
l_int|0x80
comma
l_int|0x63
comma
l_int|0xE2
comma
l_int|0x00
comma
l_int|0x07
comma
l_int|0xA6
comma
l_int|0x40
comma
l_int|0x01
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x04
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0x03
comma
l_int|0x07
comma
l_int|0x02
comma
l_int|0x01
comma
l_int|0x04
comma
l_int|0xCA
comma
l_int|0x0D
comma
l_int|0x23
comma
l_int|0x6A
comma
l_int|0x98
comma
l_int|0x4D
comma
l_int|0x04
comma
l_int|0xF0
comma
l_int|0x84
comma
l_int|0x05
comma
l_int|0xD8
comma
l_int|0x0D
comma
l_int|0x23
comma
l_int|0x6A
comma
l_int|0x98
comma
l_int|0xCD
comma
l_int|0x04
comma
l_int|0x15
comma
l_int|0x23
comma
l_int|0xF8
comma
l_int|0x88
comma
l_int|0xFB
comma
l_int|0x23
comma
l_int|0x02
comma
l_int|0x61
comma
l_int|0x82
comma
l_int|0x01
comma
l_int|0x80
comma
l_int|0x63
comma
l_int|0x02
comma
l_int|0x03
comma
l_int|0x06
comma
l_int|0xA3
comma
l_int|0x6E
comma
l_int|0x01
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x0A
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0x4E
comma
l_int|0x00
comma
l_int|0x07
comma
l_int|0xA3
comma
l_int|0x7A
comma
l_int|0x01
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x0B
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0xCD
comma
l_int|0x04
comma
l_int|0x36
comma
l_int|0x2D
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x1A
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0x50
comma
l_int|0x04
comma
l_int|0x94
comma
l_int|0x81
comma
l_int|0x06
comma
l_int|0xAB
comma
l_int|0x8E
comma
l_int|0x01
comma
l_int|0x94
comma
l_int|0x81
comma
l_int|0x4E
comma
l_int|0x00
comma
l_int|0x07
comma
l_int|0xA3
comma
l_int|0x9E
comma
l_int|0x01
comma
l_int|0x50
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0xA3
comma
l_int|0x48
comma
l_int|0x01
comma
l_int|0x00
comma
l_int|0x05
comma
l_int|0x88
comma
l_int|0x81
comma
l_int|0x48
comma
l_int|0x97
comma
l_int|0x02
comma
l_int|0x01
comma
l_int|0x05
comma
l_int|0xC6
comma
l_int|0x04
comma
l_int|0x23
comma
l_int|0xA0
comma
l_int|0x01
comma
l_int|0x15
comma
l_int|0x23
comma
l_int|0xA1
comma
l_int|0x01
comma
l_int|0xCA
comma
l_int|0x81
comma
l_int|0xFD
comma
l_int|0x23
comma
l_int|0x02
comma
l_int|0x61
comma
l_int|0x82
comma
l_int|0x01
comma
l_int|0x0A
comma
l_int|0xDA
comma
l_int|0x4A
comma
l_int|0x00
comma
l_int|0x06
comma
l_int|0x61
comma
l_int|0x00
comma
l_int|0xA0
comma
l_int|0xC0
comma
l_int|0x01
comma
l_int|0x80
comma
l_int|0x63
comma
l_int|0xCD
comma
l_int|0x04
comma
l_int|0x36
comma
l_int|0x2D
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x1B
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0x06
comma
l_int|0x23
comma
l_int|0x6A
comma
l_int|0x98
comma
l_int|0xCD
comma
l_int|0x04
comma
l_int|0xD2
comma
l_int|0x84
comma
l_int|0x06
comma
l_int|0x01
comma
l_int|0x00
comma
l_int|0xA2
comma
l_int|0xE0
comma
l_int|0x01
comma
l_int|0x57
comma
l_int|0x60
comma
l_int|0x00
comma
l_int|0xA0
comma
l_int|0xE6
comma
l_int|0x01
comma
l_int|0xD2
comma
l_int|0x84
comma
l_int|0x80
comma
l_int|0x23
comma
l_int|0xA0
comma
l_int|0x01
comma
l_int|0xD2
comma
l_int|0x84
comma
l_int|0x80
comma
l_int|0x73
comma
l_int|0x4B
comma
l_int|0x00
comma
l_int|0x06
comma
l_int|0x61
comma
l_int|0x00
comma
l_int|0xA2
comma
l_int|0x0E
comma
l_int|0x02
comma
l_int|0x04
comma
l_int|0x01
comma
l_int|0x0D
comma
l_int|0xDE
comma
l_int|0x02
comma
l_int|0x01
comma
l_int|0x03
comma
l_int|0xCC
comma
l_int|0x4F
comma
l_int|0x00
comma
l_int|0x86
comma
l_int|0x97
comma
l_int|0x08
comma
l_int|0x82
comma
l_int|0x08
comma
l_int|0x23
comma
l_int|0x02
comma
l_int|0x41
comma
l_int|0x82
comma
l_int|0x01
comma
l_int|0x4F
comma
l_int|0x00
comma
l_int|0x64
comma
l_int|0x97
comma
l_int|0x48
comma
l_int|0x04
comma
l_int|0xFF
comma
l_int|0x23
comma
l_int|0x84
comma
l_int|0x80
comma
l_int|0xF2
comma
l_int|0x97
comma
l_int|0x00
comma
l_int|0x46
comma
l_int|0x56
comma
l_int|0x00
comma
l_int|0x03
comma
l_int|0xC0
comma
l_int|0x01
comma
l_int|0x23
comma
l_int|0xE8
comma
l_int|0x00
comma
l_int|0x81
comma
l_int|0x73
comma
l_int|0x06
comma
l_int|0x29
comma
l_int|0x03
comma
l_int|0x42
comma
l_int|0x06
comma
l_int|0xE2
comma
l_int|0x03
comma
l_int|0xEE
comma
l_int|0x66
comma
l_int|0xEB
comma
l_int|0x11
comma
l_int|0x23
comma
l_int|0xF8
comma
l_int|0x88
comma
l_int|0x06
comma
l_int|0x98
comma
l_int|0xF8
comma
l_int|0x80
comma
l_int|0x80
comma
l_int|0x73
comma
l_int|0x80
comma
l_int|0x77
comma
l_int|0x06
comma
l_int|0xA6
comma
l_int|0x3C
comma
l_int|0x02
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x31
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0x04
comma
l_int|0x01
comma
l_int|0x03
comma
l_int|0xD8
comma
l_int|0xB4
comma
l_int|0x98
comma
l_int|0x3E
comma
l_int|0x96
comma
l_int|0x4E
comma
l_int|0x82
comma
l_int|0xCE
comma
l_int|0x95
comma
l_int|0x80
comma
l_int|0x67
comma
l_int|0x83
comma
l_int|0x03
comma
l_int|0x80
comma
l_int|0x63
comma
l_int|0xB6
comma
l_int|0x2D
comma
l_int|0x02
comma
l_int|0xA6
comma
l_int|0x78
comma
l_int|0x02
comma
l_int|0x07
comma
l_int|0xA6
comma
l_int|0x66
comma
l_int|0x02
comma
l_int|0x06
comma
l_int|0xA6
comma
l_int|0x6A
comma
l_int|0x02
comma
l_int|0x03
comma
l_int|0xA6
comma
l_int|0x6E
comma
l_int|0x02
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x10
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0x6A
comma
l_int|0x95
comma
l_int|0x50
comma
l_int|0x82
comma
l_int|0x34
comma
l_int|0x96
comma
l_int|0x50
comma
l_int|0x82
comma
l_int|0x04
comma
l_int|0x23
comma
l_int|0xA0
comma
l_int|0x01
comma
l_int|0x14
comma
l_int|0x23
comma
l_int|0xA1
comma
l_int|0x01
comma
l_int|0x28
comma
l_int|0x84
comma
l_int|0x04
comma
l_int|0x01
comma
l_int|0x0C
comma
l_int|0xDC
comma
l_int|0xE0
comma
l_int|0x23
comma
l_int|0x25
comma
l_int|0x61
comma
l_int|0xEF
comma
l_int|0x00
comma
l_int|0x14
comma
l_int|0x01
comma
l_int|0x4F
comma
l_int|0x04
comma
l_int|0xA8
comma
l_int|0x01
comma
l_int|0x6F
comma
l_int|0x00
comma
l_int|0xA5
comma
l_int|0x01
comma
l_int|0x03
comma
l_int|0x23
comma
l_int|0xA4
comma
l_int|0x01
comma
l_int|0x06
comma
l_int|0x23
comma
l_int|0x9C
comma
l_int|0x01
comma
l_int|0x24
comma
l_int|0x2B
comma
l_int|0x1C
comma
l_int|0x01
comma
l_int|0x02
comma
l_int|0xA6
comma
l_int|0xAA
comma
l_int|0x02
comma
l_int|0x07
comma
l_int|0xA6
comma
l_int|0x66
comma
l_int|0x02
comma
l_int|0x06
comma
l_int|0xA6
comma
l_int|0x6A
comma
l_int|0x02
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x12
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0x00
comma
l_int|0x0E
comma
l_int|0x80
comma
l_int|0x63
comma
l_int|0x00
comma
l_int|0x43
comma
l_int|0x00
comma
l_int|0xA0
comma
l_int|0x98
comma
l_int|0x02
comma
l_int|0x4D
comma
l_int|0x04
comma
l_int|0x04
comma
l_int|0x01
comma
l_int|0x0B
comma
l_int|0xDC
comma
l_int|0xE7
comma
l_int|0x23
comma
l_int|0x04
comma
l_int|0x61
comma
l_int|0x84
comma
l_int|0x01
comma
l_int|0x10
comma
l_int|0x31
comma
l_int|0x12
comma
l_int|0x35
comma
l_int|0x14
comma
l_int|0x01
comma
l_int|0xEC
comma
l_int|0x00
comma
l_int|0x6C
comma
l_int|0x38
comma
l_int|0x00
comma
l_int|0x3F
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0xEA
comma
l_int|0x82
comma
l_int|0x18
comma
l_int|0x23
comma
l_int|0x04
comma
l_int|0x61
comma
l_int|0x18
comma
l_int|0xA0
comma
l_int|0xE2
comma
l_int|0x02
comma
l_int|0x04
comma
l_int|0x01
comma
l_int|0x98
comma
l_int|0xC8
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x1F
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0x08
comma
l_int|0x31
comma
l_int|0x0A
comma
l_int|0x35
comma
l_int|0x0C
comma
l_int|0x39
comma
l_int|0x0E
comma
l_int|0x3D
comma
l_int|0x80
comma
l_int|0x98
comma
l_int|0xB6
comma
l_int|0x2D
comma
l_int|0x01
comma
l_int|0xA6
comma
l_int|0x14
comma
l_int|0x03
comma
l_int|0x00
comma
l_int|0xA6
comma
l_int|0x14
comma
l_int|0x03
comma
l_int|0x07
comma
l_int|0xA6
comma
l_int|0x0C
comma
l_int|0x03
comma
l_int|0x06
comma
l_int|0xA6
comma
l_int|0x10
comma
l_int|0x03
comma
l_int|0x03
comma
l_int|0xA6
comma
l_int|0x0C
comma
l_int|0x04
comma
l_int|0x02
comma
l_int|0xA6
comma
l_int|0x78
comma
l_int|0x02
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x33
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0x6A
comma
l_int|0x95
comma
l_int|0xEE
comma
l_int|0x82
comma
l_int|0x34
comma
l_int|0x96
comma
l_int|0xEE
comma
l_int|0x82
comma
l_int|0x84
comma
l_int|0x98
comma
l_int|0x80
comma
l_int|0x42
comma
l_int|0x80
comma
l_int|0x98
comma
l_int|0x60
comma
l_int|0xE4
comma
l_int|0x04
comma
l_int|0x01
comma
l_int|0x29
comma
l_int|0xC8
comma
l_int|0x31
comma
l_int|0x05
comma
l_int|0x07
comma
l_int|0x01
comma
l_int|0x00
comma
l_int|0xA2
comma
l_int|0x54
comma
l_int|0x03
comma
l_int|0x00
comma
l_int|0x43
comma
l_int|0x87
comma
l_int|0x01
comma
l_int|0x05
comma
l_int|0x05
comma
l_int|0x88
comma
l_int|0x98
comma
l_int|0x80
comma
l_int|0x98
comma
l_int|0x00
comma
l_int|0xA6
comma
l_int|0x16
comma
l_int|0x03
comma
l_int|0x07
comma
l_int|0xA6
comma
l_int|0x4C
comma
l_int|0x03
comma
l_int|0x03
comma
l_int|0xA6
comma
l_int|0x28
comma
l_int|0x04
comma
l_int|0x06
comma
l_int|0xA6
comma
l_int|0x50
comma
l_int|0x03
comma
l_int|0x01
comma
l_int|0xA6
comma
l_int|0x16
comma
l_int|0x03
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x25
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0x6A
comma
l_int|0x95
comma
l_int|0x32
comma
l_int|0x83
comma
l_int|0x34
comma
l_int|0x96
comma
l_int|0x32
comma
l_int|0x83
comma
l_int|0x04
comma
l_int|0x01
comma
l_int|0x0C
comma
l_int|0xCE
comma
l_int|0x03
comma
l_int|0xC8
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x42
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0x00
comma
l_int|0x01
comma
l_int|0x05
comma
l_int|0x05
comma
l_int|0xFF
comma
l_int|0xA2
comma
l_int|0x72
comma
l_int|0x03
comma
l_int|0xB1
comma
l_int|0x01
comma
l_int|0x08
comma
l_int|0x23
comma
l_int|0xB2
comma
l_int|0x01
comma
l_int|0x2E
comma
l_int|0x83
comma
l_int|0x05
comma
l_int|0x05
comma
l_int|0x15
comma
l_int|0x01
comma
l_int|0x00
comma
l_int|0xA2
comma
l_int|0x92
comma
l_int|0x03
comma
l_int|0xEC
comma
l_int|0x00
comma
l_int|0x6E
comma
l_int|0x00
comma
l_int|0x95
comma
l_int|0x01
comma
l_int|0x6C
comma
l_int|0x38
comma
l_int|0x00
comma
l_int|0x3F
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x01
comma
l_int|0xA6
comma
l_int|0x8E
comma
l_int|0x03
comma
l_int|0x00
comma
l_int|0xA6
comma
l_int|0x8E
comma
l_int|0x03
comma
l_int|0x02
comma
l_int|0x84
comma
l_int|0x80
comma
l_int|0x42
comma
l_int|0x80
comma
l_int|0x98
comma
l_int|0x01
comma
l_int|0xA6
comma
l_int|0x9C
comma
l_int|0x03
comma
l_int|0x00
comma
l_int|0xA6
comma
l_int|0xB4
comma
l_int|0x03
comma
l_int|0x02
comma
l_int|0x84
comma
l_int|0xA8
comma
l_int|0x98
comma
l_int|0x80
comma
l_int|0x42
comma
l_int|0x01
comma
l_int|0xA6
comma
l_int|0x9C
comma
l_int|0x03
comma
l_int|0x07
comma
l_int|0xA6
comma
l_int|0xAA
comma
l_int|0x03
comma
l_int|0xCC
comma
l_int|0x83
comma
l_int|0x6A
comma
l_int|0x95
comma
l_int|0xA0
comma
l_int|0x83
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x2F
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0xA8
comma
l_int|0x98
comma
l_int|0x80
comma
l_int|0x42
comma
l_int|0x00
comma
l_int|0xA6
comma
l_int|0xB4
comma
l_int|0x03
comma
l_int|0x07
comma
l_int|0xA6
comma
l_int|0xC2
comma
l_int|0x03
comma
l_int|0xCC
comma
l_int|0x83
comma
l_int|0x6A
comma
l_int|0x95
comma
l_int|0xB8
comma
l_int|0x83
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x26
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0x38
comma
l_int|0x2B
comma
l_int|0x80
comma
l_int|0x32
comma
l_int|0x80
comma
l_int|0x36
comma
l_int|0x04
comma
l_int|0x23
comma
l_int|0xA0
comma
l_int|0x01
comma
l_int|0x12
comma
l_int|0x23
comma
l_int|0xA1
comma
l_int|0x01
comma
l_int|0x02
comma
l_int|0x84
comma
l_int|0x04
comma
l_int|0xF0
comma
l_int|0x80
comma
l_int|0x6B
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x20
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0x03
comma
l_int|0xA6
comma
l_int|0x00
comma
l_int|0x04
comma
l_int|0x07
comma
l_int|0xA6
comma
l_int|0xF8
comma
l_int|0x03
comma
l_int|0x06
comma
l_int|0xA6
comma
l_int|0xFC
comma
l_int|0x03
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x17
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0x6A
comma
l_int|0x95
comma
l_int|0xE6
comma
l_int|0x83
comma
l_int|0x34
comma
l_int|0x96
comma
l_int|0xE6
comma
l_int|0x83
comma
l_int|0x0C
comma
l_int|0x84
comma
l_int|0x04
comma
l_int|0xF0
comma
l_int|0x80
comma
l_int|0x6B
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x20
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0xB6
comma
l_int|0x2D
comma
l_int|0x03
comma
l_int|0xA6
comma
l_int|0x28
comma
l_int|0x04
comma
l_int|0x07
comma
l_int|0xA6
comma
l_int|0x20
comma
l_int|0x04
comma
l_int|0x06
comma
l_int|0xA6
comma
l_int|0x24
comma
l_int|0x04
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x30
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0x6A
comma
l_int|0x95
comma
l_int|0x0C
comma
l_int|0x84
comma
l_int|0x34
comma
l_int|0x96
comma
l_int|0x0C
comma
l_int|0x84
comma
l_int|0x1D
comma
l_int|0x01
comma
l_int|0x06
comma
l_int|0xCC
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x00
comma
l_int|0x84
comma
l_int|0xC0
comma
l_int|0x20
comma
l_int|0x00
comma
l_int|0x23
comma
l_int|0xEA
comma
l_int|0x00
comma
l_int|0x81
comma
l_int|0x62
comma
l_int|0xA2
comma
l_int|0x0D
comma
l_int|0x80
comma
l_int|0x63
comma
l_int|0x07
comma
l_int|0xA6
comma
l_int|0x46
comma
l_int|0x04
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x18
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0x03
comma
l_int|0x03
comma
l_int|0x80
comma
l_int|0x63
comma
l_int|0xA3
comma
l_int|0x01
comma
l_int|0x07
comma
l_int|0xA4
comma
l_int|0x50
comma
l_int|0x04
comma
l_int|0x23
comma
l_int|0x01
comma
l_int|0x00
comma
l_int|0xA2
comma
l_int|0x72
comma
l_int|0x04
comma
l_int|0x0A
comma
l_int|0xA0
comma
l_int|0x62
comma
l_int|0x04
comma
l_int|0xE0
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x1D
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0x0B
comma
l_int|0xA0
comma
l_int|0x6E
comma
l_int|0x04
comma
l_int|0xE0
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x1E
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0x42
comma
l_int|0x23
comma
l_int|0xF8
comma
l_int|0x88
comma
l_int|0x00
comma
l_int|0x23
comma
l_int|0x22
comma
l_int|0xA3
comma
l_int|0xD2
comma
l_int|0x04
comma
l_int|0x08
comma
l_int|0x23
comma
l_int|0x22
comma
l_int|0xA3
comma
l_int|0x8E
comma
l_int|0x04
comma
l_int|0x28
comma
l_int|0x23
comma
l_int|0x22
comma
l_int|0xA3
comma
l_int|0x9A
comma
l_int|0x04
comma
l_int|0x02
comma
l_int|0x23
comma
l_int|0x22
comma
l_int|0xA3
comma
l_int|0xB0
comma
l_int|0x04
comma
l_int|0x42
comma
l_int|0x23
comma
l_int|0xF8
comma
l_int|0x88
comma
l_int|0x4A
comma
l_int|0x00
comma
l_int|0x06
comma
l_int|0x61
comma
l_int|0x00
comma
l_int|0xA0
comma
l_int|0x9A
comma
l_int|0x04
comma
l_int|0x45
comma
l_int|0x23
comma
l_int|0xF8
comma
l_int|0x88
comma
l_int|0x06
comma
l_int|0x98
comma
l_int|0x00
comma
l_int|0xA2
comma
l_int|0xAC
comma
l_int|0x04
comma
l_int|0xB4
comma
l_int|0x98
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x00
comma
l_int|0x82
comma
l_int|0xC0
comma
l_int|0x20
comma
l_int|0x81
comma
l_int|0x62
comma
l_int|0xF4
comma
l_int|0x81
comma
l_int|0x47
comma
l_int|0x23
comma
l_int|0xF8
comma
l_int|0x88
comma
l_int|0x04
comma
l_int|0x01
comma
l_int|0x0B
comma
l_int|0xDE
comma
l_int|0x06
comma
l_int|0x98
comma
l_int|0xB4
comma
l_int|0x98
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x00
comma
l_int|0x81
comma
l_int|0xC0
comma
l_int|0x20
comma
l_int|0x81
comma
l_int|0x62
comma
l_int|0x14
comma
l_int|0x01
comma
l_int|0x00
comma
l_int|0xA0
comma
l_int|0x0E
comma
l_int|0x02
comma
l_int|0x43
comma
l_int|0x23
comma
l_int|0xF8
comma
l_int|0x88
comma
l_int|0x04
comma
l_int|0x23
comma
l_int|0xA0
comma
l_int|0x01
comma
l_int|0x44
comma
l_int|0x23
comma
l_int|0xA1
comma
l_int|0x01
comma
l_int|0x80
comma
l_int|0x73
comma
l_int|0x4D
comma
l_int|0x00
comma
l_int|0x03
comma
l_int|0xA3
comma
l_int|0xE0
comma
l_int|0x04
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x27
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0x04
comma
l_int|0x01
comma
l_int|0x04
comma
l_int|0xDC
comma
l_int|0x02
comma
l_int|0x23
comma
l_int|0xA2
comma
l_int|0x01
comma
l_int|0x04
comma
l_int|0x23
comma
l_int|0xA0
comma
l_int|0x01
comma
l_int|0x06
comma
l_int|0x98
comma
l_int|0x14
comma
l_int|0x95
comma
l_int|0x4B
comma
l_int|0x00
comma
l_int|0xF6
comma
l_int|0x00
comma
l_int|0x4F
comma
l_int|0x04
comma
l_int|0x4F
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0xA3
comma
l_int|0x0E
comma
l_int|0x05
comma
l_int|0x00
comma
l_int|0x05
comma
l_int|0x76
comma
l_int|0x00
comma
l_int|0x06
comma
l_int|0x61
comma
l_int|0x00
comma
l_int|0xA2
comma
l_int|0x08
comma
l_int|0x05
comma
l_int|0xF6
comma
l_int|0x84
comma
l_int|0x48
comma
l_int|0x97
comma
l_int|0xCD
comma
l_int|0x04
comma
l_int|0x12
comma
l_int|0x85
comma
l_int|0x48
comma
l_int|0x04
comma
l_int|0xFF
comma
l_int|0x23
comma
l_int|0x84
comma
l_int|0x80
comma
l_int|0x02
comma
l_int|0x01
comma
l_int|0x03
comma
l_int|0xDA
comma
l_int|0x80
comma
l_int|0x23
comma
l_int|0x82
comma
l_int|0x01
comma
l_int|0x22
comma
l_int|0x85
comma
l_int|0x02
comma
l_int|0x23
comma
l_int|0xA0
comma
l_int|0x01
comma
l_int|0x4A
comma
l_int|0x00
comma
l_int|0x06
comma
l_int|0x61
comma
l_int|0x00
comma
l_int|0xA2
comma
l_int|0x2E
comma
l_int|0x05
comma
l_int|0x1D
comma
l_int|0x01
comma
l_int|0x04
comma
l_int|0xD6
comma
l_int|0xFF
comma
l_int|0x23
comma
l_int|0x86
comma
l_int|0x41
comma
l_int|0x4B
comma
l_int|0x60
comma
l_int|0xCB
comma
l_int|0x00
comma
l_int|0xFF
comma
l_int|0x23
comma
l_int|0x80
comma
l_int|0x01
comma
l_int|0x49
comma
l_int|0x00
comma
l_int|0x81
comma
l_int|0x01
comma
l_int|0x04
comma
l_int|0x01
comma
l_int|0x02
comma
l_int|0xC8
comma
l_int|0x30
comma
l_int|0x01
comma
l_int|0x80
comma
l_int|0x01
comma
l_int|0xF7
comma
l_int|0x04
comma
l_int|0x03
comma
l_int|0x01
comma
l_int|0x49
comma
l_int|0x04
comma
l_int|0x80
comma
l_int|0x01
comma
l_int|0xC9
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x05
comma
l_int|0x00
comma
l_int|0x01
comma
l_int|0xFF
comma
l_int|0xA0
comma
l_int|0x4E
comma
l_int|0x05
comma
l_int|0x77
comma
l_int|0x04
comma
l_int|0x01
comma
l_int|0x23
comma
l_int|0xEA
comma
l_int|0x00
comma
l_int|0x5D
comma
l_int|0x00
comma
l_int|0xFE
comma
l_int|0xC7
comma
l_int|0x00
comma
l_int|0x62
comma
l_int|0x00
comma
l_int|0x23
comma
l_int|0xEA
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x63
comma
l_int|0x07
comma
l_int|0xA4
comma
l_int|0xCC
comma
l_int|0x05
comma
l_int|0x03
comma
l_int|0x03
comma
l_int|0x02
comma
l_int|0xA0
comma
l_int|0x7C
comma
l_int|0x05
comma
l_int|0xC8
comma
l_int|0x85
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x2D
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0x04
comma
l_int|0xA0
comma
l_int|0xA2
comma
l_int|0x05
comma
l_int|0x80
comma
l_int|0x63
comma
l_int|0x4A
comma
l_int|0x00
comma
l_int|0x06
comma
l_int|0x61
comma
l_int|0x00
comma
l_int|0xA2
comma
l_int|0x8E
comma
l_int|0x05
comma
l_int|0x1D
comma
l_int|0x01
comma
l_int|0x06
comma
l_int|0xD6
comma
l_int|0x02
comma
l_int|0x23
comma
l_int|0x02
comma
l_int|0x41
comma
l_int|0x82
comma
l_int|0x01
comma
l_int|0x50
comma
l_int|0x00
comma
l_int|0x64
comma
l_int|0x97
comma
l_int|0xF0
comma
l_int|0x84
comma
l_int|0x04
comma
l_int|0x23
comma
l_int|0x02
comma
l_int|0x41
comma
l_int|0x82
comma
l_int|0x01
comma
l_int|0xF0
comma
l_int|0x84
comma
l_int|0x08
comma
l_int|0xA0
comma
l_int|0xA8
comma
l_int|0x05
comma
l_int|0xC8
comma
l_int|0x85
comma
l_int|0x03
comma
l_int|0xA0
comma
l_int|0xAE
comma
l_int|0x05
comma
l_int|0xC8
comma
l_int|0x85
comma
l_int|0x01
comma
l_int|0xA0
comma
l_int|0xBA
comma
l_int|0x05
comma
l_int|0x88
comma
l_int|0x00
comma
l_int|0x80
comma
l_int|0x63
comma
l_int|0xB8
comma
l_int|0x96
comma
l_int|0x6A
comma
l_int|0x85
comma
l_int|0x07
comma
l_int|0xA0
comma
l_int|0xC6
comma
l_int|0x05
comma
l_int|0x06
comma
l_int|0x23
comma
l_int|0x6A
comma
l_int|0x98
comma
l_int|0x48
comma
l_int|0x23
comma
l_int|0xF8
comma
l_int|0x88
comma
l_int|0xC8
comma
l_int|0x86
comma
l_int|0x80
comma
l_int|0x63
comma
l_int|0x6A
comma
l_int|0x85
comma
l_int|0x00
comma
l_int|0x63
comma
l_int|0x4A
comma
l_int|0x00
comma
l_int|0x06
comma
l_int|0x61
comma
l_int|0x00
comma
l_int|0xA2
comma
l_int|0x0A
comma
l_int|0x06
comma
l_int|0x1D
comma
l_int|0x01
comma
l_int|0x18
comma
l_int|0xD4
comma
l_int|0xC0
comma
l_int|0x23
comma
l_int|0x07
comma
l_int|0x41
comma
l_int|0x83
comma
l_int|0x03
comma
l_int|0x80
comma
l_int|0x63
comma
l_int|0x06
comma
l_int|0xA6
comma
l_int|0xEC
comma
l_int|0x05
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x37
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0x1D
comma
l_int|0x01
comma
l_int|0x02
comma
l_int|0xD6
comma
l_int|0x46
comma
l_int|0x23
comma
l_int|0xF8
comma
l_int|0x88
comma
l_int|0x63
comma
l_int|0x60
comma
l_int|0x83
comma
l_int|0x03
comma
l_int|0x80
comma
l_int|0x63
comma
l_int|0x06
comma
l_int|0xA6
comma
l_int|0x04
comma
l_int|0x06
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x38
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0xEF
comma
l_int|0x04
comma
l_int|0x6F
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x63
comma
l_int|0x4B
comma
l_int|0x00
comma
l_int|0x06
comma
l_int|0x41
comma
l_int|0xCB
comma
l_int|0x00
comma
l_int|0x52
comma
l_int|0x00
comma
l_int|0x06
comma
l_int|0x61
comma
l_int|0x00
comma
l_int|0xA2
comma
l_int|0x22
comma
l_int|0x06
comma
l_int|0x1D
comma
l_int|0x01
comma
l_int|0x03
comma
l_int|0xCA
comma
l_int|0xC0
comma
l_int|0x23
comma
l_int|0x07
comma
l_int|0x41
comma
l_int|0x00
comma
l_int|0x63
comma
l_int|0x1D
comma
l_int|0x01
comma
l_int|0x04
comma
l_int|0xCC
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x00
comma
l_int|0x83
comma
l_int|0xC0
comma
l_int|0x20
comma
l_int|0x81
comma
l_int|0x62
comma
l_int|0x80
comma
l_int|0x23
comma
l_int|0x07
comma
l_int|0x41
comma
l_int|0x00
comma
l_int|0x63
comma
l_int|0x80
comma
l_int|0x67
comma
l_int|0x08
comma
l_int|0x23
comma
l_int|0x83
comma
l_int|0x03
comma
l_int|0x80
comma
l_int|0x63
comma
l_int|0x00
comma
l_int|0x63
comma
l_int|0x06
comma
l_int|0xA6
comma
l_int|0x50
comma
l_int|0x06
comma
l_int|0x07
comma
l_int|0xA6
comma
l_int|0xA4
comma
l_int|0x06
comma
l_int|0x02
comma
l_int|0xA6
comma
l_int|0xFC
comma
l_int|0x06
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x39
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x01
comma
l_int|0xA0
comma
l_int|0x16
comma
l_int|0x07
comma
l_int|0xCE
comma
l_int|0x95
comma
l_int|0x83
comma
l_int|0x03
comma
l_int|0x80
comma
l_int|0x63
comma
l_int|0x06
comma
l_int|0xA6
comma
l_int|0x64
comma
l_int|0x06
comma
l_int|0x07
comma
l_int|0xA6
comma
l_int|0xA4
comma
l_int|0x06
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x01
comma
l_int|0xA0
comma
l_int|0x16
comma
l_int|0x07
comma
l_int|0x00
comma
l_int|0x2B
comma
l_int|0x40
comma
l_int|0x0E
comma
l_int|0x80
comma
l_int|0x63
comma
l_int|0x01
comma
l_int|0x00
comma
l_int|0x06
comma
l_int|0xA6
comma
l_int|0x80
comma
l_int|0x06
comma
l_int|0x07
comma
l_int|0xA6
comma
l_int|0xA4
comma
l_int|0x06
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x3A
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0x40
comma
l_int|0x0E
comma
l_int|0x80
comma
l_int|0x63
comma
l_int|0x00
comma
l_int|0x43
comma
l_int|0x00
comma
l_int|0xA0
comma
l_int|0x72
comma
l_int|0x06
comma
l_int|0x06
comma
l_int|0xA6
comma
l_int|0x98
comma
l_int|0x06
comma
l_int|0x07
comma
l_int|0xA6
comma
l_int|0xA4
comma
l_int|0x06
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x3B
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0x80
comma
l_int|0x67
comma
l_int|0x40
comma
l_int|0x0E
comma
l_int|0x80
comma
l_int|0x63
comma
l_int|0x07
comma
l_int|0xA6
comma
l_int|0xA4
comma
l_int|0x06
comma
l_int|0x00
comma
l_int|0x63
comma
l_int|0x03
comma
l_int|0x03
comma
l_int|0x80
comma
l_int|0x63
comma
l_int|0x88
comma
l_int|0x00
comma
l_int|0x01
comma
l_int|0xA2
comma
l_int|0xB8
comma
l_int|0x06
comma
l_int|0x07
comma
l_int|0xA2
comma
l_int|0xFC
comma
l_int|0x06
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x35
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0x07
comma
l_int|0xA6
comma
l_int|0xC2
comma
l_int|0x06
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x2A
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0x03
comma
l_int|0x03
comma
l_int|0x03
comma
l_int|0xA2
comma
l_int|0xCE
comma
l_int|0x06
comma
l_int|0x07
comma
l_int|0x23
comma
l_int|0x80
comma
l_int|0x00
comma
l_int|0x08
comma
l_int|0x87
comma
l_int|0x80
comma
l_int|0x63
comma
l_int|0x89
comma
l_int|0x00
comma
l_int|0x0A
comma
l_int|0x2B
comma
l_int|0x07
comma
l_int|0xA6
comma
l_int|0xDE
comma
l_int|0x06
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x29
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0x00
comma
l_int|0x43
comma
l_int|0x00
comma
l_int|0xA2
comma
l_int|0xEA
comma
l_int|0x06
comma
l_int|0xC0
comma
l_int|0x0E
comma
l_int|0x80
comma
l_int|0x63
comma
l_int|0xD4
comma
l_int|0x86
comma
l_int|0xC0
comma
l_int|0x0E
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x00
comma
l_int|0x80
comma
l_int|0xC0
comma
l_int|0x20
comma
l_int|0x81
comma
l_int|0x62
comma
l_int|0x04
comma
l_int|0x01
comma
l_int|0x08
comma
l_int|0xDA
comma
l_int|0x80
comma
l_int|0x63
comma
l_int|0x00
comma
l_int|0x63
comma
l_int|0x80
comma
l_int|0x67
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x00
comma
l_int|0x40
comma
l_int|0xC0
comma
l_int|0x20
comma
l_int|0x81
comma
l_int|0x62
comma
l_int|0x00
comma
l_int|0x63
comma
l_int|0x80
comma
l_int|0x7B
comma
l_int|0x80
comma
l_int|0x63
comma
l_int|0x06
comma
l_int|0xA6
comma
l_int|0x5C
comma
l_int|0x06
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x2C
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0x0C
comma
l_int|0xA2
comma
l_int|0x30
comma
l_int|0x07
comma
l_int|0xCE
comma
l_int|0x95
comma
l_int|0x83
comma
l_int|0x03
comma
l_int|0x80
comma
l_int|0x63
comma
l_int|0x06
comma
l_int|0xA6
comma
l_int|0x2E
comma
l_int|0x07
comma
l_int|0x07
comma
l_int|0xA6
comma
l_int|0xA4
comma
l_int|0x06
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x3D
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x80
comma
l_int|0x67
comma
l_int|0x83
comma
l_int|0x03
comma
l_int|0x80
comma
l_int|0x63
comma
l_int|0x0C
comma
l_int|0xA0
comma
l_int|0x46
comma
l_int|0x07
comma
l_int|0x07
comma
l_int|0xA6
comma
l_int|0xA4
comma
l_int|0x06
comma
l_int|0xBF
comma
l_int|0x23
comma
l_int|0x04
comma
l_int|0x61
comma
l_int|0x84
comma
l_int|0x01
comma
l_int|0xD2
comma
l_int|0x84
comma
l_int|0x00
comma
l_int|0x63
comma
l_int|0xF0
comma
l_int|0x04
comma
l_int|0x01
comma
l_int|0x01
comma
l_int|0xF1
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x01
comma
l_int|0xF2
comma
l_int|0x00
comma
l_int|0x01
comma
l_int|0x05
comma
l_int|0x80
comma
l_int|0x01
comma
l_int|0x72
comma
l_int|0x04
comma
l_int|0x71
comma
l_int|0x00
comma
l_int|0x81
comma
l_int|0x01
comma
l_int|0x70
comma
l_int|0x04
comma
l_int|0x80
comma
l_int|0x05
comma
l_int|0x81
comma
l_int|0x05
comma
l_int|0x00
comma
l_int|0x63
comma
l_int|0xF0
comma
l_int|0x04
comma
l_int|0xF2
comma
l_int|0x00
comma
l_int|0x72
comma
l_int|0x04
comma
l_int|0x01
comma
l_int|0x01
comma
l_int|0xF1
comma
l_int|0x00
comma
l_int|0x70
comma
l_int|0x00
comma
l_int|0x81
comma
l_int|0x01
comma
l_int|0x70
comma
l_int|0x04
comma
l_int|0x71
comma
l_int|0x00
comma
l_int|0x81
comma
l_int|0x01
comma
l_int|0x72
comma
l_int|0x00
comma
l_int|0x80
comma
l_int|0x01
comma
l_int|0x71
comma
l_int|0x04
comma
l_int|0x70
comma
l_int|0x00
comma
l_int|0x80
comma
l_int|0x01
comma
l_int|0x70
comma
l_int|0x04
comma
l_int|0x00
comma
l_int|0x63
comma
l_int|0xF0
comma
l_int|0x04
comma
l_int|0xF2
comma
l_int|0x00
comma
l_int|0x72
comma
l_int|0x04
comma
l_int|0x00
comma
l_int|0x01
comma
l_int|0xF1
comma
l_int|0x00
comma
l_int|0x70
comma
l_int|0x00
comma
l_int|0x80
comma
l_int|0x01
comma
l_int|0x70
comma
l_int|0x04
comma
l_int|0x71
comma
l_int|0x00
comma
l_int|0x80
comma
l_int|0x01
comma
l_int|0x72
comma
l_int|0x00
comma
l_int|0x81
comma
l_int|0x01
comma
l_int|0x71
comma
l_int|0x04
comma
l_int|0x70
comma
l_int|0x00
comma
l_int|0x81
comma
l_int|0x01
comma
l_int|0x70
comma
l_int|0x04
comma
l_int|0x00
comma
l_int|0x63
comma
l_int|0x00
comma
l_int|0x23
comma
l_int|0xB3
comma
l_int|0x01
comma
l_int|0x83
comma
l_int|0x05
comma
l_int|0xA3
comma
l_int|0x01
comma
l_int|0xA2
comma
l_int|0x01
comma
l_int|0xA1
comma
l_int|0x01
comma
l_int|0x01
comma
l_int|0x23
comma
l_int|0xA0
comma
l_int|0x01
comma
l_int|0x00
comma
l_int|0x01
comma
l_int|0xC8
comma
l_int|0x00
comma
l_int|0x03
comma
l_int|0xA1
comma
l_int|0xC6
comma
l_int|0x07
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x07
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0x80
comma
l_int|0x05
comma
l_int|0x81
comma
l_int|0x05
comma
l_int|0x04
comma
l_int|0x01
comma
l_int|0x11
comma
l_int|0xC8
comma
l_int|0x48
comma
l_int|0x00
comma
l_int|0xB0
comma
l_int|0x01
comma
l_int|0xB1
comma
l_int|0x01
comma
l_int|0x08
comma
l_int|0x23
comma
l_int|0xB2
comma
l_int|0x01
comma
l_int|0x05
comma
l_int|0x01
comma
l_int|0x48
comma
l_int|0x04
comma
l_int|0x00
comma
l_int|0x43
comma
l_int|0x00
comma
l_int|0xA2
comma
l_int|0xE6
comma
l_int|0x07
comma
l_int|0x00
comma
l_int|0x05
comma
l_int|0xDC
comma
l_int|0x87
comma
l_int|0x00
comma
l_int|0x01
comma
l_int|0xC8
comma
l_int|0x00
comma
l_int|0xFF
comma
l_int|0x23
comma
l_int|0x80
comma
l_int|0x01
comma
l_int|0x05
comma
l_int|0x05
comma
l_int|0x00
comma
l_int|0x63
comma
l_int|0xF7
comma
l_int|0x04
comma
l_int|0x1A
comma
l_int|0x09
comma
l_int|0xF6
comma
l_int|0x08
comma
l_int|0x6E
comma
l_int|0x04
comma
l_int|0x00
comma
l_int|0x02
comma
l_int|0x80
comma
l_int|0x43
comma
l_int|0x76
comma
l_int|0x08
comma
l_int|0x80
comma
l_int|0x02
comma
l_int|0x77
comma
l_int|0x04
comma
l_int|0x00
comma
l_int|0x63
comma
l_int|0xF7
comma
l_int|0x04
comma
l_int|0x1A
comma
l_int|0x09
comma
l_int|0xF6
comma
l_int|0x08
comma
l_int|0x6E
comma
l_int|0x04
comma
l_int|0x00
comma
l_int|0x02
comma
l_int|0x00
comma
l_int|0xA0
comma
l_int|0x16
comma
l_int|0x08
comma
l_int|0x18
comma
l_int|0x88
comma
l_int|0x00
comma
l_int|0x43
comma
l_int|0x76
comma
l_int|0x08
comma
l_int|0x80
comma
l_int|0x02
comma
l_int|0x77
comma
l_int|0x04
comma
l_int|0x00
comma
l_int|0x63
comma
l_int|0xF3
comma
l_int|0x04
comma
l_int|0x00
comma
l_int|0x23
comma
l_int|0xF4
comma
l_int|0x00
comma
l_int|0x74
comma
l_int|0x00
comma
l_int|0x80
comma
l_int|0x43
comma
l_int|0xF4
comma
l_int|0x00
comma
l_int|0xCF
comma
l_int|0x40
comma
l_int|0x00
comma
l_int|0xA2
comma
l_int|0x46
comma
l_int|0x08
comma
l_int|0x74
comma
l_int|0x04
comma
l_int|0x02
comma
l_int|0x01
comma
l_int|0xF7
comma
l_int|0xC9
comma
l_int|0xF6
comma
l_int|0xD9
comma
l_int|0x00
comma
l_int|0x01
comma
l_int|0x01
comma
l_int|0xA1
comma
l_int|0x26
comma
l_int|0x08
comma
l_int|0x06
comma
l_int|0x98
comma
l_int|0x14
comma
l_int|0x95
comma
l_int|0x26
comma
l_int|0x88
comma
l_int|0x73
comma
l_int|0x04
comma
l_int|0x00
comma
l_int|0x63
comma
l_int|0xF3
comma
l_int|0x04
comma
l_int|0x75
comma
l_int|0x04
comma
l_int|0x5C
comma
l_int|0x88
comma
l_int|0x02
comma
l_int|0x01
comma
l_int|0x04
comma
l_int|0xD8
comma
l_int|0x48
comma
l_int|0x97
comma
l_int|0x06
comma
l_int|0x98
comma
l_int|0x14
comma
l_int|0x95
comma
l_int|0x4C
comma
l_int|0x88
comma
l_int|0x75
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0xA3
comma
l_int|0x66
comma
l_int|0x08
comma
l_int|0x00
comma
l_int|0x05
comma
l_int|0x50
comma
l_int|0x88
comma
l_int|0x73
comma
l_int|0x04
comma
l_int|0x00
comma
l_int|0x63
comma
l_int|0x80
comma
l_int|0x7B
comma
l_int|0x80
comma
l_int|0x63
comma
l_int|0x06
comma
l_int|0xA6
comma
l_int|0x78
comma
l_int|0x08
comma
l_int|0x00
comma
l_int|0x33
comma
l_int|0x3E
comma
l_int|0x00
comma
l_int|0xC2
comma
l_int|0x88
comma
l_int|0x80
comma
l_int|0x67
comma
l_int|0x83
comma
l_int|0x03
comma
l_int|0x80
comma
l_int|0x63
comma
l_int|0x00
comma
l_int|0x63
comma
l_int|0x38
comma
l_int|0x2B
comma
l_int|0x9E
comma
l_int|0x88
comma
l_int|0x38
comma
l_int|0x2B
comma
l_int|0x94
comma
l_int|0x88
comma
l_int|0x32
comma
l_int|0x09
comma
l_int|0x31
comma
l_int|0x05
comma
l_int|0x94
comma
l_int|0x98
comma
l_int|0x05
comma
l_int|0x05
comma
l_int|0xB2
comma
l_int|0x09
comma
l_int|0x00
comma
l_int|0x63
comma
l_int|0x00
comma
l_int|0x32
comma
l_int|0x00
comma
l_int|0x36
comma
l_int|0x00
comma
l_int|0x3A
comma
l_int|0x00
comma
l_int|0x3E
comma
l_int|0x00
comma
l_int|0x63
comma
l_int|0x80
comma
l_int|0x32
comma
l_int|0x80
comma
l_int|0x36
comma
l_int|0x80
comma
l_int|0x3A
comma
l_int|0x80
comma
l_int|0x3E
comma
l_int|0x00
comma
l_int|0x63
comma
l_int|0x38
comma
l_int|0x2B
comma
l_int|0x40
comma
l_int|0x32
comma
l_int|0x40
comma
l_int|0x36
comma
l_int|0x40
comma
l_int|0x3A
comma
l_int|0x40
comma
l_int|0x3E
comma
l_int|0x00
comma
l_int|0x63
comma
l_int|0x5A
comma
l_int|0x20
comma
l_int|0xC9
comma
l_int|0x40
comma
l_int|0x00
comma
l_int|0xA0
comma
l_int|0xB4
comma
l_int|0x08
comma
l_int|0x5D
comma
l_int|0x00
comma
l_int|0xFE
comma
l_int|0xC3
comma
l_int|0x00
comma
l_int|0x63
comma
l_int|0x80
comma
l_int|0x73
comma
l_int|0xE6
comma
l_int|0x20
comma
l_int|0x02
comma
l_int|0x23
comma
l_int|0xE8
comma
l_int|0x00
comma
l_int|0x82
comma
l_int|0x73
comma
l_int|0xFF
comma
l_int|0xFD
comma
l_int|0x80
comma
l_int|0x73
comma
l_int|0x13
comma
l_int|0x23
comma
l_int|0xF8
comma
l_int|0x88
comma
l_int|0x66
comma
l_int|0x20
comma
l_int|0xC0
comma
l_int|0x20
comma
l_int|0x04
comma
l_int|0x23
comma
l_int|0xA0
comma
l_int|0x01
comma
l_int|0xA1
comma
l_int|0x23
comma
l_int|0xA1
comma
l_int|0x01
comma
l_int|0x81
comma
l_int|0x62
comma
l_int|0xE2
comma
l_int|0x88
comma
l_int|0x80
comma
l_int|0x73
comma
l_int|0x80
comma
l_int|0x77
comma
l_int|0x68
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0xA2
comma
l_int|0x80
comma
l_int|0x00
comma
l_int|0x03
comma
l_int|0xC2
comma
l_int|0xF1
comma
l_int|0xC7
comma
l_int|0x41
comma
l_int|0x23
comma
l_int|0xF8
comma
l_int|0x88
comma
l_int|0x11
comma
l_int|0x23
comma
l_int|0xA1
comma
l_int|0x01
comma
l_int|0x04
comma
l_int|0x23
comma
l_int|0xA0
comma
l_int|0x01
comma
l_int|0xD2
comma
l_int|0x84
comma
)brace
suffix:semicolon
DECL|variable|_mcode_size
id|ushort
id|_mcode_size
op_assign
r_sizeof
(paren
id|_mcode_buf
)paren
suffix:semicolon
DECL|variable|_mcode_chksum
id|ulong
id|_mcode_chksum
op_assign
l_int|0x012CD3FFUL
suffix:semicolon
DECL|macro|ASC_SYN_OFFSET_ONE_DISABLE_LIST
mdefine_line|#define ASC_SYN_OFFSET_ONE_DISABLE_LIST  16
DECL|variable|_syn_offset_one_disable_cmd
id|uchar
id|_syn_offset_one_disable_cmd
(braket
id|ASC_SYN_OFFSET_ONE_DISABLE_LIST
)braket
op_assign
(brace
id|SCSICMD_Inquiry
comma
id|SCSICMD_RequestSense
comma
id|SCSICMD_ReadCapacity
comma
id|SCSICMD_ReadTOC
comma
id|SCSICMD_ModeSelect6
comma
id|SCSICMD_ModeSense6
comma
id|SCSICMD_ModeSelect10
comma
id|SCSICMD_ModeSense10
comma
l_int|0xFF
comma
l_int|0xFF
comma
l_int|0xFF
comma
l_int|0xFF
comma
l_int|0xFF
comma
l_int|0xFF
comma
l_int|0xFF
comma
l_int|0xFF
)brace
suffix:semicolon
r_int
DECL|function|AscExeScsiQueue
id|AscExeScsiQueue
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|REG
id|ASC_SCSI_Q
id|dosfar
op_star
id|scsiq
)paren
(brace
id|PortAddr
id|iop_base
suffix:semicolon
r_int
id|last_int_level
suffix:semicolon
r_int
id|sta
suffix:semicolon
r_int
id|n_q_required
suffix:semicolon
r_int
id|disable_syn_offset_one_fix
suffix:semicolon
r_int
id|i
suffix:semicolon
id|ulong
id|addr
suffix:semicolon
id|ASC_EXE_CALLBACK
id|asc_exe_callback
suffix:semicolon
id|ushort
id|sg_entry_cnt
op_assign
l_int|0
suffix:semicolon
id|ushort
id|sg_entry_cnt_minus_one
op_assign
l_int|0
suffix:semicolon
id|uchar
id|target_ix
suffix:semicolon
id|uchar
id|tid_no
suffix:semicolon
id|uchar
id|sdtr_data
suffix:semicolon
id|uchar
id|extra_bytes
suffix:semicolon
id|uchar
id|scsi_cmd
suffix:semicolon
id|uchar
id|disable_cmd
suffix:semicolon
id|ASC_SG_HEAD
id|dosfar
op_star
id|sg_head
suffix:semicolon
id|ulong
id|data_cnt
suffix:semicolon
macro_line|#if CC_LINK_BUSY_Q
id|ASC_SCSI_Q
id|dosfar
op_star
id|scsiq_tail
suffix:semicolon
id|ASC_SCSI_Q
id|dosfar
op_star
id|scsiq_next
suffix:semicolon
id|ASC_SCSI_Q
id|dosfar
op_star
id|scsiq_prev
suffix:semicolon
macro_line|#endif
id|iop_base
op_assign
id|asc_dvc-&gt;iop_base
suffix:semicolon
id|sg_head
op_assign
id|scsiq-&gt;sg_head
suffix:semicolon
id|asc_exe_callback
op_assign
(paren
id|ASC_EXE_CALLBACK
)paren
id|asc_dvc-&gt;exe_callback
suffix:semicolon
r_if
c_cond
(paren
id|asc_dvc-&gt;err_code
op_ne
l_int|0
)paren
r_return
(paren
id|ERR
)paren
suffix:semicolon
r_if
c_cond
(paren
id|scsiq
op_eq
(paren
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
l_int|0L
)paren
(brace
id|AscSetLibErrorCode
c_func
(paren
id|asc_dvc
comma
id|ASCQ_ERR_SCSIQ_NULL_PTR
)paren
suffix:semicolon
r_return
(paren
id|ERR
)paren
suffix:semicolon
)brace
id|scsiq-&gt;q1.q_no
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;q1.extra_bytes
op_assign
l_int|0
suffix:semicolon
id|sta
op_assign
l_int|0
suffix:semicolon
id|target_ix
op_assign
id|scsiq-&gt;q2.target_ix
suffix:semicolon
id|tid_no
op_assign
id|ASC_TIX_TO_TID
c_func
(paren
id|target_ix
)paren
suffix:semicolon
id|n_q_required
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|scsiq-&gt;cdbptr
(braket
l_int|0
)braket
op_eq
id|SCSICMD_RequestSense
)paren
(brace
r_if
c_cond
(paren
(paren
(paren
id|asc_dvc-&gt;init_sdtr
op_amp
id|scsiq-&gt;q1.target_id
)paren
op_ne
l_int|0
)paren
op_logical_and
(paren
(paren
id|asc_dvc-&gt;sdtr_done
op_amp
id|scsiq-&gt;q1.target_id
)paren
op_ne
l_int|0
)paren
)paren
(brace
id|sdtr_data
op_assign
id|AscGetMCodeInitSDTRAtID
c_func
(paren
id|iop_base
comma
id|tid_no
)paren
suffix:semicolon
id|AscMsgOutSDTR
c_func
(paren
id|asc_dvc
comma
id|asc_dvc-&gt;sdtr_period_tbl
(braket
(paren
id|sdtr_data
op_rshift
l_int|4
)paren
op_amp
(paren
id|uchar
)paren
(paren
id|ASC_SYN_XFER_NO
op_minus
l_int|1
)paren
)braket
comma
(paren
id|uchar
)paren
(paren
id|sdtr_data
op_amp
(paren
id|uchar
)paren
id|ASC_SYN_MAX_OFFSET
)paren
)paren
suffix:semicolon
id|scsiq-&gt;q1.cntl
op_or_assign
(paren
id|QC_MSG_OUT
op_or
id|QC_URGENT
)paren
suffix:semicolon
)brace
)brace
id|last_int_level
op_assign
id|DvcEnterCritical
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|asc_dvc-&gt;in_critical_cnt
op_ne
l_int|0
)paren
(brace
id|DvcLeaveCritical
c_func
(paren
id|last_int_level
)paren
suffix:semicolon
id|AscSetLibErrorCode
c_func
(paren
id|asc_dvc
comma
id|ASCQ_ERR_CRITICAL_RE_ENTRY
)paren
suffix:semicolon
r_return
(paren
id|ERR
)paren
suffix:semicolon
)brace
id|asc_dvc-&gt;in_critical_cnt
op_increment
suffix:semicolon
r_if
c_cond
(paren
(paren
id|scsiq-&gt;q1.cntl
op_amp
id|QC_SG_HEAD
)paren
op_ne
l_int|0
)paren
(brace
r_if
c_cond
(paren
(paren
id|sg_entry_cnt
op_assign
id|sg_head-&gt;entry_cnt
)paren
op_eq
l_int|0
)paren
(brace
id|asc_dvc-&gt;in_critical_cnt
op_decrement
suffix:semicolon
id|DvcLeaveCritical
c_func
(paren
id|last_int_level
)paren
suffix:semicolon
r_return
(paren
id|ERR
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|sg_entry_cnt
OG
id|ASC_MAX_SG_LIST
)paren
(brace
r_return
(paren
id|ERR
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|sg_entry_cnt
op_eq
l_int|1
)paren
(brace
id|scsiq-&gt;q1.data_addr
op_assign
id|sg_head-&gt;sg_list
(braket
l_int|0
)braket
dot
id|addr
suffix:semicolon
id|scsiq-&gt;q1.data_cnt
op_assign
id|sg_head-&gt;sg_list
(braket
l_int|0
)braket
dot
id|bytes
suffix:semicolon
id|scsiq-&gt;q1.cntl
op_and_assign
op_complement
(paren
id|QC_SG_HEAD
op_or
id|QC_SG_SWAP_QUEUE
)paren
suffix:semicolon
)brace
r_else
(brace
macro_line|#if CC_CHK_AND_COALESCE_SG_LIST
id|AscCoalesceSgList
c_func
(paren
id|scsiq
)paren
suffix:semicolon
id|sg_entry_cnt
op_assign
id|sg_head-&gt;entry_cnt
suffix:semicolon
macro_line|#endif
)brace
id|sg_entry_cnt_minus_one
op_assign
id|sg_entry_cnt
op_minus
l_int|1
suffix:semicolon
macro_line|#if CC_DEBUG_SG_LIST
r_if
c_cond
(paren
id|asc_dvc-&gt;bus_type
op_amp
(paren
id|ASC_IS_ISA
op_or
id|ASC_IS_VL
op_or
id|ASC_IS_EISA
)paren
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|sg_entry_cnt_minus_one
suffix:semicolon
id|i
op_increment
)paren
(brace
id|addr
op_assign
id|sg_head-&gt;sg_list
(braket
id|i
)braket
dot
id|addr
op_plus
id|sg_head-&gt;sg_list
(braket
id|i
)braket
dot
id|bytes
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
id|ushort
)paren
id|addr
op_amp
l_int|0x0003
)paren
op_ne
l_int|0
)paren
(brace
id|asc_dvc-&gt;in_critical_cnt
op_decrement
suffix:semicolon
id|DvcLeaveCritical
c_func
(paren
id|last_int_level
)paren
suffix:semicolon
id|AscSetLibErrorCode
c_func
(paren
id|asc_dvc
comma
id|ASCQ_ERR_SG_LIST_ODD_ADDRESS
)paren
suffix:semicolon
r_return
(paren
id|ERR
)paren
suffix:semicolon
)brace
)brace
)brace
macro_line|#endif
)brace
id|scsi_cmd
op_assign
id|scsiq-&gt;cdbptr
(braket
l_int|0
)braket
suffix:semicolon
id|disable_syn_offset_one_fix
op_assign
id|FALSE
suffix:semicolon
r_if
c_cond
(paren
(paren
id|asc_dvc-&gt;pci_fix_asyn_xfer
op_amp
id|scsiq-&gt;q1.target_id
)paren
op_logical_and
op_logical_neg
(paren
id|asc_dvc-&gt;pci_fix_asyn_xfer_always
op_amp
id|scsiq-&gt;q1.target_id
)paren
)paren
(brace
r_if
c_cond
(paren
id|scsiq-&gt;q1.cntl
op_amp
id|QC_SG_HEAD
)paren
(brace
id|data_cnt
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|sg_entry_cnt
suffix:semicolon
id|i
op_increment
)paren
(brace
id|data_cnt
op_add_assign
id|sg_head-&gt;sg_list
(braket
id|i
)braket
dot
id|bytes
suffix:semicolon
)brace
)brace
r_else
(brace
id|data_cnt
op_assign
id|scsiq-&gt;q1.data_cnt
suffix:semicolon
)brace
r_if
c_cond
(paren
id|data_cnt
op_ne
l_int|0UL
)paren
(brace
r_if
c_cond
(paren
id|data_cnt
OL
l_int|512UL
)paren
(brace
id|disable_syn_offset_one_fix
op_assign
id|TRUE
suffix:semicolon
)brace
r_else
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ASC_SYN_OFFSET_ONE_DISABLE_LIST
suffix:semicolon
id|i
op_increment
)paren
(brace
id|disable_cmd
op_assign
id|_syn_offset_one_disable_cmd
(braket
id|i
)braket
suffix:semicolon
r_if
c_cond
(paren
id|disable_cmd
op_eq
l_int|0xFF
)paren
(brace
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|scsi_cmd
op_eq
id|disable_cmd
)paren
(brace
id|disable_syn_offset_one_fix
op_assign
id|TRUE
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
)brace
)brace
)brace
r_if
c_cond
(paren
id|disable_syn_offset_one_fix
)paren
(brace
id|scsiq-&gt;q2.tag_code
op_and_assign
op_complement
id|M2_QTAG_MSG_SIMPLE
suffix:semicolon
id|scsiq-&gt;q2.tag_code
op_or_assign
(paren
id|ASC_TAG_FLAG_DISABLE_ASYN_USE_SYN_FIX
op_or
id|ASC_TAG_FLAG_DISABLE_DISCONNECT
)paren
suffix:semicolon
)brace
r_else
(brace
id|scsiq-&gt;q2.tag_code
op_and_assign
l_int|0x23
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|scsiq-&gt;q1.cntl
op_amp
id|QC_SG_HEAD
)paren
op_ne
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|asc_dvc-&gt;bug_fix_cntl
)paren
(brace
r_if
c_cond
(paren
id|asc_dvc-&gt;bug_fix_cntl
op_amp
id|ASC_BUG_FIX_IF_NOT_DWB
)paren
(brace
r_if
c_cond
(paren
(paren
id|scsi_cmd
op_eq
id|SCSICMD_Read6
)paren
op_logical_or
(paren
id|scsi_cmd
op_eq
id|SCSICMD_Read10
)paren
)paren
(brace
id|addr
op_assign
id|sg_head-&gt;sg_list
(braket
id|sg_entry_cnt_minus_one
)braket
dot
id|addr
op_plus
id|sg_head-&gt;sg_list
(braket
id|sg_entry_cnt_minus_one
)braket
dot
id|bytes
suffix:semicolon
id|extra_bytes
op_assign
(paren
id|uchar
)paren
(paren
(paren
id|ushort
)paren
id|addr
op_amp
l_int|0x0003
)paren
suffix:semicolon
r_if
c_cond
(paren
id|extra_bytes
op_ne
l_int|0
)paren
(brace
id|scsiq-&gt;q2.tag_code
op_or_assign
id|ASC_TAG_FLAG_EXTRA_BYTES
suffix:semicolon
id|scsiq-&gt;q1.extra_bytes
op_assign
id|extra_bytes
suffix:semicolon
id|sg_head-&gt;sg_list
(braket
id|sg_entry_cnt_minus_one
)braket
dot
id|bytes
op_sub_assign
(paren
id|ulong
)paren
id|extra_bytes
suffix:semicolon
)brace
)brace
)brace
)brace
id|sg_head-&gt;entry_to_copy
op_assign
id|sg_head-&gt;entry_cnt
suffix:semicolon
id|n_q_required
op_assign
id|AscSgListToQueue
c_func
(paren
id|sg_entry_cnt
)paren
suffix:semicolon
macro_line|#if CC_LINK_BUSY_Q
id|scsiq_next
op_assign
(paren
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
id|asc_dvc-&gt;scsiq_busy_head
(braket
id|tid_no
)braket
suffix:semicolon
r_if
c_cond
(paren
id|scsiq_next
op_ne
(paren
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
l_int|0L
)paren
(brace
r_goto
id|link_scisq_to_busy_list
suffix:semicolon
)brace
macro_line|#endif
r_if
c_cond
(paren
(paren
id|AscGetNumOfFreeQueue
c_func
(paren
id|asc_dvc
comma
id|target_ix
comma
id|n_q_required
)paren
op_ge
(paren
id|uint
)paren
id|n_q_required
)paren
op_logical_or
(paren
(paren
id|scsiq-&gt;q1.cntl
op_amp
id|QC_URGENT
)paren
op_ne
l_int|0
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
id|sta
op_assign
id|AscSendScsiQueue
c_func
(paren
id|asc_dvc
comma
id|scsiq
comma
id|n_q_required
)paren
)paren
op_eq
l_int|1
)paren
(brace
id|asc_dvc-&gt;in_critical_cnt
op_decrement
suffix:semicolon
r_if
c_cond
(paren
id|asc_exe_callback
op_ne
l_int|0
)paren
(brace
(paren
op_star
id|asc_exe_callback
)paren
(paren
id|asc_dvc
comma
id|scsiq
)paren
suffix:semicolon
)brace
id|DvcLeaveCritical
c_func
(paren
id|last_int_level
)paren
suffix:semicolon
r_return
(paren
id|sta
)paren
suffix:semicolon
)brace
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|asc_dvc-&gt;bug_fix_cntl
)paren
(brace
r_if
c_cond
(paren
id|asc_dvc-&gt;bug_fix_cntl
op_amp
id|ASC_BUG_FIX_IF_NOT_DWB
)paren
(brace
r_if
c_cond
(paren
(paren
id|scsi_cmd
op_eq
id|SCSICMD_Read6
)paren
op_logical_or
(paren
id|scsi_cmd
op_eq
id|SCSICMD_Read10
)paren
)paren
(brace
id|addr
op_assign
id|scsiq-&gt;q1.data_addr
op_plus
id|scsiq-&gt;q1.data_cnt
suffix:semicolon
id|extra_bytes
op_assign
(paren
id|uchar
)paren
(paren
(paren
id|ushort
)paren
id|addr
op_amp
l_int|0x0003
)paren
suffix:semicolon
r_if
c_cond
(paren
id|extra_bytes
op_ne
l_int|0
)paren
(brace
r_if
c_cond
(paren
(paren
(paren
id|ushort
)paren
id|scsiq-&gt;q1.data_cnt
op_amp
l_int|0x01FF
)paren
op_eq
l_int|0
)paren
(brace
id|scsiq-&gt;q2.tag_code
op_or_assign
id|ASC_TAG_FLAG_EXTRA_BYTES
suffix:semicolon
id|scsiq-&gt;q1.data_cnt
op_sub_assign
(paren
id|ulong
)paren
id|extra_bytes
suffix:semicolon
id|scsiq-&gt;q1.extra_bytes
op_assign
id|extra_bytes
suffix:semicolon
)brace
)brace
)brace
)brace
)brace
id|n_q_required
op_assign
l_int|1
suffix:semicolon
macro_line|#if CC_LINK_BUSY_Q
id|scsiq_next
op_assign
(paren
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
id|asc_dvc-&gt;scsiq_busy_head
(braket
id|tid_no
)braket
suffix:semicolon
r_if
c_cond
(paren
id|scsiq_next
op_ne
(paren
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
l_int|0L
)paren
(brace
r_goto
id|link_scisq_to_busy_list
suffix:semicolon
)brace
macro_line|#endif
r_if
c_cond
(paren
(paren
id|AscGetNumOfFreeQueue
c_func
(paren
id|asc_dvc
comma
id|target_ix
comma
l_int|1
)paren
op_ge
l_int|1
)paren
op_logical_or
(paren
(paren
id|scsiq-&gt;q1.cntl
op_amp
id|QC_URGENT
)paren
op_ne
l_int|0
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
id|sta
op_assign
id|AscSendScsiQueue
c_func
(paren
id|asc_dvc
comma
id|scsiq
comma
id|n_q_required
)paren
)paren
op_eq
l_int|1
)paren
(brace
id|asc_dvc-&gt;in_critical_cnt
op_decrement
suffix:semicolon
r_if
c_cond
(paren
id|asc_exe_callback
op_ne
l_int|0
)paren
(brace
(paren
op_star
id|asc_exe_callback
)paren
(paren
id|asc_dvc
comma
id|scsiq
)paren
suffix:semicolon
)brace
id|DvcLeaveCritical
c_func
(paren
id|last_int_level
)paren
suffix:semicolon
r_return
(paren
id|sta
)paren
suffix:semicolon
)brace
)brace
)brace
macro_line|#if CC_LINK_BUSY_Q
r_if
c_cond
(paren
id|sta
op_eq
l_int|0
)paren
(brace
id|link_scisq_to_busy_list
suffix:colon
id|scsiq-&gt;ext.q_required
op_assign
id|n_q_required
suffix:semicolon
r_if
c_cond
(paren
id|scsiq_next
op_eq
(paren
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
l_int|0L
)paren
(brace
id|asc_dvc-&gt;scsiq_busy_head
(braket
id|tid_no
)braket
op_assign
(paren
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
id|scsiq
suffix:semicolon
id|asc_dvc-&gt;scsiq_busy_tail
(braket
id|tid_no
)braket
op_assign
(paren
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
id|scsiq
suffix:semicolon
id|scsiq-&gt;ext.next
op_assign
(paren
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
l_int|0L
suffix:semicolon
id|scsiq-&gt;ext.join
op_assign
(paren
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
l_int|0L
suffix:semicolon
id|scsiq-&gt;q1.status
op_assign
id|QS_BUSY
suffix:semicolon
id|sta
op_assign
l_int|1
suffix:semicolon
)brace
r_else
(brace
id|scsiq_tail
op_assign
(paren
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
id|asc_dvc-&gt;scsiq_busy_tail
(braket
id|tid_no
)braket
suffix:semicolon
r_if
c_cond
(paren
id|scsiq_tail-&gt;ext.next
op_eq
(paren
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
l_int|0L
)paren
(brace
r_if
c_cond
(paren
(paren
id|scsiq-&gt;q1.cntl
op_amp
id|QC_URGENT
)paren
op_ne
l_int|0
)paren
(brace
id|asc_dvc-&gt;scsiq_busy_head
(braket
id|tid_no
)braket
op_assign
(paren
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
id|scsiq
suffix:semicolon
id|scsiq-&gt;ext.next
op_assign
id|scsiq_next
suffix:semicolon
id|scsiq-&gt;ext.join
op_assign
(paren
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
l_int|0L
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|scsiq-&gt;ext.cntl
op_amp
id|QCX_SORT
)paren
(brace
r_do
(brace
id|scsiq_prev
op_assign
id|scsiq_next
suffix:semicolon
id|scsiq_next
op_assign
id|scsiq_next-&gt;ext.next
suffix:semicolon
r_if
c_cond
(paren
id|scsiq-&gt;ext.lba
OL
id|scsiq_prev-&gt;ext.lba
)paren
r_break
suffix:semicolon
)brace
r_while
c_loop
(paren
id|scsiq_next
op_ne
(paren
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
l_int|0L
)paren
suffix:semicolon
id|scsiq_prev-&gt;ext.next
op_assign
id|scsiq
suffix:semicolon
id|scsiq-&gt;ext.next
op_assign
id|scsiq_next
suffix:semicolon
r_if
c_cond
(paren
id|scsiq_next
op_eq
(paren
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
l_int|0L
)paren
(brace
id|asc_dvc-&gt;scsiq_busy_tail
(braket
id|tid_no
)braket
op_assign
(paren
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
id|scsiq
suffix:semicolon
)brace
id|scsiq-&gt;ext.join
op_assign
(paren
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
l_int|0L
suffix:semicolon
)brace
r_else
(brace
id|scsiq_tail-&gt;ext.next
op_assign
(paren
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
id|scsiq
suffix:semicolon
id|asc_dvc-&gt;scsiq_busy_tail
(braket
id|tid_no
)braket
op_assign
(paren
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
id|scsiq
suffix:semicolon
id|scsiq-&gt;ext.next
op_assign
(paren
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
l_int|0L
suffix:semicolon
id|scsiq-&gt;ext.join
op_assign
(paren
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
l_int|0L
suffix:semicolon
)brace
)brace
id|scsiq-&gt;q1.status
op_assign
id|QS_BUSY
suffix:semicolon
id|sta
op_assign
l_int|1
suffix:semicolon
)brace
r_else
(brace
id|AscSetLibErrorCode
c_func
(paren
id|asc_dvc
comma
id|ASCQ_ERR_SCSIQ_BAD_NEXT_PTR
)paren
suffix:semicolon
id|sta
op_assign
id|ERR
suffix:semicolon
)brace
)brace
)brace
macro_line|#endif
id|asc_dvc-&gt;in_critical_cnt
op_decrement
suffix:semicolon
id|DvcLeaveCritical
c_func
(paren
id|last_int_level
)paren
suffix:semicolon
r_return
(paren
id|sta
)paren
suffix:semicolon
)brace
r_int
DECL|function|AscSendScsiQueue
id|AscSendScsiQueue
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|REG
id|ASC_SCSI_Q
id|dosfar
op_star
id|scsiq
comma
id|uchar
id|n_q_required
)paren
(brace
id|PortAddr
id|iop_base
suffix:semicolon
id|uchar
id|free_q_head
suffix:semicolon
id|uchar
id|next_qp
suffix:semicolon
id|uchar
id|tid_no
suffix:semicolon
id|uchar
id|target_ix
suffix:semicolon
r_int
id|sta
suffix:semicolon
id|iop_base
op_assign
id|asc_dvc-&gt;iop_base
suffix:semicolon
id|target_ix
op_assign
id|scsiq-&gt;q2.target_ix
suffix:semicolon
id|tid_no
op_assign
id|ASC_TIX_TO_TID
c_func
(paren
id|target_ix
)paren
suffix:semicolon
id|sta
op_assign
l_int|0
suffix:semicolon
id|free_q_head
op_assign
(paren
id|uchar
)paren
id|AscGetVarFreeQHead
c_func
(paren
id|iop_base
)paren
suffix:semicolon
r_if
c_cond
(paren
id|n_q_required
OG
l_int|1
)paren
(brace
r_if
c_cond
(paren
(paren
id|next_qp
op_assign
id|AscAllocMultipleFreeQueue
c_func
(paren
id|iop_base
comma
id|free_q_head
comma
(paren
id|uchar
)paren
(paren
id|n_q_required
)paren
)paren
)paren
op_ne
(paren
id|uchar
)paren
id|ASC_QLINK_END
)paren
(brace
id|asc_dvc-&gt;last_q_shortage
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;sg_head-&gt;queue_cnt
op_assign
id|n_q_required
op_minus
l_int|1
suffix:semicolon
id|scsiq-&gt;q1.q_no
op_assign
id|free_q_head
suffix:semicolon
r_if
c_cond
(paren
(paren
id|sta
op_assign
id|AscPutReadySgListQueue
c_func
(paren
id|asc_dvc
comma
id|scsiq
comma
id|free_q_head
)paren
)paren
op_eq
l_int|1
)paren
(brace
macro_line|#if CC_WRITE_IO_COUNT
id|asc_dvc-&gt;req_count
op_increment
suffix:semicolon
macro_line|#endif
id|AscPutVarFreeQHead
c_func
(paren
id|iop_base
comma
id|next_qp
)paren
suffix:semicolon
id|asc_dvc-&gt;cur_total_qng
op_add_assign
(paren
id|uchar
)paren
(paren
id|n_q_required
)paren
suffix:semicolon
id|asc_dvc-&gt;cur_dvc_qng
(braket
id|tid_no
)braket
op_increment
suffix:semicolon
)brace
r_return
(paren
id|sta
)paren
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|n_q_required
op_eq
l_int|1
)paren
(brace
r_if
c_cond
(paren
(paren
id|next_qp
op_assign
id|AscAllocFreeQueue
c_func
(paren
id|iop_base
comma
id|free_q_head
)paren
)paren
op_ne
id|ASC_QLINK_END
)paren
(brace
id|scsiq-&gt;q1.q_no
op_assign
id|free_q_head
suffix:semicolon
r_if
c_cond
(paren
(paren
id|sta
op_assign
id|AscPutReadyQueue
c_func
(paren
id|asc_dvc
comma
id|scsiq
comma
id|free_q_head
)paren
)paren
op_eq
l_int|1
)paren
(brace
macro_line|#if CC_WRITE_IO_COUNT
id|asc_dvc-&gt;req_count
op_increment
suffix:semicolon
macro_line|#endif
id|AscPutVarFreeQHead
c_func
(paren
id|iop_base
comma
id|next_qp
)paren
suffix:semicolon
id|asc_dvc-&gt;cur_total_qng
op_increment
suffix:semicolon
id|asc_dvc-&gt;cur_dvc_qng
(braket
id|tid_no
)braket
op_increment
suffix:semicolon
)brace
r_return
(paren
id|sta
)paren
suffix:semicolon
)brace
)brace
r_return
(paren
id|sta
)paren
suffix:semicolon
)brace
r_int
DECL|function|AscSgListToQueue
id|AscSgListToQueue
c_func
(paren
r_int
id|sg_list
)paren
(brace
r_int
id|n_sg_list_qs
suffix:semicolon
id|n_sg_list_qs
op_assign
(paren
(paren
id|sg_list
op_minus
l_int|1
)paren
op_div
id|ASC_SG_LIST_PER_Q
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
id|sg_list
op_minus
l_int|1
)paren
op_mod
id|ASC_SG_LIST_PER_Q
)paren
op_ne
l_int|0
)paren
id|n_sg_list_qs
op_increment
suffix:semicolon
r_return
(paren
id|n_sg_list_qs
op_plus
l_int|1
)paren
suffix:semicolon
)brace
id|uint
DECL|function|AscGetNumOfFreeQueue
id|AscGetNumOfFreeQueue
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|uchar
id|target_ix
comma
id|uchar
id|n_qs
)paren
(brace
id|uint
id|cur_used_qs
suffix:semicolon
id|uint
id|cur_free_qs
suffix:semicolon
id|ASC_SCSI_BIT_ID_TYPE
id|target_id
suffix:semicolon
id|uchar
id|tid_no
suffix:semicolon
id|target_id
op_assign
id|ASC_TIX_TO_TARGET_ID
c_func
(paren
id|target_ix
)paren
suffix:semicolon
id|tid_no
op_assign
id|ASC_TIX_TO_TID
c_func
(paren
id|target_ix
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|asc_dvc-&gt;unit_not_ready
op_amp
id|target_id
)paren
op_logical_or
(paren
id|asc_dvc-&gt;queue_full_or_busy
op_amp
id|target_id
)paren
)paren
(brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|n_qs
op_eq
l_int|1
)paren
(brace
id|cur_used_qs
op_assign
(paren
id|uint
)paren
id|asc_dvc-&gt;cur_total_qng
op_plus
(paren
id|uint
)paren
id|asc_dvc-&gt;last_q_shortage
op_plus
(paren
id|uint
)paren
id|ASC_MIN_FREE_Q
suffix:semicolon
)brace
r_else
(brace
id|cur_used_qs
op_assign
(paren
id|uint
)paren
id|asc_dvc-&gt;cur_total_qng
op_plus
(paren
id|uint
)paren
id|ASC_MIN_FREE_Q
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|uint
)paren
(paren
id|cur_used_qs
op_plus
id|n_qs
)paren
op_le
(paren
id|uint
)paren
id|asc_dvc-&gt;max_total_qng
)paren
(brace
id|cur_free_qs
op_assign
(paren
id|uint
)paren
id|asc_dvc-&gt;max_total_qng
op_minus
id|cur_used_qs
suffix:semicolon
r_if
c_cond
(paren
id|asc_dvc-&gt;cur_dvc_qng
(braket
id|tid_no
)braket
op_ge
id|asc_dvc-&gt;max_dvc_qng
(braket
id|tid_no
)braket
)paren
(brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_return
(paren
id|cur_free_qs
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|n_qs
OG
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|n_qs
OG
id|asc_dvc-&gt;last_q_shortage
)paren
(brace
id|asc_dvc-&gt;last_q_shortage
op_assign
id|n_qs
suffix:semicolon
)brace
)brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_int
DECL|function|AscPutReadyQueue
id|AscPutReadyQueue
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|REG
id|ASC_SCSI_Q
id|dosfar
op_star
id|scsiq
comma
id|uchar
id|q_no
)paren
(brace
id|ushort
id|q_addr
suffix:semicolon
id|uchar
id|tid_no
suffix:semicolon
id|uchar
id|sdtr_data
suffix:semicolon
id|uchar
id|syn_period_ix
suffix:semicolon
id|uchar
id|syn_offset
suffix:semicolon
id|PortAddr
id|iop_base
suffix:semicolon
id|iop_base
op_assign
id|asc_dvc-&gt;iop_base
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
id|asc_dvc-&gt;init_sdtr
op_amp
id|scsiq-&gt;q1.target_id
)paren
op_ne
l_int|0
)paren
op_logical_and
(paren
(paren
id|asc_dvc-&gt;sdtr_done
op_amp
id|scsiq-&gt;q1.target_id
)paren
op_eq
l_int|0
)paren
)paren
(brace
id|tid_no
op_assign
id|ASC_TIX_TO_TID
c_func
(paren
id|scsiq-&gt;q2.target_ix
)paren
suffix:semicolon
id|sdtr_data
op_assign
id|AscGetMCodeInitSDTRAtID
c_func
(paren
id|iop_base
comma
id|tid_no
)paren
suffix:semicolon
id|syn_period_ix
op_assign
(paren
id|sdtr_data
op_rshift
l_int|4
)paren
op_amp
(paren
id|ASC_SYN_XFER_NO
op_minus
l_int|1
)paren
suffix:semicolon
id|syn_offset
op_assign
id|sdtr_data
op_amp
id|ASC_SYN_MAX_OFFSET
suffix:semicolon
id|AscMsgOutSDTR
c_func
(paren
id|asc_dvc
comma
id|asc_dvc-&gt;sdtr_period_tbl
(braket
id|syn_period_ix
)braket
comma
id|syn_offset
)paren
suffix:semicolon
id|scsiq-&gt;q1.cntl
op_or_assign
id|QC_MSG_OUT
suffix:semicolon
)brace
id|q_addr
op_assign
id|ASC_QNO_TO_QADDR
c_func
(paren
id|q_no
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|scsiq-&gt;q1.target_id
op_amp
id|asc_dvc-&gt;use_tagged_qng
)paren
op_eq
l_int|0
)paren
(brace
id|scsiq-&gt;q2.tag_code
op_and_assign
op_complement
id|M2_QTAG_MSG_SIMPLE
suffix:semicolon
)brace
id|scsiq-&gt;q1.status
op_assign
id|QS_FREE
suffix:semicolon
id|AscMemWordCopyToLram
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_CDB_BEG
)paren
comma
(paren
id|ushort
id|dosfar
op_star
)paren
id|scsiq-&gt;cdbptr
comma
(paren
id|ushort
)paren
(paren
(paren
id|ushort
)paren
id|scsiq-&gt;q2.cdb_len
op_rshift
l_int|1
)paren
)paren
suffix:semicolon
macro_line|#if !CC_LITTLE_ENDIAN_HOST
id|AscAdjEndianScsiQ
c_func
(paren
id|scsiq
)paren
suffix:semicolon
macro_line|#endif
id|DvcPutScsiQ
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_CPY_BEG
)paren
comma
(paren
id|ushort
id|dosfar
op_star
)paren
op_amp
id|scsiq-&gt;q1.cntl
comma
(paren
id|ushort
)paren
(paren
(paren
(paren
(paren
r_sizeof
(paren
id|ASC_SCSIQ_1
)paren
op_plus
r_sizeof
(paren
id|ASC_SCSIQ_2
)paren
)paren
op_div
l_int|2
)paren
op_minus
l_int|1
)paren
)paren
)paren
suffix:semicolon
macro_line|#if CC_WRITE_IO_COUNT
id|AscWriteLramWord
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_W_REQ_COUNT
)paren
comma
(paren
id|ushort
)paren
id|asc_dvc-&gt;req_count
)paren
suffix:semicolon
macro_line|#endif
macro_line|#if CC_VERIFY_LRAM_COPY
r_if
c_cond
(paren
(paren
id|asc_dvc-&gt;dvc_cntl
op_amp
id|ASC_CNTL_NO_VERIFY_COPY
)paren
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|AscMemWordCmpToLram
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_CDB_BEG
)paren
comma
(paren
id|ushort
id|dosfar
op_star
)paren
id|scsiq-&gt;cdbptr
comma
(paren
id|ushort
)paren
(paren
id|scsiq-&gt;q2.cdb_len
op_rshift
l_int|1
)paren
)paren
op_ne
l_int|0
)paren
(brace
id|AscSetLibErrorCode
c_func
(paren
id|asc_dvc
comma
id|ASCQ_ERR_LOCAL_MEM
)paren
suffix:semicolon
r_return
(paren
id|ERR
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|AscMemWordCmpToLram
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_CPY_BEG
)paren
comma
(paren
id|ushort
id|dosfar
op_star
)paren
op_amp
id|scsiq-&gt;q1.cntl
comma
(paren
id|ushort
)paren
(paren
(paren
(paren
r_sizeof
(paren
id|ASC_SCSIQ_1
)paren
op_plus
r_sizeof
(paren
id|ASC_SCSIQ_2
)paren
)paren
op_div
l_int|2
)paren
op_minus
l_int|1
)paren
)paren
op_ne
l_int|0
)paren
(brace
id|AscSetLibErrorCode
c_func
(paren
id|asc_dvc
comma
id|ASCQ_ERR_LOCAL_MEM
)paren
suffix:semicolon
r_return
(paren
id|ERR
)paren
suffix:semicolon
)brace
)brace
macro_line|#endif
macro_line|#if CC_CLEAR_DMA_REMAIN
id|AscWriteLramDWord
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_DW_REMAIN_XFER_ADDR
)paren
comma
l_int|0UL
)paren
suffix:semicolon
id|AscWriteLramDWord
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_DW_REMAIN_XFER_CNT
)paren
comma
l_int|0UL
)paren
suffix:semicolon
macro_line|#endif
id|AscWriteLramWord
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_B_STATUS
)paren
comma
(paren
id|ushort
)paren
(paren
(paren
(paren
id|ushort
)paren
id|scsiq-&gt;q1.q_no
op_lshift
l_int|8
)paren
op_or
(paren
id|ushort
)paren
id|QS_READY
)paren
)paren
suffix:semicolon
r_return
(paren
l_int|1
)paren
suffix:semicolon
)brace
r_int
DECL|function|AscPutReadySgListQueue
id|AscPutReadySgListQueue
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|REG
id|ASC_SCSI_Q
id|dosfar
op_star
id|scsiq
comma
id|uchar
id|q_no
)paren
(brace
r_int
id|sta
suffix:semicolon
r_int
id|i
suffix:semicolon
id|ASC_SG_HEAD
id|dosfar
op_star
id|sg_head
suffix:semicolon
id|ASC_SG_LIST_Q
id|scsi_sg_q
suffix:semicolon
id|ulong
id|saved_data_addr
suffix:semicolon
id|ulong
id|saved_data_cnt
suffix:semicolon
id|PortAddr
id|iop_base
suffix:semicolon
id|ushort
id|sg_list_dwords
suffix:semicolon
id|ushort
id|sg_index
suffix:semicolon
id|ushort
id|sg_entry_cnt
suffix:semicolon
id|ushort
id|q_addr
suffix:semicolon
id|uchar
id|next_qp
suffix:semicolon
id|iop_base
op_assign
id|asc_dvc-&gt;iop_base
suffix:semicolon
id|sg_head
op_assign
id|scsiq-&gt;sg_head
suffix:semicolon
id|saved_data_addr
op_assign
id|scsiq-&gt;q1.data_addr
suffix:semicolon
id|saved_data_cnt
op_assign
id|scsiq-&gt;q1.data_cnt
suffix:semicolon
id|scsiq-&gt;q1.data_addr
op_assign
id|sg_head-&gt;sg_list
(braket
l_int|0
)braket
dot
id|addr
suffix:semicolon
id|scsiq-&gt;q1.data_cnt
op_assign
id|sg_head-&gt;sg_list
(braket
l_int|0
)braket
dot
id|bytes
suffix:semicolon
id|sg_entry_cnt
op_assign
id|sg_head-&gt;entry_cnt
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|sg_entry_cnt
op_ne
l_int|0
)paren
(brace
id|scsiq-&gt;q1.cntl
op_or_assign
id|QC_SG_HEAD
suffix:semicolon
id|q_addr
op_assign
id|ASC_QNO_TO_QADDR
c_func
(paren
id|q_no
)paren
suffix:semicolon
id|sg_index
op_assign
l_int|1
suffix:semicolon
id|scsiq-&gt;q1.sg_queue_cnt
op_assign
id|sg_head-&gt;queue_cnt
suffix:semicolon
id|scsi_sg_q.sg_head_qp
op_assign
id|q_no
suffix:semicolon
id|scsi_sg_q.cntl
op_assign
id|QCSG_SG_XFER_LIST
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|sg_head-&gt;queue_cnt
suffix:semicolon
id|i
op_increment
)paren
(brace
id|scsi_sg_q.seq_no
op_assign
id|i
op_plus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|sg_entry_cnt
OG
id|ASC_SG_LIST_PER_Q
)paren
(brace
id|sg_list_dwords
op_assign
(paren
id|uchar
)paren
(paren
id|ASC_SG_LIST_PER_Q
op_star
l_int|2
)paren
suffix:semicolon
id|sg_entry_cnt
op_sub_assign
id|ASC_SG_LIST_PER_Q
suffix:semicolon
r_if
c_cond
(paren
id|i
op_eq
l_int|0
)paren
(brace
id|scsi_sg_q.sg_list_cnt
op_assign
id|ASC_SG_LIST_PER_Q
suffix:semicolon
id|scsi_sg_q.sg_cur_list_cnt
op_assign
id|ASC_SG_LIST_PER_Q
suffix:semicolon
)brace
r_else
(brace
id|scsi_sg_q.sg_list_cnt
op_assign
id|ASC_SG_LIST_PER_Q
op_minus
l_int|1
suffix:semicolon
id|scsi_sg_q.sg_cur_list_cnt
op_assign
id|ASC_SG_LIST_PER_Q
op_minus
l_int|1
suffix:semicolon
)brace
)brace
r_else
(brace
id|scsi_sg_q.cntl
op_or_assign
id|QCSG_SG_XFER_END
suffix:semicolon
id|sg_list_dwords
op_assign
id|sg_entry_cnt
op_lshift
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|i
op_eq
l_int|0
)paren
(brace
id|scsi_sg_q.sg_list_cnt
op_assign
id|sg_entry_cnt
suffix:semicolon
id|scsi_sg_q.sg_cur_list_cnt
op_assign
id|sg_entry_cnt
suffix:semicolon
)brace
r_else
(brace
id|scsi_sg_q.sg_list_cnt
op_assign
id|sg_entry_cnt
op_minus
l_int|1
suffix:semicolon
id|scsi_sg_q.sg_cur_list_cnt
op_assign
id|sg_entry_cnt
op_minus
l_int|1
suffix:semicolon
)brace
id|sg_entry_cnt
op_assign
l_int|0
suffix:semicolon
)brace
id|next_qp
op_assign
id|AscReadLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|q_addr
op_plus
id|ASC_SCSIQ_B_FWD
)paren
)paren
suffix:semicolon
id|scsi_sg_q.q_no
op_assign
id|next_qp
suffix:semicolon
id|q_addr
op_assign
id|ASC_QNO_TO_QADDR
c_func
(paren
id|next_qp
)paren
suffix:semicolon
id|AscMemWordCopyToLram
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|q_addr
op_plus
id|ASC_SCSIQ_SGHD_CPY_BEG
)paren
comma
(paren
id|ushort
id|dosfar
op_star
)paren
op_amp
id|scsi_sg_q
comma
(paren
id|ushort
)paren
(paren
r_sizeof
(paren
id|ASC_SG_LIST_Q
)paren
op_rshift
l_int|1
)paren
)paren
suffix:semicolon
id|AscMemDWordCopyToLram
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|q_addr
op_plus
id|ASC_SGQ_LIST_BEG
)paren
comma
(paren
id|ulong
id|dosfar
op_star
)paren
op_amp
id|sg_head-&gt;sg_list
(braket
id|sg_index
)braket
comma
(paren
id|ushort
)paren
id|sg_list_dwords
)paren
suffix:semicolon
id|sg_index
op_add_assign
id|ASC_SG_LIST_PER_Q
suffix:semicolon
)brace
)brace
r_else
(brace
id|scsiq-&gt;q1.cntl
op_and_assign
op_complement
id|QC_SG_HEAD
suffix:semicolon
)brace
id|sta
op_assign
id|AscPutReadyQueue
c_func
(paren
id|asc_dvc
comma
id|scsiq
comma
id|q_no
)paren
suffix:semicolon
id|scsiq-&gt;q1.data_addr
op_assign
id|saved_data_addr
suffix:semicolon
id|scsiq-&gt;q1.data_cnt
op_assign
id|saved_data_cnt
suffix:semicolon
r_return
(paren
id|sta
)paren
suffix:semicolon
)brace
r_int
DECL|function|AscAbortSRB
id|AscAbortSRB
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|ulong
id|srb_ptr
)paren
(brace
r_int
id|sta
suffix:semicolon
id|ASC_SCSI_BIT_ID_TYPE
id|saved_unit_not_ready
suffix:semicolon
id|PortAddr
id|iop_base
suffix:semicolon
id|iop_base
op_assign
id|asc_dvc-&gt;iop_base
suffix:semicolon
id|sta
op_assign
id|ERR
suffix:semicolon
id|saved_unit_not_ready
op_assign
id|asc_dvc-&gt;unit_not_ready
suffix:semicolon
id|asc_dvc-&gt;unit_not_ready
op_assign
l_int|0xFF
suffix:semicolon
id|AscWaitISRDone
c_func
(paren
id|asc_dvc
)paren
suffix:semicolon
r_if
c_cond
(paren
id|AscStopQueueExe
c_func
(paren
id|iop_base
)paren
op_eq
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|AscRiscHaltedAbortSRB
c_func
(paren
id|asc_dvc
comma
id|srb_ptr
)paren
op_eq
l_int|1
)paren
(brace
id|sta
op_assign
l_int|1
suffix:semicolon
id|AscCleanUpBusyQueue
c_func
(paren
id|iop_base
)paren
suffix:semicolon
id|AscStartQueueExe
c_func
(paren
id|iop_base
)paren
suffix:semicolon
)brace
r_else
(brace
id|sta
op_assign
l_int|0
suffix:semicolon
id|AscStartQueueExe
c_func
(paren
id|iop_base
)paren
suffix:semicolon
)brace
)brace
id|asc_dvc-&gt;unit_not_ready
op_assign
id|saved_unit_not_ready
suffix:semicolon
r_return
(paren
id|sta
)paren
suffix:semicolon
)brace
r_int
DECL|function|AscResetDevice
id|AscResetDevice
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|uchar
id|target_ix
)paren
(brace
id|PortAddr
id|iop_base
suffix:semicolon
r_int
id|sta
suffix:semicolon
id|uchar
id|tid_no
suffix:semicolon
id|ASC_SCSI_BIT_ID_TYPE
id|target_id
suffix:semicolon
r_int
id|i
suffix:semicolon
id|ASC_SCSI_REQ_Q
id|scsiq_buf
suffix:semicolon
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
id|scsiq
suffix:semicolon
id|uchar
id|dosfar
op_star
id|buf
suffix:semicolon
id|ASC_SCSI_BIT_ID_TYPE
id|saved_unit_not_ready
suffix:semicolon
id|iop_base
op_assign
id|asc_dvc-&gt;iop_base
suffix:semicolon
id|tid_no
op_assign
id|ASC_TIX_TO_TID
c_func
(paren
id|target_ix
)paren
suffix:semicolon
id|target_id
op_assign
id|ASC_TID_TO_TARGET_ID
c_func
(paren
id|tid_no
)paren
suffix:semicolon
id|saved_unit_not_ready
op_assign
id|asc_dvc-&gt;unit_not_ready
suffix:semicolon
id|asc_dvc-&gt;unit_not_ready
op_assign
id|target_id
suffix:semicolon
id|sta
op_assign
id|ERR
suffix:semicolon
id|AscWaitTixISRDone
c_func
(paren
id|asc_dvc
comma
id|target_ix
)paren
suffix:semicolon
r_if
c_cond
(paren
id|AscStopQueueExe
c_func
(paren
id|iop_base
)paren
op_eq
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|AscRiscHaltedAbortTIX
c_func
(paren
id|asc_dvc
comma
id|target_ix
)paren
op_eq
l_int|1
)paren
(brace
id|AscCleanUpBusyQueue
c_func
(paren
id|iop_base
)paren
suffix:semicolon
id|AscStartQueueExe
c_func
(paren
id|iop_base
)paren
suffix:semicolon
id|AscWaitTixISRDone
c_func
(paren
id|asc_dvc
comma
id|target_ix
)paren
suffix:semicolon
id|sta
op_assign
id|TRUE
suffix:semicolon
id|scsiq
op_assign
(paren
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
)paren
op_amp
id|scsiq_buf
suffix:semicolon
id|buf
op_assign
(paren
id|uchar
id|dosfar
op_star
)paren
op_amp
id|scsiq_buf
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
r_sizeof
(paren
id|ASC_SCSI_REQ_Q
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
op_star
id|buf
op_increment
op_assign
l_int|0x00
suffix:semicolon
)brace
id|scsiq-&gt;r1.status
op_assign
(paren
id|uchar
)paren
id|QS_READY
suffix:semicolon
id|scsiq-&gt;r2.cdb_len
op_assign
l_int|6
suffix:semicolon
id|scsiq-&gt;r2.tag_code
op_assign
id|M2_QTAG_MSG_SIMPLE
suffix:semicolon
id|scsiq-&gt;r1.target_id
op_assign
id|target_id
suffix:semicolon
id|scsiq-&gt;r2.target_ix
op_assign
id|ASC_TIDLUN_TO_IX
c_func
(paren
id|tid_no
comma
l_int|0
)paren
suffix:semicolon
id|scsiq-&gt;cdbptr
op_assign
(paren
id|uchar
id|dosfar
op_star
)paren
id|scsiq-&gt;cdb
suffix:semicolon
id|scsiq-&gt;r1.cntl
op_assign
id|QC_NO_CALLBACK
op_or
id|QC_MSG_OUT
op_or
id|QC_URGENT
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|asc_dvc-&gt;iop_base
comma
id|ASCV_MSGOUT_BEG
comma
id|M1_BUS_DVC_RESET
)paren
suffix:semicolon
id|asc_dvc-&gt;unit_not_ready
op_and_assign
op_complement
id|target_id
suffix:semicolon
id|asc_dvc-&gt;sdtr_done
op_or_assign
id|target_id
suffix:semicolon
r_if
c_cond
(paren
id|AscExeScsiQueue
c_func
(paren
id|asc_dvc
comma
(paren
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
id|scsiq
)paren
op_eq
l_int|1
)paren
(brace
id|asc_dvc-&gt;unit_not_ready
op_assign
id|target_id
suffix:semicolon
id|DvcSleepMilliSecond
c_func
(paren
l_int|1000
)paren
suffix:semicolon
id|_AscWaitQDone
c_func
(paren
id|iop_base
comma
(paren
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
id|scsiq
)paren
suffix:semicolon
r_if
c_cond
(paren
id|AscStopQueueExe
c_func
(paren
id|iop_base
)paren
op_eq
l_int|1
)paren
(brace
id|AscCleanUpDiscQueue
c_func
(paren
id|iop_base
)paren
suffix:semicolon
id|AscStartQueueExe
c_func
(paren
id|iop_base
)paren
suffix:semicolon
r_if
c_cond
(paren
id|asc_dvc-&gt;pci_fix_asyn_xfer
op_amp
id|target_id
)paren
(brace
id|AscSetRunChipSynRegAtID
c_func
(paren
id|iop_base
comma
id|tid_no
comma
id|ASYN_SDTR_DATA_FIX_PCI_REV_AB
)paren
suffix:semicolon
)brace
id|AscWaitTixISRDone
c_func
(paren
id|asc_dvc
comma
id|target_ix
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
id|sta
op_assign
l_int|0
suffix:semicolon
)brace
id|asc_dvc-&gt;sdtr_done
op_and_assign
op_complement
id|target_id
suffix:semicolon
)brace
r_else
(brace
id|sta
op_assign
id|ERR
suffix:semicolon
id|AscStartQueueExe
c_func
(paren
id|iop_base
)paren
suffix:semicolon
)brace
)brace
id|asc_dvc-&gt;unit_not_ready
op_assign
id|saved_unit_not_ready
suffix:semicolon
r_return
(paren
id|sta
)paren
suffix:semicolon
)brace
r_int
DECL|function|AscResetSB
id|AscResetSB
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
)paren
(brace
r_int
id|sta
suffix:semicolon
r_int
id|i
suffix:semicolon
id|PortAddr
id|iop_base
suffix:semicolon
id|iop_base
op_assign
id|asc_dvc-&gt;iop_base
suffix:semicolon
id|asc_dvc-&gt;unit_not_ready
op_assign
l_int|0xFF
suffix:semicolon
id|sta
op_assign
id|TRUE
suffix:semicolon
id|AscWaitISRDone
c_func
(paren
id|asc_dvc
)paren
suffix:semicolon
id|AscStopQueueExe
c_func
(paren
id|iop_base
)paren
suffix:semicolon
id|asc_dvc-&gt;sdtr_done
op_assign
l_int|0
suffix:semicolon
id|AscResetChipAndScsiBus
c_func
(paren
id|iop_base
)paren
suffix:semicolon
id|DvcSleepMilliSecond
c_func
(paren
(paren
id|ulong
)paren
(paren
(paren
id|ushort
)paren
id|asc_dvc-&gt;scsi_reset_wait
op_star
l_int|1000
)paren
)paren
suffix:semicolon
id|AscReInitLram
c_func
(paren
id|asc_dvc
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
id|ASC_MAX_TID
suffix:semicolon
id|i
op_increment
)paren
(brace
id|asc_dvc-&gt;cur_dvc_qng
(braket
id|i
)braket
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|asc_dvc-&gt;pci_fix_asyn_xfer
op_amp
(paren
id|ASC_SCSI_BIT_ID_TYPE
)paren
(paren
l_int|0x01
op_lshift
id|i
)paren
)paren
(brace
id|AscSetChipSynRegAtID
c_func
(paren
id|iop_base
comma
id|i
comma
id|ASYN_SDTR_DATA_FIX_PCI_REV_AB
)paren
suffix:semicolon
)brace
)brace
id|asc_dvc-&gt;err_code
op_assign
l_int|0
suffix:semicolon
id|AscSetPCAddr
c_func
(paren
id|iop_base
comma
id|ASC_MCODE_START_ADDR
)paren
suffix:semicolon
r_if
c_cond
(paren
id|AscGetPCAddr
c_func
(paren
id|iop_base
)paren
op_ne
id|ASC_MCODE_START_ADDR
)paren
(brace
id|sta
op_assign
id|ERR
suffix:semicolon
)brace
r_if
c_cond
(paren
id|AscStartChip
c_func
(paren
id|iop_base
)paren
op_eq
l_int|0
)paren
(brace
id|sta
op_assign
id|ERR
suffix:semicolon
)brace
id|AscStartQueueExe
c_func
(paren
id|iop_base
)paren
suffix:semicolon
id|asc_dvc-&gt;unit_not_ready
op_assign
l_int|0
suffix:semicolon
id|asc_dvc-&gt;queue_full_or_busy
op_assign
l_int|0
suffix:semicolon
r_return
(paren
id|sta
)paren
suffix:semicolon
)brace
r_int
DECL|function|AscSetRunChipSynRegAtID
id|AscSetRunChipSynRegAtID
c_func
(paren
id|PortAddr
id|iop_base
comma
id|uchar
id|tid_no
comma
id|uchar
id|sdtr_data
)paren
(brace
r_int
id|sta
op_assign
id|FALSE
suffix:semicolon
r_if
c_cond
(paren
id|AscHostReqRiscHalt
c_func
(paren
id|iop_base
)paren
)paren
(brace
id|sta
op_assign
id|AscSetChipSynRegAtID
c_func
(paren
id|iop_base
comma
id|tid_no
comma
id|sdtr_data
)paren
suffix:semicolon
id|AscStartChip
c_func
(paren
id|iop_base
)paren
suffix:semicolon
r_return
(paren
id|sta
)paren
suffix:semicolon
)brace
r_return
(paren
id|sta
)paren
suffix:semicolon
)brace
r_int
DECL|function|AscSetChipSynRegAtID
id|AscSetChipSynRegAtID
c_func
(paren
id|PortAddr
id|iop_base
comma
id|uchar
id|id
comma
id|uchar
id|sdtr_data
)paren
(brace
id|ASC_SCSI_BIT_ID_TYPE
id|org_id
suffix:semicolon
r_int
id|i
suffix:semicolon
r_int
id|sta
suffix:semicolon
id|sta
op_assign
id|TRUE
suffix:semicolon
id|AscSetBank
c_func
(paren
id|iop_base
comma
l_int|1
)paren
suffix:semicolon
id|org_id
op_assign
id|AscReadChipDvcID
c_func
(paren
id|iop_base
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
id|ASC_MAX_TID
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|org_id
op_eq
(paren
l_int|0x01
op_lshift
id|i
)paren
)paren
r_break
suffix:semicolon
)brace
id|org_id
op_assign
id|i
suffix:semicolon
id|AscWriteChipDvcID
c_func
(paren
id|iop_base
comma
id|id
)paren
suffix:semicolon
r_if
c_cond
(paren
id|AscReadChipDvcID
c_func
(paren
id|iop_base
)paren
op_eq
(paren
l_int|0x01
op_lshift
id|id
)paren
)paren
(brace
id|AscSetBank
c_func
(paren
id|iop_base
comma
l_int|0
)paren
suffix:semicolon
id|AscSetChipSyn
c_func
(paren
id|iop_base
comma
id|sdtr_data
)paren
suffix:semicolon
r_if
c_cond
(paren
id|AscGetChipSyn
c_func
(paren
id|iop_base
)paren
op_ne
id|sdtr_data
)paren
(brace
id|sta
op_assign
id|FALSE
suffix:semicolon
)brace
)brace
r_else
(brace
id|sta
op_assign
id|FALSE
suffix:semicolon
)brace
id|AscSetBank
c_func
(paren
id|iop_base
comma
l_int|1
)paren
suffix:semicolon
id|AscWriteChipDvcID
c_func
(paren
id|iop_base
comma
id|org_id
)paren
suffix:semicolon
id|AscSetBank
c_func
(paren
id|iop_base
comma
l_int|0
)paren
suffix:semicolon
r_return
(paren
id|sta
)paren
suffix:semicolon
)brace
r_int
DECL|function|AscReInitLram
id|AscReInitLram
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
)paren
(brace
id|AscInitLram
c_func
(paren
id|asc_dvc
)paren
suffix:semicolon
id|AscInitQLinkVar
c_func
(paren
id|asc_dvc
)paren
suffix:semicolon
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
id|ushort
DECL|function|AscInitLram
id|AscInitLram
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
)paren
(brace
id|uchar
id|i
suffix:semicolon
id|ushort
id|s_addr
suffix:semicolon
id|PortAddr
id|iop_base
suffix:semicolon
id|ushort
id|warn_code
suffix:semicolon
id|iop_base
op_assign
id|asc_dvc-&gt;iop_base
suffix:semicolon
id|warn_code
op_assign
l_int|0
suffix:semicolon
id|AscMemWordSetLram
c_func
(paren
id|iop_base
comma
id|ASC_QADR_BEG
comma
l_int|0
comma
(paren
id|ushort
)paren
(paren
(paren
(paren
r_int
)paren
(paren
id|asc_dvc-&gt;max_total_qng
op_plus
l_int|2
op_plus
l_int|1
)paren
op_star
l_int|64
)paren
op_rshift
l_int|1
)paren
)paren
suffix:semicolon
id|i
op_assign
id|ASC_MIN_ACTIVE_QNO
suffix:semicolon
id|s_addr
op_assign
id|ASC_QADR_BEG
op_plus
id|ASC_QBLK_SIZE
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|s_addr
op_plus
id|ASC_SCSIQ_B_FWD
)paren
comma
(paren
id|uchar
)paren
(paren
id|i
op_plus
l_int|1
)paren
)paren
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|s_addr
op_plus
id|ASC_SCSIQ_B_BWD
)paren
comma
(paren
id|uchar
)paren
(paren
id|asc_dvc-&gt;max_total_qng
)paren
)paren
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|s_addr
op_plus
id|ASC_SCSIQ_B_QNO
)paren
comma
(paren
id|uchar
)paren
id|i
)paren
suffix:semicolon
id|i
op_increment
suffix:semicolon
id|s_addr
op_add_assign
id|ASC_QBLK_SIZE
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
id|i
OL
id|asc_dvc-&gt;max_total_qng
suffix:semicolon
id|i
op_increment
comma
id|s_addr
op_add_assign
id|ASC_QBLK_SIZE
)paren
(brace
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|s_addr
op_plus
id|ASC_SCSIQ_B_FWD
)paren
comma
(paren
id|uchar
)paren
(paren
id|i
op_plus
l_int|1
)paren
)paren
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|s_addr
op_plus
id|ASC_SCSIQ_B_BWD
)paren
comma
(paren
id|uchar
)paren
(paren
id|i
op_minus
l_int|1
)paren
)paren
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|s_addr
op_plus
id|ASC_SCSIQ_B_QNO
)paren
comma
(paren
id|uchar
)paren
id|i
)paren
suffix:semicolon
)brace
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|s_addr
op_plus
id|ASC_SCSIQ_B_FWD
)paren
comma
(paren
id|uchar
)paren
id|ASC_QLINK_END
)paren
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|s_addr
op_plus
id|ASC_SCSIQ_B_BWD
)paren
comma
(paren
id|uchar
)paren
(paren
id|asc_dvc-&gt;max_total_qng
op_minus
l_int|1
)paren
)paren
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|s_addr
op_plus
id|ASC_SCSIQ_B_QNO
)paren
comma
(paren
id|uchar
)paren
id|asc_dvc-&gt;max_total_qng
)paren
suffix:semicolon
id|i
op_increment
suffix:semicolon
id|s_addr
op_add_assign
id|ASC_QBLK_SIZE
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
id|i
op_le
(paren
id|uchar
)paren
(paren
id|asc_dvc-&gt;max_total_qng
op_plus
l_int|3
)paren
suffix:semicolon
id|i
op_increment
comma
id|s_addr
op_add_assign
id|ASC_QBLK_SIZE
)paren
(brace
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|s_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_B_FWD
)paren
comma
id|i
)paren
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|s_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_B_BWD
)paren
comma
id|i
)paren
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|s_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_B_QNO
)paren
comma
id|i
)paren
suffix:semicolon
)brace
r_return
(paren
id|warn_code
)paren
suffix:semicolon
)brace
id|ushort
DECL|function|AscInitQLinkVar
id|AscInitQLinkVar
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
)paren
(brace
id|PortAddr
id|iop_base
suffix:semicolon
r_int
id|i
suffix:semicolon
id|ushort
id|lram_addr
suffix:semicolon
id|iop_base
op_assign
id|asc_dvc-&gt;iop_base
suffix:semicolon
id|AscPutRiscVarFreeQHead
c_func
(paren
id|iop_base
comma
l_int|1
)paren
suffix:semicolon
id|AscPutRiscVarDoneQTail
c_func
(paren
id|iop_base
comma
id|asc_dvc-&gt;max_total_qng
)paren
suffix:semicolon
id|AscPutVarFreeQHead
c_func
(paren
id|iop_base
comma
l_int|1
)paren
suffix:semicolon
id|AscPutVarDoneQTail
c_func
(paren
id|iop_base
comma
id|asc_dvc-&gt;max_total_qng
)paren
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
id|ASCV_BUSY_QHEAD_B
comma
(paren
id|uchar
)paren
(paren
(paren
r_int
)paren
id|asc_dvc-&gt;max_total_qng
op_plus
l_int|1
)paren
)paren
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
id|ASCV_DISC1_QHEAD_B
comma
(paren
id|uchar
)paren
(paren
(paren
r_int
)paren
id|asc_dvc-&gt;max_total_qng
op_plus
l_int|2
)paren
)paren
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
id|ASCV_TOTAL_READY_Q_B
comma
id|asc_dvc-&gt;max_total_qng
)paren
suffix:semicolon
id|AscWriteLramWord
c_func
(paren
id|iop_base
comma
id|ASCV_ASCDVC_ERR_CODE_W
comma
l_int|0
)paren
suffix:semicolon
id|AscWriteLramWord
c_func
(paren
id|iop_base
comma
id|ASCV_HALTCODE_W
comma
l_int|0
)paren
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
id|ASCV_STOP_CODE_B
comma
l_int|0
)paren
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
id|ASCV_SCSIBUSY_B
comma
l_int|0
)paren
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
id|ASCV_WTM_FLAG_B
comma
l_int|0
)paren
suffix:semicolon
id|AscPutQDoneInProgress
c_func
(paren
id|iop_base
comma
l_int|0
)paren
suffix:semicolon
id|lram_addr
op_assign
id|ASC_QADR_BEG
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|32
suffix:semicolon
id|i
op_increment
comma
id|lram_addr
op_add_assign
l_int|2
)paren
(brace
id|AscWriteLramWord
c_func
(paren
id|iop_base
comma
id|lram_addr
comma
l_int|0
)paren
suffix:semicolon
)brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_int
DECL|function|AscSetLibErrorCode
id|AscSetLibErrorCode
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|ushort
id|err_code
)paren
(brace
r_if
c_cond
(paren
id|asc_dvc-&gt;err_code
op_eq
l_int|0
)paren
(brace
id|asc_dvc-&gt;err_code
op_assign
id|err_code
suffix:semicolon
id|AscWriteLramWord
c_func
(paren
id|asc_dvc-&gt;iop_base
comma
id|ASCV_ASCDVC_ERR_CODE_W
comma
id|err_code
)paren
suffix:semicolon
)brace
r_return
(paren
id|err_code
)paren
suffix:semicolon
)brace
r_int
DECL|function|_AscWaitQDone
id|_AscWaitQDone
c_func
(paren
id|PortAddr
id|iop_base
comma
id|REG
id|ASC_SCSI_Q
id|dosfar
op_star
id|scsiq
)paren
(brace
id|ushort
id|q_addr
suffix:semicolon
id|uchar
id|q_status
suffix:semicolon
r_int
id|count
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|scsiq-&gt;q1.q_no
op_eq
l_int|0
)paren
suffix:semicolon
id|q_addr
op_assign
id|ASC_QNO_TO_QADDR
c_func
(paren
id|scsiq-&gt;q1.q_no
)paren
suffix:semicolon
r_do
(brace
id|q_status
op_assign
id|AscReadLramByte
c_func
(paren
id|iop_base
comma
id|q_addr
op_plus
id|ASC_SCSIQ_B_STATUS
)paren
suffix:semicolon
id|DvcSleepMilliSecond
c_func
(paren
l_int|100L
)paren
suffix:semicolon
r_if
c_cond
(paren
id|count
op_increment
OG
l_int|30
)paren
(brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
)brace
r_while
c_loop
(paren
(paren
id|q_status
op_amp
id|QS_READY
)paren
op_ne
l_int|0
)paren
suffix:semicolon
r_return
(paren
l_int|1
)paren
suffix:semicolon
)brace
id|uchar
DECL|function|AscMsgOutSDTR
id|AscMsgOutSDTR
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|uchar
id|sdtr_period
comma
id|uchar
id|sdtr_offset
)paren
(brace
id|SDTR_XMSG
id|sdtr_buf
suffix:semicolon
id|uchar
id|sdtr_period_index
suffix:semicolon
id|PortAddr
id|iop_base
suffix:semicolon
id|iop_base
op_assign
id|asc_dvc-&gt;iop_base
suffix:semicolon
id|sdtr_buf.msg_type
op_assign
id|MS_EXTEND
suffix:semicolon
id|sdtr_buf.msg_len
op_assign
id|MS_SDTR_LEN
suffix:semicolon
id|sdtr_buf.msg_req
op_assign
id|MS_SDTR_CODE
suffix:semicolon
id|sdtr_buf.xfer_period
op_assign
id|sdtr_period
suffix:semicolon
id|sdtr_offset
op_and_assign
id|ASC_SYN_MAX_OFFSET
suffix:semicolon
id|sdtr_buf.req_ack_offset
op_assign
id|sdtr_offset
suffix:semicolon
r_if
c_cond
(paren
(paren
id|sdtr_period_index
op_assign
id|AscGetSynPeriodIndex
c_func
(paren
id|asc_dvc
comma
id|sdtr_period
)paren
)paren
op_le
id|asc_dvc-&gt;max_sdtr_index
)paren
(brace
id|AscMemWordCopyToLram
c_func
(paren
id|iop_base
comma
id|ASCV_MSGOUT_BEG
comma
(paren
id|ushort
id|dosfar
op_star
)paren
op_amp
id|sdtr_buf
comma
id|SYN_XMSG_WLEN
)paren
suffix:semicolon
r_return
(paren
(paren
id|sdtr_period_index
op_lshift
l_int|4
)paren
op_or
id|sdtr_offset
)paren
suffix:semicolon
)brace
r_else
(brace
id|sdtr_buf.req_ack_offset
op_assign
l_int|0
suffix:semicolon
id|AscMemWordCopyToLram
c_func
(paren
id|iop_base
comma
id|ASCV_MSGOUT_BEG
comma
(paren
id|ushort
id|dosfar
op_star
)paren
op_amp
id|sdtr_buf
comma
id|SYN_XMSG_WLEN
)paren
suffix:semicolon
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
)brace
id|uchar
DECL|function|AscCalSDTRData
id|AscCalSDTRData
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|uchar
id|sdtr_period
comma
id|uchar
id|syn_offset
)paren
(brace
id|uchar
id|byte
suffix:semicolon
id|uchar
id|sdtr_period_ix
suffix:semicolon
id|sdtr_period_ix
op_assign
id|AscGetSynPeriodIndex
c_func
(paren
id|asc_dvc
comma
id|sdtr_period
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|sdtr_period_ix
OG
id|asc_dvc-&gt;max_sdtr_index
)paren
)paren
(brace
r_return
(paren
l_int|0xFF
)paren
suffix:semicolon
)brace
id|byte
op_assign
(paren
id|sdtr_period_ix
op_lshift
l_int|4
)paren
op_or
(paren
id|syn_offset
op_amp
id|ASC_SYN_MAX_OFFSET
)paren
suffix:semicolon
r_return
(paren
id|byte
)paren
suffix:semicolon
)brace
r_void
DECL|function|AscSetChipSDTR
id|AscSetChipSDTR
c_func
(paren
id|PortAddr
id|iop_base
comma
id|uchar
id|sdtr_data
comma
id|uchar
id|tid_no
)paren
(brace
id|AscSetChipSynRegAtID
c_func
(paren
id|iop_base
comma
id|tid_no
comma
id|sdtr_data
)paren
suffix:semicolon
id|AscPutMCodeSDTRDoneAtID
c_func
(paren
id|iop_base
comma
id|tid_no
comma
id|sdtr_data
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|uchar
DECL|function|AscGetSynPeriodIndex
id|AscGetSynPeriodIndex
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|ruchar
id|syn_time
)paren
(brace
id|ruchar
op_star
id|period_table
suffix:semicolon
r_int
id|max_index
suffix:semicolon
r_int
id|i
suffix:semicolon
id|period_table
op_assign
id|asc_dvc-&gt;sdtr_period_tbl
suffix:semicolon
id|max_index
op_assign
(paren
r_int
)paren
id|asc_dvc-&gt;max_sdtr_index
suffix:semicolon
r_if
c_cond
(paren
(paren
id|syn_time
op_ge
id|period_table
(braket
l_int|0
)braket
)paren
op_logical_and
(paren
id|syn_time
op_le
id|period_table
(braket
id|max_index
)braket
)paren
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
(paren
id|max_index
op_minus
l_int|1
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|syn_time
op_le
id|period_table
(braket
id|i
)braket
)paren
(brace
r_return
(paren
id|i
)paren
suffix:semicolon
)brace
)brace
r_return
(paren
id|max_index
)paren
suffix:semicolon
)brace
r_else
(brace
r_return
(paren
id|max_index
op_plus
l_int|1
)paren
suffix:semicolon
)brace
)brace
id|uchar
DECL|function|AscAllocFreeQueue
id|AscAllocFreeQueue
c_func
(paren
id|PortAddr
id|iop_base
comma
id|uchar
id|free_q_head
)paren
(brace
id|ushort
id|q_addr
suffix:semicolon
id|uchar
id|next_qp
suffix:semicolon
id|uchar
id|q_status
suffix:semicolon
id|q_addr
op_assign
id|ASC_QNO_TO_QADDR
c_func
(paren
id|free_q_head
)paren
suffix:semicolon
id|q_status
op_assign
(paren
id|uchar
)paren
id|AscReadLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|q_addr
op_plus
id|ASC_SCSIQ_B_STATUS
)paren
)paren
suffix:semicolon
id|next_qp
op_assign
id|AscReadLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|q_addr
op_plus
id|ASC_SCSIQ_B_FWD
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
id|q_status
op_amp
id|QS_READY
)paren
op_eq
l_int|0
)paren
op_logical_and
(paren
id|next_qp
op_ne
id|ASC_QLINK_END
)paren
)paren
(brace
r_return
(paren
id|next_qp
)paren
suffix:semicolon
)brace
r_return
(paren
id|ASC_QLINK_END
)paren
suffix:semicolon
)brace
id|uchar
DECL|function|AscAllocMultipleFreeQueue
id|AscAllocMultipleFreeQueue
c_func
(paren
id|PortAddr
id|iop_base
comma
id|uchar
id|free_q_head
comma
id|uchar
id|n_free_q
)paren
(brace
id|uchar
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|n_free_q
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|free_q_head
op_assign
id|AscAllocFreeQueue
c_func
(paren
id|iop_base
comma
id|free_q_head
)paren
)paren
op_eq
id|ASC_QLINK_END
)paren
(brace
r_return
(paren
id|ASC_QLINK_END
)paren
suffix:semicolon
)brace
)brace
r_return
(paren
id|free_q_head
)paren
suffix:semicolon
)brace
r_int
DECL|function|AscRiscHaltedAbortSRB
id|AscRiscHaltedAbortSRB
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|ulong
id|srb_ptr
)paren
(brace
id|PortAddr
id|iop_base
suffix:semicolon
id|ushort
id|q_addr
suffix:semicolon
id|uchar
id|q_no
suffix:semicolon
id|ASC_QDONE_INFO
id|scsiq_buf
suffix:semicolon
id|ASC_QDONE_INFO
id|dosfar
op_star
id|scsiq
suffix:semicolon
id|ASC_ISR_CALLBACK
id|asc_isr_callback
suffix:semicolon
r_int
id|last_int_level
suffix:semicolon
id|iop_base
op_assign
id|asc_dvc-&gt;iop_base
suffix:semicolon
id|asc_isr_callback
op_assign
(paren
id|ASC_ISR_CALLBACK
)paren
id|asc_dvc-&gt;isr_callback
suffix:semicolon
id|last_int_level
op_assign
id|DvcEnterCritical
c_func
(paren
)paren
suffix:semicolon
id|scsiq
op_assign
(paren
id|ASC_QDONE_INFO
id|dosfar
op_star
)paren
op_amp
id|scsiq_buf
suffix:semicolon
macro_line|#if CC_LINK_BUSY_Q
id|_AscAbortSrbBusyQueue
c_func
(paren
id|asc_dvc
comma
id|scsiq
comma
id|srb_ptr
)paren
suffix:semicolon
macro_line|#endif
r_for
c_loop
(paren
id|q_no
op_assign
id|ASC_MIN_ACTIVE_QNO
suffix:semicolon
id|q_no
op_le
id|asc_dvc-&gt;max_total_qng
suffix:semicolon
id|q_no
op_increment
)paren
(brace
id|q_addr
op_assign
id|ASC_QNO_TO_QADDR
c_func
(paren
id|q_no
)paren
suffix:semicolon
id|scsiq-&gt;d2.srb_ptr
op_assign
id|AscReadLramDWord
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_D_SRBPTR
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|scsiq-&gt;d2.srb_ptr
op_eq
id|srb_ptr
)paren
(brace
id|_AscCopyLramScsiDoneQ
c_func
(paren
id|iop_base
comma
id|q_addr
comma
id|scsiq
comma
id|asc_dvc-&gt;max_dma_count
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
id|scsiq-&gt;q_status
op_amp
id|QS_READY
)paren
op_ne
l_int|0
)paren
op_logical_and
(paren
(paren
id|scsiq-&gt;q_status
op_amp
id|QS_ABORTED
)paren
op_eq
l_int|0
)paren
op_logical_and
(paren
(paren
id|scsiq-&gt;cntl
op_amp
id|QCSG_SG_XFER_LIST
)paren
op_eq
l_int|0
)paren
)paren
(brace
id|scsiq-&gt;q_status
op_or_assign
id|QS_ABORTED
suffix:semicolon
id|scsiq-&gt;d3.done_stat
op_assign
id|QD_ABORTED_BY_HOST
suffix:semicolon
id|AscWriteLramDWord
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_D_SRBPTR
)paren
comma
l_int|0L
)paren
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_B_STATUS
)paren
comma
id|scsiq-&gt;q_status
)paren
suffix:semicolon
(paren
op_star
id|asc_isr_callback
)paren
(paren
id|asc_dvc
comma
id|scsiq
)paren
suffix:semicolon
r_return
(paren
l_int|1
)paren
suffix:semicolon
)brace
)brace
)brace
id|DvcLeaveCritical
c_func
(paren
id|last_int_level
)paren
suffix:semicolon
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_int
DECL|function|AscRiscHaltedAbortTIX
id|AscRiscHaltedAbortTIX
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|uchar
id|target_ix
)paren
(brace
id|PortAddr
id|iop_base
suffix:semicolon
id|ushort
id|q_addr
suffix:semicolon
id|uchar
id|q_no
suffix:semicolon
id|ASC_QDONE_INFO
id|scsiq_buf
suffix:semicolon
id|ASC_QDONE_INFO
id|dosfar
op_star
id|scsiq
suffix:semicolon
id|ASC_ISR_CALLBACK
id|asc_isr_callback
suffix:semicolon
r_int
id|last_int_level
suffix:semicolon
macro_line|#if CC_LINK_BUSY_Q
id|uchar
id|tid_no
suffix:semicolon
macro_line|#endif
id|iop_base
op_assign
id|asc_dvc-&gt;iop_base
suffix:semicolon
id|asc_isr_callback
op_assign
(paren
id|ASC_ISR_CALLBACK
)paren
id|asc_dvc-&gt;isr_callback
suffix:semicolon
id|last_int_level
op_assign
id|DvcEnterCritical
c_func
(paren
)paren
suffix:semicolon
id|scsiq
op_assign
(paren
id|ASC_QDONE_INFO
id|dosfar
op_star
)paren
op_amp
id|scsiq_buf
suffix:semicolon
macro_line|#if CC_LINK_BUSY_Q
id|tid_no
op_assign
id|ASC_TIX_TO_TID
c_func
(paren
id|target_ix
)paren
suffix:semicolon
id|_AscAbortTidBusyQueue
c_func
(paren
id|asc_dvc
comma
id|scsiq
comma
id|tid_no
)paren
suffix:semicolon
macro_line|#endif
r_for
c_loop
(paren
id|q_no
op_assign
id|ASC_MIN_ACTIVE_QNO
suffix:semicolon
id|q_no
op_le
id|asc_dvc-&gt;max_total_qng
suffix:semicolon
id|q_no
op_increment
)paren
(brace
id|q_addr
op_assign
id|ASC_QNO_TO_QADDR
c_func
(paren
id|q_no
)paren
suffix:semicolon
id|_AscCopyLramScsiDoneQ
c_func
(paren
id|iop_base
comma
id|q_addr
comma
id|scsiq
comma
id|asc_dvc-&gt;max_dma_count
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
id|scsiq-&gt;q_status
op_amp
id|QS_READY
)paren
op_ne
l_int|0
)paren
op_logical_and
(paren
(paren
id|scsiq-&gt;q_status
op_amp
id|QS_ABORTED
)paren
op_eq
l_int|0
)paren
op_logical_and
(paren
(paren
id|scsiq-&gt;cntl
op_amp
id|QCSG_SG_XFER_LIST
)paren
op_eq
l_int|0
)paren
)paren
(brace
r_if
c_cond
(paren
id|scsiq-&gt;d2.target_ix
op_eq
id|target_ix
)paren
(brace
id|scsiq-&gt;q_status
op_or_assign
id|QS_ABORTED
suffix:semicolon
id|scsiq-&gt;d3.done_stat
op_assign
id|QD_ABORTED_BY_HOST
suffix:semicolon
id|AscWriteLramDWord
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_D_SRBPTR
)paren
comma
l_int|0L
)paren
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
id|q_addr
op_plus
(paren
id|ushort
)paren
id|ASC_SCSIQ_B_STATUS
)paren
comma
id|scsiq-&gt;q_status
)paren
suffix:semicolon
(paren
op_star
id|asc_isr_callback
)paren
(paren
id|asc_dvc
comma
id|scsiq
)paren
suffix:semicolon
)brace
)brace
)brace
id|DvcLeaveCritical
c_func
(paren
id|last_int_level
)paren
suffix:semicolon
r_return
(paren
l_int|1
)paren
suffix:semicolon
)brace
macro_line|#if CC_LINK_BUSY_Q
macro_line|#endif
r_int
DECL|function|AscHostReqRiscHalt
id|AscHostReqRiscHalt
c_func
(paren
id|PortAddr
id|iop_base
)paren
(brace
r_int
id|count
op_assign
l_int|0
suffix:semicolon
r_int
id|sta
op_assign
l_int|0
suffix:semicolon
id|uchar
id|saved_stop_code
suffix:semicolon
r_if
c_cond
(paren
id|AscIsChipHalted
c_func
(paren
id|iop_base
)paren
)paren
r_return
(paren
l_int|1
)paren
suffix:semicolon
id|saved_stop_code
op_assign
id|AscReadLramByte
c_func
(paren
id|iop_base
comma
id|ASCV_STOP_CODE_B
)paren
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
id|ASCV_STOP_CODE_B
comma
id|ASC_STOP_HOST_REQ_RISC_HALT
op_or
id|ASC_STOP_REQ_RISC_STOP
)paren
suffix:semicolon
r_do
(brace
r_if
c_cond
(paren
id|AscIsChipHalted
c_func
(paren
id|iop_base
)paren
)paren
(brace
id|sta
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
)brace
id|DvcSleepMilliSecond
c_func
(paren
l_int|100
)paren
suffix:semicolon
)brace
r_while
c_loop
(paren
id|count
op_increment
OL
l_int|20
)paren
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
id|ASCV_STOP_CODE_B
comma
id|saved_stop_code
)paren
suffix:semicolon
r_return
(paren
id|sta
)paren
suffix:semicolon
)brace
r_int
DECL|function|AscStopQueueExe
id|AscStopQueueExe
c_func
(paren
id|PortAddr
id|iop_base
)paren
(brace
r_int
id|count
suffix:semicolon
id|count
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|AscReadLramByte
c_func
(paren
id|iop_base
comma
id|ASCV_STOP_CODE_B
)paren
op_eq
l_int|0
)paren
(brace
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
id|ASCV_STOP_CODE_B
comma
id|ASC_STOP_REQ_RISC_STOP
)paren
suffix:semicolon
r_do
(brace
r_if
c_cond
(paren
id|AscReadLramByte
c_func
(paren
id|iop_base
comma
id|ASCV_STOP_CODE_B
)paren
op_amp
id|ASC_STOP_ACK_RISC_STOP
)paren
(brace
r_return
(paren
l_int|1
)paren
suffix:semicolon
)brace
id|DvcSleepMilliSecond
c_func
(paren
l_int|100
)paren
suffix:semicolon
)brace
r_while
c_loop
(paren
id|count
op_increment
OL
l_int|20
)paren
suffix:semicolon
)brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_int
DECL|function|AscStartQueueExe
id|AscStartQueueExe
c_func
(paren
id|PortAddr
id|iop_base
)paren
(brace
r_if
c_cond
(paren
id|AscReadLramByte
c_func
(paren
id|iop_base
comma
id|ASCV_STOP_CODE_B
)paren
op_ne
l_int|0
)paren
(brace
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
id|ASCV_STOP_CODE_B
comma
l_int|0
)paren
suffix:semicolon
)brace
r_return
(paren
l_int|1
)paren
suffix:semicolon
)brace
r_int
DECL|function|AscCleanUpBusyQueue
id|AscCleanUpBusyQueue
c_func
(paren
id|PortAddr
id|iop_base
)paren
(brace
r_int
id|count
suffix:semicolon
id|uchar
id|stop_code
suffix:semicolon
id|count
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|AscReadLramByte
c_func
(paren
id|iop_base
comma
id|ASCV_STOP_CODE_B
)paren
op_ne
l_int|0
)paren
(brace
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
id|ASCV_STOP_CODE_B
comma
id|ASC_STOP_CLEAN_UP_BUSY_Q
)paren
suffix:semicolon
r_do
(brace
id|stop_code
op_assign
id|AscReadLramByte
c_func
(paren
id|iop_base
comma
id|ASCV_STOP_CODE_B
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|stop_code
op_amp
id|ASC_STOP_CLEAN_UP_BUSY_Q
)paren
op_eq
l_int|0
)paren
r_break
suffix:semicolon
id|DvcSleepMilliSecond
c_func
(paren
l_int|100
)paren
suffix:semicolon
)brace
r_while
c_loop
(paren
id|count
op_increment
OL
l_int|20
)paren
suffix:semicolon
)brace
r_return
(paren
l_int|1
)paren
suffix:semicolon
)brace
r_int
DECL|function|AscCleanUpDiscQueue
id|AscCleanUpDiscQueue
c_func
(paren
id|PortAddr
id|iop_base
)paren
(brace
r_int
id|count
suffix:semicolon
id|uchar
id|stop_code
suffix:semicolon
id|count
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|AscReadLramByte
c_func
(paren
id|iop_base
comma
id|ASCV_STOP_CODE_B
)paren
op_ne
l_int|0
)paren
(brace
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
id|ASCV_STOP_CODE_B
comma
id|ASC_STOP_CLEAN_UP_DISC_Q
)paren
suffix:semicolon
r_do
(brace
id|stop_code
op_assign
id|AscReadLramByte
c_func
(paren
id|iop_base
comma
id|ASCV_STOP_CODE_B
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|stop_code
op_amp
id|ASC_STOP_CLEAN_UP_DISC_Q
)paren
op_eq
l_int|0
)paren
r_break
suffix:semicolon
id|DvcSleepMilliSecond
c_func
(paren
l_int|100
)paren
suffix:semicolon
)brace
r_while
c_loop
(paren
id|count
op_increment
OL
l_int|20
)paren
suffix:semicolon
)brace
r_return
(paren
l_int|1
)paren
suffix:semicolon
)brace
r_int
DECL|function|AscWaitTixISRDone
id|AscWaitTixISRDone
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|uchar
id|target_ix
)paren
(brace
id|uchar
id|cur_req
suffix:semicolon
id|uchar
id|tid_no
suffix:semicolon
id|tid_no
op_assign
id|ASC_TIX_TO_TID
c_func
(paren
id|target_ix
)paren
suffix:semicolon
r_while
c_loop
(paren
id|TRUE
)paren
(brace
r_if
c_cond
(paren
(paren
id|cur_req
op_assign
id|asc_dvc-&gt;cur_dvc_qng
(braket
id|tid_no
)braket
)paren
op_eq
l_int|0
)paren
(brace
r_break
suffix:semicolon
)brace
id|DvcSleepMilliSecond
c_func
(paren
l_int|1000L
)paren
suffix:semicolon
r_if
c_cond
(paren
id|asc_dvc-&gt;cur_dvc_qng
(braket
id|tid_no
)braket
op_eq
id|cur_req
)paren
(brace
r_break
suffix:semicolon
)brace
)brace
r_return
(paren
l_int|1
)paren
suffix:semicolon
)brace
r_int
DECL|function|AscWaitISRDone
id|AscWaitISRDone
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
)paren
(brace
r_int
id|tid
suffix:semicolon
r_for
c_loop
(paren
id|tid
op_assign
l_int|0
suffix:semicolon
id|tid
op_le
id|ASC_MAX_TID
suffix:semicolon
id|tid
op_increment
)paren
(brace
id|AscWaitTixISRDone
c_func
(paren
id|asc_dvc
comma
id|ASC_TID_TO_TIX
c_func
(paren
id|tid
)paren
)paren
suffix:semicolon
)brace
r_return
(paren
l_int|1
)paren
suffix:semicolon
)brace
id|ulong
DECL|function|AscGetOnePhyAddr
id|AscGetOnePhyAddr
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|uchar
id|dosfar
op_star
id|buf_addr
comma
id|ulong
id|buf_size
)paren
(brace
id|ASC_MIN_SG_HEAD
id|sg_head
suffix:semicolon
id|sg_head.entry_cnt
op_assign
id|ASC_MIN_SG_LIST
suffix:semicolon
r_if
c_cond
(paren
id|DvcGetSGList
c_func
(paren
id|asc_dvc
comma
(paren
id|uchar
id|dosfar
op_star
)paren
id|buf_addr
comma
id|buf_size
comma
(paren
id|ASC_SG_HEAD
id|dosfar
op_star
)paren
op_amp
id|sg_head
)paren
op_ne
id|buf_size
)paren
(brace
r_return
(paren
l_int|0L
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|sg_head.entry_cnt
OG
l_int|1
)paren
(brace
r_return
(paren
l_int|0L
)paren
suffix:semicolon
)brace
r_return
(paren
id|sg_head.sg_list
(braket
l_int|0
)braket
dot
id|addr
)paren
suffix:semicolon
)brace
r_void
DECL|function|DvcDelayNanoSecond
id|DvcDelayNanoSecond
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|ulong
id|nano_sec
)paren
(brace
id|ulong
id|loop
suffix:semicolon
id|PortAddr
id|iop_base
suffix:semicolon
id|iop_base
op_assign
id|asc_dvc-&gt;iop_base
suffix:semicolon
id|loop
op_assign
id|nano_sec
op_div
l_int|90
suffix:semicolon
id|loop
op_increment
suffix:semicolon
r_while
c_loop
(paren
id|loop
op_decrement
op_ne
l_int|0
)paren
(brace
id|inp
c_func
(paren
id|iop_base
)paren
suffix:semicolon
)brace
r_return
suffix:semicolon
)brace
id|ulong
DECL|function|AscGetEisaProductID
id|AscGetEisaProductID
c_func
(paren
id|PortAddr
id|iop_base
)paren
(brace
id|PortAddr
id|eisa_iop
suffix:semicolon
id|ushort
id|product_id_high
comma
id|product_id_low
suffix:semicolon
id|ulong
id|product_id
suffix:semicolon
id|eisa_iop
op_assign
id|ASC_GET_EISA_SLOT
c_func
(paren
id|iop_base
)paren
op_or
id|ASC_EISA_PID_IOP_MASK
suffix:semicolon
id|product_id_low
op_assign
id|inpw
c_func
(paren
id|eisa_iop
)paren
suffix:semicolon
id|product_id_high
op_assign
id|inpw
c_func
(paren
id|eisa_iop
op_plus
l_int|2
)paren
suffix:semicolon
id|product_id
op_assign
(paren
(paren
id|ulong
)paren
id|product_id_high
op_lshift
l_int|16
)paren
op_or
(paren
id|ulong
)paren
id|product_id_low
suffix:semicolon
r_return
(paren
id|product_id
)paren
suffix:semicolon
)brace
id|PortAddr
DECL|function|AscSearchIOPortAddrEISA
id|AscSearchIOPortAddrEISA
c_func
(paren
id|PortAddr
id|iop_base
)paren
(brace
id|ulong
id|eisa_product_id
suffix:semicolon
r_if
c_cond
(paren
id|iop_base
op_eq
l_int|0
)paren
(brace
id|iop_base
op_assign
id|ASC_EISA_MIN_IOP_ADDR
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|iop_base
op_eq
id|ASC_EISA_MAX_IOP_ADDR
)paren
r_return
(paren
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|iop_base
op_amp
l_int|0x0050
)paren
op_eq
l_int|0x0050
)paren
(brace
id|iop_base
op_add_assign
id|ASC_EISA_BIG_IOP_GAP
suffix:semicolon
)brace
r_else
(brace
id|iop_base
op_add_assign
id|ASC_EISA_SMALL_IOP_GAP
suffix:semicolon
)brace
)brace
r_while
c_loop
(paren
id|iop_base
op_le
id|ASC_EISA_MAX_IOP_ADDR
)paren
(brace
id|eisa_product_id
op_assign
id|AscGetEisaProductID
c_func
(paren
id|iop_base
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|eisa_product_id
op_eq
id|ASC_EISA_ID_740
)paren
op_logical_or
(paren
id|eisa_product_id
op_eq
id|ASC_EISA_ID_750
)paren
)paren
(brace
r_if
c_cond
(paren
id|AscFindSignature
c_func
(paren
id|iop_base
)paren
)paren
(brace
id|inpw
c_func
(paren
id|iop_base
op_plus
l_int|4
)paren
suffix:semicolon
r_return
(paren
id|iop_base
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|iop_base
op_eq
id|ASC_EISA_MAX_IOP_ADDR
)paren
r_return
(paren
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|iop_base
op_amp
l_int|0x0050
)paren
op_eq
l_int|0x0050
)paren
(brace
id|iop_base
op_add_assign
id|ASC_EISA_BIG_IOP_GAP
suffix:semicolon
)brace
r_else
(brace
id|iop_base
op_add_assign
id|ASC_EISA_SMALL_IOP_GAP
suffix:semicolon
)brace
)brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_int
DECL|function|AscStartChip
id|AscStartChip
c_func
(paren
id|PortAddr
id|iop_base
)paren
(brace
id|AscSetChipControl
c_func
(paren
id|iop_base
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|AscGetChipStatus
c_func
(paren
id|iop_base
)paren
op_amp
id|CSW_HALTED
)paren
op_ne
l_int|0
)paren
(brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_return
(paren
l_int|1
)paren
suffix:semicolon
)brace
r_int
DECL|function|AscStopChip
id|AscStopChip
c_func
(paren
id|PortAddr
id|iop_base
)paren
(brace
id|uchar
id|cc_val
suffix:semicolon
id|cc_val
op_assign
id|AscGetChipControl
c_func
(paren
id|iop_base
)paren
op_amp
(paren
op_complement
(paren
id|CC_SINGLE_STEP
op_or
id|CC_TEST
op_or
id|CC_DIAG
)paren
)paren
suffix:semicolon
id|AscSetChipControl
c_func
(paren
id|iop_base
comma
(paren
id|uchar
)paren
(paren
id|cc_val
op_or
id|CC_HALT
)paren
)paren
suffix:semicolon
id|AscSetChipIH
c_func
(paren
id|iop_base
comma
id|INS_HALT
)paren
suffix:semicolon
id|AscSetChipIH
c_func
(paren
id|iop_base
comma
id|INS_RFLAG_WTM
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|AscGetChipStatus
c_func
(paren
id|iop_base
)paren
op_amp
id|CSW_HALTED
)paren
op_eq
l_int|0
)paren
(brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_return
(paren
l_int|1
)paren
suffix:semicolon
)brace
r_int
DECL|function|AscIsChipHalted
id|AscIsChipHalted
c_func
(paren
id|PortAddr
id|iop_base
)paren
(brace
r_if
c_cond
(paren
(paren
id|AscGetChipStatus
c_func
(paren
id|iop_base
)paren
op_amp
id|CSW_HALTED
)paren
op_ne
l_int|0
)paren
(brace
r_if
c_cond
(paren
(paren
id|AscGetChipControl
c_func
(paren
id|iop_base
)paren
op_amp
id|CC_HALT
)paren
op_ne
l_int|0
)paren
(brace
r_return
(paren
l_int|1
)paren
suffix:semicolon
)brace
)brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_void
DECL|function|AscSetChipIH
id|AscSetChipIH
c_func
(paren
id|PortAddr
id|iop_base
comma
id|ushort
id|ins_code
)paren
(brace
id|AscSetBank
c_func
(paren
id|iop_base
comma
l_int|1
)paren
suffix:semicolon
id|AscWriteChipIH
c_func
(paren
id|iop_base
comma
id|ins_code
)paren
suffix:semicolon
id|AscSetBank
c_func
(paren
id|iop_base
comma
l_int|0
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_void
DECL|function|AscAckInterrupt
id|AscAckInterrupt
c_func
(paren
id|PortAddr
id|iop_base
)paren
(brace
id|uchar
id|host_flag
suffix:semicolon
id|uchar
id|risc_flag
suffix:semicolon
id|ushort
id|loop
suffix:semicolon
id|loop
op_assign
l_int|0
suffix:semicolon
r_do
(brace
id|risc_flag
op_assign
id|AscReadLramByte
c_func
(paren
id|iop_base
comma
id|ASCV_RISC_FLAG_B
)paren
suffix:semicolon
r_if
c_cond
(paren
id|loop
op_increment
OG
l_int|0x7FFF
)paren
(brace
r_break
suffix:semicolon
)brace
)brace
r_while
c_loop
(paren
(paren
id|risc_flag
op_amp
id|ASC_RISC_FLAG_GEN_INT
)paren
op_ne
l_int|0
)paren
suffix:semicolon
id|host_flag
op_assign
id|AscReadLramByte
c_func
(paren
id|iop_base
comma
id|ASCV_HOST_FLAG_B
)paren
op_amp
(paren
op_complement
id|ASC_HOST_FLAG_ACK_INT
)paren
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
id|ASCV_HOST_FLAG_B
comma
(paren
id|uchar
)paren
(paren
id|host_flag
op_or
id|ASC_HOST_FLAG_ACK_INT
)paren
)paren
suffix:semicolon
id|AscSetChipStatus
c_func
(paren
id|iop_base
comma
id|CIW_INT_ACK
)paren
suffix:semicolon
id|loop
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|AscGetChipStatus
c_func
(paren
id|iop_base
)paren
op_amp
id|CSW_INT_PENDING
)paren
(brace
id|AscSetChipStatus
c_func
(paren
id|iop_base
comma
id|CIW_INT_ACK
)paren
suffix:semicolon
r_if
c_cond
(paren
id|loop
op_increment
OG
l_int|3
)paren
(brace
r_break
suffix:semicolon
)brace
)brace
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
id|ASCV_HOST_FLAG_B
comma
id|host_flag
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_void
DECL|function|AscDisableInterrupt
id|AscDisableInterrupt
c_func
(paren
id|PortAddr
id|iop_base
)paren
(brace
id|ushort
id|cfg
suffix:semicolon
id|cfg
op_assign
id|AscGetChipCfgLsw
c_func
(paren
id|iop_base
)paren
suffix:semicolon
id|AscSetChipCfgLsw
c_func
(paren
id|iop_base
comma
id|cfg
op_amp
(paren
op_complement
id|ASC_CFG0_HOST_INT_ON
)paren
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_void
DECL|function|AscEnableInterrupt
id|AscEnableInterrupt
c_func
(paren
id|PortAddr
id|iop_base
)paren
(brace
id|ushort
id|cfg
suffix:semicolon
id|cfg
op_assign
id|AscGetChipCfgLsw
c_func
(paren
id|iop_base
)paren
suffix:semicolon
id|AscSetChipCfgLsw
c_func
(paren
id|iop_base
comma
id|cfg
op_or
id|ASC_CFG0_HOST_INT_ON
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_void
DECL|function|AscSetBank
id|AscSetBank
c_func
(paren
id|PortAddr
id|iop_base
comma
id|uchar
id|bank
)paren
(brace
id|uchar
id|val
suffix:semicolon
id|val
op_assign
id|AscGetChipControl
c_func
(paren
id|iop_base
)paren
op_amp
(paren
op_complement
(paren
id|CC_SINGLE_STEP
op_or
id|CC_TEST
op_or
id|CC_DIAG
op_or
id|CC_SCSI_RESET
op_or
id|CC_CHIP_RESET
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|bank
op_eq
l_int|1
)paren
(brace
id|val
op_or_assign
id|CC_BANK_ONE
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|bank
op_eq
l_int|2
)paren
(brace
id|val
op_or_assign
id|CC_DIAG
op_or
id|CC_BANK_ONE
suffix:semicolon
)brace
r_else
(brace
id|val
op_and_assign
op_complement
id|CC_BANK_ONE
suffix:semicolon
)brace
id|AscSetChipControl
c_func
(paren
id|iop_base
comma
id|val
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_int
DECL|function|AscResetChipAndScsiBus
id|AscResetChipAndScsiBus
c_func
(paren
id|PortAddr
id|iop_base
)paren
(brace
r_while
c_loop
(paren
id|AscGetChipStatus
c_func
(paren
id|iop_base
)paren
op_amp
id|CSW_SCSI_RESET_ACTIVE
)paren
suffix:semicolon
id|AscStopChip
c_func
(paren
id|iop_base
)paren
suffix:semicolon
id|AscSetChipControl
c_func
(paren
id|iop_base
comma
id|CC_CHIP_RESET
op_or
id|CC_SCSI_RESET
op_or
id|CC_HALT
)paren
suffix:semicolon
id|DvcSleepMilliSecond
c_func
(paren
l_int|200
)paren
suffix:semicolon
id|AscSetChipIH
c_func
(paren
id|iop_base
comma
id|INS_RFLAG_WTM
)paren
suffix:semicolon
id|AscSetChipIH
c_func
(paren
id|iop_base
comma
id|INS_HALT
)paren
suffix:semicolon
id|AscSetChipControl
c_func
(paren
id|iop_base
comma
id|CC_CHIP_RESET
op_or
id|CC_HALT
)paren
suffix:semicolon
id|AscSetChipControl
c_func
(paren
id|iop_base
comma
id|CC_HALT
)paren
suffix:semicolon
id|DvcSleepMilliSecond
c_func
(paren
l_int|200
)paren
suffix:semicolon
id|AscSetChipStatus
c_func
(paren
id|iop_base
comma
id|CIW_CLR_SCSI_RESET_INT
)paren
suffix:semicolon
id|AscSetChipStatus
c_func
(paren
id|iop_base
comma
l_int|0
)paren
suffix:semicolon
r_return
(paren
id|AscIsChipHalted
c_func
(paren
id|iop_base
)paren
)paren
suffix:semicolon
)brace
id|ulong
DECL|function|AscGetMaxDmaCount
id|AscGetMaxDmaCount
c_func
(paren
id|ushort
id|bus_type
)paren
(brace
r_if
c_cond
(paren
id|bus_type
op_amp
id|ASC_IS_ISA
)paren
r_return
(paren
id|ASC_MAX_ISA_DMA_COUNT
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|bus_type
op_amp
(paren
id|ASC_IS_EISA
op_or
id|ASC_IS_VL
)paren
)paren
r_return
(paren
id|ASC_MAX_VL_DMA_COUNT
)paren
suffix:semicolon
r_return
(paren
id|ASC_MAX_PCI_DMA_COUNT
)paren
suffix:semicolon
)brace
id|ushort
DECL|function|AscGetIsaDmaChannel
id|AscGetIsaDmaChannel
c_func
(paren
id|PortAddr
id|iop_base
)paren
(brace
id|ushort
id|channel
suffix:semicolon
id|channel
op_assign
id|AscGetChipCfgLsw
c_func
(paren
id|iop_base
)paren
op_amp
l_int|0x0003
suffix:semicolon
r_if
c_cond
(paren
id|channel
op_eq
l_int|0x03
)paren
r_return
(paren
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|channel
op_eq
l_int|0x00
)paren
r_return
(paren
l_int|7
)paren
suffix:semicolon
r_return
(paren
id|channel
op_plus
l_int|4
)paren
suffix:semicolon
)brace
id|ushort
DECL|function|AscSetIsaDmaChannel
id|AscSetIsaDmaChannel
c_func
(paren
id|PortAddr
id|iop_base
comma
id|ushort
id|dma_channel
)paren
(brace
id|ushort
id|cfg_lsw
suffix:semicolon
id|uchar
id|value
suffix:semicolon
r_if
c_cond
(paren
(paren
id|dma_channel
op_ge
l_int|5
)paren
op_logical_and
(paren
id|dma_channel
op_le
l_int|7
)paren
)paren
(brace
r_if
c_cond
(paren
id|dma_channel
op_eq
l_int|7
)paren
id|value
op_assign
l_int|0x00
suffix:semicolon
r_else
id|value
op_assign
id|dma_channel
op_minus
l_int|4
suffix:semicolon
id|cfg_lsw
op_assign
id|AscGetChipCfgLsw
c_func
(paren
id|iop_base
)paren
op_amp
l_int|0xFFFC
suffix:semicolon
id|cfg_lsw
op_or_assign
id|value
suffix:semicolon
id|AscSetChipCfgLsw
c_func
(paren
id|iop_base
comma
id|cfg_lsw
)paren
suffix:semicolon
r_return
(paren
id|AscGetIsaDmaChannel
c_func
(paren
id|iop_base
)paren
)paren
suffix:semicolon
)brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
id|uchar
DECL|function|AscSetIsaDmaSpeed
id|AscSetIsaDmaSpeed
c_func
(paren
id|PortAddr
id|iop_base
comma
id|uchar
id|speed_value
)paren
(brace
id|speed_value
op_and_assign
l_int|0x07
suffix:semicolon
id|AscSetBank
c_func
(paren
id|iop_base
comma
l_int|1
)paren
suffix:semicolon
id|AscWriteChipDmaSpeed
c_func
(paren
id|iop_base
comma
id|speed_value
)paren
suffix:semicolon
id|AscSetBank
c_func
(paren
id|iop_base
comma
l_int|0
)paren
suffix:semicolon
r_return
(paren
id|AscGetIsaDmaSpeed
c_func
(paren
id|iop_base
)paren
)paren
suffix:semicolon
)brace
id|uchar
DECL|function|AscGetIsaDmaSpeed
id|AscGetIsaDmaSpeed
c_func
(paren
id|PortAddr
id|iop_base
)paren
(brace
id|uchar
id|speed_value
suffix:semicolon
id|AscSetBank
c_func
(paren
id|iop_base
comma
l_int|1
)paren
suffix:semicolon
id|speed_value
op_assign
id|AscReadChipDmaSpeed
c_func
(paren
id|iop_base
)paren
suffix:semicolon
id|speed_value
op_and_assign
l_int|0x07
suffix:semicolon
id|AscSetBank
c_func
(paren
id|iop_base
comma
l_int|0
)paren
suffix:semicolon
r_return
(paren
id|speed_value
)paren
suffix:semicolon
)brace
id|ushort
DECL|function|AscInitGetConfig
id|AscInitGetConfig
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
)paren
(brace
id|ushort
id|warn_code
suffix:semicolon
id|warn_code
op_assign
l_int|0
suffix:semicolon
id|asc_dvc-&gt;init_state
op_assign
id|ASC_INIT_STATE_BEG_GET_CFG
suffix:semicolon
r_if
c_cond
(paren
id|asc_dvc-&gt;err_code
op_ne
l_int|0
)paren
r_return
(paren
id|UW_ERR
)paren
suffix:semicolon
r_if
c_cond
(paren
id|AscFindSignature
c_func
(paren
id|asc_dvc-&gt;iop_base
)paren
)paren
(brace
id|warn_code
op_or_assign
id|AscInitAscDvcVar
c_func
(paren
id|asc_dvc
)paren
suffix:semicolon
macro_line|#if CC_INCLUDE_EEP_CONFIG
r_if
c_cond
(paren
id|asc_dvc-&gt;init_state
op_amp
id|ASC_INIT_STATE_WITHOUT_EEP
)paren
(brace
id|warn_code
op_or_assign
id|AscInitWithoutEEP
c_func
(paren
id|asc_dvc
)paren
suffix:semicolon
)brace
r_else
(brace
id|warn_code
op_or_assign
id|AscInitFromEEP
c_func
(paren
id|asc_dvc
)paren
suffix:semicolon
)brace
macro_line|#else
id|warn_code
op_or_assign
id|AscInitWithoutEEP
c_func
(paren
id|asc_dvc
)paren
suffix:semicolon
macro_line|#endif
id|asc_dvc-&gt;init_state
op_or_assign
id|ASC_INIT_STATE_END_GET_CFG
suffix:semicolon
r_if
c_cond
(paren
id|asc_dvc-&gt;scsi_reset_wait
OG
id|ASC_MAX_SCSI_RESET_WAIT
)paren
(brace
id|asc_dvc-&gt;scsi_reset_wait
op_assign
id|ASC_MAX_SCSI_RESET_WAIT
suffix:semicolon
)brace
)brace
r_else
(brace
id|asc_dvc-&gt;err_code
op_assign
id|ASC_IERR_BAD_SIGNATURE
suffix:semicolon
)brace
r_return
(paren
id|warn_code
)paren
suffix:semicolon
)brace
id|ushort
DECL|function|AscInitSetConfig
id|AscInitSetConfig
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
)paren
(brace
id|ushort
id|warn_code
suffix:semicolon
id|warn_code
op_assign
l_int|0
suffix:semicolon
id|asc_dvc-&gt;init_state
op_or_assign
id|ASC_INIT_STATE_BEG_SET_CFG
suffix:semicolon
r_if
c_cond
(paren
id|asc_dvc-&gt;err_code
op_ne
l_int|0
)paren
r_return
(paren
id|UW_ERR
)paren
suffix:semicolon
r_if
c_cond
(paren
id|AscFindSignature
c_func
(paren
id|asc_dvc-&gt;iop_base
)paren
)paren
(brace
id|warn_code
op_or_assign
id|AscInitFromAscDvcVar
c_func
(paren
id|asc_dvc
)paren
suffix:semicolon
id|asc_dvc-&gt;init_state
op_or_assign
id|ASC_INIT_STATE_END_SET_CFG
suffix:semicolon
)brace
r_else
(brace
id|asc_dvc-&gt;err_code
op_assign
id|ASC_IERR_BAD_SIGNATURE
suffix:semicolon
)brace
r_return
(paren
id|warn_code
)paren
suffix:semicolon
)brace
id|ushort
DECL|function|AscInitFromAscDvcVar
id|AscInitFromAscDvcVar
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
)paren
(brace
id|PortAddr
id|iop_base
suffix:semicolon
id|ushort
id|cfg_msw
suffix:semicolon
id|ushort
id|warn_code
suffix:semicolon
id|ushort
id|pci_device_id
suffix:semicolon
id|iop_base
op_assign
id|asc_dvc-&gt;iop_base
suffix:semicolon
id|pci_device_id
op_assign
id|asc_dvc-&gt;cfg-&gt;pci_device_id
suffix:semicolon
id|warn_code
op_assign
l_int|0
suffix:semicolon
id|cfg_msw
op_assign
id|AscGetChipCfgMsw
c_func
(paren
id|iop_base
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|cfg_msw
op_amp
id|ASC_CFG_MSW_CLR_MASK
)paren
op_ne
l_int|0
)paren
(brace
id|cfg_msw
op_and_assign
(paren
op_complement
(paren
id|ASC_CFG_MSW_CLR_MASK
)paren
)paren
suffix:semicolon
id|warn_code
op_or_assign
id|ASC_WARN_CFG_MSW_RECOVER
suffix:semicolon
id|AscSetChipCfgMsw
c_func
(paren
id|iop_base
comma
id|cfg_msw
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|asc_dvc-&gt;cfg-&gt;cmd_qng_enabled
op_amp
id|asc_dvc-&gt;cfg-&gt;disc_enable
)paren
op_ne
id|asc_dvc-&gt;cfg-&gt;cmd_qng_enabled
)paren
(brace
id|asc_dvc-&gt;cfg-&gt;disc_enable
op_assign
id|asc_dvc-&gt;cfg-&gt;cmd_qng_enabled
suffix:semicolon
id|warn_code
op_or_assign
id|ASC_WARN_CMD_QNG_CONFLICT
suffix:semicolon
)brace
r_if
c_cond
(paren
id|AscGetChipStatus
c_func
(paren
id|iop_base
)paren
op_amp
id|CSW_AUTO_CONFIG
)paren
(brace
id|warn_code
op_or_assign
id|ASC_WARN_AUTO_CONFIG
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|asc_dvc-&gt;bus_type
op_amp
(paren
id|ASC_IS_ISA
op_or
id|ASC_IS_VL
)paren
)paren
op_ne
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|AscSetChipIRQ
c_func
(paren
id|iop_base
comma
id|asc_dvc-&gt;irq_no
comma
id|asc_dvc-&gt;bus_type
)paren
op_ne
id|asc_dvc-&gt;irq_no
)paren
(brace
id|asc_dvc-&gt;err_code
op_or_assign
id|ASC_IERR_SET_IRQ_NO
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|asc_dvc-&gt;bus_type
op_amp
id|ASC_IS_PCI
)paren
(brace
macro_line|#if CC_DISABLE_PCI_PARITY_INT
id|cfg_msw
op_and_assign
l_int|0xFFC0
suffix:semicolon
id|AscSetChipCfgMsw
c_func
(paren
id|iop_base
comma
id|cfg_msw
)paren
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
(paren
id|asc_dvc-&gt;bus_type
op_amp
id|ASC_IS_PCI_ULTRA
)paren
op_eq
id|ASC_IS_PCI_ULTRA
)paren
(brace
)brace
r_else
(brace
r_if
c_cond
(paren
(paren
id|pci_device_id
op_eq
id|ASC_PCI_DEVICE_ID_REV_A
)paren
op_logical_or
(paren
id|pci_device_id
op_eq
id|ASC_PCI_DEVICE_ID_REV_B
)paren
)paren
(brace
id|asc_dvc-&gt;bug_fix_cntl
op_or_assign
id|ASC_BUG_FIX_IF_NOT_DWB
suffix:semicolon
id|asc_dvc-&gt;bug_fix_cntl
op_or_assign
id|ASC_BUG_FIX_ASYN_USE_SYN
suffix:semicolon
macro_line|#if CC_SET_PCI_LATENCY_TIMER_ZERO
id|DvcWritePCIConfigByte
c_func
(paren
id|asc_dvc
comma
id|AscPCIConfigCommandRegister
comma
id|AscPCICmdRegBits_BusMastering
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|DvcReadPCIConfigByte
c_func
(paren
id|asc_dvc
comma
id|AscPCIConfigCommandRegister
)paren
op_amp
id|AscPCICmdRegBits_BusMastering
)paren
op_ne
id|AscPCICmdRegBits_BusMastering
)paren
(brace
id|warn_code
op_or_assign
id|ASC_WARN_SET_PCI_CONFIG_SPACE
suffix:semicolon
)brace
id|DvcWritePCIConfigByte
c_func
(paren
id|asc_dvc
comma
id|AscPCIConfigLatencyTimer
comma
l_int|0x00
)paren
suffix:semicolon
r_if
c_cond
(paren
id|DvcReadPCIConfigByte
c_func
(paren
id|asc_dvc
comma
id|AscPCIConfigLatencyTimer
)paren
op_ne
l_int|0x00
)paren
(brace
id|warn_code
op_or_assign
id|ASC_WARN_SET_PCI_CONFIG_SPACE
suffix:semicolon
)brace
macro_line|#endif
)brace
)brace
)brace
r_else
r_if
c_cond
(paren
id|asc_dvc-&gt;bus_type
op_eq
id|ASC_IS_ISAPNP
)paren
(brace
r_if
c_cond
(paren
id|AscGetChipVersion
c_func
(paren
id|iop_base
comma
id|asc_dvc-&gt;bus_type
)paren
op_eq
id|ASC_CHIP_VER_ASYN_BUG
)paren
(brace
id|asc_dvc-&gt;bug_fix_cntl
op_or_assign
id|ASC_BUG_FIX_ASYN_USE_SYN
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|AscSetChipScsiID
c_func
(paren
id|iop_base
comma
id|asc_dvc-&gt;cfg-&gt;chip_scsi_id
)paren
op_ne
id|asc_dvc-&gt;cfg-&gt;chip_scsi_id
)paren
(brace
id|asc_dvc-&gt;err_code
op_or_assign
id|ASC_IERR_SET_SCSI_ID
suffix:semicolon
)brace
r_if
c_cond
(paren
id|asc_dvc-&gt;bus_type
op_amp
id|ASC_IS_ISA
)paren
(brace
id|AscSetIsaDmaChannel
c_func
(paren
id|iop_base
comma
id|asc_dvc-&gt;cfg-&gt;isa_dma_channel
)paren
suffix:semicolon
id|AscSetIsaDmaSpeed
c_func
(paren
id|iop_base
comma
id|asc_dvc-&gt;cfg-&gt;isa_dma_speed
)paren
suffix:semicolon
)brace
r_return
(paren
id|warn_code
)paren
suffix:semicolon
)brace
id|ushort
DECL|function|AscInitAsc1000Driver
id|AscInitAsc1000Driver
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
)paren
(brace
id|ushort
id|warn_code
suffix:semicolon
id|PortAddr
id|iop_base
suffix:semicolon
r_extern
id|ushort
id|_mcode_size
suffix:semicolon
r_extern
id|ulong
id|_mcode_chksum
suffix:semicolon
r_extern
id|uchar
id|_mcode_buf
(braket
)braket
suffix:semicolon
id|iop_base
op_assign
id|asc_dvc-&gt;iop_base
suffix:semicolon
id|warn_code
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
(paren
id|asc_dvc-&gt;dvc_cntl
op_amp
id|ASC_CNTL_RESET_SCSI
)paren
op_logical_and
op_logical_neg
(paren
id|asc_dvc-&gt;init_state
op_amp
id|ASC_INIT_RESET_SCSI_DONE
)paren
)paren
(brace
id|AscResetChipAndScsiBus
c_func
(paren
id|iop_base
)paren
suffix:semicolon
id|DvcSleepMilliSecond
c_func
(paren
(paren
id|ulong
)paren
(paren
(paren
id|ushort
)paren
id|asc_dvc-&gt;scsi_reset_wait
op_star
l_int|1000
)paren
)paren
suffix:semicolon
)brace
id|asc_dvc-&gt;init_state
op_or_assign
id|ASC_INIT_STATE_BEG_LOAD_MC
suffix:semicolon
r_if
c_cond
(paren
id|asc_dvc-&gt;err_code
op_ne
l_int|0
)paren
r_return
(paren
id|UW_ERR
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|AscFindSignature
c_func
(paren
id|asc_dvc-&gt;iop_base
)paren
)paren
(brace
id|asc_dvc-&gt;err_code
op_assign
id|ASC_IERR_BAD_SIGNATURE
suffix:semicolon
r_return
(paren
id|warn_code
)paren
suffix:semicolon
)brace
id|AscDisableInterrupt
c_func
(paren
id|iop_base
)paren
suffix:semicolon
id|warn_code
op_or_assign
id|AscInitLram
c_func
(paren
id|asc_dvc
)paren
suffix:semicolon
r_if
c_cond
(paren
id|asc_dvc-&gt;err_code
op_ne
l_int|0
)paren
r_return
(paren
id|UW_ERR
)paren
suffix:semicolon
r_if
c_cond
(paren
id|AscLoadMicroCode
c_func
(paren
id|iop_base
comma
l_int|0
comma
(paren
id|ushort
id|dosfar
op_star
)paren
id|_mcode_buf
comma
id|_mcode_size
)paren
op_ne
id|_mcode_chksum
)paren
(brace
id|asc_dvc-&gt;err_code
op_or_assign
id|ASC_IERR_MCODE_CHKSUM
suffix:semicolon
r_return
(paren
id|warn_code
)paren
suffix:semicolon
)brace
id|warn_code
op_or_assign
id|AscInitMicroCodeVar
c_func
(paren
id|asc_dvc
)paren
suffix:semicolon
id|asc_dvc-&gt;init_state
op_or_assign
id|ASC_INIT_STATE_END_LOAD_MC
suffix:semicolon
id|AscEnableInterrupt
c_func
(paren
id|iop_base
)paren
suffix:semicolon
r_return
(paren
id|warn_code
)paren
suffix:semicolon
)brace
id|ushort
DECL|function|AscInitAscDvcVar
id|AscInitAscDvcVar
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
)paren
(brace
r_int
id|i
suffix:semicolon
id|PortAddr
id|iop_base
suffix:semicolon
id|ushort
id|warn_code
suffix:semicolon
id|uchar
id|chip_version
suffix:semicolon
id|iop_base
op_assign
id|asc_dvc-&gt;iop_base
suffix:semicolon
id|warn_code
op_assign
l_int|0
suffix:semicolon
id|asc_dvc-&gt;err_code
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
(paren
id|asc_dvc-&gt;bus_type
op_amp
(paren
id|ASC_IS_ISA
op_or
id|ASC_IS_PCI
op_or
id|ASC_IS_EISA
op_or
id|ASC_IS_VL
)paren
)paren
op_eq
l_int|0
)paren
(brace
id|asc_dvc-&gt;err_code
op_or_assign
id|ASC_IERR_NO_BUS_TYPE
suffix:semicolon
)brace
id|AscSetChipControl
c_func
(paren
id|iop_base
comma
id|CC_HALT
)paren
suffix:semicolon
id|AscSetChipStatus
c_func
(paren
id|iop_base
comma
l_int|0
)paren
suffix:semicolon
macro_line|#if CC_LINK_BUSY_Q
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
id|ASC_MAX_TID
suffix:semicolon
id|i
op_increment
)paren
(brace
id|asc_dvc-&gt;scsiq_busy_head
(braket
id|i
)braket
op_assign
(paren
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
l_int|0L
suffix:semicolon
id|asc_dvc-&gt;scsiq_busy_tail
(braket
id|i
)braket
op_assign
(paren
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
l_int|0L
suffix:semicolon
)brace
macro_line|#endif
id|asc_dvc-&gt;bug_fix_cntl
op_assign
l_int|0
suffix:semicolon
id|asc_dvc-&gt;pci_fix_asyn_xfer
op_assign
l_int|0
suffix:semicolon
id|asc_dvc-&gt;pci_fix_asyn_xfer_always
op_assign
l_int|0
suffix:semicolon
id|asc_dvc-&gt;init_state
op_assign
l_int|0
suffix:semicolon
id|asc_dvc-&gt;sdtr_done
op_assign
l_int|0
suffix:semicolon
id|asc_dvc-&gt;cur_total_qng
op_assign
l_int|0
suffix:semicolon
id|asc_dvc-&gt;is_in_int
op_assign
l_int|0
suffix:semicolon
id|asc_dvc-&gt;in_critical_cnt
op_assign
l_int|0
suffix:semicolon
id|asc_dvc-&gt;last_q_shortage
op_assign
l_int|0
suffix:semicolon
id|asc_dvc-&gt;use_tagged_qng
op_assign
l_int|0
suffix:semicolon
id|asc_dvc-&gt;no_scam
op_assign
l_int|0
suffix:semicolon
id|asc_dvc-&gt;unit_not_ready
op_assign
l_int|0
suffix:semicolon
id|asc_dvc-&gt;queue_full_or_busy
op_assign
l_int|0
suffix:semicolon
id|asc_dvc-&gt;dvc_cntl
op_assign
id|ASC_DEF_DVC_CNTL
suffix:semicolon
id|asc_dvc-&gt;init_sdtr
op_assign
id|ASC_SCSI_WIDTH_BIT_SET
suffix:semicolon
id|asc_dvc-&gt;max_total_qng
op_assign
id|ASC_DEF_MAX_TOTAL_QNG
suffix:semicolon
id|asc_dvc-&gt;scsi_reset_wait
op_assign
l_int|3
suffix:semicolon
id|asc_dvc-&gt;start_motor
op_assign
id|ASC_SCSI_WIDTH_BIT_SET
suffix:semicolon
id|asc_dvc-&gt;max_dma_count
op_assign
id|AscGetMaxDmaCount
c_func
(paren
id|asc_dvc-&gt;bus_type
)paren
suffix:semicolon
id|asc_dvc-&gt;redo_scam
op_assign
l_int|0
suffix:semicolon
id|asc_dvc-&gt;res2
op_assign
l_int|0
suffix:semicolon
id|asc_dvc-&gt;res4
op_assign
l_int|0
suffix:semicolon
id|asc_dvc-&gt;res6
op_assign
l_int|0
suffix:semicolon
id|asc_dvc-&gt;res7
op_assign
l_int|0
suffix:semicolon
id|asc_dvc-&gt;res8
op_assign
l_int|0
suffix:semicolon
id|asc_dvc-&gt;cfg-&gt;disc_enable
op_assign
id|ASC_SCSI_WIDTH_BIT_SET
suffix:semicolon
id|asc_dvc-&gt;cfg-&gt;can_tagged_qng
op_assign
l_int|0
suffix:semicolon
id|asc_dvc-&gt;cfg-&gt;cmd_qng_enabled
op_assign
l_int|0
suffix:semicolon
id|asc_dvc-&gt;cfg-&gt;chip_scsi_id
op_assign
id|ASC_DEF_CHIP_SCSI_ID
suffix:semicolon
id|asc_dvc-&gt;cfg-&gt;lib_serial_no
op_assign
id|ASC_LIB_SERIAL_NUMBER
suffix:semicolon
id|asc_dvc-&gt;cfg-&gt;lib_version
op_assign
(paren
id|ASC_LIB_VERSION_MAJOR
op_lshift
l_int|8
)paren
op_or
id|ASC_LIB_VERSION_MINOR
suffix:semicolon
id|chip_version
op_assign
id|AscGetChipVersion
c_func
(paren
id|iop_base
comma
id|asc_dvc-&gt;bus_type
)paren
suffix:semicolon
id|asc_dvc-&gt;cfg-&gt;chip_version
op_assign
id|chip_version
suffix:semicolon
id|asc_dvc-&gt;sdtr_period_tbl
(braket
l_int|0
)braket
op_assign
id|SYN_XFER_NS_0
suffix:semicolon
id|asc_dvc-&gt;sdtr_period_tbl
(braket
l_int|1
)braket
op_assign
id|SYN_XFER_NS_1
suffix:semicolon
id|asc_dvc-&gt;sdtr_period_tbl
(braket
l_int|2
)braket
op_assign
id|SYN_XFER_NS_2
suffix:semicolon
id|asc_dvc-&gt;sdtr_period_tbl
(braket
l_int|3
)braket
op_assign
id|SYN_XFER_NS_3
suffix:semicolon
id|asc_dvc-&gt;sdtr_period_tbl
(braket
l_int|4
)braket
op_assign
id|SYN_XFER_NS_4
suffix:semicolon
id|asc_dvc-&gt;sdtr_period_tbl
(braket
l_int|5
)braket
op_assign
id|SYN_XFER_NS_5
suffix:semicolon
id|asc_dvc-&gt;sdtr_period_tbl
(braket
l_int|6
)braket
op_assign
id|SYN_XFER_NS_6
suffix:semicolon
id|asc_dvc-&gt;sdtr_period_tbl
(braket
l_int|7
)braket
op_assign
id|SYN_XFER_NS_7
suffix:semicolon
id|asc_dvc-&gt;max_sdtr_index
op_assign
l_int|7
suffix:semicolon
r_if
c_cond
(paren
(paren
id|asc_dvc-&gt;bus_type
op_amp
id|ASC_IS_PCI
)paren
op_logical_and
(paren
id|chip_version
op_ge
id|ASC_CHIP_VER_1ST_PCI_ULTRA
)paren
)paren
(brace
id|asc_dvc-&gt;sdtr_period_tbl
(braket
l_int|0
)braket
op_assign
id|SYN_ULTRA_XFER_NS_0
suffix:semicolon
id|asc_dvc-&gt;sdtr_period_tbl
(braket
l_int|1
)braket
op_assign
id|SYN_ULTRA_XFER_NS_1
suffix:semicolon
id|asc_dvc-&gt;sdtr_period_tbl
(braket
l_int|2
)braket
op_assign
id|SYN_ULTRA_XFER_NS_2
suffix:semicolon
id|asc_dvc-&gt;sdtr_period_tbl
(braket
l_int|3
)braket
op_assign
id|SYN_ULTRA_XFER_NS_3
suffix:semicolon
id|asc_dvc-&gt;sdtr_period_tbl
(braket
l_int|4
)braket
op_assign
id|SYN_ULTRA_XFER_NS_4
suffix:semicolon
id|asc_dvc-&gt;sdtr_period_tbl
(braket
l_int|5
)braket
op_assign
id|SYN_ULTRA_XFER_NS_5
suffix:semicolon
id|asc_dvc-&gt;sdtr_period_tbl
(braket
l_int|6
)braket
op_assign
id|SYN_ULTRA_XFER_NS_6
suffix:semicolon
id|asc_dvc-&gt;sdtr_period_tbl
(braket
l_int|7
)braket
op_assign
id|SYN_ULTRA_XFER_NS_7
suffix:semicolon
id|asc_dvc-&gt;sdtr_period_tbl
(braket
l_int|8
)braket
op_assign
id|SYN_ULTRA_XFER_NS_8
suffix:semicolon
id|asc_dvc-&gt;sdtr_period_tbl
(braket
l_int|9
)braket
op_assign
id|SYN_ULTRA_XFER_NS_9
suffix:semicolon
id|asc_dvc-&gt;sdtr_period_tbl
(braket
l_int|10
)braket
op_assign
id|SYN_ULTRA_XFER_NS_10
suffix:semicolon
id|asc_dvc-&gt;sdtr_period_tbl
(braket
l_int|11
)braket
op_assign
id|SYN_ULTRA_XFER_NS_11
suffix:semicolon
id|asc_dvc-&gt;sdtr_period_tbl
(braket
l_int|12
)braket
op_assign
id|SYN_ULTRA_XFER_NS_12
suffix:semicolon
id|asc_dvc-&gt;sdtr_period_tbl
(braket
l_int|13
)braket
op_assign
id|SYN_ULTRA_XFER_NS_13
suffix:semicolon
id|asc_dvc-&gt;sdtr_period_tbl
(braket
l_int|14
)braket
op_assign
id|SYN_ULTRA_XFER_NS_14
suffix:semicolon
id|asc_dvc-&gt;sdtr_period_tbl
(braket
l_int|15
)braket
op_assign
id|SYN_ULTRA_XFER_NS_15
suffix:semicolon
id|asc_dvc-&gt;max_sdtr_index
op_assign
l_int|15
suffix:semicolon
id|AscSetExtraControl
c_func
(paren
id|iop_base
comma
(paren
id|SEC_ACTIVE_NEGATE
op_or
id|SEC_SLEW_RATE
)paren
)paren
suffix:semicolon
id|asc_dvc-&gt;bus_type
op_assign
id|ASC_IS_PCI_ULTRA
suffix:semicolon
)brace
id|asc_dvc-&gt;cfg-&gt;isa_dma_speed
op_assign
id|ASC_DEF_ISA_DMA_SPEED
suffix:semicolon
r_if
c_cond
(paren
id|AscGetChipBusType
c_func
(paren
id|iop_base
)paren
op_eq
id|ASC_IS_ISAPNP
)paren
(brace
id|AscSetChipIFC
c_func
(paren
id|iop_base
comma
id|IFC_INIT_DEFAULT
)paren
suffix:semicolon
id|asc_dvc-&gt;bus_type
op_assign
id|ASC_IS_ISAPNP
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|asc_dvc-&gt;bus_type
op_amp
id|ASC_IS_ISA
)paren
op_ne
l_int|0
)paren
(brace
id|asc_dvc-&gt;cfg-&gt;isa_dma_channel
op_assign
(paren
id|uchar
)paren
id|AscGetIsaDmaChannel
c_func
(paren
id|iop_base
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
id|ASC_MAX_TID
suffix:semicolon
id|i
op_increment
)paren
(brace
id|asc_dvc-&gt;cur_dvc_qng
(braket
id|i
)braket
op_assign
l_int|0
suffix:semicolon
id|asc_dvc-&gt;max_dvc_qng
(braket
id|i
)braket
op_assign
id|ASC_MAX_SCSI1_QNG
suffix:semicolon
id|asc_dvc-&gt;scsiq_busy_head
(braket
id|i
)braket
op_assign
(paren
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
l_int|0L
suffix:semicolon
id|asc_dvc-&gt;scsiq_busy_tail
(braket
id|i
)braket
op_assign
(paren
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
l_int|0L
suffix:semicolon
id|asc_dvc-&gt;cfg-&gt;max_tag_qng
(braket
id|i
)braket
op_assign
id|ASC_MAX_INRAM_TAG_QNG
suffix:semicolon
id|asc_dvc-&gt;cfg-&gt;sdtr_period_offset
(braket
id|i
)braket
op_assign
(paren
id|uchar
)paren
(paren
id|ASC_DEF_SDTR_OFFSET
op_or
(paren
id|ASC_DEF_SDTR_INDEX
op_lshift
l_int|4
)paren
)paren
suffix:semicolon
)brace
r_return
(paren
id|warn_code
)paren
suffix:semicolon
)brace
macro_line|#if CC_INCLUDE_EEP_CONFIG
id|ushort
DECL|function|AscInitFromEEP
id|AscInitFromEEP
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
)paren
(brace
id|ASCEEP_CONFIG
id|eep_config_buf
suffix:semicolon
id|ASCEEP_CONFIG
id|dosfar
op_star
id|eep_config
suffix:semicolon
id|PortAddr
id|iop_base
suffix:semicolon
id|ushort
id|chksum
suffix:semicolon
id|ushort
id|warn_code
suffix:semicolon
id|ushort
id|cfg_msw
comma
id|cfg_lsw
suffix:semicolon
r_int
id|i
suffix:semicolon
id|iop_base
op_assign
id|asc_dvc-&gt;iop_base
suffix:semicolon
id|warn_code
op_assign
l_int|0
suffix:semicolon
id|AscWriteLramWord
c_func
(paren
id|iop_base
comma
id|ASCV_HALTCODE_W
comma
l_int|0x00FE
)paren
suffix:semicolon
id|AscStopQueueExe
c_func
(paren
id|iop_base
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|AscStopChip
c_func
(paren
id|iop_base
)paren
op_eq
id|FALSE
)paren
op_logical_or
(paren
id|AscGetChipScsiCtrl
c_func
(paren
id|iop_base
)paren
op_ne
l_int|0
)paren
)paren
(brace
id|asc_dvc-&gt;init_state
op_or_assign
id|ASC_INIT_RESET_SCSI_DONE
suffix:semicolon
id|AscResetChipAndScsiBus
c_func
(paren
id|iop_base
)paren
suffix:semicolon
id|DvcSleepMilliSecond
c_func
(paren
(paren
id|ulong
)paren
(paren
(paren
id|ushort
)paren
id|asc_dvc-&gt;scsi_reset_wait
op_star
l_int|1000
)paren
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|AscIsChipHalted
c_func
(paren
id|iop_base
)paren
op_eq
id|FALSE
)paren
(brace
id|asc_dvc-&gt;err_code
op_or_assign
id|ASC_IERR_START_STOP_CHIP
suffix:semicolon
r_return
(paren
id|warn_code
)paren
suffix:semicolon
)brace
id|AscSetPCAddr
c_func
(paren
id|iop_base
comma
id|ASC_MCODE_START_ADDR
)paren
suffix:semicolon
r_if
c_cond
(paren
id|AscGetPCAddr
c_func
(paren
id|iop_base
)paren
op_ne
id|ASC_MCODE_START_ADDR
)paren
(brace
id|asc_dvc-&gt;err_code
op_or_assign
id|ASC_IERR_SET_PC_ADDR
suffix:semicolon
r_return
(paren
id|warn_code
)paren
suffix:semicolon
)brace
id|eep_config
op_assign
(paren
id|ASCEEP_CONFIG
id|dosfar
op_star
)paren
op_amp
id|eep_config_buf
suffix:semicolon
id|cfg_msw
op_assign
id|AscGetChipCfgMsw
c_func
(paren
id|iop_base
)paren
suffix:semicolon
id|cfg_lsw
op_assign
id|AscGetChipCfgLsw
c_func
(paren
id|iop_base
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|cfg_msw
op_amp
id|ASC_CFG_MSW_CLR_MASK
)paren
op_ne
l_int|0
)paren
(brace
id|cfg_msw
op_and_assign
(paren
op_complement
(paren
id|ASC_CFG_MSW_CLR_MASK
)paren
)paren
suffix:semicolon
id|warn_code
op_or_assign
id|ASC_WARN_CFG_MSW_RECOVER
suffix:semicolon
id|AscSetChipCfgMsw
c_func
(paren
id|iop_base
comma
id|cfg_msw
)paren
suffix:semicolon
)brace
id|chksum
op_assign
id|AscGetEEPConfig
c_func
(paren
id|iop_base
comma
id|eep_config
comma
id|asc_dvc-&gt;bus_type
)paren
suffix:semicolon
id|eep_config-&gt;cfg_msw
op_and_assign
(paren
op_complement
(paren
id|ASC_CFG_MSW_CLR_MASK
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|AscGetChipStatus
c_func
(paren
id|iop_base
)paren
op_amp
id|CSW_AUTO_CONFIG
)paren
(brace
id|warn_code
op_or_assign
id|ASC_WARN_AUTO_CONFIG
suffix:semicolon
r_if
c_cond
(paren
id|asc_dvc-&gt;cfg-&gt;chip_version
op_eq
l_int|3
)paren
(brace
r_if
c_cond
(paren
id|eep_config-&gt;cfg_lsw
op_ne
id|cfg_lsw
)paren
(brace
id|warn_code
op_or_assign
id|ASC_WARN_EEPROM_RECOVER
suffix:semicolon
id|eep_config-&gt;cfg_lsw
op_assign
id|AscGetChipCfgLsw
c_func
(paren
id|iop_base
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|eep_config-&gt;cfg_msw
op_ne
id|cfg_msw
)paren
(brace
id|warn_code
op_or_assign
id|ASC_WARN_EEPROM_RECOVER
suffix:semicolon
id|eep_config-&gt;cfg_msw
op_assign
id|AscGetChipCfgMsw
c_func
(paren
id|iop_base
)paren
suffix:semicolon
)brace
)brace
)brace
id|eep_config-&gt;cfg_lsw
op_or_assign
id|ASC_CFG0_HOST_INT_ON
suffix:semicolon
r_if
c_cond
(paren
id|chksum
op_ne
id|eep_config-&gt;chksum
)paren
(brace
id|warn_code
op_or_assign
id|ASC_WARN_EEPROM_CHKSUM
suffix:semicolon
)brace
id|asc_dvc-&gt;init_sdtr
op_assign
id|eep_config-&gt;init_sdtr
suffix:semicolon
id|asc_dvc-&gt;cfg-&gt;disc_enable
op_assign
id|eep_config-&gt;disc_enable
suffix:semicolon
id|asc_dvc-&gt;cfg-&gt;cmd_qng_enabled
op_assign
id|eep_config-&gt;use_cmd_qng
suffix:semicolon
id|asc_dvc-&gt;cfg-&gt;isa_dma_speed
op_assign
id|eep_config-&gt;isa_dma_speed
suffix:semicolon
id|asc_dvc-&gt;start_motor
op_assign
id|eep_config-&gt;start_motor
suffix:semicolon
id|asc_dvc-&gt;dvc_cntl
op_assign
id|eep_config-&gt;cntl
suffix:semicolon
id|asc_dvc-&gt;no_scam
op_assign
id|eep_config-&gt;no_scam
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|AscTestExternalLram
c_func
(paren
id|asc_dvc
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
(paren
id|asc_dvc-&gt;bus_type
op_amp
id|ASC_IS_PCI_ULTRA
)paren
op_eq
id|ASC_IS_PCI_ULTRA
)paren
)paren
(brace
id|eep_config-&gt;max_total_qng
op_assign
id|ASC_MAX_PCI_ULTRA_INRAM_TOTAL_QNG
suffix:semicolon
id|eep_config-&gt;max_tag_qng
op_assign
id|ASC_MAX_PCI_ULTRA_INRAM_TAG_QNG
suffix:semicolon
)brace
r_else
(brace
id|eep_config-&gt;cfg_msw
op_or_assign
l_int|0x0800
suffix:semicolon
id|cfg_msw
op_or_assign
l_int|0x0800
suffix:semicolon
id|AscSetChipCfgMsw
c_func
(paren
id|iop_base
comma
id|cfg_msw
)paren
suffix:semicolon
id|eep_config-&gt;max_total_qng
op_assign
id|ASC_MAX_PCI_INRAM_TOTAL_QNG
suffix:semicolon
id|eep_config-&gt;max_tag_qng
op_assign
id|ASC_MAX_INRAM_TAG_QNG
suffix:semicolon
)brace
)brace
r_else
(brace
)brace
r_if
c_cond
(paren
id|eep_config-&gt;max_total_qng
OL
id|ASC_MIN_TOTAL_QNG
)paren
(brace
id|eep_config-&gt;max_total_qng
op_assign
id|ASC_MIN_TOTAL_QNG
suffix:semicolon
)brace
r_if
c_cond
(paren
id|eep_config-&gt;max_total_qng
OG
id|ASC_MAX_TOTAL_QNG
)paren
(brace
id|eep_config-&gt;max_total_qng
op_assign
id|ASC_MAX_TOTAL_QNG
suffix:semicolon
)brace
r_if
c_cond
(paren
id|eep_config-&gt;max_tag_qng
OG
id|eep_config-&gt;max_total_qng
)paren
(brace
id|eep_config-&gt;max_tag_qng
op_assign
id|eep_config-&gt;max_total_qng
suffix:semicolon
)brace
r_if
c_cond
(paren
id|eep_config-&gt;max_tag_qng
OL
id|ASC_MIN_TAG_Q_PER_DVC
)paren
(brace
id|eep_config-&gt;max_tag_qng
op_assign
id|ASC_MIN_TAG_Q_PER_DVC
suffix:semicolon
)brace
id|asc_dvc-&gt;max_total_qng
op_assign
id|eep_config-&gt;max_total_qng
suffix:semicolon
r_if
c_cond
(paren
(paren
id|eep_config-&gt;use_cmd_qng
op_amp
id|eep_config-&gt;disc_enable
)paren
op_ne
id|eep_config-&gt;use_cmd_qng
)paren
(brace
id|eep_config-&gt;disc_enable
op_assign
id|eep_config-&gt;use_cmd_qng
suffix:semicolon
id|warn_code
op_or_assign
id|ASC_WARN_CMD_QNG_CONFLICT
suffix:semicolon
)brace
r_if
c_cond
(paren
id|asc_dvc-&gt;bus_type
op_amp
(paren
id|ASC_IS_ISA
op_or
id|ASC_IS_VL
op_or
id|ASC_IS_EISA
)paren
)paren
(brace
id|asc_dvc-&gt;irq_no
op_assign
id|AscGetChipIRQ
c_func
(paren
id|iop_base
comma
id|asc_dvc-&gt;bus_type
)paren
suffix:semicolon
)brace
id|eep_config-&gt;chip_scsi_id
op_and_assign
id|ASC_MAX_TID
suffix:semicolon
id|asc_dvc-&gt;cfg-&gt;chip_scsi_id
op_assign
id|eep_config-&gt;chip_scsi_id
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
id|ASC_MAX_TID
suffix:semicolon
id|i
op_increment
)paren
(brace
macro_line|#if CC_TMP_USE_EEP_SDTR
id|asc_dvc-&gt;cfg-&gt;sdtr_period_offset
(braket
id|i
)braket
op_assign
id|eep_config-&gt;dos_int13_table
(braket
id|i
)braket
suffix:semicolon
macro_line|#endif
id|asc_dvc-&gt;dos_int13_table
(braket
id|i
)braket
op_assign
id|eep_config-&gt;dos_int13_table
(braket
id|i
)braket
suffix:semicolon
id|asc_dvc-&gt;cfg-&gt;max_tag_qng
(braket
id|i
)braket
op_assign
id|eep_config-&gt;max_tag_qng
suffix:semicolon
)brace
id|eep_config-&gt;cfg_msw
op_assign
id|AscGetChipCfgMsw
c_func
(paren
id|iop_base
)paren
suffix:semicolon
macro_line|#if CC_CHK_FIX_EEP_CONTENT
r_if
c_cond
(paren
id|AscSetEEPConfig
c_func
(paren
id|iop_base
comma
id|eep_config
comma
id|asc_dvc-&gt;bus_type
)paren
op_ne
l_int|0
)paren
(brace
id|asc_dvc-&gt;err_code
op_or_assign
id|ASC_IERR_WRITE_EEPROM
suffix:semicolon
)brace
macro_line|#endif
r_return
(paren
id|warn_code
)paren
suffix:semicolon
)brace
macro_line|#endif
id|ushort
DECL|function|AscInitWithoutEEP
id|AscInitWithoutEEP
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
)paren
(brace
id|PortAddr
id|iop_base
suffix:semicolon
id|ushort
id|warn_code
suffix:semicolon
id|ushort
id|cfg_msw
suffix:semicolon
id|iop_base
op_assign
id|asc_dvc-&gt;iop_base
suffix:semicolon
id|warn_code
op_assign
l_int|0
suffix:semicolon
id|cfg_msw
op_assign
id|AscGetChipCfgMsw
c_func
(paren
id|iop_base
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|cfg_msw
op_amp
id|ASC_CFG_MSW_CLR_MASK
)paren
op_ne
l_int|0
)paren
(brace
id|cfg_msw
op_and_assign
(paren
op_complement
(paren
id|ASC_CFG_MSW_CLR_MASK
)paren
)paren
suffix:semicolon
id|warn_code
op_or_assign
id|ASC_WARN_CFG_MSW_RECOVER
suffix:semicolon
id|AscSetChipCfgMsw
c_func
(paren
id|iop_base
comma
id|cfg_msw
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|AscTestExternalLram
c_func
(paren
id|asc_dvc
)paren
)paren
(brace
r_if
c_cond
(paren
id|asc_dvc-&gt;bus_type
op_amp
id|ASC_IS_PCI
)paren
(brace
id|cfg_msw
op_or_assign
l_int|0x0800
suffix:semicolon
id|AscSetChipCfgMsw
c_func
(paren
id|iop_base
comma
id|cfg_msw
)paren
suffix:semicolon
id|asc_dvc-&gt;max_total_qng
op_assign
id|ASC_MAX_PCI_INRAM_TOTAL_QNG
suffix:semicolon
)brace
)brace
r_else
(brace
)brace
r_if
c_cond
(paren
id|asc_dvc-&gt;bus_type
op_amp
(paren
id|ASC_IS_ISA
op_or
id|ASC_IS_VL
op_or
id|ASC_IS_EISA
)paren
)paren
(brace
id|asc_dvc-&gt;irq_no
op_assign
id|AscGetChipIRQ
c_func
(paren
id|iop_base
comma
id|asc_dvc-&gt;bus_type
)paren
suffix:semicolon
)brace
r_return
(paren
id|warn_code
)paren
suffix:semicolon
)brace
id|ushort
DECL|function|AscInitMicroCodeVar
id|AscInitMicroCodeVar
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
)paren
(brace
r_int
id|i
suffix:semicolon
id|ushort
id|warn_code
suffix:semicolon
id|PortAddr
id|iop_base
suffix:semicolon
id|ulong
id|phy_addr
suffix:semicolon
id|iop_base
op_assign
id|asc_dvc-&gt;iop_base
suffix:semicolon
id|warn_code
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
id|ASC_MAX_TID
suffix:semicolon
id|i
op_increment
)paren
(brace
id|AscPutMCodeInitSDTRAtID
c_func
(paren
id|iop_base
comma
id|i
comma
id|asc_dvc-&gt;cfg-&gt;sdtr_period_offset
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
id|AscInitQLinkVar
c_func
(paren
id|asc_dvc
)paren
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
id|ASCV_DISC_ENABLE_B
comma
id|asc_dvc-&gt;cfg-&gt;disc_enable
)paren
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
id|ASCV_HOSTSCSI_ID_B
comma
id|ASC_TID_TO_TARGET_ID
c_func
(paren
id|asc_dvc-&gt;cfg-&gt;chip_scsi_id
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|phy_addr
op_assign
id|AscGetOnePhyAddr
c_func
(paren
id|asc_dvc
comma
(paren
id|uchar
id|dosfar
op_star
)paren
id|asc_dvc-&gt;cfg-&gt;overrun_buf
comma
id|ASC_OVERRUN_BSIZE
)paren
)paren
op_eq
l_int|0L
)paren
(brace
id|asc_dvc-&gt;err_code
op_or_assign
id|ASC_IERR_GET_PHY_ADDR
suffix:semicolon
)brace
r_else
(brace
id|phy_addr
op_assign
(paren
id|phy_addr
op_amp
l_int|0xFFFFFFF8UL
)paren
op_plus
l_int|8
suffix:semicolon
id|AscWriteLramDWord
c_func
(paren
id|iop_base
comma
id|ASCV_OVERRUN_PADDR_D
comma
id|phy_addr
)paren
suffix:semicolon
id|AscWriteLramDWord
c_func
(paren
id|iop_base
comma
id|ASCV_OVERRUN_BSIZE_D
comma
id|ASC_OVERRUN_BSIZE
op_minus
l_int|8
)paren
suffix:semicolon
)brace
id|asc_dvc-&gt;cfg-&gt;mcode_date
op_assign
id|AscReadLramWord
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
id|ASCV_MC_DATE_W
)paren
suffix:semicolon
id|asc_dvc-&gt;cfg-&gt;mcode_version
op_assign
id|AscReadLramWord
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
id|ASCV_MC_VER_W
)paren
suffix:semicolon
id|AscSetPCAddr
c_func
(paren
id|iop_base
comma
id|ASC_MCODE_START_ADDR
)paren
suffix:semicolon
r_if
c_cond
(paren
id|AscGetPCAddr
c_func
(paren
id|iop_base
)paren
op_ne
id|ASC_MCODE_START_ADDR
)paren
(brace
id|asc_dvc-&gt;err_code
op_or_assign
id|ASC_IERR_SET_PC_ADDR
suffix:semicolon
r_return
(paren
id|warn_code
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|AscStartChip
c_func
(paren
id|iop_base
)paren
op_ne
l_int|1
)paren
(brace
id|asc_dvc-&gt;err_code
op_or_assign
id|ASC_IERR_START_STOP_CHIP
suffix:semicolon
r_return
(paren
id|warn_code
)paren
suffix:semicolon
)brace
r_return
(paren
id|warn_code
)paren
suffix:semicolon
)brace
r_void
id|dosfar
DECL|function|AscInitPollIsrCallBack
id|AscInitPollIsrCallBack
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|ASC_QDONE_INFO
id|dosfar
op_star
id|scsi_done_q
)paren
(brace
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
id|scsiq_req
suffix:semicolon
id|ASC_ISR_CALLBACK
id|asc_isr_callback
suffix:semicolon
id|uchar
id|cp_sen_len
suffix:semicolon
id|uchar
id|i
suffix:semicolon
r_if
c_cond
(paren
(paren
id|scsi_done_q-&gt;d2.flag
op_amp
id|ASC_FLAG_SCSIQ_REQ
)paren
op_ne
l_int|0
)paren
(brace
id|scsiq_req
op_assign
(paren
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
)paren
id|scsi_done_q-&gt;d2.srb_ptr
suffix:semicolon
id|scsiq_req-&gt;r3.done_stat
op_assign
id|scsi_done_q-&gt;d3.done_stat
suffix:semicolon
id|scsiq_req-&gt;r3.host_stat
op_assign
id|scsi_done_q-&gt;d3.host_stat
suffix:semicolon
id|scsiq_req-&gt;r3.scsi_stat
op_assign
id|scsi_done_q-&gt;d3.scsi_stat
suffix:semicolon
id|scsiq_req-&gt;r3.scsi_msg
op_assign
id|scsi_done_q-&gt;d3.scsi_msg
suffix:semicolon
r_if
c_cond
(paren
(paren
id|scsi_done_q-&gt;d3.scsi_stat
op_eq
id|SS_CHK_CONDITION
)paren
op_logical_and
(paren
id|scsi_done_q-&gt;d3.host_stat
op_eq
l_int|0
)paren
)paren
(brace
id|cp_sen_len
op_assign
(paren
id|uchar
)paren
id|ASC_MIN_SENSE_LEN
suffix:semicolon
r_if
c_cond
(paren
id|scsiq_req-&gt;r1.sense_len
OL
id|ASC_MIN_SENSE_LEN
)paren
(brace
id|cp_sen_len
op_assign
(paren
id|uchar
)paren
id|scsiq_req-&gt;r1.sense_len
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|cp_sen_len
suffix:semicolon
id|i
op_increment
)paren
(brace
id|scsiq_req-&gt;sense
(braket
id|i
)braket
op_assign
id|scsiq_req-&gt;sense_ptr
(braket
id|i
)braket
suffix:semicolon
)brace
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|asc_dvc-&gt;isr_callback
op_ne
l_int|0
)paren
(brace
id|asc_isr_callback
op_assign
(paren
id|ASC_ISR_CALLBACK
)paren
id|asc_dvc-&gt;isr_callback
suffix:semicolon
(paren
op_star
id|asc_isr_callback
)paren
(paren
id|asc_dvc
comma
id|scsi_done_q
)paren
suffix:semicolon
)brace
)brace
r_return
suffix:semicolon
)brace
r_int
DECL|function|AscTestExternalLram
id|AscTestExternalLram
c_func
(paren
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
)paren
(brace
id|PortAddr
id|iop_base
suffix:semicolon
id|ushort
id|q_addr
suffix:semicolon
id|ushort
id|saved_word
suffix:semicolon
r_int
id|sta
suffix:semicolon
id|iop_base
op_assign
id|asc_dvc-&gt;iop_base
suffix:semicolon
id|sta
op_assign
l_int|0
suffix:semicolon
id|q_addr
op_assign
id|ASC_QNO_TO_QADDR
c_func
(paren
l_int|241
)paren
suffix:semicolon
id|saved_word
op_assign
id|AscReadLramWord
c_func
(paren
id|iop_base
comma
id|q_addr
)paren
suffix:semicolon
id|AscSetChipLramAddr
c_func
(paren
id|iop_base
comma
id|q_addr
)paren
suffix:semicolon
id|AscSetChipLramData
c_func
(paren
id|iop_base
comma
l_int|0x55AA
)paren
suffix:semicolon
id|DvcSleepMilliSecond
c_func
(paren
l_int|10
)paren
suffix:semicolon
id|AscSetChipLramAddr
c_func
(paren
id|iop_base
comma
id|q_addr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|AscGetChipLramData
c_func
(paren
id|iop_base
)paren
op_eq
l_int|0x55AA
)paren
(brace
id|sta
op_assign
l_int|1
suffix:semicolon
id|AscWriteLramWord
c_func
(paren
id|iop_base
comma
id|q_addr
comma
id|saved_word
)paren
suffix:semicolon
)brace
r_return
(paren
id|sta
)paren
suffix:semicolon
)brace
macro_line|#if CC_INCLUDE_EEP_CONFIG
r_int
DECL|function|AscWriteEEPCmdReg
id|AscWriteEEPCmdReg
c_func
(paren
id|PortAddr
id|iop_base
comma
id|uchar
id|cmd_reg
)paren
(brace
id|uchar
id|read_back
suffix:semicolon
r_int
id|retry
suffix:semicolon
id|retry
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|TRUE
)paren
(brace
id|AscSetChipEEPCmd
c_func
(paren
id|iop_base
comma
id|cmd_reg
)paren
suffix:semicolon
id|DvcSleepMilliSecond
c_func
(paren
l_int|1
)paren
suffix:semicolon
id|read_back
op_assign
id|AscGetChipEEPCmd
c_func
(paren
id|iop_base
)paren
suffix:semicolon
r_if
c_cond
(paren
id|read_back
op_eq
id|cmd_reg
)paren
(brace
r_return
(paren
l_int|1
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|retry
op_increment
OG
id|ASC_EEP_MAX_RETRY
)paren
(brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
)brace
)brace
r_int
DECL|function|AscWriteEEPDataReg
id|AscWriteEEPDataReg
c_func
(paren
id|PortAddr
id|iop_base
comma
id|ushort
id|data_reg
)paren
(brace
id|ushort
id|read_back
suffix:semicolon
r_int
id|retry
suffix:semicolon
id|retry
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|TRUE
)paren
(brace
id|AscSetChipEEPData
c_func
(paren
id|iop_base
comma
id|data_reg
)paren
suffix:semicolon
id|DvcSleepMilliSecond
c_func
(paren
l_int|1
)paren
suffix:semicolon
id|read_back
op_assign
id|AscGetChipEEPData
c_func
(paren
id|iop_base
)paren
suffix:semicolon
r_if
c_cond
(paren
id|read_back
op_eq
id|data_reg
)paren
(brace
r_return
(paren
l_int|1
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|retry
op_increment
OG
id|ASC_EEP_MAX_RETRY
)paren
(brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
)brace
)brace
r_void
DECL|function|AscWaitEEPRead
id|AscWaitEEPRead
c_func
(paren
r_void
)paren
(brace
id|DvcSleepMilliSecond
c_func
(paren
l_int|1
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_void
DECL|function|AscWaitEEPWrite
id|AscWaitEEPWrite
c_func
(paren
r_void
)paren
(brace
id|DvcSleepMilliSecond
c_func
(paren
l_int|20
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|ushort
DECL|function|AscReadEEPWord
id|AscReadEEPWord
c_func
(paren
id|PortAddr
id|iop_base
comma
id|uchar
id|addr
)paren
(brace
id|ushort
id|read_wval
suffix:semicolon
id|uchar
id|cmd_reg
suffix:semicolon
id|AscWriteEEPCmdReg
c_func
(paren
id|iop_base
comma
id|ASC_EEP_CMD_WRITE_DISABLE
)paren
suffix:semicolon
id|AscWaitEEPRead
c_func
(paren
)paren
suffix:semicolon
id|cmd_reg
op_assign
id|addr
op_or
id|ASC_EEP_CMD_READ
suffix:semicolon
id|AscWriteEEPCmdReg
c_func
(paren
id|iop_base
comma
id|cmd_reg
)paren
suffix:semicolon
id|AscWaitEEPRead
c_func
(paren
)paren
suffix:semicolon
id|read_wval
op_assign
id|AscGetChipEEPData
c_func
(paren
id|iop_base
)paren
suffix:semicolon
id|AscWaitEEPRead
c_func
(paren
)paren
suffix:semicolon
r_return
(paren
id|read_wval
)paren
suffix:semicolon
)brace
id|ushort
DECL|function|AscWriteEEPWord
id|AscWriteEEPWord
c_func
(paren
id|PortAddr
id|iop_base
comma
id|uchar
id|addr
comma
id|ushort
id|word_val
)paren
(brace
id|ushort
id|read_wval
suffix:semicolon
id|read_wval
op_assign
id|AscReadEEPWord
c_func
(paren
id|iop_base
comma
id|addr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|read_wval
op_ne
id|word_val
)paren
(brace
id|AscWriteEEPCmdReg
c_func
(paren
id|iop_base
comma
id|ASC_EEP_CMD_WRITE_ABLE
)paren
suffix:semicolon
id|AscWaitEEPRead
c_func
(paren
)paren
suffix:semicolon
id|AscWriteEEPDataReg
c_func
(paren
id|iop_base
comma
id|word_val
)paren
suffix:semicolon
id|AscWaitEEPRead
c_func
(paren
)paren
suffix:semicolon
id|AscWriteEEPCmdReg
c_func
(paren
id|iop_base
comma
(paren
id|uchar
)paren
(paren
(paren
id|uchar
)paren
id|ASC_EEP_CMD_WRITE
op_or
id|addr
)paren
)paren
suffix:semicolon
id|AscWaitEEPWrite
c_func
(paren
)paren
suffix:semicolon
id|AscWriteEEPCmdReg
c_func
(paren
id|iop_base
comma
id|ASC_EEP_CMD_WRITE_DISABLE
)paren
suffix:semicolon
id|AscWaitEEPRead
c_func
(paren
)paren
suffix:semicolon
r_return
(paren
id|AscReadEEPWord
c_func
(paren
id|iop_base
comma
id|addr
)paren
)paren
suffix:semicolon
)brace
r_return
(paren
id|read_wval
)paren
suffix:semicolon
)brace
id|ushort
DECL|function|AscGetEEPConfig
id|AscGetEEPConfig
c_func
(paren
id|PortAddr
id|iop_base
comma
id|ASCEEP_CONFIG
id|dosfar
op_star
id|cfg_buf
comma
id|ushort
id|bus_type
)paren
(brace
id|ushort
id|wval
suffix:semicolon
id|ushort
id|sum
suffix:semicolon
id|ushort
id|dosfar
op_star
id|wbuf
suffix:semicolon
r_int
id|cfg_beg
suffix:semicolon
r_int
id|cfg_end
suffix:semicolon
r_int
id|s_addr
suffix:semicolon
r_int
id|isa_pnp_wsize
suffix:semicolon
id|wbuf
op_assign
(paren
id|ushort
id|dosfar
op_star
)paren
id|cfg_buf
suffix:semicolon
id|sum
op_assign
l_int|0
suffix:semicolon
id|isa_pnp_wsize
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|s_addr
op_assign
l_int|0
suffix:semicolon
id|s_addr
OL
(paren
l_int|2
op_plus
id|isa_pnp_wsize
)paren
suffix:semicolon
id|s_addr
op_increment
comma
id|wbuf
op_increment
)paren
(brace
id|wval
op_assign
id|AscReadEEPWord
c_func
(paren
id|iop_base
comma
(paren
id|uchar
)paren
id|s_addr
)paren
suffix:semicolon
id|sum
op_add_assign
id|wval
suffix:semicolon
op_star
id|wbuf
op_assign
id|wval
suffix:semicolon
)brace
r_if
c_cond
(paren
id|bus_type
op_amp
id|ASC_IS_VL
)paren
(brace
id|cfg_beg
op_assign
id|ASC_EEP_DVC_CFG_BEG_VL
suffix:semicolon
id|cfg_end
op_assign
id|ASC_EEP_MAX_DVC_ADDR_VL
suffix:semicolon
)brace
r_else
(brace
id|cfg_beg
op_assign
id|ASC_EEP_DVC_CFG_BEG
suffix:semicolon
id|cfg_end
op_assign
id|ASC_EEP_MAX_DVC_ADDR
suffix:semicolon
)brace
r_for
c_loop
(paren
id|s_addr
op_assign
id|cfg_beg
suffix:semicolon
id|s_addr
op_le
(paren
id|cfg_end
op_minus
l_int|1
)paren
suffix:semicolon
id|s_addr
op_increment
comma
id|wbuf
op_increment
)paren
(brace
id|wval
op_assign
id|AscReadEEPWord
c_func
(paren
id|iop_base
comma
(paren
id|uchar
)paren
id|s_addr
)paren
suffix:semicolon
id|sum
op_add_assign
id|wval
suffix:semicolon
op_star
id|wbuf
op_assign
id|wval
suffix:semicolon
)brace
op_star
id|wbuf
op_assign
id|AscReadEEPWord
c_func
(paren
id|iop_base
comma
(paren
id|uchar
)paren
id|s_addr
)paren
suffix:semicolon
r_return
(paren
id|sum
)paren
suffix:semicolon
)brace
macro_line|#if CC_CHK_FIX_EEP_CONTENT
r_int
DECL|function|AscSetEEPConfigOnce
id|AscSetEEPConfigOnce
c_func
(paren
id|PortAddr
id|iop_base
comma
id|ASCEEP_CONFIG
id|dosfar
op_star
id|cfg_buf
comma
id|ushort
id|bus_type
)paren
(brace
r_int
id|n_error
suffix:semicolon
id|ushort
id|dosfar
op_star
id|wbuf
suffix:semicolon
id|ushort
id|sum
suffix:semicolon
r_int
id|s_addr
suffix:semicolon
r_int
id|cfg_beg
suffix:semicolon
r_int
id|cfg_end
suffix:semicolon
id|wbuf
op_assign
(paren
id|ushort
id|dosfar
op_star
)paren
id|cfg_buf
suffix:semicolon
id|n_error
op_assign
l_int|0
suffix:semicolon
id|sum
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|s_addr
op_assign
l_int|0
suffix:semicolon
id|s_addr
OL
l_int|2
suffix:semicolon
id|s_addr
op_increment
comma
id|wbuf
op_increment
)paren
(brace
id|sum
op_add_assign
op_star
id|wbuf
suffix:semicolon
r_if
c_cond
(paren
op_star
id|wbuf
op_ne
id|AscWriteEEPWord
c_func
(paren
id|iop_base
comma
(paren
id|uchar
)paren
id|s_addr
comma
op_star
id|wbuf
)paren
)paren
(brace
id|n_error
op_increment
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|bus_type
op_amp
id|ASC_IS_VL
)paren
(brace
id|cfg_beg
op_assign
id|ASC_EEP_DVC_CFG_BEG_VL
suffix:semicolon
id|cfg_end
op_assign
id|ASC_EEP_MAX_DVC_ADDR_VL
suffix:semicolon
)brace
r_else
(brace
id|cfg_beg
op_assign
id|ASC_EEP_DVC_CFG_BEG
suffix:semicolon
id|cfg_end
op_assign
id|ASC_EEP_MAX_DVC_ADDR
suffix:semicolon
)brace
r_for
c_loop
(paren
id|s_addr
op_assign
id|cfg_beg
suffix:semicolon
id|s_addr
op_le
(paren
id|cfg_end
op_minus
l_int|1
)paren
suffix:semicolon
id|s_addr
op_increment
comma
id|wbuf
op_increment
)paren
(brace
id|sum
op_add_assign
op_star
id|wbuf
suffix:semicolon
r_if
c_cond
(paren
op_star
id|wbuf
op_ne
id|AscWriteEEPWord
c_func
(paren
id|iop_base
comma
(paren
id|uchar
)paren
id|s_addr
comma
op_star
id|wbuf
)paren
)paren
(brace
id|n_error
op_increment
suffix:semicolon
)brace
)brace
op_star
id|wbuf
op_assign
id|sum
suffix:semicolon
r_if
c_cond
(paren
id|sum
op_ne
id|AscWriteEEPWord
c_func
(paren
id|iop_base
comma
(paren
id|uchar
)paren
id|s_addr
comma
id|sum
)paren
)paren
(brace
id|n_error
op_increment
suffix:semicolon
)brace
id|wbuf
op_assign
(paren
id|ushort
id|dosfar
op_star
)paren
id|cfg_buf
suffix:semicolon
r_for
c_loop
(paren
id|s_addr
op_assign
l_int|0
suffix:semicolon
id|s_addr
OL
l_int|2
suffix:semicolon
id|s_addr
op_increment
comma
id|wbuf
op_increment
)paren
(brace
r_if
c_cond
(paren
op_star
id|wbuf
op_ne
id|AscReadEEPWord
c_func
(paren
id|iop_base
comma
(paren
id|uchar
)paren
id|s_addr
)paren
)paren
(brace
id|n_error
op_increment
suffix:semicolon
)brace
)brace
r_for
c_loop
(paren
id|s_addr
op_assign
id|cfg_beg
suffix:semicolon
id|s_addr
op_le
id|cfg_end
suffix:semicolon
id|s_addr
op_increment
comma
id|wbuf
op_increment
)paren
(brace
r_if
c_cond
(paren
op_star
id|wbuf
op_ne
id|AscReadEEPWord
c_func
(paren
id|iop_base
comma
(paren
id|uchar
)paren
id|s_addr
)paren
)paren
(brace
id|n_error
op_increment
suffix:semicolon
)brace
)brace
r_return
(paren
id|n_error
)paren
suffix:semicolon
)brace
r_int
DECL|function|AscSetEEPConfig
id|AscSetEEPConfig
c_func
(paren
id|PortAddr
id|iop_base
comma
id|ASCEEP_CONFIG
id|dosfar
op_star
id|cfg_buf
comma
id|ushort
id|bus_type
)paren
(brace
r_int
id|retry
suffix:semicolon
r_int
id|n_error
suffix:semicolon
id|retry
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|TRUE
)paren
(brace
r_if
c_cond
(paren
(paren
id|n_error
op_assign
id|AscSetEEPConfigOnce
c_func
(paren
id|iop_base
comma
id|cfg_buf
comma
id|bus_type
)paren
)paren
op_eq
l_int|0
)paren
(brace
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
op_increment
id|retry
OG
id|ASC_EEP_MAX_RETRY
)paren
(brace
r_break
suffix:semicolon
)brace
)brace
r_return
(paren
id|n_error
)paren
suffix:semicolon
)brace
macro_line|#endif
macro_line|#endif
r_int
DECL|function|AscInitPollBegin
id|AscInitPollBegin
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
)paren
(brace
id|PortAddr
id|iop_base
suffix:semicolon
id|iop_base
op_assign
id|asc_dvc-&gt;iop_base
suffix:semicolon
macro_line|#if CC_INIT_INQ_DISPLAY
id|DvcDisplayString
c_func
(paren
(paren
id|uchar
id|dosfar
op_star
)paren
l_string|&quot;&bslash;r&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#endif
id|AscDisableInterrupt
c_func
(paren
id|iop_base
)paren
suffix:semicolon
id|asc_dvc-&gt;init_state
op_or_assign
id|ASC_INIT_STATE_BEG_INQUIRY
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
id|ASCV_DISC_ENABLE_B
comma
l_int|0x00
)paren
suffix:semicolon
id|asc_dvc-&gt;use_tagged_qng
op_assign
l_int|0
suffix:semicolon
id|asc_dvc-&gt;cfg-&gt;can_tagged_qng
op_assign
l_int|0
suffix:semicolon
id|asc_dvc-&gt;saved_ptr2func
op_assign
(paren
id|ulong
)paren
id|asc_dvc-&gt;isr_callback
suffix:semicolon
id|asc_dvc-&gt;isr_callback
op_assign
id|ASC_GET_PTR2FUNC
c_func
(paren
id|AscInitPollIsrCallBack
)paren
suffix:semicolon
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_int
DECL|function|AscInitPollEnd
id|AscInitPollEnd
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
)paren
(brace
id|PortAddr
id|iop_base
suffix:semicolon
id|rint
id|i
suffix:semicolon
id|iop_base
op_assign
id|asc_dvc-&gt;iop_base
suffix:semicolon
id|asc_dvc-&gt;isr_callback
op_assign
(paren
id|Ptr2Func
)paren
id|asc_dvc-&gt;saved_ptr2func
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
id|ASCV_DISC_ENABLE_B
comma
id|asc_dvc-&gt;cfg-&gt;disc_enable
)paren
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
id|ASCV_USE_TAGGED_QNG_B
comma
id|asc_dvc-&gt;use_tagged_qng
)paren
suffix:semicolon
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
id|ASCV_CAN_TAGGED_QNG_B
comma
id|asc_dvc-&gt;cfg-&gt;can_tagged_qng
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
id|ASC_MAX_TID
suffix:semicolon
id|i
op_increment
)paren
(brace
id|AscWriteLramByte
c_func
(paren
id|iop_base
comma
(paren
id|ushort
)paren
(paren
(paren
id|ushort
)paren
id|ASCV_MAX_DVC_QNG_BEG
op_plus
(paren
id|ushort
)paren
id|i
)paren
comma
id|asc_dvc-&gt;max_dvc_qng
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
id|AscAckInterrupt
c_func
(paren
id|iop_base
)paren
suffix:semicolon
id|AscEnableInterrupt
c_func
(paren
id|iop_base
)paren
suffix:semicolon
macro_line|#if CC_INIT_INQ_DISPLAY
id|DvcDisplayString
c_func
(paren
(paren
id|uchar
id|dosfar
op_star
)paren
l_string|&quot;&bslash;r&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#endif
id|asc_dvc-&gt;init_state
op_or_assign
id|ASC_INIT_STATE_END_INQUIRY
suffix:semicolon
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
DECL|variable|_asc_wait_slow_device_
r_int
id|_asc_wait_slow_device_
op_assign
id|FALSE
suffix:semicolon
r_int
DECL|function|AscInitPollTarget
id|AscInitPollTarget
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|REG
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
id|scsiq
comma
id|REG
id|ASC_SCSI_INQUIRY
id|dosfar
op_star
id|inq
comma
id|REG
id|ASC_CAP_INFO
id|dosfar
op_star
id|cap_info
)paren
(brace
id|uchar
id|tid_no
comma
id|lun
suffix:semicolon
id|uchar
id|dvc_type
suffix:semicolon
id|ASC_SCSI_BIT_ID_TYPE
id|tid_bits
suffix:semicolon
r_int
id|dvc_found
suffix:semicolon
r_int
id|support_read_cap
suffix:semicolon
r_int
id|tmp_disable_init_sdtr
suffix:semicolon
r_int
id|sta
suffix:semicolon
id|ulong
id|phy_addr
suffix:semicolon
id|dvc_found
op_assign
l_int|0
suffix:semicolon
id|tmp_disable_init_sdtr
op_assign
id|FALSE
suffix:semicolon
id|tid_bits
op_assign
id|scsiq-&gt;r1.target_id
suffix:semicolon
id|lun
op_assign
id|scsiq-&gt;r1.target_lun
suffix:semicolon
id|tid_no
op_assign
id|ASC_TIX_TO_TID
c_func
(paren
id|scsiq-&gt;r2.target_ix
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|phy_addr
op_assign
id|AscGetOnePhyAddr
c_func
(paren
id|asc_dvc
comma
(paren
id|uchar
id|dosfar
op_star
)paren
id|scsiq-&gt;sense_ptr
comma
(paren
id|ulong
)paren
id|scsiq-&gt;r1.sense_len
)paren
)paren
op_eq
l_int|0L
)paren
(brace
r_return
(paren
id|ERR
)paren
suffix:semicolon
)brace
id|scsiq-&gt;r1.sense_addr
op_assign
id|phy_addr
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
id|asc_dvc-&gt;init_sdtr
op_amp
id|tid_bits
)paren
op_ne
l_int|0
)paren
op_logical_and
(paren
(paren
id|asc_dvc-&gt;sdtr_done
op_amp
id|tid_bits
)paren
op_eq
l_int|0
)paren
)paren
(brace
id|asc_dvc-&gt;init_sdtr
op_and_assign
op_complement
id|tid_bits
suffix:semicolon
id|tmp_disable_init_sdtr
op_assign
id|TRUE
suffix:semicolon
)brace
r_if
c_cond
(paren
id|PollScsiInquiry
c_func
(paren
id|asc_dvc
comma
id|scsiq
comma
(paren
id|uchar
id|dosfar
op_star
)paren
id|inq
comma
r_sizeof
(paren
id|ASC_SCSI_INQUIRY
)paren
)paren
op_eq
l_int|1
)paren
(brace
id|dvc_found
op_assign
l_int|1
suffix:semicolon
id|support_read_cap
op_assign
id|TRUE
suffix:semicolon
id|dvc_type
op_assign
id|inq-&gt;byte0.peri_dvc_type
suffix:semicolon
r_if
c_cond
(paren
id|dvc_type
op_ne
id|SCSI_TYPE_UNKNOWN
)paren
(brace
r_if
c_cond
(paren
(paren
id|dvc_type
op_ne
id|SCSI_TYPE_DASD
)paren
op_logical_and
(paren
id|dvc_type
op_ne
id|SCSI_TYPE_WORM
)paren
op_logical_and
(paren
id|dvc_type
op_ne
id|SCSI_TYPE_CDROM
)paren
op_logical_and
(paren
id|dvc_type
op_ne
id|SCSI_TYPE_OPTMEM
)paren
)paren
(brace
id|asc_dvc-&gt;start_motor
op_and_assign
op_complement
id|tid_bits
suffix:semicolon
id|support_read_cap
op_assign
id|FALSE
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|dvc_type
op_ne
id|SCSI_TYPE_DASD
)paren
op_logical_or
id|inq-&gt;byte1.rmb
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|_asc_wait_slow_device_
)paren
(brace
id|DvcSleepMilliSecond
c_func
(paren
l_int|3000
op_minus
(paren
(paren
r_int
)paren
id|tid_no
op_star
l_int|250
)paren
)paren
suffix:semicolon
id|_asc_wait_slow_device_
op_assign
id|TRUE
suffix:semicolon
)brace
)brace
macro_line|#if CC_INIT_INQ_DISPLAY
id|AscDispInquiry
c_func
(paren
id|tid_no
comma
id|lun
comma
id|inq
)paren
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
id|lun
op_eq
l_int|0
)paren
(brace
r_if
c_cond
(paren
(paren
id|inq-&gt;byte3.rsp_data_fmt
op_ge
l_int|2
)paren
op_logical_or
(paren
id|inq-&gt;byte2.ansi_apr_ver
op_ge
l_int|2
)paren
)paren
(brace
r_if
c_cond
(paren
id|inq-&gt;byte7.CmdQue
)paren
(brace
id|asc_dvc-&gt;cfg-&gt;can_tagged_qng
op_or_assign
id|tid_bits
suffix:semicolon
r_if
c_cond
(paren
id|asc_dvc-&gt;cfg-&gt;cmd_qng_enabled
op_amp
id|tid_bits
)paren
(brace
macro_line|#if CC_FIX_QUANTUM_XP34301_1071
r_if
c_cond
(paren
(paren
id|inq-&gt;add_len
op_ge
l_int|32
)paren
op_logical_and
(paren
id|AscCompareString
c_func
(paren
id|inq-&gt;vendor_id
comma
(paren
id|uchar
op_star
)paren
l_string|&quot;QUANTUM XP34301&quot;
comma
l_int|15
)paren
op_eq
l_int|0
)paren
op_logical_and
(paren
id|AscCompareString
c_func
(paren
id|inq-&gt;product_rev_level
comma
(paren
id|uchar
op_star
)paren
l_string|&quot;1071&quot;
comma
l_int|4
)paren
op_eq
l_int|0
)paren
)paren
(brace
)brace
r_else
(brace
macro_line|#endif
id|asc_dvc-&gt;use_tagged_qng
op_or_assign
id|tid_bits
suffix:semicolon
id|asc_dvc-&gt;max_dvc_qng
(braket
id|tid_no
)braket
op_assign
id|asc_dvc-&gt;cfg-&gt;max_tag_qng
(braket
id|tid_no
)braket
suffix:semicolon
macro_line|#if CC_FIX_QUANTUM_XP34301_1071
)brace
macro_line|#endif
)brace
)brace
r_if
c_cond
(paren
op_logical_neg
id|inq-&gt;byte7.Sync
)paren
(brace
id|asc_dvc-&gt;init_sdtr
op_and_assign
op_complement
id|tid_bits
suffix:semicolon
id|asc_dvc-&gt;sdtr_done
op_and_assign
op_complement
id|tid_bits
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|tmp_disable_init_sdtr
)paren
(brace
id|asc_dvc-&gt;init_sdtr
op_or_assign
id|tid_bits
suffix:semicolon
)brace
)brace
r_else
(brace
id|asc_dvc-&gt;init_sdtr
op_and_assign
op_complement
id|tid_bits
suffix:semicolon
id|asc_dvc-&gt;sdtr_done
op_and_assign
op_complement
id|tid_bits
suffix:semicolon
id|asc_dvc-&gt;use_tagged_qng
op_and_assign
op_complement
id|tid_bits
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|asc_dvc-&gt;bug_fix_cntl
op_amp
id|ASC_BUG_FIX_ASYN_USE_SYN
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|asc_dvc-&gt;init_sdtr
op_amp
id|tid_bits
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
id|dvc_type
op_eq
id|SCSI_TYPE_CDROM
)paren
op_logical_and
(paren
id|AscCompareString
c_func
(paren
(paren
id|uchar
op_star
)paren
id|inq-&gt;vendor_id
comma
(paren
id|uchar
op_star
)paren
l_string|&quot;HP &quot;
comma
l_int|3
)paren
op_eq
l_int|0
)paren
)paren
(brace
id|asc_dvc-&gt;pci_fix_asyn_xfer_always
op_or_assign
id|tid_bits
suffix:semicolon
)brace
id|asc_dvc-&gt;pci_fix_asyn_xfer
op_or_assign
id|tid_bits
suffix:semicolon
macro_line|#if CC_DISABLE_ASYN_FIX_WANGTEK_TAPE
r_if
c_cond
(paren
(paren
id|dvc_type
op_eq
id|SCSI_TYPE_SASD
)paren
op_logical_and
(paren
id|AscCompareString
c_func
(paren
(paren
id|uchar
op_star
)paren
id|inq-&gt;vendor_id
comma
(paren
id|uchar
op_star
)paren
l_string|&quot;WANGTEK &quot;
comma
l_int|8
)paren
op_eq
l_int|0
)paren
)paren
(brace
id|asc_dvc-&gt;pci_fix_asyn_xfer
op_and_assign
op_complement
id|tid_bits
suffix:semicolon
)brace
macro_line|#endif
r_if
c_cond
(paren
id|asc_dvc-&gt;pci_fix_asyn_xfer
op_amp
id|tid_bits
)paren
(brace
id|AscSetRunChipSynRegAtID
c_func
(paren
id|asc_dvc-&gt;iop_base
comma
id|tid_no
comma
id|ASYN_SDTR_DATA_FIX_PCI_REV_AB
)paren
suffix:semicolon
)brace
)brace
)brace
id|sta
op_assign
l_int|1
suffix:semicolon
macro_line|#if CC_INIT_TARGET_TEST_UNIT_READY
id|sta
op_assign
id|InitTestUnitReady
c_func
(paren
id|asc_dvc
comma
id|scsiq
)paren
suffix:semicolon
macro_line|#endif
macro_line|#if CC_INIT_TARGET_READ_CAPACITY
r_if
c_cond
(paren
id|sta
op_eq
l_int|1
)paren
(brace
r_if
c_cond
(paren
(paren
id|cap_info
op_ne
l_int|0L
)paren
op_logical_and
id|support_read_cap
)paren
(brace
r_if
c_cond
(paren
id|PollScsiReadCapacity
c_func
(paren
id|asc_dvc
comma
id|scsiq
comma
id|cap_info
)paren
op_ne
l_int|1
)paren
(brace
id|cap_info-&gt;lba
op_assign
l_int|0L
suffix:semicolon
id|cap_info-&gt;blk_size
op_assign
l_int|0x0000
suffix:semicolon
)brace
r_else
(brace
)brace
)brace
)brace
macro_line|#endif
)brace
r_else
(brace
id|asc_dvc-&gt;start_motor
op_and_assign
op_complement
id|tid_bits
suffix:semicolon
)brace
)brace
r_else
(brace
)brace
r_return
(paren
id|dvc_found
)paren
suffix:semicolon
)brace
r_int
DECL|function|PollQueueDone
id|PollQueueDone
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|REG
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
id|scsiq
comma
r_int
id|timeout_sec
)paren
(brace
r_int
id|status
suffix:semicolon
r_int
id|retry
suffix:semicolon
id|retry
op_assign
l_int|0
suffix:semicolon
r_do
(brace
r_if
c_cond
(paren
(paren
id|status
op_assign
id|AscExeScsiQueue
c_func
(paren
id|asc_dvc
comma
(paren
id|ASC_SCSI_Q
id|dosfar
op_star
)paren
id|scsiq
)paren
)paren
op_eq
l_int|1
)paren
(brace
r_if
c_cond
(paren
(paren
id|status
op_assign
id|AscPollQDone
c_func
(paren
id|asc_dvc
comma
id|scsiq
comma
id|timeout_sec
)paren
)paren
op_ne
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|status
op_eq
l_int|0x80
)paren
(brace
r_if
c_cond
(paren
id|retry
op_increment
OG
id|ASC_MAX_INIT_BUSY_RETRY
)paren
(brace
r_break
suffix:semicolon
)brace
id|scsiq-&gt;r3.done_stat
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;r3.host_stat
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;r3.scsi_stat
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;r3.scsi_msg
op_assign
l_int|0
suffix:semicolon
id|DvcSleepMilliSecond
c_func
(paren
l_int|2000
)paren
suffix:semicolon
r_continue
suffix:semicolon
)brace
id|scsiq-&gt;r3.done_stat
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;r3.host_stat
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;r3.scsi_stat
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;r3.scsi_msg
op_assign
l_int|0
suffix:semicolon
id|AscAbortSRB
c_func
(paren
id|asc_dvc
comma
(paren
id|ulong
)paren
id|scsiq
)paren
suffix:semicolon
)brace
r_return
(paren
id|scsiq-&gt;r3.done_stat
)paren
suffix:semicolon
)brace
)brace
r_while
c_loop
(paren
(paren
id|status
op_eq
l_int|0
)paren
op_logical_or
(paren
id|status
op_eq
l_int|0x80
)paren
)paren
suffix:semicolon
r_return
(paren
id|scsiq-&gt;r3.done_stat
op_assign
id|QD_WITH_ERROR
)paren
suffix:semicolon
)brace
r_int
DECL|function|PollScsiInquiry
id|PollScsiInquiry
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|REG
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
id|scsiq
comma
id|uchar
id|dosfar
op_star
id|buf
comma
r_int
id|buf_len
)paren
(brace
r_if
c_cond
(paren
id|AscScsiInquiry
c_func
(paren
id|asc_dvc
comma
id|scsiq
comma
id|buf
comma
id|buf_len
)paren
op_eq
id|ERR
)paren
(brace
r_return
(paren
id|scsiq-&gt;r3.done_stat
op_assign
id|QD_WITH_ERROR
)paren
suffix:semicolon
)brace
r_return
(paren
id|PollQueueDone
c_func
(paren
id|asc_dvc
comma
(paren
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
)paren
id|scsiq
comma
l_int|4
)paren
)paren
suffix:semicolon
)brace
macro_line|#if CC_INIT_TARGET_START_UNIT
r_int
DECL|function|PollScsiStartUnit
id|PollScsiStartUnit
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|REG
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
id|scsiq
)paren
(brace
r_if
c_cond
(paren
id|AscScsiStartStopUnit
c_func
(paren
id|asc_dvc
comma
id|scsiq
comma
l_int|1
)paren
op_eq
id|ERR
)paren
(brace
r_return
(paren
id|scsiq-&gt;r3.done_stat
op_assign
id|QD_WITH_ERROR
)paren
suffix:semicolon
)brace
r_return
(paren
id|PollQueueDone
c_func
(paren
id|asc_dvc
comma
(paren
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
)paren
id|scsiq
comma
l_int|40
)paren
)paren
suffix:semicolon
)brace
macro_line|#endif
macro_line|#if CC_INIT_TARGET_READ_CAPACITY
r_int
DECL|function|PollScsiReadCapacity
id|PollScsiReadCapacity
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|REG
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
id|scsiq
comma
id|REG
id|ASC_CAP_INFO
id|dosfar
op_star
id|cap_info
)paren
(brace
id|ASC_CAP_INFO
id|scsi_cap_info
suffix:semicolon
r_int
id|status
suffix:semicolon
r_if
c_cond
(paren
id|AscScsiReadCapacity
c_func
(paren
id|asc_dvc
comma
id|scsiq
comma
(paren
id|uchar
id|dosfar
op_star
)paren
op_amp
id|scsi_cap_info
)paren
op_eq
id|ERR
)paren
(brace
r_return
(paren
id|scsiq-&gt;r3.done_stat
op_assign
id|QD_WITH_ERROR
)paren
suffix:semicolon
)brace
id|status
op_assign
id|PollQueueDone
c_func
(paren
id|asc_dvc
comma
(paren
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
)paren
id|scsiq
comma
l_int|8
)paren
suffix:semicolon
r_if
c_cond
(paren
id|status
op_eq
l_int|1
)paren
(brace
macro_line|#if CC_LITTLE_ENDIAN_HOST
id|cap_info-&gt;lba
op_assign
(paren
id|ulong
)paren
op_star
id|swapfarbuf4
c_func
(paren
(paren
id|uchar
id|dosfar
op_star
)paren
op_amp
id|scsi_cap_info.lba
)paren
suffix:semicolon
id|cap_info-&gt;blk_size
op_assign
(paren
id|ulong
)paren
op_star
id|swapfarbuf4
c_func
(paren
(paren
id|uchar
id|dosfar
op_star
)paren
op_amp
id|scsi_cap_info.blk_size
)paren
suffix:semicolon
macro_line|#else
id|cap_info-&gt;lba
op_assign
id|scsi_cap_info.lba
suffix:semicolon
id|cap_info-&gt;blk_size
op_assign
id|scsi_cap_info.blk_size
suffix:semicolon
macro_line|#endif
r_return
(paren
id|scsiq-&gt;r3.done_stat
)paren
suffix:semicolon
)brace
r_return
(paren
id|scsiq-&gt;r3.done_stat
op_assign
id|QD_WITH_ERROR
)paren
suffix:semicolon
)brace
macro_line|#endif
id|ulong
id|dosfar
op_star
DECL|function|swapfarbuf4
id|swapfarbuf4
c_func
(paren
id|uchar
id|dosfar
op_star
id|buf
)paren
(brace
id|uchar
id|tmp
suffix:semicolon
id|tmp
op_assign
id|buf
(braket
l_int|3
)braket
suffix:semicolon
id|buf
(braket
l_int|3
)braket
op_assign
id|buf
(braket
l_int|0
)braket
suffix:semicolon
id|buf
(braket
l_int|0
)braket
op_assign
id|tmp
suffix:semicolon
id|tmp
op_assign
id|buf
(braket
l_int|1
)braket
suffix:semicolon
id|buf
(braket
l_int|1
)braket
op_assign
id|buf
(braket
l_int|2
)braket
suffix:semicolon
id|buf
(braket
l_int|2
)braket
op_assign
id|tmp
suffix:semicolon
r_return
(paren
(paren
id|ulong
id|dosfar
op_star
)paren
id|buf
)paren
suffix:semicolon
)brace
macro_line|#if CC_INIT_TARGET_TEST_UNIT_READY
r_int
DECL|function|PollScsiTestUnitReady
id|PollScsiTestUnitReady
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|REG
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
id|scsiq
)paren
(brace
r_if
c_cond
(paren
id|AscScsiTestUnitReady
c_func
(paren
id|asc_dvc
comma
id|scsiq
)paren
op_eq
id|ERR
)paren
(brace
r_return
(paren
id|scsiq-&gt;r3.done_stat
op_assign
id|QD_WITH_ERROR
)paren
suffix:semicolon
)brace
r_return
(paren
id|PollQueueDone
c_func
(paren
id|asc_dvc
comma
(paren
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
)paren
id|scsiq
comma
l_int|12
)paren
)paren
suffix:semicolon
)brace
r_int
DECL|function|InitTestUnitReady
id|InitTestUnitReady
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|REG
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
id|scsiq
)paren
(brace
id|ASC_SCSI_BIT_ID_TYPE
id|tid_bits
suffix:semicolon
r_int
id|retry
suffix:semicolon
id|ASC_REQ_SENSE
id|dosfar
op_star
id|sen
suffix:semicolon
id|retry
op_assign
l_int|0
suffix:semicolon
id|tid_bits
op_assign
id|scsiq-&gt;r1.target_id
suffix:semicolon
r_while
c_loop
(paren
id|retry
op_increment
OL
l_int|2
)paren
(brace
id|PollScsiTestUnitReady
c_func
(paren
id|asc_dvc
comma
id|scsiq
)paren
suffix:semicolon
r_if
c_cond
(paren
id|scsiq-&gt;r3.done_stat
op_eq
l_int|0x01
)paren
(brace
r_return
(paren
l_int|1
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|scsiq-&gt;r3.done_stat
op_eq
id|QD_WITH_ERROR
)paren
(brace
id|DvcSleepMilliSecond
c_func
(paren
l_int|100
)paren
suffix:semicolon
id|sen
op_assign
(paren
id|ASC_REQ_SENSE
id|dosfar
op_star
)paren
id|scsiq-&gt;sense_ptr
suffix:semicolon
r_if
c_cond
(paren
(paren
id|scsiq-&gt;r3.scsi_stat
op_eq
id|SS_CHK_CONDITION
)paren
op_logical_and
(paren
(paren
id|sen-&gt;err_code
op_amp
l_int|0x70
)paren
op_ne
l_int|0
)paren
)paren
(brace
r_if
c_cond
(paren
id|sen-&gt;sense_key
op_eq
id|SCSI_SENKEY_NOT_READY
)paren
(brace
r_if
c_cond
(paren
id|asc_dvc-&gt;start_motor
op_amp
id|tid_bits
)paren
(brace
r_if
c_cond
(paren
id|PollScsiStartUnit
c_func
(paren
id|asc_dvc
comma
id|scsiq
)paren
op_eq
l_int|1
)paren
(brace
id|retry
op_assign
l_int|0
suffix:semicolon
r_continue
suffix:semicolon
)brace
r_else
(brace
id|asc_dvc-&gt;start_motor
op_and_assign
op_complement
id|tid_bits
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_else
(brace
id|DvcSleepMilliSecond
c_func
(paren
l_int|5000
)paren
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|sen-&gt;sense_key
op_eq
id|SCSI_SENKEY_ATTENSION
)paren
(brace
id|DvcSleepMilliSecond
c_func
(paren
l_int|500
)paren
suffix:semicolon
)brace
r_else
(brace
r_break
suffix:semicolon
)brace
)brace
r_else
(brace
r_break
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|scsiq-&gt;r3.done_stat
op_eq
id|QD_ABORTED_BY_HOST
)paren
(brace
r_break
suffix:semicolon
)brace
r_else
(brace
r_break
suffix:semicolon
)brace
)brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
macro_line|#endif
r_int
DECL|function|AscPollQDone
id|AscPollQDone
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|REG
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
id|scsiq
comma
r_int
id|timeout_sec
)paren
(brace
r_int
id|loop
comma
id|loop_end
suffix:semicolon
r_int
id|sta
suffix:semicolon
id|PortAddr
id|iop_base
suffix:semicolon
id|iop_base
op_assign
id|asc_dvc-&gt;iop_base
suffix:semicolon
id|loop
op_assign
l_int|0
suffix:semicolon
id|loop_end
op_assign
id|timeout_sec
op_star
l_int|100
suffix:semicolon
id|sta
op_assign
l_int|1
suffix:semicolon
r_while
c_loop
(paren
id|TRUE
)paren
(brace
r_if
c_cond
(paren
id|asc_dvc-&gt;err_code
op_ne
l_int|0
)paren
(brace
id|scsiq-&gt;r3.done_stat
op_assign
id|QD_WITH_ERROR
suffix:semicolon
id|sta
op_assign
id|ERR
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|scsiq-&gt;r3.done_stat
op_ne
id|QD_IN_PROGRESS
)paren
(brace
r_if
c_cond
(paren
(paren
id|scsiq-&gt;r3.done_stat
op_eq
id|QD_WITH_ERROR
)paren
op_logical_and
(paren
id|scsiq-&gt;r3.scsi_stat
op_eq
id|SS_TARGET_BUSY
)paren
)paren
(brace
id|sta
op_assign
l_int|0x80
suffix:semicolon
)brace
r_break
suffix:semicolon
)brace
id|DvcSleepMilliSecond
c_func
(paren
l_int|10
)paren
suffix:semicolon
r_if
c_cond
(paren
id|loop
op_increment
OG
id|loop_end
)paren
(brace
id|sta
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|AscIsChipHalted
c_func
(paren
id|iop_base
)paren
)paren
(brace
macro_line|#if !CC_ASCISR_CHECK_INT_PENDING
id|AscAckInterrupt
c_func
(paren
id|iop_base
)paren
suffix:semicolon
macro_line|#endif
id|AscISR
c_func
(paren
id|asc_dvc
)paren
suffix:semicolon
id|loop
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|AscIsIntPending
c_func
(paren
id|iop_base
)paren
)paren
(brace
macro_line|#if !CC_ASCISR_CHECK_INT_PENDING
id|AscAckInterrupt
c_func
(paren
id|iop_base
)paren
suffix:semicolon
macro_line|#endif
id|AscISR
c_func
(paren
id|asc_dvc
)paren
suffix:semicolon
)brace
)brace
)brace
r_return
(paren
id|sta
)paren
suffix:semicolon
)brace
r_int
DECL|function|AscCompareString
id|AscCompareString
c_func
(paren
id|ruchar
op_star
id|str1
comma
id|ruchar
op_star
id|str2
comma
r_int
id|len
)paren
(brace
r_int
id|i
suffix:semicolon
r_int
id|diff
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|len
suffix:semicolon
id|i
op_increment
)paren
(brace
id|diff
op_assign
(paren
r_int
)paren
(paren
id|str1
(braket
id|i
)braket
op_minus
id|str2
(braket
id|i
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|diff
op_ne
l_int|0
)paren
r_return
(paren
id|diff
)paren
suffix:semicolon
)brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
id|uchar
DECL|function|AscReadLramByte
id|AscReadLramByte
c_func
(paren
id|PortAddr
id|iop_base
comma
id|ushort
id|addr
)paren
(brace
id|uchar
id|byte_data
suffix:semicolon
id|ushort
id|word_data
suffix:semicolon
r_if
c_cond
(paren
id|isodd_word
c_func
(paren
id|addr
)paren
)paren
(brace
id|AscSetChipLramAddr
c_func
(paren
id|iop_base
comma
id|addr
op_minus
l_int|1
)paren
suffix:semicolon
id|word_data
op_assign
id|AscGetChipLramData
c_func
(paren
id|iop_base
)paren
suffix:semicolon
id|byte_data
op_assign
(paren
id|uchar
)paren
(paren
(paren
id|word_data
op_rshift
l_int|8
)paren
op_amp
l_int|0xFF
)paren
suffix:semicolon
)brace
r_else
(brace
id|AscSetChipLramAddr
c_func
(paren
id|iop_base
comma
id|addr
)paren
suffix:semicolon
id|word_data
op_assign
id|AscGetChipLramData
c_func
(paren
id|iop_base
)paren
suffix:semicolon
id|byte_data
op_assign
(paren
id|uchar
)paren
(paren
id|word_data
op_amp
l_int|0xFF
)paren
suffix:semicolon
)brace
r_return
(paren
id|byte_data
)paren
suffix:semicolon
)brace
id|ushort
DECL|function|AscReadLramWord
id|AscReadLramWord
c_func
(paren
id|PortAddr
id|iop_base
comma
id|ushort
id|addr
)paren
(brace
id|ushort
id|word_data
suffix:semicolon
id|AscSetChipLramAddr
c_func
(paren
id|iop_base
comma
id|addr
)paren
suffix:semicolon
id|word_data
op_assign
id|AscGetChipLramData
c_func
(paren
id|iop_base
)paren
suffix:semicolon
r_return
(paren
id|word_data
)paren
suffix:semicolon
)brace
id|ulong
DECL|function|AscReadLramDWord
id|AscReadLramDWord
c_func
(paren
id|PortAddr
id|iop_base
comma
id|ushort
id|addr
)paren
(brace
id|ushort
id|val_low
comma
id|val_high
suffix:semicolon
id|ulong
id|dword_data
suffix:semicolon
id|AscSetChipLramAddr
c_func
(paren
id|iop_base
comma
id|addr
)paren
suffix:semicolon
id|val_low
op_assign
id|AscGetChipLramData
c_func
(paren
id|iop_base
)paren
suffix:semicolon
id|val_high
op_assign
id|AscGetChipLramData
c_func
(paren
id|iop_base
)paren
suffix:semicolon
id|dword_data
op_assign
(paren
(paren
id|ulong
)paren
id|val_high
op_lshift
l_int|16
)paren
op_or
(paren
id|ulong
)paren
id|val_low
suffix:semicolon
r_return
(paren
id|dword_data
)paren
suffix:semicolon
)brace
r_void
DECL|function|AscWriteLramWord
id|AscWriteLramWord
c_func
(paren
id|PortAddr
id|iop_base
comma
id|ushort
id|addr
comma
id|ushort
id|word_val
)paren
(brace
id|AscSetChipLramAddr
c_func
(paren
id|iop_base
comma
id|addr
)paren
suffix:semicolon
id|AscSetChipLramData
c_func
(paren
id|iop_base
comma
id|word_val
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_void
DECL|function|AscWriteLramDWord
id|AscWriteLramDWord
c_func
(paren
id|PortAddr
id|iop_base
comma
id|ushort
id|addr
comma
id|ulong
id|dword_val
)paren
(brace
id|ushort
id|word_val
suffix:semicolon
id|AscSetChipLramAddr
c_func
(paren
id|iop_base
comma
id|addr
)paren
suffix:semicolon
id|word_val
op_assign
(paren
id|ushort
)paren
id|dword_val
suffix:semicolon
id|AscSetChipLramData
c_func
(paren
id|iop_base
comma
id|word_val
)paren
suffix:semicolon
id|word_val
op_assign
(paren
id|ushort
)paren
(paren
id|dword_val
op_rshift
l_int|16
)paren
suffix:semicolon
id|AscSetChipLramData
c_func
(paren
id|iop_base
comma
id|word_val
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_void
DECL|function|AscWriteLramByte
id|AscWriteLramByte
c_func
(paren
id|PortAddr
id|iop_base
comma
id|ushort
id|addr
comma
id|uchar
id|byte_val
)paren
(brace
id|ushort
id|word_data
suffix:semicolon
r_if
c_cond
(paren
id|isodd_word
c_func
(paren
id|addr
)paren
)paren
(brace
id|addr
op_decrement
suffix:semicolon
id|word_data
op_assign
id|AscReadLramWord
c_func
(paren
id|iop_base
comma
id|addr
)paren
suffix:semicolon
id|word_data
op_and_assign
l_int|0x00FF
suffix:semicolon
id|word_data
op_or_assign
(paren
(paren
(paren
id|ushort
)paren
id|byte_val
op_lshift
l_int|8
)paren
op_amp
l_int|0xFF00
)paren
suffix:semicolon
)brace
r_else
(brace
id|word_data
op_assign
id|AscReadLramWord
c_func
(paren
id|iop_base
comma
id|addr
)paren
suffix:semicolon
id|word_data
op_and_assign
l_int|0xFF00
suffix:semicolon
id|word_data
op_or_assign
(paren
(paren
id|ushort
)paren
id|byte_val
op_amp
l_int|0x00FF
)paren
suffix:semicolon
)brace
id|AscWriteLramWord
c_func
(paren
id|iop_base
comma
id|addr
comma
id|word_data
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_void
DECL|function|AscMemWordCopyToLram
id|AscMemWordCopyToLram
c_func
(paren
id|PortAddr
id|iop_base
comma
id|ushort
id|s_addr
comma
id|ushort
id|dosfar
op_star
id|s_buffer
comma
r_int
id|words
)paren
(brace
id|AscSetChipLramAddr
c_func
(paren
id|iop_base
comma
id|s_addr
)paren
suffix:semicolon
id|DvcOutPortWords
c_func
(paren
id|iop_base
op_plus
id|IOP_RAM_DATA
comma
id|s_buffer
comma
id|words
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_void
DECL|function|AscMemDWordCopyToLram
id|AscMemDWordCopyToLram
c_func
(paren
id|PortAddr
id|iop_base
comma
id|ushort
id|s_addr
comma
id|ulong
id|dosfar
op_star
id|s_buffer
comma
r_int
id|dwords
)paren
(brace
id|AscSetChipLramAddr
c_func
(paren
id|iop_base
comma
id|s_addr
)paren
suffix:semicolon
id|DvcOutPortDWords
c_func
(paren
id|iop_base
op_plus
id|IOP_RAM_DATA
comma
id|s_buffer
comma
id|dwords
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_void
DECL|function|AscMemWordCopyFromLram
id|AscMemWordCopyFromLram
c_func
(paren
id|PortAddr
id|iop_base
comma
id|ushort
id|s_addr
comma
id|ushort
id|dosfar
op_star
id|d_buffer
comma
r_int
id|words
)paren
(brace
id|AscSetChipLramAddr
c_func
(paren
id|iop_base
comma
id|s_addr
)paren
suffix:semicolon
id|DvcInPortWords
c_func
(paren
id|iop_base
op_plus
id|IOP_RAM_DATA
comma
id|d_buffer
comma
id|words
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|ulong
DECL|function|AscMemSumLramWord
id|AscMemSumLramWord
c_func
(paren
id|PortAddr
id|iop_base
comma
id|ushort
id|s_addr
comma
id|rint
id|words
)paren
(brace
id|ulong
id|sum
suffix:semicolon
r_int
id|i
suffix:semicolon
id|sum
op_assign
l_int|0L
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|words
suffix:semicolon
id|i
op_increment
comma
id|s_addr
op_add_assign
l_int|2
)paren
(brace
id|sum
op_add_assign
id|AscReadLramWord
c_func
(paren
id|iop_base
comma
id|s_addr
)paren
suffix:semicolon
)brace
r_return
(paren
id|sum
)paren
suffix:semicolon
)brace
r_void
DECL|function|AscMemWordSetLram
id|AscMemWordSetLram
c_func
(paren
id|PortAddr
id|iop_base
comma
id|ushort
id|s_addr
comma
id|ushort
id|set_wval
comma
id|rint
id|words
)paren
(brace
id|rint
id|i
suffix:semicolon
id|AscSetChipLramAddr
c_func
(paren
id|iop_base
comma
id|s_addr
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|words
suffix:semicolon
id|i
op_increment
)paren
(brace
id|AscSetChipLramData
c_func
(paren
id|iop_base
comma
id|set_wval
)paren
suffix:semicolon
)brace
r_return
suffix:semicolon
)brace
r_int
DECL|function|AscScsiInquiry
id|AscScsiInquiry
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|REG
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
id|scsiq
comma
id|uchar
id|dosfar
op_star
id|buf
comma
r_int
id|buf_len
)paren
(brace
r_if
c_cond
(paren
id|AscScsiSetupCmdQ
c_func
(paren
id|asc_dvc
comma
id|scsiq
comma
id|buf
comma
(paren
id|ulong
)paren
id|buf_len
)paren
op_eq
id|ERR
)paren
(brace
r_return
(paren
id|scsiq-&gt;r3.done_stat
op_assign
id|QD_WITH_ERROR
)paren
suffix:semicolon
)brace
id|scsiq-&gt;cdb
(braket
l_int|0
)braket
op_assign
(paren
id|uchar
)paren
id|SCSICMD_Inquiry
suffix:semicolon
id|scsiq-&gt;cdb
(braket
l_int|1
)braket
op_assign
id|scsiq-&gt;r1.target_lun
op_lshift
l_int|5
suffix:semicolon
id|scsiq-&gt;cdb
(braket
l_int|2
)braket
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;cdb
(braket
l_int|3
)braket
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;cdb
(braket
l_int|4
)braket
op_assign
id|buf_len
suffix:semicolon
id|scsiq-&gt;cdb
(braket
l_int|5
)braket
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;r2.cdb_len
op_assign
l_int|6
suffix:semicolon
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
macro_line|#if CC_INIT_TARGET_READ_CAPACITY
r_int
DECL|function|AscScsiReadCapacity
id|AscScsiReadCapacity
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|REG
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
id|scsiq
comma
id|uchar
id|dosfar
op_star
id|info
)paren
(brace
r_if
c_cond
(paren
id|AscScsiSetupCmdQ
c_func
(paren
id|asc_dvc
comma
id|scsiq
comma
id|info
comma
l_int|8L
)paren
op_eq
id|ERR
)paren
(brace
r_return
(paren
id|scsiq-&gt;r3.done_stat
op_assign
id|QD_WITH_ERROR
)paren
suffix:semicolon
)brace
id|scsiq-&gt;cdb
(braket
l_int|0
)braket
op_assign
(paren
id|uchar
)paren
id|SCSICMD_ReadCapacity
suffix:semicolon
id|scsiq-&gt;cdb
(braket
l_int|1
)braket
op_assign
id|scsiq-&gt;r1.target_lun
op_lshift
l_int|5
suffix:semicolon
id|scsiq-&gt;cdb
(braket
l_int|2
)braket
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;cdb
(braket
l_int|3
)braket
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;cdb
(braket
l_int|4
)braket
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;cdb
(braket
l_int|5
)braket
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;cdb
(braket
l_int|6
)braket
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;cdb
(braket
l_int|7
)braket
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;cdb
(braket
l_int|8
)braket
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;cdb
(braket
l_int|9
)braket
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;r2.cdb_len
op_assign
l_int|10
suffix:semicolon
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
macro_line|#endif
macro_line|#if CC_INIT_TARGET_TEST_UNIT_READY
r_int
DECL|function|AscScsiTestUnitReady
id|AscScsiTestUnitReady
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|REG
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
id|scsiq
)paren
(brace
r_if
c_cond
(paren
id|AscScsiSetupCmdQ
c_func
(paren
id|asc_dvc
comma
id|scsiq
comma
id|FNULLPTR
comma
(paren
id|ulong
)paren
l_int|0L
)paren
op_eq
id|ERR
)paren
(brace
r_return
(paren
id|scsiq-&gt;r3.done_stat
op_assign
id|QD_WITH_ERROR
)paren
suffix:semicolon
)brace
id|scsiq-&gt;r1.cntl
op_assign
(paren
id|uchar
)paren
id|ASC_SCSIDIR_NODATA
suffix:semicolon
id|scsiq-&gt;cdb
(braket
l_int|0
)braket
op_assign
(paren
id|uchar
)paren
id|SCSICMD_TestUnitReady
suffix:semicolon
id|scsiq-&gt;cdb
(braket
l_int|1
)braket
op_assign
id|scsiq-&gt;r1.target_lun
op_lshift
l_int|5
suffix:semicolon
id|scsiq-&gt;cdb
(braket
l_int|2
)braket
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;cdb
(braket
l_int|3
)braket
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;cdb
(braket
l_int|4
)braket
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;cdb
(braket
l_int|5
)braket
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;r2.cdb_len
op_assign
l_int|6
suffix:semicolon
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
macro_line|#endif
macro_line|#if CC_INIT_TARGET_START_UNIT
r_int
DECL|function|AscScsiStartStopUnit
id|AscScsiStartStopUnit
c_func
(paren
id|REG
id|ASC_DVC_VAR
id|asc_ptr_type
op_star
id|asc_dvc
comma
id|REG
id|ASC_SCSI_REQ_Q
id|dosfar
op_star
id|scsiq
comma
id|uchar
id|op_mode
)paren
(brace
r_if
c_cond
(paren
id|AscScsiSetupCmdQ
c_func
(paren
id|asc_dvc
comma
id|scsiq
comma
id|FNULLPTR
comma
(paren
id|ulong
)paren
l_int|0L
)paren
op_eq
id|ERR
)paren
(brace
r_return
(paren
id|scsiq-&gt;r3.done_stat
op_assign
id|QD_WITH_ERROR
)paren
suffix:semicolon
)brace
id|scsiq-&gt;r1.cntl
op_assign
(paren
id|uchar
)paren
id|ASC_SCSIDIR_NODATA
suffix:semicolon
id|scsiq-&gt;cdb
(braket
l_int|0
)braket
op_assign
(paren
id|uchar
)paren
id|SCSICMD_StartStopUnit
suffix:semicolon
id|scsiq-&gt;cdb
(braket
l_int|1
)braket
op_assign
id|scsiq-&gt;r1.target_lun
op_lshift
l_int|5
suffix:semicolon
id|scsiq-&gt;cdb
(braket
l_int|2
)braket
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;cdb
(braket
l_int|3
)braket
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;cdb
(braket
l_int|4
)braket
op_assign
id|op_mode
suffix:semicolon
id|scsiq-&gt;cdb
(braket
l_int|5
)braket
op_assign
l_int|0
suffix:semicolon
id|scsiq-&gt;r2.cdb_len
op_assign
l_int|6
suffix:semicolon
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
macro_line|#endif
eof
