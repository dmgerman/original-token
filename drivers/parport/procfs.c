multiline_comment|/* Sysctl interface for parport devices.&n; * &n; * Authors: David Campbell &lt;campbell@torque.net&gt;&n; *          Tim Waugh &lt;tim@cyberelk.demon.co.uk&gt;&n; *          Philip Blundell &lt;philb@gnu.org&gt;&n; *          Andrea Arcangeli&n; *          Riccardo Facchetti &lt;fizban@tin.it&gt;&n; *&n; * based on work by Grant Guenther &lt;grant@torque.net&gt;&n; *              and Philip Blundell&n; *&n; * Cleaned up include files - Russell King &lt;linux@arm.uk.linux.org&gt;&n; */
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/errno.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/malloc.h&gt;
macro_line|#include &lt;linux/parport.h&gt;
macro_line|#include &lt;linux/ctype.h&gt;
macro_line|#include &lt;linux/sysctl.h&gt;
macro_line|#include &lt;asm/uaccess.h&gt;
macro_line|#if defined(CONFIG_SYSCTL) &amp;&amp; defined(CONFIG_PROC_FS)
DECL|macro|PARPORT_MIN_TIMESLICE_VALUE
mdefine_line|#define PARPORT_MIN_TIMESLICE_VALUE 1ul 
DECL|macro|PARPORT_MAX_TIMESLICE_VALUE
mdefine_line|#define PARPORT_MAX_TIMESLICE_VALUE ((unsigned long) HZ)
DECL|macro|PARPORT_MIN_SPINTIME_VALUE
mdefine_line|#define PARPORT_MIN_SPINTIME_VALUE 1
DECL|macro|PARPORT_MAX_SPINTIME_VALUE
mdefine_line|#define PARPORT_MAX_SPINTIME_VALUE 1000
DECL|function|do_active_device
r_static
r_int
id|do_active_device
c_func
(paren
id|ctl_table
op_star
id|table
comma
r_int
id|write
comma
r_struct
id|file
op_star
id|filp
comma
r_void
op_star
id|result
comma
r_int
op_star
id|lenp
)paren
(brace
r_struct
id|parport
op_star
id|port
op_assign
(paren
r_struct
id|parport
op_star
)paren
id|table-&gt;extra1
suffix:semicolon
r_char
id|buffer
(braket
l_int|256
)braket
suffix:semicolon
r_struct
id|pardevice
op_star
id|dev
suffix:semicolon
r_int
id|len
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|write
)paren
multiline_comment|/* can&squot;t happen anyway */
r_return
op_minus
id|EACCES
suffix:semicolon
r_if
c_cond
(paren
id|filp-&gt;f_pos
)paren
(brace
op_star
id|lenp
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_for
c_loop
(paren
id|dev
op_assign
id|port-&gt;devices
suffix:semicolon
id|dev
suffix:semicolon
id|dev
op_assign
id|dev-&gt;next
)paren
(brace
r_if
c_cond
(paren
id|dev
op_eq
id|port-&gt;cad
)paren
(brace
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buffer
comma
l_string|&quot;%s&bslash;n&quot;
comma
id|dev-&gt;name
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
op_logical_neg
id|len
)paren
(brace
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buffer
comma
l_string|&quot;%s&bslash;n&quot;
comma
l_string|&quot;none&quot;
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|len
OG
op_star
id|lenp
)paren
id|len
op_assign
op_star
id|lenp
suffix:semicolon
r_else
op_star
id|lenp
op_assign
id|len
suffix:semicolon
id|filp-&gt;f_pos
op_add_assign
id|len
suffix:semicolon
r_return
id|copy_to_user
c_func
(paren
id|result
comma
id|buffer
comma
id|len
)paren
ques
c_cond
op_minus
id|EFAULT
suffix:colon
l_int|0
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_PARPORT_1284
DECL|function|do_autoprobe
r_static
r_int
id|do_autoprobe
c_func
(paren
id|ctl_table
op_star
id|table
comma
r_int
id|write
comma
r_struct
id|file
op_star
id|filp
comma
r_void
op_star
id|result
comma
r_int
op_star
id|lenp
)paren
(brace
r_struct
id|parport_device_info
op_star
id|info
op_assign
id|table-&gt;extra2
suffix:semicolon
r_const
r_char
op_star
id|str
suffix:semicolon
r_char
id|buffer
(braket
l_int|256
)braket
suffix:semicolon
r_int
id|len
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|write
)paren
multiline_comment|/* permissions stop this */
r_return
op_minus
id|EACCES
suffix:semicolon
r_if
c_cond
(paren
id|filp-&gt;f_pos
)paren
(brace
op_star
id|lenp
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|str
op_assign
id|info-&gt;class_name
)paren
op_ne
l_int|NULL
)paren
id|len
op_add_assign
id|sprintf
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot;CLASS:%s;&bslash;n&quot;
comma
id|str
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|str
op_assign
id|info-&gt;model
)paren
op_ne
l_int|NULL
)paren
id|len
op_add_assign
id|sprintf
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot;MODEL:%s;&bslash;n&quot;
comma
id|str
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|str
op_assign
id|info-&gt;mfr
)paren
op_ne
l_int|NULL
)paren
id|len
op_add_assign
id|sprintf
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot;MANUFACTURER:%s;&bslash;n&quot;
comma
id|str
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|str
op_assign
id|info-&gt;description
)paren
op_ne
l_int|NULL
)paren
id|len
op_add_assign
id|sprintf
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot;DESCRIPTION:%s;&bslash;n&quot;
comma
id|str
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|str
op_assign
id|info-&gt;cmdset
)paren
op_ne
l_int|NULL
)paren
id|len
op_add_assign
id|sprintf
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot;COMMAND SET:%s;&bslash;n&quot;
comma
id|str
)paren
suffix:semicolon
r_if
c_cond
(paren
id|len
OG
op_star
id|lenp
)paren
id|len
op_assign
op_star
id|lenp
suffix:semicolon
r_else
op_star
id|lenp
op_assign
id|len
suffix:semicolon
id|filp-&gt;f_pos
op_add_assign
id|len
suffix:semicolon
r_return
id|copy_to_user
(paren
id|result
comma
id|buffer
comma
id|len
)paren
ques
c_cond
op_minus
id|EFAULT
suffix:colon
l_int|0
suffix:semicolon
)brace
macro_line|#endif /* IEEE1284.3 support. */
DECL|function|do_hardware_base_addr
r_static
r_int
id|do_hardware_base_addr
(paren
id|ctl_table
op_star
id|table
comma
r_int
id|write
comma
r_struct
id|file
op_star
id|filp
comma
r_void
op_star
id|result
comma
r_int
op_star
id|lenp
)paren
(brace
r_struct
id|parport
op_star
id|port
op_assign
(paren
r_struct
id|parport
op_star
)paren
id|table-&gt;extra1
suffix:semicolon
r_char
id|buffer
(braket
l_int|20
)braket
suffix:semicolon
r_int
id|len
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|filp-&gt;f_pos
)paren
(brace
op_star
id|lenp
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|write
)paren
multiline_comment|/* permissions prevent this anyway */
r_return
op_minus
id|EACCES
suffix:semicolon
id|len
op_add_assign
id|sprintf
(paren
id|buffer
comma
l_string|&quot;%lu&bslash;t%lu&bslash;n&quot;
comma
id|port-&gt;base
comma
id|port-&gt;base_hi
)paren
suffix:semicolon
r_if
c_cond
(paren
id|len
OG
op_star
id|lenp
)paren
id|len
op_assign
op_star
id|lenp
suffix:semicolon
r_else
op_star
id|lenp
op_assign
id|len
suffix:semicolon
id|filp-&gt;f_pos
op_add_assign
id|len
suffix:semicolon
r_return
id|copy_to_user
c_func
(paren
id|result
comma
id|buffer
comma
id|len
)paren
ques
c_cond
op_minus
id|EFAULT
suffix:colon
l_int|0
suffix:semicolon
)brace
DECL|function|do_hardware_irq
r_static
r_int
id|do_hardware_irq
(paren
id|ctl_table
op_star
id|table
comma
r_int
id|write
comma
r_struct
id|file
op_star
id|filp
comma
r_void
op_star
id|result
comma
r_int
op_star
id|lenp
)paren
(brace
r_struct
id|parport
op_star
id|port
op_assign
(paren
r_struct
id|parport
op_star
)paren
id|table-&gt;extra1
suffix:semicolon
r_char
id|buffer
(braket
l_int|20
)braket
suffix:semicolon
r_int
id|len
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|filp-&gt;f_pos
)paren
(brace
op_star
id|lenp
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|write
)paren
multiline_comment|/* permissions prevent this anyway */
r_return
op_minus
id|EACCES
suffix:semicolon
id|len
op_add_assign
id|sprintf
(paren
id|buffer
comma
l_string|&quot;%d&bslash;n&quot;
comma
id|port-&gt;irq
)paren
suffix:semicolon
r_if
c_cond
(paren
id|len
OG
op_star
id|lenp
)paren
id|len
op_assign
op_star
id|lenp
suffix:semicolon
r_else
op_star
id|lenp
op_assign
id|len
suffix:semicolon
id|filp-&gt;f_pos
op_add_assign
id|len
suffix:semicolon
r_return
id|copy_to_user
c_func
(paren
id|result
comma
id|buffer
comma
id|len
)paren
ques
c_cond
op_minus
id|EFAULT
suffix:colon
l_int|0
suffix:semicolon
)brace
DECL|function|do_hardware_dma
r_static
r_int
id|do_hardware_dma
(paren
id|ctl_table
op_star
id|table
comma
r_int
id|write
comma
r_struct
id|file
op_star
id|filp
comma
r_void
op_star
id|result
comma
r_int
op_star
id|lenp
)paren
(brace
r_struct
id|parport
op_star
id|port
op_assign
(paren
r_struct
id|parport
op_star
)paren
id|table-&gt;extra1
suffix:semicolon
r_char
id|buffer
(braket
l_int|20
)braket
suffix:semicolon
r_int
id|len
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|filp-&gt;f_pos
)paren
(brace
op_star
id|lenp
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|write
)paren
multiline_comment|/* permissions prevent this anyway */
r_return
op_minus
id|EACCES
suffix:semicolon
id|len
op_add_assign
id|sprintf
(paren
id|buffer
comma
l_string|&quot;%d&bslash;n&quot;
comma
id|port-&gt;dma
)paren
suffix:semicolon
r_if
c_cond
(paren
id|len
OG
op_star
id|lenp
)paren
id|len
op_assign
op_star
id|lenp
suffix:semicolon
r_else
op_star
id|lenp
op_assign
id|len
suffix:semicolon
id|filp-&gt;f_pos
op_add_assign
id|len
suffix:semicolon
r_return
id|copy_to_user
c_func
(paren
id|result
comma
id|buffer
comma
id|len
)paren
ques
c_cond
op_minus
id|EFAULT
suffix:colon
l_int|0
suffix:semicolon
)brace
DECL|function|do_hardware_modes
r_static
r_int
id|do_hardware_modes
(paren
id|ctl_table
op_star
id|table
comma
r_int
id|write
comma
r_struct
id|file
op_star
id|filp
comma
r_void
op_star
id|result
comma
r_int
op_star
id|lenp
)paren
(brace
r_struct
id|parport
op_star
id|port
op_assign
(paren
r_struct
id|parport
op_star
)paren
id|table-&gt;extra1
suffix:semicolon
r_char
id|buffer
(braket
l_int|40
)braket
suffix:semicolon
r_int
id|len
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|filp-&gt;f_pos
)paren
(brace
op_star
id|lenp
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|write
)paren
multiline_comment|/* permissions prevent this anyway */
r_return
op_minus
id|EACCES
suffix:semicolon
(brace
DECL|macro|printmode
mdefine_line|#define printmode(x) {if(port-&gt;modes&amp;PARPORT_MODE_##x){len+=sprintf(buffer+len,&quot;%s%s&quot;,f?&quot;,&quot;:&quot;&quot;,#x);f++;}}
r_int
id|f
op_assign
l_int|0
suffix:semicolon
id|printmode
c_func
(paren
id|PCSPP
)paren
suffix:semicolon
id|printmode
c_func
(paren
id|TRISTATE
)paren
suffix:semicolon
id|printmode
c_func
(paren
id|COMPAT
)paren
suffix:semicolon
id|printmode
c_func
(paren
id|EPP
)paren
suffix:semicolon
id|printmode
c_func
(paren
id|ECP
)paren
suffix:semicolon
id|printmode
c_func
(paren
id|DMA
)paren
suffix:semicolon
DECL|macro|printmode
macro_line|#undef printmode
)brace
id|buffer
(braket
id|len
op_increment
)braket
op_assign
l_char|&squot;&bslash;n&squot;
suffix:semicolon
r_if
c_cond
(paren
id|len
OG
op_star
id|lenp
)paren
id|len
op_assign
op_star
id|lenp
suffix:semicolon
r_else
op_star
id|lenp
op_assign
id|len
suffix:semicolon
id|filp-&gt;f_pos
op_add_assign
id|len
suffix:semicolon
r_return
id|copy_to_user
c_func
(paren
id|result
comma
id|buffer
comma
id|len
)paren
ques
c_cond
op_minus
id|EFAULT
suffix:colon
l_int|0
suffix:semicolon
)brace
DECL|macro|PARPORT_PORT_DIR
mdefine_line|#define PARPORT_PORT_DIR(child) { 0, NULL, NULL, 0, 0555, child }
DECL|macro|PARPORT_PARPORT_DIR
mdefine_line|#define PARPORT_PARPORT_DIR(child) { DEV_PARPORT, &quot;parport&quot;, &bslash;&n;                                     NULL, 0, 0555, child }
DECL|macro|PARPORT_DEV_DIR
mdefine_line|#define PARPORT_DEV_DIR(child) { CTL_DEV, &quot;dev&quot;, NULL, 0, 0555, child }
DECL|macro|PARPORT_DEVICES_ROOT_DIR
mdefine_line|#define PARPORT_DEVICES_ROOT_DIR  { DEV_PARPORT_DEVICES, &quot;devices&quot;, &bslash;&n;                                    NULL, 0, 0555, NULL }
DECL|variable|parport_min_timeslice_value
r_static
r_const
r_int
r_int
id|parport_min_timeslice_value
op_assign
id|PARPORT_MIN_TIMESLICE_VALUE
suffix:semicolon
DECL|variable|parport_max_timeslice_value
r_static
r_const
r_int
r_int
id|parport_max_timeslice_value
op_assign
id|PARPORT_MAX_TIMESLICE_VALUE
suffix:semicolon
DECL|variable|parport_min_spintime_value
r_static
r_const
r_int
id|parport_min_spintime_value
op_assign
id|PARPORT_MIN_SPINTIME_VALUE
suffix:semicolon
DECL|variable|parport_max_spintime_value
r_static
r_const
r_int
id|parport_max_spintime_value
op_assign
id|PARPORT_MAX_SPINTIME_VALUE
suffix:semicolon
DECL|struct|parport_sysctl_table
r_struct
id|parport_sysctl_table
(brace
DECL|member|sysctl_header
r_struct
id|ctl_table_header
op_star
id|sysctl_header
suffix:semicolon
DECL|member|vars
id|ctl_table
id|vars
(braket
l_int|12
)braket
suffix:semicolon
DECL|member|device_dir
id|ctl_table
id|device_dir
(braket
l_int|2
)braket
suffix:semicolon
DECL|member|port_dir
id|ctl_table
id|port_dir
(braket
l_int|2
)braket
suffix:semicolon
DECL|member|parport_dir
id|ctl_table
id|parport_dir
(braket
l_int|2
)braket
suffix:semicolon
DECL|member|dev_dir
id|ctl_table
id|dev_dir
(braket
l_int|2
)braket
suffix:semicolon
)brace
suffix:semicolon
DECL|variable|parport_sysctl_template
r_static
r_const
r_struct
id|parport_sysctl_table
id|parport_sysctl_template
op_assign
(brace
l_int|NULL
comma
(brace
(brace
id|DEV_PARPORT_SPINTIME
comma
l_string|&quot;spintime&quot;
comma
l_int|NULL
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec_minmax
comma
l_int|NULL
comma
l_int|NULL
comma
(paren
r_void
op_star
)paren
op_amp
id|parport_min_spintime_value
comma
(paren
r_void
op_star
)paren
op_amp
id|parport_max_spintime_value
)brace
comma
(brace
id|DEV_PARPORT_BASE_ADDR
comma
l_string|&quot;base-addr&quot;
comma
l_int|NULL
comma
l_int|0
comma
l_int|0444
comma
l_int|NULL
comma
op_amp
id|do_hardware_base_addr
)brace
comma
(brace
id|DEV_PARPORT_IRQ
comma
l_string|&quot;irq&quot;
comma
l_int|NULL
comma
l_int|0
comma
l_int|0444
comma
l_int|NULL
comma
op_amp
id|do_hardware_irq
)brace
comma
(brace
id|DEV_PARPORT_DMA
comma
l_string|&quot;dma&quot;
comma
l_int|NULL
comma
l_int|0
comma
l_int|0444
comma
l_int|NULL
comma
op_amp
id|do_hardware_dma
)brace
comma
(brace
id|DEV_PARPORT_MODES
comma
l_string|&quot;modes&quot;
comma
l_int|NULL
comma
l_int|0
comma
l_int|0444
comma
l_int|NULL
comma
op_amp
id|do_hardware_modes
)brace
comma
id|PARPORT_DEVICES_ROOT_DIR
comma
macro_line|#ifdef CONFIG_PARPORT_1284
(brace
id|DEV_PARPORT_AUTOPROBE
comma
l_string|&quot;autoprobe&quot;
comma
l_int|NULL
comma
l_int|0
comma
l_int|0444
comma
l_int|NULL
comma
op_amp
id|do_autoprobe
)brace
comma
(brace
id|DEV_PARPORT_AUTOPROBE
op_plus
l_int|1
comma
l_string|&quot;autoprobe0&quot;
comma
l_int|NULL
comma
l_int|0
comma
l_int|0444
comma
l_int|NULL
comma
op_amp
id|do_autoprobe
)brace
comma
(brace
id|DEV_PARPORT_AUTOPROBE
op_plus
l_int|2
comma
l_string|&quot;autoprobe1&quot;
comma
l_int|NULL
comma
l_int|0
comma
l_int|0444
comma
l_int|NULL
comma
op_amp
id|do_autoprobe
)brace
comma
(brace
id|DEV_PARPORT_AUTOPROBE
op_plus
l_int|3
comma
l_string|&quot;autoprobe2&quot;
comma
l_int|NULL
comma
l_int|0
comma
l_int|0444
comma
l_int|NULL
comma
op_amp
id|do_autoprobe
)brace
comma
(brace
id|DEV_PARPORT_AUTOPROBE
op_plus
l_int|4
comma
l_string|&quot;autoprobe3&quot;
comma
l_int|NULL
comma
l_int|0
comma
l_int|0444
comma
l_int|NULL
comma
op_amp
id|do_autoprobe
)brace
comma
macro_line|#endif /* IEEE 1284 support */
(brace
l_int|0
)brace
)brace
comma
(brace
(brace
id|DEV_PARPORT_DEVICES_ACTIVE
comma
l_string|&quot;active&quot;
comma
l_int|NULL
comma
l_int|0
comma
l_int|0444
comma
l_int|NULL
comma
op_amp
id|do_active_device
)brace
comma
(brace
l_int|0
)brace
)brace
comma
(brace
id|PARPORT_PORT_DIR
c_func
(paren
l_int|NULL
)paren
comma
(brace
l_int|0
)brace
)brace
comma
(brace
id|PARPORT_PARPORT_DIR
c_func
(paren
l_int|NULL
)paren
comma
(brace
l_int|0
)brace
)brace
comma
(brace
id|PARPORT_DEV_DIR
c_func
(paren
l_int|NULL
)paren
comma
(brace
l_int|0
)brace
)brace
)brace
suffix:semicolon
DECL|struct|parport_device_sysctl_table
r_struct
id|parport_device_sysctl_table
(brace
DECL|member|sysctl_header
r_struct
id|ctl_table_header
op_star
id|sysctl_header
suffix:semicolon
DECL|member|vars
id|ctl_table
id|vars
(braket
l_int|2
)braket
suffix:semicolon
DECL|member|device_dir
id|ctl_table
id|device_dir
(braket
l_int|2
)braket
suffix:semicolon
DECL|member|devices_root_dir
id|ctl_table
id|devices_root_dir
(braket
l_int|2
)braket
suffix:semicolon
DECL|member|port_dir
id|ctl_table
id|port_dir
(braket
l_int|2
)braket
suffix:semicolon
DECL|member|parport_dir
id|ctl_table
id|parport_dir
(braket
l_int|2
)braket
suffix:semicolon
DECL|member|dev_dir
id|ctl_table
id|dev_dir
(braket
l_int|2
)braket
suffix:semicolon
)brace
suffix:semicolon
r_static
r_const
r_struct
id|parport_device_sysctl_table
DECL|variable|parport_device_sysctl_template
id|parport_device_sysctl_template
op_assign
(brace
l_int|NULL
comma
(brace
(brace
id|DEV_PARPORT_DEVICE_TIMESLICE
comma
l_string|&quot;timeslice&quot;
comma
l_int|NULL
comma
r_sizeof
(paren
r_int
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_doulongvec_ms_jiffies_minmax
comma
l_int|NULL
comma
l_int|NULL
comma
(paren
r_void
op_star
)paren
op_amp
id|parport_min_timeslice_value
comma
(paren
r_void
op_star
)paren
op_amp
id|parport_max_timeslice_value
)brace
comma
)brace
comma
(brace
(brace
l_int|0
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|0
comma
l_int|0555
comma
l_int|NULL
)brace
comma
(brace
l_int|0
)brace
)brace
comma
(brace
id|PARPORT_DEVICES_ROOT_DIR
comma
(brace
l_int|0
)brace
)brace
comma
(brace
id|PARPORT_PORT_DIR
c_func
(paren
l_int|NULL
)paren
comma
(brace
l_int|0
)brace
)brace
comma
(brace
id|PARPORT_PARPORT_DIR
c_func
(paren
l_int|NULL
)paren
comma
(brace
l_int|0
)brace
)brace
comma
(brace
id|PARPORT_DEV_DIR
c_func
(paren
l_int|NULL
)paren
comma
(brace
l_int|0
)brace
)brace
)brace
suffix:semicolon
DECL|struct|parport_default_sysctl_table
r_struct
id|parport_default_sysctl_table
(brace
DECL|member|sysctl_header
r_struct
id|ctl_table_header
op_star
id|sysctl_header
suffix:semicolon
DECL|member|vars
id|ctl_table
id|vars
(braket
l_int|3
)braket
suffix:semicolon
DECL|member|default_dir
id|ctl_table
id|default_dir
(braket
l_int|2
)braket
suffix:semicolon
DECL|member|parport_dir
id|ctl_table
id|parport_dir
(braket
l_int|2
)braket
suffix:semicolon
DECL|member|dev_dir
id|ctl_table
id|dev_dir
(braket
l_int|2
)braket
suffix:semicolon
)brace
suffix:semicolon
r_extern
r_int
r_int
id|parport_default_timeslice
suffix:semicolon
r_extern
r_int
id|parport_default_spintime
suffix:semicolon
r_static
r_struct
id|parport_default_sysctl_table
DECL|variable|parport_default_sysctl_table
id|parport_default_sysctl_table
op_assign
(brace
l_int|NULL
comma
(brace
(brace
id|DEV_PARPORT_DEFAULT_TIMESLICE
comma
l_string|&quot;timeslice&quot;
comma
op_amp
id|parport_default_timeslice
comma
r_sizeof
(paren
id|parport_default_timeslice
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_doulongvec_ms_jiffies_minmax
comma
l_int|NULL
comma
l_int|NULL
comma
(paren
r_void
op_star
)paren
op_amp
id|parport_min_timeslice_value
comma
(paren
r_void
op_star
)paren
op_amp
id|parport_max_timeslice_value
)brace
comma
(brace
id|DEV_PARPORT_DEFAULT_SPINTIME
comma
l_string|&quot;spintime&quot;
comma
op_amp
id|parport_default_spintime
comma
r_sizeof
(paren
id|parport_default_spintime
)paren
comma
l_int|0644
comma
l_int|NULL
comma
op_amp
id|proc_dointvec_minmax
comma
l_int|NULL
comma
l_int|NULL
comma
(paren
r_void
op_star
)paren
op_amp
id|parport_min_spintime_value
comma
(paren
r_void
op_star
)paren
op_amp
id|parport_max_spintime_value
)brace
comma
(brace
l_int|0
)brace
)brace
comma
(brace
(brace
id|DEV_PARPORT_DEFAULT
comma
l_string|&quot;default&quot;
comma
l_int|NULL
comma
l_int|0
comma
l_int|0555
comma
id|parport_default_sysctl_table.vars
)brace
comma
(brace
l_int|0
)brace
)brace
comma
(brace
id|PARPORT_PARPORT_DIR
c_func
(paren
id|parport_default_sysctl_table.default_dir
)paren
comma
(brace
l_int|0
)brace
)brace
comma
(brace
id|PARPORT_DEV_DIR
c_func
(paren
id|parport_default_sysctl_table.parport_dir
)paren
comma
(brace
l_int|0
)brace
)brace
)brace
suffix:semicolon
DECL|function|parport_proc_register
r_int
id|parport_proc_register
c_func
(paren
r_struct
id|parport
op_star
id|port
)paren
(brace
r_struct
id|parport_sysctl_table
op_star
id|t
suffix:semicolon
r_int
id|i
suffix:semicolon
id|t
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
op_star
id|t
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|t
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|memcpy
c_func
(paren
id|t
comma
op_amp
id|parport_sysctl_template
comma
r_sizeof
(paren
op_star
id|t
)paren
)paren
suffix:semicolon
id|t-&gt;device_dir
(braket
l_int|0
)braket
dot
id|extra1
op_assign
id|port
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|8
suffix:semicolon
id|i
op_increment
)paren
id|t-&gt;vars
(braket
id|i
)braket
dot
id|extra1
op_assign
id|port
suffix:semicolon
id|t-&gt;vars
(braket
l_int|0
)braket
dot
id|data
op_assign
op_amp
id|port-&gt;spintime
suffix:semicolon
id|t-&gt;vars
(braket
l_int|5
)braket
dot
id|child
op_assign
id|t-&gt;device_dir
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|5
suffix:semicolon
id|i
op_increment
)paren
id|t-&gt;vars
(braket
l_int|6
op_plus
id|i
)braket
dot
id|extra2
op_assign
op_amp
id|port-&gt;probe_info
(braket
id|i
)braket
suffix:semicolon
id|t-&gt;port_dir
(braket
l_int|0
)braket
dot
id|procname
op_assign
id|port-&gt;name
suffix:semicolon
id|t-&gt;port_dir
(braket
l_int|0
)braket
dot
id|ctl_name
op_assign
id|port-&gt;number
op_plus
l_int|1
suffix:semicolon
multiline_comment|/* nb 0 isn&squot;t legal here */
id|t-&gt;port_dir
(braket
l_int|0
)braket
dot
id|child
op_assign
id|t-&gt;vars
suffix:semicolon
id|t-&gt;parport_dir
(braket
l_int|0
)braket
dot
id|child
op_assign
id|t-&gt;port_dir
suffix:semicolon
id|t-&gt;dev_dir
(braket
l_int|0
)braket
dot
id|child
op_assign
id|t-&gt;parport_dir
suffix:semicolon
id|t-&gt;sysctl_header
op_assign
id|register_sysctl_table
c_func
(paren
id|t-&gt;dev_dir
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|t-&gt;sysctl_header
op_eq
l_int|NULL
)paren
(brace
id|kfree
c_func
(paren
id|t
)paren
suffix:semicolon
id|t
op_assign
l_int|NULL
suffix:semicolon
)brace
id|port-&gt;sysctl_table
op_assign
id|t
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|parport_proc_unregister
r_int
id|parport_proc_unregister
c_func
(paren
r_struct
id|parport
op_star
id|port
)paren
(brace
r_if
c_cond
(paren
id|port-&gt;sysctl_table
)paren
(brace
r_struct
id|parport_sysctl_table
op_star
id|t
op_assign
id|port-&gt;sysctl_table
suffix:semicolon
id|port-&gt;sysctl_table
op_assign
l_int|NULL
suffix:semicolon
id|unregister_sysctl_table
c_func
(paren
id|t-&gt;sysctl_header
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|t
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|parport_device_proc_register
r_int
id|parport_device_proc_register
c_func
(paren
r_struct
id|pardevice
op_star
id|device
)paren
(brace
r_struct
id|parport_device_sysctl_table
op_star
id|t
suffix:semicolon
r_struct
id|parport
op_star
id|port
op_assign
id|device-&gt;port
suffix:semicolon
id|t
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
op_star
id|t
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|t
op_eq
l_int|NULL
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|memcpy
c_func
(paren
id|t
comma
op_amp
id|parport_device_sysctl_template
comma
r_sizeof
(paren
op_star
id|t
)paren
)paren
suffix:semicolon
id|t-&gt;dev_dir
(braket
l_int|0
)braket
dot
id|child
op_assign
id|t-&gt;parport_dir
suffix:semicolon
id|t-&gt;parport_dir
(braket
l_int|0
)braket
dot
id|child
op_assign
id|t-&gt;port_dir
suffix:semicolon
id|t-&gt;port_dir
(braket
l_int|0
)braket
dot
id|procname
op_assign
id|port-&gt;name
suffix:semicolon
id|t-&gt;port_dir
(braket
l_int|0
)braket
dot
id|ctl_name
op_assign
id|port-&gt;number
op_plus
l_int|1
suffix:semicolon
multiline_comment|/* nb 0 isn&squot;t legal here */
id|t-&gt;port_dir
(braket
l_int|0
)braket
dot
id|child
op_assign
id|t-&gt;devices_root_dir
suffix:semicolon
id|t-&gt;devices_root_dir
(braket
l_int|0
)braket
dot
id|child
op_assign
id|t-&gt;device_dir
suffix:semicolon
macro_line|#ifdef CONFIG_PARPORT_1284
id|t-&gt;device_dir
(braket
l_int|0
)braket
dot
id|ctl_name
op_assign
id|parport_device_num
c_func
(paren
id|port-&gt;number
comma
id|port-&gt;muxport
comma
id|device-&gt;daisy
)paren
op_plus
l_int|1
suffix:semicolon
multiline_comment|/* nb 0 isn&squot;t legal here */
macro_line|#else /* No IEEE 1284 support */
multiline_comment|/* parport_device_num isn&squot;t available. */
id|t-&gt;device_dir
(braket
l_int|0
)braket
dot
id|ctl_name
op_assign
l_int|1
suffix:semicolon
macro_line|#endif /* IEEE 1284 support or not */
id|t-&gt;device_dir
(braket
l_int|0
)braket
dot
id|procname
op_assign
id|device-&gt;name
suffix:semicolon
id|t-&gt;device_dir
(braket
l_int|0
)braket
dot
id|extra1
op_assign
id|device
suffix:semicolon
id|t-&gt;device_dir
(braket
l_int|0
)braket
dot
id|child
op_assign
id|t-&gt;vars
suffix:semicolon
id|t-&gt;vars
(braket
l_int|0
)braket
dot
id|data
op_assign
op_amp
id|device-&gt;timeslice
suffix:semicolon
id|t-&gt;sysctl_header
op_assign
id|register_sysctl_table
c_func
(paren
id|t-&gt;dev_dir
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|t-&gt;sysctl_header
op_eq
l_int|NULL
)paren
(brace
id|kfree
c_func
(paren
id|t
)paren
suffix:semicolon
id|t
op_assign
l_int|NULL
suffix:semicolon
)brace
id|device-&gt;sysctl_table
op_assign
id|t
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|parport_device_proc_unregister
r_int
id|parport_device_proc_unregister
c_func
(paren
r_struct
id|pardevice
op_star
id|device
)paren
(brace
r_if
c_cond
(paren
id|device-&gt;sysctl_table
)paren
(brace
r_struct
id|parport_device_sysctl_table
op_star
id|t
op_assign
id|device-&gt;sysctl_table
suffix:semicolon
id|device-&gt;sysctl_table
op_assign
l_int|NULL
suffix:semicolon
id|unregister_sysctl_table
c_func
(paren
id|t-&gt;sysctl_header
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|t
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|parport_default_proc_register
r_int
id|parport_default_proc_register
c_func
(paren
r_void
)paren
(brace
id|parport_default_sysctl_table.sysctl_header
op_assign
id|register_sysctl_table
c_func
(paren
id|parport_default_sysctl_table.dev_dir
comma
l_int|0
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|parport_default_proc_unregister
r_int
id|parport_default_proc_unregister
c_func
(paren
r_void
)paren
(brace
r_if
c_cond
(paren
id|parport_default_sysctl_table.sysctl_header
)paren
(brace
id|unregister_sysctl_table
c_func
(paren
id|parport_default_sysctl_table
dot
id|sysctl_header
)paren
suffix:semicolon
id|parport_default_sysctl_table.sysctl_header
op_assign
l_int|NULL
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#else /* no sysctl or no procfs*/
DECL|function|parport_proc_register
r_int
id|parport_proc_register
c_func
(paren
r_struct
id|parport
op_star
id|pp
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|parport_proc_unregister
r_int
id|parport_proc_unregister
c_func
(paren
r_struct
id|parport
op_star
id|pp
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|parport_device_proc_register
r_int
id|parport_device_proc_register
c_func
(paren
r_struct
id|pardevice
op_star
id|device
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|parport_device_proc_unregister
r_int
id|parport_device_proc_unregister
c_func
(paren
r_struct
id|pardevice
op_star
id|device
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|parport_default_proc_register
r_int
id|parport_default_proc_register
(paren
r_void
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|parport_default_proc_unregister
r_int
id|parport_default_proc_unregister
(paren
r_void
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif
eof
