multiline_comment|/***************************************************************************&bslash;&n;|*                                                                           *|&n;|*       Copyright 1993-1998 NVIDIA, Corporation.  All rights reserved.      *|&n;|*                                                                           *|&n;|*     NOTICE TO USER:   The source code  is copyrighted under  U.S. and     *|&n;|*     international laws.  Users and possessors of this source code are     *|&n;|*     hereby granted a nonexclusive,  royalty-free copyright license to     *|&n;|*     use this code in individual and commercial software.                  *|&n;|*                                                                           *|&n;|*     Any use of this source code must include,  in the user documenta-     *|&n;|*     tion and  internal comments to the code,  notices to the end user     *|&n;|*     as follows:                                                           *|&n;|*                                                                           *|&n;|*       Copyright 1993-1998 NVIDIA, Corporation.  All rights reserved.      *|&n;|*                                                                           *|&n;|*     NVIDIA, CORPORATION MAKES NO REPRESENTATION ABOUT THE SUITABILITY     *|&n;|*     OF  THIS SOURCE  CODE  FOR ANY PURPOSE.  IT IS  PROVIDED  &quot;AS IS&quot;     *|&n;|*     WITHOUT EXPRESS OR IMPLIED WARRANTY OF ANY KIND.  NVIDIA, CORPOR-     *|&n;|*     ATION DISCLAIMS ALL WARRANTIES  WITH REGARD  TO THIS SOURCE CODE,     *|&n;|*     INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY, NONINFRINGE-     *|&n;|*     MENT,  AND FITNESS  FOR A PARTICULAR PURPOSE.   IN NO EVENT SHALL     *|&n;|*     NVIDIA, CORPORATION  BE LIABLE FOR ANY SPECIAL,  INDIRECT,  INCI-     *|&n;|*     DENTAL, OR CONSEQUENTIAL DAMAGES,  OR ANY DAMAGES  WHATSOEVER RE-     *|&n;|*     SULTING FROM LOSS OF USE,  DATA OR PROFITS,  WHETHER IN AN ACTION     *|&n;|*     OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION,  ARISING OUT OF     *|&n;|*     OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOURCE CODE.     *|&n;|*                                                                           *|&n;|*     U.S. Government  End  Users.   This source code  is a &quot;commercial     *|&n;|*     item,&quot;  as that  term is  defined at  48 C.F.R. 2.101 (OCT 1995),     *|&n;|*     consisting  of &quot;commercial  computer  software&quot;  and  &quot;commercial     *|&n;|*     computer  software  documentation,&quot;  as such  terms  are  used in     *|&n;|*     48 C.F.R. 12.212 (SEPT 1995)  and is provided to the U.S. Govern-     *|&n;|*     ment only as  a commercial end item.   Consistent with  48 C.F.R.     *|&n;|*     12.212 and  48 C.F.R. 227.7202-1 through  227.7202-4 (JUNE 1995),     *|&n;|*     all U.S. Government End Users  acquire the source code  with only     *|&n;|*     those rights set forth herein.                                        *|&n;|*                                                                           *|&n; &bslash;***************************************************************************/
multiline_comment|/* &n; * GPL licensing note -- nVidia is allowing a liberal interpretation of &n; * the documentation restriction above, to merely say that this nVidia&squot;s&n; * copyright and disclaimer should be included with all code derived &n; * from this source.  -- Jeff Garzik &lt;jgarzik@mandrakesoft.com&gt;, 01/Nov/99&n; */
multiline_comment|/* $XFree86: xc/programs/Xserver/hw/xfree86/vga256/drivers/nv/riva_hw.c,v 1.1.2.3 1998/12/26 00:12:39 dawes Exp $ */
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &quot;riva_hw.h&quot;
macro_line|#include &quot;riva_tbl.h&quot;
multiline_comment|/*&n; * This file is an OS-agnostic file used to make RIVA 128 and RIVA TNT&n; * operate identically (except TNT has more memory and better 3D quality.&n; */
DECL|function|nv3Busy
r_static
r_int
id|nv3Busy
(paren
id|RIVA_HW_INST
op_star
id|chip
)paren
(brace
r_return
(paren
(paren
op_logical_neg
(paren
id|chip-&gt;PFIFO
(braket
l_int|0x00001214
op_div
l_int|4
)braket
op_amp
l_int|0x10
)paren
)paren
op_or
(paren
id|chip-&gt;PGRAPH
(braket
l_int|0x000006B0
op_div
l_int|4
)braket
op_amp
l_int|0x01
)paren
)paren
suffix:semicolon
)brace
DECL|function|nv4Busy
r_static
r_int
id|nv4Busy
(paren
id|RIVA_HW_INST
op_star
id|chip
)paren
(brace
r_return
(paren
(paren
op_logical_neg
(paren
id|chip-&gt;PFIFO
(braket
l_int|0x00001214
op_div
l_int|4
)braket
op_amp
l_int|0x10
)paren
)paren
op_or
(paren
id|chip-&gt;PGRAPH
(braket
l_int|0x00000700
op_div
l_int|4
)braket
op_amp
l_int|0x01
)paren
)paren
suffix:semicolon
)brace
DECL|function|ShowHideCursor
r_static
r_int
id|ShowHideCursor
(paren
id|RIVA_HW_INST
op_star
id|chip
comma
r_int
id|ShowHide
)paren
(brace
r_int
id|xcurrent
suffix:semicolon
id|xcurrent
op_assign
id|chip-&gt;CurrentState-&gt;cursor1
suffix:semicolon
id|chip-&gt;CurrentState-&gt;cursor1
op_assign
(paren
id|chip-&gt;CurrentState-&gt;cursor1
op_amp
l_int|0xFE
)paren
op_or
(paren
id|ShowHide
op_amp
l_int|0x01
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0x31
comma
l_int|0x3D4
)paren
suffix:semicolon
id|outb
c_func
(paren
id|chip-&gt;CurrentState-&gt;cursor1
comma
l_int|0x3D5
)paren
suffix:semicolon
r_return
(paren
id|xcurrent
op_amp
l_int|0x01
)paren
suffix:semicolon
)brace
multiline_comment|/****************************************************************************&bslash;&n;*                                                                            *&n;* The video arbitration routines calculate some &quot;magic&quot; numbers.  Fixes      *&n;* the snow seen when accessing the framebuffer without it.                   *&n;* It just works (I hope).                                                    *&n;*                                                                            *&n;&bslash;****************************************************************************/
DECL|macro|DEFAULT_GR_LWM
mdefine_line|#define DEFAULT_GR_LWM 100
DECL|macro|DEFAULT_VID_LWM
mdefine_line|#define DEFAULT_VID_LWM 100
DECL|macro|DEFAULT_GR_BURST_SIZE
mdefine_line|#define DEFAULT_GR_BURST_SIZE 256
DECL|macro|DEFAULT_VID_BURST_SIZE
mdefine_line|#define DEFAULT_VID_BURST_SIZE 128
DECL|macro|VIDEO
mdefine_line|#define VIDEO&t;&t;0
DECL|macro|GRAPHICS
mdefine_line|#define GRAPHICS&t;1
DECL|macro|MPORT
mdefine_line|#define MPORT&t;&t;2
DECL|macro|ENGINE
mdefine_line|#define ENGINE&t;&t;3
DECL|macro|GFIFO_SIZE
mdefine_line|#define GFIFO_SIZE&t;320
DECL|macro|GFIFO_SIZE_128
mdefine_line|#define GFIFO_SIZE_128&t;256
DECL|macro|MFIFO_SIZE
mdefine_line|#define MFIFO_SIZE&t;120
DECL|macro|VFIFO_SIZE
mdefine_line|#define VFIFO_SIZE&t;256
DECL|macro|ABS
mdefine_line|#define&t;ABS(a)&t;(a&gt;0?a:-a)
r_typedef
r_struct
(brace
DECL|member|gdrain_rate
r_int
id|gdrain_rate
suffix:semicolon
DECL|member|vdrain_rate
r_int
id|vdrain_rate
suffix:semicolon
DECL|member|mdrain_rate
r_int
id|mdrain_rate
suffix:semicolon
DECL|member|gburst_size
r_int
id|gburst_size
suffix:semicolon
DECL|member|vburst_size
r_int
id|vburst_size
suffix:semicolon
DECL|member|vid_en
r_char
id|vid_en
suffix:semicolon
DECL|member|gr_en
r_char
id|gr_en
suffix:semicolon
DECL|member|wcmocc
DECL|member|wcgocc
DECL|member|wcvocc
DECL|member|wcvlwm
DECL|member|wcglwm
r_int
id|wcmocc
comma
id|wcgocc
comma
id|wcvocc
comma
id|wcvlwm
comma
id|wcglwm
suffix:semicolon
DECL|member|by_gfacc
r_int
id|by_gfacc
suffix:semicolon
DECL|member|vid_only_once
r_char
id|vid_only_once
suffix:semicolon
DECL|member|gr_only_once
r_char
id|gr_only_once
suffix:semicolon
DECL|member|first_vacc
r_char
id|first_vacc
suffix:semicolon
DECL|member|first_gacc
r_char
id|first_gacc
suffix:semicolon
DECL|member|first_macc
r_char
id|first_macc
suffix:semicolon
DECL|member|vocc
r_int
id|vocc
suffix:semicolon
DECL|member|gocc
r_int
id|gocc
suffix:semicolon
DECL|member|mocc
r_int
id|mocc
suffix:semicolon
DECL|member|cur
r_char
id|cur
suffix:semicolon
DECL|member|engine_en
r_char
id|engine_en
suffix:semicolon
DECL|member|converged
r_char
id|converged
suffix:semicolon
DECL|member|priority
r_int
id|priority
suffix:semicolon
DECL|typedef|nv3_arb_info
)brace
id|nv3_arb_info
suffix:semicolon
r_typedef
r_struct
(brace
DECL|member|graphics_lwm
r_int
id|graphics_lwm
suffix:semicolon
DECL|member|video_lwm
r_int
id|video_lwm
suffix:semicolon
DECL|member|graphics_burst_size
r_int
id|graphics_burst_size
suffix:semicolon
DECL|member|video_burst_size
r_int
id|video_burst_size
suffix:semicolon
DECL|member|graphics_hi_priority
r_int
id|graphics_hi_priority
suffix:semicolon
DECL|member|media_hi_priority
r_int
id|media_hi_priority
suffix:semicolon
DECL|member|rtl_values
r_int
id|rtl_values
suffix:semicolon
DECL|member|valid
r_int
id|valid
suffix:semicolon
DECL|typedef|nv3_fifo_info
)brace
id|nv3_fifo_info
suffix:semicolon
r_typedef
r_struct
(brace
DECL|member|pix_bpp
r_char
id|pix_bpp
suffix:semicolon
DECL|member|enable_video
r_char
id|enable_video
suffix:semicolon
DECL|member|gr_during_vid
r_char
id|gr_during_vid
suffix:semicolon
DECL|member|enable_mp
r_char
id|enable_mp
suffix:semicolon
DECL|member|memory_width
r_int
id|memory_width
suffix:semicolon
DECL|member|video_scale
r_int
id|video_scale
suffix:semicolon
DECL|member|pclk_khz
r_int
id|pclk_khz
suffix:semicolon
DECL|member|mclk_khz
r_int
id|mclk_khz
suffix:semicolon
DECL|member|mem_page_miss
r_int
id|mem_page_miss
suffix:semicolon
DECL|member|mem_latency
r_int
id|mem_latency
suffix:semicolon
DECL|member|mem_aligned
r_char
id|mem_aligned
suffix:semicolon
DECL|typedef|nv3_sim_state
)brace
id|nv3_sim_state
suffix:semicolon
r_typedef
r_struct
(brace
DECL|member|graphics_lwm
r_int
id|graphics_lwm
suffix:semicolon
DECL|member|video_lwm
r_int
id|video_lwm
suffix:semicolon
DECL|member|graphics_burst_size
r_int
id|graphics_burst_size
suffix:semicolon
DECL|member|video_burst_size
r_int
id|video_burst_size
suffix:semicolon
DECL|member|valid
r_int
id|valid
suffix:semicolon
DECL|typedef|nv4_fifo_info
)brace
id|nv4_fifo_info
suffix:semicolon
r_typedef
r_struct
(brace
DECL|member|pclk_khz
r_int
id|pclk_khz
suffix:semicolon
DECL|member|mclk_khz
r_int
id|mclk_khz
suffix:semicolon
DECL|member|nvclk_khz
r_int
id|nvclk_khz
suffix:semicolon
DECL|member|mem_page_miss
r_char
id|mem_page_miss
suffix:semicolon
DECL|member|mem_latency
r_char
id|mem_latency
suffix:semicolon
DECL|member|memory_width
r_int
id|memory_width
suffix:semicolon
DECL|member|enable_video
r_char
id|enable_video
suffix:semicolon
DECL|member|gr_during_vid
r_char
id|gr_during_vid
suffix:semicolon
DECL|member|pix_bpp
r_char
id|pix_bpp
suffix:semicolon
DECL|member|mem_aligned
r_char
id|mem_aligned
suffix:semicolon
DECL|member|enable_mp
r_char
id|enable_mp
suffix:semicolon
DECL|typedef|nv4_sim_state
)brace
id|nv4_sim_state
suffix:semicolon
DECL|function|nv3_iterate
r_static
r_int
id|nv3_iterate
c_func
(paren
id|nv3_fifo_info
op_star
id|res_info
comma
id|nv3_sim_state
op_star
id|state
comma
id|nv3_arb_info
op_star
id|ainfo
)paren
(brace
r_int
id|iter
op_assign
l_int|0
suffix:semicolon
r_int
id|tmp
suffix:semicolon
r_int
id|vfsize
comma
id|mfsize
comma
id|gfsize
suffix:semicolon
r_int
id|mburst_size
op_assign
l_int|32
suffix:semicolon
r_int
id|mmisses
comma
id|gmisses
comma
id|vmisses
suffix:semicolon
r_int
id|misses
suffix:semicolon
r_int
id|vlwm
comma
id|glwm
comma
id|mlwm
suffix:semicolon
r_int
id|last
comma
id|next
comma
id|cur
suffix:semicolon
r_int
id|max_gfsize
suffix:semicolon
r_int
id|ns
suffix:semicolon
id|vlwm
op_assign
l_int|0
suffix:semicolon
id|glwm
op_assign
l_int|0
suffix:semicolon
id|mlwm
op_assign
l_int|0
suffix:semicolon
id|vfsize
op_assign
l_int|0
suffix:semicolon
id|gfsize
op_assign
l_int|0
suffix:semicolon
id|cur
op_assign
id|ainfo-&gt;cur
suffix:semicolon
id|mmisses
op_assign
l_int|2
suffix:semicolon
id|gmisses
op_assign
l_int|2
suffix:semicolon
id|vmisses
op_assign
l_int|2
suffix:semicolon
r_if
c_cond
(paren
id|ainfo-&gt;gburst_size
op_eq
l_int|128
)paren
id|max_gfsize
op_assign
id|GFIFO_SIZE_128
suffix:semicolon
r_else
id|max_gfsize
op_assign
id|GFIFO_SIZE
suffix:semicolon
id|max_gfsize
op_assign
id|GFIFO_SIZE
suffix:semicolon
r_while
c_loop
(paren
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|ainfo-&gt;vid_en
)paren
(brace
r_if
c_cond
(paren
id|ainfo-&gt;wcvocc
OG
id|ainfo-&gt;vocc
)paren
id|ainfo-&gt;wcvocc
op_assign
id|ainfo-&gt;vocc
suffix:semicolon
r_if
c_cond
(paren
id|ainfo-&gt;wcvlwm
OG
id|vlwm
)paren
id|ainfo-&gt;wcvlwm
op_assign
id|vlwm
suffix:semicolon
id|ns
op_assign
l_int|1000000
op_star
id|ainfo-&gt;vburst_size
op_div
(paren
id|state-&gt;memory_width
op_div
l_int|8
)paren
op_div
id|state-&gt;mclk_khz
suffix:semicolon
id|vfsize
op_assign
id|ns
op_star
id|ainfo-&gt;vdrain_rate
op_div
l_int|1000000
suffix:semicolon
id|vfsize
op_assign
id|ainfo-&gt;wcvlwm
op_minus
id|ainfo-&gt;vburst_size
op_plus
id|vfsize
suffix:semicolon
)brace
r_if
c_cond
(paren
id|state-&gt;enable_mp
)paren
(brace
r_if
c_cond
(paren
id|ainfo-&gt;wcmocc
OG
id|ainfo-&gt;mocc
)paren
id|ainfo-&gt;wcmocc
op_assign
id|ainfo-&gt;mocc
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ainfo-&gt;gr_en
)paren
(brace
r_if
c_cond
(paren
id|ainfo-&gt;wcglwm
OG
id|glwm
)paren
id|ainfo-&gt;wcglwm
op_assign
id|glwm
suffix:semicolon
r_if
c_cond
(paren
id|ainfo-&gt;wcgocc
OG
id|ainfo-&gt;gocc
)paren
id|ainfo-&gt;wcgocc
op_assign
id|ainfo-&gt;gocc
suffix:semicolon
id|ns
op_assign
l_int|1000000
op_star
(paren
id|ainfo-&gt;gburst_size
op_div
(paren
id|state-&gt;memory_width
op_div
l_int|8
)paren
)paren
op_div
id|state-&gt;mclk_khz
suffix:semicolon
id|gfsize
op_assign
id|ns
op_star
id|ainfo-&gt;gdrain_rate
op_div
l_int|1000000
suffix:semicolon
id|gfsize
op_assign
id|ainfo-&gt;wcglwm
op_minus
id|ainfo-&gt;gburst_size
op_plus
id|gfsize
suffix:semicolon
)brace
id|mfsize
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|state-&gt;gr_during_vid
op_logical_and
id|ainfo-&gt;vid_en
)paren
r_if
c_cond
(paren
id|ainfo-&gt;vid_en
op_logical_and
(paren
id|ainfo-&gt;vocc
OL
l_int|0
)paren
op_logical_and
op_logical_neg
id|ainfo-&gt;vid_only_once
)paren
id|next
op_assign
id|VIDEO
suffix:semicolon
r_else
r_if
c_cond
(paren
id|ainfo-&gt;mocc
OL
l_int|0
)paren
id|next
op_assign
id|MPORT
suffix:semicolon
r_else
r_if
c_cond
(paren
id|ainfo-&gt;gocc
OL
id|ainfo-&gt;by_gfacc
)paren
id|next
op_assign
id|GRAPHICS
suffix:semicolon
r_else
r_return
(paren
l_int|0
)paren
suffix:semicolon
r_else
r_switch
c_cond
(paren
id|ainfo-&gt;priority
)paren
(brace
r_case
id|VIDEO
suffix:colon
r_if
c_cond
(paren
id|ainfo-&gt;vid_en
op_logical_and
id|ainfo-&gt;vocc
OL
l_int|0
op_logical_and
op_logical_neg
id|ainfo-&gt;vid_only_once
)paren
id|next
op_assign
id|VIDEO
suffix:semicolon
r_else
r_if
c_cond
(paren
id|ainfo-&gt;gr_en
op_logical_and
id|ainfo-&gt;gocc
OL
l_int|0
op_logical_and
op_logical_neg
id|ainfo-&gt;gr_only_once
)paren
id|next
op_assign
id|GRAPHICS
suffix:semicolon
r_else
r_if
c_cond
(paren
id|ainfo-&gt;mocc
OL
l_int|0
)paren
id|next
op_assign
id|MPORT
suffix:semicolon
r_else
r_return
(paren
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|GRAPHICS
suffix:colon
r_if
c_cond
(paren
id|ainfo-&gt;gr_en
op_logical_and
id|ainfo-&gt;gocc
OL
l_int|0
op_logical_and
op_logical_neg
id|ainfo-&gt;gr_only_once
)paren
id|next
op_assign
id|GRAPHICS
suffix:semicolon
r_else
r_if
c_cond
(paren
id|ainfo-&gt;vid_en
op_logical_and
id|ainfo-&gt;vocc
OL
l_int|0
op_logical_and
op_logical_neg
id|ainfo-&gt;vid_only_once
)paren
id|next
op_assign
id|VIDEO
suffix:semicolon
r_else
r_if
c_cond
(paren
id|ainfo-&gt;mocc
OL
l_int|0
)paren
id|next
op_assign
id|MPORT
suffix:semicolon
r_else
r_return
(paren
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
(brace
)brace
r_if
c_cond
(paren
id|ainfo-&gt;mocc
OL
l_int|0
)paren
id|next
op_assign
id|MPORT
suffix:semicolon
r_else
r_if
c_cond
(paren
id|ainfo-&gt;gr_en
op_logical_and
id|ainfo-&gt;gocc
OL
l_int|0
op_logical_and
op_logical_neg
id|ainfo-&gt;gr_only_once
)paren
id|next
op_assign
id|GRAPHICS
suffix:semicolon
r_else
r_if
c_cond
(paren
id|ainfo-&gt;vid_en
op_logical_and
id|ainfo-&gt;vocc
OL
l_int|0
op_logical_and
op_logical_neg
id|ainfo-&gt;vid_only_once
)paren
id|next
op_assign
id|VIDEO
suffix:semicolon
r_else
r_return
(paren
l_int|0
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|last
op_assign
id|cur
suffix:semicolon
id|cur
op_assign
id|next
suffix:semicolon
id|iter
op_increment
suffix:semicolon
r_switch
c_cond
(paren
id|cur
)paren
(brace
r_case
id|VIDEO
suffix:colon
r_if
c_cond
(paren
id|last
op_eq
id|cur
)paren
id|misses
op_assign
l_int|0
suffix:semicolon
r_else
r_if
c_cond
(paren
id|ainfo-&gt;first_vacc
)paren
id|misses
op_assign
id|vmisses
suffix:semicolon
r_else
id|misses
op_assign
l_int|1
suffix:semicolon
id|ainfo-&gt;first_vacc
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|last
op_ne
id|cur
)paren
(brace
id|ns
op_assign
l_int|1000000
op_star
(paren
id|vmisses
op_star
id|state-&gt;mem_page_miss
op_plus
id|state-&gt;mem_latency
)paren
op_div
id|state-&gt;mclk_khz
suffix:semicolon
id|vlwm
op_assign
id|ns
op_star
id|ainfo-&gt;vdrain_rate
op_div
l_int|1000000
suffix:semicolon
id|vlwm
op_assign
id|ainfo-&gt;vocc
op_minus
id|vlwm
suffix:semicolon
)brace
id|ns
op_assign
l_int|1000000
op_star
(paren
id|misses
op_star
id|state-&gt;mem_page_miss
op_plus
id|ainfo-&gt;vburst_size
)paren
op_div
(paren
id|state-&gt;memory_width
op_div
l_int|8
)paren
op_div
id|state-&gt;mclk_khz
suffix:semicolon
id|ainfo-&gt;vocc
op_assign
id|ainfo-&gt;vocc
op_plus
id|ainfo-&gt;vburst_size
op_minus
id|ns
op_star
id|ainfo-&gt;vdrain_rate
op_div
l_int|1000000
suffix:semicolon
id|ainfo-&gt;gocc
op_assign
id|ainfo-&gt;gocc
op_minus
id|ns
op_star
id|ainfo-&gt;gdrain_rate
op_div
l_int|1000000
suffix:semicolon
id|ainfo-&gt;mocc
op_assign
id|ainfo-&gt;mocc
op_minus
id|ns
op_star
id|ainfo-&gt;mdrain_rate
op_div
l_int|1000000
suffix:semicolon
r_break
suffix:semicolon
r_case
id|GRAPHICS
suffix:colon
r_if
c_cond
(paren
id|last
op_eq
id|cur
)paren
id|misses
op_assign
l_int|0
suffix:semicolon
r_else
r_if
c_cond
(paren
id|ainfo-&gt;first_gacc
)paren
id|misses
op_assign
id|gmisses
suffix:semicolon
r_else
id|misses
op_assign
l_int|1
suffix:semicolon
id|ainfo-&gt;first_gacc
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|last
op_ne
id|cur
)paren
(brace
id|ns
op_assign
l_int|1000000
op_star
(paren
id|gmisses
op_star
id|state-&gt;mem_page_miss
op_plus
id|state-&gt;mem_latency
)paren
op_div
id|state-&gt;mclk_khz
suffix:semicolon
id|glwm
op_assign
id|ns
op_star
id|ainfo-&gt;gdrain_rate
op_div
l_int|1000000
suffix:semicolon
id|glwm
op_assign
id|ainfo-&gt;gocc
op_minus
id|glwm
suffix:semicolon
)brace
id|ns
op_assign
l_int|1000000
op_star
(paren
id|misses
op_star
id|state-&gt;mem_page_miss
op_plus
id|ainfo-&gt;gburst_size
op_div
(paren
id|state-&gt;memory_width
op_div
l_int|8
)paren
)paren
op_div
id|state-&gt;mclk_khz
suffix:semicolon
id|ainfo-&gt;vocc
op_assign
id|ainfo-&gt;vocc
op_plus
l_int|0
op_minus
id|ns
op_star
id|ainfo-&gt;vdrain_rate
op_div
l_int|1000000
suffix:semicolon
id|ainfo-&gt;gocc
op_assign
id|ainfo-&gt;gocc
op_plus
id|ainfo-&gt;gburst_size
op_minus
id|ns
op_star
id|ainfo-&gt;gdrain_rate
op_div
l_int|1000000
suffix:semicolon
id|ainfo-&gt;mocc
op_assign
id|ainfo-&gt;mocc
op_plus
l_int|0
op_minus
id|ns
op_star
id|ainfo-&gt;mdrain_rate
op_div
l_int|1000000
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
(brace
)brace
r_if
c_cond
(paren
id|last
op_eq
id|cur
)paren
id|misses
op_assign
l_int|0
suffix:semicolon
r_else
r_if
c_cond
(paren
id|ainfo-&gt;first_macc
)paren
id|misses
op_assign
id|mmisses
suffix:semicolon
r_else
id|misses
op_assign
l_int|1
suffix:semicolon
id|ainfo-&gt;first_macc
op_assign
l_int|0
suffix:semicolon
id|ns
op_assign
l_int|1000000
op_star
(paren
id|misses
op_star
id|state-&gt;mem_page_miss
op_plus
id|mburst_size
op_div
(paren
id|state-&gt;memory_width
op_div
l_int|8
)paren
)paren
op_div
id|state-&gt;mclk_khz
suffix:semicolon
id|ainfo-&gt;vocc
op_assign
id|ainfo-&gt;vocc
op_plus
l_int|0
op_minus
id|ns
op_star
id|ainfo-&gt;vdrain_rate
op_div
l_int|1000000
suffix:semicolon
id|ainfo-&gt;gocc
op_assign
id|ainfo-&gt;gocc
op_plus
l_int|0
op_minus
id|ns
op_star
id|ainfo-&gt;gdrain_rate
op_div
l_int|1000000
suffix:semicolon
id|ainfo-&gt;mocc
op_assign
id|ainfo-&gt;mocc
op_plus
id|mburst_size
op_minus
id|ns
op_star
id|ainfo-&gt;mdrain_rate
op_div
l_int|1000000
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|iter
OG
l_int|100
)paren
(brace
id|ainfo-&gt;converged
op_assign
l_int|0
suffix:semicolon
r_return
(paren
l_int|1
)paren
suffix:semicolon
)brace
id|ns
op_assign
l_int|1000000
op_star
id|ainfo-&gt;gburst_size
op_div
(paren
id|state-&gt;memory_width
op_div
l_int|8
)paren
op_div
id|state-&gt;mclk_khz
suffix:semicolon
id|tmp
op_assign
id|ns
op_star
id|ainfo-&gt;gdrain_rate
op_div
l_int|1000000
suffix:semicolon
r_if
c_cond
(paren
id|ABS
c_func
(paren
id|ainfo-&gt;gburst_size
)paren
op_plus
(paren
(paren
id|ABS
c_func
(paren
id|ainfo-&gt;wcglwm
)paren
op_plus
l_int|16
)paren
op_amp
op_complement
l_int|0x7
)paren
op_minus
id|tmp
OG
id|max_gfsize
)paren
(brace
id|ainfo-&gt;converged
op_assign
l_int|0
suffix:semicolon
r_return
(paren
l_int|1
)paren
suffix:semicolon
)brace
id|ns
op_assign
l_int|1000000
op_star
id|ainfo-&gt;vburst_size
op_div
(paren
id|state-&gt;memory_width
op_div
l_int|8
)paren
op_div
id|state-&gt;mclk_khz
suffix:semicolon
id|tmp
op_assign
id|ns
op_star
id|ainfo-&gt;vdrain_rate
op_div
l_int|1000000
suffix:semicolon
r_if
c_cond
(paren
id|ABS
c_func
(paren
id|ainfo-&gt;vburst_size
)paren
op_plus
(paren
id|ABS
c_func
(paren
id|ainfo-&gt;wcvlwm
op_plus
l_int|32
)paren
op_amp
op_complement
l_int|0xf
)paren
op_minus
id|tmp
OG
id|VFIFO_SIZE
)paren
(brace
id|ainfo-&gt;converged
op_assign
l_int|0
suffix:semicolon
r_return
(paren
l_int|1
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ABS
c_func
(paren
id|ainfo-&gt;gocc
)paren
OG
id|max_gfsize
)paren
(brace
id|ainfo-&gt;converged
op_assign
l_int|0
suffix:semicolon
r_return
(paren
l_int|1
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ABS
c_func
(paren
id|ainfo-&gt;vocc
)paren
OG
id|VFIFO_SIZE
)paren
(brace
id|ainfo-&gt;converged
op_assign
l_int|0
suffix:semicolon
r_return
(paren
l_int|1
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ABS
c_func
(paren
id|ainfo-&gt;mocc
)paren
OG
id|MFIFO_SIZE
)paren
(brace
id|ainfo-&gt;converged
op_assign
l_int|0
suffix:semicolon
r_return
(paren
l_int|1
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ABS
c_func
(paren
id|vfsize
)paren
OG
id|VFIFO_SIZE
)paren
(brace
id|ainfo-&gt;converged
op_assign
l_int|0
suffix:semicolon
r_return
(paren
l_int|1
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ABS
c_func
(paren
id|gfsize
)paren
OG
id|max_gfsize
)paren
(brace
id|ainfo-&gt;converged
op_assign
l_int|0
suffix:semicolon
r_return
(paren
l_int|1
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ABS
c_func
(paren
id|mfsize
)paren
OG
id|MFIFO_SIZE
)paren
(brace
id|ainfo-&gt;converged
op_assign
l_int|0
suffix:semicolon
r_return
(paren
l_int|1
)paren
suffix:semicolon
)brace
)brace
)brace
DECL|function|nv3_arb
r_static
r_char
id|nv3_arb
c_func
(paren
id|nv3_fifo_info
op_star
id|res_info
comma
id|nv3_sim_state
op_star
id|state
comma
id|nv3_arb_info
op_star
id|ainfo
)paren
(brace
r_int
id|ens
comma
id|vns
comma
id|mns
comma
id|gns
suffix:semicolon
r_int
id|mmisses
comma
id|gmisses
comma
id|vmisses
comma
id|eburst_size
comma
id|mburst_size
suffix:semicolon
r_int
id|refresh_cycle
suffix:semicolon
id|refresh_cycle
op_assign
l_int|0
suffix:semicolon
id|refresh_cycle
op_assign
l_int|2
op_star
(paren
id|state-&gt;mclk_khz
op_div
id|state-&gt;pclk_khz
)paren
op_plus
l_int|5
suffix:semicolon
id|mmisses
op_assign
l_int|2
suffix:semicolon
r_if
c_cond
(paren
id|state-&gt;mem_aligned
)paren
id|gmisses
op_assign
l_int|2
suffix:semicolon
r_else
id|gmisses
op_assign
l_int|3
suffix:semicolon
id|vmisses
op_assign
l_int|2
suffix:semicolon
id|eburst_size
op_assign
id|state-&gt;memory_width
op_star
l_int|1
suffix:semicolon
id|mburst_size
op_assign
l_int|32
suffix:semicolon
id|gns
op_assign
l_int|1000000
op_star
(paren
id|gmisses
op_star
id|state-&gt;mem_page_miss
op_plus
id|state-&gt;mem_latency
)paren
op_div
id|state-&gt;mclk_khz
suffix:semicolon
id|ainfo-&gt;by_gfacc
op_assign
id|gns
op_star
id|ainfo-&gt;gdrain_rate
op_div
l_int|1000000
suffix:semicolon
id|ainfo-&gt;wcmocc
op_assign
l_int|0
suffix:semicolon
id|ainfo-&gt;wcgocc
op_assign
l_int|0
suffix:semicolon
id|ainfo-&gt;wcvocc
op_assign
l_int|0
suffix:semicolon
id|ainfo-&gt;wcvlwm
op_assign
l_int|0
suffix:semicolon
id|ainfo-&gt;wcglwm
op_assign
l_int|0
suffix:semicolon
id|ainfo-&gt;engine_en
op_assign
l_int|1
suffix:semicolon
id|ainfo-&gt;converged
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|ainfo-&gt;engine_en
)paren
(brace
id|ens
op_assign
l_int|1000000
op_star
(paren
id|state-&gt;mem_page_miss
op_plus
id|eburst_size
op_div
(paren
id|state-&gt;memory_width
op_div
l_int|8
)paren
op_plus
id|refresh_cycle
)paren
op_div
id|state-&gt;mclk_khz
suffix:semicolon
id|ainfo-&gt;mocc
op_assign
id|state-&gt;enable_mp
ques
c_cond
l_int|0
op_minus
id|ens
op_star
id|ainfo-&gt;mdrain_rate
op_div
l_int|1000000
suffix:colon
l_int|0
suffix:semicolon
id|ainfo-&gt;vocc
op_assign
id|ainfo-&gt;vid_en
ques
c_cond
l_int|0
op_minus
id|ens
op_star
id|ainfo-&gt;vdrain_rate
op_div
l_int|1000000
suffix:colon
l_int|0
suffix:semicolon
id|ainfo-&gt;gocc
op_assign
id|ainfo-&gt;gr_en
ques
c_cond
l_int|0
op_minus
id|ens
op_star
id|ainfo-&gt;gdrain_rate
op_div
l_int|1000000
suffix:colon
l_int|0
suffix:semicolon
id|ainfo-&gt;cur
op_assign
id|ENGINE
suffix:semicolon
id|ainfo-&gt;first_vacc
op_assign
l_int|1
suffix:semicolon
id|ainfo-&gt;first_gacc
op_assign
l_int|1
suffix:semicolon
id|ainfo-&gt;first_macc
op_assign
l_int|1
suffix:semicolon
id|nv3_iterate
c_func
(paren
id|res_info
comma
id|state
comma
id|ainfo
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|state-&gt;enable_mp
)paren
(brace
id|mns
op_assign
l_int|1000000
op_star
(paren
id|mmisses
op_star
id|state-&gt;mem_page_miss
op_plus
id|mburst_size
op_div
(paren
id|state-&gt;memory_width
op_div
l_int|8
)paren
op_plus
id|refresh_cycle
)paren
op_div
id|state-&gt;mclk_khz
suffix:semicolon
id|ainfo-&gt;mocc
op_assign
id|state-&gt;enable_mp
ques
c_cond
l_int|0
suffix:colon
id|mburst_size
op_minus
id|mns
op_star
id|ainfo-&gt;mdrain_rate
op_div
l_int|1000000
suffix:semicolon
id|ainfo-&gt;vocc
op_assign
id|ainfo-&gt;vid_en
ques
c_cond
l_int|0
suffix:colon
l_int|0
op_minus
id|mns
op_star
id|ainfo-&gt;vdrain_rate
op_div
l_int|1000000
suffix:semicolon
id|ainfo-&gt;gocc
op_assign
id|ainfo-&gt;gr_en
ques
c_cond
l_int|0
suffix:colon
l_int|0
op_minus
id|mns
op_star
id|ainfo-&gt;gdrain_rate
op_div
l_int|1000000
suffix:semicolon
id|ainfo-&gt;cur
op_assign
id|MPORT
suffix:semicolon
id|ainfo-&gt;first_vacc
op_assign
l_int|1
suffix:semicolon
id|ainfo-&gt;first_gacc
op_assign
l_int|1
suffix:semicolon
id|ainfo-&gt;first_macc
op_assign
l_int|0
suffix:semicolon
id|nv3_iterate
c_func
(paren
id|res_info
comma
id|state
comma
id|ainfo
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ainfo-&gt;gr_en
)paren
(brace
id|ainfo-&gt;first_vacc
op_assign
l_int|1
suffix:semicolon
id|ainfo-&gt;first_gacc
op_assign
l_int|0
suffix:semicolon
id|ainfo-&gt;first_macc
op_assign
l_int|1
suffix:semicolon
id|gns
op_assign
l_int|1000000
op_star
(paren
id|gmisses
op_star
id|state-&gt;mem_page_miss
op_plus
id|ainfo-&gt;gburst_size
op_div
(paren
id|state-&gt;memory_width
op_div
l_int|8
)paren
op_plus
id|refresh_cycle
)paren
op_div
id|state-&gt;mclk_khz
suffix:semicolon
id|ainfo-&gt;gocc
op_assign
id|ainfo-&gt;gburst_size
op_minus
id|gns
op_star
id|ainfo-&gt;gdrain_rate
op_div
l_int|1000000
suffix:semicolon
id|ainfo-&gt;vocc
op_assign
id|ainfo-&gt;vid_en
ques
c_cond
l_int|0
op_minus
id|gns
op_star
id|ainfo-&gt;vdrain_rate
op_div
l_int|1000000
suffix:colon
l_int|0
suffix:semicolon
id|ainfo-&gt;mocc
op_assign
id|state-&gt;enable_mp
ques
c_cond
l_int|0
op_minus
id|gns
op_star
id|ainfo-&gt;mdrain_rate
op_div
l_int|1000000
suffix:colon
l_int|0
suffix:semicolon
id|ainfo-&gt;cur
op_assign
id|GRAPHICS
suffix:semicolon
id|nv3_iterate
c_func
(paren
id|res_info
comma
id|state
comma
id|ainfo
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ainfo-&gt;vid_en
)paren
(brace
id|ainfo-&gt;first_vacc
op_assign
l_int|0
suffix:semicolon
id|ainfo-&gt;first_gacc
op_assign
l_int|1
suffix:semicolon
id|ainfo-&gt;first_macc
op_assign
l_int|1
suffix:semicolon
id|vns
op_assign
l_int|1000000
op_star
(paren
id|vmisses
op_star
id|state-&gt;mem_page_miss
op_plus
id|ainfo-&gt;vburst_size
op_div
(paren
id|state-&gt;memory_width
op_div
l_int|8
)paren
op_plus
id|refresh_cycle
)paren
op_div
id|state-&gt;mclk_khz
suffix:semicolon
id|ainfo-&gt;vocc
op_assign
id|ainfo-&gt;vburst_size
op_minus
id|vns
op_star
id|ainfo-&gt;vdrain_rate
op_div
l_int|1000000
suffix:semicolon
id|ainfo-&gt;gocc
op_assign
id|ainfo-&gt;gr_en
ques
c_cond
(paren
l_int|0
op_minus
id|vns
op_star
id|ainfo-&gt;gdrain_rate
op_div
l_int|1000000
)paren
suffix:colon
l_int|0
suffix:semicolon
id|ainfo-&gt;mocc
op_assign
id|state-&gt;enable_mp
ques
c_cond
l_int|0
op_minus
id|vns
op_star
id|ainfo-&gt;mdrain_rate
op_div
l_int|1000000
suffix:colon
l_int|0
suffix:semicolon
id|ainfo-&gt;cur
op_assign
id|VIDEO
suffix:semicolon
id|nv3_iterate
c_func
(paren
id|res_info
comma
id|state
comma
id|ainfo
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ainfo-&gt;converged
)paren
(brace
id|res_info-&gt;graphics_lwm
op_assign
(paren
r_int
)paren
id|ABS
c_func
(paren
id|ainfo-&gt;wcglwm
)paren
op_plus
l_int|16
suffix:semicolon
id|res_info-&gt;video_lwm
op_assign
(paren
r_int
)paren
id|ABS
c_func
(paren
id|ainfo-&gt;wcvlwm
)paren
op_plus
l_int|32
suffix:semicolon
id|res_info-&gt;graphics_burst_size
op_assign
id|ainfo-&gt;gburst_size
suffix:semicolon
id|res_info-&gt;video_burst_size
op_assign
id|ainfo-&gt;vburst_size
suffix:semicolon
id|res_info-&gt;graphics_hi_priority
op_assign
(paren
id|ainfo-&gt;priority
op_eq
id|GRAPHICS
)paren
suffix:semicolon
id|res_info-&gt;media_hi_priority
op_assign
(paren
id|ainfo-&gt;priority
op_eq
id|MPORT
)paren
suffix:semicolon
r_if
c_cond
(paren
id|res_info-&gt;video_lwm
OG
l_int|160
)paren
(brace
id|res_info-&gt;graphics_lwm
op_assign
l_int|256
suffix:semicolon
id|res_info-&gt;video_lwm
op_assign
l_int|128
suffix:semicolon
id|res_info-&gt;graphics_burst_size
op_assign
l_int|64
suffix:semicolon
id|res_info-&gt;video_burst_size
op_assign
l_int|64
suffix:semicolon
id|res_info-&gt;graphics_hi_priority
op_assign
l_int|0
suffix:semicolon
id|res_info-&gt;media_hi_priority
op_assign
l_int|0
suffix:semicolon
id|ainfo-&gt;converged
op_assign
l_int|0
suffix:semicolon
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|res_info-&gt;video_lwm
OG
l_int|128
)paren
(brace
id|res_info-&gt;video_lwm
op_assign
l_int|128
suffix:semicolon
)brace
r_return
(paren
l_int|1
)paren
suffix:semicolon
)brace
r_else
(brace
id|res_info-&gt;graphics_lwm
op_assign
l_int|256
suffix:semicolon
id|res_info-&gt;video_lwm
op_assign
l_int|128
suffix:semicolon
id|res_info-&gt;graphics_burst_size
op_assign
l_int|64
suffix:semicolon
id|res_info-&gt;video_burst_size
op_assign
l_int|64
suffix:semicolon
id|res_info-&gt;graphics_hi_priority
op_assign
l_int|0
suffix:semicolon
id|res_info-&gt;media_hi_priority
op_assign
l_int|0
suffix:semicolon
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
)brace
DECL|function|nv3_get_param
r_static
r_char
id|nv3_get_param
c_func
(paren
id|nv3_fifo_info
op_star
id|res_info
comma
id|nv3_sim_state
op_star
id|state
comma
id|nv3_arb_info
op_star
id|ainfo
)paren
(brace
r_int
id|done
comma
id|g
comma
id|v
comma
id|p
suffix:semicolon
id|done
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|state-&gt;gr_during_vid
op_logical_and
id|ainfo-&gt;vid_en
)paren
id|ainfo-&gt;priority
op_assign
id|MPORT
suffix:semicolon
r_else
id|ainfo-&gt;priority
op_assign
id|ainfo-&gt;gdrain_rate
OL
id|ainfo-&gt;vdrain_rate
ques
c_cond
id|VIDEO
suffix:colon
id|GRAPHICS
suffix:semicolon
r_for
c_loop
(paren
id|p
op_assign
l_int|0
suffix:semicolon
id|p
OL
l_int|2
op_logical_and
id|done
op_ne
l_int|1
suffix:semicolon
id|p
op_increment
)paren
(brace
r_for
c_loop
(paren
id|g
op_assign
l_int|128
suffix:semicolon
(paren
id|g
OG
l_int|32
)paren
op_logical_and
(paren
id|done
op_ne
l_int|1
)paren
suffix:semicolon
id|g
op_assign
id|g
op_rshift
l_int|1
)paren
(brace
r_for
c_loop
(paren
id|v
op_assign
l_int|128
suffix:semicolon
(paren
id|v
op_ge
l_int|32
)paren
op_logical_and
(paren
id|done
op_ne
l_int|1
)paren
suffix:semicolon
id|v
op_assign
id|v
op_rshift
l_int|1
)paren
(brace
id|ainfo-&gt;priority
op_assign
id|p
suffix:semicolon
id|ainfo-&gt;gburst_size
op_assign
id|g
suffix:semicolon
id|ainfo-&gt;vburst_size
op_assign
id|v
suffix:semicolon
id|done
op_assign
id|nv3_arb
c_func
(paren
id|res_info
comma
id|state
comma
id|ainfo
)paren
suffix:semicolon
r_if
c_cond
(paren
id|g
op_eq
l_int|128
)paren
(brace
r_if
c_cond
(paren
(paren
id|res_info-&gt;graphics_lwm
op_plus
id|g
)paren
OG
l_int|256
)paren
id|done
op_assign
l_int|0
suffix:semicolon
)brace
)brace
)brace
)brace
r_if
c_cond
(paren
op_logical_neg
id|done
)paren
r_return
(paren
l_int|0
)paren
suffix:semicolon
r_else
r_return
(paren
l_int|1
)paren
suffix:semicolon
)brace
DECL|function|nv3CalcArbitration
r_static
r_void
id|nv3CalcArbitration
(paren
id|nv3_fifo_info
op_star
id|res_info
comma
id|nv3_sim_state
op_star
id|state
)paren
(brace
id|nv3_fifo_info
id|save_info
suffix:semicolon
id|nv3_arb_info
id|ainfo
suffix:semicolon
r_char
id|res_gr
comma
id|res_vid
suffix:semicolon
id|ainfo.gr_en
op_assign
l_int|1
suffix:semicolon
id|ainfo.vid_en
op_assign
id|state-&gt;enable_video
suffix:semicolon
id|ainfo.vid_only_once
op_assign
l_int|0
suffix:semicolon
id|ainfo.gr_only_once
op_assign
l_int|0
suffix:semicolon
id|ainfo.gdrain_rate
op_assign
(paren
r_int
)paren
id|state-&gt;pclk_khz
op_star
id|state
op_member_access_from_pointer
id|pix_bpp
op_div
l_int|8
suffix:semicolon
id|ainfo.vdrain_rate
op_assign
(paren
r_int
)paren
id|state-&gt;pclk_khz
op_star
l_int|2
suffix:semicolon
r_if
c_cond
(paren
id|state-&gt;video_scale
op_ne
l_int|0
)paren
id|ainfo.vdrain_rate
op_assign
id|ainfo.vdrain_rate
op_div
id|state-&gt;video_scale
suffix:semicolon
id|ainfo.mdrain_rate
op_assign
l_int|33000
suffix:semicolon
id|res_info-&gt;rtl_values
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|state-&gt;gr_during_vid
op_logical_and
id|state-&gt;enable_video
)paren
(brace
id|ainfo.gr_only_once
op_assign
l_int|1
suffix:semicolon
id|ainfo.gr_en
op_assign
l_int|1
suffix:semicolon
id|ainfo.gdrain_rate
op_assign
l_int|0
suffix:semicolon
id|res_vid
op_assign
id|nv3_get_param
c_func
(paren
id|res_info
comma
id|state
comma
op_amp
id|ainfo
)paren
suffix:semicolon
id|res_vid
op_assign
id|ainfo.converged
suffix:semicolon
id|save_info.video_lwm
op_assign
id|res_info-&gt;video_lwm
suffix:semicolon
id|save_info.video_burst_size
op_assign
id|res_info-&gt;video_burst_size
suffix:semicolon
id|ainfo.vid_en
op_assign
l_int|1
suffix:semicolon
id|ainfo.vid_only_once
op_assign
l_int|1
suffix:semicolon
id|ainfo.gr_en
op_assign
l_int|1
suffix:semicolon
id|ainfo.gdrain_rate
op_assign
(paren
r_int
)paren
id|state-&gt;pclk_khz
op_star
id|state
op_member_access_from_pointer
id|pix_bpp
op_div
l_int|8
suffix:semicolon
id|ainfo.vdrain_rate
op_assign
l_int|0
suffix:semicolon
id|res_gr
op_assign
id|nv3_get_param
c_func
(paren
id|res_info
comma
id|state
comma
op_amp
id|ainfo
)paren
suffix:semicolon
id|res_gr
op_assign
id|ainfo.converged
suffix:semicolon
id|res_info-&gt;video_lwm
op_assign
id|save_info.video_lwm
suffix:semicolon
id|res_info-&gt;video_burst_size
op_assign
id|save_info.video_burst_size
suffix:semicolon
id|res_info-&gt;valid
op_assign
id|res_gr
op_amp
id|res_vid
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
op_logical_neg
id|ainfo.gr_en
)paren
id|ainfo.gdrain_rate
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ainfo.vid_en
)paren
id|ainfo.vdrain_rate
op_assign
l_int|0
suffix:semicolon
id|res_gr
op_assign
id|nv3_get_param
c_func
(paren
id|res_info
comma
id|state
comma
op_amp
id|ainfo
)paren
suffix:semicolon
id|res_info-&gt;valid
op_assign
id|ainfo.converged
suffix:semicolon
)brace
)brace
DECL|function|nv3UpdateArbitrationSettings
r_void
id|nv3UpdateArbitrationSettings
(paren
r_int
id|VClk
comma
r_int
id|pixelDepth
comma
r_int
op_star
id|burst
comma
r_int
op_star
id|lwm
comma
id|RIVA_HW_INST
op_star
id|chip
)paren
(brace
id|nv3_fifo_info
id|fifo_data
suffix:semicolon
id|nv3_sim_state
id|sim_data
suffix:semicolon
r_int
r_int
id|M
comma
id|N
comma
id|P
comma
id|pll
comma
id|MClk
suffix:semicolon
id|pll
op_assign
id|chip-&gt;PRAMDAC
(braket
l_int|0x00000504
op_div
l_int|4
)braket
suffix:semicolon
id|M
op_assign
(paren
id|pll
op_rshift
l_int|0
)paren
op_amp
l_int|0xFF
suffix:semicolon
id|N
op_assign
(paren
id|pll
op_rshift
l_int|8
)paren
op_amp
l_int|0xFF
suffix:semicolon
id|P
op_assign
(paren
id|pll
op_rshift
l_int|16
)paren
op_amp
l_int|0x0F
suffix:semicolon
id|MClk
op_assign
(paren
id|N
op_star
id|chip-&gt;CrystalFreqKHz
op_div
id|M
)paren
op_rshift
id|P
suffix:semicolon
id|sim_data.pix_bpp
op_assign
(paren
r_char
)paren
id|pixelDepth
suffix:semicolon
id|sim_data.enable_video
op_assign
l_int|0
suffix:semicolon
id|sim_data.enable_mp
op_assign
l_int|0
suffix:semicolon
id|sim_data.video_scale
op_assign
l_int|1
suffix:semicolon
id|sim_data.memory_width
op_assign
(paren
id|chip-&gt;PEXTDEV
(braket
l_int|0x00000000
op_div
l_int|4
)braket
op_amp
l_int|0x10
)paren
ques
c_cond
l_int|128
suffix:colon
l_int|64
suffix:semicolon
id|sim_data.memory_width
op_assign
l_int|128
suffix:semicolon
id|sim_data.mem_latency
op_assign
l_int|11
suffix:semicolon
id|sim_data.mem_aligned
op_assign
l_int|1
suffix:semicolon
id|sim_data.mem_page_miss
op_assign
l_int|9
suffix:semicolon
id|sim_data.gr_during_vid
op_assign
l_int|0
suffix:semicolon
id|sim_data.pclk_khz
op_assign
id|VClk
suffix:semicolon
id|sim_data.mclk_khz
op_assign
id|MClk
suffix:semicolon
id|nv3CalcArbitration
c_func
(paren
op_amp
id|fifo_data
comma
op_amp
id|sim_data
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fifo_data.valid
)paren
(brace
r_int
id|b
op_assign
id|fifo_data.graphics_burst_size
op_rshift
l_int|4
suffix:semicolon
op_star
id|burst
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|b
op_rshift_assign
l_int|1
)paren
(paren
op_star
id|burst
)paren
op_increment
suffix:semicolon
op_star
id|lwm
op_assign
id|fifo_data.graphics_lwm
op_rshift
l_int|3
suffix:semicolon
)brace
r_else
(brace
op_star
id|lwm
op_assign
l_int|0x24
suffix:semicolon
op_star
id|burst
op_assign
l_int|0x02
suffix:semicolon
)brace
)brace
DECL|function|nv4CalcArbitration
r_static
r_void
id|nv4CalcArbitration
(paren
id|nv4_fifo_info
op_star
id|fifo
comma
id|nv4_sim_state
op_star
id|arb
)paren
(brace
r_int
id|data
comma
id|pagemiss
comma
id|cas
comma
id|width
comma
id|video_enable
comma
id|color_key_enable
comma
id|bpp
comma
id|align
suffix:semicolon
r_int
id|nvclks
comma
id|mclks
comma
id|pclks
comma
id|vpagemiss
comma
id|crtpagemiss
comma
id|vbs
op_assign
l_int|0
suffix:semicolon
r_int
id|found
comma
id|mclk_extra
comma
id|mclk_loop
comma
id|cbs
comma
id|m1
comma
id|p1
suffix:semicolon
r_int
id|mclk_freq
comma
id|pclk_freq
comma
id|nvclk_freq
comma
id|mp_enable
suffix:semicolon
r_int
id|us_m
comma
id|us_n
comma
id|us_p
comma
id|video_drain_rate
comma
id|crtc_drain_rate
suffix:semicolon
r_int
id|vpm_us
comma
id|us_video
comma
id|vlwm
comma
id|video_fill_us
comma
id|cpm_us
comma
id|us_crt
comma
id|clwm
suffix:semicolon
r_int
id|craw
comma
id|vraw
suffix:semicolon
id|fifo-&gt;valid
op_assign
l_int|1
suffix:semicolon
id|pclk_freq
op_assign
id|arb-&gt;pclk_khz
suffix:semicolon
id|mclk_freq
op_assign
id|arb-&gt;mclk_khz
suffix:semicolon
id|nvclk_freq
op_assign
id|arb-&gt;nvclk_khz
suffix:semicolon
id|pagemiss
op_assign
id|arb-&gt;mem_page_miss
suffix:semicolon
id|cas
op_assign
id|arb-&gt;mem_latency
suffix:semicolon
id|width
op_assign
id|arb-&gt;memory_width
op_rshift
l_int|6
suffix:semicolon
id|video_enable
op_assign
id|arb-&gt;enable_video
suffix:semicolon
id|color_key_enable
op_assign
id|arb-&gt;gr_during_vid
suffix:semicolon
id|bpp
op_assign
id|arb-&gt;pix_bpp
suffix:semicolon
id|align
op_assign
id|arb-&gt;mem_aligned
suffix:semicolon
id|mp_enable
op_assign
id|arb-&gt;enable_mp
suffix:semicolon
id|clwm
op_assign
l_int|0
suffix:semicolon
id|vlwm
op_assign
l_int|0
suffix:semicolon
id|cbs
op_assign
l_int|128
suffix:semicolon
id|pclks
op_assign
l_int|2
suffix:semicolon
id|nvclks
op_assign
l_int|2
suffix:semicolon
id|nvclks
op_add_assign
l_int|2
suffix:semicolon
id|nvclks
op_add_assign
l_int|1
suffix:semicolon
id|mclks
op_assign
l_int|5
suffix:semicolon
id|mclks
op_add_assign
l_int|3
suffix:semicolon
id|mclks
op_add_assign
l_int|1
suffix:semicolon
id|mclks
op_add_assign
id|cas
suffix:semicolon
id|mclks
op_add_assign
l_int|1
suffix:semicolon
id|mclks
op_add_assign
l_int|1
suffix:semicolon
id|mclks
op_add_assign
l_int|1
suffix:semicolon
id|mclks
op_add_assign
l_int|1
suffix:semicolon
id|mclk_extra
op_assign
l_int|3
suffix:semicolon
id|nvclks
op_add_assign
l_int|2
suffix:semicolon
id|nvclks
op_add_assign
l_int|1
suffix:semicolon
id|nvclks
op_add_assign
l_int|1
suffix:semicolon
id|nvclks
op_add_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|mp_enable
)paren
id|mclks
op_add_assign
l_int|4
suffix:semicolon
id|nvclks
op_add_assign
l_int|0
suffix:semicolon
id|pclks
op_add_assign
l_int|0
suffix:semicolon
id|found
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|found
op_ne
l_int|1
)paren
(brace
id|fifo-&gt;valid
op_assign
l_int|1
suffix:semicolon
id|found
op_assign
l_int|1
suffix:semicolon
id|mclk_loop
op_assign
id|mclks
op_plus
id|mclk_extra
suffix:semicolon
id|us_m
op_assign
id|mclk_loop
op_star
l_int|1000
op_star
l_int|1000
op_div
id|mclk_freq
suffix:semicolon
id|us_n
op_assign
id|nvclks
op_star
l_int|1000
op_star
l_int|1000
op_div
id|nvclk_freq
suffix:semicolon
id|us_p
op_assign
id|nvclks
op_star
l_int|1000
op_star
l_int|1000
op_div
id|pclk_freq
suffix:semicolon
r_if
c_cond
(paren
id|video_enable
)paren
(brace
id|video_drain_rate
op_assign
id|pclk_freq
op_star
l_int|2
suffix:semicolon
id|crtc_drain_rate
op_assign
id|pclk_freq
op_star
id|bpp
op_div
l_int|8
suffix:semicolon
id|vpagemiss
op_assign
l_int|2
suffix:semicolon
id|vpagemiss
op_add_assign
l_int|1
suffix:semicolon
id|crtpagemiss
op_assign
l_int|2
suffix:semicolon
id|vpm_us
op_assign
(paren
id|vpagemiss
op_star
id|pagemiss
)paren
op_star
l_int|1000
op_star
l_int|1000
op_div
id|mclk_freq
suffix:semicolon
r_if
c_cond
(paren
id|nvclk_freq
op_star
l_int|2
OG
id|mclk_freq
op_star
id|width
)paren
id|video_fill_us
op_assign
id|cbs
op_star
l_int|1000
op_star
l_int|1000
op_div
l_int|16
op_div
id|nvclk_freq
suffix:semicolon
r_else
id|video_fill_us
op_assign
id|cbs
op_star
l_int|1000
op_star
l_int|1000
op_div
(paren
l_int|8
op_star
id|width
)paren
op_div
id|mclk_freq
suffix:semicolon
id|us_video
op_assign
id|vpm_us
op_plus
id|us_m
op_plus
id|us_n
op_plus
id|us_p
op_plus
id|video_fill_us
suffix:semicolon
id|vlwm
op_assign
id|us_video
op_star
id|video_drain_rate
op_div
(paren
l_int|1000
op_star
l_int|1000
)paren
suffix:semicolon
id|vlwm
op_increment
suffix:semicolon
id|vbs
op_assign
l_int|128
suffix:semicolon
r_if
c_cond
(paren
id|vlwm
OG
l_int|128
)paren
id|vbs
op_assign
l_int|64
suffix:semicolon
r_if
c_cond
(paren
id|vlwm
OG
(paren
l_int|256
op_minus
l_int|64
)paren
)paren
id|vbs
op_assign
l_int|32
suffix:semicolon
r_if
c_cond
(paren
id|nvclk_freq
op_star
l_int|2
OG
id|mclk_freq
op_star
id|width
)paren
id|video_fill_us
op_assign
id|vbs
op_star
l_int|1000
op_star
l_int|1000
op_div
l_int|16
op_div
id|nvclk_freq
suffix:semicolon
r_else
id|video_fill_us
op_assign
id|vbs
op_star
l_int|1000
op_star
l_int|1000
op_div
(paren
l_int|8
op_star
id|width
)paren
op_div
id|mclk_freq
suffix:semicolon
id|cpm_us
op_assign
id|crtpagemiss
op_star
id|pagemiss
op_star
l_int|1000
op_star
l_int|1000
op_div
id|mclk_freq
suffix:semicolon
id|us_crt
op_assign
id|us_video
op_plus
id|video_fill_us
op_plus
id|cpm_us
op_plus
id|us_m
op_plus
id|us_n
op_plus
id|us_p
suffix:semicolon
id|clwm
op_assign
id|us_crt
op_star
id|crtc_drain_rate
op_div
(paren
l_int|1000
op_star
l_int|1000
)paren
suffix:semicolon
id|clwm
op_increment
suffix:semicolon
)brace
r_else
(brace
id|crtc_drain_rate
op_assign
id|pclk_freq
op_star
id|bpp
op_div
l_int|8
suffix:semicolon
id|crtpagemiss
op_assign
l_int|2
suffix:semicolon
id|crtpagemiss
op_add_assign
l_int|1
suffix:semicolon
id|cpm_us
op_assign
id|crtpagemiss
op_star
id|pagemiss
op_star
l_int|1000
op_star
l_int|1000
op_div
id|mclk_freq
suffix:semicolon
id|us_crt
op_assign
id|cpm_us
op_plus
id|us_m
op_plus
id|us_n
op_plus
id|us_p
suffix:semicolon
id|clwm
op_assign
id|us_crt
op_star
id|crtc_drain_rate
op_div
(paren
l_int|1000
op_star
l_int|1000
)paren
suffix:semicolon
id|clwm
op_increment
suffix:semicolon
)brace
id|m1
op_assign
id|clwm
op_plus
id|cbs
op_minus
l_int|512
suffix:semicolon
id|p1
op_assign
id|m1
op_star
id|pclk_freq
op_div
id|mclk_freq
suffix:semicolon
id|p1
op_assign
id|p1
op_star
id|bpp
op_div
l_int|8
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p1
OL
id|m1
)paren
op_logical_and
(paren
id|m1
OG
l_int|0
)paren
)paren
(brace
id|fifo-&gt;valid
op_assign
l_int|0
suffix:semicolon
id|found
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|mclk_extra
op_eq
l_int|0
)paren
id|found
op_assign
l_int|1
suffix:semicolon
id|mclk_extra
op_decrement
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|video_enable
)paren
(brace
r_if
c_cond
(paren
(paren
id|clwm
OG
l_int|511
)paren
op_logical_or
(paren
id|vlwm
OG
l_int|255
)paren
)paren
(brace
id|fifo-&gt;valid
op_assign
l_int|0
suffix:semicolon
id|found
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|mclk_extra
op_eq
l_int|0
)paren
id|found
op_assign
l_int|1
suffix:semicolon
id|mclk_extra
op_decrement
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|clwm
OG
l_int|519
)paren
(brace
id|fifo-&gt;valid
op_assign
l_int|0
suffix:semicolon
id|found
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|mclk_extra
op_eq
l_int|0
)paren
id|found
op_assign
l_int|1
suffix:semicolon
id|mclk_extra
op_decrement
suffix:semicolon
)brace
)brace
id|craw
op_assign
id|clwm
suffix:semicolon
id|vraw
op_assign
id|vlwm
suffix:semicolon
r_if
c_cond
(paren
id|clwm
OL
l_int|384
)paren
id|clwm
op_assign
l_int|384
suffix:semicolon
r_if
c_cond
(paren
id|vlwm
OL
l_int|128
)paren
id|vlwm
op_assign
l_int|128
suffix:semicolon
id|data
op_assign
(paren
r_int
)paren
(paren
id|clwm
)paren
suffix:semicolon
id|fifo-&gt;graphics_lwm
op_assign
id|data
suffix:semicolon
id|fifo-&gt;graphics_burst_size
op_assign
l_int|128
suffix:semicolon
id|data
op_assign
(paren
r_int
)paren
(paren
(paren
id|vlwm
op_plus
l_int|15
)paren
)paren
suffix:semicolon
id|fifo-&gt;video_lwm
op_assign
id|data
suffix:semicolon
id|fifo-&gt;video_burst_size
op_assign
id|vbs
suffix:semicolon
)brace
)brace
DECL|function|nv4UpdateArbitrationSettings
r_static
r_void
id|nv4UpdateArbitrationSettings
(paren
r_int
id|VClk
comma
r_int
id|pixelDepth
comma
r_int
op_star
id|burst
comma
r_int
op_star
id|lwm
comma
id|RIVA_HW_INST
op_star
id|chip
)paren
(brace
id|nv4_fifo_info
id|fifo_data
suffix:semicolon
id|nv4_sim_state
id|sim_data
suffix:semicolon
r_int
r_int
id|M
comma
id|N
comma
id|P
comma
id|pll
comma
id|MClk
comma
id|NVClk
comma
id|cfg1
suffix:semicolon
id|pll
op_assign
id|chip-&gt;PRAMDAC
(braket
l_int|0x00000504
op_div
l_int|4
)braket
suffix:semicolon
id|M
op_assign
(paren
id|pll
op_rshift
l_int|0
)paren
op_amp
l_int|0xFF
suffix:semicolon
id|N
op_assign
(paren
id|pll
op_rshift
l_int|8
)paren
op_amp
l_int|0xFF
suffix:semicolon
id|P
op_assign
(paren
id|pll
op_rshift
l_int|16
)paren
op_amp
l_int|0x0F
suffix:semicolon
id|MClk
op_assign
(paren
id|N
op_star
id|chip-&gt;CrystalFreqKHz
op_div
id|M
)paren
op_rshift
id|P
suffix:semicolon
id|pll
op_assign
id|chip-&gt;PRAMDAC
(braket
l_int|0x00000500
op_div
l_int|4
)braket
suffix:semicolon
id|M
op_assign
(paren
id|pll
op_rshift
l_int|0
)paren
op_amp
l_int|0xFF
suffix:semicolon
id|N
op_assign
(paren
id|pll
op_rshift
l_int|8
)paren
op_amp
l_int|0xFF
suffix:semicolon
id|P
op_assign
(paren
id|pll
op_rshift
l_int|16
)paren
op_amp
l_int|0x0F
suffix:semicolon
id|NVClk
op_assign
(paren
id|N
op_star
id|chip-&gt;CrystalFreqKHz
op_div
id|M
)paren
op_rshift
id|P
suffix:semicolon
id|cfg1
op_assign
id|chip-&gt;PFB
(braket
l_int|0x00000204
op_div
l_int|4
)braket
suffix:semicolon
id|sim_data.pix_bpp
op_assign
(paren
r_char
)paren
id|pixelDepth
suffix:semicolon
id|sim_data.enable_video
op_assign
l_int|0
suffix:semicolon
id|sim_data.enable_mp
op_assign
l_int|0
suffix:semicolon
id|sim_data.memory_width
op_assign
(paren
id|chip-&gt;PEXTDEV
(braket
l_int|0x00000000
op_div
l_int|4
)braket
op_amp
l_int|0x10
)paren
ques
c_cond
l_int|128
suffix:colon
l_int|64
suffix:semicolon
id|sim_data.mem_latency
op_assign
(paren
r_char
)paren
id|cfg1
op_amp
l_int|0x0F
suffix:semicolon
id|sim_data.mem_aligned
op_assign
l_int|1
suffix:semicolon
id|sim_data.mem_page_miss
op_assign
(paren
r_char
)paren
(paren
(paren
(paren
id|cfg1
op_rshift
l_int|4
)paren
op_amp
l_int|0x0F
)paren
op_plus
(paren
(paren
id|cfg1
op_rshift
l_int|31
)paren
op_amp
l_int|0x01
)paren
)paren
suffix:semicolon
id|sim_data.gr_during_vid
op_assign
l_int|0
suffix:semicolon
id|sim_data.pclk_khz
op_assign
id|VClk
suffix:semicolon
id|sim_data.mclk_khz
op_assign
id|MClk
suffix:semicolon
id|sim_data.nvclk_khz
op_assign
id|NVClk
suffix:semicolon
id|nv4CalcArbitration
c_func
(paren
op_amp
id|fifo_data
comma
op_amp
id|sim_data
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fifo_data.valid
)paren
(brace
r_int
id|b
op_assign
id|fifo_data.graphics_burst_size
op_rshift
l_int|4
suffix:semicolon
op_star
id|burst
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|b
op_rshift_assign
l_int|1
)paren
(paren
op_star
id|burst
)paren
op_increment
suffix:semicolon
op_star
id|lwm
op_assign
id|fifo_data.graphics_lwm
op_rshift
l_int|3
suffix:semicolon
)brace
)brace
multiline_comment|/****************************************************************************&bslash;&n;*                                                                            *&n;*                          RIVA Mode State Routines                          *&n;*                                                                            *&n;&bslash;****************************************************************************/
multiline_comment|/*&n; * Calculate the Video Clock parameters for the PLL.&n; */
DECL|function|CalcVClock
r_static
r_int
id|CalcVClock
(paren
r_int
id|clockIn
comma
r_int
op_star
id|clockOut
comma
r_int
op_star
id|mOut
comma
r_int
op_star
id|nOut
comma
r_int
op_star
id|pOut
comma
id|RIVA_HW_INST
op_star
id|chip
)paren
(brace
r_int
id|lowM
comma
id|highM
comma
id|highP
suffix:semicolon
r_int
id|DeltaNew
comma
id|DeltaOld
suffix:semicolon
r_int
id|VClk
comma
id|Freq
suffix:semicolon
r_int
id|M
comma
id|N
comma
id|P
suffix:semicolon
id|DeltaOld
op_assign
l_int|0xFFFFFFFF
suffix:semicolon
id|VClk
op_assign
(paren
r_int
)paren
id|clockIn
suffix:semicolon
r_if
c_cond
(paren
id|chip-&gt;CrystalFreqKHz
op_eq
l_int|14318
)paren
(brace
id|lowM
op_assign
l_int|8
suffix:semicolon
id|highM
op_assign
l_int|14
op_minus
(paren
id|chip-&gt;Architecture
op_eq
l_int|3
)paren
suffix:semicolon
)brace
r_else
(brace
id|lowM
op_assign
l_int|7
suffix:semicolon
id|highM
op_assign
l_int|13
op_minus
(paren
id|chip-&gt;Architecture
op_eq
l_int|3
)paren
suffix:semicolon
)brace
id|highP
op_assign
l_int|4
op_minus
(paren
id|chip-&gt;Architecture
op_eq
l_int|3
)paren
suffix:semicolon
r_for
c_loop
(paren
id|P
op_assign
l_int|0
suffix:semicolon
id|P
op_le
id|highP
suffix:semicolon
id|P
op_increment
)paren
(brace
id|Freq
op_assign
id|VClk
op_lshift
id|P
suffix:semicolon
r_if
c_cond
(paren
(paren
id|Freq
op_ge
l_int|128000
)paren
op_logical_and
(paren
id|Freq
op_le
id|chip-&gt;MaxVClockFreqKHz
)paren
)paren
(brace
r_for
c_loop
(paren
id|M
op_assign
id|lowM
suffix:semicolon
id|M
op_le
id|highM
suffix:semicolon
id|M
op_increment
)paren
(brace
id|N
op_assign
(paren
id|VClk
op_star
id|M
op_div
id|chip-&gt;CrystalFreqKHz
)paren
op_lshift
id|P
suffix:semicolon
id|Freq
op_assign
(paren
id|chip-&gt;CrystalFreqKHz
op_star
id|N
op_div
id|M
)paren
op_rshift
id|P
suffix:semicolon
r_if
c_cond
(paren
id|Freq
OG
id|VClk
)paren
id|DeltaNew
op_assign
id|Freq
op_minus
id|VClk
suffix:semicolon
r_else
id|DeltaNew
op_assign
id|VClk
op_minus
id|Freq
suffix:semicolon
r_if
c_cond
(paren
id|DeltaNew
OL
id|DeltaOld
)paren
(brace
op_star
id|mOut
op_assign
id|M
suffix:semicolon
op_star
id|nOut
op_assign
id|N
suffix:semicolon
op_star
id|pOut
op_assign
id|P
suffix:semicolon
op_star
id|clockOut
op_assign
id|Freq
suffix:semicolon
id|DeltaOld
op_assign
id|DeltaNew
suffix:semicolon
)brace
)brace
)brace
)brace
r_return
(paren
id|DeltaOld
op_ne
l_int|0xFFFFFFFF
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Calculate extended mode parameters (SVGA) and save in a &n; * mode state structure.&n; */
DECL|function|CalcStateExt
r_static
r_void
id|CalcStateExt
(paren
id|RIVA_HW_INST
op_star
id|chip
comma
id|RIVA_HW_STATE
op_star
id|state
comma
r_int
id|bpp
comma
r_int
id|width
comma
r_int
id|hDisplaySize
comma
r_int
id|hDisplay
comma
r_int
id|hStart
comma
r_int
id|hEnd
comma
r_int
id|hTotal
comma
r_int
id|height
comma
r_int
id|vDisplay
comma
r_int
id|vStart
comma
r_int
id|vEnd
comma
r_int
id|vTotal
comma
r_int
id|dotClock
)paren
(brace
r_int
id|pixelDepth
comma
id|VClk
comma
id|m
comma
id|n
comma
id|p
suffix:semicolon
multiline_comment|/*&n;     * Save mode parameters.&n;     */
id|state-&gt;bpp
op_assign
id|bpp
suffix:semicolon
id|state-&gt;width
op_assign
id|width
suffix:semicolon
id|state-&gt;height
op_assign
id|height
suffix:semicolon
multiline_comment|/*&n;     * Extended RIVA registers.&n;     */
id|pixelDepth
op_assign
(paren
id|bpp
op_plus
l_int|1
)paren
op_div
l_int|8
suffix:semicolon
id|CalcVClock
c_func
(paren
id|dotClock
comma
op_amp
id|VClk
comma
op_amp
id|m
comma
op_amp
id|n
comma
op_amp
id|p
comma
id|chip
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|chip-&gt;Architecture
)paren
(brace
r_case
l_int|3
suffix:colon
id|nv3UpdateArbitrationSettings
c_func
(paren
id|VClk
comma
id|pixelDepth
op_star
l_int|8
comma
op_amp
(paren
id|state-&gt;arbitration0
)paren
comma
op_amp
(paren
id|state-&gt;arbitration1
)paren
comma
id|chip
)paren
suffix:semicolon
id|state-&gt;cursor0
op_assign
l_int|0x00
suffix:semicolon
id|state-&gt;cursor1
op_assign
l_int|0x78
suffix:semicolon
id|state-&gt;cursor2
op_assign
l_int|0x00000000
suffix:semicolon
id|state-&gt;pllsel
op_assign
l_int|0x10010100
suffix:semicolon
id|state-&gt;config
op_assign
(paren
(paren
id|width
op_plus
l_int|31
)paren
op_div
l_int|32
)paren
op_or
(paren
(paren
(paren
id|pixelDepth
OG
l_int|2
)paren
ques
c_cond
l_int|3
suffix:colon
id|pixelDepth
)paren
op_lshift
l_int|8
)paren
op_or
l_int|0x1000
suffix:semicolon
id|state-&gt;general
op_assign
l_int|0x00000100
suffix:semicolon
id|state-&gt;repaint1
op_assign
id|hDisplaySize
OL
l_int|1280
ques
c_cond
l_int|0x06
suffix:colon
l_int|0x02
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
r_case
l_int|5
suffix:colon
id|nv4UpdateArbitrationSettings
c_func
(paren
id|VClk
comma
id|pixelDepth
op_star
l_int|8
comma
op_amp
(paren
id|state-&gt;arbitration0
)paren
comma
op_amp
(paren
id|state-&gt;arbitration1
)paren
comma
id|chip
)paren
suffix:semicolon
id|state-&gt;cursor0
op_assign
l_int|0x00
suffix:semicolon
id|state-&gt;cursor1
op_assign
l_int|0xFC
suffix:semicolon
id|state-&gt;cursor2
op_assign
l_int|0x00000000
suffix:semicolon
id|state-&gt;pllsel
op_assign
l_int|0x10000700
suffix:semicolon
id|state-&gt;config
op_assign
l_int|0x00001114
suffix:semicolon
id|state-&gt;general
op_assign
id|bpp
op_eq
l_int|16
ques
c_cond
l_int|0x00101100
suffix:colon
l_int|0x00100100
suffix:semicolon
id|state-&gt;repaint1
op_assign
id|hDisplaySize
OL
l_int|1280
ques
c_cond
l_int|0x04
suffix:colon
l_int|0x00
suffix:semicolon
r_break
suffix:semicolon
)brace
id|state-&gt;vpll
op_assign
(paren
id|p
op_lshift
l_int|16
)paren
op_or
(paren
id|n
op_lshift
l_int|8
)paren
op_or
id|m
suffix:semicolon
id|state-&gt;screen
op_assign
(paren
(paren
id|hTotal
op_amp
l_int|0x040
)paren
op_rshift
l_int|2
)paren
op_or
(paren
(paren
id|vDisplay
op_amp
l_int|0x400
)paren
op_rshift
l_int|7
)paren
op_or
(paren
(paren
id|vStart
op_amp
l_int|0x400
)paren
op_rshift
l_int|8
)paren
op_or
(paren
(paren
id|vDisplay
op_amp
l_int|0x400
)paren
op_rshift
l_int|9
)paren
op_or
(paren
(paren
id|vTotal
op_amp
l_int|0x400
)paren
op_rshift
l_int|10
)paren
suffix:semicolon
id|state-&gt;repaint0
op_assign
(paren
(paren
(paren
id|width
op_div
l_int|8
)paren
op_star
id|pixelDepth
)paren
op_amp
l_int|0x700
)paren
op_rshift
l_int|3
suffix:semicolon
id|state-&gt;horiz
op_assign
id|hTotal
OL
l_int|260
ques
c_cond
l_int|0x00
suffix:colon
l_int|0x01
suffix:semicolon
id|state-&gt;pixel
op_assign
(paren
id|pixelDepth
OG
l_int|2
ques
c_cond
l_int|3
suffix:colon
id|pixelDepth
)paren
op_or
l_int|0x40
suffix:semicolon
id|state-&gt;offset0
op_assign
id|state-&gt;offset1
op_assign
id|state-&gt;offset2
op_assign
id|state-&gt;offset3
op_assign
l_int|0
suffix:semicolon
id|state-&gt;pitch0
op_assign
id|state-&gt;pitch1
op_assign
id|state-&gt;pitch2
op_assign
id|state-&gt;pitch3
op_assign
id|pixelDepth
op_star
id|width
suffix:semicolon
)brace
multiline_comment|/*&n; * Load fixed function state and pre-calculated/stored state.&n; */
DECL|macro|LOAD_FIXED_STATE
mdefine_line|#define LOAD_FIXED_STATE(tbl,dev)                                       &bslash;&n;    for (i = 0; i &lt; sizeof(tbl##Table##dev)/8; i++)                 &bslash;&n;        chip-&gt;dev[tbl##Table##dev[i][0]] = tbl##Table##dev[i][1]
DECL|macro|LOAD_FIXED_STATE_8BPP
mdefine_line|#define LOAD_FIXED_STATE_8BPP(tbl,dev)                                  &bslash;&n;    for (i = 0; i &lt; sizeof(tbl##Table##dev##_8BPP)/8; i++)            &bslash;&n;        chip-&gt;dev[tbl##Table##dev##_8BPP[i][0]] = tbl##Table##dev##_8BPP[i][1]
DECL|macro|LOAD_FIXED_STATE_15BPP
mdefine_line|#define LOAD_FIXED_STATE_15BPP(tbl,dev)                                 &bslash;&n;    for (i = 0; i &lt; sizeof(tbl##Table##dev##_15BPP)/8; i++)           &bslash;&n;        chip-&gt;dev[tbl##Table##dev##_15BPP[i][0]] = tbl##Table##dev##_15BPP[i][1]
DECL|macro|LOAD_FIXED_STATE_16BPP
mdefine_line|#define LOAD_FIXED_STATE_16BPP(tbl,dev)                                 &bslash;&n;    for (i = 0; i &lt; sizeof(tbl##Table##dev##_16BPP)/8; i++)           &bslash;&n;        chip-&gt;dev[tbl##Table##dev##_16BPP[i][0]] = tbl##Table##dev##_16BPP[i][1]
DECL|macro|LOAD_FIXED_STATE_32BPP
mdefine_line|#define LOAD_FIXED_STATE_32BPP(tbl,dev)                                 &bslash;&n;    for (i = 0; i &lt; sizeof(tbl##Table##dev##_32BPP)/8; i++)           &bslash;&n;        chip-&gt;dev[tbl##Table##dev##_32BPP[i][0]] = tbl##Table##dev##_32BPP[i][1]
DECL|function|LoadStateExt
r_static
r_void
id|LoadStateExt
(paren
id|RIVA_HW_INST
op_star
id|chip
comma
id|RIVA_HW_STATE
op_star
id|state
)paren
(brace
r_int
id|i
suffix:semicolon
multiline_comment|/*&n;     * Load HW fixed function state.&n;     */
id|LOAD_FIXED_STATE
c_func
(paren
id|Riva
comma
id|PMC
)paren
suffix:semicolon
id|LOAD_FIXED_STATE
c_func
(paren
id|Riva
comma
id|PTIMER
)paren
suffix:semicolon
multiline_comment|/*&n;     * Make sure frame buffer config gets set before loading PRAMIN.&n;     */
id|chip-&gt;PFB
(braket
l_int|0x00000200
op_div
l_int|4
)braket
op_assign
id|state-&gt;config
suffix:semicolon
r_switch
c_cond
(paren
id|chip-&gt;Architecture
)paren
(brace
r_case
l_int|3
suffix:colon
id|LOAD_FIXED_STATE
c_func
(paren
id|nv3
comma
id|PFIFO
)paren
suffix:semicolon
id|LOAD_FIXED_STATE
c_func
(paren
id|nv3
comma
id|PRAMIN
)paren
suffix:semicolon
id|LOAD_FIXED_STATE
c_func
(paren
id|nv3
comma
id|PGRAPH
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|state-&gt;bpp
)paren
(brace
r_case
l_int|15
suffix:colon
r_case
l_int|16
suffix:colon
id|LOAD_FIXED_STATE_15BPP
c_func
(paren
id|nv3
comma
id|PRAMIN
)paren
suffix:semicolon
id|LOAD_FIXED_STATE_15BPP
c_func
(paren
id|nv3
comma
id|PGRAPH
)paren
suffix:semicolon
id|chip-&gt;Tri03
op_assign
(paren
id|RivaTexturedTriangle03
op_star
)paren
op_amp
(paren
id|chip-&gt;FIFO
(braket
l_int|0x0000E000
op_div
l_int|4
)braket
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|24
suffix:colon
r_case
l_int|32
suffix:colon
id|LOAD_FIXED_STATE_32BPP
c_func
(paren
id|nv3
comma
id|PRAMIN
)paren
suffix:semicolon
id|LOAD_FIXED_STATE_32BPP
c_func
(paren
id|nv3
comma
id|PGRAPH
)paren
suffix:semicolon
id|chip-&gt;Tri03
op_assign
l_int|0L
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|8
suffix:colon
r_default
suffix:colon
id|LOAD_FIXED_STATE_8BPP
c_func
(paren
id|nv3
comma
id|PRAMIN
)paren
suffix:semicolon
id|LOAD_FIXED_STATE_8BPP
c_func
(paren
id|nv3
comma
id|PGRAPH
)paren
suffix:semicolon
id|chip-&gt;Tri03
op_assign
l_int|0L
suffix:semicolon
r_break
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x00000
suffix:semicolon
id|i
OL
l_int|0x00800
suffix:semicolon
id|i
op_increment
)paren
id|chip-&gt;PRAMIN
(braket
l_int|0x00000502
op_plus
id|i
)braket
op_assign
(paren
id|i
op_lshift
l_int|12
)paren
op_or
l_int|0x03
suffix:semicolon
id|chip-&gt;PGRAPH
(braket
l_int|0x00000630
op_div
l_int|4
)braket
op_assign
id|state-&gt;offset0
suffix:semicolon
id|chip-&gt;PGRAPH
(braket
l_int|0x00000634
op_div
l_int|4
)braket
op_assign
id|state-&gt;offset1
suffix:semicolon
id|chip-&gt;PGRAPH
(braket
l_int|0x00000638
op_div
l_int|4
)braket
op_assign
id|state-&gt;offset2
suffix:semicolon
id|chip-&gt;PGRAPH
(braket
l_int|0x0000063C
op_div
l_int|4
)braket
op_assign
id|state-&gt;offset3
suffix:semicolon
id|chip-&gt;PGRAPH
(braket
l_int|0x00000650
op_div
l_int|4
)braket
op_assign
id|state-&gt;pitch0
suffix:semicolon
id|chip-&gt;PGRAPH
(braket
l_int|0x00000654
op_div
l_int|4
)braket
op_assign
id|state-&gt;pitch1
suffix:semicolon
id|chip-&gt;PGRAPH
(braket
l_int|0x00000658
op_div
l_int|4
)braket
op_assign
id|state-&gt;pitch2
suffix:semicolon
id|chip-&gt;PGRAPH
(braket
l_int|0x0000065C
op_div
l_int|4
)braket
op_assign
id|state-&gt;pitch3
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
r_case
l_int|5
suffix:colon
id|LOAD_FIXED_STATE
c_func
(paren
id|nv4
comma
id|PFIFO
)paren
suffix:semicolon
id|LOAD_FIXED_STATE
c_func
(paren
id|nv4
comma
id|PRAMIN
)paren
suffix:semicolon
id|LOAD_FIXED_STATE
c_func
(paren
id|nv4
comma
id|PGRAPH
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|state-&gt;bpp
)paren
(brace
r_case
l_int|15
suffix:colon
id|LOAD_FIXED_STATE_15BPP
c_func
(paren
id|nv4
comma
id|PRAMIN
)paren
suffix:semicolon
id|LOAD_FIXED_STATE_15BPP
c_func
(paren
id|nv4
comma
id|PGRAPH
)paren
suffix:semicolon
id|chip-&gt;Tri03
op_assign
(paren
id|RivaTexturedTriangle03
op_star
)paren
op_amp
(paren
id|chip-&gt;FIFO
(braket
l_int|0x0000E000
op_div
l_int|4
)braket
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|16
suffix:colon
id|LOAD_FIXED_STATE_16BPP
c_func
(paren
id|nv4
comma
id|PRAMIN
)paren
suffix:semicolon
id|LOAD_FIXED_STATE_16BPP
c_func
(paren
id|nv4
comma
id|PGRAPH
)paren
suffix:semicolon
id|chip-&gt;Tri03
op_assign
(paren
id|RivaTexturedTriangle03
op_star
)paren
op_amp
(paren
id|chip-&gt;FIFO
(braket
l_int|0x0000E000
op_div
l_int|4
)braket
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|24
suffix:colon
r_case
l_int|32
suffix:colon
id|LOAD_FIXED_STATE_32BPP
c_func
(paren
id|nv4
comma
id|PRAMIN
)paren
suffix:semicolon
id|LOAD_FIXED_STATE_32BPP
c_func
(paren
id|nv4
comma
id|PGRAPH
)paren
suffix:semicolon
id|chip-&gt;Tri03
op_assign
l_int|0L
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|8
suffix:colon
r_default
suffix:colon
id|LOAD_FIXED_STATE_8BPP
c_func
(paren
id|nv4
comma
id|PRAMIN
)paren
suffix:semicolon
id|LOAD_FIXED_STATE_8BPP
c_func
(paren
id|nv4
comma
id|PGRAPH
)paren
suffix:semicolon
id|chip-&gt;Tri03
op_assign
l_int|0L
suffix:semicolon
r_break
suffix:semicolon
)brace
id|chip-&gt;PGRAPH
(braket
l_int|0x00000640
op_div
l_int|4
)braket
op_assign
id|state-&gt;offset0
suffix:semicolon
id|chip-&gt;PGRAPH
(braket
l_int|0x00000644
op_div
l_int|4
)braket
op_assign
id|state-&gt;offset1
suffix:semicolon
id|chip-&gt;PGRAPH
(braket
l_int|0x00000648
op_div
l_int|4
)braket
op_assign
id|state-&gt;offset2
suffix:semicolon
id|chip-&gt;PGRAPH
(braket
l_int|0x0000064C
op_div
l_int|4
)braket
op_assign
id|state-&gt;offset3
suffix:semicolon
id|chip-&gt;PGRAPH
(braket
l_int|0x00000670
op_div
l_int|4
)braket
op_assign
id|state-&gt;pitch0
suffix:semicolon
id|chip-&gt;PGRAPH
(braket
l_int|0x00000674
op_div
l_int|4
)braket
op_assign
id|state-&gt;pitch1
suffix:semicolon
id|chip-&gt;PGRAPH
(braket
l_int|0x00000678
op_div
l_int|4
)braket
op_assign
id|state-&gt;pitch2
suffix:semicolon
id|chip-&gt;PGRAPH
(braket
l_int|0x0000067C
op_div
l_int|4
)braket
op_assign
id|state-&gt;pitch3
suffix:semicolon
r_break
suffix:semicolon
)brace
singleline_comment|//NOTICE(&quot;8&quot;);
singleline_comment|//    LOAD_FIXED_STATE(Riva,FIFO); /* FIX ME*/
singleline_comment|//NOTICE(&quot;9&quot;);
multiline_comment|/*&n;     * Load HW mode state.&n;     */
id|outb
c_func
(paren
l_int|0x19
comma
l_int|0x3D4
)paren
suffix:semicolon
id|outb
c_func
(paren
id|state-&gt;repaint0
comma
l_int|0x3D5
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0x1A
comma
l_int|0x3D4
)paren
suffix:semicolon
id|outb
c_func
(paren
id|state-&gt;repaint1
comma
l_int|0x3D5
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0x25
comma
l_int|0x3D4
)paren
suffix:semicolon
id|outb
c_func
(paren
id|state-&gt;screen
comma
l_int|0x3D5
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0x28
comma
l_int|0x3D4
)paren
suffix:semicolon
id|outb
c_func
(paren
id|state-&gt;pixel
comma
l_int|0x3D5
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0x2D
comma
l_int|0x3D4
)paren
suffix:semicolon
id|outb
c_func
(paren
id|state-&gt;horiz
comma
l_int|0x3D5
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0x1B
comma
l_int|0x3D4
)paren
suffix:semicolon
id|outb
c_func
(paren
id|state-&gt;arbitration0
comma
l_int|0x3D5
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0x20
comma
l_int|0x3D4
)paren
suffix:semicolon
id|outb
c_func
(paren
id|state-&gt;arbitration1
comma
l_int|0x3D5
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0x30
comma
l_int|0x3D4
)paren
suffix:semicolon
id|outb
c_func
(paren
id|state-&gt;cursor0
comma
l_int|0x3D5
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0x31
comma
l_int|0x3D4
)paren
suffix:semicolon
id|outb
c_func
(paren
id|state-&gt;cursor1
comma
l_int|0x3D5
)paren
suffix:semicolon
id|chip-&gt;PRAMDAC
(braket
l_int|0x00000300
op_div
l_int|4
)braket
op_assign
id|state-&gt;cursor2
suffix:semicolon
id|chip-&gt;PRAMDAC
(braket
l_int|0x00000508
op_div
l_int|4
)braket
op_assign
id|state-&gt;vpll
suffix:semicolon
id|chip-&gt;PRAMDAC
(braket
l_int|0x0000050C
op_div
l_int|4
)braket
op_assign
id|state-&gt;pllsel
suffix:semicolon
id|chip-&gt;PRAMDAC
(braket
l_int|0x00000600
op_div
l_int|4
)braket
op_assign
id|state-&gt;general
suffix:semicolon
multiline_comment|/*&n;     * Turn off VBlank enable and reset.&n;     */
singleline_comment|//    *(chip-&gt;VBLANKENABLE) = 0;&t;&t;/* FIXME*/
singleline_comment|//    *(chip-&gt;VBLANK)       = chip-&gt;VBlankBit; /*FIXME*/
multiline_comment|/*&n;     * Set interrupt enable.&n;     */
id|chip-&gt;PMC
(braket
l_int|0x00000140
op_div
l_int|4
)braket
op_assign
id|chip-&gt;EnableIRQ
op_amp
l_int|0x01
suffix:semicolon
multiline_comment|/*&n;     * Set current state pointer.&n;     */
id|chip-&gt;CurrentState
op_assign
id|state
suffix:semicolon
multiline_comment|/*&n;     * Reset FIFO free count.&n;     */
id|chip-&gt;FifoFreeCount
op_assign
l_int|0
suffix:semicolon
)brace
DECL|function|UnloadStateExt
r_static
r_void
id|UnloadStateExt
(paren
id|RIVA_HW_INST
op_star
id|chip
comma
id|RIVA_HW_STATE
op_star
id|state
)paren
(brace
multiline_comment|/*&n;     * Save current HW state.&n;     */
id|outb
c_func
(paren
l_int|0x19
comma
l_int|0x3D4
)paren
suffix:semicolon
id|state-&gt;repaint0
op_assign
id|inb
c_func
(paren
l_int|0x3D5
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0x1A
comma
l_int|0x3D4
)paren
suffix:semicolon
id|state-&gt;repaint1
op_assign
id|inb
c_func
(paren
l_int|0x3D5
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0x25
comma
l_int|0x3D4
)paren
suffix:semicolon
id|state-&gt;screen
op_assign
id|inb
c_func
(paren
l_int|0x3D5
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0x28
comma
l_int|0x3D4
)paren
suffix:semicolon
id|state-&gt;pixel
op_assign
id|inb
c_func
(paren
l_int|0x3D5
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0x2D
comma
l_int|0x3D4
)paren
suffix:semicolon
id|state-&gt;horiz
op_assign
id|inb
c_func
(paren
l_int|0x3D5
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0x1B
comma
l_int|0x3D4
)paren
suffix:semicolon
id|state-&gt;arbitration0
op_assign
id|inb
c_func
(paren
l_int|0x3D5
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0x20
comma
l_int|0x3D4
)paren
suffix:semicolon
id|state-&gt;arbitration1
op_assign
id|inb
c_func
(paren
l_int|0x3D5
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0x30
comma
l_int|0x3D4
)paren
suffix:semicolon
id|state-&gt;cursor0
op_assign
id|inb
c_func
(paren
l_int|0x3D5
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0x31
comma
l_int|0x3D4
)paren
suffix:semicolon
id|state-&gt;cursor1
op_assign
id|inb
c_func
(paren
l_int|0x3D5
)paren
suffix:semicolon
id|state-&gt;cursor2
op_assign
id|chip-&gt;PRAMDAC
(braket
l_int|0x00000300
op_div
l_int|4
)braket
suffix:semicolon
id|state-&gt;vpll
op_assign
id|chip-&gt;PRAMDAC
(braket
l_int|0x00000508
op_div
l_int|4
)braket
suffix:semicolon
id|state-&gt;pllsel
op_assign
id|chip-&gt;PRAMDAC
(braket
l_int|0x0000050C
op_div
l_int|4
)braket
suffix:semicolon
id|state-&gt;general
op_assign
id|chip-&gt;PRAMDAC
(braket
l_int|0x00000600
op_div
l_int|4
)braket
suffix:semicolon
id|state-&gt;config
op_assign
id|chip-&gt;PFB
(braket
l_int|0x00000200
op_div
l_int|4
)braket
suffix:semicolon
r_switch
c_cond
(paren
id|chip-&gt;Architecture
)paren
(brace
r_case
l_int|3
suffix:colon
id|state-&gt;offset0
op_assign
id|chip-&gt;PGRAPH
(braket
l_int|0x00000630
op_div
l_int|4
)braket
suffix:semicolon
id|state-&gt;offset1
op_assign
id|chip-&gt;PGRAPH
(braket
l_int|0x00000634
op_div
l_int|4
)braket
suffix:semicolon
id|state-&gt;offset2
op_assign
id|chip-&gt;PGRAPH
(braket
l_int|0x00000638
op_div
l_int|4
)braket
suffix:semicolon
id|state-&gt;offset3
op_assign
id|chip-&gt;PGRAPH
(braket
l_int|0x0000063C
op_div
l_int|4
)braket
suffix:semicolon
id|state-&gt;pitch0
op_assign
id|chip-&gt;PGRAPH
(braket
l_int|0x00000650
op_div
l_int|4
)braket
suffix:semicolon
id|state-&gt;pitch1
op_assign
id|chip-&gt;PGRAPH
(braket
l_int|0x00000654
op_div
l_int|4
)braket
suffix:semicolon
id|state-&gt;pitch2
op_assign
id|chip-&gt;PGRAPH
(braket
l_int|0x00000658
op_div
l_int|4
)braket
suffix:semicolon
id|state-&gt;pitch3
op_assign
id|chip-&gt;PGRAPH
(braket
l_int|0x0000065C
op_div
l_int|4
)braket
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
r_case
l_int|5
suffix:colon
id|state-&gt;offset0
op_assign
id|chip-&gt;PGRAPH
(braket
l_int|0x00000640
op_div
l_int|4
)braket
suffix:semicolon
id|state-&gt;offset1
op_assign
id|chip-&gt;PGRAPH
(braket
l_int|0x00000644
op_div
l_int|4
)braket
suffix:semicolon
id|state-&gt;offset2
op_assign
id|chip-&gt;PGRAPH
(braket
l_int|0x00000648
op_div
l_int|4
)braket
suffix:semicolon
id|state-&gt;offset3
op_assign
id|chip-&gt;PGRAPH
(braket
l_int|0x0000064C
op_div
l_int|4
)braket
suffix:semicolon
id|state-&gt;pitch0
op_assign
id|chip-&gt;PGRAPH
(braket
l_int|0x00000670
op_div
l_int|4
)braket
suffix:semicolon
id|state-&gt;pitch1
op_assign
id|chip-&gt;PGRAPH
(braket
l_int|0x00000674
op_div
l_int|4
)braket
suffix:semicolon
id|state-&gt;pitch2
op_assign
id|chip-&gt;PGRAPH
(braket
l_int|0x00000678
op_div
l_int|4
)braket
suffix:semicolon
id|state-&gt;pitch3
op_assign
id|chip-&gt;PGRAPH
(braket
l_int|0x0000067C
op_div
l_int|4
)braket
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
DECL|function|SetStartAddress
r_static
r_void
id|SetStartAddress
(paren
id|RIVA_HW_INST
op_star
id|chip
comma
r_int
id|start
)paren
(brace
r_int
id|offset
op_assign
id|start
op_rshift
l_int|2
suffix:semicolon
r_int
id|pan
op_assign
(paren
id|start
op_amp
l_int|3
)paren
op_lshift
l_int|1
suffix:semicolon
r_int
r_char
id|tmp
suffix:semicolon
multiline_comment|/*&n;     * Unlock extended registers.&n;     */
id|outb
c_func
(paren
id|chip-&gt;LockUnlockIndex
comma
id|chip-&gt;LockUnlockIO
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0x57
comma
id|chip-&gt;LockUnlockIO
op_plus
l_int|1
)paren
suffix:semicolon
multiline_comment|/*&n;     * Set start address.&n;     */
id|outb
c_func
(paren
l_int|0x0D
comma
l_int|0x3D4
)paren
suffix:semicolon
id|outb
c_func
(paren
id|offset
comma
l_int|0x3D5
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0x0C
comma
l_int|0x3D4
)paren
suffix:semicolon
id|outb
c_func
(paren
id|offset
op_rshift
l_int|8
comma
l_int|0x3D5
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0x19
comma
l_int|0x3D4
)paren
suffix:semicolon
id|tmp
op_assign
id|inb
c_func
(paren
l_int|0x3D5
)paren
suffix:semicolon
id|outb
c_func
(paren
(paren
(paren
id|offset
op_rshift
l_int|16
)paren
op_amp
l_int|0x0F
)paren
op_or
(paren
id|tmp
op_amp
l_int|0xF0
)paren
comma
l_int|0x3D5
)paren
suffix:semicolon
multiline_comment|/*&n;     * 4 pixel pan register.&n;     */
id|offset
op_assign
id|inb
c_func
(paren
id|chip-&gt;IO
op_plus
l_int|0x0A
)paren
suffix:semicolon
id|outb
c_func
(paren
l_int|0x13
comma
l_int|0x3C0
)paren
suffix:semicolon
id|outb
c_func
(paren
id|pan
comma
l_int|0x3C0
)paren
suffix:semicolon
)brace
DECL|function|nv3SetSurfaces2D
r_static
r_void
id|nv3SetSurfaces2D
(paren
id|RIVA_HW_INST
op_star
id|chip
comma
r_int
id|surf0
comma
r_int
id|surf1
)paren
(brace
r_while
c_loop
(paren
id|nv3Busy
c_func
(paren
id|chip
)paren
)paren
suffix:semicolon
id|chip-&gt;PGRAPH
(braket
l_int|0x00000630
op_div
l_int|4
)braket
op_assign
id|surf0
suffix:semicolon
id|chip-&gt;PGRAPH
(braket
l_int|0x00000634
op_div
l_int|4
)braket
op_assign
id|surf1
suffix:semicolon
)brace
DECL|function|nv4SetSurfaces2D
r_static
r_void
id|nv4SetSurfaces2D
(paren
id|RIVA_HW_INST
op_star
id|chip
comma
r_int
id|surf0
comma
r_int
id|surf1
)paren
(brace
r_while
c_loop
(paren
id|nv4Busy
c_func
(paren
id|chip
)paren
)paren
suffix:semicolon
id|chip-&gt;PGRAPH
(braket
l_int|0x00000640
op_div
l_int|4
)braket
op_assign
id|surf0
suffix:semicolon
id|chip-&gt;PGRAPH
(braket
l_int|0x00000644
op_div
l_int|4
)braket
op_assign
id|surf1
suffix:semicolon
)brace
DECL|function|nv3SetSurfaces3D
r_static
r_void
id|nv3SetSurfaces3D
(paren
id|RIVA_HW_INST
op_star
id|chip
comma
r_int
id|surf0
comma
r_int
id|surf1
)paren
(brace
r_while
c_loop
(paren
id|nv3Busy
c_func
(paren
id|chip
)paren
)paren
suffix:semicolon
id|chip-&gt;PGRAPH
(braket
l_int|0x00000638
op_div
l_int|4
)braket
op_assign
id|surf0
suffix:semicolon
id|chip-&gt;PGRAPH
(braket
l_int|0x0000063C
op_div
l_int|4
)braket
op_assign
id|surf1
suffix:semicolon
)brace
DECL|function|nv4SetSurfaces3D
r_static
r_void
id|nv4SetSurfaces3D
(paren
id|RIVA_HW_INST
op_star
id|chip
comma
r_int
id|surf0
comma
r_int
id|surf1
)paren
(brace
r_while
c_loop
(paren
id|nv4Busy
c_func
(paren
id|chip
)paren
)paren
suffix:semicolon
id|chip-&gt;PGRAPH
(braket
l_int|0x00000648
op_div
l_int|4
)braket
op_assign
id|surf0
suffix:semicolon
id|chip-&gt;PGRAPH
(braket
l_int|0x0000064C
op_div
l_int|4
)braket
op_assign
id|surf1
suffix:semicolon
)brace
multiline_comment|/****************************************************************************&bslash;&n;*                                                                            *&n;*                      Probe RIVA Chip Configuration                         *&n;*                                                                            *&n;&bslash;****************************************************************************/
DECL|function|nv3GetConfig
r_void
id|nv3GetConfig
(paren
id|RIVA_HW_INST
op_star
id|chip
)paren
(brace
multiline_comment|/*&n;     * Fill in chip configuration.&n;     */
r_if
c_cond
(paren
id|chip-&gt;PFB
(braket
l_int|0x00000000
op_div
l_int|4
)braket
op_amp
l_int|0x00000020
)paren
(brace
r_if
c_cond
(paren
(paren
(paren
id|chip-&gt;PMC
(braket
l_int|0x00000000
op_div
l_int|4
)braket
op_amp
l_int|0xF0
)paren
op_eq
l_int|0x20
)paren
op_logical_and
(paren
(paren
id|chip-&gt;PMC
(braket
l_int|0x00000000
op_div
l_int|4
)braket
op_amp
l_int|0x0F
)paren
op_ge
l_int|0x02
)paren
)paren
(brace
multiline_comment|/*&n;             * SDRAM 128 ZX.&n;             */
id|chip-&gt;RamBandwidthKBytesPerSec
op_assign
l_int|800000
suffix:semicolon
r_switch
c_cond
(paren
id|chip-&gt;PFB
(braket
l_int|0x00000000
op_div
l_int|4
)braket
op_amp
l_int|0x03
)paren
(brace
r_case
l_int|2
suffix:colon
id|chip-&gt;RamAmountKBytes
op_assign
l_int|1024
op_star
l_int|4
op_minus
l_int|32
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|chip-&gt;RamAmountKBytes
op_assign
l_int|1024
op_star
l_int|2
op_minus
l_int|32
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|chip-&gt;RamAmountKBytes
op_assign
l_int|1024
op_star
l_int|8
op_minus
l_int|32
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_else
(brace
id|chip-&gt;RamBandwidthKBytesPerSec
op_assign
l_int|1000000
suffix:semicolon
id|chip-&gt;RamAmountKBytes
op_assign
l_int|1024
op_star
l_int|8
op_minus
l_int|32
suffix:semicolon
)brace
)brace
r_else
(brace
multiline_comment|/*&n;         * SGRAM 128.&n;         */
id|chip-&gt;RamBandwidthKBytesPerSec
op_assign
l_int|1000000
suffix:semicolon
r_switch
c_cond
(paren
id|chip-&gt;PFB
(braket
l_int|0x00000000
op_div
l_int|4
)braket
op_amp
l_int|0x00000003
)paren
(brace
r_case
l_int|0
suffix:colon
id|chip-&gt;RamAmountKBytes
op_assign
l_int|1024
op_star
l_int|8
op_minus
l_int|32
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|chip-&gt;RamAmountKBytes
op_assign
l_int|1024
op_star
l_int|4
op_minus
l_int|32
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|chip-&gt;RamAmountKBytes
op_assign
l_int|1024
op_star
l_int|2
op_minus
l_int|32
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
id|chip-&gt;CrystalFreqKHz
op_assign
(paren
id|chip-&gt;PEXTDEV
(braket
l_int|0x00000000
op_div
l_int|4
)braket
op_amp
l_int|0x00000020
)paren
ques
c_cond
l_int|14318
suffix:colon
l_int|13500
suffix:semicolon
id|chip-&gt;CURSOR
op_assign
op_amp
(paren
id|chip-&gt;PRAMIN
(braket
l_int|0x00008000
op_div
l_int|4
op_minus
l_int|0x0800
op_div
l_int|4
)braket
)paren
suffix:semicolon
id|chip-&gt;CURSORPOS
op_assign
op_amp
(paren
id|chip-&gt;PRAMDAC
(braket
l_int|0x0300
op_div
l_int|4
)braket
)paren
suffix:semicolon
id|chip-&gt;VBLANKENABLE
op_assign
op_amp
(paren
id|chip-&gt;PGRAPH
(braket
l_int|0x0140
op_div
l_int|4
)braket
)paren
suffix:semicolon
id|chip-&gt;VBLANK
op_assign
op_amp
(paren
id|chip-&gt;PGRAPH
(braket
l_int|0x0100
op_div
l_int|4
)braket
)paren
suffix:semicolon
id|chip-&gt;VBlankBit
op_assign
l_int|0x00000100
suffix:semicolon
id|chip-&gt;MaxVClockFreqKHz
op_assign
l_int|230000
suffix:semicolon
id|chip-&gt;LockUnlockIO
op_assign
l_int|0x3C4
suffix:semicolon
id|chip-&gt;LockUnlockIndex
op_assign
l_int|0x06
suffix:semicolon
multiline_comment|/*&n;     * Set chip functions.&n;     */
id|chip-&gt;Busy
op_assign
id|nv3Busy
suffix:semicolon
id|chip-&gt;ShowHideCursor
op_assign
id|ShowHideCursor
suffix:semicolon
id|chip-&gt;CalcStateExt
op_assign
id|CalcStateExt
suffix:semicolon
id|chip-&gt;LoadStateExt
op_assign
id|LoadStateExt
suffix:semicolon
id|chip-&gt;UnloadStateExt
op_assign
id|UnloadStateExt
suffix:semicolon
id|chip-&gt;SetStartAddress
op_assign
id|SetStartAddress
suffix:semicolon
id|chip-&gt;SetSurfaces2D
op_assign
id|nv3SetSurfaces2D
suffix:semicolon
id|chip-&gt;SetSurfaces3D
op_assign
id|nv3SetSurfaces3D
suffix:semicolon
)brace
DECL|function|nv4GetConfig
r_void
id|nv4GetConfig
(paren
id|RIVA_HW_INST
op_star
id|chip
)paren
(brace
multiline_comment|/*&n;     * Fill in chip configuration.&n;     */
r_switch
c_cond
(paren
id|chip-&gt;PFB
(braket
l_int|0x00000000
op_div
l_int|4
)braket
op_amp
l_int|0x00000003
)paren
(brace
r_case
l_int|0
suffix:colon
id|chip-&gt;RamAmountKBytes
op_assign
l_int|1024
op_star
l_int|32
op_minus
l_int|128
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|chip-&gt;RamAmountKBytes
op_assign
l_int|1024
op_star
l_int|4
op_minus
l_int|128
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|chip-&gt;RamAmountKBytes
op_assign
l_int|1024
op_star
l_int|8
op_minus
l_int|128
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
r_default
suffix:colon
id|chip-&gt;RamAmountKBytes
op_assign
l_int|1024
op_star
l_int|16
op_minus
l_int|128
suffix:semicolon
r_break
suffix:semicolon
)brace
r_switch
c_cond
(paren
(paren
id|chip-&gt;PFB
(braket
l_int|0x00000000
op_div
l_int|4
)braket
op_rshift
l_int|3
)paren
op_amp
l_int|0x00000003
)paren
(brace
r_case
l_int|3
suffix:colon
id|chip-&gt;RamBandwidthKBytesPerSec
op_assign
l_int|800000
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|chip-&gt;RamBandwidthKBytesPerSec
op_assign
l_int|1000000
suffix:semicolon
r_break
suffix:semicolon
)brace
id|chip-&gt;CrystalFreqKHz
op_assign
(paren
id|chip-&gt;PEXTDEV
(braket
l_int|0x00000000
op_div
l_int|4
)braket
op_amp
l_int|0x00000040
)paren
ques
c_cond
l_int|14318
suffix:colon
l_int|13500
suffix:semicolon
id|chip-&gt;CURSOR
op_assign
op_amp
(paren
id|chip-&gt;PRAMIN
(braket
l_int|0x00010000
op_div
l_int|4
op_minus
l_int|0x0800
op_div
l_int|4
)braket
)paren
suffix:semicolon
id|chip-&gt;CURSORPOS
op_assign
op_amp
(paren
id|chip-&gt;PRAMDAC
(braket
l_int|0x0300
op_div
l_int|4
)braket
)paren
suffix:semicolon
id|chip-&gt;VBLANKENABLE
op_assign
op_amp
(paren
id|chip-&gt;PCRTC
(braket
l_int|0x0140
op_div
l_int|4
)braket
)paren
suffix:semicolon
id|chip-&gt;VBLANK
op_assign
op_amp
(paren
id|chip-&gt;PCRTC
(braket
l_int|0x0100
op_div
l_int|4
)braket
)paren
suffix:semicolon
id|chip-&gt;VBlankBit
op_assign
l_int|0x00000001
suffix:semicolon
id|chip-&gt;MaxVClockFreqKHz
op_assign
l_int|250000
suffix:semicolon
id|chip-&gt;LockUnlockIO
op_assign
l_int|0x3D4
suffix:semicolon
id|chip-&gt;LockUnlockIndex
op_assign
l_int|0x1F
suffix:semicolon
multiline_comment|/*&n;     * Set chip functions.&n;     */
id|chip-&gt;Busy
op_assign
id|nv4Busy
suffix:semicolon
id|chip-&gt;ShowHideCursor
op_assign
id|ShowHideCursor
suffix:semicolon
id|chip-&gt;CalcStateExt
op_assign
id|CalcStateExt
suffix:semicolon
id|chip-&gt;LoadStateExt
op_assign
id|LoadStateExt
suffix:semicolon
id|chip-&gt;UnloadStateExt
op_assign
id|UnloadStateExt
suffix:semicolon
id|chip-&gt;SetStartAddress
op_assign
id|SetStartAddress
suffix:semicolon
id|chip-&gt;SetSurfaces2D
op_assign
id|nv4SetSurfaces2D
suffix:semicolon
id|chip-&gt;SetSurfaces3D
op_assign
id|nv4SetSurfaces3D
suffix:semicolon
)brace
DECL|function|nv5GetConfig
r_void
id|nv5GetConfig
(paren
id|RIVA_HW_INST
op_star
id|chip
)paren
(brace
multiline_comment|/*&n;     * Fill in chip configuration.&n;     */
r_switch
c_cond
(paren
id|chip-&gt;PFB
(braket
l_int|0x00000000
op_div
l_int|4
)braket
op_amp
l_int|0x00000003
)paren
(brace
r_case
l_int|0
suffix:colon
id|chip-&gt;RamAmountKBytes
op_assign
l_int|1024
op_star
l_int|32
op_minus
l_int|128
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|chip-&gt;RamAmountKBytes
op_assign
l_int|1024
op_star
l_int|4
op_minus
l_int|128
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|chip-&gt;RamAmountKBytes
op_assign
l_int|1024
op_star
l_int|8
op_minus
l_int|128
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
r_default
suffix:colon
id|chip-&gt;RamAmountKBytes
op_assign
l_int|1024
op_star
l_int|16
op_minus
l_int|128
suffix:semicolon
r_break
suffix:semicolon
)brace
r_switch
c_cond
(paren
(paren
id|chip-&gt;PFB
(braket
l_int|0x00000000
op_div
l_int|4
)braket
op_rshift
l_int|3
)paren
op_amp
l_int|0x00000003
)paren
(brace
r_case
l_int|3
suffix:colon
id|chip-&gt;RamBandwidthKBytesPerSec
op_assign
l_int|800000
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|chip-&gt;RamBandwidthKBytesPerSec
op_assign
l_int|1000000
suffix:semicolon
r_break
suffix:semicolon
)brace
id|chip-&gt;CrystalFreqKHz
op_assign
(paren
id|chip-&gt;PEXTDEV
(braket
l_int|0x00000000
op_div
l_int|4
)braket
op_amp
l_int|0x00000040
)paren
ques
c_cond
l_int|14318
suffix:colon
l_int|13500
suffix:semicolon
id|chip-&gt;CURSOR
op_assign
op_amp
(paren
id|chip-&gt;PRAMIN
(braket
l_int|0x00010000
op_div
l_int|4
op_minus
l_int|0x0800
op_div
l_int|4
)braket
)paren
suffix:semicolon
id|chip-&gt;CURSORPOS
op_assign
op_amp
(paren
id|chip-&gt;PRAMDAC
(braket
l_int|0x0300
op_div
l_int|4
)braket
)paren
suffix:semicolon
id|chip-&gt;VBLANKENABLE
op_assign
op_amp
(paren
id|chip-&gt;PCRTC
(braket
l_int|0x0140
op_div
l_int|4
)braket
)paren
suffix:semicolon
id|chip-&gt;VBLANK
op_assign
op_amp
(paren
id|chip-&gt;PCRTC
(braket
l_int|0x0100
op_div
l_int|4
)braket
)paren
suffix:semicolon
id|chip-&gt;VBlankBit
op_assign
l_int|0x00000001
suffix:semicolon
id|chip-&gt;MaxVClockFreqKHz
op_assign
l_int|250000
suffix:semicolon
id|chip-&gt;LockUnlockIO
op_assign
l_int|0x3D4
suffix:semicolon
id|chip-&gt;LockUnlockIndex
op_assign
l_int|0x1F
suffix:semicolon
multiline_comment|/*&n;     * Set chip functions.&n;     */
id|chip-&gt;Busy
op_assign
id|nv4Busy
suffix:semicolon
id|chip-&gt;ShowHideCursor
op_assign
id|ShowHideCursor
suffix:semicolon
id|chip-&gt;CalcStateExt
op_assign
id|CalcStateExt
suffix:semicolon
id|chip-&gt;LoadStateExt
op_assign
id|LoadStateExt
suffix:semicolon
id|chip-&gt;UnloadStateExt
op_assign
id|UnloadStateExt
suffix:semicolon
id|chip-&gt;SetStartAddress
op_assign
id|SetStartAddress
suffix:semicolon
id|chip-&gt;SetSurfaces2D
op_assign
id|nv4SetSurfaces2D
suffix:semicolon
id|chip-&gt;SetSurfaces3D
op_assign
id|nv4SetSurfaces3D
suffix:semicolon
)brace
DECL|function|RivaGetConfig
r_int
id|RivaGetConfig
(paren
id|RIVA_HW_INST
op_star
id|chip
)paren
(brace
multiline_comment|/*&n;     * Save this so future SW know whats it&squot;s dealing with.&n;     */
id|chip-&gt;Version
op_assign
id|RIVA_SW_VERSION
suffix:semicolon
multiline_comment|/*&n;     * Chip specific configuration.&n;     */
r_switch
c_cond
(paren
id|chip-&gt;Architecture
)paren
(brace
r_case
l_int|3
suffix:colon
id|nv3GetConfig
c_func
(paren
id|chip
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
id|nv4GetConfig
c_func
(paren
id|chip
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
id|nv5GetConfig
c_func
(paren
id|chip
)paren
suffix:semicolon
r_default
suffix:colon
r_return
(paren
op_minus
l_int|1
)paren
suffix:semicolon
)brace
multiline_comment|/*&n;     * Fill in FIFO pointers.&n;     */
id|chip-&gt;Rop
op_assign
(paren
id|RivaRop
op_star
)paren
op_amp
(paren
id|chip-&gt;FIFO
(braket
l_int|0x00000000
op_div
l_int|4
)braket
)paren
suffix:semicolon
id|chip-&gt;Clip
op_assign
(paren
id|RivaClip
op_star
)paren
op_amp
(paren
id|chip-&gt;FIFO
(braket
l_int|0x00002000
op_div
l_int|4
)braket
)paren
suffix:semicolon
id|chip-&gt;Patt
op_assign
(paren
id|RivaPattern
op_star
)paren
op_amp
(paren
id|chip-&gt;FIFO
(braket
l_int|0x00004000
op_div
l_int|4
)braket
)paren
suffix:semicolon
id|chip-&gt;Pixmap
op_assign
(paren
id|RivaPixmap
op_star
)paren
op_amp
(paren
id|chip-&gt;FIFO
(braket
l_int|0x00006000
op_div
l_int|4
)braket
)paren
suffix:semicolon
id|chip-&gt;Blt
op_assign
(paren
id|RivaScreenBlt
op_star
)paren
op_amp
(paren
id|chip-&gt;FIFO
(braket
l_int|0x00008000
op_div
l_int|4
)braket
)paren
suffix:semicolon
id|chip-&gt;Bitmap
op_assign
(paren
id|RivaBitmap
op_star
)paren
op_amp
(paren
id|chip-&gt;FIFO
(braket
l_int|0x0000A000
op_div
l_int|4
)braket
)paren
suffix:semicolon
id|chip-&gt;Tri03
op_assign
(paren
id|RivaTexturedTriangle03
op_star
)paren
op_amp
(paren
id|chip-&gt;FIFO
(braket
l_int|0x0000E000
op_div
l_int|4
)braket
)paren
suffix:semicolon
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
eof
