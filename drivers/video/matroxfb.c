multiline_comment|/*&n; *&n; * Hardware accelerated Matrox Millennium I, II, Mystique, G100, G200 and G400&n; *&n; * (c) 1998,1999 Petr Vandrovec &lt;vandrove@vc.cvut.cz&gt;&n; *&n; * Version: 1.19 1999/08/05&n; *&n; * MTRR stuff: 1998 Tom Rini &lt;tmrini@ntplx.net&gt;&n; *&n; * Contributors: &quot;menion?&quot; &lt;menion@mindless.com&gt;&n; *                     Betatesting, fixes, ideas&n; *&n; *               &quot;Kurt Garloff&quot; &lt;garloff@kg1.ping.de&gt;&n; *                     Betatesting, fixes, ideas, videomodes, videomodes timmings&n; *&n; *               &quot;Tom Rini&quot; &lt;trini@disparity.net&gt;&n; *                     MTRR stuff, PPC cleanups, betatesting, fixes, ideas&n; *&n; *               &quot;Bibek Sahu&quot; &lt;scorpio@dodds.net&gt;&n; *                     Access device through readb|w|l and write b|w|l&n; *                     Extensive debugging stuff&n; *&n; *               &quot;Daniel Haun&quot; &lt;haund@usa.net&gt;&n; *                     Testing, hardware cursor fixes&n; *&n; *               &quot;Scott Wood&quot; &lt;sawst46+@pitt.edu&gt;&n; *                     Fixes&n; *&n; *               &quot;Gerd Knorr&quot; &lt;kraxel@goldbach.isdn.cs.tu-berlin.de&gt;&n; *                     Betatesting&n; *&n; *               &quot;Kelly French&quot; &lt;targon@hazmat.com&gt;&n; *               &quot;Fernando Herrera&quot; &lt;fherrera@eurielec.etsit.upm.es&gt;&n; *                     Betatesting, bug reporting&n; *&n; *               &quot;Pablo Bianucci&quot; &lt;pbian@pccp.com.ar&gt;&n; *                     Fixes, ideas, betatesting&n; *&n; *               &quot;Inaky Perez Gonzalez&quot; &lt;inaky@peloncho.fis.ucm.es&gt;&n; *                     Fixes, enhandcements, ideas, betatesting&n; *&n; *               &quot;Ryuichi Oikawa&quot; &lt;roikawa@rr.iiij4u.or.jp&gt;&n; *                     PPC betatesting, PPC support, backward compatibility&n; *&n; *               &quot;Paul Womar&quot; &lt;Paul@pwomar.demon.co.uk&gt;&n; *               &quot;Owen Waller&quot; &lt;O.Waller@ee.qub.ac.uk&gt;&n; *                     PPC betatesting &n; *&n; *               &quot;Thomas Pornin&quot; &lt;pornin@bolet.ens.fr&gt;&n; *                     Alpha betatesting&n; *&n; *               &quot;Pieter van Leuven&quot; &lt;pvl@iae.nl&gt;&n; *               &quot;Ulf Jaenicke-Roessler&quot; &lt;ujr@physik.phy.tu-dresden.de&gt;&n; *                     G100 testing&n; *&n; *               &quot;H. Peter Arvin&quot; &lt;hpa@transmeta.com&gt;&n; *                     Ideas&n; *&n; *               &quot;Cort Dougan&quot; &lt;cort@cs.nmt.edu&gt;&n; *                     CHRP fixes and PReP cleanup&n; *&n; *               &quot;Mark Vojkovich&quot; &lt;mvojkovi@ucsd.edu&gt;&n; *                     G400 support&n; *&n; * (following author is not in any relation with this code, but his code&n; *  is included in this driver)&n; *&n; * Based on framebuffer driver for VBE 2.0 compliant graphic boards&n; *     (c) 1998 Gerd Knorr &lt;kraxel@cs.tu-berlin.de&gt;&n; *&n; * (following author is not in any relation with this code, but his ideas&n; *  were used when writting this driver)&n; *&n; *&t;&t; FreeVBE/AF (Matrox), &quot;Shawn Hargreaves&quot; &lt;shawn@talula.demon.co.uk&gt;&n; *&n; */
multiline_comment|/* general, but fairly heavy, debugging */
DECL|macro|MATROXFB_DEBUG
macro_line|#undef MATROXFB_DEBUG
multiline_comment|/* heavy debugging: */
multiline_comment|/* -- logs putc[s], so everytime a char is displayed, it&squot;s logged */
DECL|macro|MATROXFB_DEBUG_HEAVY
macro_line|#undef MATROXFB_DEBUG_HEAVY
multiline_comment|/* This one _could_ cause infinite loops */
multiline_comment|/* It _does_ cause lots and lots of messages during idle loops */
DECL|macro|MATROXFB_DEBUG_LOOP
macro_line|#undef MATROXFB_DEBUG_LOOP 
multiline_comment|/* Debug register calls, too? */
DECL|macro|MATROXFB_DEBUG_REG
macro_line|#undef MATROXFB_DEBUG_REG
multiline_comment|/* Log reentrancy attempts - you must have printstate() patch applied */
DECL|macro|MATROXFB_DEBUG_REENTER
macro_line|#undef MATROXFB_DEBUG_REENTER
multiline_comment|/* you must define DEBUG_REENTER to get debugged CONSOLEBH... */
DECL|macro|MATROXFB_DEBUG_CONSOLEBH
macro_line|#undef MATROXFB_DEBUG_CONSOLEBH
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/errno.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/tty.h&gt;
macro_line|#include &lt;linux/malloc.h&gt;
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/fb.h&gt;
macro_line|#include &lt;linux/console.h&gt;
macro_line|#include &lt;linux/selection.h&gt;
macro_line|#include &lt;linux/ioport.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/timer.h&gt;
macro_line|#include &lt;linux/pci.h&gt;
macro_line|#include &lt;linux/spinlock.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;asm/unaligned.h&gt;
macro_line|#ifdef CONFIG_MTRR
macro_line|#include &lt;asm/mtrr.h&gt;
macro_line|#endif
macro_line|#include &lt;video/fbcon.h&gt;
macro_line|#include &lt;video/fbcon-cfb4.h&gt;
macro_line|#include &lt;video/fbcon-cfb8.h&gt;
macro_line|#include &lt;video/fbcon-cfb16.h&gt;
macro_line|#include &lt;video/fbcon-cfb24.h&gt;
macro_line|#include &lt;video/fbcon-cfb32.h&gt;
macro_line|#if defined(CONFIG_FB_OF)
macro_line|#if defined(CONFIG_FB_COMPAT_XPMAC)
macro_line|#include &lt;asm/vc_ioctl.h&gt;
macro_line|#endif
macro_line|#include &lt;asm/prom.h&gt;
macro_line|#include &lt;asm/pci-bridge.h&gt;
macro_line|#include &lt;video/macmodes.h&gt;
macro_line|#endif
multiline_comment|/* always compile support for 32MB... It cost almost nothing */
DECL|macro|CONFIG_FB_MATROX_32MB
mdefine_line|#define CONFIG_FB_MATROX_32MB
DECL|macro|FBCON_HAS_VGATEXT
mdefine_line|#define FBCON_HAS_VGATEXT
macro_line|#ifdef MATROXFB_DEBUG
DECL|macro|DEBUG
mdefine_line|#define DEBUG
DECL|macro|DBG
mdefine_line|#define DBG(x)&t;&t;printk(KERN_DEBUG &quot;matroxfb: %s&bslash;n&quot;, (x));
macro_line|#ifdef MATROXFB_DEBUG_HEAVY
DECL|macro|DBG_HEAVY
mdefine_line|#define DBG_HEAVY(x)&t;DBG(x)
macro_line|#else /* MATROXFB_DEBUG_HEAVY */
DECL|macro|DBG_HEAVY
mdefine_line|#define DBG_HEAVY(x)&t;/* DBG_HEAVY */
macro_line|#endif /* MATROXFB_DEBUG_HEAVY */
macro_line|#ifdef MATROXFB_DEBUG_LOOP
DECL|macro|DBG_LOOP
mdefine_line|#define DBG_LOOP(x)&t;DBG(x)
macro_line|#else /* MATROXFB_DEBUG_LOOP */
DECL|macro|DBG_LOOP
mdefine_line|#define DBG_LOOP(x)&t;/* DBG_LOOP */
macro_line|#endif /* MATROXFB_DEBUG_LOOP */
macro_line|#ifdef MATROXFB_DEBUG_REG
DECL|macro|DBG_REG
mdefine_line|#define DBG_REG(x)&t;DBG(x)
macro_line|#else /* MATROXFB_DEBUG_REG */
DECL|macro|DBG_REG
mdefine_line|#define DBG_REG(x)&t;/* DBG_REG */
macro_line|#endif /* MATROXFB_DEBUG_REG */
macro_line|#else /* MATROXFB_DEBUG */
DECL|macro|DBG
mdefine_line|#define DBG(x)&t;&t;/* DBG */
DECL|macro|DBG_HEAVY
mdefine_line|#define DBG_HEAVY(x)&t;/* DBG_HEAVY */
DECL|macro|DBG_REG
mdefine_line|#define DBG_REG(x)&t;/* DBG_REG */
DECL|macro|DBG_LOOP
mdefine_line|#define DBG_LOOP(x)&t;/* DBG_LOOP */
macro_line|#endif /* MATROXFB_DEBUG */
macro_line|#ifndef __i386__
macro_line|#ifndef ioremap_nocache
DECL|macro|ioremap_nocache
mdefine_line|#define ioremap_nocache(X,Y) ioremap(X,Y)
macro_line|#endif 
macro_line|#endif
macro_line|#if defined(__alpha__) || defined(__m68k__)
DECL|macro|READx_WORKS
mdefine_line|#define READx_WORKS
DECL|macro|MEMCPYTOIO_WORKS
mdefine_line|#define MEMCPYTOIO_WORKS
macro_line|#else
DECL|macro|READx_FAILS
mdefine_line|#define READx_FAILS
multiline_comment|/* recheck __ppc__, maybe that __ppc__ needs MEMCPYTOIO_WRITEL */
multiline_comment|/* I benchmarked PII/350MHz with G200... MEMCPY, MEMCPYTOIO and WRITEL are on same speed ( &lt;2% diff) */
multiline_comment|/* so that means that G200 speed (or AGP speed?) is our limit... I do not have benchmark to test, how */
multiline_comment|/* much of PCI bandwidth is used during transfers... */
macro_line|#if defined(__i386__)
DECL|macro|MEMCPYTOIO_MEMCPY
mdefine_line|#define MEMCPYTOIO_MEMCPY
macro_line|#else
DECL|macro|MEMCPYTOIO_WRITEL
mdefine_line|#define MEMCPYTOIO_WRITEL
macro_line|#endif
macro_line|#endif
macro_line|#ifdef __sparc__
macro_line|#error &quot;Sorry, I have no idea how to do this on sparc... There is mapioaddr... With bus_type parameter...&quot;
macro_line|#endif
macro_line|#if defined(__m68k__)
DECL|macro|MAP_BUSTOVIRT
mdefine_line|#define MAP_BUSTOVIRT
macro_line|#else
DECL|macro|MAP_IOREMAP
mdefine_line|#define MAP_IOREMAP
macro_line|#endif
macro_line|#ifdef DEBUG
DECL|macro|dprintk
mdefine_line|#define dprintk(X...)&t;printk(X)
macro_line|#else
DECL|macro|dprintk
mdefine_line|#define dprintk(X...)
macro_line|#endif
macro_line|#ifndef PCI_SS_VENDOR_ID_SIEMENS_NIXDORF
DECL|macro|PCI_SS_VENDOR_ID_SIEMENS_NIXDORF
mdefine_line|#define PCI_SS_VENDOR_ID_SIEMENS_NIXDORF&t;0x110A
macro_line|#endif
macro_line|#ifndef PCI_SS_VENDOR_ID_MATROX
DECL|macro|PCI_SS_VENDOR_ID_MATROX
mdefine_line|#define PCI_SS_VENDOR_ID_MATROX&t;&t;PCI_VENDOR_ID_MATROX
macro_line|#endif
macro_line|#ifndef PCI_DEVICE_ID_MATROX_G200_PCI
DECL|macro|PCI_DEVICE_ID_MATROX_G200_PCI
mdefine_line|#define PCI_DEVICE_ID_MATROX_G200_PCI&t;0x0520
macro_line|#endif
macro_line|#ifndef PCI_DEVICE_ID_MATROX_G200_AGP
DECL|macro|PCI_DEVICE_ID_MATROX_G200_AGP
mdefine_line|#define PCI_DEVICE_ID_MATROX_G200_AGP&t;0x0521
macro_line|#endif
macro_line|#ifndef PCI_DEVICE_ID_MATROX_G100
DECL|macro|PCI_DEVICE_ID_MATROX_G100
mdefine_line|#define PCI_DEVICE_ID_MATROX_G100&t;0x1000
macro_line|#endif
macro_line|#ifndef PCI_DEVICE_ID_MATROX_G100_AGP
DECL|macro|PCI_DEVICE_ID_MATROX_G100_AGP
mdefine_line|#define PCI_DEVICE_ID_MATROX_G100_AGP&t;0x1001
macro_line|#endif
macro_line|#ifndef PCI_DEVICE_ID_MATROX_G400_AGP
DECL|macro|PCI_DEVICE_ID_MATROX_G400_AGP
mdefine_line|#define PCI_DEVICE_ID_MATROX_G400_AGP&t;0x0525
macro_line|#endif
macro_line|#ifndef PCI_SS_ID_MATROX_PRODUCTIVA_G100_AGP
DECL|macro|PCI_SS_ID_MATROX_GENERIC
mdefine_line|#define PCI_SS_ID_MATROX_GENERIC&t;&t;0xFF00
DECL|macro|PCI_SS_ID_MATROX_PRODUCTIVA_G100_AGP
mdefine_line|#define PCI_SS_ID_MATROX_PRODUCTIVA_G100_AGP&t;0xFF01
DECL|macro|PCI_SS_ID_MATROX_MYSTIQUE_G200_AGP
mdefine_line|#define PCI_SS_ID_MATROX_MYSTIQUE_G200_AGP&t;0xFF02
DECL|macro|PCI_SS_ID_MATROX_MILLENIUM_G200_AGP
mdefine_line|#define PCI_SS_ID_MATROX_MILLENIUM_G200_AGP&t;0xFF03
DECL|macro|PCI_SS_ID_MATROX_MARVEL_G200_AGP
mdefine_line|#define PCI_SS_ID_MATROX_MARVEL_G200_AGP&t;0xFF04
DECL|macro|PCI_SS_ID_MATROX_MGA_G100_PCI
mdefine_line|#define PCI_SS_ID_MATROX_MGA_G100_PCI&t;&t;0xFF05
DECL|macro|PCI_SS_ID_MATROX_MGA_G100_AGP
mdefine_line|#define PCI_SS_ID_MATROX_MGA_G100_AGP&t;&t;0x1001
DECL|macro|PCI_SS_ID_SIEMENS_MGA_G100_AGP
mdefine_line|#define PCI_SS_ID_SIEMENS_MGA_G100_AGP&t;&t;0x001E /* 30 */
DECL|macro|PCI_SS_ID_SIEMENS_MGA_G200_AGP
mdefine_line|#define PCI_SS_ID_SIEMENS_MGA_G200_AGP&t;&t;0x0032 /* 50 */
macro_line|#endif
DECL|macro|MX_VISUAL_TRUECOLOR
mdefine_line|#define MX_VISUAL_TRUECOLOR&t;FB_VISUAL_DIRECTCOLOR
DECL|macro|MX_VISUAL_DIRECTCOLOR
mdefine_line|#define MX_VISUAL_DIRECTCOLOR&t;FB_VISUAL_TRUECOLOR
DECL|macro|MX_VISUAL_PSEUDOCOLOR
mdefine_line|#define MX_VISUAL_PSEUDOCOLOR&t;FB_VISUAL_PSEUDOCOLOR
DECL|macro|CNVT_TOHW
mdefine_line|#define CNVT_TOHW(val,width) ((((val)&lt;&lt;(width))+0x7FFF-(val))&gt;&gt;16)
multiline_comment|/* G100, G200 and Mystique have (almost) same DAC */
DECL|macro|NEED_DAC1064
macro_line|#undef NEED_DAC1064
macro_line|#if defined(CONFIG_FB_MATROX_MYSTIQUE) || defined(CONFIG_FB_MATROX_G100)
DECL|macro|NEED_DAC1064
mdefine_line|#define NEED_DAC1064 1
macro_line|#endif
r_typedef
r_struct
(brace
DECL|member|vaddr
id|u_int8_t
op_star
id|vaddr
suffix:semicolon
DECL|typedef|vaddr_t
)brace
id|vaddr_t
suffix:semicolon
macro_line|#ifdef READx_WORKS
DECL|function|mga_readb
r_static
r_inline
r_int
r_int
id|mga_readb
c_func
(paren
id|vaddr_t
id|va
comma
r_int
r_int
id|offs
)paren
(brace
r_return
id|readb
c_func
(paren
id|va.vaddr
op_plus
id|offs
)paren
suffix:semicolon
)brace
DECL|function|mga_readw
r_static
r_inline
r_int
r_int
id|mga_readw
c_func
(paren
id|vaddr_t
id|va
comma
r_int
r_int
id|offs
)paren
(brace
r_return
id|readw
c_func
(paren
id|va.vaddr
op_plus
id|offs
)paren
suffix:semicolon
)brace
DECL|function|mga_readl
r_static
r_inline
id|u_int32_t
id|mga_readl
c_func
(paren
id|vaddr_t
id|va
comma
r_int
r_int
id|offs
)paren
(brace
r_return
id|readl
c_func
(paren
id|va.vaddr
op_plus
id|offs
)paren
suffix:semicolon
)brace
DECL|function|mga_writeb
r_static
r_inline
r_void
id|mga_writeb
c_func
(paren
id|vaddr_t
id|va
comma
r_int
r_int
id|offs
comma
id|u_int8_t
id|value
)paren
(brace
id|writeb
c_func
(paren
id|value
comma
id|va.vaddr
op_plus
id|offs
)paren
suffix:semicolon
)brace
DECL|function|mga_writew
r_static
r_inline
r_void
id|mga_writew
c_func
(paren
id|vaddr_t
id|va
comma
r_int
r_int
id|offs
comma
id|u_int16_t
id|value
)paren
(brace
id|writew
c_func
(paren
id|value
comma
id|va.vaddr
op_plus
id|offs
)paren
suffix:semicolon
)brace
DECL|function|mga_writel
r_static
r_inline
r_void
id|mga_writel
c_func
(paren
id|vaddr_t
id|va
comma
r_int
r_int
id|offs
comma
id|u_int32_t
id|value
)paren
(brace
id|writel
c_func
(paren
id|value
comma
id|va.vaddr
op_plus
id|offs
)paren
suffix:semicolon
)brace
macro_line|#else
DECL|function|mga_readb
r_static
r_inline
r_int
r_int
id|mga_readb
c_func
(paren
id|vaddr_t
id|va
comma
r_int
r_int
id|offs
)paren
(brace
r_return
op_star
(paren
r_volatile
id|u_int8_t
op_star
)paren
(paren
id|va.vaddr
op_plus
id|offs
)paren
suffix:semicolon
)brace
DECL|function|mga_readw
r_static
r_inline
r_int
r_int
id|mga_readw
c_func
(paren
id|vaddr_t
id|va
comma
r_int
r_int
id|offs
)paren
(brace
r_return
op_star
(paren
r_volatile
id|u_int16_t
op_star
)paren
(paren
id|va.vaddr
op_plus
id|offs
)paren
suffix:semicolon
)brace
DECL|function|mga_readl
r_static
r_inline
id|u_int32_t
id|mga_readl
c_func
(paren
id|vaddr_t
id|va
comma
r_int
r_int
id|offs
)paren
(brace
r_return
op_star
(paren
r_volatile
id|u_int32_t
op_star
)paren
(paren
id|va.vaddr
op_plus
id|offs
)paren
suffix:semicolon
)brace
DECL|function|mga_writeb
r_static
r_inline
r_void
id|mga_writeb
c_func
(paren
id|vaddr_t
id|va
comma
r_int
r_int
id|offs
comma
id|u_int8_t
id|value
)paren
(brace
op_star
(paren
r_volatile
id|u_int8_t
op_star
)paren
(paren
id|va.vaddr
op_plus
id|offs
)paren
op_assign
id|value
suffix:semicolon
)brace
DECL|function|mga_writew
r_static
r_inline
r_void
id|mga_writew
c_func
(paren
id|vaddr_t
id|va
comma
r_int
r_int
id|offs
comma
id|u_int16_t
id|value
)paren
(brace
op_star
(paren
r_volatile
id|u_int16_t
op_star
)paren
(paren
id|va.vaddr
op_plus
id|offs
)paren
op_assign
id|value
suffix:semicolon
)brace
DECL|function|mga_writel
r_static
r_inline
r_void
id|mga_writel
c_func
(paren
id|vaddr_t
id|va
comma
r_int
r_int
id|offs
comma
id|u_int32_t
id|value
)paren
(brace
op_star
(paren
r_volatile
id|u_int32_t
op_star
)paren
(paren
id|va.vaddr
op_plus
id|offs
)paren
op_assign
id|value
suffix:semicolon
)brace
macro_line|#endif
DECL|function|mga_memcpy_toio
r_static
r_inline
r_void
id|mga_memcpy_toio
c_func
(paren
id|vaddr_t
id|va
comma
r_int
r_int
id|offs
comma
r_const
r_void
op_star
id|src
comma
r_int
id|len
)paren
(brace
macro_line|#ifdef MEMCPYTOIO_WORKS
id|memcpy_toio
c_func
(paren
id|va.vaddr
op_plus
id|offs
comma
id|src
comma
id|len
)paren
suffix:semicolon
macro_line|#elif defined(MEMCPYTOIO_WRITEL)
mdefine_line|#define srcd ((const u_int32_t*)src)
r_if
c_cond
(paren
id|offs
op_amp
l_int|3
)paren
(brace
r_while
c_loop
(paren
id|len
op_ge
l_int|4
)paren
(brace
id|mga_writel
c_func
(paren
id|va
comma
id|offs
comma
id|get_unaligned
c_func
(paren
id|srcd
op_increment
)paren
)paren
suffix:semicolon
id|offs
op_add_assign
l_int|4
suffix:semicolon
id|len
op_sub_assign
l_int|4
suffix:semicolon
)brace
)brace
r_else
(brace
r_while
c_loop
(paren
id|len
op_ge
l_int|4
)paren
(brace
id|mga_writel
c_func
(paren
id|va
comma
id|offs
comma
op_star
id|srcd
op_increment
)paren
suffix:semicolon
id|offs
op_add_assign
l_int|4
suffix:semicolon
id|len
op_sub_assign
l_int|4
suffix:semicolon
)brace
)brace
macro_line|#undef srcd
r_if
c_cond
(paren
id|len
)paren
(brace
id|u_int32_t
id|tmp
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|tmp
comma
id|src
comma
id|len
)paren
suffix:semicolon
id|mga_writel
c_func
(paren
id|va
comma
id|offs
comma
id|tmp
)paren
suffix:semicolon
)brace
macro_line|#elif defined(MEMCPYTOIO_MEMCPY)
id|memcpy
c_func
(paren
id|va.vaddr
op_plus
id|offs
comma
id|src
comma
id|len
)paren
suffix:semicolon
macro_line|#else
macro_line|#error &quot;Sorry, do not know how to write block of data to device&quot;
macro_line|#endif
)brace
DECL|function|vaddr_add
r_static
r_inline
r_void
id|vaddr_add
c_func
(paren
id|vaddr_t
op_star
id|va
comma
r_int
r_int
id|offs
)paren
(brace
id|va-&gt;vaddr
op_add_assign
id|offs
suffix:semicolon
)brace
DECL|function|vaddr_va
r_static
r_inline
r_void
op_star
id|vaddr_va
c_func
(paren
id|vaddr_t
id|va
)paren
(brace
r_return
id|va.vaddr
suffix:semicolon
)brace
DECL|macro|MGA_IOREMAP_NORMAL
mdefine_line|#define MGA_IOREMAP_NORMAL&t;0
DECL|macro|MGA_IOREMAP_NOCACHE
mdefine_line|#define MGA_IOREMAP_NOCACHE&t;1
DECL|macro|MGA_IOREMAP_FB
mdefine_line|#define MGA_IOREMAP_FB&t;&t;MGA_IOREMAP_NOCACHE
DECL|macro|MGA_IOREMAP_MMIO
mdefine_line|#define MGA_IOREMAP_MMIO&t;MGA_IOREMAP_NOCACHE
DECL|function|mga_ioremap
r_static
r_inline
r_int
id|mga_ioremap
c_func
(paren
r_int
r_int
id|phys
comma
r_int
r_int
id|size
comma
r_int
id|flags
comma
id|vaddr_t
op_star
id|virt
)paren
(brace
macro_line|#ifdef MAP_IOREMAP
r_if
c_cond
(paren
id|flags
op_amp
id|MGA_IOREMAP_NOCACHE
)paren
id|virt-&gt;vaddr
op_assign
id|ioremap_nocache
c_func
(paren
id|phys
comma
id|size
)paren
suffix:semicolon
r_else
id|virt-&gt;vaddr
op_assign
id|ioremap
c_func
(paren
id|phys
comma
id|size
)paren
suffix:semicolon
macro_line|#else
macro_line|#ifdef MAP_BUSTOVIRT
id|virt-&gt;vaddr
op_assign
id|bus_to_virt
c_func
(paren
id|phys
)paren
suffix:semicolon
macro_line|#else
macro_line|#error &quot;Your architecture does not have neither ioremap nor bus_to_virt... Giving up&quot;
macro_line|#endif
macro_line|#endif
r_return
(paren
id|virt-&gt;vaddr
op_eq
l_int|0
)paren
suffix:semicolon
multiline_comment|/* 0, !0... 0, error_code in future */
)brace
DECL|function|mga_iounmap
r_static
r_inline
r_void
id|mga_iounmap
c_func
(paren
id|vaddr_t
id|va
)paren
(brace
macro_line|#ifdef MAP_IOREMAP
id|iounmap
c_func
(paren
id|va.vaddr
)paren
suffix:semicolon
macro_line|#endif
)brace
DECL|struct|matroxfb_par
r_struct
id|matroxfb_par
(brace
DECL|member|final_bppShift
r_int
r_int
id|final_bppShift
suffix:semicolon
DECL|member|cmap_len
r_int
r_int
id|cmap_len
suffix:semicolon
r_struct
(brace
DECL|member|bytes
r_int
r_int
id|bytes
suffix:semicolon
DECL|member|pixels
r_int
r_int
id|pixels
suffix:semicolon
DECL|member|chunks
r_int
r_int
id|chunks
suffix:semicolon
DECL|member|ydstorg
)brace
id|ydstorg
suffix:semicolon
DECL|member|putc
r_void
(paren
op_star
id|putc
)paren
(paren
id|u_int32_t
comma
id|u_int32_t
comma
r_struct
id|display
op_star
comma
r_int
comma
r_int
comma
r_int
)paren
suffix:semicolon
DECL|member|putcs
r_void
(paren
op_star
id|putcs
)paren
(paren
id|u_int32_t
comma
id|u_int32_t
comma
r_struct
id|display
op_star
comma
r_const
r_int
r_int
op_star
comma
r_int
comma
r_int
comma
r_int
)paren
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|my_timming
r_struct
id|my_timming
(brace
DECL|member|pixclock
r_int
r_int
id|pixclock
suffix:semicolon
DECL|member|HDisplay
r_int
r_int
id|HDisplay
suffix:semicolon
DECL|member|HSyncStart
r_int
r_int
id|HSyncStart
suffix:semicolon
DECL|member|HSyncEnd
r_int
r_int
id|HSyncEnd
suffix:semicolon
DECL|member|HTotal
r_int
r_int
id|HTotal
suffix:semicolon
DECL|member|VDisplay
r_int
r_int
id|VDisplay
suffix:semicolon
DECL|member|VSyncStart
r_int
r_int
id|VSyncStart
suffix:semicolon
DECL|member|VSyncEnd
r_int
r_int
id|VSyncEnd
suffix:semicolon
DECL|member|VTotal
r_int
r_int
id|VTotal
suffix:semicolon
DECL|member|sync
r_int
r_int
id|sync
suffix:semicolon
DECL|member|dblscan
r_int
id|dblscan
suffix:semicolon
DECL|member|interlaced
r_int
id|interlaced
suffix:semicolon
)brace
suffix:semicolon
r_struct
id|matrox_fb_info
suffix:semicolon
DECL|macro|MATROX_2MB_WITH_4MB_ADDON
mdefine_line|#define MATROX_2MB_WITH_4MB_ADDON
DECL|struct|matrox_pll_features
r_struct
id|matrox_pll_features
(brace
DECL|member|vco_freq_min
r_int
r_int
id|vco_freq_min
suffix:semicolon
DECL|member|ref_freq
r_int
r_int
id|ref_freq
suffix:semicolon
DECL|member|feed_div_min
r_int
r_int
id|feed_div_min
suffix:semicolon
DECL|member|feed_div_max
r_int
r_int
id|feed_div_max
suffix:semicolon
DECL|member|in_div_min
r_int
r_int
id|in_div_min
suffix:semicolon
DECL|member|in_div_max
r_int
r_int
id|in_div_max
suffix:semicolon
DECL|member|post_shift_max
r_int
r_int
id|post_shift_max
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|matrox_DAC1064_features
r_struct
id|matrox_DAC1064_features
(brace
DECL|member|xvrefctrl
id|u_int8_t
id|xvrefctrl
suffix:semicolon
DECL|member|cursorimage
r_int
r_int
id|cursorimage
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|matrox_accel_features
r_struct
id|matrox_accel_features
(brace
DECL|member|has_cacheflush
r_int
id|has_cacheflush
suffix:semicolon
)brace
suffix:semicolon
multiline_comment|/* current hardware status */
DECL|struct|matrox_hw_state
r_struct
id|matrox_hw_state
(brace
DECL|member|MXoptionReg
id|u_int32_t
id|MXoptionReg
suffix:semicolon
DECL|member|DACclk
r_int
r_char
id|DACclk
(braket
l_int|6
)braket
suffix:semicolon
DECL|member|DACreg
r_int
r_char
id|DACreg
(braket
l_int|64
)braket
suffix:semicolon
DECL|member|MiscOutReg
r_int
r_char
id|MiscOutReg
suffix:semicolon
DECL|member|DACpal
r_int
r_char
id|DACpal
(braket
l_int|768
)braket
suffix:semicolon
DECL|member|CRTC
r_int
r_char
id|CRTC
(braket
l_int|25
)braket
suffix:semicolon
DECL|member|CRTCEXT
r_int
r_char
id|CRTCEXT
(braket
l_int|9
)braket
suffix:semicolon
DECL|member|SEQ
r_int
r_char
id|SEQ
(braket
l_int|5
)braket
suffix:semicolon
multiline_comment|/* unused for MGA mode, but who knows... */
DECL|member|GCTL
r_int
r_char
id|GCTL
(braket
l_int|9
)braket
suffix:semicolon
multiline_comment|/* unused for MGA mode, but who knows... */
DECL|member|ATTR
r_int
r_char
id|ATTR
(braket
l_int|21
)braket
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|matrox_accel_data
r_struct
id|matrox_accel_data
(brace
macro_line|#ifdef CONFIG_FB_MATROX_MILLENIUM
DECL|member|ramdac_rev
r_int
r_char
id|ramdac_rev
suffix:semicolon
macro_line|#endif
DECL|member|m_dwg_rect
id|u_int32_t
id|m_dwg_rect
suffix:semicolon
DECL|member|m_opmode
id|u_int32_t
id|m_opmode
suffix:semicolon
)brace
suffix:semicolon
macro_line|#ifdef CONFIG_FB_MATROX_MULTIHEAD
DECL|macro|ACCESS_FBINFO2
mdefine_line|#define ACCESS_FBINFO2(info, x) (info-&gt;x)
DECL|macro|ACCESS_FBINFO
mdefine_line|#define ACCESS_FBINFO(x) ACCESS_FBINFO2(minfo,x)
DECL|macro|MINFO
mdefine_line|#define MINFO minfo
DECL|macro|WPMINFO
mdefine_line|#define WPMINFO struct matrox_fb_info* minfo,
DECL|macro|CPMINFO
mdefine_line|#define CPMINFO&t;const struct matrox_fb_info* minfo,
DECL|macro|PMINFO
mdefine_line|#define PMINFO  minfo,
DECL|function|mxinfo
r_static
r_inline
r_struct
id|matrox_fb_info
op_star
id|mxinfo
c_func
(paren
r_const
r_struct
id|display
op_star
id|p
)paren
(brace
r_return
(paren
r_struct
id|matrox_fb_info
op_star
)paren
id|p-&gt;fb_info
suffix:semicolon
)brace
DECL|macro|PMXINFO
mdefine_line|#define PMXINFO(p) mxinfo(p),
DECL|macro|MINFO_FROM
mdefine_line|#define MINFO_FROM(x)&t;   struct matrox_fb_info* minfo = x
DECL|macro|MINFO_FROM_DISP
mdefine_line|#define MINFO_FROM_DISP(x) MINFO_FROM(mxinfo(x))
macro_line|#else
DECL|variable|global_mxinfo
r_struct
id|matrox_fb_info
id|global_mxinfo
suffix:semicolon
DECL|variable|global_disp
r_struct
id|display
id|global_disp
suffix:semicolon
DECL|macro|ACCESS_FBINFO
mdefine_line|#define ACCESS_FBINFO(x) (global_mxinfo.x)
DECL|macro|ACCESS_FBINFO2
mdefine_line|#define ACCESS_FBINFO2(info, x) (global_mxinfo.x)
DECL|macro|MINFO
mdefine_line|#define MINFO (&amp;global_mxinfo)
DECL|macro|WPMINFO
mdefine_line|#define WPMINFO
DECL|macro|CPMINFO
mdefine_line|#define CPMINFO
DECL|macro|PMINFO
mdefine_line|#define PMINFO
macro_line|#if 0
r_static
r_inline
r_struct
id|matrox_fb_info
op_star
id|mxinfo
c_func
(paren
r_const
r_struct
id|display
op_star
id|p
)paren
(brace
r_return
op_amp
id|global_mxinfo
suffix:semicolon
)brace
macro_line|#endif
DECL|macro|PMXINFO
mdefine_line|#define PMXINFO(p)
DECL|macro|MINFO_FROM
mdefine_line|#define MINFO_FROM(x)
DECL|macro|MINFO_FROM_DISP
mdefine_line|#define MINFO_FROM_DISP(x)
macro_line|#endif
DECL|struct|matrox_switch
r_struct
id|matrox_switch
(brace
DECL|member|preinit
r_int
(paren
op_star
id|preinit
)paren
(paren
id|WPMINFO
r_struct
id|matrox_hw_state
op_star
)paren
suffix:semicolon
DECL|member|reset
r_void
(paren
op_star
id|reset
)paren
(paren
id|WPMINFO
r_struct
id|matrox_hw_state
op_star
)paren
suffix:semicolon
DECL|member|init
r_int
(paren
op_star
id|init
)paren
(paren
id|CPMINFO
r_struct
id|matrox_hw_state
op_star
comma
r_struct
id|my_timming
op_star
comma
r_struct
id|display
op_star
)paren
suffix:semicolon
DECL|member|restore
r_void
(paren
op_star
id|restore
)paren
(paren
id|WPMINFO
r_struct
id|matrox_hw_state
op_star
comma
r_struct
id|matrox_hw_state
op_star
comma
r_struct
id|display
op_star
)paren
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|matrox_fb_info
r_struct
id|matrox_fb_info
(brace
multiline_comment|/* fb_info must be first */
DECL|member|fbcon
r_struct
id|fb_info
id|fbcon
suffix:semicolon
DECL|member|next_fb
r_struct
id|matrox_fb_info
op_star
id|next_fb
suffix:semicolon
DECL|member|curr
r_struct
id|matroxfb_par
id|curr
suffix:semicolon
DECL|member|hw1
r_struct
id|matrox_hw_state
id|hw1
suffix:semicolon
DECL|member|hw2
r_struct
id|matrox_hw_state
id|hw2
suffix:semicolon
DECL|member|newhw
r_struct
id|matrox_hw_state
op_star
id|newhw
suffix:semicolon
DECL|member|currenthw
r_struct
id|matrox_hw_state
op_star
id|currenthw
suffix:semicolon
DECL|member|accel
r_struct
id|matrox_accel_data
id|accel
suffix:semicolon
DECL|member|pcidev
r_struct
id|pci_dev
op_star
id|pcidev
suffix:semicolon
r_struct
(brace
DECL|member|base
r_int
r_int
id|base
suffix:semicolon
multiline_comment|/* physical */
DECL|member|vbase
id|vaddr_t
id|vbase
suffix:semicolon
multiline_comment|/* CPU view */
DECL|member|len
r_int
r_int
id|len
suffix:semicolon
DECL|member|len_usable
r_int
r_int
id|len_usable
suffix:semicolon
DECL|member|video
)brace
id|video
suffix:semicolon
r_struct
(brace
DECL|member|base
r_int
r_int
id|base
suffix:semicolon
multiline_comment|/* physical */
DECL|member|vbase
id|vaddr_t
id|vbase
suffix:semicolon
multiline_comment|/* CPU view */
DECL|member|len
r_int
r_int
id|len
suffix:semicolon
DECL|member|mmio
)brace
id|mmio
suffix:semicolon
DECL|member|max_pixel_clock
r_int
r_int
id|max_pixel_clock
suffix:semicolon
DECL|member|hw_switch
r_struct
id|matrox_switch
op_star
id|hw_switch
suffix:semicolon
DECL|member|currcon
r_int
id|currcon
suffix:semicolon
DECL|member|currcon_display
r_struct
id|display
op_star
id|currcon_display
suffix:semicolon
r_struct
(brace
DECL|member|pll
r_struct
id|matrox_pll_features
id|pll
suffix:semicolon
DECL|member|DAC1064
r_struct
id|matrox_DAC1064_features
id|DAC1064
suffix:semicolon
DECL|member|accel
r_struct
id|matrox_accel_features
id|accel
suffix:semicolon
DECL|member|features
)brace
id|features
suffix:semicolon
r_struct
(brace
DECL|member|DAC
id|spinlock_t
id|DAC
suffix:semicolon
DECL|member|lock
)brace
id|lock
suffix:semicolon
DECL|member|interleave
r_int
id|interleave
suffix:semicolon
DECL|member|millenium
r_int
id|millenium
suffix:semicolon
DECL|member|milleniumII
r_int
id|milleniumII
suffix:semicolon
r_struct
(brace
DECL|member|cfb4
r_int
id|cfb4
suffix:semicolon
DECL|member|vxres
r_const
r_int
op_star
id|vxres
suffix:semicolon
DECL|member|cross4MB
r_int
id|cross4MB
suffix:semicolon
DECL|member|text
r_int
id|text
suffix:semicolon
DECL|member|plnwt
r_int
id|plnwt
suffix:semicolon
DECL|member|capable
)brace
id|capable
suffix:semicolon
r_struct
(brace
DECL|member|size
r_int
r_int
id|size
suffix:semicolon
DECL|member|mgabase
r_int
r_int
id|mgabase
suffix:semicolon
DECL|member|vbase
id|vaddr_t
id|vbase
suffix:semicolon
DECL|member|fastfont
)brace
id|fastfont
suffix:semicolon
macro_line|#ifdef CONFIG_MTRR
r_struct
(brace
DECL|member|vram
r_int
id|vram
suffix:semicolon
DECL|member|vram_valid
r_int
id|vram_valid
suffix:semicolon
DECL|member|mtrr
)brace
id|mtrr
suffix:semicolon
macro_line|#endif
r_struct
(brace
DECL|member|precise_width
r_int
id|precise_width
suffix:semicolon
DECL|member|mga_24bpp_fix
r_int
id|mga_24bpp_fix
suffix:semicolon
DECL|member|novga
r_int
id|novga
suffix:semicolon
DECL|member|nobios
r_int
id|nobios
suffix:semicolon
DECL|member|nopciretry
r_int
id|nopciretry
suffix:semicolon
DECL|member|noinit
r_int
id|noinit
suffix:semicolon
DECL|member|inverse
r_int
id|inverse
suffix:semicolon
DECL|member|hwcursor
r_int
id|hwcursor
suffix:semicolon
DECL|member|blink
r_int
id|blink
suffix:semicolon
DECL|member|sgram
r_int
id|sgram
suffix:semicolon
macro_line|#ifdef CONFIG_FB_MATROX_32MB
DECL|member|support32MB
r_int
id|support32MB
suffix:semicolon
macro_line|#endif
DECL|member|accelerator
r_int
id|accelerator
suffix:semicolon
DECL|member|text_type_aux
r_int
id|text_type_aux
suffix:semicolon
DECL|member|video64bits
r_int
id|video64bits
suffix:semicolon
DECL|member|vgastep
r_int
r_int
id|vgastep
suffix:semicolon
DECL|member|textmode
r_int
r_int
id|textmode
suffix:semicolon
DECL|member|textstep
r_int
r_int
id|textstep
suffix:semicolon
DECL|member|textvram
r_int
r_int
id|textvram
suffix:semicolon
multiline_comment|/* character cells */
DECL|member|ydstorg
r_int
r_int
id|ydstorg
suffix:semicolon
multiline_comment|/* offset in bytes from video start to usable memory */
multiline_comment|/* 0 except for 6MB Millenium */
DECL|member|devflags
)brace
id|devflags
suffix:semicolon
DECL|member|dispsw
r_struct
id|display_switch
id|dispsw
suffix:semicolon
r_struct
(brace
DECL|member|x
r_int
id|x
suffix:semicolon
DECL|member|y
r_int
id|y
suffix:semicolon
DECL|member|w
r_int
r_int
id|w
suffix:semicolon
DECL|member|u
r_int
r_int
id|u
suffix:semicolon
DECL|member|d
r_int
r_int
id|d
suffix:semicolon
DECL|member|type
r_int
r_int
id|type
suffix:semicolon
DECL|member|state
r_int
id|state
suffix:semicolon
DECL|member|redraw
r_int
id|redraw
suffix:semicolon
DECL|member|timer
r_struct
id|timer_list
id|timer
suffix:semicolon
DECL|member|cursor
)brace
id|cursor
suffix:semicolon
macro_line|#if defined(FBCON_HAS_CFB16) || defined(FBCON_HAS_CFB24) || defined(FBCON_HAS_CFB32)
r_union
(brace
macro_line|#ifdef FBCON_HAS_CFB16
DECL|member|cfb16
id|u_int16_t
id|cfb16
(braket
l_int|16
)braket
suffix:semicolon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB24
DECL|member|cfb24
id|u_int32_t
id|cfb24
(braket
l_int|16
)braket
suffix:semicolon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB32
DECL|member|cfb32
id|u_int32_t
id|cfb32
(braket
l_int|16
)braket
suffix:semicolon
macro_line|#endif
DECL|member|cmap
)brace
id|cmap
suffix:semicolon
macro_line|#endif
DECL|member|red
DECL|member|green
DECL|member|blue
DECL|member|transp
DECL|member|palette
r_struct
(brace
r_int
id|red
comma
id|green
comma
id|blue
comma
id|transp
suffix:semicolon
)brace
id|palette
(braket
l_int|256
)braket
suffix:semicolon
macro_line|#if defined(CONFIG_FB_OF) &amp;&amp; defined(CONFIG_FB_COMPAT_XPMAC)
DECL|member|matrox_name
r_char
id|matrox_name
(braket
l_int|32
)braket
suffix:semicolon
macro_line|#endif
)brace
suffix:semicolon
macro_line|#if defined(CONFIG_FB_OF)
r_int
r_char
id|nvram_read_byte
c_func
(paren
r_int
)paren
suffix:semicolon
r_int
id|matrox_of_init
c_func
(paren
r_struct
id|device_node
op_star
id|dp
)paren
suffix:semicolon
DECL|variable|default_vmode
r_static
r_int
id|default_vmode
op_assign
id|VMODE_NVRAM
suffix:semicolon
DECL|variable|default_cmode
r_static
r_int
id|default_cmode
op_assign
id|CMODE_NVRAM
suffix:semicolon
macro_line|#endif
DECL|macro|curr_ydstorg
mdefine_line|#define curr_ydstorg(x)&t;ACCESS_FBINFO2(x, curr.ydstorg.pixels)
DECL|macro|PCI_OPTION_REG
mdefine_line|#define PCI_OPTION_REG&t;0x40
DECL|macro|PCI_MGA_INDEX
mdefine_line|#define PCI_MGA_INDEX&t;0x44
DECL|macro|PCI_MGA_DATA
mdefine_line|#define PCI_MGA_DATA&t;0x48
DECL|macro|M_DWGCTL
mdefine_line|#define M_DWGCTL&t;0x1C00
DECL|macro|M_MACCESS
mdefine_line|#define M_MACCESS&t;0x1C04
DECL|macro|M_CTLWTST
mdefine_line|#define M_CTLWTST&t;0x1C08
DECL|macro|M_PLNWT
mdefine_line|#define M_PLNWT&t;&t;0x1C1C
DECL|macro|M_BCOL
mdefine_line|#define M_BCOL&t;&t;0x1C20
DECL|macro|M_FCOL
mdefine_line|#define M_FCOL&t;&t;0x1C24
DECL|macro|M_SGN
mdefine_line|#define M_SGN&t;&t;0x1C58
DECL|macro|M_LEN
mdefine_line|#define M_LEN&t;&t;0x1C5C
DECL|macro|M_AR0
mdefine_line|#define M_AR0&t;&t;0x1C60
DECL|macro|M_AR1
mdefine_line|#define M_AR1&t;&t;0x1C64
DECL|macro|M_AR2
mdefine_line|#define M_AR2&t;&t;0x1C68
DECL|macro|M_AR3
mdefine_line|#define M_AR3&t;&t;0x1C6C
DECL|macro|M_AR4
mdefine_line|#define M_AR4&t;&t;0x1C70
DECL|macro|M_AR5
mdefine_line|#define M_AR5&t;&t;0x1C74
DECL|macro|M_AR6
mdefine_line|#define M_AR6&t;&t;0x1C78
DECL|macro|M_CXBNDRY
mdefine_line|#define M_CXBNDRY&t;0x1C80
DECL|macro|M_FXBNDRY
mdefine_line|#define M_FXBNDRY&t;0x1C84
DECL|macro|M_YDSTLEN
mdefine_line|#define M_YDSTLEN&t;0x1C88
DECL|macro|M_PITCH
mdefine_line|#define M_PITCH&t;&t;0x1C8C
DECL|macro|M_YDST
mdefine_line|#define M_YDST&t;&t;0x1C90
DECL|macro|M_YDSTORG
mdefine_line|#define M_YDSTORG&t;0x1C94
DECL|macro|M_YTOP
mdefine_line|#define M_YTOP&t;&t;0x1C98
DECL|macro|M_YBOT
mdefine_line|#define M_YBOT&t;&t;0x1C9C
multiline_comment|/* mystique only */
DECL|macro|M_CACHEFLUSH
mdefine_line|#define M_CACHEFLUSH&t;0x1FFF
DECL|macro|M_EXEC
mdefine_line|#define M_EXEC&t;&t;0x0100
DECL|macro|M_DWG_TRAP
mdefine_line|#define M_DWG_TRAP&t;0x04
DECL|macro|M_DWG_BITBLT
mdefine_line|#define M_DWG_BITBLT&t;0x08
DECL|macro|M_DWG_ILOAD
mdefine_line|#define M_DWG_ILOAD&t;0x09
DECL|macro|M_DWG_LINEAR
mdefine_line|#define M_DWG_LINEAR&t;0x0080
DECL|macro|M_DWG_SOLID
mdefine_line|#define M_DWG_SOLID&t;0x0800
DECL|macro|M_DWG_ARZERO
mdefine_line|#define M_DWG_ARZERO&t;0x1000
DECL|macro|M_DWG_SGNZERO
mdefine_line|#define M_DWG_SGNZERO&t;0x2000
DECL|macro|M_DWG_SHIFTZERO
mdefine_line|#define M_DWG_SHIFTZERO&t;0x4000
DECL|macro|M_DWG_REPLACE
mdefine_line|#define M_DWG_REPLACE&t;0x000C0000
DECL|macro|M_DWG_REPLACE2
mdefine_line|#define M_DWG_REPLACE2&t;(M_DWG_REPLACE | 0x40)
DECL|macro|M_DWG_XOR
mdefine_line|#define M_DWG_XOR&t;0x00060010
DECL|macro|M_DWG_BFCOL
mdefine_line|#define M_DWG_BFCOL&t;0x04000000
DECL|macro|M_DWG_BMONOWF
mdefine_line|#define M_DWG_BMONOWF&t;0x08000000
DECL|macro|M_DWG_TRANSC
mdefine_line|#define M_DWG_TRANSC&t;0x40000000
DECL|macro|M_FIFOSTATUS
mdefine_line|#define M_FIFOSTATUS&t;0x1E10
DECL|macro|M_STATUS
mdefine_line|#define M_STATUS&t;0x1E14
DECL|macro|M_IEN
mdefine_line|#define M_IEN&t;&t;0x1E1C
DECL|macro|M_VCOUNT
mdefine_line|#define M_VCOUNT&t;0x1E20
DECL|macro|M_RESET
mdefine_line|#define M_RESET&t;&t;0x1E40
DECL|macro|M_AGP2PLL
mdefine_line|#define M_AGP2PLL&t;0x1E4C
DECL|macro|M_OPMODE
mdefine_line|#define M_OPMODE&t;0x1E54
DECL|macro|M_OPMODE_DMA_GEN_WRITE
mdefine_line|#define     M_OPMODE_DMA_GEN_WRITE&t;0x00
DECL|macro|M_OPMODE_DMA_BLIT
mdefine_line|#define     M_OPMODE_DMA_BLIT&t;&t;0x04
DECL|macro|M_OPMODE_DMA_VECTOR_WRITE
mdefine_line|#define     M_OPMODE_DMA_VECTOR_WRITE&t;0x08
DECL|macro|M_OPMODE_DMA_LE
mdefine_line|#define     M_OPMODE_DMA_LE&t;&t;0x0000&t;&t;/* little endian - no transformation */
DECL|macro|M_OPMODE_DMA_BE_8BPP
mdefine_line|#define     M_OPMODE_DMA_BE_8BPP&t;0x0000
DECL|macro|M_OPMODE_DMA_BE_16BPP
mdefine_line|#define     M_OPMODE_DMA_BE_16BPP&t;0x0100
DECL|macro|M_OPMODE_DMA_BE_32BPP
mdefine_line|#define     M_OPMODE_DMA_BE_32BPP&t;0x0200
DECL|macro|M_OPMODE_DIR_LE
mdefine_line|#define     M_OPMODE_DIR_LE&t;&t;0x000000&t;/* little endian - no transformation */
DECL|macro|M_OPMODE_DIR_BE_8BPP
mdefine_line|#define     M_OPMODE_DIR_BE_8BPP&t;0x000000
DECL|macro|M_OPMODE_DIR_BE_16BPP
mdefine_line|#define     M_OPMODE_DIR_BE_16BPP&t;0x010000
DECL|macro|M_OPMODE_DIR_BE_32BPP
mdefine_line|#define     M_OPMODE_DIR_BE_32BPP&t;0x020000
DECL|macro|M_ATTR_INDEX
mdefine_line|#define M_ATTR_INDEX&t;0x1FC0
DECL|macro|M_ATTR_DATA
mdefine_line|#define M_ATTR_DATA&t;0x1FC1
DECL|macro|M_MISC_REG
mdefine_line|#define M_MISC_REG&t;0x1FC2
DECL|macro|M_3C2_RD
mdefine_line|#define M_3C2_RD&t;0x1FC2
DECL|macro|M_SEQ_INDEX
mdefine_line|#define M_SEQ_INDEX&t;0x1FC4
DECL|macro|M_SEQ_DATA
mdefine_line|#define M_SEQ_DATA&t;0x1FC5
DECL|macro|M_MISC_REG_READ
mdefine_line|#define M_MISC_REG_READ&t;0x1FCC
DECL|macro|M_GRAPHICS_INDEX
mdefine_line|#define M_GRAPHICS_INDEX 0x1FCE
DECL|macro|M_GRAPHICS_DATA
mdefine_line|#define M_GRAPHICS_DATA&t;0x1FCF
DECL|macro|M_CRTC_INDEX
mdefine_line|#define M_CRTC_INDEX&t;0x1FD4
DECL|macro|M_ATTR_RESET
mdefine_line|#define M_ATTR_RESET&t;0x1FDA
DECL|macro|M_3DA_WR
mdefine_line|#define M_3DA_WR&t;0x1FDA
DECL|macro|M_EXTVGA_INDEX
mdefine_line|#define M_EXTVGA_INDEX&t;0x1FDE
DECL|macro|M_EXTVGA_DATA
mdefine_line|#define M_EXTVGA_DATA&t;0x1FDF
multiline_comment|/* G200 only */
DECL|macro|M_SRCORG
mdefine_line|#define M_SRCORG&t;0x2CB4
DECL|macro|M_RAMDAC_BASE
mdefine_line|#define M_RAMDAC_BASE&t;0x3C00
multiline_comment|/* fortunately, same on TVP3026 and MGA1064 */
DECL|macro|M_DAC_REG
mdefine_line|#define M_DAC_REG&t;(M_RAMDAC_BASE+0)
DECL|macro|M_DAC_VAL
mdefine_line|#define M_DAC_VAL&t;(M_RAMDAC_BASE+1)
DECL|macro|M_PALETTE_MASK
mdefine_line|#define M_PALETTE_MASK&t;(M_RAMDAC_BASE+2)
DECL|macro|M_X_INDEX
mdefine_line|#define M_X_INDEX&t;0x00
DECL|macro|M_X_DATAREG
mdefine_line|#define M_X_DATAREG&t;0x0A
DECL|macro|DAC_XGENIOCTRL
mdefine_line|#define DAC_XGENIOCTRL&t;&t;0x2A
DECL|macro|DAC_XGENIODATA
mdefine_line|#define DAC_XGENIODATA&t;&t;0x2B
macro_line|#ifdef CONFIG_FB_MATROX_MILLENIUM
DECL|macro|TVP3026_INDEX
mdefine_line|#define TVP3026_INDEX&t;&t;0x00
DECL|macro|TVP3026_PALWRADD
mdefine_line|#define TVP3026_PALWRADD&t;0x00
DECL|macro|TVP3026_PALDATA
mdefine_line|#define TVP3026_PALDATA&t;&t;0x01
DECL|macro|TVP3026_PIXRDMSK
mdefine_line|#define TVP3026_PIXRDMSK&t;0x02
DECL|macro|TVP3026_PALRDADD
mdefine_line|#define TVP3026_PALRDADD&t;0x03
DECL|macro|TVP3026_CURCOLWRADD
mdefine_line|#define TVP3026_CURCOLWRADD&t;0x04
DECL|macro|TVP3026_CLOVERSCAN
mdefine_line|#define     TVP3026_CLOVERSCAN&t;&t;0x00
DECL|macro|TVP3026_CLCOLOR0
mdefine_line|#define     TVP3026_CLCOLOR0&t;&t;0x01
DECL|macro|TVP3026_CLCOLOR1
mdefine_line|#define     TVP3026_CLCOLOR1&t;&t;0x02
DECL|macro|TVP3026_CLCOLOR2
mdefine_line|#define     TVP3026_CLCOLOR2&t;&t;0x03
DECL|macro|TVP3026_CURCOLDATA
mdefine_line|#define TVP3026_CURCOLDATA&t;0x05
DECL|macro|TVP3026_CURCOLRDADD
mdefine_line|#define TVP3026_CURCOLRDADD&t;0x07
DECL|macro|TVP3026_CURCTRL
mdefine_line|#define TVP3026_CURCTRL&t;&t;0x09
DECL|macro|TVP3026_X_DATAREG
mdefine_line|#define TVP3026_X_DATAREG&t;0x0A
DECL|macro|TVP3026_CURRAMDATA
mdefine_line|#define TVP3026_CURRAMDATA&t;0x0B
DECL|macro|TVP3026_CURPOSXL
mdefine_line|#define TVP3026_CURPOSXL&t;0x0C
DECL|macro|TVP3026_CURPOSXH
mdefine_line|#define TVP3026_CURPOSXH&t;0x0D
DECL|macro|TVP3026_CURPOSYL
mdefine_line|#define TVP3026_CURPOSYL&t;0x0E
DECL|macro|TVP3026_CURPOSYH
mdefine_line|#define TVP3026_CURPOSYH&t;0x0F
DECL|macro|TVP3026_XSILICONREV
mdefine_line|#define TVP3026_XSILICONREV&t;0x01
DECL|macro|TVP3026_XCURCTRL
mdefine_line|#define TVP3026_XCURCTRL&t;0x06
DECL|macro|TVP3026_XCURCTRL_DIS
mdefine_line|#define     TVP3026_XCURCTRL_DIS&t;0x00&t;/* transparent, transparent, transparent, transparent */
DECL|macro|TVP3026_XCURCTRL_3COLOR
mdefine_line|#define     TVP3026_XCURCTRL_3COLOR&t;0x01&t;/* transparent, 0, 1, 2 */
DECL|macro|TVP3026_XCURCTRL_XGA
mdefine_line|#define     TVP3026_XCURCTRL_XGA&t;0x02&t;/* 0, 1, transparent, complement */
DECL|macro|TVP3026_XCURCTRL_XWIN
mdefine_line|#define     TVP3026_XCURCTRL_XWIN&t;0x03&t;/* transparent, transparent, 0, 1 */
DECL|macro|TVP3026_XCURCTRL_BLANK2048
mdefine_line|#define     TVP3026_XCURCTRL_BLANK2048&t;0x00
DECL|macro|TVP3026_XCURCTRL_BLANK4096
mdefine_line|#define     TVP3026_XCURCTRL_BLANK4096&t;0x10
DECL|macro|TVP3026_XCURCTRL_INTERLACED
mdefine_line|#define     TVP3026_XCURCTRL_INTERLACED&t;0x20
DECL|macro|TVP3026_XCURCTRL_ODD
mdefine_line|#define     TVP3026_XCURCTRL_ODD&t;0x00 /* ext.signal ODD/&bslash;EVEN */
DECL|macro|TVP3026_XCURCTRL_EVEN
mdefine_line|#define     TVP3026_XCURCTRL_EVEN&t;0x40 /* ext.signal EVEN/&bslash;ODD */
DECL|macro|TVP3026_XCURCTRL_INDIRECT
mdefine_line|#define     TVP3026_XCURCTRL_INDIRECT&t;0x00
DECL|macro|TVP3026_XCURCTRL_DIRECT
mdefine_line|#define     TVP3026_XCURCTRL_DIRECT&t;0x80
DECL|macro|TVP3026_XLATCHCTRL
mdefine_line|#define TVP3026_XLATCHCTRL&t;0x0F
DECL|macro|TVP3026_XLATCHCTRL_1_1
mdefine_line|#define     TVP3026_XLATCHCTRL_1_1&t;0x06
DECL|macro|TVP3026_XLATCHCTRL_2_1
mdefine_line|#define     TVP3026_XLATCHCTRL_2_1&t;0x07
DECL|macro|TVP3026_XLATCHCTRL_4_1
mdefine_line|#define     TVP3026_XLATCHCTRL_4_1&t;0x06
DECL|macro|TVP3026_XLATCHCTRL_8_1
mdefine_line|#define     TVP3026_XLATCHCTRL_8_1&t;0x06
DECL|macro|TVP3026_XLATCHCTRL_16_1
mdefine_line|#define     TVP3026_XLATCHCTRL_16_1&t;0x06
DECL|macro|TVP3026A_XLATCHCTRL_4_3
mdefine_line|#define     TVP3026A_XLATCHCTRL_4_3&t;0x06&t;/* ??? do not understand... but it works... !!! */
DECL|macro|TVP3026A_XLATCHCTRL_8_3
mdefine_line|#define     TVP3026A_XLATCHCTRL_8_3&t;0x07
DECL|macro|TVP3026B_XLATCHCTRL_4_3
mdefine_line|#define     TVP3026B_XLATCHCTRL_4_3&t;0x08
DECL|macro|TVP3026B_XLATCHCTRL_8_3
mdefine_line|#define     TVP3026B_XLATCHCTRL_8_3&t;0x06&t;/* ??? do not understand... but it works... !!! */
DECL|macro|TVP3026_XTRUECOLORCTRL
mdefine_line|#define TVP3026_XTRUECOLORCTRL&t;0x18
DECL|macro|TVP3026_XTRUECOLORCTRL_VRAM_SHIFT_ACCEL
mdefine_line|#define     TVP3026_XTRUECOLORCTRL_VRAM_SHIFT_ACCEL&t;0x00
DECL|macro|TVP3026_XTRUECOLORCTRL_VRAM_SHIFT_TVP
mdefine_line|#define     TVP3026_XTRUECOLORCTRL_VRAM_SHIFT_TVP&t;0x20
DECL|macro|TVP3026_XTRUECOLORCTRL_PSEUDOCOLOR
mdefine_line|#define     TVP3026_XTRUECOLORCTRL_PSEUDOCOLOR&t;&t;0x80
DECL|macro|TVP3026_XTRUECOLORCTRL_TRUECOLOR
mdefine_line|#define     TVP3026_XTRUECOLORCTRL_TRUECOLOR&t;&t;0x40 /* paletized */
DECL|macro|TVP3026_XTRUECOLORCTRL_DIRECTCOLOR
mdefine_line|#define     TVP3026_XTRUECOLORCTRL_DIRECTCOLOR&t;&t;0x00
DECL|macro|TVP3026_XTRUECOLORCTRL_24_ALTERNATE
mdefine_line|#define     TVP3026_XTRUECOLORCTRL_24_ALTERNATE&t;&t;0x08 /* 5:4/5:2 instead of 4:3/8:3 */
DECL|macro|TVP3026_XTRUECOLORCTRL_RGB_888
mdefine_line|#define     TVP3026_XTRUECOLORCTRL_RGB_888&t;&t;0x16 /* 4:3/8:3 (or 5:4/5:2) */
DECL|macro|TVP3026_XTRUECOLORCTRL_BGR_888
mdefine_line|#define&t;    TVP3026_XTRUECOLORCTRL_BGR_888&t;&t;0x17
DECL|macro|TVP3026_XTRUECOLORCTRL_ORGB_8888
mdefine_line|#define     TVP3026_XTRUECOLORCTRL_ORGB_8888&t;&t;0x06
DECL|macro|TVP3026_XTRUECOLORCTRL_BGRO_8888
mdefine_line|#define     TVP3026_XTRUECOLORCTRL_BGRO_8888&t;&t;0x07
DECL|macro|TVP3026_XTRUECOLORCTRL_RGB_565
mdefine_line|#define     TVP3026_XTRUECOLORCTRL_RGB_565&t;&t;0x05
DECL|macro|TVP3026_XTRUECOLORCTRL_ORGB_1555
mdefine_line|#define     TVP3026_XTRUECOLORCTRL_ORGB_1555&t;&t;0x04
DECL|macro|TVP3026_XTRUECOLORCTRL_RGB_664
mdefine_line|#define     TVP3026_XTRUECOLORCTRL_RGB_664&t;&t;0x03
DECL|macro|TVP3026_XTRUECOLORCTRL_RGBO_4444
mdefine_line|#define     TVP3026_XTRUECOLORCTRL_RGBO_4444&t;&t;0x01
DECL|macro|TVP3026_XMUXCTRL
mdefine_line|#define TVP3026_XMUXCTRL&t;0x19
DECL|macro|TVP3026_XMUXCTRL_MEMORY_8BIT
mdefine_line|#define     TVP3026_XMUXCTRL_MEMORY_8BIT&t;&t;&t;0x01 /* - */
DECL|macro|TVP3026_XMUXCTRL_MEMORY_16BIT
mdefine_line|#define     TVP3026_XMUXCTRL_MEMORY_16BIT&t;&t;&t;0x02 /* - */
DECL|macro|TVP3026_XMUXCTRL_MEMORY_32BIT
mdefine_line|#define     TVP3026_XMUXCTRL_MEMORY_32BIT&t;&t;&t;0x03 /* 2MB RAM, 512K * 4 */
DECL|macro|TVP3026_XMUXCTRL_MEMORY_64BIT
mdefine_line|#define     TVP3026_XMUXCTRL_MEMORY_64BIT&t;&t;&t;0x04 /* &gt;2MB RAM, 512K * 8 &amp; more */
DECL|macro|TVP3026_XMUXCTRL_PIXEL_4BIT
mdefine_line|#define     TVP3026_XMUXCTRL_PIXEL_4BIT&t;&t;&t;&t;0x40 /* L0,H0,L1,H1... */
DECL|macro|TVP3026_XMUXCTRL_PIXEL_4BIT_SWAPPED
mdefine_line|#define     TVP3026_XMUXCTRL_PIXEL_4BIT_SWAPPED&t;&t;&t;0x60 /* H0,L0,H1,L1... */
DECL|macro|TVP3026_XMUXCTRL_PIXEL_8BIT
mdefine_line|#define     TVP3026_XMUXCTRL_PIXEL_8BIT&t;&t;&t;&t;0x48
DECL|macro|TVP3026_XMUXCTRL_PIXEL_16BIT
mdefine_line|#define     TVP3026_XMUXCTRL_PIXEL_16BIT&t;&t;&t;0x50
DECL|macro|TVP3026_XMUXCTRL_PIXEL_32BIT
mdefine_line|#define     TVP3026_XMUXCTRL_PIXEL_32BIT&t;&t;&t;0x58
DECL|macro|TVP3026_XMUXCTRL_VGA
mdefine_line|#define     TVP3026_XMUXCTRL_VGA&t;&t;&t;&t;0x98 /* VGA MEMORY, 8BIT PIXEL */
DECL|macro|TVP3026_XCLKCTRL
mdefine_line|#define TVP3026_XCLKCTRL&t;0x1A
DECL|macro|TVP3026_XCLKCTRL_DIV1
mdefine_line|#define     TVP3026_XCLKCTRL_DIV1&t;0x00
DECL|macro|TVP3026_XCLKCTRL_DIV2
mdefine_line|#define     TVP3026_XCLKCTRL_DIV2&t;0x10
DECL|macro|TVP3026_XCLKCTRL_DIV4
mdefine_line|#define     TVP3026_XCLKCTRL_DIV4&t;0x20
DECL|macro|TVP3026_XCLKCTRL_DIV8
mdefine_line|#define     TVP3026_XCLKCTRL_DIV8&t;0x30
DECL|macro|TVP3026_XCLKCTRL_DIV16
mdefine_line|#define     TVP3026_XCLKCTRL_DIV16&t;0x40
DECL|macro|TVP3026_XCLKCTRL_DIV32
mdefine_line|#define     TVP3026_XCLKCTRL_DIV32&t;0x50
DECL|macro|TVP3026_XCLKCTRL_DIV64
mdefine_line|#define     TVP3026_XCLKCTRL_DIV64&t;0x60
DECL|macro|TVP3026_XCLKCTRL_CLKSTOPPED
mdefine_line|#define     TVP3026_XCLKCTRL_CLKSTOPPED&t;0x70
DECL|macro|TVP3026_XCLKCTRL_SRC_CLK0
mdefine_line|#define     TVP3026_XCLKCTRL_SRC_CLK0&t;0x00
DECL|macro|TVP3026_XCLKCTRL_SRC_CLK1
mdefine_line|#define     TVP3026_XCLKCTRL_SRC_CLK1   0x01
DECL|macro|TVP3026_XCLKCTRL_SRC_CLK2
mdefine_line|#define     TVP3026_XCLKCTRL_SRC_CLK2&t;0x02&t;/* CLK2 is TTL source*/
DECL|macro|TVP3026_XCLKCTRL_SRC_NCLK2
mdefine_line|#define     TVP3026_XCLKCTRL_SRC_NCLK2&t;0x03&t;/* not CLK2 is TTL source */
DECL|macro|TVP3026_XCLKCTRL_SRC_ECLK2
mdefine_line|#define     TVP3026_XCLKCTRL_SRC_ECLK2&t;0x04&t;/* CLK2 and not CLK2 is ECL source */
DECL|macro|TVP3026_XCLKCTRL_SRC_PLL
mdefine_line|#define     TVP3026_XCLKCTRL_SRC_PLL&t;0x05
DECL|macro|TVP3026_XCLKCTRL_SRC_DIS
mdefine_line|#define     TVP3026_XCLKCTRL_SRC_DIS&t;0x06&t;/* disable &amp; poweroff internal clock */
DECL|macro|TVP3026_XCLKCTRL_SRC_CLK0VGA
mdefine_line|#define     TVP3026_XCLKCTRL_SRC_CLK0VGA 0x07
DECL|macro|TVP3026_XPALETTEPAGE
mdefine_line|#define TVP3026_XPALETTEPAGE&t;0x1C
DECL|macro|TVP3026_XGENCTRL
mdefine_line|#define TVP3026_XGENCTRL&t;0x1D
DECL|macro|TVP3026_XGENCTRL_HSYNC_POS
mdefine_line|#define     TVP3026_XGENCTRL_HSYNC_POS&t;0x00
DECL|macro|TVP3026_XGENCTRL_HSYNC_NEG
mdefine_line|#define     TVP3026_XGENCTRL_HSYNC_NEG&t;0x01
DECL|macro|TVP3026_XGENCTRL_VSYNC_POS
mdefine_line|#define     TVP3026_XGENCTRL_VSYNC_POS&t;0x00
DECL|macro|TVP3026_XGENCTRL_VSYNC_NEG
mdefine_line|#define     TVP3026_XGENCTRL_VSYNC_NEG&t;0x02
DECL|macro|TVP3026_XGENCTRL_LITTLE_ENDIAN
mdefine_line|#define     TVP3026_XGENCTRL_LITTLE_ENDIAN 0x00
DECL|macro|TVP3026_XGENCTRL_BIG_ENDIAN
mdefine_line|#define     TVP3026_XGENCTRL_BIG_ENDIAN    0x08
DECL|macro|TVP3026_XGENCTRL_BLACK_0IRE
mdefine_line|#define     TVP3026_XGENCTRL_BLACK_0IRE&t;&t;0x00
DECL|macro|TVP3026_XGENCTRL_BLACK_75IRE
mdefine_line|#define     TVP3026_XGENCTRL_BLACK_75IRE&t;0x10
DECL|macro|TVP3026_XGENCTRL_NO_SYNC_ON_GREEN
mdefine_line|#define     TVP3026_XGENCTRL_NO_SYNC_ON_GREEN&t;0x00
DECL|macro|TVP3026_XGENCTRL_SYNC_ON_GREEN
mdefine_line|#define     TVP3026_XGENCTRL_SYNC_ON_GREEN&t;0x20
DECL|macro|TVP3026_XGENCTRL_OVERSCAN_DIS
mdefine_line|#define     TVP3026_XGENCTRL_OVERSCAN_DIS&t;0x00
DECL|macro|TVP3026_XGENCTRL_OVERSCAN_EN
mdefine_line|#define     TVP3026_XGENCTRL_OVERSCAN_EN&t;0x40
DECL|macro|TVP3026_XMISCCTRL
mdefine_line|#define TVP3026_XMISCCTRL&t;0x1E
DECL|macro|TVP3026_XMISCCTRL_DAC_PUP
mdefine_line|#define     TVP3026_XMISCCTRL_DAC_PUP&t;0x00
DECL|macro|TVP3026_XMISCCTRL_DAC_PDOWN
mdefine_line|#define     TVP3026_XMISCCTRL_DAC_PDOWN&t;0x01
DECL|macro|TVP3026_XMISCCTRL_DAC_EXT
mdefine_line|#define     TVP3026_XMISCCTRL_DAC_EXT&t;0x00 /* or 8, bit 3 is ignored */
DECL|macro|TVP3026_XMISCCTRL_DAC_6BIT
mdefine_line|#define     TVP3026_XMISCCTRL_DAC_6BIT&t;0x04
DECL|macro|TVP3026_XMISCCTRL_DAC_8BIT
mdefine_line|#define     TVP3026_XMISCCTRL_DAC_8BIT&t;0x0C
DECL|macro|TVP3026_XMISCCTRL_PSEL_DIS
mdefine_line|#define     TVP3026_XMISCCTRL_PSEL_DIS&t;0x00
DECL|macro|TVP3026_XMISCCTRL_PSEL_EN
mdefine_line|#define     TVP3026_XMISCCTRL_PSEL_EN&t;0x10
DECL|macro|TVP3026_XMISCCTRL_PSEL_LOW
mdefine_line|#define     TVP3026_XMISCCTRL_PSEL_LOW&t;0x00 /* PSEL high selects directcolor */
DECL|macro|TVP3026_XMISCCTRL_PSEL_HIGH
mdefine_line|#define     TVP3026_XMISCCTRL_PSEL_HIGH 0x20 /* PSEL high selects truecolor or pseudocolor */
DECL|macro|TVP3026_XGENIOCTRL
mdefine_line|#define TVP3026_XGENIOCTRL&t;0x2A
DECL|macro|TVP3026_XGENIODATA
mdefine_line|#define TVP3026_XGENIODATA&t;0x2B
DECL|macro|TVP3026_XPLLADDR
mdefine_line|#define TVP3026_XPLLADDR&t;0x2C
DECL|macro|TVP3026_XPLLADDR_X
mdefine_line|#define     TVP3026_XPLLADDR_X(LOOP,MCLK,PIX) (((LOOP)&lt;&lt;4) | ((MCLK)&lt;&lt;2) | (PIX))
DECL|macro|TVP3026_XPLLDATA_N
mdefine_line|#define     TVP3026_XPLLDATA_N&t;&t;0x00
DECL|macro|TVP3026_XPLLDATA_M
mdefine_line|#define     TVP3026_XPLLDATA_M&t;&t;0x01
DECL|macro|TVP3026_XPLLDATA_P
mdefine_line|#define     TVP3026_XPLLDATA_P&t;&t;0x02
DECL|macro|TVP3026_XPLLDATA_STAT
mdefine_line|#define     TVP3026_XPLLDATA_STAT&t;0x03
DECL|macro|TVP3026_XPIXPLLDATA
mdefine_line|#define TVP3026_XPIXPLLDATA&t;0x2D
DECL|macro|TVP3026_XMEMPLLDATA
mdefine_line|#define TVP3026_XMEMPLLDATA&t;0x2E
DECL|macro|TVP3026_XLOOPPLLDATA
mdefine_line|#define TVP3026_XLOOPPLLDATA&t;0x2F
DECL|macro|TVP3026_XCOLKEYOVRMIN
mdefine_line|#define TVP3026_XCOLKEYOVRMIN&t;0x30
DECL|macro|TVP3026_XCOLKEYOVRMAX
mdefine_line|#define TVP3026_XCOLKEYOVRMAX&t;0x31
DECL|macro|TVP3026_XCOLKEYREDMIN
mdefine_line|#define TVP3026_XCOLKEYREDMIN&t;0x32
DECL|macro|TVP3026_XCOLKEYREDMAX
mdefine_line|#define TVP3026_XCOLKEYREDMAX&t;0x33
DECL|macro|TVP3026_XCOLKEYGREENMIN
mdefine_line|#define TVP3026_XCOLKEYGREENMIN&t;0x34
DECL|macro|TVP3026_XCOLKEYGREENMAX
mdefine_line|#define TVP3026_XCOLKEYGREENMAX&t;0x35
DECL|macro|TVP3026_XCOLKEYBLUEMIN
mdefine_line|#define TVP3026_XCOLKEYBLUEMIN&t;0x36
DECL|macro|TVP3026_XCOLKEYBLUEMAX
mdefine_line|#define TVP3026_XCOLKEYBLUEMAX&t;0x37
DECL|macro|TVP3026_XCOLKEYCTRL
mdefine_line|#define TVP3026_XCOLKEYCTRL&t;0x38
DECL|macro|TVP3026_XCOLKEYCTRL_OVR_EN
mdefine_line|#define     TVP3026_XCOLKEYCTRL_OVR_EN&t;0x01
DECL|macro|TVP3026_XCOLKEYCTRL_RED_EN
mdefine_line|#define     TVP3026_XCOLKEYCTRL_RED_EN&t;0x02
DECL|macro|TVP3026_XCOLKEYCTRL_GREEN_EN
mdefine_line|#define     TVP3026_XCOLKEYCTRL_GREEN_EN 0x04
DECL|macro|TVP3026_XCOLKEYCTRL_BLUE_EN
mdefine_line|#define     TVP3026_XCOLKEYCTRL_BLUE_EN&t;0x08
DECL|macro|TVP3026_XCOLKEYCTRL_NEGATE
mdefine_line|#define     TVP3026_XCOLKEYCTRL_NEGATE&t;0x10
DECL|macro|TVP3026_XCOLKEYCTRL_ZOOM1
mdefine_line|#define     TVP3026_XCOLKEYCTRL_ZOOM1&t;0x00
DECL|macro|TVP3026_XCOLKEYCTRL_ZOOM2
mdefine_line|#define     TVP3026_XCOLKEYCTRL_ZOOM2&t;0x20
DECL|macro|TVP3026_XCOLKEYCTRL_ZOOM4
mdefine_line|#define     TVP3026_XCOLKEYCTRL_ZOOM4&t;0x40
DECL|macro|TVP3026_XCOLKEYCTRL_ZOOM8
mdefine_line|#define     TVP3026_XCOLKEYCTRL_ZOOM8&t;0x60
DECL|macro|TVP3026_XCOLKEYCTRL_ZOOM16
mdefine_line|#define     TVP3026_XCOLKEYCTRL_ZOOM16&t;0x80
DECL|macro|TVP3026_XCOLKEYCTRL_ZOOM32
mdefine_line|#define     TVP3026_XCOLKEYCTRL_ZOOM32&t;0xA0
DECL|macro|TVP3026_XMEMPLLCTRL
mdefine_line|#define TVP3026_XMEMPLLCTRL&t;0x39
DECL|macro|TVP3026_XMEMPLLCTRL_DIV
mdefine_line|#define     TVP3026_XMEMPLLCTRL_DIV(X)&t;(((X)-1)&gt;&gt;1)&t;/* 2,4,6,8,10,12,14,16, division applied to LOOP PLL after divide by 2^P */
DECL|macro|TVP3026_XMEMPLLCTRL_STROBEMKC4
mdefine_line|#define     TVP3026_XMEMPLLCTRL_STROBEMKC4&t;0x08
DECL|macro|TVP3026_XMEMPLLCTRL_MCLK_DOTCLOCK
mdefine_line|#define     TVP3026_XMEMPLLCTRL_MCLK_DOTCLOCK&t;0x00&t;/* MKC4 */
DECL|macro|TVP3026_XMEMPLLCTRL_MCLK_MCLKPLL
mdefine_line|#define     TVP3026_XMEMPLLCTRL_MCLK_MCLKPLL&t;0x10&t;/* MKC4 */
DECL|macro|TVP3026_XMEMPLLCTRL_RCLK_PIXPLL
mdefine_line|#define     TVP3026_XMEMPLLCTRL_RCLK_PIXPLL&t;0x00
DECL|macro|TVP3026_XMEMPLLCTRL_RCLK_LOOPPLL
mdefine_line|#define     TVP3026_XMEMPLLCTRL_RCLK_LOOPPLL&t;0x20
DECL|macro|TVP3026_XMEMPLLCTRL_RCLK_DOTDIVN
mdefine_line|#define     TVP3026_XMEMPLLCTRL_RCLK_DOTDIVN&t;0x40&t;/* dot clock divided by loop pclk N prescaler */
DECL|macro|TVP3026_XSENSETEST
mdefine_line|#define TVP3026_XSENSETEST&t;0x3A
DECL|macro|TVP3026_XTESTMODEDATA
mdefine_line|#define TVP3026_XTESTMODEDATA&t;0x3B
DECL|macro|TVP3026_XCRCREML
mdefine_line|#define TVP3026_XCRCREML&t;0x3C
DECL|macro|TVP3026_XCRCREMH
mdefine_line|#define TVP3026_XCRCREMH&t;0x3D
DECL|macro|TVP3026_XCRCBITSEL
mdefine_line|#define TVP3026_XCRCBITSEL&t;0x3E
DECL|macro|TVP3026_XID
mdefine_line|#define TVP3026_XID&t;&t;0x3F
macro_line|#endif
macro_line|#ifdef NEED_DAC1064
DECL|macro|DAC1064_OPT_SCLK_PCI
mdefine_line|#define DAC1064_OPT_SCLK_PCI&t;0x00
DECL|macro|DAC1064_OPT_SCLK_PLL
mdefine_line|#define DAC1064_OPT_SCLK_PLL&t;0x01
DECL|macro|DAC1064_OPT_SCLK_EXT
mdefine_line|#define DAC1064_OPT_SCLK_EXT&t;0x02
DECL|macro|DAC1064_OPT_SCLK_MASK
mdefine_line|#define DAC1064_OPT_SCLK_MASK&t;0x03
DECL|macro|DAC1064_OPT_GDIV1
mdefine_line|#define DAC1064_OPT_GDIV1&t;0x04&t;/* maybe it is GDIV2 on G100 ?! */
DECL|macro|DAC1064_OPT_GDIV3
mdefine_line|#define DAC1064_OPT_GDIV3&t;0x00
DECL|macro|DAC1064_OPT_MDIV1
mdefine_line|#define DAC1064_OPT_MDIV1&t;0x08
DECL|macro|DAC1064_OPT_MDIV2
mdefine_line|#define DAC1064_OPT_MDIV2&t;0x00
DECL|macro|DAC1064_OPT_RESERVED
mdefine_line|#define DAC1064_OPT_RESERVED&t;0x10
DECL|macro|M1064_INDEX
mdefine_line|#define M1064_INDEX&t;0x00
DECL|macro|M1064_PALWRADD
mdefine_line|#define M1064_PALWRADD&t;0x00
DECL|macro|M1064_PALDATA
mdefine_line|#define M1064_PALDATA&t;0x01
DECL|macro|M1064_PIXRDMSK
mdefine_line|#define M1064_PIXRDMSK&t;0x02
DECL|macro|M1064_PALRDADD
mdefine_line|#define M1064_PALRDADD&t;0x03
DECL|macro|M1064_X_DATAREG
mdefine_line|#define M1064_X_DATAREG&t;0x0A
DECL|macro|M1064_CURPOSXL
mdefine_line|#define M1064_CURPOSXL&t;0x0C&t;/* can be accessed as DWORD */
DECL|macro|M1064_CURPOSXH
mdefine_line|#define M1064_CURPOSXH&t;0x0D
DECL|macro|M1064_CURPOSYL
mdefine_line|#define M1064_CURPOSYL&t;0x0E
DECL|macro|M1064_CURPOSYH
mdefine_line|#define M1064_CURPOSYH&t;0x0F
DECL|macro|M1064_XCURADDL
mdefine_line|#define M1064_XCURADDL&t;&t;0x04
DECL|macro|M1064_XCURADDH
mdefine_line|#define M1064_XCURADDH&t;&t;0x05
DECL|macro|M1064_XCURCTRL
mdefine_line|#define M1064_XCURCTRL&t;&t;0x06
DECL|macro|M1064_XCURCTRL_DIS
mdefine_line|#define     M1064_XCURCTRL_DIS&t;&t;0x00&t;/* transparent, transparent, transparent, transparent */
DECL|macro|M1064_XCURCTRL_3COLOR
mdefine_line|#define     M1064_XCURCTRL_3COLOR&t;0x01&t;/* transparent, 0, 1, 2 */
DECL|macro|M1064_XCURCTRL_XGA
mdefine_line|#define     M1064_XCURCTRL_XGA&t;&t;0x02&t;/* 0, 1, transparent, complement */
DECL|macro|M1064_XCURCTRL_XWIN
mdefine_line|#define     M1064_XCURCTRL_XWIN&t;&t;0x03&t;/* transparent, transparent, 0, 1 */
DECL|macro|M1064_XCURCOL0RED
mdefine_line|#define M1064_XCURCOL0RED&t;0x08
DECL|macro|M1064_XCURCOL0GREEN
mdefine_line|#define M1064_XCURCOL0GREEN&t;0x09
DECL|macro|M1064_XCURCOL0BLUE
mdefine_line|#define M1064_XCURCOL0BLUE&t;0x0A
DECL|macro|M1064_XCURCOL1RED
mdefine_line|#define M1064_XCURCOL1RED&t;0x0C
DECL|macro|M1064_XCURCOL1GREEN
mdefine_line|#define M1064_XCURCOL1GREEN&t;0x0D
DECL|macro|M1064_XCURCOL1BLUE
mdefine_line|#define M1064_XCURCOL1BLUE&t;0x0E
DECL|macro|M1064_XCURCOL2RED
mdefine_line|#define M1064_XCURCOL2RED&t;0x10
DECL|macro|M1064_XCURCOL2GREEN
mdefine_line|#define M1064_XCURCOL2GREEN&t;0x11
DECL|macro|M1064_XCURCOL2BLUE
mdefine_line|#define M1064_XCURCOL2BLUE&t;0x12
DECL|macro|DAC1064_XVREFCTRL
mdefine_line|#define DAC1064_XVREFCTRL&t;0x18
DECL|macro|DAC1064_XVREFCTRL_INTERNAL
mdefine_line|#define      DAC1064_XVREFCTRL_INTERNAL&t;&t;0x3F
DECL|macro|DAC1064_XVREFCTRL_EXTERNAL
mdefine_line|#define      DAC1064_XVREFCTRL_EXTERNAL&t;&t;0x00
DECL|macro|DAC1064_XVREFCTRL_G100_DEFAULT
mdefine_line|#define      DAC1064_XVREFCTRL_G100_DEFAULT&t;0x03
DECL|macro|M1064_XMULCTRL
mdefine_line|#define M1064_XMULCTRL&t;&t;0x19
DECL|macro|M1064_XMULCTRL_DEPTH_8BPP
mdefine_line|#define      M1064_XMULCTRL_DEPTH_8BPP&t;&t;0x00&t;/* 8 bpp paletized */
DECL|macro|M1064_XMULCTRL_DEPTH_15BPP_1BPP
mdefine_line|#define      M1064_XMULCTRL_DEPTH_15BPP_1BPP&t;0x01&t;/* 15 bpp paletized + 1 bpp overlay */
DECL|macro|M1064_XMULCTRL_DEPTH_16BPP
mdefine_line|#define      M1064_XMULCTRL_DEPTH_16BPP&t;&t;0x02&t;/* 16 bpp paletized */
DECL|macro|M1064_XMULCTRL_DEPTH_24BPP
mdefine_line|#define      M1064_XMULCTRL_DEPTH_24BPP&t;&t;0x03&t;/* 24 bpp paletized */
DECL|macro|M1064_XMULCTRL_DEPTH_24BPP_8BPP
mdefine_line|#define      M1064_XMULCTRL_DEPTH_24BPP_8BPP&t;0x04&t;/* 24 bpp direct + 8 bpp overlay paletized */
DECL|macro|M1064_XMULCTRL_2G8V16
mdefine_line|#define      M1064_XMULCTRL_2G8V16&t;&t;0x05&t;/* 15 bpp video direct, half xres, 8bpp paletized */
DECL|macro|M1064_XMULCTRL_G16V16
mdefine_line|#define      M1064_XMULCTRL_G16V16&t;&t;0x06&t;/* 15 bpp video, 15bpp graphics, one of them paletized */
DECL|macro|M1064_XMULCTRL_DEPTH_32BPP
mdefine_line|#define      M1064_XMULCTRL_DEPTH_32BPP&t;&t;0x07&t;/* 24 bpp paletized + 8 bpp unused */
DECL|macro|M1064_XMULCTRL_GRAPHICS_PALETIZED
mdefine_line|#define      M1064_XMULCTRL_GRAPHICS_PALETIZED&t;0x00
DECL|macro|M1064_XMULCTRL_VIDEO_PALETIZED
mdefine_line|#define      M1064_XMULCTRL_VIDEO_PALETIZED&t;0x08
DECL|macro|M1064_XPIXCLKCTRL
mdefine_line|#define M1064_XPIXCLKCTRL&t;0x1A
DECL|macro|M1064_XPIXCLKCTRL_SRC_PCI
mdefine_line|#define      M1064_XPIXCLKCTRL_SRC_PCI&t;&t;0x00
DECL|macro|M1064_XPIXCLKCTRL_SRC_PLL
mdefine_line|#define      M1064_XPIXCLKCTRL_SRC_PLL&t;&t;0x01
DECL|macro|M1064_XPIXCLKCTRL_SRC_EXT
mdefine_line|#define      M1064_XPIXCLKCTRL_SRC_EXT&t;&t;0x02
DECL|macro|M1064_XPIXCLKCTRL_SRC_MASK
mdefine_line|#define      M1064_XPIXCLKCTRL_SRC_MASK&t;&t;0x03
DECL|macro|M1064_XPIXCLKCTRL_EN
mdefine_line|#define      M1064_XPIXCLKCTRL_EN&t;&t;0x00
DECL|macro|M1064_XPIXCLKCTRL_DIS
mdefine_line|#define      M1064_XPIXCLKCTRL_DIS&t;&t;0x04
DECL|macro|M1064_XPIXCLKCTRL_PLL_DOWN
mdefine_line|#define      M1064_XPIXCLKCTRL_PLL_DOWN&t;&t;0x00
DECL|macro|M1064_XPIXCLKCTRL_PLL_UP
mdefine_line|#define      M1064_XPIXCLKCTRL_PLL_UP&t;&t;0x08
DECL|macro|M1064_XGENCTRL
mdefine_line|#define M1064_XGENCTRL&t;&t;0x1D
DECL|macro|M1064_XGENCTRL_VS_0
mdefine_line|#define      M1064_XGENCTRL_VS_0&t;&t;0x00
DECL|macro|M1064_XGENCTRL_VS_1
mdefine_line|#define      M1064_XGENCTRL_VS_1&t;&t;0x01
DECL|macro|M1064_XGENCTRL_ALPHA_DIS
mdefine_line|#define      M1064_XGENCTRL_ALPHA_DIS&t;&t;0x00
DECL|macro|M1064_XGENCTRL_ALPHA_EN
mdefine_line|#define      M1064_XGENCTRL_ALPHA_EN&t;&t;0x02
DECL|macro|M1064_XGENCTRL_BLACK_0IRE
mdefine_line|#define      M1064_XGENCTRL_BLACK_0IRE&t;&t;0x00
DECL|macro|M1064_XGENCTRL_BLACK_75IRE
mdefine_line|#define      M1064_XGENCTRL_BLACK_75IRE&t;&t;0x10
DECL|macro|M1064_XGENCTRL_SYNC_ON_GREEN
mdefine_line|#define      M1064_XGENCTRL_SYNC_ON_GREEN&t;0x00
DECL|macro|M1064_XGENCTRL_NO_SYNC_ON_GREEN
mdefine_line|#define      M1064_XGENCTRL_NO_SYNC_ON_GREEN&t;0x20
DECL|macro|M1064_XGENCTRL_SYNC_ON_GREEN_MASK
mdefine_line|#define      M1064_XGENCTRL_SYNC_ON_GREEN_MASK&t;0x20
DECL|macro|M1064_XMISCCTRL
mdefine_line|#define M1064_XMISCCTRL&t;&t;0x1E
DECL|macro|M1064_XMISCCTRL_DAC_DIS
mdefine_line|#define      M1064_XMISCCTRL_DAC_DIS&t;&t;0x00
DECL|macro|M1064_XMISCCTRL_DAC_EN
mdefine_line|#define      M1064_XMISCCTRL_DAC_EN&t;&t;0x01
DECL|macro|M1064_XMISCCTRL_MFC_VGA
mdefine_line|#define      M1064_XMISCCTRL_MFC_VGA&t;&t;0x00
DECL|macro|M1064_XMISCCTRL_MFC_MAFC
mdefine_line|#define      M1064_XMISCCTRL_MFC_MAFC&t;&t;0x02
DECL|macro|M1064_XMISCCTRL_MFC_DIS
mdefine_line|#define      M1064_XMISCCTRL_MFC_DIS&t;&t;0x06
DECL|macro|M1064_XMISCCTRL_DAC_6BIT
mdefine_line|#define      M1064_XMISCCTRL_DAC_6BIT&t;&t;0x00
DECL|macro|M1064_XMISCCTRL_DAC_8BIT
mdefine_line|#define      M1064_XMISCCTRL_DAC_8BIT&t;&t;0x08
DECL|macro|M1064_XMISCCTRL_LUT_DIS
mdefine_line|#define      M1064_XMISCCTRL_LUT_DIS&t;&t;0x00
DECL|macro|M1064_XMISCCTRL_LUT_EN
mdefine_line|#define      M1064_XMISCCTRL_LUT_EN&t;&t;0x10
DECL|macro|M1064_XGENIOCTRL
mdefine_line|#define M1064_XGENIOCTRL&t;0x2A
DECL|macro|M1064_XGENIODATA
mdefine_line|#define M1064_XGENIODATA&t;0x2B
DECL|macro|DAC1064_XSYSPLLM
mdefine_line|#define DAC1064_XSYSPLLM&t;0x2C
DECL|macro|DAC1064_XSYSPLLN
mdefine_line|#define DAC1064_XSYSPLLN&t;0x2D
DECL|macro|DAC1064_XSYSPLLP
mdefine_line|#define DAC1064_XSYSPLLP&t;0x2E
DECL|macro|DAC1064_XSYSPLLSTAT
mdefine_line|#define DAC1064_XSYSPLLSTAT&t;0x2F
DECL|macro|M1064_XZOOMCTRL
mdefine_line|#define M1064_XZOOMCTRL&t;&t;0x38
DECL|macro|M1064_XZOOMCTRL_1
mdefine_line|#define      M1064_XZOOMCTRL_1&t;&t;&t;0x00
DECL|macro|M1064_XZOOMCTRL_2
mdefine_line|#define      M1064_XZOOMCTRL_2&t;&t;&t;0x01
DECL|macro|M1064_XZOOMCTRL_4
mdefine_line|#define      M1064_XZOOMCTRL_4&t;&t;&t;0x03
DECL|macro|M1064_XSENSETEST
mdefine_line|#define M1064_XSENSETEST&t;0x3A
DECL|macro|M1064_XSENSETEST_BCOMP
mdefine_line|#define      M1064_XSENSETEST_BCOMP&t;&t;0x01
DECL|macro|M1064_XSENSETEST_GCOMP
mdefine_line|#define      M1064_XSENSETEST_GCOMP&t;&t;0x02
DECL|macro|M1064_XSENSETEST_RCOMP
mdefine_line|#define      M1064_XSENSETEST_RCOMP&t;&t;0x04
DECL|macro|M1064_XSENSETEST_PDOWN
mdefine_line|#define      M1064_XSENSETEST_PDOWN&t;&t;0x00
DECL|macro|M1064_XSENSETEST_PUP
mdefine_line|#define      M1064_XSENSETEST_PUP&t;&t;0x80
DECL|macro|M1064_XCRCREML
mdefine_line|#define M1064_XCRCREML&t;&t;0x3C
DECL|macro|M1064_XCRCREMH
mdefine_line|#define M1064_XCRCREMH&t;&t;0x3D
DECL|macro|M1064_XCRCBITSEL
mdefine_line|#define M1064_XCRCBITSEL&t;0x3E
DECL|macro|M1064_XCOLKEYMASKL
mdefine_line|#define M1064_XCOLKEYMASKL&t;0x40
DECL|macro|M1064_XCOLKEYMASKH
mdefine_line|#define M1064_XCOLKEYMASKH&t;0x41
DECL|macro|M1064_XCOLKEYL
mdefine_line|#define M1064_XCOLKEYL&t;&t;0x42
DECL|macro|M1064_XCOLKEYH
mdefine_line|#define M1064_XCOLKEYH&t;&t;0x43
DECL|macro|M1064_XPIXPLLAM
mdefine_line|#define M1064_XPIXPLLAM&t;&t;0x44
DECL|macro|M1064_XPIXPLLAN
mdefine_line|#define M1064_XPIXPLLAN&t;&t;0x45
DECL|macro|M1064_XPIXPLLAP
mdefine_line|#define M1064_XPIXPLLAP&t;&t;0x46
DECL|macro|M1064_XPIXPLLBM
mdefine_line|#define M1064_XPIXPLLBM&t;&t;0x48
DECL|macro|M1064_XPIXPLLBN
mdefine_line|#define M1064_XPIXPLLBN&t;&t;0x49
DECL|macro|M1064_XPIXPLLBP
mdefine_line|#define M1064_XPIXPLLBP&t;&t;0x4A
DECL|macro|M1064_XPIXPLLCM
mdefine_line|#define M1064_XPIXPLLCM&t;&t;0x4C
DECL|macro|M1064_XPIXPLLCN
mdefine_line|#define M1064_XPIXPLLCN&t;&t;0x4D
DECL|macro|M1064_XPIXPLLCP
mdefine_line|#define M1064_XPIXPLLCP&t;&t;0x4E
DECL|macro|M1064_XPIXPLLSTAT
mdefine_line|#define M1064_XPIXPLLSTAT&t;0x4F
macro_line|#endif
macro_line|#ifdef __LITTLE_ENDIAN
DECL|macro|MX_OPTION_BSWAP
mdefine_line|#define MX_OPTION_BSWAP&t;&t;0x00000000
DECL|macro|M_OPMODE_4BPP
mdefine_line|#define M_OPMODE_4BPP&t;(M_OPMODE_DMA_LE | M_OPMODE_DIR_LE | M_OPMODE_DMA_BLIT)
DECL|macro|M_OPMODE_8BPP
mdefine_line|#define M_OPMODE_8BPP&t;(M_OPMODE_DMA_LE | M_OPMODE_DIR_LE | M_OPMODE_DMA_BLIT)
DECL|macro|M_OPMODE_16BPP
mdefine_line|#define M_OPMODE_16BPP&t;(M_OPMODE_DMA_LE | M_OPMODE_DIR_LE | M_OPMODE_DMA_BLIT)
DECL|macro|M_OPMODE_24BPP
mdefine_line|#define M_OPMODE_24BPP&t;(M_OPMODE_DMA_LE | M_OPMODE_DIR_LE | M_OPMODE_DMA_BLIT)
DECL|macro|M_OPMODE_32BPP
mdefine_line|#define M_OPMODE_32BPP&t;(M_OPMODE_DMA_LE | M_OPMODE_DIR_LE | M_OPMODE_DMA_BLIT)
macro_line|#else
macro_line|#ifdef __BIG_ENDIAN
DECL|macro|MX_OPTION_BSWAP
mdefine_line|#define MX_OPTION_BSWAP&t;&t;0x80000000
DECL|macro|M_OPMODE_4BPP
mdefine_line|#define M_OPMODE_4BPP&t;(M_OPMODE_DMA_LE | M_OPMODE_DIR_LE | M_OPMODE_DMA_BLIT)&t;/* TODO */
DECL|macro|M_OPMODE_8BPP
mdefine_line|#define M_OPMODE_8BPP&t;(M_OPMODE_DMA_BE_8BPP  | M_OPMODE_DIR_BE_8BPP  | M_OPMODE_DMA_BLIT)
DECL|macro|M_OPMODE_16BPP
mdefine_line|#define M_OPMODE_16BPP&t;(M_OPMODE_DMA_BE_16BPP | M_OPMODE_DIR_BE_16BPP | M_OPMODE_DMA_BLIT)
DECL|macro|M_OPMODE_24BPP
mdefine_line|#define M_OPMODE_24BPP&t;(M_OPMODE_DMA_BE_8BPP | M_OPMODE_DIR_BE_8BPP | M_OPMODE_DMA_BLIT)&t;/* TODO, ?32 */
DECL|macro|M_OPMODE_32BPP
mdefine_line|#define M_OPMODE_32BPP&t;(M_OPMODE_DMA_BE_32BPP | M_OPMODE_DIR_BE_32BPP | M_OPMODE_DMA_BLIT)
macro_line|#else
macro_line|#error &quot;Byte ordering have to be defined. Cannot continue.&quot;
macro_line|#endif
macro_line|#endif
DECL|macro|mga_inb
mdefine_line|#define mga_inb(addr)&t;mga_readb(ACCESS_FBINFO(mmio.vbase), (addr))
DECL|macro|mga_inl
mdefine_line|#define mga_inl(addr)&t;mga_readl(ACCESS_FBINFO(mmio.vbase), (addr))
DECL|macro|mga_outb
mdefine_line|#define mga_outb(addr,val) mga_writeb(ACCESS_FBINFO(mmio.vbase), (addr), (val))
DECL|macro|mga_outw
mdefine_line|#define mga_outw(addr,val) mga_writew(ACCESS_FBINFO(mmio.vbase), (addr), (val))
DECL|macro|mga_outl
mdefine_line|#define mga_outl(addr,val) mga_writel(ACCESS_FBINFO(mmio.vbase), (addr), (val))
DECL|macro|mga_readr
mdefine_line|#define mga_readr(port,idx) (mga_outb((port),(idx)), mga_inb((port)+1))
macro_line|#ifdef __LITTLE_ENDIAN
DECL|macro|mga_setr
mdefine_line|#define mga_setr(addr,port,val) mga_outw(addr, ((val)&lt;&lt;8) | (port))
macro_line|#else
DECL|macro|mga_setr
mdefine_line|#define mga_setr(addr,port,val) do { mga_outb(addr, port); mga_outb((addr)+1, val); } while (0)
macro_line|#endif
macro_line|#ifdef __LITTLE_ENDIAN
DECL|macro|mga_fifo
mdefine_line|#define mga_fifo(n)&t;do {} while (mga_inb(M_FIFOSTATUS) &lt; (n))
macro_line|#else
DECL|macro|mga_fifo
mdefine_line|#define mga_fifo(n)&t;do {} while ((mga_inl(M_FIFOSTATUS) &amp; 0xFF) &lt; (n))
macro_line|#endif
DECL|macro|WaitTillIdle
mdefine_line|#define WaitTillIdle()&t;do {} while (mga_inl(M_STATUS) &amp; 0x10000)
multiline_comment|/* code speedup */
macro_line|#ifdef CONFIG_FB_MATROX_MILLENIUM
DECL|macro|isInterleave
mdefine_line|#define isInterleave(x)&t; (x-&gt;interleave)
DECL|macro|isMillenium
mdefine_line|#define isMillenium(x)&t; (x-&gt;millenium)
DECL|macro|isMilleniumII
mdefine_line|#define isMilleniumII(x) (x-&gt;milleniumII)
macro_line|#else
DECL|macro|isInterleave
mdefine_line|#define isInterleave(x)  (0)
DECL|macro|isMillenium
mdefine_line|#define isMillenium(x)&t; (0)
DECL|macro|isMilleniumII
mdefine_line|#define isMilleniumII(x) (0)
macro_line|#endif
macro_line|#ifdef MATROXFB_DEBUG_REENTER
DECL|variable|guard_counter
r_static
id|atomic_t
id|guard_counter
op_assign
id|ATOMIC_INIT
c_func
(paren
l_int|1
)paren
suffix:semicolon
DECL|variable|guard_printing
r_static
id|atomic_t
id|guard_printing
op_assign
id|ATOMIC_INIT
c_func
(paren
l_int|1
)paren
suffix:semicolon
DECL|function|guard_start
r_static
r_void
id|guard_start
c_func
(paren
r_void
)paren
(brace
r_if
c_cond
(paren
id|atomic_dec_and_test
c_func
(paren
op_amp
id|guard_counter
)paren
)paren
(brace
multiline_comment|/* first level */
r_if
c_cond
(paren
op_logical_neg
(paren
id|bh_mask
op_amp
(paren
l_int|1
op_lshift
id|CONSOLE_BH
)paren
)paren
)paren
multiline_comment|/* and CONSOLE_BH disabled */
r_return
suffix:semicolon
multiline_comment|/* is OK */
multiline_comment|/* otherwise it is first level with CONSOLE_BH enabled -&n;&t;&t;   - if we are __sti or SMP, reentering from console_bh possible */
id|atomic_dec
c_func
(paren
op_amp
id|guard_printing
)paren
suffix:semicolon
multiline_comment|/* disable reentrancy warning */
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;matroxfb entered without CONSOLE_BH disabled&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#ifdef printstate
id|printstate
c_func
(paren
)paren
suffix:semicolon
macro_line|#endif
id|atomic_inc
c_func
(paren
op_amp
id|guard_printing
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
multiline_comment|/* real reentering... You should be already warned by code above */
r_if
c_cond
(paren
id|atomic_dec_and_test
c_func
(paren
op_amp
id|guard_printing
)paren
)paren
(brace
macro_line|#ifdef printstate
id|printstate
c_func
(paren
)paren
suffix:semicolon
macro_line|#endif
)brace
id|atomic_inc
c_func
(paren
op_amp
id|guard_printing
)paren
suffix:semicolon
)brace
DECL|function|guard_end
r_static
r_inline
r_void
id|guard_end
c_func
(paren
r_void
)paren
(brace
id|atomic_inc
c_func
(paren
op_amp
id|guard_counter
)paren
suffix:semicolon
)brace
DECL|macro|CRITBEGIN
mdefine_line|#define CRITBEGIN guard_start();
DECL|macro|CRITEND
mdefine_line|#define CRITEND   guard_end();
macro_line|#else
DECL|macro|CRITBEGIN
mdefine_line|#define CRITBEGIN
DECL|macro|CRITEND
mdefine_line|#define CRITEND
macro_line|#endif
DECL|macro|mga_ydstlen
mdefine_line|#define mga_ydstlen(y,l) mga_outl(M_YDSTLEN | M_EXEC, ((y) &lt;&lt; 16) | (l))
DECL|function|matrox_cfbX_init
r_static
r_void
id|matrox_cfbX_init
c_func
(paren
id|WPMINFO
r_struct
id|display
op_star
id|p
)paren
(brace
id|u_int32_t
id|maccess
suffix:semicolon
id|u_int32_t
id|mpitch
suffix:semicolon
id|u_int32_t
id|mopmode
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;matrox_cfbX_init&quot;
)paren
id|mpitch
op_assign
id|p-&gt;var.xres_virtual
suffix:semicolon
r_if
c_cond
(paren
id|p-&gt;type
op_eq
id|FB_TYPE_TEXT
)paren
(brace
id|maccess
op_assign
l_int|0x00000000
suffix:semicolon
id|mpitch
op_assign
(paren
id|mpitch
op_rshift
l_int|4
)paren
op_or
l_int|0x8000
suffix:semicolon
multiline_comment|/* set something */
id|mopmode
op_assign
id|M_OPMODE_8BPP
suffix:semicolon
)brace
r_else
(brace
r_switch
c_cond
(paren
id|p-&gt;var.bits_per_pixel
)paren
(brace
r_case
l_int|4
suffix:colon
id|maccess
op_assign
l_int|0x00000000
suffix:semicolon
multiline_comment|/* accelerate as 8bpp video */
id|mpitch
op_assign
(paren
id|mpitch
op_rshift
l_int|1
)paren
op_or
l_int|0x8000
suffix:semicolon
multiline_comment|/* disable linearization */
id|mopmode
op_assign
id|M_OPMODE_4BPP
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|8
suffix:colon
id|maccess
op_assign
l_int|0x00000000
suffix:semicolon
id|mopmode
op_assign
id|M_OPMODE_8BPP
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|16
suffix:colon
r_if
c_cond
(paren
id|p-&gt;var.green.length
op_eq
l_int|5
)paren
id|maccess
op_assign
l_int|0xC0000001
suffix:semicolon
r_else
id|maccess
op_assign
l_int|0x40000001
suffix:semicolon
id|mopmode
op_assign
id|M_OPMODE_16BPP
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|24
suffix:colon
id|maccess
op_assign
l_int|0x00000003
suffix:semicolon
id|mopmode
op_assign
id|M_OPMODE_24BPP
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|32
suffix:colon
id|maccess
op_assign
l_int|0x00000002
suffix:semicolon
id|mopmode
op_assign
id|M_OPMODE_32BPP
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|maccess
op_assign
l_int|0x00000000
suffix:semicolon
id|mopmode
op_assign
l_int|0x00000000
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* turn off acceleration!!! */
)brace
)brace
id|mga_fifo
c_func
(paren
l_int|8
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_PITCH
comma
id|mpitch
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_YDSTORG
comma
id|curr_ydstorg
c_func
(paren
id|MINFO
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|capable.plnwt
)paren
)paren
id|mga_outl
c_func
(paren
id|M_PLNWT
comma
op_minus
l_int|1
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_OPMODE
comma
id|mopmode
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_CXBNDRY
comma
l_int|0xFFFF0000
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_YTOP
comma
l_int|0
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_YBOT
comma
l_int|0x01FFFFFF
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_MACCESS
comma
id|maccess
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|accel.m_dwg_rect
)paren
op_assign
id|M_DWG_TRAP
op_or
id|M_DWG_SOLID
op_or
id|M_DWG_ARZERO
op_or
id|M_DWG_SGNZERO
op_or
id|M_DWG_SHIFTZERO
suffix:semicolon
r_if
c_cond
(paren
id|isMilleniumII
c_func
(paren
id|MINFO
)paren
)paren
id|ACCESS_FBINFO
c_func
(paren
id|accel.m_dwg_rect
)paren
op_or_assign
id|M_DWG_TRANSC
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|accel.m_opmode
)paren
op_assign
id|mopmode
suffix:semicolon
)brace
DECL|function|matrox_cfbX_bmove
r_static
r_void
id|matrox_cfbX_bmove
c_func
(paren
r_struct
id|display
op_star
id|p
comma
r_int
id|sy
comma
r_int
id|sx
comma
r_int
id|dy
comma
r_int
id|dx
comma
r_int
id|height
comma
r_int
id|width
)paren
(brace
r_int
id|pixx
op_assign
id|p-&gt;var.xres_virtual
comma
id|start
comma
id|end
suffix:semicolon
id|MINFO_FROM_DISP
c_func
(paren
id|p
)paren
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;matrox_cfbX_bmove&quot;
)paren
id|CRITBEGIN
id|sx
op_mul_assign
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
id|dx
op_mul_assign
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
id|width
op_mul_assign
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
id|height
op_mul_assign
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|sy
op_mul_assign
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|dy
op_mul_assign
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|dy
OL
id|sy
)paren
op_logical_or
(paren
(paren
id|dy
op_eq
id|sy
)paren
op_logical_and
(paren
id|dx
op_le
id|sx
)paren
)paren
)paren
(brace
id|mga_fifo
c_func
(paren
l_int|2
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_DWGCTL
comma
id|M_DWG_BITBLT
op_or
id|M_DWG_SHIFTZERO
op_or
id|M_DWG_SGNZERO
op_or
id|M_DWG_BFCOL
op_or
id|M_DWG_REPLACE
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_AR5
comma
id|pixx
)paren
suffix:semicolon
id|width
op_decrement
suffix:semicolon
id|start
op_assign
id|sy
op_star
id|pixx
op_plus
id|sx
op_plus
id|curr_ydstorg
c_func
(paren
id|MINFO
)paren
suffix:semicolon
id|end
op_assign
id|start
op_plus
id|width
suffix:semicolon
)brace
r_else
(brace
id|mga_fifo
c_func
(paren
l_int|3
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_DWGCTL
comma
id|M_DWG_BITBLT
op_or
id|M_DWG_SHIFTZERO
op_or
id|M_DWG_BFCOL
op_or
id|M_DWG_REPLACE
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_SGN
comma
l_int|5
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_AR5
comma
op_minus
id|pixx
)paren
suffix:semicolon
id|width
op_decrement
suffix:semicolon
id|end
op_assign
(paren
id|sy
op_plus
id|height
op_minus
l_int|1
)paren
op_star
id|pixx
op_plus
id|sx
op_plus
id|curr_ydstorg
c_func
(paren
id|MINFO
)paren
suffix:semicolon
id|start
op_assign
id|end
op_plus
id|width
suffix:semicolon
id|dy
op_add_assign
id|height
op_minus
l_int|1
suffix:semicolon
)brace
id|mga_fifo
c_func
(paren
l_int|4
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_AR0
comma
id|end
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_AR3
comma
id|start
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_FXBNDRY
comma
(paren
(paren
id|dx
op_plus
id|width
)paren
op_lshift
l_int|16
)paren
op_or
id|dx
)paren
suffix:semicolon
id|mga_ydstlen
c_func
(paren
id|dy
comma
id|height
)paren
suffix:semicolon
id|WaitTillIdle
c_func
(paren
)paren
suffix:semicolon
id|CRITEND
)brace
macro_line|#ifdef FBCON_HAS_CFB4
DECL|function|matrox_cfb4_bmove
r_static
r_void
id|matrox_cfb4_bmove
c_func
(paren
r_struct
id|display
op_star
id|p
comma
r_int
id|sy
comma
r_int
id|sx
comma
r_int
id|dy
comma
r_int
id|dx
comma
r_int
id|height
comma
r_int
id|width
)paren
(brace
r_int
id|pixx
comma
id|start
comma
id|end
suffix:semicolon
id|MINFO_FROM_DISP
c_func
(paren
id|p
)paren
suffix:semicolon
multiline_comment|/* both (sx or dx or width) and fontwidth() are odd, so their multiply is&n;&t;   also odd, that means that we cannot use acceleration */
id|DBG
c_func
(paren
l_string|&quot;matrox_cfb4_bmove&quot;
)paren
id|CRITBEGIN
r_if
c_cond
(paren
(paren
id|sx
op_or
id|dx
op_or
id|width
)paren
op_amp
id|fontwidth
c_func
(paren
id|p
)paren
op_amp
l_int|1
)paren
(brace
id|fbcon_cfb4_bmove
c_func
(paren
id|p
comma
id|sy
comma
id|sx
comma
id|dy
comma
id|dx
comma
id|height
comma
id|width
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|sx
op_mul_assign
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
id|dx
op_mul_assign
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
id|width
op_mul_assign
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
id|height
op_mul_assign
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|sy
op_mul_assign
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|dy
op_mul_assign
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|pixx
op_assign
id|p-&gt;var.xres_virtual
op_rshift
l_int|1
suffix:semicolon
id|sx
op_rshift_assign
l_int|1
suffix:semicolon
id|dx
op_rshift_assign
l_int|1
suffix:semicolon
id|width
op_rshift_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
(paren
id|dy
OL
id|sy
)paren
op_logical_or
(paren
(paren
id|dy
op_eq
id|sy
)paren
op_logical_and
(paren
id|dx
op_le
id|sx
)paren
)paren
)paren
(brace
id|mga_fifo
c_func
(paren
l_int|2
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_AR5
comma
id|pixx
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_DWGCTL
comma
id|M_DWG_BITBLT
op_or
id|M_DWG_SHIFTZERO
op_or
id|M_DWG_SGNZERO
op_or
id|M_DWG_BFCOL
op_or
id|M_DWG_REPLACE
)paren
suffix:semicolon
id|width
op_decrement
suffix:semicolon
id|start
op_assign
id|sy
op_star
id|pixx
op_plus
id|sx
op_plus
id|curr_ydstorg
c_func
(paren
id|MINFO
)paren
suffix:semicolon
id|end
op_assign
id|start
op_plus
id|width
suffix:semicolon
)brace
r_else
(brace
id|mga_fifo
c_func
(paren
l_int|3
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_SGN
comma
l_int|5
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_AR5
comma
op_minus
id|pixx
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_DWGCTL
comma
id|M_DWG_BITBLT
op_or
id|M_DWG_SHIFTZERO
op_or
id|M_DWG_BFCOL
op_or
id|M_DWG_REPLACE
)paren
suffix:semicolon
id|width
op_decrement
suffix:semicolon
id|end
op_assign
(paren
id|sy
op_plus
id|height
op_minus
l_int|1
)paren
op_star
id|pixx
op_plus
id|sx
op_plus
id|curr_ydstorg
c_func
(paren
id|MINFO
)paren
suffix:semicolon
id|start
op_assign
id|end
op_plus
id|width
suffix:semicolon
id|dy
op_add_assign
id|height
op_minus
l_int|1
suffix:semicolon
)brace
id|mga_fifo
c_func
(paren
l_int|5
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_AR0
comma
id|end
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_AR3
comma
id|start
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_FXBNDRY
comma
(paren
(paren
id|dx
op_plus
id|width
)paren
op_lshift
l_int|16
)paren
op_or
id|dx
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_YDST
comma
id|dy
op_star
id|pixx
op_rshift
l_int|5
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_LEN
op_or
id|M_EXEC
comma
id|height
)paren
suffix:semicolon
id|WaitTillIdle
c_func
(paren
)paren
suffix:semicolon
id|CRITEND
)brace
macro_line|#endif
DECL|function|matroxfb_accel_clear
r_static
r_void
id|matroxfb_accel_clear
c_func
(paren
id|CPMINFO
id|u_int32_t
id|color
comma
r_int
id|sy
comma
r_int
id|sx
comma
r_int
id|height
comma
r_int
id|width
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;matroxfb_accel_clear&quot;
)paren
id|CRITBEGIN
id|mga_fifo
c_func
(paren
l_int|5
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_DWGCTL
comma
id|ACCESS_FBINFO
c_func
(paren
id|accel.m_dwg_rect
)paren
op_or
id|M_DWG_REPLACE
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_FCOL
comma
id|color
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_FXBNDRY
comma
(paren
(paren
id|sx
op_plus
id|width
)paren
op_lshift
l_int|16
)paren
op_or
id|sx
)paren
suffix:semicolon
id|mga_ydstlen
c_func
(paren
id|sy
comma
id|height
)paren
suffix:semicolon
id|WaitTillIdle
c_func
(paren
)paren
suffix:semicolon
id|CRITEND
)brace
DECL|function|matrox_cfbX_clear
r_static
r_void
id|matrox_cfbX_clear
c_func
(paren
id|u_int32_t
id|color
comma
r_struct
id|display
op_star
id|p
comma
r_int
id|sy
comma
r_int
id|sx
comma
r_int
id|height
comma
r_int
id|width
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;matrox_cfbX_clear&quot;
)paren
id|matroxfb_accel_clear
c_func
(paren
id|PMXINFO
c_func
(paren
id|p
)paren
id|color
comma
id|sy
op_star
id|fontheight
c_func
(paren
id|p
)paren
comma
id|sx
op_star
id|fontwidth
c_func
(paren
id|p
)paren
comma
id|height
op_star
id|fontheight
c_func
(paren
id|p
)paren
comma
id|width
op_star
id|fontwidth
c_func
(paren
id|p
)paren
)paren
suffix:semicolon
)brace
macro_line|#ifdef FBCON_HAS_CFB4
DECL|function|matrox_cfb4_clear
r_static
r_void
id|matrox_cfb4_clear
c_func
(paren
r_struct
id|vc_data
op_star
id|conp
comma
r_struct
id|display
op_star
id|p
comma
r_int
id|sy
comma
r_int
id|sx
comma
r_int
id|height
comma
r_int
id|width
)paren
(brace
id|u_int32_t
id|bgx
suffix:semicolon
r_int
id|whattodo
suffix:semicolon
id|MINFO_FROM_DISP
c_func
(paren
id|p
)paren
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;matrox_cfb4_clear&quot;
)paren
id|CRITBEGIN
id|whattodo
op_assign
l_int|0
suffix:semicolon
id|bgx
op_assign
id|attr_bgcol_ec
c_func
(paren
id|p
comma
id|conp
)paren
suffix:semicolon
id|bgx
op_or_assign
id|bgx
op_lshift
l_int|4
suffix:semicolon
id|bgx
op_or_assign
id|bgx
op_lshift
l_int|8
suffix:semicolon
id|bgx
op_or_assign
id|bgx
op_lshift
l_int|16
suffix:semicolon
id|sy
op_mul_assign
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|sx
op_mul_assign
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
id|height
op_mul_assign
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|width
op_mul_assign
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
id|sx
op_amp
l_int|1
)paren
(brace
id|sx
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|width
)paren
r_return
suffix:semicolon
id|width
op_decrement
suffix:semicolon
id|whattodo
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|width
op_amp
l_int|1
)paren
(brace
id|whattodo
op_or_assign
l_int|2
suffix:semicolon
)brace
id|width
op_rshift_assign
l_int|1
suffix:semicolon
id|sx
op_rshift_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|width
)paren
(brace
id|mga_fifo
c_func
(paren
l_int|5
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_DWGCTL
comma
id|ACCESS_FBINFO
c_func
(paren
id|accel.m_dwg_rect
)paren
op_or
id|M_DWG_REPLACE2
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_FCOL
comma
id|bgx
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_FXBNDRY
comma
(paren
(paren
id|sx
op_plus
id|width
)paren
op_lshift
l_int|16
)paren
op_or
id|sx
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_YDST
comma
id|sy
op_star
id|p-&gt;var.xres_virtual
op_rshift
l_int|6
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_LEN
op_or
id|M_EXEC
comma
id|height
)paren
suffix:semicolon
id|WaitTillIdle
c_func
(paren
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|whattodo
)paren
(brace
id|u_int32_t
id|step
op_assign
id|p-&gt;var.xres_virtual
op_rshift
l_int|1
suffix:semicolon
id|vaddr_t
id|vbase
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
suffix:semicolon
r_if
c_cond
(paren
id|whattodo
op_amp
l_int|1
)paren
(brace
r_int
r_int
id|uaddr
op_assign
id|sy
op_star
id|step
op_plus
id|sx
op_minus
l_int|1
suffix:semicolon
id|u_int32_t
id|loop
suffix:semicolon
id|u_int8_t
id|bgx2
op_assign
id|bgx
op_amp
l_int|0xF0
suffix:semicolon
r_for
c_loop
(paren
id|loop
op_assign
id|height
suffix:semicolon
id|loop
OG
l_int|0
suffix:semicolon
id|loop
op_decrement
)paren
(brace
id|mga_writeb
c_func
(paren
id|vbase
comma
id|uaddr
comma
(paren
id|mga_readb
c_func
(paren
id|vbase
comma
id|uaddr
)paren
op_amp
l_int|0x0F
)paren
op_or
id|bgx2
)paren
suffix:semicolon
id|uaddr
op_add_assign
id|step
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|whattodo
op_amp
l_int|2
)paren
(brace
r_int
r_int
id|uaddr
op_assign
id|sy
op_star
id|step
op_plus
id|sx
op_plus
id|width
suffix:semicolon
id|u_int32_t
id|loop
suffix:semicolon
id|u_int8_t
id|bgx2
op_assign
id|bgx
op_amp
l_int|0x0F
suffix:semicolon
r_for
c_loop
(paren
id|loop
op_assign
id|height
suffix:semicolon
id|loop
OG
l_int|0
suffix:semicolon
id|loop
op_decrement
)paren
(brace
id|mga_writeb
c_func
(paren
id|vbase
comma
id|uaddr
comma
(paren
id|mga_readb
c_func
(paren
id|vbase
comma
id|uaddr
)paren
op_amp
l_int|0xF0
)paren
op_or
id|bgx2
)paren
suffix:semicolon
id|uaddr
op_add_assign
id|step
suffix:semicolon
)brace
)brace
)brace
id|CRITEND
)brace
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB8
DECL|function|matrox_cfb8_clear
r_static
r_void
id|matrox_cfb8_clear
c_func
(paren
r_struct
id|vc_data
op_star
id|conp
comma
r_struct
id|display
op_star
id|p
comma
r_int
id|sy
comma
r_int
id|sx
comma
r_int
id|height
comma
r_int
id|width
)paren
(brace
id|u_int32_t
id|bgx
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;matrox_cfb8_clear&quot;
)paren
id|bgx
op_assign
id|attr_bgcol_ec
c_func
(paren
id|p
comma
id|conp
)paren
suffix:semicolon
id|bgx
op_or_assign
id|bgx
op_lshift
l_int|8
suffix:semicolon
id|bgx
op_or_assign
id|bgx
op_lshift
l_int|16
suffix:semicolon
id|matrox_cfbX_clear
c_func
(paren
id|bgx
comma
id|p
comma
id|sy
comma
id|sx
comma
id|height
comma
id|width
)paren
suffix:semicolon
)brace
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB16
DECL|function|matrox_cfb16_clear
r_static
r_void
id|matrox_cfb16_clear
c_func
(paren
r_struct
id|vc_data
op_star
id|conp
comma
r_struct
id|display
op_star
id|p
comma
r_int
id|sy
comma
r_int
id|sx
comma
r_int
id|height
comma
r_int
id|width
)paren
(brace
id|u_int32_t
id|bgx
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;matrox_cfb16_clear&quot;
)paren
id|bgx
op_assign
(paren
(paren
id|u_int16_t
op_star
)paren
id|p-&gt;dispsw_data
)paren
(braket
id|attr_bgcol_ec
c_func
(paren
id|p
comma
id|conp
)paren
)braket
suffix:semicolon
id|matrox_cfbX_clear
c_func
(paren
(paren
id|bgx
op_lshift
l_int|16
)paren
op_or
id|bgx
comma
id|p
comma
id|sy
comma
id|sx
comma
id|height
comma
id|width
)paren
suffix:semicolon
)brace
macro_line|#endif
macro_line|#if defined(FBCON_HAS_CFB32) || defined(FBCON_HAS_CFB24)
DECL|function|matrox_cfb32_clear
r_static
r_void
id|matrox_cfb32_clear
c_func
(paren
r_struct
id|vc_data
op_star
id|conp
comma
r_struct
id|display
op_star
id|p
comma
r_int
id|sy
comma
r_int
id|sx
comma
r_int
id|height
comma
r_int
id|width
)paren
(brace
id|u_int32_t
id|bgx
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;matrox_cfb32_clear&quot;
)paren
id|bgx
op_assign
(paren
(paren
id|u_int32_t
op_star
)paren
id|p-&gt;dispsw_data
)paren
(braket
id|attr_bgcol_ec
c_func
(paren
id|p
comma
id|conp
)paren
)braket
suffix:semicolon
id|matrox_cfbX_clear
c_func
(paren
id|bgx
comma
id|p
comma
id|sy
comma
id|sx
comma
id|height
comma
id|width
)paren
suffix:semicolon
)brace
macro_line|#endif
DECL|function|matrox_cfbX_fastputc
r_static
r_void
id|matrox_cfbX_fastputc
c_func
(paren
id|u_int32_t
id|fgx
comma
id|u_int32_t
id|bgx
comma
r_struct
id|display
op_star
id|p
comma
r_int
id|c
comma
r_int
id|yy
comma
r_int
id|xx
)paren
(brace
r_int
r_int
id|charcell
suffix:semicolon
r_int
r_int
id|ar3
suffix:semicolon
id|MINFO_FROM_DISP
c_func
(paren
id|p
)paren
suffix:semicolon
id|charcell
op_assign
id|fontwidth
c_func
(paren
id|p
)paren
op_star
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|yy
op_mul_assign
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|xx
op_mul_assign
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
id|CRITBEGIN
id|mga_fifo
c_func
(paren
l_int|8
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_DWGCTL
comma
id|M_DWG_BITBLT
op_or
id|M_DWG_SGNZERO
op_or
id|M_DWG_SHIFTZERO
op_or
id|M_DWG_BMONOWF
op_or
id|M_DWG_LINEAR
op_or
id|M_DWG_REPLACE
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_FCOL
comma
id|fgx
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_BCOL
comma
id|bgx
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_FXBNDRY
comma
(paren
(paren
id|xx
op_plus
id|fontwidth
c_func
(paren
id|p
)paren
op_minus
l_int|1
)paren
op_lshift
l_int|16
)paren
op_or
id|xx
)paren
suffix:semicolon
id|ar3
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|fastfont.mgabase
)paren
op_plus
(paren
id|c
op_amp
id|p-&gt;charmask
)paren
op_star
id|charcell
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_AR3
comma
id|ar3
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_AR0
comma
(paren
id|ar3
op_plus
id|charcell
op_minus
l_int|1
)paren
op_amp
l_int|0x0003FFFF
)paren
suffix:semicolon
id|mga_ydstlen
c_func
(paren
id|yy
comma
id|fontheight
c_func
(paren
id|p
)paren
)paren
suffix:semicolon
id|WaitTillIdle
c_func
(paren
)paren
suffix:semicolon
id|CRITEND
)brace
DECL|function|matrox_cfbX_putc
r_static
r_void
id|matrox_cfbX_putc
c_func
(paren
id|u_int32_t
id|fgx
comma
id|u_int32_t
id|bgx
comma
r_struct
id|display
op_star
id|p
comma
r_int
id|c
comma
r_int
id|yy
comma
r_int
id|xx
)paren
(brace
id|u_int32_t
id|ar0
suffix:semicolon
id|u_int32_t
id|step
suffix:semicolon
id|MINFO_FROM_DISP
c_func
(paren
id|p
)paren
suffix:semicolon
id|DBG_HEAVY
c_func
(paren
l_string|&quot;matrox_cfbX_putc&quot;
)paren
suffix:semicolon
id|yy
op_mul_assign
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|xx
op_mul_assign
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
id|CRITBEGIN
macro_line|#ifdef __BIG_ENDIAN
id|WaitTillIdle
c_func
(paren
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_OPMODE
comma
id|M_OPMODE_8BPP
)paren
suffix:semicolon
macro_line|#else
id|mga_fifo
c_func
(paren
l_int|7
)paren
suffix:semicolon
macro_line|#endif
id|ar0
op_assign
id|fontwidth
c_func
(paren
id|p
)paren
op_minus
l_int|1
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_FXBNDRY
comma
(paren
(paren
id|xx
op_plus
id|ar0
)paren
op_lshift
l_int|16
)paren
op_or
id|xx
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fontwidth
c_func
(paren
id|p
)paren
op_le
l_int|8
)paren
id|step
op_assign
l_int|1
suffix:semicolon
r_else
r_if
c_cond
(paren
id|fontwidth
c_func
(paren
id|p
)paren
op_le
l_int|16
)paren
id|step
op_assign
l_int|2
suffix:semicolon
r_else
id|step
op_assign
l_int|4
suffix:semicolon
r_if
c_cond
(paren
id|fontwidth
c_func
(paren
id|p
)paren
op_eq
id|step
op_lshift
l_int|3
)paren
(brace
r_int
id|charcell
op_assign
id|fontheight
c_func
(paren
id|p
)paren
op_star
id|step
suffix:semicolon
multiline_comment|/* TODO: Align charcell to 4B for BE */
id|mga_outl
c_func
(paren
id|M_DWGCTL
comma
id|M_DWG_ILOAD
op_or
id|M_DWG_SGNZERO
op_or
id|M_DWG_SHIFTZERO
op_or
id|M_DWG_BMONOWF
op_or
id|M_DWG_LINEAR
op_or
id|M_DWG_REPLACE
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_FCOL
comma
id|fgx
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_BCOL
comma
id|bgx
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_AR3
comma
l_int|0
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_AR0
comma
id|fontheight
c_func
(paren
id|p
)paren
op_star
id|fontwidth
c_func
(paren
id|p
)paren
op_minus
l_int|1
)paren
suffix:semicolon
id|mga_ydstlen
c_func
(paren
id|yy
comma
id|fontheight
c_func
(paren
id|p
)paren
)paren
suffix:semicolon
id|mga_memcpy_toio
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|mmio.vbase
)paren
comma
l_int|0
comma
id|p-&gt;fontdata
op_plus
(paren
id|c
op_amp
id|p-&gt;charmask
)paren
op_star
id|charcell
comma
id|charcell
)paren
suffix:semicolon
)brace
r_else
(brace
id|u8
op_star
id|chardata
op_assign
id|p-&gt;fontdata
op_plus
(paren
id|c
op_amp
id|p-&gt;charmask
)paren
op_star
id|fontheight
c_func
(paren
id|p
)paren
op_star
id|step
suffix:semicolon
r_int
id|i
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_DWGCTL
comma
id|M_DWG_ILOAD
op_or
id|M_DWG_SGNZERO
op_or
id|M_DWG_SHIFTZERO
op_or
id|M_DWG_BMONOWF
op_or
id|M_DWG_REPLACE
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_FCOL
comma
id|fgx
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_BCOL
comma
id|bgx
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_AR5
comma
l_int|0
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_AR3
comma
l_int|0
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_AR0
comma
id|ar0
)paren
suffix:semicolon
id|mga_ydstlen
c_func
(paren
id|yy
comma
id|fontheight
c_func
(paren
id|p
)paren
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|step
)paren
(brace
r_case
l_int|1
suffix:colon
r_for
c_loop
(paren
id|i
op_assign
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|i
OG
l_int|0
suffix:semicolon
id|i
op_decrement
)paren
(brace
macro_line|#ifdef __LITTLE_ENDIAN
id|mga_outl
c_func
(paren
l_int|0
comma
op_star
id|chardata
op_increment
)paren
suffix:semicolon
macro_line|#else
id|mga_outl
c_func
(paren
l_int|0
comma
(paren
op_star
id|chardata
op_increment
)paren
op_lshift
l_int|24
)paren
suffix:semicolon
macro_line|#endif
)brace
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
r_for
c_loop
(paren
id|i
op_assign
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|i
OG
l_int|0
suffix:semicolon
id|i
op_decrement
)paren
(brace
macro_line|#ifdef __LITTLE_ENDIAN
id|mga_outl
c_func
(paren
l_int|0
comma
op_star
(paren
id|u_int16_t
op_star
)paren
id|chardata
)paren
suffix:semicolon
macro_line|#else
id|mga_outl
c_func
(paren
l_int|0
comma
(paren
op_star
(paren
id|u_int16_t
op_star
)paren
id|chardata
)paren
op_lshift
l_int|16
)paren
suffix:semicolon
macro_line|#endif
id|chardata
op_add_assign
l_int|2
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
id|mga_memcpy_toio
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|mmio.vbase
)paren
comma
l_int|0
comma
id|chardata
comma
id|fontheight
c_func
(paren
id|p
)paren
op_star
l_int|4
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
id|WaitTillIdle
c_func
(paren
)paren
suffix:semicolon
macro_line|#ifdef __BIG_ENDIAN
id|mga_outl
c_func
(paren
id|M_OPMODE
comma
id|ACCESS_FBINFO
c_func
(paren
id|accel.m_opmode
)paren
)paren
suffix:semicolon
macro_line|#endif
id|CRITEND
)brace
macro_line|#ifdef FBCON_HAS_CFB8
DECL|function|matrox_cfb8_putc
r_static
r_void
id|matrox_cfb8_putc
c_func
(paren
r_struct
id|vc_data
op_star
id|conp
comma
r_struct
id|display
op_star
id|p
comma
r_int
id|c
comma
r_int
id|yy
comma
r_int
id|xx
)paren
(brace
id|u_int32_t
id|fgx
comma
id|bgx
suffix:semicolon
id|MINFO_FROM_DISP
c_func
(paren
id|p
)paren
suffix:semicolon
id|DBG_HEAVY
c_func
(paren
l_string|&quot;matroxfb_cfb8_putc&quot;
)paren
suffix:semicolon
id|fgx
op_assign
id|attr_fgcol
c_func
(paren
id|p
comma
id|c
)paren
suffix:semicolon
id|bgx
op_assign
id|attr_bgcol
c_func
(paren
id|p
comma
id|c
)paren
suffix:semicolon
id|fgx
op_or_assign
(paren
id|fgx
op_lshift
l_int|8
)paren
suffix:semicolon
id|fgx
op_or_assign
(paren
id|fgx
op_lshift
l_int|16
)paren
suffix:semicolon
id|bgx
op_or_assign
(paren
id|bgx
op_lshift
l_int|8
)paren
suffix:semicolon
id|bgx
op_or_assign
(paren
id|bgx
op_lshift
l_int|16
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|curr.putc
)paren
(paren
id|fgx
comma
id|bgx
comma
id|p
comma
id|c
comma
id|yy
comma
id|xx
)paren
suffix:semicolon
)brace
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB16
DECL|function|matrox_cfb16_putc
r_static
r_void
id|matrox_cfb16_putc
c_func
(paren
r_struct
id|vc_data
op_star
id|conp
comma
r_struct
id|display
op_star
id|p
comma
r_int
id|c
comma
r_int
id|yy
comma
r_int
id|xx
)paren
(brace
id|u_int32_t
id|fgx
comma
id|bgx
suffix:semicolon
id|MINFO_FROM_DISP
c_func
(paren
id|p
)paren
suffix:semicolon
id|DBG_HEAVY
c_func
(paren
l_string|&quot;matroxfb_cfb16_putc&quot;
)paren
suffix:semicolon
id|fgx
op_assign
(paren
(paren
id|u_int16_t
op_star
)paren
id|p-&gt;dispsw_data
)paren
(braket
id|attr_fgcol
c_func
(paren
id|p
comma
id|c
)paren
)braket
suffix:semicolon
id|bgx
op_assign
(paren
(paren
id|u_int16_t
op_star
)paren
id|p-&gt;dispsw_data
)paren
(braket
id|attr_bgcol
c_func
(paren
id|p
comma
id|c
)paren
)braket
suffix:semicolon
id|fgx
op_or_assign
(paren
id|fgx
op_lshift
l_int|16
)paren
suffix:semicolon
id|bgx
op_or_assign
(paren
id|bgx
op_lshift
l_int|16
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|curr.putc
)paren
(paren
id|fgx
comma
id|bgx
comma
id|p
comma
id|c
comma
id|yy
comma
id|xx
)paren
suffix:semicolon
)brace
macro_line|#endif
macro_line|#if defined(FBCON_HAS_CFB32) || defined(FBCON_HAS_CFB24)
DECL|function|matrox_cfb32_putc
r_static
r_void
id|matrox_cfb32_putc
c_func
(paren
r_struct
id|vc_data
op_star
id|conp
comma
r_struct
id|display
op_star
id|p
comma
r_int
id|c
comma
r_int
id|yy
comma
r_int
id|xx
)paren
(brace
id|u_int32_t
id|fgx
comma
id|bgx
suffix:semicolon
id|MINFO_FROM_DISP
c_func
(paren
id|p
)paren
suffix:semicolon
id|DBG_HEAVY
c_func
(paren
l_string|&quot;matroxfb_cfb32_putc&quot;
)paren
suffix:semicolon
id|fgx
op_assign
(paren
(paren
id|u_int32_t
op_star
)paren
id|p-&gt;dispsw_data
)paren
(braket
id|attr_fgcol
c_func
(paren
id|p
comma
id|c
)paren
)braket
suffix:semicolon
id|bgx
op_assign
(paren
(paren
id|u_int32_t
op_star
)paren
id|p-&gt;dispsw_data
)paren
(braket
id|attr_bgcol
c_func
(paren
id|p
comma
id|c
)paren
)braket
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|curr.putc
)paren
(paren
id|fgx
comma
id|bgx
comma
id|p
comma
id|c
comma
id|yy
comma
id|xx
)paren
suffix:semicolon
)brace
macro_line|#endif
DECL|function|matrox_cfbX_fastputcs
r_static
r_void
id|matrox_cfbX_fastputcs
c_func
(paren
id|u_int32_t
id|fgx
comma
id|u_int32_t
id|bgx
comma
r_struct
id|display
op_star
id|p
comma
r_const
r_int
r_int
op_star
id|s
comma
r_int
id|count
comma
r_int
id|yy
comma
r_int
id|xx
)paren
(brace
r_int
r_int
id|charcell
suffix:semicolon
id|MINFO_FROM_DISP
c_func
(paren
id|p
)paren
suffix:semicolon
id|yy
op_mul_assign
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|xx
op_mul_assign
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
id|charcell
op_assign
id|fontwidth
c_func
(paren
id|p
)paren
op_star
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|CRITBEGIN
id|mga_fifo
c_func
(paren
l_int|3
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_DWGCTL
comma
id|M_DWG_BITBLT
op_or
id|M_DWG_SGNZERO
op_or
id|M_DWG_SHIFTZERO
op_or
id|M_DWG_BMONOWF
op_or
id|M_DWG_LINEAR
op_or
id|M_DWG_REPLACE
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_FCOL
comma
id|fgx
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_BCOL
comma
id|bgx
)paren
suffix:semicolon
r_while
c_loop
(paren
id|count
op_decrement
)paren
(brace
id|u_int32_t
id|ar3
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|fastfont.mgabase
)paren
op_plus
(paren
id|scr_readw
c_func
(paren
id|s
op_increment
)paren
op_amp
id|p-&gt;charmask
)paren
op_star
id|charcell
suffix:semicolon
id|mga_fifo
c_func
(paren
l_int|4
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_FXBNDRY
comma
(paren
(paren
id|xx
op_plus
id|fontwidth
c_func
(paren
id|p
)paren
op_minus
l_int|1
)paren
op_lshift
l_int|16
)paren
op_or
id|xx
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_AR3
comma
id|ar3
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_AR0
comma
(paren
id|ar3
op_plus
id|charcell
op_minus
l_int|1
)paren
op_amp
l_int|0x0003FFFF
)paren
suffix:semicolon
id|mga_ydstlen
c_func
(paren
id|yy
comma
id|fontheight
c_func
(paren
id|p
)paren
)paren
suffix:semicolon
id|xx
op_add_assign
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
)brace
id|WaitTillIdle
c_func
(paren
)paren
suffix:semicolon
id|CRITEND
)brace
DECL|function|matrox_cfbX_putcs
r_static
r_void
id|matrox_cfbX_putcs
c_func
(paren
id|u_int32_t
id|fgx
comma
id|u_int32_t
id|bgx
comma
r_struct
id|display
op_star
id|p
comma
r_const
r_int
r_int
op_star
id|s
comma
r_int
id|count
comma
r_int
id|yy
comma
r_int
id|xx
)paren
(brace
id|u_int32_t
id|step
suffix:semicolon
id|u_int32_t
id|ydstlen
suffix:semicolon
id|u_int32_t
id|xlen
suffix:semicolon
id|u_int32_t
id|ar0
suffix:semicolon
id|u_int32_t
id|charcell
suffix:semicolon
id|u_int32_t
id|fxbndry
suffix:semicolon
id|vaddr_t
id|mmio
suffix:semicolon
r_int
id|easy
suffix:semicolon
id|MINFO_FROM_DISP
c_func
(paren
id|p
)paren
suffix:semicolon
id|DBG_HEAVY
c_func
(paren
l_string|&quot;matroxfb_cfbX_putcs&quot;
)paren
suffix:semicolon
id|yy
op_mul_assign
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|xx
op_mul_assign
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fontwidth
c_func
(paren
id|p
)paren
op_le
l_int|8
)paren
id|step
op_assign
l_int|1
suffix:semicolon
r_else
r_if
c_cond
(paren
id|fontwidth
c_func
(paren
id|p
)paren
op_le
l_int|16
)paren
id|step
op_assign
l_int|2
suffix:semicolon
r_else
id|step
op_assign
l_int|4
suffix:semicolon
id|charcell
op_assign
id|fontheight
c_func
(paren
id|p
)paren
op_star
id|step
suffix:semicolon
id|xlen
op_assign
(paren
id|charcell
op_plus
l_int|3
)paren
op_amp
op_complement
l_int|3
suffix:semicolon
id|ydstlen
op_assign
(paren
id|yy
op_lshift
l_int|16
)paren
op_or
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fontwidth
c_func
(paren
id|p
)paren
op_eq
id|step
op_lshift
l_int|3
)paren
(brace
id|ar0
op_assign
id|fontheight
c_func
(paren
id|p
)paren
op_star
id|fontwidth
c_func
(paren
id|p
)paren
op_minus
l_int|1
suffix:semicolon
id|easy
op_assign
l_int|1
suffix:semicolon
)brace
r_else
(brace
id|ar0
op_assign
id|fontwidth
c_func
(paren
id|p
)paren
op_minus
l_int|1
suffix:semicolon
id|easy
op_assign
l_int|0
suffix:semicolon
)brace
id|CRITBEGIN
macro_line|#ifdef __BIG_ENDIAN
id|WaitTillIdle
c_func
(paren
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_OPMODE
comma
id|M_OPMODE_8BPP
)paren
suffix:semicolon
macro_line|#else
id|mga_fifo
c_func
(paren
l_int|3
)paren
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
id|easy
)paren
id|mga_outl
c_func
(paren
id|M_DWGCTL
comma
id|M_DWG_ILOAD
op_or
id|M_DWG_SGNZERO
op_or
id|M_DWG_SHIFTZERO
op_or
id|M_DWG_BMONOWF
op_or
id|M_DWG_LINEAR
op_or
id|M_DWG_REPLACE
)paren
suffix:semicolon
r_else
id|mga_outl
c_func
(paren
id|M_DWGCTL
comma
id|M_DWG_ILOAD
op_or
id|M_DWG_SGNZERO
op_or
id|M_DWG_SHIFTZERO
op_or
id|M_DWG_BMONOWF
op_or
id|M_DWG_REPLACE
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_FCOL
comma
id|fgx
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_BCOL
comma
id|bgx
)paren
suffix:semicolon
id|fxbndry
op_assign
(paren
(paren
id|xx
op_plus
id|fontwidth
c_func
(paren
id|p
)paren
op_minus
l_int|1
)paren
op_lshift
l_int|16
)paren
op_or
id|xx
suffix:semicolon
id|mmio
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|mmio.vbase
)paren
suffix:semicolon
r_while
c_loop
(paren
id|count
op_decrement
)paren
(brace
id|u_int8_t
op_star
id|chardata
op_assign
id|p-&gt;fontdata
op_plus
(paren
id|scr_readw
c_func
(paren
id|s
op_increment
)paren
op_amp
id|p-&gt;charmask
)paren
op_star
id|charcell
suffix:semicolon
id|mga_fifo
c_func
(paren
l_int|6
)paren
suffix:semicolon
id|mga_writel
c_func
(paren
id|mmio
comma
id|M_FXBNDRY
comma
id|fxbndry
)paren
suffix:semicolon
id|mga_writel
c_func
(paren
id|mmio
comma
id|M_AR0
comma
id|ar0
)paren
suffix:semicolon
id|mga_writel
c_func
(paren
id|mmio
comma
id|M_AR3
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|easy
)paren
(brace
id|mga_writel
c_func
(paren
id|mmio
comma
id|M_YDSTLEN
op_or
id|M_EXEC
comma
id|ydstlen
)paren
suffix:semicolon
id|mga_memcpy_toio
c_func
(paren
id|mmio
comma
l_int|0
comma
id|chardata
comma
id|xlen
)paren
suffix:semicolon
)brace
r_else
(brace
id|mga_writel
c_func
(paren
id|mmio
comma
id|M_AR5
comma
l_int|0
)paren
suffix:semicolon
id|mga_writel
c_func
(paren
id|mmio
comma
id|M_YDSTLEN
op_or
id|M_EXEC
comma
id|ydstlen
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|step
)paren
(brace
r_case
l_int|1
suffix:colon
(brace
id|u_int8_t
op_star
id|charend
op_assign
id|chardata
op_plus
id|charcell
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
id|chardata
op_ne
id|charend
suffix:semicolon
id|chardata
op_increment
)paren
(brace
macro_line|#ifdef __LITTLE_ENDIAN
id|mga_writel
c_func
(paren
id|mmio
comma
l_int|0
comma
op_star
id|chardata
)paren
suffix:semicolon
macro_line|#else
id|mga_writel
c_func
(paren
id|mmio
comma
l_int|0
comma
(paren
op_star
id|chardata
)paren
op_lshift
l_int|24
)paren
suffix:semicolon
macro_line|#endif
)brace
)brace
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
(brace
id|u_int8_t
op_star
id|charend
op_assign
id|chardata
op_plus
id|charcell
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
id|chardata
op_ne
id|charend
suffix:semicolon
id|chardata
op_add_assign
l_int|2
)paren
(brace
macro_line|#ifdef __LITTLE_ENDIAN
id|mga_writel
c_func
(paren
id|mmio
comma
l_int|0
comma
op_star
(paren
id|u_int16_t
op_star
)paren
id|chardata
)paren
suffix:semicolon
macro_line|#else
id|mga_writel
c_func
(paren
id|mmio
comma
l_int|0
comma
(paren
op_star
(paren
id|u_int16_t
op_star
)paren
id|chardata
)paren
op_lshift
l_int|16
)paren
suffix:semicolon
macro_line|#endif
)brace
)brace
r_break
suffix:semicolon
r_default
suffix:colon
id|mga_memcpy_toio
c_func
(paren
id|mmio
comma
l_int|0
comma
id|chardata
comma
id|charcell
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
id|fxbndry
op_add_assign
id|fontwidth
c_func
(paren
id|p
)paren
op_plus
(paren
id|fontwidth
c_func
(paren
id|p
)paren
op_lshift
l_int|16
)paren
suffix:semicolon
)brace
id|WaitTillIdle
c_func
(paren
)paren
suffix:semicolon
macro_line|#ifdef __BIG_ENDIAN
id|mga_outl
c_func
(paren
id|M_OPMODE
comma
id|ACCESS_FBINFO
c_func
(paren
id|accel.m_opmode
)paren
)paren
suffix:semicolon
macro_line|#endif
id|CRITEND
)brace
macro_line|#ifdef FBCON_HAS_CFB8
DECL|function|matrox_cfb8_putcs
r_static
r_void
id|matrox_cfb8_putcs
c_func
(paren
r_struct
id|vc_data
op_star
id|conp
comma
r_struct
id|display
op_star
id|p
comma
r_const
r_int
r_int
op_star
id|s
comma
r_int
id|count
comma
r_int
id|yy
comma
r_int
id|xx
)paren
(brace
id|u_int32_t
id|fgx
comma
id|bgx
suffix:semicolon
id|MINFO_FROM_DISP
c_func
(paren
id|p
)paren
suffix:semicolon
id|DBG_HEAVY
c_func
(paren
l_string|&quot;matroxfb_cfb8_putcs&quot;
)paren
suffix:semicolon
id|fgx
op_assign
id|attr_fgcol
c_func
(paren
id|p
comma
id|scr_readw
c_func
(paren
id|s
)paren
)paren
suffix:semicolon
id|bgx
op_assign
id|attr_bgcol
c_func
(paren
id|p
comma
id|scr_readw
c_func
(paren
id|s
)paren
)paren
suffix:semicolon
id|fgx
op_or_assign
(paren
id|fgx
op_lshift
l_int|8
)paren
suffix:semicolon
id|fgx
op_or_assign
(paren
id|fgx
op_lshift
l_int|16
)paren
suffix:semicolon
id|bgx
op_or_assign
(paren
id|bgx
op_lshift
l_int|8
)paren
suffix:semicolon
id|bgx
op_or_assign
(paren
id|bgx
op_lshift
l_int|16
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|curr.putcs
)paren
(paren
id|fgx
comma
id|bgx
comma
id|p
comma
id|s
comma
id|count
comma
id|yy
comma
id|xx
)paren
suffix:semicolon
)brace
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB16
DECL|function|matrox_cfb16_putcs
r_static
r_void
id|matrox_cfb16_putcs
c_func
(paren
r_struct
id|vc_data
op_star
id|conp
comma
r_struct
id|display
op_star
id|p
comma
r_const
r_int
r_int
op_star
id|s
comma
r_int
id|count
comma
r_int
id|yy
comma
r_int
id|xx
)paren
(brace
id|u_int32_t
id|fgx
comma
id|bgx
suffix:semicolon
id|MINFO_FROM_DISP
c_func
(paren
id|p
)paren
suffix:semicolon
id|DBG_HEAVY
c_func
(paren
l_string|&quot;matroxfb_cfb16_putcs&quot;
)paren
suffix:semicolon
id|fgx
op_assign
(paren
(paren
id|u_int16_t
op_star
)paren
id|p-&gt;dispsw_data
)paren
(braket
id|attr_fgcol
c_func
(paren
id|p
comma
id|scr_readw
c_func
(paren
id|s
)paren
)paren
)braket
suffix:semicolon
id|bgx
op_assign
(paren
(paren
id|u_int16_t
op_star
)paren
id|p-&gt;dispsw_data
)paren
(braket
id|attr_bgcol
c_func
(paren
id|p
comma
id|scr_readw
c_func
(paren
id|s
)paren
)paren
)braket
suffix:semicolon
id|fgx
op_or_assign
(paren
id|fgx
op_lshift
l_int|16
)paren
suffix:semicolon
id|bgx
op_or_assign
(paren
id|bgx
op_lshift
l_int|16
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|curr.putcs
)paren
(paren
id|fgx
comma
id|bgx
comma
id|p
comma
id|s
comma
id|count
comma
id|yy
comma
id|xx
)paren
suffix:semicolon
)brace
macro_line|#endif
macro_line|#if defined(FBCON_HAS_CFB32) || defined(FBCON_HAS_CFB24)
DECL|function|matrox_cfb32_putcs
r_static
r_void
id|matrox_cfb32_putcs
c_func
(paren
r_struct
id|vc_data
op_star
id|conp
comma
r_struct
id|display
op_star
id|p
comma
r_const
r_int
r_int
op_star
id|s
comma
r_int
id|count
comma
r_int
id|yy
comma
r_int
id|xx
)paren
(brace
id|u_int32_t
id|fgx
comma
id|bgx
suffix:semicolon
id|MINFO_FROM_DISP
c_func
(paren
id|p
)paren
suffix:semicolon
id|DBG_HEAVY
c_func
(paren
l_string|&quot;matroxfb_cfb32_putcs&quot;
)paren
suffix:semicolon
id|fgx
op_assign
(paren
(paren
id|u_int32_t
op_star
)paren
id|p-&gt;dispsw_data
)paren
(braket
id|attr_fgcol
c_func
(paren
id|p
comma
id|scr_readw
c_func
(paren
id|s
)paren
)paren
)braket
suffix:semicolon
id|bgx
op_assign
(paren
(paren
id|u_int32_t
op_star
)paren
id|p-&gt;dispsw_data
)paren
(braket
id|attr_bgcol
c_func
(paren
id|p
comma
id|scr_readw
c_func
(paren
id|s
)paren
)paren
)braket
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|curr.putcs
)paren
(paren
id|fgx
comma
id|bgx
comma
id|p
comma
id|s
comma
id|count
comma
id|yy
comma
id|xx
)paren
suffix:semicolon
)brace
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB4
DECL|function|matrox_cfb4_revc
r_static
r_void
id|matrox_cfb4_revc
c_func
(paren
r_struct
id|display
op_star
id|p
comma
r_int
id|xx
comma
r_int
id|yy
)paren
(brace
id|MINFO_FROM_DISP
c_func
(paren
id|p
)paren
suffix:semicolon
id|DBG_LOOP
c_func
(paren
l_string|&quot;matroxfb_cfb4_revc&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fontwidth
c_func
(paren
id|p
)paren
op_amp
l_int|1
)paren
(brace
id|fbcon_cfb4_revc
c_func
(paren
id|p
comma
id|xx
comma
id|yy
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|yy
op_mul_assign
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|xx
op_mul_assign
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
id|xx
op_or_assign
(paren
id|xx
op_plus
id|fontwidth
c_func
(paren
id|p
)paren
)paren
op_lshift
l_int|16
suffix:semicolon
id|xx
op_rshift_assign
l_int|1
suffix:semicolon
id|CRITBEGIN
id|mga_fifo
c_func
(paren
l_int|5
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_DWGCTL
comma
id|ACCESS_FBINFO
c_func
(paren
id|accel.m_dwg_rect
)paren
op_or
id|M_DWG_XOR
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_FCOL
comma
l_int|0xFFFFFFFF
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_FXBNDRY
comma
id|xx
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_YDST
comma
id|yy
op_star
id|p-&gt;var.xres_virtual
op_rshift
l_int|6
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_LEN
op_or
id|M_EXEC
comma
id|fontheight
c_func
(paren
id|p
)paren
)paren
suffix:semicolon
id|WaitTillIdle
c_func
(paren
)paren
suffix:semicolon
id|CRITEND
)brace
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB8
DECL|function|matrox_cfb8_revc
r_static
r_void
id|matrox_cfb8_revc
c_func
(paren
r_struct
id|display
op_star
id|p
comma
r_int
id|xx
comma
r_int
id|yy
)paren
(brace
id|MINFO_FROM_DISP
c_func
(paren
id|p
)paren
suffix:semicolon
id|DBG_LOOP
c_func
(paren
l_string|&quot;matrox_cfb8_revc&quot;
)paren
id|yy
op_mul_assign
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|xx
op_mul_assign
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
id|CRITBEGIN
id|mga_fifo
c_func
(paren
l_int|4
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_DWGCTL
comma
id|ACCESS_FBINFO
c_func
(paren
id|accel.m_dwg_rect
)paren
op_or
id|M_DWG_XOR
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_FCOL
comma
l_int|0x0F0F0F0F
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_FXBNDRY
comma
(paren
(paren
id|xx
op_plus
id|fontwidth
c_func
(paren
id|p
)paren
)paren
op_lshift
l_int|16
)paren
op_or
id|xx
)paren
suffix:semicolon
id|mga_ydstlen
c_func
(paren
id|yy
comma
id|fontheight
c_func
(paren
id|p
)paren
)paren
suffix:semicolon
id|WaitTillIdle
c_func
(paren
)paren
suffix:semicolon
id|CRITEND
)brace
macro_line|#endif
DECL|function|matrox_cfbX_revc
r_static
r_void
id|matrox_cfbX_revc
c_func
(paren
r_struct
id|display
op_star
id|p
comma
r_int
id|xx
comma
r_int
id|yy
)paren
(brace
id|MINFO_FROM_DISP
c_func
(paren
id|p
)paren
suffix:semicolon
id|DBG_LOOP
c_func
(paren
l_string|&quot;matrox_cfbX_revc&quot;
)paren
id|yy
op_mul_assign
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|xx
op_mul_assign
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
id|CRITBEGIN
id|mga_fifo
c_func
(paren
l_int|4
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_DWGCTL
comma
id|ACCESS_FBINFO
c_func
(paren
id|accel.m_dwg_rect
)paren
op_or
id|M_DWG_XOR
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_FCOL
comma
l_int|0xFFFFFFFF
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_FXBNDRY
comma
(paren
(paren
id|xx
op_plus
id|fontwidth
c_func
(paren
id|p
)paren
)paren
op_lshift
l_int|16
)paren
op_or
id|xx
)paren
suffix:semicolon
id|mga_ydstlen
c_func
(paren
id|yy
comma
id|fontheight
c_func
(paren
id|p
)paren
)paren
suffix:semicolon
id|WaitTillIdle
c_func
(paren
)paren
suffix:semicolon
id|CRITEND
)brace
DECL|function|matrox_cfbX_clear_margins
r_static
r_void
id|matrox_cfbX_clear_margins
c_func
(paren
r_struct
id|vc_data
op_star
id|conp
comma
r_struct
id|display
op_star
id|p
comma
r_int
id|bottom_only
)paren
(brace
r_int
r_int
id|bottom_height
comma
id|right_width
suffix:semicolon
r_int
r_int
id|bottom_start
comma
id|right_start
suffix:semicolon
r_int
r_int
id|cell_h
comma
id|cell_w
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;matrox_cfbX_clear_margins&quot;
)paren
id|cell_w
op_assign
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|cell_w
)paren
r_return
suffix:semicolon
multiline_comment|/* PARANOID */
id|right_width
op_assign
id|p-&gt;var.xres
op_mod
id|cell_w
suffix:semicolon
id|right_start
op_assign
id|p-&gt;var.xres
op_minus
id|right_width
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|bottom_only
op_logical_and
id|right_width
)paren
(brace
multiline_comment|/* clear whole right margin, not only visible portion */
id|matroxfb_accel_clear
c_func
(paren
id|PMXINFO
c_func
(paren
id|p
)paren
multiline_comment|/* color */
l_int|0x00000000
comma
multiline_comment|/* y */
l_int|0
comma
multiline_comment|/* x */
id|p-&gt;var.xoffset
op_plus
id|right_start
comma
multiline_comment|/* height */
id|p-&gt;var.yres_virtual
comma
multiline_comment|/* width */
id|right_width
)paren
suffix:semicolon
)brace
id|cell_h
op_assign
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|cell_h
)paren
r_return
suffix:semicolon
multiline_comment|/* PARANOID */
id|bottom_height
op_assign
id|p-&gt;var.yres
op_mod
id|cell_h
suffix:semicolon
r_if
c_cond
(paren
id|bottom_height
)paren
(brace
id|bottom_start
op_assign
id|p-&gt;var.yres
op_minus
id|bottom_height
suffix:semicolon
id|matroxfb_accel_clear
c_func
(paren
id|PMXINFO
c_func
(paren
id|p
)paren
multiline_comment|/* color */
l_int|0x00000000
comma
multiline_comment|/* y */
id|p-&gt;var.yoffset
op_plus
id|bottom_start
comma
multiline_comment|/* x */
id|p-&gt;var.xoffset
comma
multiline_comment|/* height */
id|bottom_height
comma
multiline_comment|/* width */
id|right_start
)paren
suffix:semicolon
)brace
)brace
DECL|function|outDAC
r_static
r_void
id|outDAC
c_func
(paren
id|CPMINFO
r_int
id|reg
comma
r_int
id|val
)paren
(brace
id|DBG_REG
c_func
(paren
l_string|&quot;outDAC&quot;
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|M_X_INDEX
comma
id|reg
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|M_X_DATAREG
comma
id|val
)paren
suffix:semicolon
)brace
DECL|function|inDAC
r_static
r_int
id|inDAC
c_func
(paren
id|CPMINFO
r_int
id|reg
)paren
(brace
id|DBG_REG
c_func
(paren
l_string|&quot;inDAC&quot;
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|M_X_INDEX
comma
id|reg
)paren
suffix:semicolon
r_return
id|mga_inb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|M_X_DATAREG
)paren
suffix:semicolon
)brace
DECL|macro|outTi3026
mdefine_line|#define outTi3026 outDAC
DECL|macro|inTi3026
mdefine_line|#define inTi3026 inDAC
DECL|macro|outDAC1064
mdefine_line|#define outDAC1064 outDAC
DECL|macro|inDAC1064
mdefine_line|#define inDAC1064 inDAC
DECL|function|matroxfb_createcursorshape
r_static
r_void
id|matroxfb_createcursorshape
c_func
(paren
id|WPMINFO
r_struct
id|display
op_star
id|p
comma
r_int
id|vmode
)paren
(brace
r_int
r_int
id|h
suffix:semicolon
r_int
r_int
id|cu
comma
id|cd
suffix:semicolon
id|h
op_assign
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
id|vmode
op_amp
id|FB_VMODE_DOUBLE
)paren
id|h
op_mul_assign
l_int|2
suffix:semicolon
id|cd
op_assign
id|h
suffix:semicolon
r_if
c_cond
(paren
id|cd
op_ge
l_int|10
)paren
id|cd
op_decrement
suffix:semicolon
r_switch
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|cursor.type
)paren
op_assign
(paren
id|p-&gt;conp-&gt;vc_cursor_type
op_amp
id|CUR_HWMASK
)paren
)paren
(brace
r_case
id|CUR_NONE
suffix:colon
id|cu
op_assign
id|cd
suffix:semicolon
r_break
suffix:semicolon
r_case
id|CUR_UNDERLINE
suffix:colon
id|cu
op_assign
id|cd
op_minus
l_int|2
suffix:semicolon
r_break
suffix:semicolon
r_case
id|CUR_LOWER_THIRD
suffix:colon
id|cu
op_assign
(paren
id|h
op_star
l_int|2
)paren
op_div
l_int|3
suffix:semicolon
r_break
suffix:semicolon
r_case
id|CUR_LOWER_HALF
suffix:colon
id|cu
op_assign
id|h
op_div
l_int|2
suffix:semicolon
r_break
suffix:semicolon
r_case
id|CUR_TWO_THIRDS
suffix:colon
id|cu
op_assign
id|h
op_div
l_int|3
suffix:semicolon
r_break
suffix:semicolon
r_case
id|CUR_BLOCK
suffix:colon
r_default
suffix:colon
id|cu
op_assign
l_int|0
suffix:semicolon
id|cd
op_assign
id|h
suffix:semicolon
r_break
suffix:semicolon
)brace
id|ACCESS_FBINFO
c_func
(paren
id|cursor.w
)paren
op_assign
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|cursor.u
)paren
op_assign
id|cu
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|cursor.d
)paren
op_assign
id|cd
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_FB_MATROX_MILLENIUM
DECL|macro|POS3026_XCURCTRL
mdefine_line|#define POS3026_XCURCTRL&t;20
DECL|function|matroxfb_ti3026_flashcursor
r_static
r_void
id|matroxfb_ti3026_flashcursor
c_func
(paren
r_int
r_int
id|ptr
)paren
(brace
DECL|macro|minfo
mdefine_line|#define minfo ((struct matrox_fb_info*)ptr)
id|spin_lock
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|lock.DAC
)paren
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XCURCTRL
comma
id|inTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XCURCTRL
)paren
op_xor
id|TVP3026_XCURCTRL_DIS
op_xor
id|TVP3026_XCURCTRL_XGA
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|cursor.timer.expires
)paren
op_assign
id|jiffies
op_plus
id|HZ
op_div
l_int|2
suffix:semicolon
id|add_timer
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|cursor.timer
)paren
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|lock.DAC
)paren
)paren
suffix:semicolon
DECL|macro|minfo
macro_line|#undef minfo
)brace
DECL|function|matroxfb_ti3026_createcursor
r_static
r_void
id|matroxfb_ti3026_createcursor
c_func
(paren
id|WPMINFO
r_struct
id|display
op_star
id|p
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
id|u_int32_t
id|xline
suffix:semicolon
r_int
r_int
id|i
suffix:semicolon
r_int
r_int
id|to
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|currcon_display
)paren
op_ne
id|p
)paren
r_return
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;matroxfb_ti3026_createcursor&quot;
)paren
suffix:semicolon
id|matroxfb_createcursorshape
c_func
(paren
id|PMINFO
id|p
comma
id|p-&gt;var.vmode
)paren
suffix:semicolon
id|xline
op_assign
(paren
op_complement
l_int|0
)paren
op_lshift
(paren
l_int|32
op_minus
id|ACCESS_FBINFO
c_func
(paren
id|cursor.w
)paren
)paren
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|lock.DAC
)paren
comma
id|flags
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|TVP3026_INDEX
comma
l_int|0
)paren
suffix:semicolon
id|to
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|cursor.u
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|to
suffix:semicolon
id|i
op_increment
)paren
(brace
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|TVP3026_CURRAMDATA
comma
l_int|0
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|TVP3026_CURRAMDATA
comma
l_int|0
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|TVP3026_CURRAMDATA
comma
l_int|0
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|TVP3026_CURRAMDATA
comma
l_int|0
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|TVP3026_CURRAMDATA
comma
l_int|0
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|TVP3026_CURRAMDATA
comma
l_int|0
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|TVP3026_CURRAMDATA
comma
l_int|0
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|TVP3026_CURRAMDATA
comma
l_int|0
)paren
suffix:semicolon
)brace
id|to
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|cursor.d
)paren
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
id|i
OL
id|to
suffix:semicolon
id|i
op_increment
)paren
(brace
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|TVP3026_CURRAMDATA
comma
id|xline
op_rshift
l_int|24
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|TVP3026_CURRAMDATA
comma
id|xline
op_rshift
l_int|16
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|TVP3026_CURRAMDATA
comma
id|xline
op_rshift
l_int|8
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|TVP3026_CURRAMDATA
comma
id|xline
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|TVP3026_CURRAMDATA
comma
l_int|0
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|TVP3026_CURRAMDATA
comma
l_int|0
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|TVP3026_CURRAMDATA
comma
l_int|0
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|TVP3026_CURRAMDATA
comma
l_int|0
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
suffix:semicolon
id|i
OL
l_int|64
suffix:semicolon
id|i
op_increment
)paren
(brace
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|TVP3026_CURRAMDATA
comma
l_int|0
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|TVP3026_CURRAMDATA
comma
l_int|0
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|TVP3026_CURRAMDATA
comma
l_int|0
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|TVP3026_CURRAMDATA
comma
l_int|0
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|TVP3026_CURRAMDATA
comma
l_int|0
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|TVP3026_CURRAMDATA
comma
l_int|0
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|TVP3026_CURRAMDATA
comma
l_int|0
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|TVP3026_CURRAMDATA
comma
l_int|0
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|512
suffix:semicolon
id|i
op_increment
)paren
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|TVP3026_CURRAMDATA
comma
l_int|0xFF
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|lock.DAC
)paren
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|matroxfb_ti3026_cursor
r_static
r_void
id|matroxfb_ti3026_cursor
c_func
(paren
r_struct
id|display
op_star
id|p
comma
r_int
id|mode
comma
r_int
id|x
comma
r_int
id|y
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
id|MINFO_FROM_DISP
c_func
(paren
id|p
)paren
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;matroxfb_ti3026_cursor&quot;
)paren
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|currcon_display
)paren
op_ne
id|p
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|mode
op_eq
id|CM_ERASE
)paren
(brace
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|cursor.state
)paren
op_ne
id|CM_ERASE
)paren
(brace
id|spin_lock_irqsave
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|lock.DAC
)paren
comma
id|flags
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|cursor.state
)paren
op_assign
id|CM_ERASE
suffix:semicolon
id|del_timer
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|cursor.timer
)paren
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XCURCTRL
comma
id|ACCESS_FBINFO
c_func
(paren
id|currenthw-&gt;DACreg
(braket
id|POS3026_XCURCTRL
)braket
)paren
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|lock.DAC
)paren
comma
id|flags
)paren
suffix:semicolon
)brace
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|p-&gt;conp-&gt;vc_cursor_type
op_amp
id|CUR_HWMASK
)paren
op_ne
id|ACCESS_FBINFO
c_func
(paren
id|cursor.type
)paren
)paren
id|matroxfb_ti3026_createcursor
c_func
(paren
id|PMINFO
id|p
)paren
suffix:semicolon
id|x
op_mul_assign
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
id|y
op_mul_assign
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|y
op_sub_assign
id|p-&gt;var.yoffset
suffix:semicolon
r_if
c_cond
(paren
id|p-&gt;var.vmode
op_amp
id|FB_VMODE_DOUBLE
)paren
id|y
op_mul_assign
l_int|2
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|lock.DAC
)paren
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|x
op_ne
id|ACCESS_FBINFO
c_func
(paren
id|cursor.x
)paren
)paren
op_logical_or
(paren
id|y
op_ne
id|ACCESS_FBINFO
c_func
(paren
id|cursor.y
)paren
)paren
op_logical_or
id|ACCESS_FBINFO
c_func
(paren
id|cursor.redraw
)paren
)paren
(brace
id|ACCESS_FBINFO
c_func
(paren
id|cursor.redraw
)paren
op_assign
l_int|0
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|cursor.x
)paren
op_assign
id|x
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|cursor.y
)paren
op_assign
id|y
suffix:semicolon
id|x
op_add_assign
l_int|64
suffix:semicolon
id|y
op_add_assign
l_int|64
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XCURCTRL
comma
id|ACCESS_FBINFO
c_func
(paren
id|currenthw-&gt;DACreg
(braket
id|POS3026_XCURCTRL
)braket
)paren
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|TVP3026_CURPOSXL
comma
id|x
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|TVP3026_CURPOSXH
comma
id|x
op_rshift
l_int|8
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|TVP3026_CURPOSYL
comma
id|y
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|TVP3026_CURPOSYH
comma
id|y
op_rshift
l_int|8
)paren
suffix:semicolon
)brace
id|ACCESS_FBINFO
c_func
(paren
id|cursor.state
)paren
op_assign
id|CM_DRAW
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.blink
)paren
)paren
id|mod_timer
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|cursor.timer
)paren
comma
id|jiffies
op_plus
id|HZ
op_div
l_int|2
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XCURCTRL
comma
id|ACCESS_FBINFO
c_func
(paren
id|currenthw-&gt;DACreg
(braket
id|POS3026_XCURCTRL
)braket
)paren
op_or
id|TVP3026_XCURCTRL_XGA
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|lock.DAC
)paren
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|macro|POS3026_XCURCTRL
macro_line|#undef POS3026_XCURCTRL
DECL|function|matroxfb_ti3026_setfont
r_static
r_int
id|matroxfb_ti3026_setfont
c_func
(paren
r_struct
id|display
op_star
id|p
comma
r_int
id|width
comma
r_int
id|height
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;matrox_ti3026_setfont&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|p
op_logical_and
id|p-&gt;conp
)paren
id|matroxfb_ti3026_createcursor
c_func
(paren
id|PMXINFO
c_func
(paren
id|p
)paren
id|p
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif
macro_line|#ifdef NEED_DAC1064
DECL|function|matroxfb_DAC1064_flashcursor
r_static
r_void
id|matroxfb_DAC1064_flashcursor
c_func
(paren
r_int
r_int
id|ptr
)paren
(brace
DECL|macro|minfo
mdefine_line|#define minfo ((struct matrox_fb_info*)ptr)
id|spin_lock
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|lock.DAC
)paren
)paren
suffix:semicolon
id|outDAC1064
c_func
(paren
id|PMINFO
id|M1064_XCURCTRL
comma
id|inDAC1064
c_func
(paren
id|PMINFO
id|M1064_XCURCTRL
)paren
op_xor
id|M1064_XCURCTRL_DIS
op_xor
id|M1064_XCURCTRL_XGA
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|cursor.timer.expires
)paren
op_assign
id|jiffies
op_plus
id|HZ
op_div
l_int|2
suffix:semicolon
id|add_timer
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|cursor.timer
)paren
)paren
suffix:semicolon
id|spin_unlock
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|lock.DAC
)paren
)paren
suffix:semicolon
DECL|macro|minfo
macro_line|#undef minfo
)brace
DECL|function|matroxfb_DAC1064_createcursor
r_static
r_void
id|matroxfb_DAC1064_createcursor
c_func
(paren
id|WPMINFO
r_struct
id|display
op_star
id|p
)paren
(brace
id|vaddr_t
id|cursorbase
suffix:semicolon
id|u_int32_t
id|xline
suffix:semicolon
r_int
r_int
id|i
suffix:semicolon
r_int
r_int
id|h
comma
id|to
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|currcon_display
)paren
op_ne
id|p
)paren
r_return
suffix:semicolon
id|matroxfb_createcursorshape
c_func
(paren
id|PMINFO
id|p
comma
id|p-&gt;var.vmode
)paren
suffix:semicolon
id|xline
op_assign
(paren
op_complement
l_int|0
)paren
op_lshift
(paren
l_int|32
op_minus
id|ACCESS_FBINFO
c_func
(paren
id|cursor.w
)paren
)paren
suffix:semicolon
id|cursorbase
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
suffix:semicolon
id|h
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|features.DAC1064.cursorimage
)paren
suffix:semicolon
id|CRITBEGIN
macro_line|#ifdef __BIG_ENDIAN
id|WaitTillIdle
c_func
(paren
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_OPMODE
comma
id|M_OPMODE_32BPP
)paren
suffix:semicolon
macro_line|#endif
id|to
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|cursor.u
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|to
suffix:semicolon
id|i
op_increment
)paren
(brace
id|mga_writel
c_func
(paren
id|cursorbase
comma
id|h
comma
l_int|0
)paren
suffix:semicolon
id|mga_writel
c_func
(paren
id|cursorbase
comma
id|h
op_plus
l_int|4
comma
l_int|0
)paren
suffix:semicolon
id|mga_writel
c_func
(paren
id|cursorbase
comma
id|h
op_plus
l_int|8
comma
op_complement
l_int|0
)paren
suffix:semicolon
id|mga_writel
c_func
(paren
id|cursorbase
comma
id|h
op_plus
l_int|12
comma
op_complement
l_int|0
)paren
suffix:semicolon
id|h
op_add_assign
l_int|16
suffix:semicolon
)brace
id|to
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|cursor.d
)paren
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
id|i
OL
id|to
suffix:semicolon
id|i
op_increment
)paren
(brace
id|mga_writel
c_func
(paren
id|cursorbase
comma
id|h
comma
l_int|0
)paren
suffix:semicolon
id|mga_writel
c_func
(paren
id|cursorbase
comma
id|h
op_plus
l_int|4
comma
id|xline
)paren
suffix:semicolon
id|mga_writel
c_func
(paren
id|cursorbase
comma
id|h
op_plus
l_int|8
comma
op_complement
l_int|0
)paren
suffix:semicolon
id|mga_writel
c_func
(paren
id|cursorbase
comma
id|h
op_plus
l_int|12
comma
op_complement
l_int|0
)paren
suffix:semicolon
id|h
op_add_assign
l_int|16
suffix:semicolon
)brace
r_for
c_loop
(paren
suffix:semicolon
id|i
OL
l_int|64
suffix:semicolon
id|i
op_increment
)paren
(brace
id|mga_writel
c_func
(paren
id|cursorbase
comma
id|h
comma
l_int|0
)paren
suffix:semicolon
id|mga_writel
c_func
(paren
id|cursorbase
comma
id|h
op_plus
l_int|4
comma
l_int|0
)paren
suffix:semicolon
id|mga_writel
c_func
(paren
id|cursorbase
comma
id|h
op_plus
l_int|8
comma
op_complement
l_int|0
)paren
suffix:semicolon
id|mga_writel
c_func
(paren
id|cursorbase
comma
id|h
op_plus
l_int|12
comma
op_complement
l_int|0
)paren
suffix:semicolon
id|h
op_add_assign
l_int|16
suffix:semicolon
)brace
macro_line|#ifdef __BIG_ENDIAN
id|mga_outl
c_func
(paren
id|M_OPMODE
comma
id|ACCESS_FBINFO
c_func
(paren
id|accel.m_opmode
)paren
)paren
suffix:semicolon
macro_line|#endif
id|CRITEND
)brace
DECL|function|matroxfb_DAC1064_cursor
r_static
r_void
id|matroxfb_DAC1064_cursor
c_func
(paren
r_struct
id|display
op_star
id|p
comma
r_int
id|mode
comma
r_int
id|x
comma
r_int
id|y
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
id|MINFO_FROM_DISP
c_func
(paren
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|currcon_display
)paren
op_ne
id|p
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|mode
op_eq
id|CM_ERASE
)paren
(brace
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|cursor.state
)paren
op_ne
id|CM_ERASE
)paren
(brace
id|spin_lock_irqsave
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|lock.DAC
)paren
comma
id|flags
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|cursor.state
)paren
op_assign
id|CM_ERASE
suffix:semicolon
id|del_timer
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|cursor.timer
)paren
)paren
suffix:semicolon
id|outDAC1064
c_func
(paren
id|PMINFO
id|M1064_XCURCTRL
comma
id|M1064_XCURCTRL_DIS
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|lock.DAC
)paren
comma
id|flags
)paren
suffix:semicolon
)brace
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|p-&gt;conp-&gt;vc_cursor_type
op_amp
id|CUR_HWMASK
)paren
op_ne
id|ACCESS_FBINFO
c_func
(paren
id|cursor.type
)paren
)paren
id|matroxfb_DAC1064_createcursor
c_func
(paren
id|PMINFO
id|p
)paren
suffix:semicolon
id|x
op_mul_assign
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
id|y
op_mul_assign
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|y
op_sub_assign
id|p-&gt;var.yoffset
suffix:semicolon
r_if
c_cond
(paren
id|p-&gt;var.vmode
op_amp
id|FB_VMODE_DOUBLE
)paren
id|y
op_mul_assign
l_int|2
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|lock.DAC
)paren
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|x
op_ne
id|ACCESS_FBINFO
c_func
(paren
id|cursor.x
)paren
)paren
op_logical_or
(paren
id|y
op_ne
id|ACCESS_FBINFO
c_func
(paren
id|cursor.y
)paren
)paren
op_logical_or
id|ACCESS_FBINFO
c_func
(paren
id|cursor.redraw
)paren
)paren
(brace
id|ACCESS_FBINFO
c_func
(paren
id|cursor.redraw
)paren
op_assign
l_int|0
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|cursor.x
)paren
op_assign
id|x
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|cursor.y
)paren
op_assign
id|y
suffix:semicolon
id|x
op_add_assign
l_int|64
suffix:semicolon
id|y
op_add_assign
l_int|64
suffix:semicolon
id|outDAC1064
c_func
(paren
id|PMINFO
id|M1064_XCURCTRL
comma
id|M1064_XCURCTRL_DIS
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|M1064_CURPOSXL
comma
id|x
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|M1064_CURPOSXH
comma
id|x
op_rshift
l_int|8
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|M1064_CURPOSYL
comma
id|y
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|M1064_CURPOSYH
comma
id|y
op_rshift
l_int|8
)paren
suffix:semicolon
)brace
id|ACCESS_FBINFO
c_func
(paren
id|cursor.state
)paren
op_assign
id|CM_DRAW
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.blink
)paren
)paren
id|mod_timer
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|cursor.timer
)paren
comma
id|jiffies
op_plus
id|HZ
op_div
l_int|2
)paren
suffix:semicolon
id|outDAC1064
c_func
(paren
id|PMINFO
id|M1064_XCURCTRL
comma
id|M1064_XCURCTRL_XGA
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|lock.DAC
)paren
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|matroxfb_DAC1064_setfont
r_static
r_int
id|matroxfb_DAC1064_setfont
c_func
(paren
r_struct
id|display
op_star
id|p
comma
r_int
id|width
comma
r_int
id|height
)paren
(brace
r_if
c_cond
(paren
id|p
op_logical_and
id|p-&gt;conp
)paren
id|matroxfb_DAC1064_createcursor
c_func
(paren
id|PMXINFO
c_func
(paren
id|p
)paren
id|p
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif
macro_line|#ifndef FNTCHARCNT
DECL|macro|FNTCHARCNT
mdefine_line|#define FNTCHARCNT(fd)&t;(((int *)(fd))[-3])
macro_line|#endif
DECL|function|matroxfb_fastfont_tryset
r_static
r_int
id|matroxfb_fastfont_tryset
c_func
(paren
id|WPMINFO
r_struct
id|display
op_star
id|p
)paren
(brace
r_int
r_int
id|fsize
suffix:semicolon
r_int
r_int
id|width
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|p
op_logical_or
op_logical_neg
id|p-&gt;fontdata
)paren
r_return
l_int|0
suffix:semicolon
id|width
op_assign
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
id|width
OG
l_int|32
)paren
r_return
l_int|0
suffix:semicolon
id|fsize
op_assign
(paren
id|p-&gt;userfont
ques
c_cond
id|FNTCHARCNT
c_func
(paren
id|p-&gt;fontdata
)paren
suffix:colon
l_int|256
)paren
op_star
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
id|fsize
op_star
id|width
op_plus
l_int|31
)paren
op_div
l_int|32
)paren
op_star
l_int|4
OG
id|ACCESS_FBINFO
c_func
(paren
id|fastfont.size
)paren
)paren
r_return
l_int|0
suffix:semicolon
id|CRITBEGIN
id|mga_outl
c_func
(paren
id|M_OPMODE
comma
id|M_OPMODE_8BPP
)paren
suffix:semicolon
r_if
c_cond
(paren
id|width
op_le
l_int|8
)paren
(brace
r_if
c_cond
(paren
id|width
op_eq
l_int|8
)paren
id|mga_memcpy_toio
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|fastfont.vbase
)paren
comma
l_int|0
comma
id|p-&gt;fontdata
comma
id|fsize
)paren
suffix:semicolon
r_else
(brace
id|vaddr_t
id|dst
suffix:semicolon
r_int
r_int
id|i
suffix:semicolon
id|u_int8_t
op_star
id|font
suffix:semicolon
id|u_int32_t
id|mask
comma
id|valid
comma
id|reg
suffix:semicolon
id|dst
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|fastfont.vbase
)paren
suffix:semicolon
id|font
op_assign
(paren
id|u_int8_t
op_star
)paren
id|p-&gt;fontdata
suffix:semicolon
id|mask
op_assign
op_complement
l_int|0
op_lshift
(paren
l_int|8
op_minus
id|width
)paren
suffix:semicolon
id|valid
op_assign
l_int|0
suffix:semicolon
id|reg
op_assign
l_int|0
suffix:semicolon
id|i
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|fsize
op_decrement
)paren
(brace
id|reg
op_or_assign
(paren
op_star
id|font
op_increment
op_amp
id|mask
)paren
op_lshift
(paren
l_int|8
op_minus
id|valid
)paren
suffix:semicolon
id|valid
op_add_assign
id|width
suffix:semicolon
r_if
c_cond
(paren
id|valid
op_ge
l_int|8
)paren
(brace
id|mga_writeb
c_func
(paren
id|dst
comma
id|i
op_increment
comma
id|reg
op_rshift
l_int|8
)paren
suffix:semicolon
id|reg
op_assign
id|reg
op_lshift
l_int|8
suffix:semicolon
id|valid
op_sub_assign
l_int|8
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|valid
)paren
id|mga_writeb
c_func
(paren
id|dst
comma
id|i
comma
id|reg
op_rshift
l_int|8
)paren
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|width
op_le
l_int|16
)paren
(brace
r_if
c_cond
(paren
id|width
op_eq
l_int|16
)paren
id|mga_memcpy_toio
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|fastfont.vbase
)paren
comma
l_int|0
comma
id|p-&gt;fontdata
comma
id|fsize
op_star
l_int|2
)paren
suffix:semicolon
r_else
(brace
id|vaddr_t
id|dst
suffix:semicolon
id|u_int16_t
op_star
id|font
suffix:semicolon
id|u_int32_t
id|mask
comma
id|valid
comma
id|reg
suffix:semicolon
r_int
r_int
id|i
suffix:semicolon
id|dst
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|fastfont.vbase
)paren
suffix:semicolon
id|font
op_assign
(paren
id|u_int16_t
op_star
)paren
id|p-&gt;fontdata
suffix:semicolon
id|mask
op_assign
op_complement
l_int|0
op_lshift
(paren
l_int|16
op_minus
id|width
)paren
suffix:semicolon
id|valid
op_assign
l_int|0
suffix:semicolon
id|reg
op_assign
l_int|0
suffix:semicolon
id|i
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|fsize
op_decrement
)paren
(brace
id|reg
op_or_assign
(paren
id|ntohs
c_func
(paren
op_star
id|font
op_increment
)paren
op_amp
id|mask
)paren
op_lshift
(paren
l_int|16
op_minus
id|valid
)paren
suffix:semicolon
id|valid
op_add_assign
id|width
suffix:semicolon
r_if
c_cond
(paren
id|valid
op_ge
l_int|16
)paren
(brace
id|mga_writew
c_func
(paren
id|dst
comma
id|i
comma
id|htons
c_func
(paren
id|reg
op_rshift
l_int|16
)paren
)paren
suffix:semicolon
id|i
op_add_assign
l_int|2
suffix:semicolon
id|reg
op_assign
id|reg
op_lshift
l_int|16
suffix:semicolon
id|valid
op_sub_assign
l_int|16
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|valid
)paren
id|mga_writew
c_func
(paren
id|dst
comma
id|i
comma
id|htons
c_func
(paren
id|reg
op_rshift
l_int|16
)paren
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|width
op_eq
l_int|32
)paren
id|mga_memcpy_toio
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|fastfont.vbase
)paren
comma
l_int|0
comma
id|p-&gt;fontdata
comma
id|fsize
op_star
l_int|4
)paren
suffix:semicolon
r_else
(brace
id|vaddr_t
id|dst
suffix:semicolon
id|u_int32_t
op_star
id|font
suffix:semicolon
id|u_int32_t
id|mask
comma
id|valid
comma
id|reg
suffix:semicolon
r_int
r_int
id|i
suffix:semicolon
id|dst
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|fastfont.vbase
)paren
suffix:semicolon
id|font
op_assign
(paren
id|u_int32_t
op_star
)paren
id|p-&gt;fontdata
suffix:semicolon
id|mask
op_assign
op_complement
l_int|0
op_lshift
(paren
l_int|32
op_minus
id|width
)paren
suffix:semicolon
id|valid
op_assign
l_int|0
suffix:semicolon
id|reg
op_assign
l_int|0
suffix:semicolon
id|i
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|fsize
op_decrement
)paren
(brace
id|reg
op_or_assign
(paren
id|ntohl
c_func
(paren
op_star
id|font
)paren
op_amp
id|mask
)paren
op_rshift
id|valid
suffix:semicolon
id|valid
op_add_assign
id|width
suffix:semicolon
r_if
c_cond
(paren
id|valid
op_ge
l_int|32
)paren
(brace
id|mga_writel
c_func
(paren
id|dst
comma
id|i
comma
id|htonl
c_func
(paren
id|reg
)paren
)paren
suffix:semicolon
id|i
op_add_assign
l_int|4
suffix:semicolon
id|valid
op_sub_assign
l_int|32
suffix:semicolon
r_if
c_cond
(paren
id|valid
)paren
id|reg
op_assign
(paren
id|ntohl
c_func
(paren
op_star
id|font
)paren
op_amp
id|mask
)paren
op_lshift
(paren
id|width
op_minus
id|valid
)paren
suffix:semicolon
r_else
id|reg
op_assign
l_int|0
suffix:semicolon
)brace
id|font
op_increment
suffix:semicolon
)brace
r_if
c_cond
(paren
id|valid
)paren
id|mga_writel
c_func
(paren
id|dst
comma
id|i
comma
id|htonl
c_func
(paren
id|reg
)paren
)paren
suffix:semicolon
)brace
)brace
id|mga_outl
c_func
(paren
id|M_OPMODE
comma
id|ACCESS_FBINFO
c_func
(paren
id|accel.m_opmode
)paren
)paren
suffix:semicolon
id|CRITEND
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|matrox_text_setup
r_static
r_void
id|matrox_text_setup
c_func
(paren
r_struct
id|display
op_star
id|p
)paren
(brace
id|MINFO_FROM_DISP
c_func
(paren
id|p
)paren
suffix:semicolon
id|p-&gt;next_line
op_assign
id|p-&gt;line_length
ques
c_cond
id|p-&gt;line_length
suffix:colon
(paren
(paren
id|p-&gt;var.xres_virtual
op_div
(paren
id|fontwidth
c_func
(paren
id|p
)paren
ques
c_cond
id|fontwidth
c_func
(paren
id|p
)paren
suffix:colon
l_int|8
)paren
)paren
op_star
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textstep
)paren
)paren
suffix:semicolon
id|p-&gt;next_plane
op_assign
l_int|0
suffix:semicolon
)brace
DECL|function|matrox_text_bmove
r_static
r_void
id|matrox_text_bmove
c_func
(paren
r_struct
id|display
op_star
id|p
comma
r_int
id|sy
comma
r_int
id|sx
comma
r_int
id|dy
comma
r_int
id|dx
comma
r_int
id|height
comma
r_int
id|width
)paren
(brace
r_int
r_int
id|srcoff
suffix:semicolon
r_int
r_int
id|dstoff
suffix:semicolon
r_int
r_int
id|step
suffix:semicolon
id|MINFO_FROM_DISP
c_func
(paren
id|p
)paren
suffix:semicolon
id|CRITBEGIN
id|step
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textstep
)paren
suffix:semicolon
id|srcoff
op_assign
(paren
id|sy
op_star
id|p-&gt;next_line
)paren
op_plus
(paren
id|sx
op_star
id|step
)paren
suffix:semicolon
id|dstoff
op_assign
(paren
id|dy
op_star
id|p-&gt;next_line
)paren
op_plus
(paren
id|dx
op_star
id|step
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dstoff
OL
id|srcoff
)paren
(brace
r_while
c_loop
(paren
id|height
OG
l_int|0
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
id|width
suffix:semicolon
id|i
OG
l_int|0
suffix:semicolon
id|dstoff
op_add_assign
id|step
comma
id|srcoff
op_add_assign
id|step
comma
id|i
op_decrement
)paren
id|mga_writew
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
comma
id|dstoff
comma
id|mga_readw
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
comma
id|srcoff
)paren
)paren
suffix:semicolon
id|height
op_decrement
suffix:semicolon
id|dstoff
op_add_assign
id|p-&gt;next_line
op_minus
id|width
op_star
id|step
suffix:semicolon
id|srcoff
op_add_assign
id|p-&gt;next_line
op_minus
id|width
op_star
id|step
suffix:semicolon
)brace
)brace
r_else
(brace
r_int
r_int
id|off
suffix:semicolon
id|off
op_assign
(paren
id|height
op_minus
l_int|1
)paren
op_star
id|p-&gt;next_line
op_plus
(paren
id|width
op_minus
l_int|1
)paren
op_star
id|step
suffix:semicolon
id|srcoff
op_add_assign
id|off
suffix:semicolon
id|dstoff
op_add_assign
id|off
suffix:semicolon
r_while
c_loop
(paren
id|height
OG
l_int|0
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
id|width
suffix:semicolon
id|i
OG
l_int|0
suffix:semicolon
id|dstoff
op_sub_assign
id|step
comma
id|srcoff
op_sub_assign
id|step
comma
id|i
op_decrement
)paren
id|mga_writew
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
comma
id|dstoff
comma
id|mga_readw
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
comma
id|srcoff
)paren
)paren
suffix:semicolon
id|dstoff
op_sub_assign
id|p-&gt;next_line
op_minus
id|width
op_star
id|step
suffix:semicolon
id|srcoff
op_sub_assign
id|p-&gt;next_line
op_minus
id|width
op_star
id|step
suffix:semicolon
id|height
op_decrement
suffix:semicolon
)brace
)brace
id|CRITEND
)brace
DECL|function|matrox_text_clear
r_static
r_void
id|matrox_text_clear
c_func
(paren
r_struct
id|vc_data
op_star
id|conp
comma
r_struct
id|display
op_star
id|p
comma
r_int
id|sy
comma
r_int
id|sx
comma
r_int
id|height
comma
r_int
id|width
)paren
(brace
r_int
r_int
id|offs
suffix:semicolon
r_int
r_int
id|val
suffix:semicolon
r_int
r_int
id|step
suffix:semicolon
id|MINFO_FROM_DISP
c_func
(paren
id|p
)paren
suffix:semicolon
id|step
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textstep
)paren
suffix:semicolon
id|offs
op_assign
id|sy
op_star
id|p-&gt;next_line
op_plus
id|sx
op_star
id|step
suffix:semicolon
id|val
op_assign
id|ntohs
c_func
(paren
(paren
id|attr_bgcol
c_func
(paren
id|p
comma
id|conp-&gt;vc_video_erase_char
)paren
op_lshift
l_int|4
)paren
op_or
id|attr_fgcol
c_func
(paren
id|p
comma
id|conp-&gt;vc_video_erase_char
)paren
op_or
(paren
l_char|&squot; &squot;
op_lshift
l_int|8
)paren
)paren
suffix:semicolon
id|CRITBEGIN
r_while
c_loop
(paren
id|height
OG
l_int|0
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
id|width
suffix:semicolon
id|i
OG
l_int|0
suffix:semicolon
id|offs
op_add_assign
id|step
comma
id|i
op_decrement
)paren
id|mga_writew
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
comma
id|offs
comma
id|val
)paren
suffix:semicolon
id|offs
op_add_assign
id|p-&gt;next_line
op_minus
id|width
op_star
id|step
suffix:semicolon
id|height
op_decrement
suffix:semicolon
)brace
id|CRITEND
)brace
DECL|function|matrox_text_putc
r_static
r_void
id|matrox_text_putc
c_func
(paren
r_struct
id|vc_data
op_star
id|conp
comma
r_struct
id|display
op_star
id|p
comma
r_int
id|c
comma
r_int
id|yy
comma
r_int
id|xx
)paren
(brace
r_int
r_int
id|offs
suffix:semicolon
r_int
r_int
id|chr
suffix:semicolon
r_int
r_int
id|step
suffix:semicolon
id|MINFO_FROM_DISP
c_func
(paren
id|p
)paren
suffix:semicolon
id|step
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textstep
)paren
suffix:semicolon
id|offs
op_assign
id|yy
op_star
id|p-&gt;next_line
op_plus
id|xx
op_star
id|step
suffix:semicolon
id|chr
op_assign
id|attr_fgcol
c_func
(paren
id|p
comma
id|c
)paren
op_or
(paren
id|attr_bgcol
c_func
(paren
id|p
comma
id|c
)paren
op_lshift
l_int|4
)paren
op_or
(paren
(paren
id|c
op_amp
id|p-&gt;charmask
)paren
op_lshift
l_int|8
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chr
op_amp
l_int|0x10000
)paren
id|chr
op_or_assign
l_int|0x08
suffix:semicolon
id|CRITBEGIN
id|mga_writew
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
comma
id|offs
comma
id|ntohs
c_func
(paren
id|chr
)paren
)paren
suffix:semicolon
id|CRITEND
)brace
DECL|function|matrox_text_putcs
r_static
r_void
id|matrox_text_putcs
c_func
(paren
r_struct
id|vc_data
op_star
id|conp
comma
r_struct
id|display
op_star
id|p
comma
r_const
r_int
r_int
op_star
id|s
comma
r_int
id|count
comma
r_int
id|yy
comma
r_int
id|xx
)paren
(brace
r_int
r_int
id|offs
suffix:semicolon
r_int
r_int
id|attr
suffix:semicolon
r_int
r_int
id|step
suffix:semicolon
id|MINFO_FROM_DISP
c_func
(paren
id|p
)paren
suffix:semicolon
id|step
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textstep
)paren
suffix:semicolon
id|offs
op_assign
id|yy
op_star
id|p-&gt;next_line
op_plus
id|xx
op_star
id|step
suffix:semicolon
id|attr
op_assign
id|attr_fgcol
c_func
(paren
id|p
comma
id|scr_readw
c_func
(paren
id|s
)paren
)paren
op_or
(paren
id|attr_bgcol
c_func
(paren
id|p
comma
id|scr_readw
c_func
(paren
id|s
)paren
)paren
op_lshift
l_int|4
)paren
suffix:semicolon
id|CRITBEGIN
r_while
c_loop
(paren
id|count
op_decrement
OG
l_int|0
)paren
(brace
r_int
r_int
id|chr
op_assign
(paren
(paren
id|scr_readw
c_func
(paren
id|s
op_increment
)paren
)paren
op_amp
id|p-&gt;charmask
)paren
op_lshift
l_int|8
suffix:semicolon
r_if
c_cond
(paren
id|chr
op_amp
l_int|0x10000
)paren
id|chr
op_xor_assign
l_int|0x10008
suffix:semicolon
id|mga_writew
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
comma
id|offs
comma
id|ntohs
c_func
(paren
id|attr
op_or
id|chr
)paren
)paren
suffix:semicolon
id|offs
op_add_assign
id|step
suffix:semicolon
)brace
id|CRITEND
)brace
DECL|function|matrox_text_revc
r_static
r_void
id|matrox_text_revc
c_func
(paren
r_struct
id|display
op_star
id|p
comma
r_int
id|xx
comma
r_int
id|yy
)paren
(brace
r_int
r_int
id|offs
suffix:semicolon
r_int
r_int
id|step
suffix:semicolon
id|MINFO_FROM_DISP
c_func
(paren
id|p
)paren
suffix:semicolon
id|step
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textstep
)paren
suffix:semicolon
id|offs
op_assign
id|yy
op_star
id|p-&gt;next_line
op_plus
id|xx
op_star
id|step
op_plus
l_int|1
suffix:semicolon
id|CRITBEGIN
id|mga_writeb
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
comma
id|offs
comma
id|mga_readb
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
comma
id|offs
)paren
op_xor
l_int|0x77
)paren
suffix:semicolon
id|CRITEND
)brace
DECL|function|matrox_text_loadfont
r_static
r_int
id|matrox_text_loadfont
c_func
(paren
id|WPMINFO
r_struct
id|display
op_star
id|p
)paren
(brace
r_int
r_int
id|fsize
suffix:semicolon
r_int
r_int
id|width
suffix:semicolon
id|vaddr_t
id|dst
suffix:semicolon
r_int
r_int
id|i
suffix:semicolon
id|u_int8_t
op_star
id|font
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|p
op_logical_or
op_logical_neg
id|p-&gt;fontdata
)paren
r_return
l_int|0
suffix:semicolon
id|width
op_assign
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
id|fsize
op_assign
id|p-&gt;userfont
ques
c_cond
id|FNTCHARCNT
c_func
(paren
id|p-&gt;fontdata
)paren
suffix:colon
l_int|256
suffix:semicolon
id|dst
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
suffix:semicolon
id|i
op_assign
l_int|2
suffix:semicolon
id|font
op_assign
(paren
id|u_int8_t
op_star
)paren
id|p-&gt;fontdata
suffix:semicolon
id|CRITBEGIN
id|mga_setr
c_func
(paren
id|M_SEQ_INDEX
comma
l_int|0x02
comma
l_int|0x04
)paren
suffix:semicolon
r_while
c_loop
(paren
id|fsize
op_decrement
)paren
(brace
r_int
id|l
suffix:semicolon
r_for
c_loop
(paren
id|l
op_assign
l_int|0
suffix:semicolon
id|l
OL
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|l
op_increment
)paren
(brace
id|mga_writeb
c_func
(paren
id|dst
comma
id|i
comma
op_star
id|font
op_increment
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fontwidth
c_func
(paren
id|p
)paren
OG
l_int|8
)paren
id|font
op_increment
suffix:semicolon
id|i
op_add_assign
id|ACCESS_FBINFO
c_func
(paren
id|devflags.vgastep
)paren
suffix:semicolon
)brace
id|i
op_add_assign
(paren
l_int|32
op_minus
id|fontheight
c_func
(paren
id|p
)paren
)paren
op_star
id|ACCESS_FBINFO
c_func
(paren
id|devflags.vgastep
)paren
suffix:semicolon
)brace
id|mga_setr
c_func
(paren
id|M_SEQ_INDEX
comma
l_int|0x02
comma
l_int|0x03
)paren
suffix:semicolon
id|CRITEND
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|matrox_text_createcursor
r_static
r_void
id|matrox_text_createcursor
c_func
(paren
id|WPMINFO
r_struct
id|display
op_star
id|p
)paren
(brace
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|currcon_display
)paren
op_ne
id|p
)paren
r_return
suffix:semicolon
id|matroxfb_createcursorshape
c_func
(paren
id|PMINFO
id|p
comma
l_int|0
)paren
suffix:semicolon
id|CRITBEGIN
id|mga_setr
c_func
(paren
id|M_CRTC_INDEX
comma
l_int|0x0A
comma
id|ACCESS_FBINFO
c_func
(paren
id|cursor.u
)paren
)paren
suffix:semicolon
id|mga_setr
c_func
(paren
id|M_CRTC_INDEX
comma
l_int|0x0B
comma
id|ACCESS_FBINFO
c_func
(paren
id|cursor.d
)paren
op_minus
l_int|1
)paren
suffix:semicolon
id|CRITEND
)brace
DECL|function|matrox_text_cursor
r_static
r_void
id|matrox_text_cursor
c_func
(paren
r_struct
id|display
op_star
id|p
comma
r_int
id|mode
comma
r_int
id|x
comma
r_int
id|y
)paren
(brace
r_int
r_int
id|pos
suffix:semicolon
id|MINFO_FROM_DISP
c_func
(paren
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|currcon_display
)paren
op_ne
id|p
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|mode
op_eq
id|CM_ERASE
)paren
(brace
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|cursor.state
)paren
op_ne
id|CM_ERASE
)paren
(brace
id|CRITBEGIN
id|mga_setr
c_func
(paren
id|M_CRTC_INDEX
comma
l_int|0x0A
comma
l_int|0x20
)paren
suffix:semicolon
id|CRITEND
id|ACCESS_FBINFO
c_func
(paren
id|cursor.state
)paren
op_assign
id|CM_ERASE
suffix:semicolon
)brace
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|p-&gt;conp-&gt;vc_cursor_type
op_amp
id|CUR_HWMASK
)paren
op_ne
id|ACCESS_FBINFO
c_func
(paren
id|cursor.type
)paren
)paren
id|matrox_text_createcursor
c_func
(paren
id|PMINFO
id|p
)paren
suffix:semicolon
multiline_comment|/* DO NOT CHECK cursor.x != x because of vgaHWinit moves cursor to 0,0 */
id|ACCESS_FBINFO
c_func
(paren
id|cursor.x
)paren
op_assign
id|x
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|cursor.y
)paren
op_assign
id|y
suffix:semicolon
id|pos
op_assign
id|p-&gt;next_line
op_div
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textstep
)paren
op_star
id|y
op_plus
id|x
suffix:semicolon
id|CRITBEGIN
id|mga_setr
c_func
(paren
id|M_CRTC_INDEX
comma
l_int|0x0F
comma
id|pos
)paren
suffix:semicolon
id|mga_setr
c_func
(paren
id|M_CRTC_INDEX
comma
l_int|0x0E
comma
id|pos
op_rshift
l_int|8
)paren
suffix:semicolon
id|mga_setr
c_func
(paren
id|M_CRTC_INDEX
comma
l_int|0x0A
comma
id|ACCESS_FBINFO
c_func
(paren
id|cursor.u
)paren
)paren
suffix:semicolon
id|CRITEND
id|ACCESS_FBINFO
c_func
(paren
id|cursor.state
)paren
op_assign
id|CM_DRAW
suffix:semicolon
)brace
DECL|function|matrox_text_round
r_static
r_void
id|matrox_text_round
c_func
(paren
id|CPMINFO
r_struct
id|fb_var_screeninfo
op_star
id|var
comma
r_struct
id|display
op_star
id|p
)paren
(brace
r_int
id|hf
suffix:semicolon
r_int
id|vf
suffix:semicolon
r_int
id|vxres
suffix:semicolon
r_int
id|ych
suffix:semicolon
id|hf
op_assign
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|hf
)paren
id|hf
op_assign
l_int|8
suffix:semicolon
multiline_comment|/* do not touch xres */
id|vxres
op_assign
(paren
id|var-&gt;xres_virtual
op_plus
id|hf
op_minus
l_int|1
)paren
op_div
id|hf
suffix:semicolon
r_if
c_cond
(paren
id|vxres
op_ge
l_int|256
)paren
id|vxres
op_assign
l_int|255
suffix:semicolon
r_if
c_cond
(paren
id|vxres
OL
l_int|16
)paren
id|vxres
op_assign
l_int|16
suffix:semicolon
id|vxres
op_assign
(paren
id|vxres
op_plus
l_int|1
)paren
op_amp
op_complement
l_int|1
suffix:semicolon
multiline_comment|/* must be even */
id|vf
op_assign
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|vf
)paren
id|vf
op_assign
l_int|16
suffix:semicolon
r_if
c_cond
(paren
id|var-&gt;yres
OL
id|var-&gt;yres_virtual
)paren
(brace
id|ych
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textvram
)paren
op_div
id|vxres
suffix:semicolon
id|var-&gt;yres_virtual
op_assign
id|ych
op_star
id|vf
suffix:semicolon
)brace
r_else
id|ych
op_assign
id|var-&gt;yres_virtual
op_div
id|vf
suffix:semicolon
r_if
c_cond
(paren
id|vxres
op_star
id|ych
OG
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textvram
)paren
)paren
(brace
id|ych
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textvram
)paren
op_div
id|vxres
suffix:semicolon
id|var-&gt;yres_virtual
op_assign
id|ych
op_star
id|vf
suffix:semicolon
)brace
id|var-&gt;xres_virtual
op_assign
id|vxres
op_star
id|hf
suffix:semicolon
)brace
DECL|function|matrox_text_setfont
r_static
r_int
id|matrox_text_setfont
c_func
(paren
r_struct
id|display
op_star
id|p
comma
r_int
id|width
comma
r_int
id|height
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;matrox_text_setfont&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|p
)paren
(brace
id|MINFO_FROM_DISP
c_func
(paren
id|p
)paren
suffix:semicolon
id|matrox_text_round
c_func
(paren
id|PMINFO
op_amp
id|p-&gt;var
comma
id|p
)paren
suffix:semicolon
id|p-&gt;next_line
op_assign
id|p-&gt;line_length
op_assign
(paren
(paren
id|p-&gt;var.xres_virtual
op_div
(paren
id|fontwidth
c_func
(paren
id|p
)paren
ques
c_cond
id|fontwidth
c_func
(paren
id|p
)paren
suffix:colon
l_int|8
)paren
)paren
op_star
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textstep
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|p-&gt;conp
)paren
id|matrox_text_createcursor
c_func
(paren
id|PMINFO
id|p
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|macro|matrox_cfb16_revc
mdefine_line|#define matrox_cfb16_revc matrox_cfbX_revc
DECL|macro|matrox_cfb24_revc
mdefine_line|#define matrox_cfb24_revc matrox_cfbX_revc
DECL|macro|matrox_cfb32_revc
mdefine_line|#define matrox_cfb32_revc matrox_cfbX_revc
DECL|macro|matrox_cfb24_clear
mdefine_line|#define matrox_cfb24_clear matrox_cfb32_clear
DECL|macro|matrox_cfb24_putc
mdefine_line|#define matrox_cfb24_putc matrox_cfb32_putc
DECL|macro|matrox_cfb24_putcs
mdefine_line|#define matrox_cfb24_putcs matrox_cfb32_putcs
macro_line|#ifdef FBCON_HAS_VGATEXT
DECL|variable|matroxfb_text
r_static
r_struct
id|display_switch
id|matroxfb_text
op_assign
(brace
id|matrox_text_setup
comma
id|matrox_text_bmove
comma
id|matrox_text_clear
comma
id|matrox_text_putc
comma
id|matrox_text_putcs
comma
id|matrox_text_revc
comma
id|matrox_text_cursor
comma
id|matrox_text_setfont
comma
l_int|NULL
comma
id|FONTWIDTH
c_func
(paren
l_int|8
)paren
op_or
id|FONTWIDTH
c_func
(paren
l_int|9
)paren
)brace
suffix:semicolon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB4
DECL|variable|matroxfb_cfb4
r_static
r_struct
id|display_switch
id|matroxfb_cfb4
op_assign
(brace
id|fbcon_cfb4_setup
comma
id|matrox_cfb4_bmove
comma
id|matrox_cfb4_clear
comma
id|fbcon_cfb4_putc
comma
id|fbcon_cfb4_putcs
comma
id|matrox_cfb4_revc
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
multiline_comment|/* cursor... */
multiline_comment|/* set_font... */
id|FONTWIDTH
c_func
(paren
l_int|8
)paren
multiline_comment|/* fix, fix, fix it */
)brace
suffix:semicolon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB8
DECL|variable|matroxfb_cfb8
r_static
r_struct
id|display_switch
id|matroxfb_cfb8
op_assign
(brace
id|fbcon_cfb8_setup
comma
id|matrox_cfbX_bmove
comma
id|matrox_cfb8_clear
comma
id|matrox_cfb8_putc
comma
id|matrox_cfb8_putcs
comma
id|matrox_cfb8_revc
comma
l_int|NULL
comma
l_int|NULL
comma
id|matrox_cfbX_clear_margins
comma
op_complement
l_int|1
multiline_comment|/* FONTWIDTHS */
)brace
suffix:semicolon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB16
DECL|variable|matroxfb_cfb16
r_static
r_struct
id|display_switch
id|matroxfb_cfb16
op_assign
(brace
id|fbcon_cfb16_setup
comma
id|matrox_cfbX_bmove
comma
id|matrox_cfb16_clear
comma
id|matrox_cfb16_putc
comma
id|matrox_cfb16_putcs
comma
id|matrox_cfb16_revc
comma
l_int|NULL
comma
l_int|NULL
comma
id|matrox_cfbX_clear_margins
comma
op_complement
l_int|1
multiline_comment|/* FONTWIDTHS */
)brace
suffix:semicolon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB24
DECL|variable|matroxfb_cfb24
r_static
r_struct
id|display_switch
id|matroxfb_cfb24
op_assign
(brace
id|fbcon_cfb24_setup
comma
id|matrox_cfbX_bmove
comma
id|matrox_cfb24_clear
comma
id|matrox_cfb24_putc
comma
id|matrox_cfb24_putcs
comma
id|matrox_cfb24_revc
comma
l_int|NULL
comma
l_int|NULL
comma
id|matrox_cfbX_clear_margins
comma
op_complement
l_int|1
multiline_comment|/* FONTWIDTHS */
multiline_comment|/* TODO: and what about non-aligned access on BE? I think that there are no in my code */
)brace
suffix:semicolon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB32
DECL|variable|matroxfb_cfb32
r_static
r_struct
id|display_switch
id|matroxfb_cfb32
op_assign
(brace
id|fbcon_cfb32_setup
comma
id|matrox_cfbX_bmove
comma
id|matrox_cfb32_clear
comma
id|matrox_cfb32_putc
comma
id|matrox_cfb32_putcs
comma
id|matrox_cfb32_revc
comma
l_int|NULL
comma
l_int|NULL
comma
id|matrox_cfbX_clear_margins
comma
op_complement
l_int|1
multiline_comment|/* FONTWIDTHS */
)brace
suffix:semicolon
macro_line|#endif
DECL|function|initMatrox
r_static
r_void
id|initMatrox
c_func
(paren
id|WPMINFO
r_struct
id|display
op_star
id|p
)paren
(brace
r_struct
id|display_switch
op_star
id|swtmp
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;initMatrox&quot;
)paren
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|currcon_display
)paren
op_ne
id|p
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|p-&gt;dispsw
op_logical_and
id|p-&gt;conp
)paren
id|fb_con
dot
id|con_cursor
c_func
(paren
id|p-&gt;conp
comma
id|CM_ERASE
)paren
suffix:semicolon
id|p-&gt;dispsw_data
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p-&gt;var.accel_flags
op_amp
id|FB_ACCELF_TEXT
)paren
op_ne
id|FB_ACCELF_TEXT
)paren
(brace
r_if
c_cond
(paren
id|p-&gt;type
op_eq
id|FB_TYPE_TEXT
)paren
(brace
id|swtmp
op_assign
op_amp
id|matroxfb_text
suffix:semicolon
)brace
r_else
(brace
r_switch
c_cond
(paren
id|p-&gt;var.bits_per_pixel
)paren
(brace
macro_line|#ifdef FBCON_HAS_CFB4
r_case
l_int|4
suffix:colon
id|swtmp
op_assign
op_amp
id|fbcon_cfb4
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB8
r_case
l_int|8
suffix:colon
id|swtmp
op_assign
op_amp
id|fbcon_cfb8
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB16
r_case
l_int|16
suffix:colon
id|p-&gt;dispsw_data
op_assign
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|cmap.cfb16
)paren
suffix:semicolon
id|swtmp
op_assign
op_amp
id|fbcon_cfb16
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB24
r_case
l_int|24
suffix:colon
id|p-&gt;dispsw_data
op_assign
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|cmap.cfb24
)paren
suffix:semicolon
id|swtmp
op_assign
op_amp
id|fbcon_cfb24
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB32
r_case
l_int|32
suffix:colon
id|p-&gt;dispsw_data
op_assign
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|cmap.cfb32
)paren
suffix:semicolon
id|swtmp
op_assign
op_amp
id|fbcon_cfb32
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
r_default
suffix:colon
id|p-&gt;dispsw
op_assign
op_amp
id|fbcon_dummy
suffix:semicolon
r_return
suffix:semicolon
)brace
)brace
id|dprintk
c_func
(paren
id|KERN_INFO
l_string|&quot;matroxfb: acceleration disabled&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|p-&gt;type
op_eq
id|FB_TYPE_TEXT
)paren
(brace
id|swtmp
op_assign
op_amp
id|matroxfb_text
suffix:semicolon
)brace
r_else
(brace
r_switch
c_cond
(paren
id|p-&gt;var.bits_per_pixel
)paren
(brace
macro_line|#ifdef FBCON_HAS_CFB4
r_case
l_int|4
suffix:colon
id|swtmp
op_assign
op_amp
id|matroxfb_cfb4
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB8
r_case
l_int|8
suffix:colon
id|swtmp
op_assign
op_amp
id|matroxfb_cfb8
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB16
r_case
l_int|16
suffix:colon
id|p-&gt;dispsw_data
op_assign
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|cmap.cfb16
)paren
suffix:semicolon
id|swtmp
op_assign
op_amp
id|matroxfb_cfb16
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB24
r_case
l_int|24
suffix:colon
id|p-&gt;dispsw_data
op_assign
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|cmap.cfb24
)paren
suffix:semicolon
id|swtmp
op_assign
op_amp
id|matroxfb_cfb24
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB32
r_case
l_int|32
suffix:colon
id|p-&gt;dispsw_data
op_assign
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|cmap.cfb32
)paren
suffix:semicolon
id|swtmp
op_assign
op_amp
id|matroxfb_cfb32
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
r_default
suffix:colon
id|p-&gt;dispsw
op_assign
op_amp
id|fbcon_dummy
suffix:semicolon
r_return
suffix:semicolon
)brace
)brace
id|memcpy
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|dispsw
)paren
comma
id|swtmp
comma
r_sizeof
(paren
id|ACCESS_FBINFO
c_func
(paren
id|dispsw
)paren
)paren
)paren
suffix:semicolon
id|p-&gt;dispsw
op_assign
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|dispsw
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p-&gt;type
op_ne
id|FB_TYPE_TEXT
)paren
op_logical_and
id|ACCESS_FBINFO
c_func
(paren
id|devflags.hwcursor
)paren
)paren
(brace
r_if
c_cond
(paren
id|isMillenium
c_func
(paren
id|MINFO
)paren
)paren
(brace
macro_line|#ifdef CONFIG_FB_MATROX_MILLENIUM
id|ACCESS_FBINFO
c_func
(paren
id|dispsw.cursor
)paren
op_assign
id|matroxfb_ti3026_cursor
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|dispsw.set_font
)paren
op_assign
id|matroxfb_ti3026_setfont
suffix:semicolon
macro_line|#endif
)brace
r_else
(brace
macro_line|#ifdef NEED_DAC1064
id|ACCESS_FBINFO
c_func
(paren
id|dispsw.cursor
)paren
op_assign
id|matroxfb_DAC1064_cursor
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|dispsw.set_font
)paren
op_assign
id|matroxfb_DAC1064_setfont
suffix:semicolon
macro_line|#endif
)brace
)brace
)brace
multiline_comment|/* --------------------------------------------------------------------- */
multiline_comment|/*&n; * card parameters&n; */
multiline_comment|/* --------------------------------------------------------------------- */
DECL|variable|__initdata
r_static
r_struct
id|fb_var_screeninfo
id|vesafb_defined
id|__initdata
op_assign
(brace
l_int|640
comma
l_int|480
comma
l_int|640
comma
l_int|480
comma
multiline_comment|/* W,H, W, H (virtual) load xres,xres_virtual*/
l_int|0
comma
l_int|0
comma
multiline_comment|/* virtual -&gt; visible no offset */
l_int|8
comma
multiline_comment|/* depth -&gt; load bits_per_pixel */
l_int|0
comma
multiline_comment|/* greyscale ? */
(brace
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
multiline_comment|/* R */
(brace
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
multiline_comment|/* G */
(brace
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
multiline_comment|/* B */
(brace
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
multiline_comment|/* transparency */
l_int|0
comma
multiline_comment|/* standard pixel format */
id|FB_ACTIVATE_NOW
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
id|FB_ACCELF_TEXT
comma
multiline_comment|/* accel flags */
l_int|39721L
comma
l_int|48L
comma
l_int|16L
comma
l_int|33L
comma
l_int|10L
comma
l_int|96L
comma
l_int|2L
comma
op_complement
l_int|0
comma
multiline_comment|/* No sync info */
id|FB_VMODE_NONINTERLACED
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
)brace
suffix:semicolon
multiline_comment|/* --------------------------------------------------------------------- */
DECL|function|matrox_pan_var
r_static
r_void
id|matrox_pan_var
c_func
(paren
id|WPMINFO
r_struct
id|fb_var_screeninfo
op_star
id|var
)paren
(brace
r_int
r_int
id|pos
suffix:semicolon
r_int
r_int
id|p0
comma
id|p1
comma
id|p2
suffix:semicolon
macro_line|#ifdef CONFIG_FB_MATROX_32MB
r_int
r_int
id|p3
suffix:semicolon
macro_line|#endif
r_struct
id|display
op_star
id|disp
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;matrox_pan_var&quot;
)paren
id|disp
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|currcon_display
)paren
suffix:semicolon
r_if
c_cond
(paren
id|disp-&gt;type
op_eq
id|FB_TYPE_TEXT
)paren
(brace
id|pos
op_assign
id|var-&gt;yoffset
op_div
id|fontheight
c_func
(paren
id|disp
)paren
op_star
id|disp-&gt;next_line
op_div
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textstep
)paren
op_plus
id|var-&gt;xoffset
op_div
(paren
id|fontwidth
c_func
(paren
id|disp
)paren
ques
c_cond
id|fontwidth
c_func
(paren
id|disp
)paren
suffix:colon
l_int|8
)paren
suffix:semicolon
)brace
r_else
(brace
id|pos
op_assign
(paren
id|var-&gt;yoffset
op_star
id|var-&gt;xres_virtual
op_plus
id|var-&gt;xoffset
)paren
op_star
id|ACCESS_FBINFO
c_func
(paren
id|curr.final_bppShift
)paren
op_div
l_int|32
suffix:semicolon
id|pos
op_add_assign
id|ACCESS_FBINFO
c_func
(paren
id|curr.ydstorg.chunks
)paren
suffix:semicolon
)brace
id|p0
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|currenthw
)paren
op_member_access_from_pointer
id|CRTC
(braket
l_int|0x0D
)braket
op_assign
id|pos
op_amp
l_int|0xFF
suffix:semicolon
id|p1
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|currenthw
)paren
op_member_access_from_pointer
id|CRTC
(braket
l_int|0x0C
)braket
op_assign
(paren
id|pos
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
suffix:semicolon
id|p2
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|currenthw
)paren
op_member_access_from_pointer
id|CRTCEXT
(braket
l_int|0
)braket
op_assign
(paren
id|ACCESS_FBINFO
c_func
(paren
id|currenthw
)paren
op_member_access_from_pointer
id|CRTCEXT
(braket
l_int|0
)braket
op_amp
l_int|0xB0
)paren
op_or
(paren
(paren
id|pos
op_rshift
l_int|16
)paren
op_amp
l_int|0x0F
)paren
op_or
(paren
(paren
id|pos
op_rshift
l_int|14
)paren
op_amp
l_int|0x40
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_FB_MATROX_32MB
id|p3
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|currenthw
)paren
op_member_access_from_pointer
id|CRTCEXT
(braket
l_int|8
)braket
op_assign
id|pos
op_rshift
l_int|21
suffix:semicolon
macro_line|#endif&t;
id|CRITBEGIN
id|mga_setr
c_func
(paren
id|M_CRTC_INDEX
comma
l_int|0x0D
comma
id|p0
)paren
suffix:semicolon
id|mga_setr
c_func
(paren
id|M_CRTC_INDEX
comma
l_int|0x0C
comma
id|p1
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_FB_MATROX_32MB
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.support32MB
)paren
)paren
id|mga_setr
c_func
(paren
id|M_EXTVGA_INDEX
comma
l_int|0x08
comma
id|p3
)paren
suffix:semicolon
macro_line|#endif
id|mga_setr
c_func
(paren
id|M_EXTVGA_INDEX
comma
l_int|0x00
comma
id|p2
)paren
suffix:semicolon
id|CRITEND
)brace
multiline_comment|/*&n;&t; * Open/Release the frame buffer device&n;&t; */
DECL|function|matroxfb_open
r_static
r_int
id|matroxfb_open
c_func
(paren
r_struct
id|fb_info
op_star
id|info
comma
r_int
id|user
)paren
(brace
id|DBG_LOOP
c_func
(paren
l_string|&quot;matroxfb_open&quot;
)paren
multiline_comment|/*&n;&t; * Nothing, only a usage count for the moment&n;&t; */
id|MOD_INC_USE_COUNT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|matroxfb_release
r_static
r_int
id|matroxfb_release
c_func
(paren
r_struct
id|fb_info
op_star
id|info
comma
r_int
id|user
)paren
(brace
id|DBG_LOOP
c_func
(paren
l_string|&quot;matroxfb_release&quot;
)paren
id|MOD_DEC_USE_COUNT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|matroxfb_pan_display
r_static
r_int
id|matroxfb_pan_display
c_func
(paren
r_struct
id|fb_var_screeninfo
op_star
id|var
comma
r_int
id|con
comma
r_struct
id|fb_info
op_star
id|info
)paren
(brace
DECL|macro|minfo
mdefine_line|#define minfo ((struct matrox_fb_info*)info)
id|DBG
c_func
(paren
l_string|&quot;matroxfb_pan_display&quot;
)paren
r_if
c_cond
(paren
id|var-&gt;vmode
op_amp
id|FB_VMODE_YWRAP
)paren
(brace
r_if
c_cond
(paren
id|var-&gt;yoffset
OL
l_int|0
op_logical_or
id|var-&gt;yoffset
op_ge
id|fb_display
(braket
id|con
)braket
dot
id|var.yres_virtual
op_logical_or
id|var-&gt;xoffset
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|var-&gt;xoffset
op_plus
id|fb_display
(braket
id|con
)braket
dot
id|var.xres
OG
id|fb_display
(braket
id|con
)braket
dot
id|var.xres_virtual
op_logical_or
id|var-&gt;yoffset
op_plus
id|fb_display
(braket
id|con
)braket
dot
id|var.yres
OG
id|fb_display
(braket
id|con
)braket
dot
id|var.yres_virtual
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|con
op_eq
id|ACCESS_FBINFO
c_func
(paren
id|currcon
)paren
)paren
id|matrox_pan_var
c_func
(paren
id|PMINFO
id|var
)paren
suffix:semicolon
id|fb_display
(braket
id|con
)braket
dot
id|var.xoffset
op_assign
id|var-&gt;xoffset
suffix:semicolon
id|fb_display
(braket
id|con
)braket
dot
id|var.yoffset
op_assign
id|var-&gt;yoffset
suffix:semicolon
r_if
c_cond
(paren
id|var-&gt;vmode
op_amp
id|FB_VMODE_YWRAP
)paren
id|fb_display
(braket
id|con
)braket
dot
id|var.vmode
op_or_assign
id|FB_VMODE_YWRAP
suffix:semicolon
r_else
id|fb_display
(braket
id|con
)braket
dot
id|var.vmode
op_and_assign
op_complement
id|FB_VMODE_YWRAP
suffix:semicolon
r_return
l_int|0
suffix:semicolon
DECL|macro|minfo
macro_line|#undef minfo
)brace
DECL|function|matroxfb_updatevar
r_static
r_int
id|matroxfb_updatevar
c_func
(paren
r_int
id|con
comma
r_struct
id|fb_info
op_star
id|info
)paren
(brace
DECL|macro|minfo
mdefine_line|#define minfo ((struct matrox_fb_info*)info)
id|DBG
c_func
(paren
l_string|&quot;matroxfb_updatevar&quot;
)paren
suffix:semicolon
id|matrox_pan_var
c_func
(paren
id|PMINFO
op_amp
id|fb_display
(braket
id|con
)braket
dot
id|var
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
DECL|macro|minfo
macro_line|#undef minfo
)brace
DECL|function|matroxfb_get_final_bppShift
r_static
r_int
id|matroxfb_get_final_bppShift
c_func
(paren
id|CPMINFO
r_int
id|bpp
)paren
(brace
r_int
id|bppshft2
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;matroxfb_get_final_bppShift&quot;
)paren
id|bppshft2
op_assign
id|bpp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|bppshft2
)paren
(brace
r_return
l_int|8
suffix:semicolon
)brace
r_if
c_cond
(paren
id|isInterleave
c_func
(paren
id|MINFO
)paren
)paren
id|bppshft2
op_rshift_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.video64bits
)paren
)paren
id|bppshft2
op_rshift_assign
l_int|1
suffix:semicolon
r_return
id|bppshft2
suffix:semicolon
)brace
DECL|function|matroxfb_test_and_set_rounding
r_static
r_int
id|matroxfb_test_and_set_rounding
c_func
(paren
id|CPMINFO
r_int
id|xres
comma
r_int
id|bpp
)paren
(brace
r_int
id|over
suffix:semicolon
r_int
id|rounding
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;matroxfb_test_and_set_rounding&quot;
)paren
r_switch
c_cond
(paren
id|bpp
)paren
(brace
r_case
l_int|0
suffix:colon
r_return
id|xres
suffix:semicolon
r_case
l_int|4
suffix:colon
id|rounding
op_assign
l_int|128
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|8
suffix:colon
id|rounding
op_assign
l_int|64
suffix:semicolon
multiline_comment|/* doc says 64; 32 is OK for G400 */
r_break
suffix:semicolon
r_case
l_int|16
suffix:colon
id|rounding
op_assign
l_int|32
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|24
suffix:colon
id|rounding
op_assign
l_int|64
suffix:semicolon
multiline_comment|/* doc says 64; 32 is OK for G400 */
r_break
suffix:semicolon
r_default
suffix:colon
id|rounding
op_assign
l_int|16
suffix:semicolon
multiline_comment|/* on G400, 16 really does not work */
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.accelerator
)paren
op_eq
id|FB_ACCEL_MATROX_MGAG400
)paren
id|rounding
op_assign
l_int|32
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|isInterleave
c_func
(paren
id|MINFO
)paren
)paren
(brace
id|rounding
op_mul_assign
l_int|2
suffix:semicolon
)brace
id|over
op_assign
id|xres
op_mod
id|rounding
suffix:semicolon
r_if
c_cond
(paren
id|over
)paren
id|xres
op_add_assign
id|rounding
op_minus
id|over
suffix:semicolon
r_return
id|xres
suffix:semicolon
)brace
DECL|function|matroxfb_pitch_adjust
r_static
r_int
id|matroxfb_pitch_adjust
c_func
(paren
id|CPMINFO
r_int
id|xres
comma
r_int
id|bpp
)paren
(brace
r_const
r_int
op_star
id|width
suffix:semicolon
r_int
id|xres_new
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;matroxfb_pitch_adjust&quot;
)paren
r_if
c_cond
(paren
op_logical_neg
id|bpp
)paren
r_return
id|xres
suffix:semicolon
id|width
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|capable.vxres
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.precise_width
)paren
)paren
(brace
r_while
c_loop
(paren
op_star
id|width
)paren
(brace
r_if
c_cond
(paren
(paren
op_star
id|width
op_ge
id|xres
)paren
op_logical_and
(paren
id|matroxfb_test_and_set_rounding
c_func
(paren
id|PMINFO
op_star
id|width
comma
id|bpp
)paren
op_eq
op_star
id|width
)paren
)paren
(brace
r_break
suffix:semicolon
)brace
id|width
op_increment
suffix:semicolon
)brace
id|xres_new
op_assign
op_star
id|width
suffix:semicolon
)brace
r_else
(brace
id|xres_new
op_assign
id|matroxfb_test_and_set_rounding
c_func
(paren
id|PMINFO
id|xres
comma
id|bpp
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|xres_new
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|xres
op_ne
id|xres_new
)paren
(brace
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;matroxfb: cannot set xres to %d, rounded up to %d&bslash;n&quot;
comma
id|xres
comma
id|xres_new
)paren
suffix:semicolon
)brace
r_return
id|xres_new
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_FB_MATROX_MILLENIUM
DECL|variable|DACseq
r_static
r_const
r_int
r_char
id|DACseq
(braket
)braket
op_assign
(brace
id|TVP3026_XLATCHCTRL
comma
id|TVP3026_XTRUECOLORCTRL
comma
id|TVP3026_XMUXCTRL
comma
id|TVP3026_XCLKCTRL
comma
id|TVP3026_XPALETTEPAGE
comma
id|TVP3026_XGENCTRL
comma
id|TVP3026_XMISCCTRL
comma
id|TVP3026_XGENIOCTRL
comma
id|TVP3026_XGENIODATA
comma
id|TVP3026_XCOLKEYOVRMIN
comma
id|TVP3026_XCOLKEYOVRMAX
comma
id|TVP3026_XCOLKEYREDMIN
comma
id|TVP3026_XCOLKEYREDMAX
comma
id|TVP3026_XCOLKEYGREENMIN
comma
id|TVP3026_XCOLKEYGREENMAX
comma
id|TVP3026_XCOLKEYBLUEMIN
comma
id|TVP3026_XCOLKEYBLUEMAX
comma
id|TVP3026_XCOLKEYCTRL
comma
id|TVP3026_XMEMPLLCTRL
comma
id|TVP3026_XSENSETEST
comma
id|TVP3026_XCURCTRL
)brace
suffix:semicolon
DECL|macro|POS3026_XLATCHCTRL
mdefine_line|#define POS3026_XLATCHCTRL&t;0
DECL|macro|POS3026_XTRUECOLORCTRL
mdefine_line|#define POS3026_XTRUECOLORCTRL&t;1
DECL|macro|POS3026_XMUXCTRL
mdefine_line|#define POS3026_XMUXCTRL&t;2
DECL|macro|POS3026_XCLKCTRL
mdefine_line|#define POS3026_XCLKCTRL&t;3
DECL|macro|POS3026_XGENCTRL
mdefine_line|#define POS3026_XGENCTRL&t;5
DECL|macro|POS3026_XMISCCTRL
mdefine_line|#define POS3026_XMISCCTRL&t;6
DECL|macro|POS3026_XMEMPLLCTRL
mdefine_line|#define POS3026_XMEMPLLCTRL&t;18
DECL|macro|POS3026_XCURCTRL
mdefine_line|#define POS3026_XCURCTRL&t;20
DECL|variable|MGADACbpp32
r_static
r_const
r_int
r_char
id|MGADACbpp32
(braket
)braket
op_assign
(brace
id|TVP3026_XLATCHCTRL_2_1
comma
id|TVP3026_XTRUECOLORCTRL_DIRECTCOLOR
op_or
id|TVP3026_XTRUECOLORCTRL_ORGB_8888
comma
l_int|0x00
comma
id|TVP3026_XCLKCTRL_DIV1
op_or
id|TVP3026_XCLKCTRL_SRC_PLL
comma
l_int|0x00
comma
id|TVP3026_XGENCTRL_HSYNC_POS
op_or
id|TVP3026_XGENCTRL_VSYNC_POS
op_or
id|TVP3026_XGENCTRL_LITTLE_ENDIAN
op_or
id|TVP3026_XGENCTRL_BLACK_0IRE
op_or
id|TVP3026_XGENCTRL_NO_SYNC_ON_GREEN
op_or
id|TVP3026_XGENCTRL_OVERSCAN_DIS
comma
id|TVP3026_XMISCCTRL_DAC_PUP
op_or
id|TVP3026_XMISCCTRL_DAC_8BIT
op_or
id|TVP3026_XMISCCTRL_PSEL_DIS
op_or
id|TVP3026_XMISCCTRL_PSEL_HIGH
comma
l_int|0x00
comma
l_int|0x1E
comma
l_int|0xFF
comma
l_int|0xFF
comma
l_int|0xFF
comma
l_int|0xFF
comma
l_int|0xFF
comma
l_int|0xFF
comma
l_int|0xFF
comma
l_int|0xFF
comma
id|TVP3026_XCOLKEYCTRL_ZOOM1
comma
l_int|0x00
comma
l_int|0x00
comma
id|TVP3026_XCURCTRL_DIS
)brace
suffix:semicolon
macro_line|#endif&t;/* CONFIG_FB_MATROX_MILLENIUM */
DECL|function|PLL_calcclock
r_static
r_int
id|PLL_calcclock
c_func
(paren
id|CPMINFO
r_int
r_int
id|freq
comma
r_int
r_int
id|fmax
comma
r_int
r_int
op_star
id|in
comma
r_int
r_int
op_star
id|feed
comma
r_int
r_int
op_star
id|post
)paren
(brace
r_int
r_int
id|bestdiff
op_assign
op_complement
l_int|0
suffix:semicolon
r_int
r_int
id|bestvco
op_assign
l_int|0
suffix:semicolon
r_int
r_int
id|fxtal
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.ref_freq
)paren
suffix:semicolon
r_int
r_int
id|fwant
suffix:semicolon
r_int
r_int
id|p
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;PLL_calcclock&quot;
)paren
id|fwant
op_assign
id|freq
suffix:semicolon
macro_line|#ifdef DEBUG
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;post_shift_max: %d&bslash;n&quot;
comma
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.post_shift_max
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;ref_freq: %d&bslash;n&quot;
comma
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.ref_freq
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;freq: %d&bslash;n&quot;
comma
id|freq
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;vco_freq_min: %d&bslash;n&quot;
comma
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.vco_freq_min
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;in_div_min: %d&bslash;n&quot;
comma
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.in_div_min
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;in_div_max: %d&bslash;n&quot;
comma
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.in_div_max
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;feed_div_min: %d&bslash;n&quot;
comma
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.feed_div_min
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;feed_div_max: %d&bslash;n&quot;
comma
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.feed_div_max
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;fmax: %d&bslash;n&quot;
comma
id|fmax
)paren
suffix:semicolon
macro_line|#endif
r_for
c_loop
(paren
id|p
op_assign
l_int|1
suffix:semicolon
id|p
op_le
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.post_shift_max
)paren
suffix:semicolon
id|p
op_increment
)paren
(brace
r_if
c_cond
(paren
id|fwant
op_star
l_int|2
OG
id|fmax
)paren
r_break
suffix:semicolon
id|fwant
op_mul_assign
l_int|2
suffix:semicolon
)brace
r_if
c_cond
(paren
id|fwant
OL
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.vco_freq_min
)paren
)paren
id|fwant
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.vco_freq_min
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fwant
OG
id|fmax
)paren
id|fwant
op_assign
id|fmax
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
id|p
op_decrement
OG
l_int|0
suffix:semicolon
id|fwant
op_rshift_assign
l_int|1
comma
id|bestdiff
op_rshift_assign
l_int|1
)paren
(brace
r_int
r_int
id|m
suffix:semicolon
r_if
c_cond
(paren
id|fwant
OL
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.vco_freq_min
)paren
)paren
r_break
suffix:semicolon
r_for
c_loop
(paren
id|m
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.in_div_min
)paren
suffix:semicolon
id|m
op_le
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.in_div_max
)paren
suffix:semicolon
id|m
op_increment
)paren
(brace
r_int
r_int
id|diff
comma
id|fvco
suffix:semicolon
r_int
r_int
id|n
suffix:semicolon
id|n
op_assign
(paren
id|fwant
op_star
(paren
id|m
op_plus
l_int|1
)paren
op_plus
(paren
id|fxtal
op_rshift
l_int|1
)paren
)paren
op_div
id|fxtal
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|n
OG
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.feed_div_max
)paren
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|n
OL
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.feed_div_min
)paren
)paren
id|n
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.feed_div_min
)paren
suffix:semicolon
id|fvco
op_assign
(paren
id|fxtal
op_star
(paren
id|n
op_plus
l_int|1
)paren
)paren
op_div
(paren
id|m
op_plus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fvco
OL
id|fwant
)paren
id|diff
op_assign
id|fwant
op_minus
id|fvco
suffix:semicolon
r_else
id|diff
op_assign
id|fvco
op_minus
id|fwant
suffix:semicolon
r_if
c_cond
(paren
id|diff
OL
id|bestdiff
)paren
(brace
id|bestdiff
op_assign
id|diff
suffix:semicolon
op_star
id|post
op_assign
id|p
suffix:semicolon
op_star
id|in
op_assign
id|m
suffix:semicolon
op_star
id|feed
op_assign
id|n
suffix:semicolon
id|bestvco
op_assign
id|fvco
suffix:semicolon
)brace
)brace
)brace
id|dprintk
c_func
(paren
id|KERN_ERR
l_string|&quot;clk: %02X %02X %02X %d %d %d&bslash;n&quot;
comma
op_star
id|in
comma
op_star
id|feed
comma
op_star
id|post
comma
id|fxtal
comma
id|bestvco
comma
id|fwant
)paren
suffix:semicolon
r_return
id|bestvco
suffix:semicolon
)brace
macro_line|#ifdef NEED_DAC1064
DECL|function|DAC1064_calcclock
r_static
r_void
id|DAC1064_calcclock
c_func
(paren
id|CPMINFO
r_int
r_int
id|freq
comma
r_int
r_int
id|fmax
comma
r_int
r_int
op_star
id|in
comma
r_int
r_int
op_star
id|feed
comma
r_int
r_int
op_star
id|post
)paren
(brace
r_int
r_int
id|fvco
suffix:semicolon
r_int
r_int
id|p
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;DAC1064_calcclock&quot;
)paren
id|fvco
op_assign
id|PLL_calcclock
c_func
(paren
id|PMINFO
id|freq
comma
id|fmax
comma
id|in
comma
id|feed
comma
op_amp
id|p
)paren
suffix:semicolon
id|p
op_assign
(paren
l_int|1
op_lshift
id|p
)paren
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|fvco
op_le
l_int|100000
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|fvco
op_le
l_int|140000
)paren
id|p
op_or_assign
l_int|0x08
suffix:semicolon
r_else
r_if
c_cond
(paren
id|fvco
op_le
l_int|180000
)paren
id|p
op_or_assign
l_int|0x10
suffix:semicolon
r_else
id|p
op_or_assign
l_int|0x18
suffix:semicolon
op_star
id|post
op_assign
id|p
suffix:semicolon
)brace
macro_line|#endif
macro_line|#ifdef CONFIG_FB_MATROX_MILLENIUM
DECL|function|Ti3026_calcclock
r_static
r_int
id|Ti3026_calcclock
c_func
(paren
id|CPMINFO
r_int
r_int
id|freq
comma
r_int
r_int
id|fmax
comma
r_int
op_star
id|in
comma
r_int
op_star
id|feed
comma
r_int
op_star
id|post
)paren
(brace
r_int
r_int
id|fvco
suffix:semicolon
r_int
r_int
id|lin
comma
id|lfeed
comma
id|lpost
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;Ti3026_calcclock&quot;
)paren
id|fvco
op_assign
id|PLL_calcclock
c_func
(paren
id|PMINFO
id|freq
comma
id|fmax
comma
op_amp
id|lin
comma
op_amp
id|lfeed
comma
op_amp
id|lpost
)paren
suffix:semicolon
id|fvco
op_rshift_assign
(paren
op_star
id|post
op_assign
id|lpost
)paren
suffix:semicolon
op_star
id|in
op_assign
l_int|64
op_minus
id|lin
suffix:semicolon
op_star
id|feed
op_assign
l_int|64
op_minus
id|lfeed
suffix:semicolon
r_return
id|fvco
suffix:semicolon
)brace
DECL|function|Ti3026_setpclk
r_static
r_int
id|Ti3026_setpclk
c_func
(paren
id|CPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
comma
r_int
id|clk
comma
r_struct
id|display
op_star
id|p
)paren
(brace
r_int
r_int
id|f_pll
suffix:semicolon
r_int
r_int
id|pixfeed
comma
id|pixin
comma
id|pixpost
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;Ti3026_setpclk&quot;
)paren
id|f_pll
op_assign
id|Ti3026_calcclock
c_func
(paren
id|PMINFO
id|clk
comma
id|ACCESS_FBINFO
c_func
(paren
id|max_pixel_clock
)paren
comma
op_amp
id|pixin
comma
op_amp
id|pixfeed
comma
op_amp
id|pixpost
)paren
suffix:semicolon
id|hw-&gt;DACclk
(braket
l_int|0
)braket
op_assign
id|pixin
op_or
l_int|0xC0
suffix:semicolon
id|hw-&gt;DACclk
(braket
l_int|1
)braket
op_assign
id|pixfeed
suffix:semicolon
id|hw-&gt;DACclk
(braket
l_int|2
)braket
op_assign
id|pixpost
op_or
l_int|0xB0
suffix:semicolon
r_if
c_cond
(paren
id|p-&gt;type
op_eq
id|FB_TYPE_TEXT
)paren
(brace
id|hw-&gt;DACreg
(braket
id|POS3026_XMEMPLLCTRL
)braket
op_assign
id|TVP3026_XMEMPLLCTRL_MCLK_MCLKPLL
op_or
id|TVP3026_XMEMPLLCTRL_RCLK_PIXPLL
suffix:semicolon
id|hw-&gt;DACclk
(braket
l_int|3
)braket
op_assign
l_int|0xFD
suffix:semicolon
id|hw-&gt;DACclk
(braket
l_int|4
)braket
op_assign
l_int|0x3D
suffix:semicolon
id|hw-&gt;DACclk
(braket
l_int|5
)braket
op_assign
l_int|0x70
suffix:semicolon
)brace
r_else
(brace
r_int
r_int
id|loopfeed
comma
id|loopin
comma
id|looppost
comma
id|loopdiv
comma
id|z
suffix:semicolon
r_int
r_int
id|Bpp
suffix:semicolon
id|Bpp
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|curr.final_bppShift
)paren
suffix:semicolon
r_if
c_cond
(paren
id|p-&gt;var.bits_per_pixel
op_eq
l_int|24
)paren
(brace
id|loopfeed
op_assign
l_int|3
suffix:semicolon
multiline_comment|/* set lm to any possible value */
id|loopin
op_assign
l_int|3
op_star
l_int|32
op_div
id|Bpp
suffix:semicolon
)brace
r_else
(brace
id|loopfeed
op_assign
l_int|4
suffix:semicolon
id|loopin
op_assign
l_int|4
op_star
l_int|32
op_div
id|Bpp
suffix:semicolon
)brace
id|z
op_assign
(paren
l_int|110000
op_star
id|loopin
)paren
op_div
(paren
id|f_pll
op_star
id|loopfeed
)paren
suffix:semicolon
id|loopdiv
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* div 2 */
r_if
c_cond
(paren
id|z
OL
l_int|2
)paren
id|looppost
op_assign
l_int|0
suffix:semicolon
r_else
r_if
c_cond
(paren
id|z
OL
l_int|4
)paren
id|looppost
op_assign
l_int|1
suffix:semicolon
r_else
r_if
c_cond
(paren
id|z
OL
l_int|8
)paren
id|looppost
op_assign
l_int|2
suffix:semicolon
r_else
(brace
id|looppost
op_assign
l_int|3
suffix:semicolon
id|loopdiv
op_assign
id|z
op_div
l_int|16
suffix:semicolon
)brace
r_if
c_cond
(paren
id|p-&gt;var.bits_per_pixel
op_eq
l_int|24
)paren
(brace
id|hw-&gt;DACclk
(braket
l_int|3
)braket
op_assign
(paren
(paren
l_int|65
op_minus
id|loopin
)paren
op_amp
l_int|0x3F
)paren
op_or
l_int|0xC0
suffix:semicolon
id|hw-&gt;DACclk
(braket
l_int|4
)braket
op_assign
(paren
l_int|65
op_minus
id|loopfeed
)paren
op_or
l_int|0x80
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|accel.ramdac_rev
)paren
OG
l_int|0x20
)paren
(brace
r_if
c_cond
(paren
id|isInterleave
c_func
(paren
id|MINFO
)paren
)paren
id|hw-&gt;DACreg
(braket
id|POS3026_XLATCHCTRL
)braket
op_assign
id|TVP3026B_XLATCHCTRL_8_3
suffix:semicolon
r_else
(brace
id|hw-&gt;DACclk
(braket
l_int|4
)braket
op_and_assign
op_complement
l_int|0xC0
suffix:semicolon
id|hw-&gt;DACreg
(braket
id|POS3026_XLATCHCTRL
)braket
op_assign
id|TVP3026B_XLATCHCTRL_4_3
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|isInterleave
c_func
(paren
id|MINFO
)paren
)paren
suffix:semicolon
multiline_comment|/* default... */
r_else
(brace
id|hw-&gt;DACclk
(braket
l_int|4
)braket
op_xor_assign
l_int|0xC0
suffix:semicolon
multiline_comment|/* change from 0x80 to 0x40 */
id|hw-&gt;DACreg
(braket
id|POS3026_XLATCHCTRL
)braket
op_assign
id|TVP3026A_XLATCHCTRL_4_3
suffix:semicolon
)brace
)brace
id|hw-&gt;DACclk
(braket
l_int|5
)braket
op_assign
id|looppost
op_or
l_int|0xF8
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.mga_24bpp_fix
)paren
)paren
id|hw-&gt;DACclk
(braket
l_int|5
)braket
op_xor_assign
l_int|0x40
suffix:semicolon
)brace
r_else
(brace
id|hw-&gt;DACclk
(braket
l_int|3
)braket
op_assign
(paren
(paren
l_int|65
op_minus
id|loopin
)paren
op_amp
l_int|0x3F
)paren
op_or
l_int|0xC0
suffix:semicolon
id|hw-&gt;DACclk
(braket
l_int|4
)braket
op_assign
l_int|65
op_minus
id|loopfeed
suffix:semicolon
id|hw-&gt;DACclk
(braket
l_int|5
)braket
op_assign
id|looppost
op_or
l_int|0xF0
suffix:semicolon
)brace
id|hw-&gt;DACreg
(braket
id|POS3026_XMEMPLLCTRL
)braket
op_assign
id|loopdiv
op_or
id|TVP3026_XMEMPLLCTRL_MCLK_MCLKPLL
op_or
id|TVP3026_XMEMPLLCTRL_RCLK_LOOPPLL
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif
DECL|function|var2my
r_static
r_void
id|var2my
c_func
(paren
r_struct
id|fb_var_screeninfo
op_star
id|var
comma
r_struct
id|my_timming
op_star
id|mt
)paren
(brace
r_int
r_int
id|pixclock
op_assign
id|var-&gt;pixclock
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;var2my&quot;
)paren
r_if
c_cond
(paren
op_logical_neg
id|pixclock
)paren
id|pixclock
op_assign
l_int|10000
suffix:semicolon
multiline_comment|/* 10ns = 100MHz */
id|mt-&gt;pixclock
op_assign
l_int|1000000000
op_div
id|pixclock
suffix:semicolon
r_if
c_cond
(paren
id|mt-&gt;pixclock
OL
l_int|1
)paren
id|mt-&gt;pixclock
op_assign
l_int|1
suffix:semicolon
id|mt-&gt;dblscan
op_assign
id|var-&gt;vmode
op_amp
id|FB_VMODE_DOUBLE
suffix:semicolon
id|mt-&gt;interlaced
op_assign
id|var-&gt;vmode
op_amp
id|FB_VMODE_INTERLACED
suffix:semicolon
id|mt-&gt;HDisplay
op_assign
id|var-&gt;xres
suffix:semicolon
id|mt-&gt;HSyncStart
op_assign
id|mt-&gt;HDisplay
op_plus
id|var-&gt;right_margin
suffix:semicolon
id|mt-&gt;HSyncEnd
op_assign
id|mt-&gt;HSyncStart
op_plus
id|var-&gt;hsync_len
suffix:semicolon
id|mt-&gt;HTotal
op_assign
id|mt-&gt;HSyncEnd
op_plus
id|var-&gt;left_margin
suffix:semicolon
id|mt-&gt;VDisplay
op_assign
id|var-&gt;yres
suffix:semicolon
id|mt-&gt;VSyncStart
op_assign
id|mt-&gt;VDisplay
op_plus
id|var-&gt;lower_margin
suffix:semicolon
id|mt-&gt;VSyncEnd
op_assign
id|mt-&gt;VSyncStart
op_plus
id|var-&gt;vsync_len
suffix:semicolon
id|mt-&gt;VTotal
op_assign
id|mt-&gt;VSyncEnd
op_plus
id|var-&gt;upper_margin
suffix:semicolon
id|mt-&gt;sync
op_assign
id|var-&gt;sync
suffix:semicolon
)brace
DECL|function|vgaHWinit
r_static
r_int
id|vgaHWinit
c_func
(paren
id|CPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
comma
r_struct
id|my_timming
op_star
id|m
comma
r_struct
id|display
op_star
id|p
)paren
(brace
r_int
r_int
id|hd
comma
id|hs
comma
id|he
comma
id|hbe
comma
id|ht
suffix:semicolon
r_int
r_int
id|vd
comma
id|vs
comma
id|ve
comma
id|vt
suffix:semicolon
r_int
r_int
id|wd
suffix:semicolon
r_int
r_int
id|divider
suffix:semicolon
r_int
id|i
suffix:semicolon
r_int
id|text
op_assign
id|p-&gt;type
op_eq
id|FB_TYPE_TEXT
suffix:semicolon
r_int
id|fwidth
suffix:semicolon
r_if
c_cond
(paren
id|text
)paren
(brace
id|fwidth
op_assign
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|fwidth
)paren
id|fwidth
op_assign
l_int|8
suffix:semicolon
)brace
r_else
id|fwidth
op_assign
l_int|8
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;vgaHWinit&quot;
)paren
id|hw-&gt;SEQ
(braket
l_int|0
)braket
op_assign
l_int|0x00
suffix:semicolon
r_if
c_cond
(paren
id|fwidth
op_eq
l_int|9
)paren
id|hw-&gt;SEQ
(braket
l_int|1
)braket
op_assign
l_int|0x00
suffix:semicolon
r_else
id|hw-&gt;SEQ
(braket
l_int|1
)braket
op_assign
l_int|0x01
suffix:semicolon
multiline_comment|/* or 0x09 */
id|hw-&gt;SEQ
(braket
l_int|2
)braket
op_assign
l_int|0x0F
suffix:semicolon
multiline_comment|/* bitplanes */
id|hw-&gt;SEQ
(braket
l_int|3
)braket
op_assign
l_int|0x00
suffix:semicolon
r_if
c_cond
(paren
id|text
)paren
id|hw-&gt;SEQ
(braket
l_int|4
)braket
op_assign
l_int|0x02
suffix:semicolon
r_else
id|hw-&gt;SEQ
(braket
l_int|4
)braket
op_assign
l_int|0x0E
suffix:semicolon
multiline_comment|/* CRTC 0..7, 9, 16..19, 21, 22 are reprogrammed by Matrox Millenium code... Hope that by MGA1064 too */
r_if
c_cond
(paren
id|m-&gt;dblscan
)paren
(brace
id|m-&gt;VTotal
op_lshift_assign
l_int|1
suffix:semicolon
id|m-&gt;VDisplay
op_lshift_assign
l_int|1
suffix:semicolon
id|m-&gt;VSyncStart
op_lshift_assign
l_int|1
suffix:semicolon
id|m-&gt;VSyncEnd
op_lshift_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|m-&gt;interlaced
)paren
(brace
id|m-&gt;VTotal
op_rshift_assign
l_int|1
suffix:semicolon
id|m-&gt;VDisplay
op_rshift_assign
l_int|1
suffix:semicolon
id|m-&gt;VSyncStart
op_rshift_assign
l_int|1
suffix:semicolon
id|m-&gt;VSyncEnd
op_rshift_assign
l_int|1
suffix:semicolon
)brace
multiline_comment|/* GCTL is ignored when not using 0xA0000 aperture */
id|hw-&gt;GCTL
(braket
l_int|0
)braket
op_assign
l_int|0x00
suffix:semicolon
id|hw-&gt;GCTL
(braket
l_int|1
)braket
op_assign
l_int|0x00
suffix:semicolon
id|hw-&gt;GCTL
(braket
l_int|2
)braket
op_assign
l_int|0x00
suffix:semicolon
id|hw-&gt;GCTL
(braket
l_int|3
)braket
op_assign
l_int|0x00
suffix:semicolon
id|hw-&gt;GCTL
(braket
l_int|4
)braket
op_assign
l_int|0x00
suffix:semicolon
r_if
c_cond
(paren
id|text
)paren
(brace
id|hw-&gt;GCTL
(braket
l_int|5
)braket
op_assign
l_int|0x10
suffix:semicolon
id|hw-&gt;GCTL
(braket
l_int|6
)braket
op_assign
l_int|0x02
suffix:semicolon
)brace
r_else
(brace
id|hw-&gt;GCTL
(braket
l_int|5
)braket
op_assign
l_int|0x40
suffix:semicolon
id|hw-&gt;GCTL
(braket
l_int|6
)braket
op_assign
l_int|0x05
suffix:semicolon
)brace
id|hw-&gt;GCTL
(braket
l_int|7
)braket
op_assign
l_int|0x0F
suffix:semicolon
id|hw-&gt;GCTL
(braket
l_int|8
)braket
op_assign
l_int|0xFF
suffix:semicolon
multiline_comment|/* Whole ATTR is ignored in PowerGraphics mode */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|16
suffix:semicolon
id|i
op_increment
)paren
id|hw-&gt;ATTR
(braket
id|i
)braket
op_assign
id|i
suffix:semicolon
r_if
c_cond
(paren
id|text
)paren
(brace
id|hw-&gt;ATTR
(braket
l_int|16
)braket
op_assign
l_int|0x04
suffix:semicolon
)brace
r_else
(brace
id|hw-&gt;ATTR
(braket
l_int|16
)braket
op_assign
l_int|0x41
suffix:semicolon
)brace
id|hw-&gt;ATTR
(braket
l_int|17
)braket
op_assign
l_int|0xFF
suffix:semicolon
id|hw-&gt;ATTR
(braket
l_int|18
)braket
op_assign
l_int|0x0F
suffix:semicolon
r_if
c_cond
(paren
id|fwidth
op_eq
l_int|9
)paren
id|hw-&gt;ATTR
(braket
l_int|19
)braket
op_assign
l_int|0x08
suffix:semicolon
r_else
id|hw-&gt;ATTR
(braket
l_int|19
)braket
op_assign
l_int|0x00
suffix:semicolon
id|hw-&gt;ATTR
(braket
l_int|20
)braket
op_assign
l_int|0x00
suffix:semicolon
r_if
c_cond
(paren
id|text
)paren
(brace
id|hd
op_assign
id|m-&gt;HDisplay
op_div
id|fwidth
suffix:semicolon
id|hs
op_assign
id|m-&gt;HSyncStart
op_div
id|fwidth
suffix:semicolon
id|he
op_assign
id|m-&gt;HSyncEnd
op_div
id|fwidth
suffix:semicolon
id|ht
op_assign
id|m-&gt;HTotal
op_div
id|fwidth
suffix:semicolon
id|divider
op_assign
l_int|8
suffix:semicolon
)brace
r_else
(brace
id|hd
op_assign
id|m-&gt;HDisplay
op_rshift
l_int|3
suffix:semicolon
id|hs
op_assign
id|m-&gt;HSyncStart
op_rshift
l_int|3
suffix:semicolon
id|he
op_assign
id|m-&gt;HSyncEnd
op_rshift
l_int|3
suffix:semicolon
id|ht
op_assign
id|m-&gt;HTotal
op_rshift
l_int|3
suffix:semicolon
multiline_comment|/* standard timmings are in 8pixels, but for interleaved we cannot */
multiline_comment|/* do it for 4bpp (because of (4bpp &gt;&gt; 1(interleaved))/4 == 0) */
multiline_comment|/* using 16 or more pixels per unit can save us */
id|divider
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|curr.final_bppShift
)paren
suffix:semicolon
)brace
r_while
c_loop
(paren
id|divider
op_amp
l_int|3
)paren
(brace
id|hd
op_rshift_assign
l_int|1
suffix:semicolon
id|hs
op_rshift_assign
l_int|1
suffix:semicolon
id|he
op_rshift_assign
l_int|1
suffix:semicolon
id|ht
op_rshift_assign
l_int|1
suffix:semicolon
id|divider
op_lshift_assign
l_int|1
suffix:semicolon
)brace
id|divider
op_assign
id|divider
op_div
l_int|4
suffix:semicolon
multiline_comment|/* divider can be from 1 to 8 */
r_while
c_loop
(paren
id|divider
OG
l_int|8
)paren
(brace
id|hd
op_lshift_assign
l_int|1
suffix:semicolon
id|hs
op_lshift_assign
l_int|1
suffix:semicolon
id|he
op_lshift_assign
l_int|1
suffix:semicolon
id|ht
op_lshift_assign
l_int|1
suffix:semicolon
id|divider
op_rshift_assign
l_int|1
suffix:semicolon
)brace
id|hd
op_assign
id|hd
op_minus
l_int|1
suffix:semicolon
id|hs
op_assign
id|hs
op_minus
l_int|1
suffix:semicolon
id|he
op_assign
id|he
op_minus
l_int|1
suffix:semicolon
id|ht
op_assign
id|ht
op_minus
l_int|1
suffix:semicolon
id|vd
op_assign
id|m-&gt;VDisplay
op_minus
l_int|1
suffix:semicolon
id|vs
op_assign
id|m-&gt;VSyncStart
op_minus
l_int|1
suffix:semicolon
id|ve
op_assign
id|m-&gt;VSyncEnd
op_minus
l_int|1
suffix:semicolon
id|vt
op_assign
id|m-&gt;VTotal
op_minus
l_int|2
suffix:semicolon
multiline_comment|/* G200 cannot work with (ht &amp; 7) == 6 */
r_if
c_cond
(paren
(paren
(paren
id|ht
op_amp
l_int|0x07
)paren
op_eq
l_int|0x06
)paren
op_logical_or
(paren
(paren
id|ht
op_amp
l_int|0x0F
)paren
op_eq
l_int|0x04
)paren
)paren
id|ht
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|text
)paren
(brace
id|hbe
op_assign
id|ht
op_minus
l_int|1
suffix:semicolon
id|wd
op_assign
id|p-&gt;var.xres_virtual
op_div
(paren
id|fwidth
op_star
l_int|2
)paren
suffix:semicolon
)brace
r_else
(brace
id|hbe
op_assign
id|ht
suffix:semicolon
id|wd
op_assign
id|p-&gt;var.xres_virtual
op_star
id|ACCESS_FBINFO
c_func
(paren
id|curr.final_bppShift
)paren
op_div
l_int|64
suffix:semicolon
)brace
id|hw-&gt;CRTCEXT
(braket
l_int|0
)braket
op_assign
l_int|0
suffix:semicolon
id|hw-&gt;CRTCEXT
(braket
l_int|5
)braket
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|m-&gt;interlaced
)paren
(brace
id|hw-&gt;CRTCEXT
(braket
l_int|0
)braket
op_assign
l_int|0x80
suffix:semicolon
id|hw-&gt;CRTCEXT
(braket
l_int|5
)braket
op_assign
(paren
id|hs
op_plus
id|he
op_minus
id|ht
)paren
op_rshift
l_int|1
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|m-&gt;dblscan
)paren
id|wd
op_lshift_assign
l_int|1
suffix:semicolon
id|vt
op_and_assign
op_complement
l_int|1
suffix:semicolon
)brace
id|hw-&gt;CRTCEXT
(braket
l_int|0
)braket
op_or_assign
(paren
id|wd
op_amp
l_int|0x300
)paren
op_rshift
l_int|4
suffix:semicolon
id|hw-&gt;CRTCEXT
(braket
l_int|1
)braket
op_assign
(paren
(paren
(paren
id|ht
op_minus
l_int|4
)paren
op_amp
l_int|0x100
)paren
op_rshift
l_int|8
)paren
op_or
(paren
(paren
id|hd
op_amp
l_int|0x100
)paren
op_rshift
l_int|7
)paren
op_or
multiline_comment|/* blanking */
(paren
(paren
id|hs
op_amp
l_int|0x100
)paren
op_rshift
l_int|6
)paren
op_or
multiline_comment|/* sync start */
(paren
id|hbe
op_amp
l_int|0x040
)paren
suffix:semicolon
multiline_comment|/* end hor. blanking */
id|hw-&gt;CRTCEXT
(braket
l_int|2
)braket
op_assign
(paren
(paren
id|vt
op_amp
l_int|0xC00
)paren
op_rshift
l_int|10
)paren
op_or
(paren
(paren
id|vd
op_amp
l_int|0x400
)paren
op_rshift
l_int|8
)paren
op_or
multiline_comment|/* disp end */
(paren
(paren
id|vd
op_amp
l_int|0xC00
)paren
op_rshift
l_int|7
)paren
op_or
multiline_comment|/* vblanking start */
(paren
(paren
id|vs
op_amp
l_int|0xC00
)paren
op_rshift
l_int|5
)paren
suffix:semicolon
r_if
c_cond
(paren
id|text
)paren
id|hw-&gt;CRTCEXT
(braket
l_int|3
)braket
op_assign
l_int|0x00
suffix:semicolon
r_else
id|hw-&gt;CRTCEXT
(braket
l_int|3
)braket
op_assign
(paren
id|divider
op_minus
l_int|1
)paren
op_or
l_int|0x80
suffix:semicolon
id|hw-&gt;CRTCEXT
(braket
l_int|4
)braket
op_assign
l_int|0
suffix:semicolon
id|hw-&gt;CRTC
(braket
l_int|0
)braket
op_assign
id|ht
op_minus
l_int|4
suffix:semicolon
id|hw-&gt;CRTC
(braket
l_int|1
)braket
op_assign
id|hd
suffix:semicolon
id|hw-&gt;CRTC
(braket
l_int|2
)braket
op_assign
id|hd
suffix:semicolon
id|hw-&gt;CRTC
(braket
l_int|3
)braket
op_assign
(paren
id|hbe
op_amp
l_int|0x1F
)paren
op_or
l_int|0x80
suffix:semicolon
id|hw-&gt;CRTC
(braket
l_int|4
)braket
op_assign
id|hs
suffix:semicolon
id|hw-&gt;CRTC
(braket
l_int|5
)braket
op_assign
(paren
(paren
id|hbe
op_amp
l_int|0x20
)paren
op_lshift
l_int|2
)paren
op_or
(paren
id|he
op_amp
l_int|0x1F
)paren
suffix:semicolon
r_if
c_cond
(paren
id|text
)paren
id|hw-&gt;CRTC
(braket
l_int|5
)braket
op_or_assign
l_int|0x60
suffix:semicolon
multiline_comment|/* delay sync for 3 clocks (to same picture position on MGA and VGA) */
id|hw-&gt;CRTC
(braket
l_int|6
)braket
op_assign
id|vt
op_amp
l_int|0xFF
suffix:semicolon
id|hw-&gt;CRTC
(braket
l_int|7
)braket
op_assign
(paren
(paren
id|vt
op_amp
l_int|0x100
)paren
op_rshift
l_int|8
)paren
op_or
(paren
(paren
id|vd
op_amp
l_int|0x100
)paren
op_rshift
l_int|7
)paren
op_or
(paren
(paren
id|vs
op_amp
l_int|0x100
)paren
op_rshift
l_int|6
)paren
op_or
(paren
(paren
id|vd
op_amp
l_int|0x100
)paren
op_rshift
l_int|5
)paren
op_or
l_int|0x10
op_or
(paren
(paren
id|vt
op_amp
l_int|0x200
)paren
op_rshift
l_int|4
)paren
op_or
(paren
(paren
id|vd
op_amp
l_int|0x200
)paren
op_rshift
l_int|3
)paren
op_or
(paren
(paren
id|vs
op_amp
l_int|0x200
)paren
op_rshift
l_int|2
)paren
suffix:semicolon
id|hw-&gt;CRTC
(braket
l_int|8
)braket
op_assign
l_int|0x00
suffix:semicolon
id|hw-&gt;CRTC
(braket
l_int|9
)braket
op_assign
(paren
(paren
id|vd
op_amp
l_int|0x200
)paren
op_rshift
l_int|4
)paren
op_or
l_int|0x40
suffix:semicolon
r_if
c_cond
(paren
id|text
)paren
id|hw-&gt;CRTC
(braket
l_int|9
)braket
op_or_assign
id|fontheight
c_func
(paren
id|p
)paren
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|m-&gt;dblscan
op_logical_and
op_logical_neg
id|m-&gt;interlaced
)paren
id|hw-&gt;CRTC
(braket
l_int|9
)braket
op_or_assign
l_int|0x80
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|10
suffix:semicolon
id|i
OL
l_int|16
suffix:semicolon
id|i
op_increment
)paren
id|hw-&gt;CRTC
(braket
id|i
)braket
op_assign
l_int|0x00
suffix:semicolon
id|hw-&gt;CRTC
(braket
l_int|16
)braket
op_assign
id|vs
multiline_comment|/* &amp; 0xFF */
suffix:semicolon
id|hw-&gt;CRTC
(braket
l_int|17
)braket
op_assign
(paren
id|ve
op_amp
l_int|0x0F
)paren
op_or
l_int|0x20
suffix:semicolon
id|hw-&gt;CRTC
(braket
l_int|18
)braket
op_assign
id|vd
multiline_comment|/* &amp; 0xFF */
suffix:semicolon
id|hw-&gt;CRTC
(braket
l_int|19
)braket
op_assign
id|wd
multiline_comment|/* &amp; 0xFF */
suffix:semicolon
id|hw-&gt;CRTC
(braket
l_int|20
)braket
op_assign
l_int|0x00
suffix:semicolon
id|hw-&gt;CRTC
(braket
l_int|21
)braket
op_assign
id|vd
multiline_comment|/* &amp; 0xFF */
suffix:semicolon
id|hw-&gt;CRTC
(braket
l_int|22
)braket
op_assign
(paren
id|vt
op_plus
l_int|1
)paren
multiline_comment|/* &amp; 0xFF */
suffix:semicolon
r_if
c_cond
(paren
id|text
)paren
(brace
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textmode
)paren
op_eq
l_int|1
)paren
id|hw-&gt;CRTC
(braket
l_int|23
)braket
op_assign
l_int|0xC3
suffix:semicolon
r_else
id|hw-&gt;CRTC
(braket
l_int|23
)braket
op_assign
l_int|0xA3
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textmode
)paren
op_eq
l_int|4
)paren
id|hw-&gt;CRTC
(braket
l_int|20
)braket
op_assign
l_int|0x5F
suffix:semicolon
r_else
id|hw-&gt;CRTC
(braket
l_int|20
)braket
op_assign
l_int|0x1F
suffix:semicolon
)brace
r_else
id|hw-&gt;CRTC
(braket
l_int|23
)braket
op_assign
l_int|0xC3
suffix:semicolon
id|hw-&gt;CRTC
(braket
l_int|24
)braket
op_assign
l_int|0xFF
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
suffix:semicolon
macro_line|#ifdef NEED_DAC1064
DECL|variable|MGA1064_DAC_regs
r_static
r_const
r_int
r_char
id|MGA1064_DAC_regs
(braket
)braket
op_assign
(brace
id|M1064_XCURADDL
comma
id|M1064_XCURADDH
comma
id|M1064_XCURCTRL
comma
id|M1064_XCURCOL0RED
comma
id|M1064_XCURCOL0GREEN
comma
id|M1064_XCURCOL0BLUE
comma
id|M1064_XCURCOL1RED
comma
id|M1064_XCURCOL1GREEN
comma
id|M1064_XCURCOL1BLUE
comma
id|M1064_XCURCOL2RED
comma
id|M1064_XCURCOL2GREEN
comma
id|M1064_XCURCOL2BLUE
comma
id|DAC1064_XVREFCTRL
comma
id|M1064_XMULCTRL
comma
id|M1064_XPIXCLKCTRL
comma
id|M1064_XGENCTRL
comma
id|M1064_XMISCCTRL
comma
id|M1064_XGENIOCTRL
comma
id|M1064_XGENIODATA
comma
id|M1064_XZOOMCTRL
comma
id|M1064_XSENSETEST
comma
id|M1064_XCRCBITSEL
comma
id|M1064_XCOLKEYMASKL
comma
id|M1064_XCOLKEYMASKH
comma
id|M1064_XCOLKEYL
comma
id|M1064_XCOLKEYH
)brace
suffix:semicolon
DECL|macro|POS1064_XCURADDL
mdefine_line|#define POS1064_XCURADDL&t;&t; 0
DECL|macro|POS1064_XCURADDH
mdefine_line|#define POS1064_XCURADDH&t;&t; 1
DECL|macro|POS1064_XVREFCTRL
mdefine_line|#define POS1064_XVREFCTRL&t;&t;12
DECL|macro|POS1064_XMULCTRL
mdefine_line|#define POS1064_XMULCTRL&t;&t;13
DECL|macro|POS1064_XGENCTRL
mdefine_line|#define POS1064_XGENCTRL&t;&t;15
DECL|macro|POS1064_XMISCCTRL
mdefine_line|#define POS1064_XMISCCTRL&t;&t;16
DECL|variable|MGA1064_DAC
r_static
r_const
r_int
r_char
id|MGA1064_DAC
(braket
)braket
op_assign
(brace
l_int|0x00
comma
l_int|0x00
comma
id|M1064_XCURCTRL_DIS
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
multiline_comment|/* black */
l_int|0xFF
comma
l_int|0xFF
comma
l_int|0xFF
comma
multiline_comment|/* white */
l_int|0xFF
comma
l_int|0x00
comma
l_int|0x00
comma
multiline_comment|/* red */
l_int|0x00
comma
l_int|0
comma
id|M1064_XPIXCLKCTRL_PLL_UP
op_or
id|M1064_XPIXCLKCTRL_EN
op_or
id|M1064_XPIXCLKCTRL_SRC_PLL
comma
id|M1064_XGENCTRL_VS_0
op_or
id|M1064_XGENCTRL_ALPHA_DIS
op_or
id|M1064_XGENCTRL_BLACK_0IRE
op_or
id|M1064_XGENCTRL_NO_SYNC_ON_GREEN
comma
id|M1064_XMISCCTRL_DAC_EN
op_or
id|M1064_XMISCCTRL_MFC_DIS
op_or
id|M1064_XMISCCTRL_DAC_8BIT
op_or
id|M1064_XMISCCTRL_LUT_EN
comma
l_int|0x10
comma
l_int|0x3F
comma
id|M1064_XZOOMCTRL_1
comma
id|M1064_XSENSETEST_BCOMP
op_or
id|M1064_XSENSETEST_GCOMP
op_or
id|M1064_XSENSETEST_RCOMP
op_or
id|M1064_XSENSETEST_PDOWN
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0xFF
comma
l_int|0xFF
)brace
suffix:semicolon
DECL|function|DAC1064_setpclk
r_static
r_void
id|DAC1064_setpclk
c_func
(paren
id|CPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
comma
r_int
r_int
id|fout
)paren
(brace
r_int
r_int
id|m
comma
id|n
comma
id|p
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;DAC1064_setpclk&quot;
)paren
id|DAC1064_calcclock
c_func
(paren
id|PMINFO
id|fout
comma
id|ACCESS_FBINFO
c_func
(paren
id|max_pixel_clock
)paren
comma
op_amp
id|m
comma
op_amp
id|n
comma
op_amp
id|p
)paren
suffix:semicolon
id|hw-&gt;DACclk
(braket
l_int|0
)braket
op_assign
id|m
suffix:semicolon
id|hw-&gt;DACclk
(braket
l_int|1
)braket
op_assign
id|n
suffix:semicolon
id|hw-&gt;DACclk
(braket
l_int|2
)braket
op_assign
id|p
suffix:semicolon
)brace
DECL|function|DAC1064_setmclk
r_static
r_void
id|__init
(def_block
id|DAC1064_setmclk
c_func
(paren
id|CPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
comma
r_int
id|oscinfo
comma
r_int
r_int
id|fmem
)paren
(brace
id|u_int32_t
id|mx
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;DAC1064_setmclk&quot;
)paren
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.noinit
)paren
)paren
(brace
multiline_comment|/* read MCLK and give up... */
id|hw-&gt;DACclk
(braket
l_int|3
)braket
op_assign
id|inDAC1064
c_func
(paren
id|PMINFO
id|DAC1064_XSYSPLLM
)paren
suffix:semicolon
id|hw-&gt;DACclk
(braket
l_int|4
)braket
op_assign
id|inDAC1064
c_func
(paren
id|PMINFO
id|DAC1064_XSYSPLLN
)paren
suffix:semicolon
id|hw-&gt;DACclk
(braket
l_int|5
)braket
op_assign
id|inDAC1064
c_func
(paren
id|PMINFO
id|DAC1064_XSYSPLLP
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|mx
op_assign
id|hw-&gt;MXoptionReg
op_or
l_int|0x00000004
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_OPTION_REG
comma
id|mx
)paren
suffix:semicolon
id|mx
op_and_assign
op_complement
l_int|0x000000BB
suffix:semicolon
r_if
c_cond
(paren
id|oscinfo
op_amp
id|DAC1064_OPT_GDIV1
)paren
id|mx
op_or_assign
l_int|0x00000008
suffix:semicolon
r_if
c_cond
(paren
id|oscinfo
op_amp
id|DAC1064_OPT_MDIV1
)paren
id|mx
op_or_assign
l_int|0x00000010
suffix:semicolon
r_if
c_cond
(paren
id|oscinfo
op_amp
id|DAC1064_OPT_RESERVED
)paren
id|mx
op_or_assign
l_int|0x00000080
suffix:semicolon
r_if
c_cond
(paren
(paren
id|oscinfo
op_amp
id|DAC1064_OPT_SCLK_MASK
)paren
op_eq
id|DAC1064_OPT_SCLK_PLL
)paren
(brace
multiline_comment|/* select PCI clock until we have setup oscilator... */
r_int
id|clk
suffix:semicolon
r_int
r_int
id|m
comma
id|n
comma
id|p
suffix:semicolon
multiline_comment|/* powerup system PLL, select PCI clock */
id|mx
op_or_assign
l_int|0x00000020
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_OPTION_REG
comma
id|mx
)paren
suffix:semicolon
id|mx
op_and_assign
op_complement
l_int|0x00000004
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_OPTION_REG
comma
id|mx
)paren
suffix:semicolon
multiline_comment|/* !!! you must not access device if MCLK is not running !!!&n;&t;&t;   Doing so cause immediate PCI lockup :-( Maybe they should&n;&t;&t;   generate ABORT or I/O (parity...) error and Linux should &n;&t;&t;   recover from this... (kill driver/process). But world is not&n;&t;&t;   perfect... */
multiline_comment|/* (bit 2 of PCI_OPTION_REG must be 0... and bits 0,1 must not&n;&t;&t;   select PLL... because of PLL can be stopped at this time) */
id|DAC1064_calcclock
c_func
(paren
id|PMINFO
id|fmem
comma
id|ACCESS_FBINFO
c_func
(paren
id|max_pixel_clock
)paren
comma
op_amp
id|m
comma
op_amp
id|n
comma
op_amp
id|p
)paren
suffix:semicolon
id|outDAC1064
c_func
(paren
id|PMINFO
id|DAC1064_XSYSPLLM
comma
id|hw-&gt;DACclk
(braket
l_int|3
)braket
op_assign
id|m
)paren
suffix:semicolon
id|outDAC1064
c_func
(paren
id|PMINFO
id|DAC1064_XSYSPLLN
comma
id|hw-&gt;DACclk
(braket
l_int|4
)braket
op_assign
id|n
)paren
suffix:semicolon
id|outDAC1064
c_func
(paren
id|PMINFO
id|DAC1064_XSYSPLLP
comma
id|hw-&gt;DACclk
(braket
l_int|5
)braket
op_assign
id|p
)paren
suffix:semicolon
r_for
c_loop
(paren
id|clk
op_assign
l_int|65536
suffix:semicolon
id|clk
suffix:semicolon
op_decrement
id|clk
)paren
(brace
r_if
c_cond
(paren
id|inDAC1064
c_func
(paren
id|PMINFO
id|DAC1064_XSYSPLLSTAT
)paren
op_amp
l_int|0x40
)paren
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|clk
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: aiee, SYSPLL not locked&bslash;n&quot;
)paren
suffix:semicolon
multiline_comment|/* select PLL */
id|mx
op_or_assign
l_int|0x00000005
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* select specified system clock source */
id|mx
op_or_assign
id|oscinfo
op_amp
id|DAC1064_OPT_SCLK_MASK
suffix:semicolon
)brace
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_OPTION_REG
comma
id|mx
)paren
suffix:semicolon
id|mx
op_and_assign
op_complement
l_int|0x00000004
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_OPTION_REG
comma
id|mx
)paren
suffix:semicolon
id|hw-&gt;MXoptionReg
op_assign
id|mx
suffix:semicolon
)brace
)def_block
DECL|function|DAC1064_init_1
r_static
r_int
id|DAC1064_init_1
c_func
(paren
id|CPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
comma
r_struct
id|my_timming
op_star
id|m
comma
r_struct
id|display
op_star
id|p
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;DAC1064_init_1&quot;
)paren
id|memcpy
c_func
(paren
id|hw-&gt;DACreg
comma
id|MGA1064_DAC
comma
r_sizeof
(paren
id|MGA1064_DAC_regs
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|p-&gt;type
op_eq
id|FB_TYPE_TEXT
)paren
(brace
id|hw-&gt;DACreg
(braket
id|POS1064_XMISCCTRL
)braket
op_assign
id|M1064_XMISCCTRL_DAC_EN
op_or
id|M1064_XMISCCTRL_MFC_DIS
op_or
id|M1064_XMISCCTRL_DAC_6BIT
op_or
id|M1064_XMISCCTRL_LUT_EN
suffix:semicolon
id|hw-&gt;DACreg
(braket
id|POS1064_XMULCTRL
)braket
op_assign
id|M1064_XMULCTRL_DEPTH_8BPP
op_or
id|M1064_XMULCTRL_GRAPHICS_PALETIZED
suffix:semicolon
)brace
r_else
(brace
r_switch
c_cond
(paren
id|p-&gt;var.bits_per_pixel
)paren
(brace
multiline_comment|/* case 4: not supported by MGA1064 DAC */
r_case
l_int|8
suffix:colon
id|hw-&gt;DACreg
(braket
id|POS1064_XMULCTRL
)braket
op_assign
id|M1064_XMULCTRL_DEPTH_8BPP
op_or
id|M1064_XMULCTRL_GRAPHICS_PALETIZED
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|16
suffix:colon
r_if
c_cond
(paren
id|p-&gt;var.green.length
op_eq
l_int|5
)paren
id|hw-&gt;DACreg
(braket
id|POS1064_XMULCTRL
)braket
op_assign
id|M1064_XMULCTRL_DEPTH_15BPP_1BPP
op_or
id|M1064_XMULCTRL_GRAPHICS_PALETIZED
suffix:semicolon
r_else
id|hw-&gt;DACreg
(braket
id|POS1064_XMULCTRL
)braket
op_assign
id|M1064_XMULCTRL_DEPTH_16BPP
op_or
id|M1064_XMULCTRL_GRAPHICS_PALETIZED
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|24
suffix:colon
id|hw-&gt;DACreg
(braket
id|POS1064_XMULCTRL
)braket
op_assign
id|M1064_XMULCTRL_DEPTH_24BPP
op_or
id|M1064_XMULCTRL_GRAPHICS_PALETIZED
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|32
suffix:colon
id|hw-&gt;DACreg
(braket
id|POS1064_XMULCTRL
)braket
op_assign
id|M1064_XMULCTRL_DEPTH_32BPP
op_or
id|M1064_XMULCTRL_GRAPHICS_PALETIZED
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
l_int|1
suffix:semicolon
multiline_comment|/* unsupported depth */
)brace
)brace
id|hw-&gt;DACreg
(braket
id|POS1064_XVREFCTRL
)braket
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|features.DAC1064.xvrefctrl
)paren
suffix:semicolon
id|hw-&gt;DACreg
(braket
id|POS1064_XGENCTRL
)braket
op_and_assign
op_complement
id|M1064_XGENCTRL_SYNC_ON_GREEN_MASK
suffix:semicolon
id|hw-&gt;DACreg
(braket
id|POS1064_XGENCTRL
)braket
op_or_assign
(paren
id|m-&gt;sync
op_amp
id|FB_SYNC_ON_GREEN
)paren
ques
c_cond
id|M1064_XGENCTRL_SYNC_ON_GREEN
suffix:colon
id|M1064_XGENCTRL_NO_SYNC_ON_GREEN
suffix:semicolon
id|hw-&gt;DACreg
(braket
id|POS1064_XCURADDL
)braket
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|features.DAC1064.cursorimage
)paren
op_rshift
l_int|10
suffix:semicolon
id|hw-&gt;DACreg
(braket
id|POS1064_XCURADDH
)braket
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|features.DAC1064.cursorimage
)paren
op_rshift
l_int|18
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|DAC1064_init_2
r_static
r_int
id|DAC1064_init_2
c_func
(paren
id|CPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
comma
r_struct
id|my_timming
op_star
id|m
comma
r_struct
id|display
op_star
id|p
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;DAC1064_init_2&quot;
)paren
id|DAC1064_setpclk
c_func
(paren
id|PMINFO
id|hw
comma
id|m-&gt;pixclock
)paren
suffix:semicolon
r_if
c_cond
(paren
id|p-&gt;var.bits_per_pixel
OG
l_int|16
)paren
(brace
multiline_comment|/* 256 entries */
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|256
suffix:semicolon
id|i
op_increment
)paren
(brace
id|hw-&gt;DACpal
(braket
id|i
op_star
l_int|3
op_plus
l_int|0
)braket
op_assign
id|i
suffix:semicolon
id|hw-&gt;DACpal
(braket
id|i
op_star
l_int|3
op_plus
l_int|1
)braket
op_assign
id|i
suffix:semicolon
id|hw-&gt;DACpal
(braket
id|i
op_star
l_int|3
op_plus
l_int|2
)braket
op_assign
id|i
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|p-&gt;var.bits_per_pixel
OG
l_int|8
)paren
(brace
r_if
c_cond
(paren
id|p-&gt;var.green.length
op_eq
l_int|5
)paren
(brace
multiline_comment|/* 0..31, 128..159 */
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|32
suffix:semicolon
id|i
op_increment
)paren
(brace
multiline_comment|/* with p15 == 0 */
id|hw-&gt;DACpal
(braket
id|i
op_star
l_int|3
op_plus
l_int|0
)braket
op_assign
id|i
op_lshift
l_int|3
suffix:semicolon
id|hw-&gt;DACpal
(braket
id|i
op_star
l_int|3
op_plus
l_int|1
)braket
op_assign
id|i
op_lshift
l_int|3
suffix:semicolon
id|hw-&gt;DACpal
(braket
id|i
op_star
l_int|3
op_plus
l_int|2
)braket
op_assign
id|i
op_lshift
l_int|3
suffix:semicolon
multiline_comment|/* with p15 == 1 */
id|hw-&gt;DACpal
(braket
(paren
id|i
op_plus
l_int|128
)paren
op_star
l_int|3
op_plus
l_int|0
)braket
op_assign
id|i
op_lshift
l_int|3
suffix:semicolon
id|hw-&gt;DACpal
(braket
(paren
id|i
op_plus
l_int|128
)paren
op_star
l_int|3
op_plus
l_int|1
)braket
op_assign
id|i
op_lshift
l_int|3
suffix:semicolon
id|hw-&gt;DACpal
(braket
(paren
id|i
op_plus
l_int|128
)paren
op_star
l_int|3
op_plus
l_int|2
)braket
op_assign
id|i
op_lshift
l_int|3
suffix:semicolon
)brace
)brace
r_else
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|64
suffix:semicolon
id|i
op_increment
)paren
(brace
multiline_comment|/* 0..63 */
id|hw-&gt;DACpal
(braket
id|i
op_star
l_int|3
op_plus
l_int|0
)braket
op_assign
id|i
op_lshift
l_int|3
suffix:semicolon
id|hw-&gt;DACpal
(braket
id|i
op_star
l_int|3
op_plus
l_int|1
)braket
op_assign
id|i
op_lshift
l_int|2
suffix:semicolon
id|hw-&gt;DACpal
(braket
id|i
op_star
l_int|3
op_plus
l_int|2
)braket
op_assign
id|i
op_lshift
l_int|3
suffix:semicolon
)brace
)brace
)brace
r_else
(brace
id|memset
c_func
(paren
id|hw-&gt;DACpal
comma
l_int|0
comma
l_int|768
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|DAC1064_restore_1
r_static
r_void
id|DAC1064_restore_1
c_func
(paren
id|CPMINFO
r_const
r_struct
id|matrox_hw_state
op_star
id|hw
comma
r_const
r_struct
id|matrox_hw_state
op_star
id|oldhw
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;DAC1064_restore_1&quot;
)paren
id|CRITBEGIN
id|outDAC1064
c_func
(paren
id|PMINFO
id|DAC1064_XSYSPLLM
comma
id|hw-&gt;DACclk
(braket
l_int|3
)braket
)paren
suffix:semicolon
id|outDAC1064
c_func
(paren
id|PMINFO
id|DAC1064_XSYSPLLN
comma
id|hw-&gt;DACclk
(braket
l_int|4
)braket
)paren
suffix:semicolon
id|outDAC1064
c_func
(paren
id|PMINFO
id|DAC1064_XSYSPLLP
comma
id|hw-&gt;DACclk
(braket
l_int|5
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|oldhw
op_logical_or
id|memcmp
c_func
(paren
id|hw-&gt;DACreg
comma
id|oldhw-&gt;DACreg
comma
r_sizeof
(paren
id|MGA1064_DAC_regs
)paren
)paren
)paren
(brace
r_int
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
r_sizeof
(paren
id|MGA1064_DAC_regs
)paren
suffix:semicolon
id|i
op_increment
)paren
id|outDAC1064
c_func
(paren
id|PMINFO
id|MGA1064_DAC_regs
(braket
id|i
)braket
comma
id|hw-&gt;DACreg
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
id|CRITEND
)brace
DECL|function|DAC1064_restore_2
r_static
r_void
id|DAC1064_restore_2
c_func
(paren
id|WPMINFO
r_const
r_struct
id|matrox_hw_state
op_star
id|hw
comma
r_const
r_struct
id|matrox_hw_state
op_star
id|oldhw
comma
r_struct
id|display
op_star
id|p
)paren
(brace
r_int
r_int
id|i
suffix:semicolon
r_int
r_int
id|tmout
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;DAC1064_restore_2&quot;
)paren
id|CRITBEGIN
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|3
suffix:semicolon
id|i
op_increment
)paren
id|outDAC1064
c_func
(paren
id|PMINFO
id|M1064_XPIXPLLCM
op_plus
id|i
comma
id|hw-&gt;DACclk
(braket
id|i
)braket
)paren
suffix:semicolon
r_for
c_loop
(paren
id|tmout
op_assign
l_int|500000
suffix:semicolon
id|tmout
suffix:semicolon
id|tmout
op_decrement
)paren
(brace
r_if
c_cond
(paren
id|inDAC1064
c_func
(paren
id|PMINFO
id|M1064_XPIXPLLSTAT
)paren
op_amp
l_int|0x40
)paren
r_break
suffix:semicolon
id|udelay
c_func
(paren
l_int|10
)paren
suffix:semicolon
)brace
suffix:semicolon
id|CRITEND
r_if
c_cond
(paren
op_logical_neg
id|tmout
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: Pixel PLL not locked after 5 secs&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|p
op_logical_and
id|p-&gt;conp
)paren
(brace
r_if
c_cond
(paren
id|p-&gt;type
op_eq
id|FB_TYPE_TEXT
)paren
(brace
id|matrox_text_createcursor
c_func
(paren
id|PMINFO
id|p
)paren
suffix:semicolon
id|matrox_text_loadfont
c_func
(paren
id|PMINFO
id|p
)paren
suffix:semicolon
id|i
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|matroxfb_DAC1064_createcursor
c_func
(paren
id|PMINFO
id|p
)paren
suffix:semicolon
id|i
op_assign
id|matroxfb_fastfont_tryset
c_func
(paren
id|PMINFO
id|p
)paren
suffix:semicolon
)brace
)brace
r_else
id|i
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|i
)paren
(brace
id|ACCESS_FBINFO
c_func
(paren
id|curr.putc
)paren
op_assign
id|matrox_cfbX_fastputc
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|curr.putcs
)paren
op_assign
id|matrox_cfbX_fastputcs
suffix:semicolon
)brace
r_else
(brace
id|ACCESS_FBINFO
c_func
(paren
id|curr.putc
)paren
op_assign
id|matrox_cfbX_putc
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|curr.putcs
)paren
op_assign
id|matrox_cfbX_putcs
suffix:semicolon
)brace
macro_line|#ifdef DEBUG
id|dprintk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;DAC1064regs &quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
r_sizeof
(paren
id|MGA1064_DAC_regs
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
id|dprintk
c_func
(paren
l_string|&quot;R%02X=%02X &quot;
comma
id|MGA1064_DAC_regs
(braket
id|i
)braket
comma
id|hw-&gt;DACreg
(braket
id|i
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|i
op_amp
l_int|0x7
)paren
op_eq
l_int|0x7
)paren
id|dprintk
c_func
(paren
l_string|&quot;&bslash;n&quot;
id|KERN_DEBUG
l_string|&quot;continuing... &quot;
)paren
suffix:semicolon
)brace
id|dprintk
c_func
(paren
l_string|&quot;&bslash;n&quot;
id|KERN_DEBUG
l_string|&quot;DAC1064clk &quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|6
suffix:semicolon
id|i
op_increment
)paren
id|dprintk
c_func
(paren
l_string|&quot;C%02X=%02X &quot;
comma
id|i
comma
id|hw-&gt;DACclk
(braket
id|i
)braket
)paren
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#endif
)brace
macro_line|#endif /* NEED_DAC1064 */
macro_line|#ifdef CONFIG_FB_MATROX_MYSTIQUE
DECL|function|MGA1064_init
r_static
r_int
id|MGA1064_init
c_func
(paren
id|CPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
comma
r_struct
id|my_timming
op_star
id|m
comma
r_struct
id|display
op_star
id|p
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;MGA1064_init&quot;
)paren
r_if
c_cond
(paren
id|DAC1064_init_1
c_func
(paren
id|PMINFO
id|hw
comma
id|m
comma
id|p
)paren
)paren
r_return
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|vgaHWinit
c_func
(paren
id|PMINFO
id|hw
comma
id|m
comma
id|p
)paren
)paren
r_return
l_int|1
suffix:semicolon
id|hw-&gt;MiscOutReg
op_assign
l_int|0xCB
suffix:semicolon
r_if
c_cond
(paren
id|m-&gt;sync
op_amp
id|FB_SYNC_HOR_HIGH_ACT
)paren
id|hw-&gt;MiscOutReg
op_and_assign
op_complement
l_int|0x40
suffix:semicolon
r_if
c_cond
(paren
id|m-&gt;sync
op_amp
id|FB_SYNC_VERT_HIGH_ACT
)paren
id|hw-&gt;MiscOutReg
op_and_assign
op_complement
l_int|0x80
suffix:semicolon
r_if
c_cond
(paren
id|m-&gt;sync
op_amp
id|FB_SYNC_COMP_HIGH_ACT
)paren
multiline_comment|/* should be only FB_SYNC_COMP */
id|hw-&gt;CRTCEXT
(braket
l_int|3
)braket
op_or_assign
l_int|0x40
suffix:semicolon
r_if
c_cond
(paren
id|DAC1064_init_2
c_func
(paren
id|PMINFO
id|hw
comma
id|m
comma
id|p
)paren
)paren
r_return
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif
macro_line|#ifdef CONFIG_FB_MATROX_G100
DECL|function|MGAG100_init
r_static
r_int
id|MGAG100_init
c_func
(paren
id|CPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
comma
r_struct
id|my_timming
op_star
id|m
comma
r_struct
id|display
op_star
id|p
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;MGAG100_init&quot;
)paren
r_if
c_cond
(paren
id|DAC1064_init_1
c_func
(paren
id|PMINFO
id|hw
comma
id|m
comma
id|p
)paren
)paren
r_return
l_int|1
suffix:semicolon
id|hw-&gt;MXoptionReg
op_and_assign
op_complement
l_int|0x2000
suffix:semicolon
r_if
c_cond
(paren
id|vgaHWinit
c_func
(paren
id|PMINFO
id|hw
comma
id|m
comma
id|p
)paren
)paren
r_return
l_int|1
suffix:semicolon
id|hw-&gt;MiscOutReg
op_assign
l_int|0xEF
suffix:semicolon
r_if
c_cond
(paren
id|m-&gt;sync
op_amp
id|FB_SYNC_HOR_HIGH_ACT
)paren
id|hw-&gt;MiscOutReg
op_and_assign
op_complement
l_int|0x40
suffix:semicolon
r_if
c_cond
(paren
id|m-&gt;sync
op_amp
id|FB_SYNC_VERT_HIGH_ACT
)paren
id|hw-&gt;MiscOutReg
op_and_assign
op_complement
l_int|0x80
suffix:semicolon
r_if
c_cond
(paren
id|m-&gt;sync
op_amp
id|FB_SYNC_COMP_HIGH_ACT
)paren
multiline_comment|/* should be only FB_SYNC_COMP */
id|hw-&gt;CRTCEXT
(braket
l_int|3
)braket
op_or_assign
l_int|0x40
suffix:semicolon
r_if
c_cond
(paren
id|DAC1064_init_2
c_func
(paren
id|PMINFO
id|hw
comma
id|m
comma
id|p
)paren
)paren
r_return
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif&t;/* G100 */
macro_line|#ifdef CONFIG_FB_MATROX_MILLENIUM
DECL|function|Ti3026_init
r_static
r_int
id|Ti3026_init
c_func
(paren
id|CPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
comma
r_struct
id|my_timming
op_star
id|m
comma
r_struct
id|display
op_star
id|p
)paren
(brace
id|u_int8_t
id|muxctrl
op_assign
id|isInterleave
c_func
(paren
id|MINFO
)paren
ques
c_cond
id|TVP3026_XMUXCTRL_MEMORY_64BIT
suffix:colon
id|TVP3026_XMUXCTRL_MEMORY_32BIT
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;Ti3026_init&quot;
)paren
id|memcpy
c_func
(paren
id|hw-&gt;DACreg
comma
id|MGADACbpp32
comma
r_sizeof
(paren
id|hw-&gt;DACreg
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|p-&gt;type
op_eq
id|FB_TYPE_TEXT
)paren
(brace
id|hw-&gt;DACreg
(braket
id|POS3026_XLATCHCTRL
)braket
op_assign
id|TVP3026_XLATCHCTRL_8_1
suffix:semicolon
id|hw-&gt;DACreg
(braket
id|POS3026_XTRUECOLORCTRL
)braket
op_assign
id|TVP3026_XTRUECOLORCTRL_PSEUDOCOLOR
suffix:semicolon
id|hw-&gt;DACreg
(braket
id|POS3026_XMUXCTRL
)braket
op_assign
id|TVP3026_XMUXCTRL_VGA
suffix:semicolon
id|hw-&gt;DACreg
(braket
id|POS3026_XCLKCTRL
)braket
op_assign
id|TVP3026_XCLKCTRL_SRC_PLL
op_or
id|TVP3026_XCLKCTRL_DIV4
suffix:semicolon
id|hw-&gt;DACreg
(braket
id|POS3026_XMISCCTRL
)braket
op_assign
id|TVP3026_XMISCCTRL_DAC_PUP
op_or
id|TVP3026_XMISCCTRL_DAC_6BIT
op_or
id|TVP3026_XMISCCTRL_PSEL_DIS
op_or
id|TVP3026_XMISCCTRL_PSEL_LOW
suffix:semicolon
)brace
r_else
(brace
r_switch
c_cond
(paren
id|p-&gt;var.bits_per_pixel
)paren
(brace
r_case
l_int|4
suffix:colon
id|hw-&gt;DACreg
(braket
id|POS3026_XLATCHCTRL
)braket
op_assign
id|TVP3026_XLATCHCTRL_16_1
suffix:semicolon
multiline_comment|/* or _8_1, they are same */
id|hw-&gt;DACreg
(braket
id|POS3026_XTRUECOLORCTRL
)braket
op_assign
id|TVP3026_XTRUECOLORCTRL_PSEUDOCOLOR
suffix:semicolon
id|hw-&gt;DACreg
(braket
id|POS3026_XMUXCTRL
)braket
op_assign
id|muxctrl
op_or
id|TVP3026_XMUXCTRL_PIXEL_4BIT
suffix:semicolon
id|hw-&gt;DACreg
(braket
id|POS3026_XCLKCTRL
)braket
op_assign
id|TVP3026_XCLKCTRL_SRC_PLL
op_or
id|TVP3026_XCLKCTRL_DIV8
suffix:semicolon
id|hw-&gt;DACreg
(braket
id|POS3026_XMISCCTRL
)braket
op_assign
id|TVP3026_XMISCCTRL_DAC_PUP
op_or
id|TVP3026_XMISCCTRL_DAC_8BIT
op_or
id|TVP3026_XMISCCTRL_PSEL_DIS
op_or
id|TVP3026_XMISCCTRL_PSEL_LOW
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|8
suffix:colon
id|hw-&gt;DACreg
(braket
id|POS3026_XLATCHCTRL
)braket
op_assign
id|TVP3026_XLATCHCTRL_8_1
suffix:semicolon
multiline_comment|/* or _4_1, they are same */
id|hw-&gt;DACreg
(braket
id|POS3026_XTRUECOLORCTRL
)braket
op_assign
id|TVP3026_XTRUECOLORCTRL_PSEUDOCOLOR
suffix:semicolon
id|hw-&gt;DACreg
(braket
id|POS3026_XMUXCTRL
)braket
op_assign
id|muxctrl
op_or
id|TVP3026_XMUXCTRL_PIXEL_8BIT
suffix:semicolon
id|hw-&gt;DACreg
(braket
id|POS3026_XCLKCTRL
)braket
op_assign
id|TVP3026_XCLKCTRL_SRC_PLL
op_or
id|TVP3026_XCLKCTRL_DIV4
suffix:semicolon
id|hw-&gt;DACreg
(braket
id|POS3026_XMISCCTRL
)braket
op_assign
id|TVP3026_XMISCCTRL_DAC_PUP
op_or
id|TVP3026_XMISCCTRL_DAC_8BIT
op_or
id|TVP3026_XMISCCTRL_PSEL_DIS
op_or
id|TVP3026_XMISCCTRL_PSEL_LOW
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|16
suffix:colon
multiline_comment|/* XLATCHCTRL should be _4_1 / _2_1... Why is not? (_2_1 is used everytime) */
id|hw-&gt;DACreg
(braket
id|POS3026_XTRUECOLORCTRL
)braket
op_assign
(paren
id|p-&gt;var.green.length
op_eq
l_int|5
)paren
ques
c_cond
(paren
id|TVP3026_XTRUECOLORCTRL_DIRECTCOLOR
op_or
id|TVP3026_XTRUECOLORCTRL_ORGB_1555
)paren
suffix:colon
(paren
id|TVP3026_XTRUECOLORCTRL_DIRECTCOLOR
op_or
id|TVP3026_XTRUECOLORCTRL_RGB_565
)paren
suffix:semicolon
id|hw-&gt;DACreg
(braket
id|POS3026_XMUXCTRL
)braket
op_assign
id|muxctrl
op_or
id|TVP3026_XMUXCTRL_PIXEL_16BIT
suffix:semicolon
id|hw-&gt;DACreg
(braket
id|POS3026_XCLKCTRL
)braket
op_assign
id|TVP3026_XCLKCTRL_SRC_PLL
op_or
id|TVP3026_XCLKCTRL_DIV2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|24
suffix:colon
multiline_comment|/* XLATCHCTRL is: for (A) use _4_3 (?_8_3 is same? TBD), for (B) it is set in setpclk */
id|hw-&gt;DACreg
(braket
id|POS3026_XTRUECOLORCTRL
)braket
op_assign
id|TVP3026_XTRUECOLORCTRL_DIRECTCOLOR
op_or
id|TVP3026_XTRUECOLORCTRL_RGB_888
suffix:semicolon
id|hw-&gt;DACreg
(braket
id|POS3026_XMUXCTRL
)braket
op_assign
id|muxctrl
op_or
id|TVP3026_XMUXCTRL_PIXEL_32BIT
suffix:semicolon
id|hw-&gt;DACreg
(braket
id|POS3026_XCLKCTRL
)braket
op_assign
id|TVP3026_XCLKCTRL_SRC_PLL
op_or
id|TVP3026_XCLKCTRL_DIV4
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|32
suffix:colon
multiline_comment|/* XLATCHCTRL should be _2_1 / _1_1... Why is not? (_2_1 is used everytime) */
id|hw-&gt;DACreg
(braket
id|POS3026_XMUXCTRL
)braket
op_assign
id|muxctrl
op_or
id|TVP3026_XMUXCTRL_PIXEL_32BIT
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
l_int|1
suffix:semicolon
multiline_comment|/* TODO: failed */
)brace
)brace
r_if
c_cond
(paren
id|vgaHWinit
c_func
(paren
id|PMINFO
id|hw
comma
id|m
comma
id|p
)paren
)paren
r_return
l_int|1
suffix:semicolon
multiline_comment|/* set SYNC */
id|hw-&gt;MiscOutReg
op_assign
l_int|0xCB
suffix:semicolon
r_if
c_cond
(paren
id|m-&gt;sync
op_amp
id|FB_SYNC_HOR_HIGH_ACT
)paren
id|hw-&gt;DACreg
(braket
id|POS3026_XGENCTRL
)braket
op_or_assign
id|TVP3026_XGENCTRL_HSYNC_NEG
suffix:semicolon
r_if
c_cond
(paren
id|m-&gt;sync
op_amp
id|FB_SYNC_VERT_HIGH_ACT
)paren
id|hw-&gt;DACreg
(braket
id|POS3026_XGENCTRL
)braket
op_or_assign
id|TVP3026_XGENCTRL_VSYNC_NEG
suffix:semicolon
r_if
c_cond
(paren
id|m-&gt;sync
op_amp
id|FB_SYNC_ON_GREEN
)paren
id|hw-&gt;DACreg
(braket
id|POS3026_XGENCTRL
)braket
op_or_assign
id|TVP3026_XGENCTRL_SYNC_ON_GREEN
suffix:semicolon
multiline_comment|/* set DELAY */
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.len
)paren
OL
l_int|0x400000
)paren
id|hw-&gt;CRTCEXT
(braket
l_int|3
)braket
op_or_assign
l_int|0x08
suffix:semicolon
r_else
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.len
)paren
OG
l_int|0x400000
)paren
id|hw-&gt;CRTCEXT
(braket
l_int|3
)braket
op_or_assign
l_int|0x10
suffix:semicolon
multiline_comment|/* set HWCURSOR */
r_if
c_cond
(paren
id|m-&gt;interlaced
)paren
(brace
id|hw-&gt;DACreg
(braket
id|POS3026_XCURCTRL
)braket
op_or_assign
id|TVP3026_XCURCTRL_INTERLACED
suffix:semicolon
)brace
r_if
c_cond
(paren
id|m-&gt;HTotal
op_ge
l_int|1536
)paren
id|hw-&gt;DACreg
(braket
id|POS3026_XCURCTRL
)braket
op_or_assign
id|TVP3026_XCURCTRL_BLANK4096
suffix:semicolon
multiline_comment|/* set interleaving */
id|hw-&gt;MXoptionReg
op_and_assign
op_complement
l_int|0x00001000
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p-&gt;type
op_ne
id|FB_TYPE_TEXT
)paren
op_logical_and
id|isInterleave
c_func
(paren
id|MINFO
)paren
)paren
id|hw-&gt;MXoptionReg
op_or_assign
l_int|0x00001000
suffix:semicolon
multiline_comment|/* set DAC */
id|Ti3026_setpclk
c_func
(paren
id|PMINFO
id|hw
comma
id|m-&gt;pixclock
comma
id|p
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif&t;/* CONFIG_FB_MATROX_MILLENIUM */
DECL|function|matroxfb_get_cmap_len
r_static
r_int
id|matroxfb_get_cmap_len
c_func
(paren
r_struct
id|fb_var_screeninfo
op_star
id|var
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;matroxfb_get_cmap_len&quot;
)paren
r_switch
c_cond
(paren
id|var-&gt;bits_per_pixel
)paren
(brace
macro_line|#ifdef FBCON_HAS_VGATEXT
r_case
l_int|0
suffix:colon
r_return
l_int|16
suffix:semicolon
multiline_comment|/* pseudocolor... 16 entries HW palette */
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB4
r_case
l_int|4
suffix:colon
r_return
l_int|16
suffix:semicolon
multiline_comment|/* pseudocolor... 16 entries HW palette */
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB8
r_case
l_int|8
suffix:colon
r_return
l_int|256
suffix:semicolon
multiline_comment|/* pseudocolor... 256 entries HW palette */
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB16
r_case
l_int|16
suffix:colon
r_return
l_int|16
suffix:semicolon
multiline_comment|/* directcolor... 16 entries SW palette */
multiline_comment|/* Mystique: truecolor, 16 entries SW palette, HW palette hardwired into 1:1 mapping */
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB24
r_case
l_int|24
suffix:colon
r_return
l_int|16
suffix:semicolon
multiline_comment|/* directcolor... 16 entries SW palette */
multiline_comment|/* Mystique: truecolor, 16 entries SW palette, HW palette hardwired into 1:1 mapping */
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB32
r_case
l_int|32
suffix:colon
r_return
l_int|16
suffix:semicolon
multiline_comment|/* directcolor... 16 entries SW palette */
multiline_comment|/* Mystique: truecolor, 16 entries SW palette, HW palette hardwired into 1:1 mapping */
macro_line|#endif
)brace
r_return
l_int|16
suffix:semicolon
multiline_comment|/* return something reasonable... or panic()? */
)brace
DECL|function|matroxfb_decode_var
r_static
r_int
id|matroxfb_decode_var
c_func
(paren
id|CPMINFO
r_struct
id|display
op_star
id|p
comma
r_struct
id|fb_var_screeninfo
op_star
id|var
comma
r_int
op_star
id|visual
comma
r_int
op_star
id|video_cmap_len
comma
r_int
r_int
op_star
id|ydstorg
)paren
(brace
r_int
r_int
id|vramlen
suffix:semicolon
r_int
r_int
id|memlen
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;matroxfb_decode_var&quot;
)paren
r_switch
c_cond
(paren
id|var-&gt;bits_per_pixel
)paren
(brace
macro_line|#ifdef FBCON_HAS_VGATEXT
r_case
l_int|0
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|ACCESS_FBINFO
c_func
(paren
id|capable.text
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB4
r_case
l_int|4
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|ACCESS_FBINFO
c_func
(paren
id|capable.cfb4
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB8
r_case
l_int|8
suffix:colon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB16
r_case
l_int|16
suffix:colon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB24
r_case
l_int|24
suffix:colon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB32
r_case
l_int|32
suffix:colon
r_break
suffix:semicolon
macro_line|#endif
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
op_star
id|ydstorg
op_assign
l_int|0
suffix:semicolon
id|vramlen
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|video.len_usable
)paren
suffix:semicolon
r_if
c_cond
(paren
id|var-&gt;bits_per_pixel
)paren
(brace
id|var-&gt;xres_virtual
op_assign
id|matroxfb_pitch_adjust
c_func
(paren
id|PMINFO
id|var-&gt;xres_virtual
comma
id|var-&gt;bits_per_pixel
)paren
suffix:semicolon
id|memlen
op_assign
id|var-&gt;xres_virtual
op_star
id|var-&gt;bits_per_pixel
op_star
id|var-&gt;yres_virtual
op_div
l_int|8
suffix:semicolon
r_if
c_cond
(paren
id|memlen
OG
id|vramlen
)paren
(brace
id|var-&gt;yres_virtual
op_assign
id|vramlen
op_star
l_int|8
op_div
(paren
id|var-&gt;xres_virtual
op_star
id|var-&gt;bits_per_pixel
)paren
suffix:semicolon
id|memlen
op_assign
id|var-&gt;xres_virtual
op_star
id|var-&gt;bits_per_pixel
op_star
id|var-&gt;yres_virtual
op_div
l_int|8
suffix:semicolon
)brace
multiline_comment|/* There is hardware bug that no line can cross 4MB boundary */
multiline_comment|/* give up for CFB24, it is impossible to easy workaround it */
multiline_comment|/* for other try to do something */
r_if
c_cond
(paren
op_logical_neg
id|ACCESS_FBINFO
c_func
(paren
id|capable.cross4MB
)paren
op_logical_and
(paren
id|memlen
OG
l_int|0x400000
)paren
)paren
(brace
r_if
c_cond
(paren
id|var-&gt;bits_per_pixel
op_eq
l_int|24
)paren
(brace
multiline_comment|/* sorry */
)brace
r_else
(brace
r_int
r_int
id|linelen
suffix:semicolon
r_int
r_int
id|m1
op_assign
id|linelen
op_assign
id|var-&gt;xres_virtual
op_star
id|var-&gt;bits_per_pixel
op_div
l_int|8
suffix:semicolon
r_int
r_int
id|m2
op_assign
id|PAGE_SIZE
suffix:semicolon
multiline_comment|/* or 128 if you do not need PAGE ALIGNED address */
r_int
r_int
id|max_yres
suffix:semicolon
r_while
c_loop
(paren
id|m1
)paren
(brace
r_int
id|t
suffix:semicolon
r_while
c_loop
(paren
id|m2
op_ge
id|m1
)paren
id|m2
op_sub_assign
id|m1
suffix:semicolon
id|t
op_assign
id|m1
suffix:semicolon
id|m1
op_assign
id|m2
suffix:semicolon
id|m2
op_assign
id|t
suffix:semicolon
)brace
id|m2
op_assign
id|linelen
op_star
id|PAGE_SIZE
op_div
id|m2
suffix:semicolon
op_star
id|ydstorg
op_assign
id|m2
op_assign
l_int|0x400000
op_mod
id|m2
suffix:semicolon
id|max_yres
op_assign
(paren
id|vramlen
op_minus
id|m2
)paren
op_div
id|linelen
suffix:semicolon
r_if
c_cond
(paren
id|var-&gt;yres_virtual
OG
id|max_yres
)paren
id|var-&gt;yres_virtual
op_assign
id|max_yres
suffix:semicolon
)brace
)brace
)brace
r_else
(brace
id|matrox_text_round
c_func
(paren
id|PMINFO
id|var
comma
id|p
)paren
suffix:semicolon
macro_line|#if 0
multiline_comment|/* we must limit pixclock by mclk... &n;   Millenium I:    66 MHz = 15000&n;   Millenium II:   61 MHz = 16300&n;   Millenium G200: 83 MHz = 12000 */
r_if
c_cond
(paren
id|var-&gt;pixclock
OL
l_int|15000
)paren
id|var-&gt;pixclock
op_assign
l_int|15000
suffix:semicolon
multiline_comment|/* limit for &quot;normal&quot; gclk &amp; mclk */
macro_line|#endif
)brace
multiline_comment|/* YDSTLEN contains only signed 16bit value */
r_if
c_cond
(paren
id|var-&gt;yres_virtual
OG
l_int|32767
)paren
id|var-&gt;yres_virtual
op_assign
l_int|32767
suffix:semicolon
r_if
c_cond
(paren
id|var-&gt;yres_virtual
OL
id|var-&gt;yres
)paren
id|var-&gt;yres
op_assign
id|var-&gt;yres_virtual
suffix:semicolon
r_if
c_cond
(paren
id|var-&gt;xres_virtual
OL
id|var-&gt;xres
)paren
id|var-&gt;xres
op_assign
id|var-&gt;xres_virtual
suffix:semicolon
r_if
c_cond
(paren
id|var-&gt;xoffset
op_plus
id|var-&gt;xres
OG
id|var-&gt;xres_virtual
)paren
id|var-&gt;xoffset
op_assign
id|var-&gt;xres_virtual
op_minus
id|var-&gt;xres
suffix:semicolon
r_if
c_cond
(paren
id|var-&gt;yoffset
op_plus
id|var-&gt;yres
OG
id|var-&gt;yres_virtual
)paren
id|var-&gt;yoffset
op_assign
id|var-&gt;yres_virtual
op_minus
id|var-&gt;yres
suffix:semicolon
r_if
c_cond
(paren
id|var-&gt;bits_per_pixel
op_eq
l_int|0
)paren
(brace
id|var-&gt;red.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;red.length
op_assign
l_int|6
suffix:semicolon
id|var-&gt;green.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;green.length
op_assign
l_int|6
suffix:semicolon
id|var-&gt;blue.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;blue.length
op_assign
l_int|6
suffix:semicolon
id|var-&gt;transp.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;transp.length
op_assign
l_int|0
suffix:semicolon
op_star
id|visual
op_assign
id|MX_VISUAL_PSEUDOCOLOR
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|var-&gt;bits_per_pixel
op_eq
l_int|4
)paren
(brace
id|var-&gt;red.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;red.length
op_assign
l_int|8
suffix:semicolon
id|var-&gt;green.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;green.length
op_assign
l_int|8
suffix:semicolon
id|var-&gt;blue.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;blue.length
op_assign
l_int|8
suffix:semicolon
id|var-&gt;transp.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;transp.length
op_assign
l_int|0
suffix:semicolon
op_star
id|visual
op_assign
id|MX_VISUAL_PSEUDOCOLOR
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|var-&gt;bits_per_pixel
op_le
l_int|8
)paren
(brace
id|var-&gt;red.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;red.length
op_assign
l_int|8
suffix:semicolon
id|var-&gt;green.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;green.length
op_assign
l_int|8
suffix:semicolon
id|var-&gt;blue.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;blue.length
op_assign
l_int|8
suffix:semicolon
id|var-&gt;transp.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;transp.length
op_assign
l_int|0
suffix:semicolon
op_star
id|visual
op_assign
id|MX_VISUAL_PSEUDOCOLOR
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|var-&gt;bits_per_pixel
op_le
l_int|16
)paren
(brace
r_if
c_cond
(paren
id|var-&gt;green.length
op_eq
l_int|5
)paren
(brace
id|var-&gt;red.offset
op_assign
l_int|10
suffix:semicolon
id|var-&gt;red.length
op_assign
l_int|5
suffix:semicolon
id|var-&gt;green.offset
op_assign
l_int|5
suffix:semicolon
id|var-&gt;green.length
op_assign
l_int|5
suffix:semicolon
id|var-&gt;blue.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;blue.length
op_assign
l_int|5
suffix:semicolon
id|var-&gt;transp.offset
op_assign
l_int|15
suffix:semicolon
id|var-&gt;transp.length
op_assign
l_int|1
suffix:semicolon
)brace
r_else
(brace
id|var-&gt;red.offset
op_assign
l_int|11
suffix:semicolon
id|var-&gt;red.length
op_assign
l_int|5
suffix:semicolon
id|var-&gt;green.offset
op_assign
l_int|5
suffix:semicolon
id|var-&gt;green.length
op_assign
l_int|6
suffix:semicolon
id|var-&gt;blue.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;blue.length
op_assign
l_int|5
suffix:semicolon
id|var-&gt;transp.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;transp.length
op_assign
l_int|0
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|var-&gt;bits_per_pixel
op_le
l_int|24
)paren
(brace
id|var-&gt;red.offset
op_assign
l_int|16
suffix:semicolon
id|var-&gt;red.length
op_assign
l_int|8
suffix:semicolon
id|var-&gt;green.offset
op_assign
l_int|8
suffix:semicolon
id|var-&gt;green.length
op_assign
l_int|8
suffix:semicolon
id|var-&gt;blue.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;blue.length
op_assign
l_int|8
suffix:semicolon
id|var-&gt;transp.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;transp.length
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|var-&gt;red.offset
op_assign
l_int|16
suffix:semicolon
id|var-&gt;red.length
op_assign
l_int|8
suffix:semicolon
id|var-&gt;green.offset
op_assign
l_int|8
suffix:semicolon
id|var-&gt;green.length
op_assign
l_int|8
suffix:semicolon
id|var-&gt;blue.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;blue.length
op_assign
l_int|8
suffix:semicolon
id|var-&gt;transp.offset
op_assign
l_int|24
suffix:semicolon
id|var-&gt;transp.length
op_assign
l_int|8
suffix:semicolon
)brace
id|dprintk
c_func
(paren
l_string|&quot;matroxfb: truecolor: &quot;
l_string|&quot;size=%d:%d:%d:%d, shift=%d:%d:%d:%d&bslash;n&quot;
comma
id|var-&gt;transp.length
comma
id|var-&gt;red.length
comma
id|var-&gt;green.length
comma
id|var-&gt;blue.length
comma
id|var-&gt;transp.offset
comma
id|var-&gt;red.offset
comma
id|var-&gt;green.offset
comma
id|var-&gt;blue.offset
)paren
suffix:semicolon
op_star
id|visual
op_assign
id|MX_VISUAL_DIRECTCOLOR
suffix:semicolon
)brace
op_star
id|video_cmap_len
op_assign
id|matroxfb_get_cmap_len
c_func
(paren
id|var
)paren
suffix:semicolon
id|dprintk
c_func
(paren
id|KERN_INFO
l_string|&quot;requested %d*%d/%dbpp (%d*%d)&bslash;n&quot;
comma
id|var-&gt;xres
comma
id|var-&gt;yres
comma
id|var-&gt;bits_per_pixel
comma
id|var-&gt;xres_virtual
comma
id|var-&gt;yres_virtual
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_FB_MATROX_MILLENIUM
DECL|function|ti3026_setMCLK
r_static
r_void
id|__init
(def_block
id|ti3026_setMCLK
c_func
(paren
id|CPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
comma
r_int
id|fout
)paren
(brace
r_int
r_int
id|f_pll
suffix:semicolon
r_int
r_int
id|pclk_m
comma
id|pclk_n
comma
id|pclk_p
suffix:semicolon
r_int
r_int
id|mclk_m
comma
id|mclk_n
comma
id|mclk_p
suffix:semicolon
r_int
r_int
id|rfhcnt
comma
id|mclk_ctl
suffix:semicolon
r_int
id|tmout
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;ti3026_setMCLK&quot;
)paren
id|f_pll
op_assign
id|Ti3026_calcclock
c_func
(paren
id|PMINFO
id|fout
comma
id|ACCESS_FBINFO
c_func
(paren
id|max_pixel_clock
)paren
comma
op_amp
id|mclk_n
comma
op_amp
id|mclk_m
comma
op_amp
id|mclk_p
)paren
suffix:semicolon
multiline_comment|/* save pclk */
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPLLADDR
comma
l_int|0xFC
)paren
suffix:semicolon
id|pclk_n
op_assign
id|inTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPIXPLLDATA
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPLLADDR
comma
l_int|0xFD
)paren
suffix:semicolon
id|pclk_m
op_assign
id|inTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPIXPLLDATA
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPLLADDR
comma
l_int|0xFE
)paren
suffix:semicolon
id|pclk_p
op_assign
id|inTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPIXPLLDATA
)paren
suffix:semicolon
multiline_comment|/* stop pclk */
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPLLADDR
comma
l_int|0xFE
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPIXPLLDATA
comma
l_int|0x00
)paren
suffix:semicolon
multiline_comment|/* set pclk to new mclk */
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPLLADDR
comma
l_int|0xFC
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPIXPLLDATA
comma
id|mclk_n
op_or
l_int|0xC0
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPIXPLLDATA
comma
id|mclk_m
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPIXPLLDATA
comma
id|mclk_p
op_or
l_int|0xB0
)paren
suffix:semicolon
multiline_comment|/* wait for PLL to lock */
r_for
c_loop
(paren
id|tmout
op_assign
l_int|500000
suffix:semicolon
id|tmout
suffix:semicolon
id|tmout
op_decrement
)paren
(brace
r_if
c_cond
(paren
id|inTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPIXPLLDATA
)paren
op_amp
l_int|0x40
)paren
r_break
suffix:semicolon
id|udelay
c_func
(paren
l_int|10
)paren
suffix:semicolon
)brace
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|tmout
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: Temporary pixel PLL not locked after 5 secs&bslash;n&quot;
)paren
suffix:semicolon
multiline_comment|/* output pclk on mclk pin */
id|mclk_ctl
op_assign
id|inTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XMEMPLLCTRL
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XMEMPLLCTRL
comma
id|mclk_ctl
op_amp
l_int|0xE7
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XMEMPLLCTRL
comma
(paren
id|mclk_ctl
op_amp
l_int|0xE7
)paren
op_or
id|TVP3026_XMEMPLLCTRL_STROBEMKC4
)paren
suffix:semicolon
multiline_comment|/* stop MCLK */
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPLLADDR
comma
l_int|0xFB
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XMEMPLLDATA
comma
l_int|0x00
)paren
suffix:semicolon
multiline_comment|/* set mclk to new freq */
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPLLADDR
comma
l_int|0xF3
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XMEMPLLDATA
comma
id|mclk_n
op_or
l_int|0xC0
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XMEMPLLDATA
comma
id|mclk_m
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XMEMPLLDATA
comma
id|mclk_p
op_or
l_int|0xB0
)paren
suffix:semicolon
multiline_comment|/* wait for PLL to lock */
r_for
c_loop
(paren
id|tmout
op_assign
l_int|500000
suffix:semicolon
id|tmout
suffix:semicolon
id|tmout
op_decrement
)paren
(brace
r_if
c_cond
(paren
id|inTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XMEMPLLDATA
)paren
op_amp
l_int|0x40
)paren
r_break
suffix:semicolon
id|udelay
c_func
(paren
l_int|10
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|tmout
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: Memory PLL not locked after 5 secs&bslash;n&quot;
)paren
suffix:semicolon
id|f_pll
op_assign
id|f_pll
op_star
l_int|333
op_div
(paren
l_int|10000
op_lshift
id|mclk_p
)paren
suffix:semicolon
r_if
c_cond
(paren
id|isMilleniumII
c_func
(paren
id|MINFO
)paren
)paren
(brace
id|rfhcnt
op_assign
(paren
id|f_pll
op_minus
l_int|128
)paren
op_div
l_int|256
suffix:semicolon
r_if
c_cond
(paren
id|rfhcnt
OG
l_int|15
)paren
id|rfhcnt
op_assign
l_int|15
suffix:semicolon
)brace
r_else
(brace
id|rfhcnt
op_assign
(paren
id|f_pll
op_minus
l_int|64
)paren
op_div
l_int|128
suffix:semicolon
r_if
c_cond
(paren
id|rfhcnt
OG
l_int|15
)paren
id|rfhcnt
op_assign
l_int|0
suffix:semicolon
)brace
id|hw-&gt;MXoptionReg
op_assign
(paren
id|hw-&gt;MXoptionReg
op_amp
op_complement
l_int|0x000F0000
)paren
op_or
(paren
id|rfhcnt
op_lshift
l_int|16
)paren
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_OPTION_REG
comma
id|hw-&gt;MXoptionReg
)paren
suffix:semicolon
multiline_comment|/* output MCLK to MCLK pin */
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XMEMPLLCTRL
comma
(paren
id|mclk_ctl
op_amp
l_int|0xE7
)paren
op_or
id|TVP3026_XMEMPLLCTRL_MCLK_MCLKPLL
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XMEMPLLCTRL
comma
(paren
id|mclk_ctl
)paren
op_or
id|TVP3026_XMEMPLLCTRL_MCLK_MCLKPLL
op_or
id|TVP3026_XMEMPLLCTRL_STROBEMKC4
)paren
suffix:semicolon
multiline_comment|/* stop PCLK */
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPLLADDR
comma
l_int|0xFE
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPIXPLLDATA
comma
l_int|0x00
)paren
suffix:semicolon
multiline_comment|/* restore pclk */
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPLLADDR
comma
l_int|0xFC
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPIXPLLDATA
comma
id|pclk_n
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPIXPLLDATA
comma
id|pclk_m
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPIXPLLDATA
comma
id|pclk_p
)paren
suffix:semicolon
multiline_comment|/* wait for PLL to lock */
r_for
c_loop
(paren
id|tmout
op_assign
l_int|500000
suffix:semicolon
id|tmout
suffix:semicolon
id|tmout
op_decrement
)paren
(brace
r_if
c_cond
(paren
id|inTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPIXPLLDATA
)paren
op_amp
l_int|0x40
)paren
r_break
suffix:semicolon
id|udelay
c_func
(paren
l_int|10
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|tmout
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: Pixel PLL not locked after 5 secs&bslash;n&quot;
)paren
suffix:semicolon
)brace
)def_block
DECL|function|ti3026_ramdac_init
r_static
r_void
id|__init
(def_block
id|ti3026_ramdac_init
c_func
(paren
id|WPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;ti3026_ramdac_init&quot;
)paren
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.vco_freq_min
)paren
op_assign
l_int|110000
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.ref_freq
)paren
op_assign
l_int|114545
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.feed_div_min
)paren
op_assign
l_int|2
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.feed_div_max
)paren
op_assign
l_int|24
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.in_div_min
)paren
op_assign
l_int|2
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.in_div_max
)paren
op_assign
l_int|63
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.post_shift_max
)paren
op_assign
l_int|3
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.noinit
)paren
)paren
r_return
suffix:semicolon
id|ti3026_setMCLK
c_func
(paren
id|PMINFO
id|hw
comma
l_int|60000
)paren
suffix:semicolon
)brace
)def_block
macro_line|#endif
DECL|function|matroxfb_fastfont_init
r_static
r_void
(def_block
id|matroxfb_fastfont_init
c_func
(paren
r_struct
id|matrox_fb_info
op_star
id|minfo
)paren
(brace
r_int
r_int
id|size
suffix:semicolon
id|size
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|fastfont.size
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fastfont.size
)paren
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|size
)paren
(brace
r_int
r_int
id|end
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|video.len_usable
)paren
suffix:semicolon
r_if
c_cond
(paren
id|size
OL
id|end
)paren
(brace
r_int
r_int
id|start
suffix:semicolon
id|start
op_assign
(paren
id|end
op_minus
id|size
)paren
op_amp
id|PAGE_MASK
suffix:semicolon
r_if
c_cond
(paren
id|start
op_ge
l_int|0x00100000
)paren
(brace
id|ACCESS_FBINFO
c_func
(paren
id|video.len_usable
)paren
op_assign
id|start
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fastfont.mgabase
)paren
op_assign
id|start
op_star
l_int|8
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fastfont.vbase
)paren
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
suffix:semicolon
id|vaddr_add
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|fastfont.vbase
)paren
comma
id|start
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fastfont.size
)paren
op_assign
id|end
op_minus
id|start
suffix:semicolon
)brace
)brace
)brace
)brace
)def_block
macro_line|#ifdef CONFIG_FB_MATROX_MYSTIQUE
DECL|function|MGA1064_ramdac_init
r_static
r_void
id|__init
(def_block
id|MGA1064_ramdac_init
c_func
(paren
id|WPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;MGA1064_ramdac_init&quot;
)paren
suffix:semicolon
multiline_comment|/* ACCESS_FBINFO(features.DAC1064.vco_freq_min) = 120000; */
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.vco_freq_min
)paren
op_assign
l_int|62000
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.ref_freq
)paren
op_assign
l_int|14318
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.feed_div_min
)paren
op_assign
l_int|100
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.feed_div_max
)paren
op_assign
l_int|127
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.in_div_min
)paren
op_assign
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.in_div_max
)paren
op_assign
l_int|31
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.post_shift_max
)paren
op_assign
l_int|3
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.DAC1064.xvrefctrl
)paren
op_assign
id|DAC1064_XVREFCTRL_EXTERNAL
suffix:semicolon
multiline_comment|/* maybe cmdline MCLK= ?, doc says gclk=44MHz, mclk=66MHz... it was 55/83 with old values */
id|DAC1064_setmclk
c_func
(paren
id|PMINFO
id|hw
comma
id|DAC1064_OPT_MDIV2
op_or
id|DAC1064_OPT_GDIV3
op_or
id|DAC1064_OPT_SCLK_PLL
comma
l_int|133333
)paren
suffix:semicolon
)brace
)def_block
DECL|function|MGA1064_preinit
r_static
r_int
id|__init
(def_block
id|MGA1064_preinit
c_func
(paren
id|WPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
)paren
(brace
r_static
r_const
r_int
id|vxres_mystique
(braket
)braket
op_assign
(brace
l_int|512
comma
l_int|640
comma
l_int|768
comma
l_int|800
comma
l_int|832
comma
l_int|960
comma
l_int|1024
comma
l_int|1152
comma
l_int|1280
comma
l_int|1600
comma
l_int|1664
comma
l_int|1920
comma
l_int|2048
comma
l_int|0
)brace
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;MGA1064_preinit&quot;
)paren
multiline_comment|/* ACCESS_FBINFO(capable.cfb4) = 0; ... preinitialized by 0 */
id|ACCESS_FBINFO
c_func
(paren
id|capable.text
)paren
op_assign
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|capable.vxres
)paren
op_assign
id|vxres_mystique
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.accel.has_cacheflush
)paren
op_assign
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|cursor.timer.function
)paren
op_assign
id|matroxfb_DAC1064_flashcursor
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.noinit
)paren
)paren
r_return
l_int|0
suffix:semicolon
multiline_comment|/* do not modify settings */
id|hw-&gt;MXoptionReg
op_and_assign
l_int|0xC0000100
suffix:semicolon
id|hw-&gt;MXoptionReg
op_or_assign
l_int|0x00094E20
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.novga
)paren
)paren
id|hw-&gt;MXoptionReg
op_and_assign
op_complement
l_int|0x00000100
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.nobios
)paren
)paren
id|hw-&gt;MXoptionReg
op_and_assign
op_complement
l_int|0x40000000
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.nopciretry
)paren
)paren
id|hw-&gt;MXoptionReg
op_or_assign
l_int|0x20000000
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_OPTION_REG
comma
id|hw-&gt;MXoptionReg
)paren
suffix:semicolon
id|mga_setr
c_func
(paren
id|M_SEQ_INDEX
comma
l_int|0x01
comma
l_int|0x20
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_CTLWTST
comma
l_int|0x00000000
)paren
suffix:semicolon
id|udelay
c_func
(paren
l_int|200
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_MACCESS
comma
l_int|0x00008000
)paren
suffix:semicolon
id|udelay
c_func
(paren
l_int|100
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_MACCESS
comma
l_int|0x0000C000
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
)def_block
DECL|function|MGA1064_reset
r_static
r_void
id|__init
(def_block
id|MGA1064_reset
c_func
(paren
id|WPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;MGA1064_reset&quot;
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.DAC1064.cursorimage
)paren
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|video.len_usable
)paren
op_minus
l_int|1024
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.hwcursor
)paren
)paren
id|ACCESS_FBINFO
c_func
(paren
id|video.len_usable
)paren
op_sub_assign
l_int|1024
suffix:semicolon
id|matroxfb_fastfont_init
c_func
(paren
id|MINFO
)paren
suffix:semicolon
id|MGA1064_ramdac_init
c_func
(paren
id|PMINFO
id|hw
)paren
suffix:semicolon
)brace
)def_block
macro_line|#endif
macro_line|#ifdef CONFIG_FB_MATROX_G100
multiline_comment|/* BIOS environ */
DECL|variable|x7AF4
r_static
r_int
id|x7AF4
op_assign
l_int|0x10
suffix:semicolon
multiline_comment|/* flags, maybe 0x10 = SDRAM, 0x00 = SGRAM??? */
multiline_comment|/* G100 wants 0x10, G200 SGRAM does not care... */
macro_line|#if 0 
r_static
r_int
id|def50
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* reg50, &amp; 0x0F, &amp; 0x3000 (only 0x0000, 0x1000, 0x2000 (0x3000 disallowed and treated as 0) */
macro_line|#endif
DECL|function|MGAG100_progPixClock
r_static
r_void
id|__init
(def_block
id|MGAG100_progPixClock
c_func
(paren
id|CPMINFO
r_int
id|flags
comma
r_int
id|m
comma
r_int
id|n
comma
r_int
id|p
)paren
(brace
r_int
id|reg
suffix:semicolon
r_int
id|selClk
suffix:semicolon
r_int
id|clk
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;MGAG100_progPixClock&quot;
)paren
id|outDAC1064
c_func
(paren
id|PMINFO
id|M1064_XPIXCLKCTRL
comma
id|inDAC1064
c_func
(paren
id|PMINFO
id|M1064_XPIXCLKCTRL
)paren
op_or
id|M1064_XPIXCLKCTRL_DIS
op_or
id|M1064_XPIXCLKCTRL_PLL_UP
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|flags
op_amp
l_int|3
)paren
(brace
r_case
l_int|0
suffix:colon
id|reg
op_assign
id|M1064_XPIXPLLAM
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|reg
op_assign
id|M1064_XPIXPLLBM
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|reg
op_assign
id|M1064_XPIXPLLCM
suffix:semicolon
r_break
suffix:semicolon
)brace
id|outDAC1064
c_func
(paren
id|PMINFO
id|reg
op_increment
comma
id|m
)paren
suffix:semicolon
id|outDAC1064
c_func
(paren
id|PMINFO
id|reg
op_increment
comma
id|n
)paren
suffix:semicolon
id|outDAC1064
c_func
(paren
id|PMINFO
id|reg
comma
id|p
)paren
suffix:semicolon
id|selClk
op_assign
id|mga_inb
c_func
(paren
id|M_MISC_REG_READ
)paren
op_amp
op_complement
l_int|0xC
suffix:semicolon
multiline_comment|/* there should be flags &amp; 0x03 &amp; case 0/1/else */
multiline_comment|/* and we should first select source and after that we should wait for PLL */
multiline_comment|/* and we are waiting for PLL with oscilator disabled... Is it right? */
r_switch
c_cond
(paren
id|flags
op_amp
l_int|0x03
)paren
(brace
r_case
l_int|0x00
suffix:colon
r_break
suffix:semicolon
r_case
l_int|0x01
suffix:colon
id|selClk
op_or_assign
l_int|4
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|selClk
op_or_assign
l_int|0x0C
suffix:semicolon
r_break
suffix:semicolon
)brace
id|mga_outb
c_func
(paren
id|M_MISC_REG
comma
id|selClk
)paren
suffix:semicolon
r_for
c_loop
(paren
id|clk
op_assign
l_int|500000
suffix:semicolon
id|clk
suffix:semicolon
id|clk
op_decrement
)paren
(brace
r_if
c_cond
(paren
id|inDAC1064
c_func
(paren
id|PMINFO
id|M1064_XPIXPLLSTAT
)paren
op_amp
l_int|0x40
)paren
r_break
suffix:semicolon
id|udelay
c_func
(paren
l_int|10
)paren
suffix:semicolon
)brace
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|clk
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: Pixel PLL%c not locked after usual time&bslash;n&quot;
comma
(paren
id|reg
op_minus
id|M1064_XPIXPLLAM
op_minus
l_int|2
)paren
op_div
l_int|4
op_plus
l_char|&squot;A&squot;
)paren
suffix:semicolon
id|selClk
op_assign
id|inDAC1064
c_func
(paren
id|PMINFO
id|M1064_XPIXCLKCTRL
)paren
op_amp
op_complement
id|M1064_XPIXCLKCTRL_SRC_MASK
suffix:semicolon
r_switch
c_cond
(paren
id|flags
op_amp
l_int|0x0C
)paren
(brace
r_case
l_int|0x00
suffix:colon
id|selClk
op_or_assign
id|M1064_XPIXCLKCTRL_SRC_PCI
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x04
suffix:colon
id|selClk
op_or_assign
id|M1064_XPIXCLKCTRL_SRC_PLL
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|selClk
op_or_assign
id|M1064_XPIXCLKCTRL_SRC_EXT
suffix:semicolon
r_break
suffix:semicolon
)brace
id|outDAC1064
c_func
(paren
id|PMINFO
id|M1064_XPIXCLKCTRL
comma
id|selClk
)paren
suffix:semicolon
id|outDAC1064
c_func
(paren
id|PMINFO
id|M1064_XPIXCLKCTRL
comma
id|inDAC1064
c_func
(paren
id|PMINFO
id|M1064_XPIXCLKCTRL
)paren
op_amp
op_complement
id|M1064_XPIXCLKCTRL_DIS
)paren
suffix:semicolon
)brace
)def_block
DECL|function|MGAG100_setPixClock
r_static
r_void
id|__init
(def_block
id|MGAG100_setPixClock
c_func
(paren
id|CPMINFO
r_int
id|flags
comma
r_int
id|freq
)paren
(brace
r_int
r_int
id|m
comma
id|n
comma
id|p
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;MGAG100_setPixClock&quot;
)paren
id|DAC1064_calcclock
c_func
(paren
id|PMINFO
id|freq
comma
id|ACCESS_FBINFO
c_func
(paren
id|max_pixel_clock
)paren
comma
op_amp
id|m
comma
op_amp
id|n
comma
op_amp
id|p
)paren
suffix:semicolon
id|MGAG100_progPixClock
c_func
(paren
id|PMINFO
id|flags
comma
id|m
comma
id|n
comma
id|p
)paren
suffix:semicolon
)brace
)def_block
DECL|function|MGAG100_preinit
r_static
r_int
id|__init
(def_block
id|MGAG100_preinit
c_func
(paren
id|WPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
)paren
(brace
r_static
r_const
r_int
id|vxres_g100
(braket
)braket
op_assign
(brace
l_int|512
comma
l_int|640
comma
l_int|768
comma
l_int|800
comma
l_int|832
comma
l_int|960
comma
l_int|1024
comma
l_int|1152
comma
l_int|1280
comma
l_int|1600
comma
l_int|1664
comma
l_int|1920
comma
l_int|2048
comma
l_int|0
)brace
suffix:semicolon
id|u_int32_t
id|reg50
suffix:semicolon
macro_line|#if 0
id|u_int32_t
id|q
suffix:semicolon
macro_line|#endif
id|DBG
c_func
(paren
l_string|&quot;MGAG100_preinit&quot;
)paren
multiline_comment|/* there are some instabilities if in_div &gt; 19 &amp;&amp; vco &lt; 61000 */
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.vco_freq_min
)paren
op_assign
l_int|62000
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.ref_freq
)paren
op_assign
l_int|27000
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.feed_div_min
)paren
op_assign
l_int|7
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.feed_div_max
)paren
op_assign
l_int|127
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.in_div_min
)paren
op_assign
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.in_div_max
)paren
op_assign
l_int|31
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.post_shift_max
)paren
op_assign
l_int|3
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.DAC1064.xvrefctrl
)paren
op_assign
id|DAC1064_XVREFCTRL_G100_DEFAULT
suffix:semicolon
multiline_comment|/* ACCESS_FBINFO(capable.cfb4) = 0; ... preinitialized by 0 */
id|ACCESS_FBINFO
c_func
(paren
id|capable.text
)paren
op_assign
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|capable.vxres
)paren
op_assign
id|vxres_g100
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.accel.has_cacheflush
)paren
op_assign
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|cursor.timer.function
)paren
op_assign
id|matroxfb_DAC1064_flashcursor
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|capable.plnwt
)paren
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|devflags.accelerator
)paren
op_ne
id|FB_ACCEL_MATROX_MGAG100
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.noinit
)paren
)paren
r_return
l_int|0
suffix:semicolon
id|hw-&gt;MXoptionReg
op_and_assign
l_int|0xC0000100
suffix:semicolon
id|hw-&gt;MXoptionReg
op_or_assign
l_int|0x00078020
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.novga
)paren
)paren
id|hw-&gt;MXoptionReg
op_and_assign
op_complement
l_int|0x00000100
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.nobios
)paren
)paren
id|hw-&gt;MXoptionReg
op_and_assign
op_complement
l_int|0x40000000
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.nopciretry
)paren
)paren
id|hw-&gt;MXoptionReg
op_or_assign
l_int|0x20000000
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_OPTION_REG
comma
id|hw-&gt;MXoptionReg
)paren
suffix:semicolon
id|pci_read_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
l_int|0x50
comma
op_amp
id|reg50
)paren
suffix:semicolon
id|reg50
op_and_assign
op_complement
l_int|0x3000
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
l_int|0x50
comma
id|reg50
)paren
suffix:semicolon
id|DAC1064_setmclk
c_func
(paren
id|PMINFO
id|hw
comma
id|DAC1064_OPT_MDIV2
op_or
id|DAC1064_OPT_GDIV3
op_or
id|DAC1064_OPT_SCLK_PCI
comma
l_int|133333
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.accelerator
)paren
op_eq
id|FB_ACCEL_MATROX_MGAG100
)paren
(brace
id|hw-&gt;MXoptionReg
op_or_assign
l_int|0x1080
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_OPTION_REG
comma
id|hw-&gt;MXoptionReg
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_CTLWTST
comma
l_int|0x00000300
)paren
suffix:semicolon
multiline_comment|/* mga_outl(M_CTLWTST, 0x03258A31); */
id|udelay
c_func
(paren
l_int|100
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
l_int|0x1C05
comma
l_int|0x00
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
l_int|0x1C05
comma
l_int|0x80
)paren
suffix:semicolon
id|udelay
c_func
(paren
l_int|100
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
l_int|0x1C05
comma
l_int|0x40
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
l_int|0x1C05
comma
l_int|0xC0
)paren
suffix:semicolon
id|udelay
c_func
(paren
l_int|100
)paren
suffix:semicolon
id|reg50
op_and_assign
op_complement
l_int|0xFF
suffix:semicolon
id|reg50
op_or_assign
l_int|0x07
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
l_int|0x50
comma
id|reg50
)paren
suffix:semicolon
multiline_comment|/* it should help with G100 */
id|mga_outb
c_func
(paren
id|M_GRAPHICS_INDEX
comma
l_int|6
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_GRAPHICS_DATA
comma
(paren
id|mga_inb
c_func
(paren
id|M_GRAPHICS_DATA
)paren
op_amp
l_int|3
)paren
op_or
l_int|4
)paren
suffix:semicolon
id|mga_setr
c_func
(paren
id|M_EXTVGA_INDEX
comma
l_int|0x03
comma
l_int|0x81
)paren
suffix:semicolon
id|mga_setr
c_func
(paren
id|M_EXTVGA_INDEX
comma
l_int|0x04
comma
l_int|0x00
)paren
suffix:semicolon
id|mga_writeb
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
comma
l_int|0x0000
comma
l_int|0xAA
)paren
suffix:semicolon
id|mga_writeb
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
comma
l_int|0x0800
comma
l_int|0x55
)paren
suffix:semicolon
id|mga_writeb
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
comma
l_int|0x4000
comma
l_int|0x55
)paren
suffix:semicolon
macro_line|#if 0
r_if
c_cond
(paren
id|mga_readb
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
comma
l_int|0x0000
)paren
op_ne
l_int|0xAA
)paren
(brace
id|hw-&gt;MXoptionReg
op_and_assign
op_complement
l_int|0x1000
suffix:semicolon
)brace
macro_line|#endif
)brace
r_else
(brace
id|hw-&gt;MXoptionReg
op_or_assign
l_int|0x00000C00
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.sgram
)paren
)paren
id|hw-&gt;MXoptionReg
op_or_assign
l_int|0x4000
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_CTLWTST
comma
l_int|0x042450A1
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
l_int|0x1E47
comma
l_int|0x00
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
l_int|0x1E46
comma
l_int|0x00
)paren
suffix:semicolon
id|udelay
c_func
(paren
l_int|10
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
l_int|0x1C05
comma
l_int|0x00
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
l_int|0x1C05
comma
l_int|0x80
)paren
suffix:semicolon
id|udelay
c_func
(paren
l_int|100
)paren
suffix:semicolon
id|mga_outw
c_func
(paren
l_int|0x1E44
comma
l_int|0x0108
)paren
suffix:semicolon
)brace
id|hw-&gt;MXoptionReg
op_assign
(paren
id|hw-&gt;MXoptionReg
op_amp
op_complement
l_int|0x1F8000
)paren
op_or
l_int|0x78000
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_OPTION_REG
comma
id|hw-&gt;MXoptionReg
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
)def_block
DECL|function|MGAG100_reset
r_static
r_void
id|__init
(def_block
id|MGAG100_reset
c_func
(paren
id|WPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
)paren
(brace
id|u_int8_t
id|b
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;MGAG100_reset&quot;
)paren
id|ACCESS_FBINFO
c_func
(paren
id|features.DAC1064.cursorimage
)paren
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|video.len_usable
)paren
op_minus
l_int|1024
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.hwcursor
)paren
)paren
id|ACCESS_FBINFO
c_func
(paren
id|video.len_usable
)paren
op_sub_assign
l_int|1024
suffix:semicolon
id|matroxfb_fastfont_init
c_func
(paren
id|MINFO
)paren
suffix:semicolon
(brace
macro_line|#ifdef G100_BROKEN_IBM_82351
id|u_int32_t
id|d
suffix:semicolon
id|find
l_int|1014
op_div
l_int|22
(paren
id|IBM
op_div
l_int|82351
)paren
suffix:semicolon
multiline_comment|/* if found and bridging Matrox, do some strange stuff */
id|pci_read_config_byte
c_func
(paren
id|ibm
comma
id|PCI_SECONDARY_BUS
comma
op_amp
id|b
)paren
suffix:semicolon
r_if
c_cond
(paren
id|b
op_eq
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
op_member_access_from_pointer
id|bus-&gt;number
)paren
(brace
id|pci_write_config_byte
c_func
(paren
id|ibm
comma
id|PCI_COMMAND
op_plus
l_int|1
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* disable back-to-back &amp; SERR */
id|pci_write_config_byte
c_func
(paren
id|ibm
comma
l_int|0x41
comma
l_int|0xF4
)paren
suffix:semicolon
multiline_comment|/* ??? */
id|pci_write_config_byte
c_func
(paren
id|ibm
comma
id|PCI_IO_BASE
comma
l_int|0xF0
)paren
suffix:semicolon
multiline_comment|/* ??? */
id|pci_write_config_byte
c_func
(paren
id|ibm
comma
id|PCI_IO_LIMIT
comma
l_int|0x00
)paren
suffix:semicolon
multiline_comment|/* ??? */
)brace
macro_line|#endif
r_if
c_cond
(paren
op_logical_neg
id|ACCESS_FBINFO
c_func
(paren
id|devflags.noinit
)paren
)paren
(brace
r_if
c_cond
(paren
id|x7AF4
op_amp
l_int|8
)paren
(brace
id|hw-&gt;MXoptionReg
op_or_assign
l_int|0x40
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_OPTION_REG
comma
id|hw-&gt;MXoptionReg
)paren
suffix:semicolon
)brace
id|mga_setr
c_func
(paren
id|M_EXTVGA_INDEX
comma
l_int|0x06
comma
l_int|0x50
)paren
suffix:semicolon
)brace
)brace
id|DAC1064_setmclk
c_func
(paren
id|PMINFO
id|hw
comma
id|DAC1064_OPT_RESERVED
op_or
id|DAC1064_OPT_MDIV2
op_or
id|DAC1064_OPT_GDIV1
op_or
id|DAC1064_OPT_SCLK_PLL
comma
l_int|133333
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.noinit
)paren
)paren
r_return
suffix:semicolon
id|MGAG100_setPixClock
c_func
(paren
id|PMINFO
l_int|4
comma
l_int|25175
)paren
suffix:semicolon
id|MGAG100_setPixClock
c_func
(paren
id|PMINFO
l_int|5
comma
l_int|28322
)paren
suffix:semicolon
r_if
c_cond
(paren
id|x7AF4
op_amp
l_int|0x10
)paren
(brace
id|b
op_assign
id|inDAC1064
c_func
(paren
id|PMINFO
id|M1064_XGENIODATA
)paren
op_amp
op_complement
l_int|1
suffix:semicolon
id|outDAC1064
c_func
(paren
id|PMINFO
id|M1064_XGENIODATA
comma
id|b
)paren
suffix:semicolon
id|b
op_assign
id|inDAC1064
c_func
(paren
id|PMINFO
id|M1064_XGENIOCTRL
)paren
op_or
l_int|1
suffix:semicolon
id|outDAC1064
c_func
(paren
id|PMINFO
id|M1064_XGENIOCTRL
comma
id|b
)paren
suffix:semicolon
)brace
)brace
)def_block
macro_line|#endif
DECL|function|vgaHWrestore
r_static
r_void
id|vgaHWrestore
c_func
(paren
id|CPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
comma
r_struct
id|matrox_hw_state
op_star
id|oldhw
)paren
(brace
r_int
id|i
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;vgaHWrestore&quot;
)paren
id|dprintk
c_func
(paren
id|KERN_INFO
l_string|&quot;MiscOutReg: %02X&bslash;n&quot;
comma
id|hw-&gt;MiscOutReg
)paren
suffix:semicolon
id|dprintk
c_func
(paren
id|KERN_INFO
l_string|&quot;SEQ regs:   &quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|5
suffix:semicolon
id|i
op_increment
)paren
id|dprintk
c_func
(paren
l_string|&quot;%02X:&quot;
comma
id|hw-&gt;SEQ
(braket
id|i
)braket
)paren
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|dprintk
c_func
(paren
id|KERN_INFO
l_string|&quot;GDC regs:   &quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|9
suffix:semicolon
id|i
op_increment
)paren
id|dprintk
c_func
(paren
l_string|&quot;%02X:&quot;
comma
id|hw-&gt;GCTL
(braket
id|i
)braket
)paren
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|dprintk
c_func
(paren
id|KERN_INFO
l_string|&quot;CRTC regs: &quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|25
suffix:semicolon
id|i
op_increment
)paren
id|dprintk
c_func
(paren
l_string|&quot;%02X:&quot;
comma
id|hw-&gt;CRTC
(braket
id|i
)braket
)paren
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|dprintk
c_func
(paren
id|KERN_INFO
l_string|&quot;ATTR regs: &quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|21
suffix:semicolon
id|i
op_increment
)paren
id|dprintk
c_func
(paren
l_string|&quot;%02X:&quot;
comma
id|hw-&gt;ATTR
(braket
id|i
)braket
)paren
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|CRITBEGIN
id|mga_inb
c_func
(paren
id|M_ATTR_RESET
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_ATTR_INDEX
comma
l_int|0
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_MISC_REG
comma
id|hw-&gt;MiscOutReg
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|1
suffix:semicolon
id|i
OL
l_int|5
suffix:semicolon
id|i
op_increment
)paren
id|mga_setr
c_func
(paren
id|M_SEQ_INDEX
comma
id|i
comma
id|hw-&gt;SEQ
(braket
id|i
)braket
)paren
suffix:semicolon
id|mga_setr
c_func
(paren
id|M_CRTC_INDEX
comma
l_int|17
comma
id|hw-&gt;CRTC
(braket
l_int|17
)braket
op_amp
l_int|0x7F
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|25
suffix:semicolon
id|i
op_increment
)paren
id|mga_setr
c_func
(paren
id|M_CRTC_INDEX
comma
id|i
comma
id|hw-&gt;CRTC
(braket
id|i
)braket
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|9
suffix:semicolon
id|i
op_increment
)paren
id|mga_setr
c_func
(paren
id|M_GRAPHICS_INDEX
comma
id|i
comma
id|hw-&gt;GCTL
(braket
id|i
)braket
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|21
suffix:semicolon
id|i
op_increment
)paren
(brace
id|mga_inb
c_func
(paren
id|M_ATTR_RESET
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_ATTR_INDEX
comma
id|i
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_ATTR_INDEX
comma
id|hw-&gt;ATTR
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
id|mga_outb
c_func
(paren
id|M_PALETTE_MASK
comma
l_int|0xFF
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_DAC_REG
comma
l_int|0x00
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|768
suffix:semicolon
id|i
op_increment
)paren
id|mga_outb
c_func
(paren
id|M_DAC_VAL
comma
id|hw-&gt;DACpal
(braket
id|i
)braket
)paren
suffix:semicolon
id|mga_inb
c_func
(paren
id|M_ATTR_RESET
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_ATTR_INDEX
comma
l_int|0x20
)paren
suffix:semicolon
id|CRITEND
)brace
DECL|function|matrox_setcolreg
r_static
r_int
id|matrox_setcolreg
c_func
(paren
r_int
id|regno
comma
r_int
id|red
comma
r_int
id|green
comma
r_int
id|blue
comma
r_int
id|transp
comma
r_struct
id|fb_info
op_star
id|fb_info
)paren
(brace
r_struct
id|display
op_star
id|p
suffix:semicolon
macro_line|#ifdef CONFIG_FB_MATROX_MULTIHEAD
r_struct
id|matrox_fb_info
op_star
id|minfo
op_assign
(paren
r_struct
id|matrox_fb_info
op_star
)paren
id|fb_info
suffix:semicolon
macro_line|#endif
id|DBG
c_func
(paren
l_string|&quot;matrox_setcolreg&quot;
)paren
multiline_comment|/*&n;&t; *  Set a single color register. The values supplied are&n;&t; *  already rounded down to the hardware&squot;s capabilities&n;&t; *  (according to the entries in the `var&squot; structure). Return&n;&t; *  != 0 for invalid regno.&n;&t; */
r_if
c_cond
(paren
id|regno
op_ge
id|ACCESS_FBINFO
c_func
(paren
id|curr.cmap_len
)paren
)paren
r_return
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|palette
(braket
id|regno
)braket
dot
id|red
)paren
op_assign
id|red
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|palette
(braket
id|regno
)braket
dot
id|green
)paren
op_assign
id|green
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|palette
(braket
id|regno
)braket
dot
id|blue
)paren
op_assign
id|blue
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|palette
(braket
id|regno
)braket
dot
id|transp
)paren
op_assign
id|transp
suffix:semicolon
id|p
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|currcon_display
)paren
suffix:semicolon
r_if
c_cond
(paren
id|p-&gt;var.grayscale
)paren
(brace
multiline_comment|/* gray = 0.30*R + 0.59*G + 0.11*B */
id|red
op_assign
id|green
op_assign
id|blue
op_assign
(paren
id|red
op_star
l_int|77
op_plus
id|green
op_star
l_int|151
op_plus
id|blue
op_star
l_int|28
)paren
op_rshift
l_int|8
suffix:semicolon
)brace
id|red
op_assign
id|CNVT_TOHW
c_func
(paren
id|red
comma
id|p-&gt;var.red.length
)paren
suffix:semicolon
id|green
op_assign
id|CNVT_TOHW
c_func
(paren
id|green
comma
id|p-&gt;var.green.length
)paren
suffix:semicolon
id|blue
op_assign
id|CNVT_TOHW
c_func
(paren
id|blue
comma
id|p-&gt;var.blue.length
)paren
suffix:semicolon
id|transp
op_assign
id|CNVT_TOHW
c_func
(paren
id|transp
comma
id|p-&gt;var.transp.length
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|p-&gt;var.bits_per_pixel
)paren
(brace
macro_line|#if defined(FBCON_HAS_CFB8) || defined(FBCON_HAS_CFB4) || defined(FBCON_HAS_VGATEXT)
macro_line|#ifdef FBCON_HAS_VGATEXT
r_case
l_int|0
suffix:colon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB4
r_case
l_int|4
suffix:colon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB8
r_case
l_int|8
suffix:colon
macro_line|#endif
id|mga_outb
c_func
(paren
id|M_DAC_REG
comma
id|regno
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_DAC_VAL
comma
id|red
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_DAC_VAL
comma
id|green
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_DAC_VAL
comma
id|blue
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB16&t;
r_case
l_int|16
suffix:colon
id|ACCESS_FBINFO
c_func
(paren
id|cmap.cfb16
(braket
id|regno
)braket
)paren
op_assign
(paren
id|red
op_lshift
id|p-&gt;var.red.offset
)paren
op_or
(paren
id|green
op_lshift
id|p-&gt;var.green.offset
)paren
op_or
(paren
id|blue
op_lshift
id|p-&gt;var.blue.offset
)paren
op_or
(paren
id|transp
op_lshift
id|p-&gt;var.transp.offset
)paren
suffix:semicolon
multiline_comment|/* for 1:5:5:5 */
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB24
r_case
l_int|24
suffix:colon
id|ACCESS_FBINFO
c_func
(paren
id|cmap.cfb24
(braket
id|regno
)braket
)paren
op_assign
(paren
id|red
op_lshift
id|p-&gt;var.red.offset
)paren
op_or
(paren
id|green
op_lshift
id|p-&gt;var.green.offset
)paren
op_or
(paren
id|blue
op_lshift
id|p-&gt;var.blue.offset
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB32
r_case
l_int|32
suffix:colon
id|ACCESS_FBINFO
c_func
(paren
id|cmap.cfb32
(braket
id|regno
)braket
)paren
op_assign
(paren
id|red
op_lshift
id|p-&gt;var.red.offset
)paren
op_or
(paren
id|green
op_lshift
id|p-&gt;var.green.offset
)paren
op_or
(paren
id|blue
op_lshift
id|p-&gt;var.blue.offset
)paren
op_or
(paren
id|transp
op_lshift
id|p-&gt;var.transp.offset
)paren
suffix:semicolon
multiline_comment|/* 8:8:8:8 */
r_break
suffix:semicolon
macro_line|#endif
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|do_install_cmap
r_static
r_void
id|do_install_cmap
c_func
(paren
id|WPMINFO
r_struct
id|display
op_star
id|dsp
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;do_install_cmap&quot;
)paren
r_if
c_cond
(paren
id|dsp-&gt;cmap.len
)paren
id|fb_set_cmap
c_func
(paren
op_amp
id|dsp-&gt;cmap
comma
l_int|1
comma
id|matrox_setcolreg
comma
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
)paren
suffix:semicolon
r_else
id|fb_set_cmap
c_func
(paren
id|fb_default_cmap
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|curr.cmap_len
)paren
)paren
comma
l_int|1
comma
id|matrox_setcolreg
comma
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
)paren
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_FB_MATROX_MYSTIQUE
DECL|function|MGA1064_restore
r_static
r_void
id|MGA1064_restore
c_func
(paren
id|WPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
comma
r_struct
id|matrox_hw_state
op_star
id|oldhw
comma
r_struct
id|display
op_star
id|p
)paren
(brace
r_int
id|i
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;MGA1064_restore&quot;
)paren
id|CRITBEGIN
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_OPTION_REG
comma
id|hw-&gt;MXoptionReg
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_IEN
comma
l_int|0x00
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_CACHEFLUSH
comma
l_int|0x00
)paren
suffix:semicolon
id|CRITEND
id|DAC1064_restore_1
c_func
(paren
id|PMINFO
id|hw
comma
id|oldhw
)paren
suffix:semicolon
id|vgaHWrestore
c_func
(paren
id|PMINFO
id|hw
comma
id|oldhw
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|6
suffix:semicolon
id|i
op_increment
)paren
id|mga_setr
c_func
(paren
id|M_EXTVGA_INDEX
comma
id|i
comma
id|hw-&gt;CRTCEXT
(braket
id|i
)braket
)paren
suffix:semicolon
id|DAC1064_restore_2
c_func
(paren
id|PMINFO
id|hw
comma
id|oldhw
comma
id|p
)paren
suffix:semicolon
)brace
macro_line|#endif
macro_line|#ifdef CONFIG_FB_MATROX_G100
DECL|function|MGAG100_restore
r_static
r_void
id|MGAG100_restore
c_func
(paren
id|WPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
comma
r_struct
id|matrox_hw_state
op_star
id|oldhw
comma
r_struct
id|display
op_star
id|p
)paren
(brace
r_int
id|i
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;MGAG100_restore&quot;
)paren
id|CRITBEGIN
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_OPTION_REG
comma
id|hw-&gt;MXoptionReg
)paren
suffix:semicolon
id|CRITEND
id|DAC1064_restore_1
c_func
(paren
id|PMINFO
id|hw
comma
id|oldhw
)paren
suffix:semicolon
id|vgaHWrestore
c_func
(paren
id|PMINFO
id|hw
comma
id|oldhw
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_FB_MATROX_32MB
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.support32MB
)paren
)paren
id|mga_setr
c_func
(paren
id|M_EXTVGA_INDEX
comma
l_int|8
comma
id|hw-&gt;CRTCEXT
(braket
l_int|8
)braket
)paren
suffix:semicolon
macro_line|#endif
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|6
suffix:semicolon
id|i
op_increment
)paren
id|mga_setr
c_func
(paren
id|M_EXTVGA_INDEX
comma
id|i
comma
id|hw-&gt;CRTCEXT
(braket
id|i
)braket
)paren
suffix:semicolon
id|DAC1064_restore_2
c_func
(paren
id|PMINFO
id|hw
comma
id|oldhw
comma
id|p
)paren
suffix:semicolon
)brace
macro_line|#endif
macro_line|#ifdef CONFIG_FB_MATROX_MILLENIUM
DECL|function|Ti3026_restore
r_static
r_void
id|Ti3026_restore
c_func
(paren
id|WPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
comma
r_struct
id|matrox_hw_state
op_star
id|oldhw
comma
r_struct
id|display
op_star
id|p
)paren
(brace
r_int
id|i
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;Ti3026_restore&quot;
)paren
id|dprintk
c_func
(paren
id|KERN_INFO
l_string|&quot;EXTVGA regs: &quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|6
suffix:semicolon
id|i
op_increment
)paren
id|dprintk
c_func
(paren
l_string|&quot;%02X:&quot;
comma
id|hw-&gt;CRTCEXT
(braket
id|i
)braket
)paren
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|CRITBEGIN
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_OPTION_REG
comma
id|hw-&gt;MXoptionReg
)paren
suffix:semicolon
id|CRITEND
id|vgaHWrestore
c_func
(paren
id|PMINFO
id|hw
comma
id|oldhw
)paren
suffix:semicolon
id|CRITBEGIN
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|6
suffix:semicolon
id|i
op_increment
)paren
id|mga_setr
c_func
(paren
id|M_EXTVGA_INDEX
comma
id|i
comma
id|hw-&gt;CRTCEXT
(braket
id|i
)braket
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|21
suffix:semicolon
id|i
op_increment
)paren
(brace
id|outTi3026
c_func
(paren
id|PMINFO
id|DACseq
(braket
id|i
)braket
comma
id|hw-&gt;DACreg
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|oldhw
)paren
(brace
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPLLADDR
comma
l_int|0x00
)paren
suffix:semicolon
id|oldhw-&gt;DACclk
(braket
l_int|0
)braket
op_assign
id|inTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPIXPLLDATA
)paren
suffix:semicolon
id|oldhw-&gt;DACclk
(braket
l_int|3
)braket
op_assign
id|inTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XLOOPPLLDATA
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPLLADDR
comma
l_int|0x15
)paren
suffix:semicolon
id|oldhw-&gt;DACclk
(braket
l_int|1
)braket
op_assign
id|inTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPIXPLLDATA
)paren
suffix:semicolon
id|oldhw-&gt;DACclk
(braket
l_int|4
)braket
op_assign
id|inTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XLOOPPLLDATA
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPLLADDR
comma
l_int|0x2A
)paren
suffix:semicolon
id|oldhw-&gt;DACclk
(braket
l_int|2
)braket
op_assign
id|inTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPIXPLLDATA
)paren
suffix:semicolon
id|oldhw-&gt;DACclk
(braket
l_int|5
)braket
op_assign
id|inTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XLOOPPLLDATA
)paren
suffix:semicolon
)brace
id|CRITEND
r_if
c_cond
(paren
op_logical_neg
id|oldhw
op_logical_or
id|memcmp
c_func
(paren
id|hw-&gt;DACclk
comma
id|oldhw-&gt;DACclk
comma
l_int|6
)paren
)paren
(brace
multiline_comment|/* agrhh... setting up PLL is very slow on Millenium... */
multiline_comment|/* Mystique PLL is locked in few ms, but Millenium PLL lock takes about 0.15 s... */
multiline_comment|/* Maybe even we should call schedule() ? */
id|CRITBEGIN
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XCLKCTRL
comma
id|hw-&gt;DACreg
(braket
id|POS3026_XCLKCTRL
)braket
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPLLADDR
comma
l_int|0x2A
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XLOOPPLLDATA
comma
l_int|0
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPIXPLLDATA
comma
l_int|0
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPLLADDR
comma
l_int|0x00
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|3
suffix:semicolon
id|i
op_increment
)paren
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPIXPLLDATA
comma
id|hw-&gt;DACclk
(braket
id|i
)braket
)paren
suffix:semicolon
multiline_comment|/* wait for PLL only if PLL clock requested (always for PowerMode, never for VGA) */
r_if
c_cond
(paren
id|hw-&gt;MiscOutReg
op_amp
l_int|0x08
)paren
(brace
r_int
id|tmout
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPLLADDR
comma
l_int|0x3F
)paren
suffix:semicolon
r_for
c_loop
(paren
id|tmout
op_assign
l_int|500000
suffix:semicolon
id|tmout
suffix:semicolon
op_decrement
id|tmout
)paren
(brace
r_if
c_cond
(paren
id|inTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPIXPLLDATA
)paren
op_amp
l_int|0x40
)paren
r_break
suffix:semicolon
id|udelay
c_func
(paren
l_int|10
)paren
suffix:semicolon
)brace
id|CRITEND
r_if
c_cond
(paren
op_logical_neg
id|tmout
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: Pixel PLL not locked after 5 secs&bslash;n&quot;
)paren
suffix:semicolon
r_else
id|dprintk
c_func
(paren
id|KERN_INFO
l_string|&quot;PixelPLL: %d&bslash;n&quot;
comma
l_int|500000
op_minus
id|tmout
)paren
suffix:semicolon
id|CRITBEGIN
)brace
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XMEMPLLCTRL
comma
id|hw-&gt;DACreg
(braket
id|POS3026_XMEMPLLCTRL
)braket
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPLLADDR
comma
l_int|0x00
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|3
suffix:semicolon
id|i
OL
l_int|6
suffix:semicolon
id|i
op_increment
)paren
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XLOOPPLLDATA
comma
id|hw-&gt;DACclk
(braket
id|i
)braket
)paren
suffix:semicolon
id|CRITEND
r_if
c_cond
(paren
(paren
id|hw-&gt;MiscOutReg
op_amp
l_int|0x08
)paren
op_logical_and
(paren
(paren
id|hw-&gt;DACclk
(braket
l_int|5
)braket
op_amp
l_int|0x80
)paren
op_eq
l_int|0x80
)paren
)paren
(brace
r_int
id|tmout
suffix:semicolon
id|CRITBEGIN
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPLLADDR
comma
l_int|0x3F
)paren
suffix:semicolon
r_for
c_loop
(paren
id|tmout
op_assign
l_int|500000
suffix:semicolon
id|tmout
suffix:semicolon
op_decrement
id|tmout
)paren
(brace
r_if
c_cond
(paren
id|inTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XLOOPPLLDATA
)paren
op_amp
l_int|0x40
)paren
r_break
suffix:semicolon
id|udelay
c_func
(paren
l_int|10
)paren
suffix:semicolon
)brace
id|CRITEND
r_if
c_cond
(paren
op_logical_neg
id|tmout
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: Loop PLL not locked after 5 secs&bslash;n&quot;
)paren
suffix:semicolon
r_else
id|dprintk
c_func
(paren
id|KERN_INFO
l_string|&quot;LoopPLL: %d&bslash;n&quot;
comma
l_int|500000
op_minus
id|tmout
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|p
op_logical_and
id|p-&gt;conp
)paren
(brace
r_if
c_cond
(paren
id|p-&gt;type
op_eq
id|FB_TYPE_TEXT
)paren
(brace
id|matrox_text_createcursor
c_func
(paren
id|PMINFO
id|p
)paren
suffix:semicolon
id|matrox_text_loadfont
c_func
(paren
id|PMINFO
id|p
)paren
suffix:semicolon
id|i
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|matroxfb_ti3026_createcursor
c_func
(paren
id|PMINFO
id|p
)paren
suffix:semicolon
id|i
op_assign
id|matroxfb_fastfont_tryset
c_func
(paren
id|PMINFO
id|p
)paren
suffix:semicolon
)brace
)brace
r_else
id|i
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|i
)paren
(brace
id|ACCESS_FBINFO
c_func
(paren
id|curr.putc
)paren
op_assign
id|matrox_cfbX_fastputc
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|curr.putcs
)paren
op_assign
id|matrox_cfbX_fastputcs
suffix:semicolon
)brace
r_else
(brace
id|ACCESS_FBINFO
c_func
(paren
id|curr.putc
)paren
op_assign
id|matrox_cfbX_putc
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|curr.putcs
)paren
op_assign
id|matrox_cfbX_putcs
suffix:semicolon
)brace
id|dprintk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;3026DACregs &quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|21
suffix:semicolon
id|i
op_increment
)paren
(brace
id|dprintk
c_func
(paren
l_string|&quot;R%02X=%02X &quot;
comma
id|DACseq
(braket
id|i
)braket
comma
id|hw-&gt;DACreg
(braket
id|i
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|i
op_amp
l_int|0x7
)paren
op_eq
l_int|0x7
)paren
id|dprintk
c_func
(paren
l_string|&quot;&bslash;n&quot;
id|KERN_DEBUG
l_string|&quot;continuing... &quot;
)paren
suffix:semicolon
)brace
id|dprintk
c_func
(paren
l_string|&quot;&bslash;n&quot;
id|KERN_DEBUG
l_string|&quot;DACclk &quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|6
suffix:semicolon
id|i
op_increment
)paren
id|dprintk
c_func
(paren
l_string|&quot;C%02X=%02X &quot;
comma
id|i
comma
id|hw-&gt;DACclk
(braket
id|i
)braket
)paren
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
macro_line|#endif
DECL|function|matroxfb_get_fix
r_static
r_int
id|matroxfb_get_fix
c_func
(paren
r_struct
id|fb_fix_screeninfo
op_star
id|fix
comma
r_int
id|con
comma
r_struct
id|fb_info
op_star
id|info
)paren
(brace
r_struct
id|display
op_star
id|p
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;matroxfb_get_fix&quot;
)paren
DECL|macro|minfo
mdefine_line|#define minfo ((struct matrox_fb_info*)info)
r_if
c_cond
(paren
id|con
op_ge
l_int|0
)paren
id|p
op_assign
id|fb_display
op_plus
id|con
suffix:semicolon
r_else
id|p
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.disp
)paren
suffix:semicolon
id|memset
c_func
(paren
id|fix
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|fb_fix_screeninfo
)paren
)paren
suffix:semicolon
id|strcpy
c_func
(paren
id|fix-&gt;id
comma
l_string|&quot;MATROX&quot;
)paren
suffix:semicolon
id|fix-&gt;smem_start
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|video.base
)paren
op_plus
id|ACCESS_FBINFO
c_func
(paren
id|curr.ydstorg.bytes
)paren
suffix:semicolon
id|fix-&gt;smem_len
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|video.len_usable
)paren
op_minus
id|ACCESS_FBINFO
c_func
(paren
id|curr.ydstorg.bytes
)paren
suffix:semicolon
id|fix-&gt;type
op_assign
id|p-&gt;type
suffix:semicolon
id|fix-&gt;type_aux
op_assign
id|p-&gt;type_aux
suffix:semicolon
id|fix-&gt;visual
op_assign
id|p-&gt;visual
suffix:semicolon
id|fix-&gt;xpanstep
op_assign
l_int|8
suffix:semicolon
multiline_comment|/* 8 for 8bpp, 4 for 16bpp, 2 for 32bpp */
id|fix-&gt;ypanstep
op_assign
l_int|1
suffix:semicolon
id|fix-&gt;ywrapstep
op_assign
l_int|0
suffix:semicolon
id|fix-&gt;line_length
op_assign
id|p-&gt;line_length
suffix:semicolon
id|fix-&gt;mmio_start
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|mmio.base
)paren
suffix:semicolon
id|fix-&gt;mmio_len
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|mmio.len
)paren
suffix:semicolon
id|fix-&gt;accel
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|devflags.accelerator
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
DECL|macro|minfo
macro_line|#undef minfo
)brace
DECL|function|matroxfb_get_var
r_static
r_int
id|matroxfb_get_var
c_func
(paren
r_struct
id|fb_var_screeninfo
op_star
id|var
comma
r_int
id|con
comma
r_struct
id|fb_info
op_star
id|info
)paren
(brace
DECL|macro|minfo
mdefine_line|#define minfo ((struct matrox_fb_info*)info)
id|DBG
c_func
(paren
l_string|&quot;matroxfb_get_var&quot;
)paren
r_if
c_cond
(paren
id|con
OL
l_int|0
)paren
(brace
op_star
id|var
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.disp
)paren
op_member_access_from_pointer
id|var
suffix:semicolon
)brace
r_else
op_star
id|var
op_assign
id|fb_display
(braket
id|con
)braket
dot
id|var
suffix:semicolon
r_return
l_int|0
suffix:semicolon
DECL|macro|minfo
macro_line|#undef minfo
)brace
DECL|function|matroxfb_set_var
r_static
r_int
id|matroxfb_set_var
c_func
(paren
r_struct
id|fb_var_screeninfo
op_star
id|var
comma
r_int
id|con
comma
r_struct
id|fb_info
op_star
id|info
)paren
(brace
DECL|macro|minfo
mdefine_line|#define minfo ((struct matrox_fb_info*)info)
r_int
id|err
suffix:semicolon
r_int
id|visual
suffix:semicolon
r_int
id|cmap_len
suffix:semicolon
r_int
r_int
id|ydstorg
suffix:semicolon
r_struct
id|display
op_star
id|display
suffix:semicolon
r_int
id|chgvar
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;matroxfb_set_var&quot;
)paren
r_if
c_cond
(paren
id|con
op_ge
l_int|0
)paren
id|display
op_assign
id|fb_display
op_plus
id|con
suffix:semicolon
r_else
id|display
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.disp
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|matroxfb_decode_var
c_func
(paren
id|PMINFO
id|display
comma
id|var
comma
op_amp
id|visual
comma
op_amp
id|cmap_len
comma
op_amp
id|ydstorg
)paren
)paren
op_ne
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_switch
c_cond
(paren
id|var-&gt;activate
op_amp
id|FB_ACTIVATE_MASK
)paren
(brace
r_case
id|FB_ACTIVATE_TEST
suffix:colon
r_return
l_int|0
suffix:semicolon
r_case
id|FB_ACTIVATE_NXTOPEN
suffix:colon
multiline_comment|/* ?? */
r_case
id|FB_ACTIVATE_NOW
suffix:colon
r_break
suffix:semicolon
multiline_comment|/* continue */
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
multiline_comment|/* unknown */
)brace
r_if
c_cond
(paren
id|con
op_ge
l_int|0
)paren
(brace
id|chgvar
op_assign
(paren
(paren
id|display-&gt;var.xres
op_ne
id|var-&gt;xres
)paren
op_logical_or
(paren
id|display-&gt;var.yres
op_ne
id|var-&gt;yres
)paren
op_logical_or
(paren
id|display-&gt;var.xres_virtual
op_ne
id|var-&gt;xres_virtual
)paren
op_logical_or
(paren
id|display-&gt;var.yres_virtual
op_ne
id|var-&gt;yres_virtual
)paren
op_logical_or
(paren
id|display-&gt;var.bits_per_pixel
op_ne
id|var-&gt;bits_per_pixel
)paren
op_logical_or
id|memcmp
c_func
(paren
op_amp
id|display-&gt;var.red
comma
op_amp
id|var-&gt;red
comma
r_sizeof
(paren
id|var-&gt;red
)paren
)paren
op_logical_or
id|memcmp
c_func
(paren
op_amp
id|display-&gt;var.green
comma
op_amp
id|var-&gt;green
comma
r_sizeof
(paren
id|var-&gt;green
)paren
)paren
op_logical_or
id|memcmp
c_func
(paren
op_amp
id|display-&gt;var.blue
comma
op_amp
id|var-&gt;blue
comma
r_sizeof
(paren
id|var-&gt;blue
)paren
)paren
)paren
suffix:semicolon
)brace
r_else
(brace
id|chgvar
op_assign
l_int|0
suffix:semicolon
)brace
id|display-&gt;var
op_assign
op_star
id|var
suffix:semicolon
multiline_comment|/* cmap */
id|display-&gt;screen_base
op_assign
id|vaddr_va
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
)paren
op_plus
id|ydstorg
suffix:semicolon
id|display-&gt;visual
op_assign
id|visual
suffix:semicolon
id|display-&gt;ypanstep
op_assign
l_int|1
suffix:semicolon
id|display-&gt;ywrapstep
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|var-&gt;bits_per_pixel
)paren
(brace
id|display-&gt;type
op_assign
id|FB_TYPE_PACKED_PIXELS
suffix:semicolon
id|display-&gt;type_aux
op_assign
l_int|0
suffix:semicolon
id|display-&gt;next_line
op_assign
id|display-&gt;line_length
op_assign
(paren
id|var-&gt;xres_virtual
op_star
id|var-&gt;bits_per_pixel
)paren
op_rshift
l_int|3
suffix:semicolon
)brace
r_else
(brace
id|display-&gt;type
op_assign
id|FB_TYPE_TEXT
suffix:semicolon
id|display-&gt;type_aux
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|devflags.text_type_aux
)paren
suffix:semicolon
id|display-&gt;next_line
op_assign
id|display-&gt;line_length
op_assign
(paren
id|var-&gt;xres_virtual
op_div
(paren
id|fontwidth
c_func
(paren
id|display
)paren
ques
c_cond
id|fontwidth
c_func
(paren
id|display
)paren
suffix:colon
l_int|8
)paren
)paren
op_star
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textstep
)paren
suffix:semicolon
)brace
id|display-&gt;can_soft_blank
op_assign
l_int|1
suffix:semicolon
id|display-&gt;inverse
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|devflags.inverse
)paren
suffix:semicolon
multiline_comment|/* conp, fb_info, vrows, cursor_x, cursor_y, fgcol, bgcol */
multiline_comment|/* next_plane, fontdata, _font*, userfont */
id|initMatrox
c_func
(paren
id|PMINFO
id|display
)paren
suffix:semicolon
multiline_comment|/* dispsw */
multiline_comment|/* dispsw, scrollmode, yscroll */
multiline_comment|/* fgshift, bgshift, charmask */
r_if
c_cond
(paren
id|chgvar
op_logical_and
id|info
op_logical_and
id|info-&gt;changevar
)paren
id|info
op_member_access_from_pointer
id|changevar
c_func
(paren
id|con
)paren
suffix:semicolon
r_if
c_cond
(paren
id|con
op_eq
id|ACCESS_FBINFO
c_func
(paren
id|currcon
)paren
)paren
(brace
r_int
r_int
id|pos
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|curr.cmap_len
)paren
op_assign
id|cmap_len
suffix:semicolon
r_if
c_cond
(paren
id|display-&gt;type
op_eq
id|FB_TYPE_TEXT
)paren
(brace
multiline_comment|/* textmode must be in first megabyte, so no ydstorg allowed */
id|ACCESS_FBINFO
c_func
(paren
id|curr.ydstorg.bytes
)paren
op_assign
l_int|0
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|curr.ydstorg.chunks
)paren
op_assign
l_int|0
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|curr.ydstorg.pixels
)paren
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|ydstorg
op_add_assign
id|ACCESS_FBINFO
c_func
(paren
id|devflags.ydstorg
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|curr.ydstorg.bytes
)paren
op_assign
id|ydstorg
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|curr.ydstorg.chunks
)paren
op_assign
id|ydstorg
op_rshift
(paren
id|isInterleave
c_func
(paren
id|MINFO
)paren
ques
c_cond
l_int|3
suffix:colon
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|var-&gt;bits_per_pixel
op_eq
l_int|4
)paren
id|ACCESS_FBINFO
c_func
(paren
id|curr.ydstorg.pixels
)paren
op_assign
id|ydstorg
suffix:semicolon
r_else
id|ACCESS_FBINFO
c_func
(paren
id|curr.ydstorg.pixels
)paren
op_assign
(paren
id|ydstorg
op_star
l_int|8
)paren
op_div
id|var-&gt;bits_per_pixel
suffix:semicolon
)brace
id|ACCESS_FBINFO
c_func
(paren
id|curr.final_bppShift
)paren
op_assign
id|matroxfb_get_final_bppShift
c_func
(paren
id|PMINFO
id|var-&gt;bits_per_pixel
)paren
suffix:semicolon
r_if
c_cond
(paren
id|visual
op_eq
id|MX_VISUAL_PSEUDOCOLOR
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|16
suffix:semicolon
id|i
op_increment
)paren
(brace
r_int
id|j
suffix:semicolon
id|j
op_assign
id|color_table
(braket
id|i
)braket
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|palette
(braket
id|i
)braket
dot
id|red
)paren
op_assign
id|default_red
(braket
id|j
)braket
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|palette
(braket
id|i
)braket
dot
id|green
)paren
op_assign
id|default_grn
(braket
id|j
)braket
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|palette
(braket
id|i
)braket
dot
id|blue
)paren
op_assign
id|default_blu
(braket
id|j
)braket
suffix:semicolon
)brace
)brace
(brace
r_struct
id|my_timming
id|mt
suffix:semicolon
r_struct
id|matrox_hw_state
op_star
id|hw
suffix:semicolon
r_struct
id|matrox_hw_state
op_star
id|ohw
suffix:semicolon
id|var2my
c_func
(paren
id|var
comma
op_amp
id|mt
)paren
suffix:semicolon
id|hw
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|newhw
)paren
suffix:semicolon
id|ohw
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|currenthw
)paren
suffix:semicolon
multiline_comment|/* MXoptionReg is not set from scratch */
id|hw-&gt;MXoptionReg
op_assign
id|ohw-&gt;MXoptionReg
suffix:semicolon
multiline_comment|/* DACclk[3]..[5] are not initialized with DAC1064 */
id|memcpy
c_func
(paren
id|hw-&gt;DACclk
comma
id|ohw-&gt;DACclk
comma
r_sizeof
(paren
id|hw-&gt;DACclk
)paren
)paren
suffix:semicolon
multiline_comment|/* others are initialized by init() */
id|del_timer
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|cursor.timer
)paren
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|cursor.state
)paren
op_assign
id|CM_ERASE
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|hw_switch
op_member_access_from_pointer
id|init
c_func
(paren
id|PMINFO
id|hw
comma
op_amp
id|mt
comma
id|display
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|display-&gt;type
op_eq
id|FB_TYPE_TEXT
)paren
(brace
r_if
c_cond
(paren
id|fontheight
c_func
(paren
id|display
)paren
)paren
id|pos
op_assign
id|var-&gt;yoffset
op_div
id|fontheight
c_func
(paren
id|display
)paren
op_star
id|display-&gt;next_line
op_div
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textstep
)paren
op_plus
id|var-&gt;xoffset
op_div
(paren
id|fontwidth
c_func
(paren
id|display
)paren
ques
c_cond
id|fontwidth
c_func
(paren
id|display
)paren
suffix:colon
l_int|8
)paren
suffix:semicolon
r_else
id|pos
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|pos
op_assign
(paren
id|var-&gt;yoffset
op_star
id|var-&gt;xres_virtual
op_plus
id|var-&gt;xoffset
)paren
op_star
id|ACCESS_FBINFO
c_func
(paren
id|curr.final_bppShift
)paren
op_div
l_int|32
suffix:semicolon
id|pos
op_add_assign
id|ACCESS_FBINFO
c_func
(paren
id|curr.ydstorg.chunks
)paren
suffix:semicolon
)brace
id|hw-&gt;CRTC
(braket
l_int|0x0D
)braket
op_assign
id|pos
op_amp
l_int|0xFF
suffix:semicolon
id|hw-&gt;CRTC
(braket
l_int|0x0C
)braket
op_assign
(paren
id|pos
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
suffix:semicolon
id|hw-&gt;CRTCEXT
(braket
l_int|0
)braket
op_assign
(paren
id|hw-&gt;CRTCEXT
(braket
l_int|0
)braket
op_amp
l_int|0xF0
)paren
op_or
(paren
(paren
id|pos
op_rshift
l_int|16
)paren
op_amp
l_int|0x0F
)paren
op_or
(paren
(paren
id|pos
op_rshift
l_int|14
)paren
op_amp
l_int|0x40
)paren
suffix:semicolon
id|hw-&gt;CRTCEXT
(braket
l_int|8
)braket
op_assign
id|pos
op_rshift
l_int|21
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|hw_switch
op_member_access_from_pointer
id|restore
c_func
(paren
id|PMINFO
id|hw
comma
id|ohw
comma
id|display
)paren
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|cursor.redraw
)paren
op_assign
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|currenthw
)paren
op_assign
id|hw
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|newhw
)paren
op_assign
id|ohw
suffix:semicolon
id|matrox_cfbX_init
c_func
(paren
id|PMINFO
id|display
)paren
suffix:semicolon
id|do_install_cmap
c_func
(paren
id|PMINFO
id|display
)paren
suffix:semicolon
macro_line|#if defined(CONFIG_FB_OF) &amp;&amp; defined(CONFIG_FB_COMPAT_XPMAC)
r_if
c_cond
(paren
id|console_fb_info
op_eq
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
)paren
(brace
r_int
id|vmode
comma
id|cmode
suffix:semicolon
id|display_info.width
op_assign
id|var-&gt;xres
suffix:semicolon
id|display_info.height
op_assign
id|var-&gt;yres
suffix:semicolon
id|display_info.depth
op_assign
id|var-&gt;bits_per_pixel
suffix:semicolon
id|display_info.pitch
op_assign
(paren
id|var-&gt;xres_virtual
)paren
op_star
(paren
id|var-&gt;bits_per_pixel
)paren
op_div
l_int|8
suffix:semicolon
r_if
c_cond
(paren
id|mac_var_to_vmode
c_func
(paren
id|var
comma
op_amp
id|vmode
comma
op_amp
id|cmode
)paren
)paren
id|display_info.mode
op_assign
l_int|0
suffix:semicolon
r_else
id|display_info.mode
op_assign
id|vmode
suffix:semicolon
id|strcpy
c_func
(paren
id|display_info.name
comma
id|ACCESS_FBINFO
c_func
(paren
id|matrox_name
)paren
)paren
suffix:semicolon
id|display_info.fb_address
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|video.base
)paren
suffix:semicolon
id|display_info.cmap_adr_address
op_assign
l_int|0
suffix:semicolon
id|display_info.cmap_data_address
op_assign
l_int|0
suffix:semicolon
id|display_info.disp_reg_address
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|mmio.base
)paren
suffix:semicolon
)brace
macro_line|#endif /* CONFIG_FB_OF &amp;&amp; CONFIG_FB_COMPAT_XPMAC */
)brace
)brace
r_return
l_int|0
suffix:semicolon
DECL|macro|minfo
macro_line|#undef minfo
)brace
DECL|function|matrox_getcolreg
r_static
r_int
id|matrox_getcolreg
c_func
(paren
r_int
id|regno
comma
r_int
op_star
id|red
comma
r_int
op_star
id|green
comma
r_int
op_star
id|blue
comma
r_int
op_star
id|transp
comma
r_struct
id|fb_info
op_star
id|info
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;matrox_getcolreg&quot;
)paren
DECL|macro|minfo
mdefine_line|#define minfo ((struct matrox_fb_info*)info)
multiline_comment|/*&n;&t; *  Read a single color register and split it into colors/transparent.&n;&t; *  Return != 0 for invalid regno.&n;&t; */
r_if
c_cond
(paren
id|regno
op_ge
id|ACCESS_FBINFO
c_func
(paren
id|curr.cmap_len
)paren
)paren
r_return
l_int|1
suffix:semicolon
op_star
id|red
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|palette
(braket
id|regno
)braket
dot
id|red
)paren
suffix:semicolon
op_star
id|green
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|palette
(braket
id|regno
)braket
dot
id|green
)paren
suffix:semicolon
op_star
id|blue
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|palette
(braket
id|regno
)braket
dot
id|blue
)paren
suffix:semicolon
op_star
id|transp
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|palette
(braket
id|regno
)braket
dot
id|transp
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
DECL|macro|minfo
macro_line|#undef minfo
)brace
DECL|function|matroxfb_get_cmap
r_static
r_int
id|matroxfb_get_cmap
c_func
(paren
r_struct
id|fb_cmap
op_star
id|cmap
comma
r_int
id|kspc
comma
r_int
id|con
comma
r_struct
id|fb_info
op_star
id|info
)paren
(brace
DECL|macro|minfo
mdefine_line|#define minfo ((struct matrox_fb_info*)info)
r_struct
id|display
op_star
id|dsp
op_assign
(paren
id|con
OL
l_int|0
)paren
ques
c_cond
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.disp
)paren
suffix:colon
id|fb_display
op_plus
id|con
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;matroxfb_get_cmap&quot;
)paren
r_if
c_cond
(paren
id|con
op_eq
id|ACCESS_FBINFO
c_func
(paren
id|currcon
)paren
)paren
multiline_comment|/* current console? */
r_return
id|fb_get_cmap
c_func
(paren
id|cmap
comma
id|kspc
comma
id|matrox_getcolreg
comma
id|info
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|dsp-&gt;cmap.len
)paren
multiline_comment|/* non default colormap? */
id|fb_copy_cmap
c_func
(paren
op_amp
id|dsp-&gt;cmap
comma
id|cmap
comma
id|kspc
ques
c_cond
l_int|0
suffix:colon
l_int|2
)paren
suffix:semicolon
r_else
id|fb_copy_cmap
c_func
(paren
id|fb_default_cmap
c_func
(paren
id|matroxfb_get_cmap_len
c_func
(paren
op_amp
id|dsp-&gt;var
)paren
)paren
comma
id|cmap
comma
id|kspc
ques
c_cond
l_int|0
suffix:colon
l_int|2
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
DECL|macro|minfo
macro_line|#undef minfo
)brace
DECL|function|matroxfb_set_cmap
r_static
r_int
id|matroxfb_set_cmap
c_func
(paren
r_struct
id|fb_cmap
op_star
id|cmap
comma
r_int
id|kspc
comma
r_int
id|con
comma
r_struct
id|fb_info
op_star
id|info
)paren
(brace
r_int
r_int
id|cmap_len
suffix:semicolon
r_struct
id|display
op_star
id|dsp
op_assign
(paren
id|con
OL
l_int|0
)paren
ques
c_cond
id|info-&gt;disp
suffix:colon
(paren
id|fb_display
op_plus
id|con
)paren
suffix:semicolon
DECL|macro|minfo
mdefine_line|#define minfo ((struct matrox_fb_info*)info)
id|DBG
c_func
(paren
l_string|&quot;matroxfb_set_cmap&quot;
)paren
id|cmap_len
op_assign
id|matroxfb_get_cmap_len
c_func
(paren
op_amp
id|dsp-&gt;var
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dsp-&gt;cmap.len
op_ne
id|cmap_len
)paren
(brace
r_int
id|err
suffix:semicolon
id|err
op_assign
id|fb_alloc_cmap
c_func
(paren
op_amp
id|dsp-&gt;cmap
comma
id|cmap_len
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
id|con
op_eq
id|ACCESS_FBINFO
c_func
(paren
id|currcon
)paren
)paren
(brace
multiline_comment|/* current console? */
r_return
id|fb_set_cmap
c_func
(paren
id|cmap
comma
id|kspc
comma
id|matrox_setcolreg
comma
id|info
)paren
suffix:semicolon
)brace
r_else
id|fb_copy_cmap
c_func
(paren
id|cmap
comma
op_amp
id|dsp-&gt;cmap
comma
id|kspc
ques
c_cond
l_int|0
suffix:colon
l_int|1
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
DECL|macro|minfo
macro_line|#undef minfo&t;
)brace
DECL|function|matroxfb_ioctl
r_static
r_int
id|matroxfb_ioctl
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
comma
r_int
r_int
id|cmd
comma
r_int
r_int
id|arg
comma
r_int
id|con
comma
r_struct
id|fb_info
op_star
id|info
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;matroxfb_ioctl&quot;
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
DECL|variable|matroxfb_ops
r_static
r_struct
id|fb_ops
id|matroxfb_ops
op_assign
(brace
id|matroxfb_open
comma
id|matroxfb_release
comma
id|matroxfb_get_fix
comma
id|matroxfb_get_var
comma
id|matroxfb_set_var
comma
id|matroxfb_get_cmap
comma
id|matroxfb_set_cmap
comma
id|matroxfb_pan_display
comma
id|matroxfb_ioctl
comma
l_int|NULL
multiline_comment|/* mmap */
)brace
suffix:semicolon
DECL|function|matroxfb_switch
r_static
r_int
id|matroxfb_switch
c_func
(paren
r_int
id|con
comma
r_struct
id|fb_info
op_star
id|info
)paren
(brace
DECL|macro|minfo
mdefine_line|#define minfo ((struct matrox_fb_info*)info)
r_struct
id|fb_cmap
op_star
id|cmap
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;matroxfb_switch&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|currcon
)paren
op_ge
l_int|0
)paren
(brace
multiline_comment|/* Do we have to save the colormap? */
id|cmap
op_assign
op_amp
(paren
id|ACCESS_FBINFO
c_func
(paren
id|currcon_display
)paren
op_member_access_from_pointer
id|cmap
)paren
suffix:semicolon
id|dprintk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;switch1: con = %d, cmap.len = %d&bslash;n&quot;
comma
id|ACCESS_FBINFO
c_func
(paren
id|currcon
)paren
comma
id|cmap-&gt;len
)paren
suffix:semicolon
r_if
c_cond
(paren
id|cmap-&gt;len
)paren
(brace
id|dprintk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;switch1a: %p %p %p %p&bslash;n&quot;
comma
id|cmap-&gt;red
comma
id|cmap-&gt;green
comma
id|cmap-&gt;blue
comma
id|cmap-&gt;transp
)paren
suffix:semicolon
id|fb_get_cmap
c_func
(paren
id|cmap
comma
l_int|1
comma
id|matrox_getcolreg
comma
id|info
)paren
suffix:semicolon
macro_line|#ifdef DEBUG
r_if
c_cond
(paren
id|cmap-&gt;red
)paren
(brace
id|dprintk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;switch1r: %X&bslash;n&quot;
comma
id|cmap-&gt;red
(braket
l_int|0
)braket
)paren
suffix:semicolon
)brace
macro_line|#endif
)brace
)brace
id|ACCESS_FBINFO
c_func
(paren
id|currcon
)paren
op_assign
id|con
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|currcon_display
)paren
op_assign
id|fb_display
op_plus
id|con
suffix:semicolon
id|fb_display
(braket
id|con
)braket
dot
id|var.activate
op_assign
id|FB_ACTIVATE_NOW
suffix:semicolon
macro_line|#ifdef DEBUG
id|cmap
op_assign
op_amp
id|fb_display
(braket
id|con
)braket
dot
id|cmap
suffix:semicolon
id|dprintk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;switch2: con = %d, cmap.len = %d&bslash;n&quot;
comma
id|con
comma
id|cmap-&gt;len
)paren
suffix:semicolon
id|dprintk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;switch2a: %p %p %p %p&bslash;n&quot;
comma
id|cmap-&gt;red
comma
id|cmap-&gt;green
comma
id|cmap-&gt;blue
comma
id|cmap-&gt;transp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fb_display
(braket
id|con
)braket
dot
id|cmap.red
)paren
(brace
id|dprintk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;switch2r: %X&bslash;n&quot;
comma
id|cmap-&gt;red
(braket
l_int|0
)braket
)paren
suffix:semicolon
)brace
macro_line|#endif
id|matroxfb_set_var
c_func
(paren
op_amp
id|fb_display
(braket
id|con
)braket
dot
id|var
comma
id|con
comma
id|info
)paren
suffix:semicolon
macro_line|#ifdef DEBUG
id|dprintk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;switch3: con = %d, cmap.len = %d&bslash;n&quot;
comma
id|con
comma
id|cmap-&gt;len
)paren
suffix:semicolon
id|dprintk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;switch3a: %p %p %p %p&bslash;n&quot;
comma
id|cmap-&gt;red
comma
id|cmap-&gt;green
comma
id|cmap-&gt;blue
comma
id|cmap-&gt;transp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fb_display
(braket
id|con
)braket
dot
id|cmap.red
)paren
(brace
id|dprintk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;switch3r: %X&bslash;n&quot;
comma
id|cmap-&gt;red
(braket
l_int|0
)braket
)paren
suffix:semicolon
)brace
macro_line|#endif
r_return
l_int|0
suffix:semicolon
DECL|macro|minfo
macro_line|#undef minfo
)brace
multiline_comment|/* 0 unblank, 1 blank, 2 no vsync, 3 no hsync, 4 off */
DECL|function|matroxfb_blank
r_static
r_void
id|matroxfb_blank
c_func
(paren
r_int
id|blank
comma
r_struct
id|fb_info
op_star
id|info
)paren
(brace
DECL|macro|minfo
mdefine_line|#define minfo ((struct matrox_fb_info*)info)
r_int
id|seq
suffix:semicolon
r_int
id|crtc
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;matroxfb_blank&quot;
)paren
r_switch
c_cond
(paren
id|blank
)paren
(brace
r_case
l_int|1
suffix:colon
id|seq
op_assign
l_int|0x20
suffix:semicolon
id|crtc
op_assign
l_int|0x00
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* works ??? */
r_case
l_int|2
suffix:colon
id|seq
op_assign
l_int|0x20
suffix:semicolon
id|crtc
op_assign
l_int|0x10
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|seq
op_assign
l_int|0x20
suffix:semicolon
id|crtc
op_assign
l_int|0x20
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
id|seq
op_assign
l_int|0x20
suffix:semicolon
id|crtc
op_assign
l_int|0x30
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|seq
op_assign
l_int|0x00
suffix:semicolon
id|crtc
op_assign
l_int|0x00
suffix:semicolon
r_break
suffix:semicolon
)brace
id|CRITBEGIN
id|mga_outb
c_func
(paren
id|M_SEQ_INDEX
comma
l_int|1
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_SEQ_DATA
comma
(paren
id|mga_inb
c_func
(paren
id|M_SEQ_DATA
)paren
op_amp
op_complement
l_int|0x20
)paren
op_or
id|seq
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_EXTVGA_INDEX
comma
l_int|1
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_EXTVGA_DATA
comma
(paren
id|mga_inb
c_func
(paren
id|M_EXTVGA_DATA
)paren
op_amp
op_complement
l_int|0x30
)paren
op_or
id|crtc
)paren
suffix:semicolon
id|CRITEND
DECL|macro|minfo
macro_line|#undef minfo
)brace
DECL|macro|RSResolution
mdefine_line|#define RSResolution(X)&t;((X) &amp; 0x0F)
DECL|macro|RS640x400
mdefine_line|#define RS640x400&t;1
DECL|macro|RS640x480
mdefine_line|#define RS640x480&t;2
DECL|macro|RS800x600
mdefine_line|#define RS800x600&t;3
DECL|macro|RS1024x768
mdefine_line|#define RS1024x768&t;4
DECL|macro|RS1280x1024
mdefine_line|#define RS1280x1024&t;5
DECL|macro|RS1600x1200
mdefine_line|#define RS1600x1200&t;6
DECL|macro|RS768x576
mdefine_line|#define RS768x576&t;7
DECL|macro|RS960x720
mdefine_line|#define RS960x720&t;8
DECL|macro|RS1152x864
mdefine_line|#define RS1152x864&t;9
DECL|macro|RS1408x1056
mdefine_line|#define RS1408x1056&t;10
DECL|macro|RS640x350
mdefine_line|#define RS640x350&t;11
DECL|macro|RS1056x344
mdefine_line|#define RS1056x344&t;12&t;/* 132 x 43 text */
DECL|macro|RS1056x400
mdefine_line|#define RS1056x400&t;13&t;/* 132 x 50 text */
DECL|macro|RS1056x480
mdefine_line|#define RS1056x480&t;14&t;/* 132 x 60 text */
DECL|macro|RSNoxNo
mdefine_line|#define RSNoxNo&t;&t;15
multiline_comment|/* 10-FF */
DECL|member|xres
DECL|member|yres
DECL|member|left
DECL|member|right
DECL|member|upper
DECL|member|lower
DECL|member|hslen
DECL|member|vslen
DECL|member|vfreq
DECL|variable|__initdata
r_static
r_struct
(brace
r_int
id|xres
comma
id|yres
comma
id|left
comma
id|right
comma
id|upper
comma
id|lower
comma
id|hslen
comma
id|vslen
comma
id|vfreq
suffix:semicolon
)brace
id|timmings
(braket
)braket
id|__initdata
op_assign
(brace
(brace
l_int|640
comma
l_int|400
comma
l_int|48
comma
l_int|16
comma
l_int|39
comma
l_int|8
comma
l_int|96
comma
l_int|2
comma
l_int|70
)brace
comma
(brace
l_int|640
comma
l_int|480
comma
l_int|48
comma
l_int|16
comma
l_int|33
comma
l_int|10
comma
l_int|96
comma
l_int|2
comma
l_int|60
)brace
comma
(brace
l_int|800
comma
l_int|600
comma
l_int|144
comma
l_int|24
comma
l_int|28
comma
l_int|8
comma
l_int|112
comma
l_int|6
comma
l_int|60
)brace
comma
(brace
l_int|1024
comma
l_int|768
comma
l_int|160
comma
l_int|32
comma
l_int|30
comma
l_int|4
comma
l_int|128
comma
l_int|4
comma
l_int|60
)brace
comma
(brace
l_int|1280
comma
l_int|1024
comma
l_int|224
comma
l_int|32
comma
l_int|32
comma
l_int|4
comma
l_int|136
comma
l_int|4
comma
l_int|60
)brace
comma
(brace
l_int|1600
comma
l_int|1200
comma
l_int|272
comma
l_int|48
comma
l_int|32
comma
l_int|5
comma
l_int|152
comma
l_int|5
comma
l_int|60
)brace
comma
(brace
l_int|768
comma
l_int|576
comma
l_int|144
comma
l_int|16
comma
l_int|28
comma
l_int|6
comma
l_int|112
comma
l_int|4
comma
l_int|60
)brace
comma
(brace
l_int|960
comma
l_int|720
comma
l_int|144
comma
l_int|24
comma
l_int|28
comma
l_int|8
comma
l_int|112
comma
l_int|4
comma
l_int|60
)brace
comma
(brace
l_int|1152
comma
l_int|864
comma
l_int|192
comma
l_int|32
comma
l_int|30
comma
l_int|4
comma
l_int|128
comma
l_int|4
comma
l_int|60
)brace
comma
(brace
l_int|1408
comma
l_int|1056
comma
l_int|256
comma
l_int|40
comma
l_int|32
comma
l_int|5
comma
l_int|144
comma
l_int|5
comma
l_int|60
)brace
comma
(brace
l_int|640
comma
l_int|350
comma
l_int|48
comma
l_int|16
comma
l_int|39
comma
l_int|8
comma
l_int|96
comma
l_int|2
comma
l_int|70
)brace
comma
(brace
l_int|1056
comma
l_int|344
comma
l_int|96
comma
l_int|24
comma
l_int|59
comma
l_int|44
comma
l_int|160
comma
l_int|2
comma
l_int|70
)brace
comma
(brace
l_int|1056
comma
l_int|400
comma
l_int|96
comma
l_int|24
comma
l_int|39
comma
l_int|8
comma
l_int|160
comma
l_int|2
comma
l_int|70
)brace
comma
(brace
l_int|1056
comma
l_int|480
comma
l_int|96
comma
l_int|24
comma
l_int|36
comma
l_int|12
comma
l_int|160
comma
l_int|3
comma
l_int|60
)brace
comma
(brace
l_int|0
comma
l_int|0
comma
op_complement
l_int|0
comma
op_complement
l_int|0
comma
op_complement
l_int|0
comma
op_complement
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
)brace
suffix:semicolon
DECL|macro|RSDepth
mdefine_line|#define RSDepth(X)&t;(((X) &gt;&gt; 8) &amp; 0x0F)
DECL|macro|RS8bpp
mdefine_line|#define RS8bpp&t;&t;0x1
DECL|macro|RS15bpp
mdefine_line|#define RS15bpp&t;&t;0x2
DECL|macro|RS16bpp
mdefine_line|#define RS16bpp&t;&t;0x3
DECL|macro|RS32bpp
mdefine_line|#define RS32bpp&t;&t;0x4
DECL|macro|RS4bpp
mdefine_line|#define RS4bpp&t;&t;0x5
DECL|macro|RS24bpp
mdefine_line|#define RS24bpp&t;&t;0x6
DECL|macro|RSText
mdefine_line|#define RSText&t;&t;0x7
DECL|macro|RSText8
mdefine_line|#define RSText8&t;&t;0x8
multiline_comment|/* 9-F */
DECL|member|red
DECL|member|green
DECL|member|blue
DECL|member|transp
DECL|member|bits_per_pixel
DECL|variable|__initdata
r_static
r_struct
(brace
r_struct
id|fb_bitfield
id|red
comma
id|green
comma
id|blue
comma
id|transp
suffix:semicolon
r_int
id|bits_per_pixel
suffix:semicolon
)brace
id|colors
(braket
)braket
id|__initdata
op_assign
(brace
(brace
(brace
l_int|0
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
l_int|8
)brace
comma
(brace
(brace
l_int|10
comma
l_int|5
comma
l_int|0
)brace
comma
(brace
l_int|5
comma
l_int|5
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|5
comma
l_int|0
)brace
comma
(brace
l_int|15
comma
l_int|1
comma
l_int|0
)brace
comma
l_int|16
)brace
comma
(brace
(brace
l_int|11
comma
l_int|5
comma
l_int|0
)brace
comma
(brace
l_int|6
comma
l_int|5
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|5
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
l_int|16
)brace
comma
(brace
(brace
l_int|16
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|8
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|24
comma
l_int|8
comma
l_int|0
)brace
comma
l_int|32
)brace
comma
(brace
(brace
l_int|0
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
l_int|4
)brace
comma
(brace
(brace
l_int|16
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|8
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
l_int|24
)brace
comma
(brace
(brace
l_int|0
comma
l_int|6
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|6
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|6
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
l_int|0
)brace
comma
multiline_comment|/* textmode with (default) VGA8x16 */
(brace
(brace
l_int|0
comma
l_int|6
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|6
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|6
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
l_int|0
)brace
comma
multiline_comment|/* textmode hardwired to VGA8x8 */
)brace
suffix:semicolon
DECL|macro|RSCreate
mdefine_line|#define RSCreate(X,Y)&t;((X) | ((Y) &lt;&lt; 8))
DECL|member|vesa
DECL|member|info
DECL|variable|RSptr
DECL|variable|__initdata
r_static
r_struct
(brace
r_int
r_int
id|vesa
suffix:semicolon
r_int
r_int
id|info
suffix:semicolon
)brace
op_star
id|RSptr
comma
id|vesamap
(braket
)braket
id|__initdata
op_assign
(brace
multiline_comment|/* default must be first */
macro_line|#ifdef FBCON_HAS_CFB8
(brace
op_complement
l_int|0
comma
id|RSCreate
c_func
(paren
id|RSNoxNo
comma
id|RS8bpp
)paren
)brace
comma
(brace
l_int|0x101
comma
id|RSCreate
c_func
(paren
id|RS640x480
comma
id|RS8bpp
)paren
)brace
comma
(brace
l_int|0x100
comma
id|RSCreate
c_func
(paren
id|RS640x400
comma
id|RS8bpp
)paren
)brace
comma
(brace
l_int|0x180
comma
id|RSCreate
c_func
(paren
id|RS768x576
comma
id|RS8bpp
)paren
)brace
comma
(brace
l_int|0x103
comma
id|RSCreate
c_func
(paren
id|RS800x600
comma
id|RS8bpp
)paren
)brace
comma
(brace
l_int|0x188
comma
id|RSCreate
c_func
(paren
id|RS960x720
comma
id|RS8bpp
)paren
)brace
comma
(brace
l_int|0x105
comma
id|RSCreate
c_func
(paren
id|RS1024x768
comma
id|RS8bpp
)paren
)brace
comma
(brace
l_int|0x190
comma
id|RSCreate
c_func
(paren
id|RS1152x864
comma
id|RS8bpp
)paren
)brace
comma
(brace
l_int|0x107
comma
id|RSCreate
c_func
(paren
id|RS1280x1024
comma
id|RS8bpp
)paren
)brace
comma
(brace
l_int|0x198
comma
id|RSCreate
c_func
(paren
id|RS1408x1056
comma
id|RS8bpp
)paren
)brace
comma
(brace
l_int|0x11C
comma
id|RSCreate
c_func
(paren
id|RS1600x1200
comma
id|RS8bpp
)paren
)brace
comma
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB16
(brace
op_complement
l_int|0
comma
id|RSCreate
c_func
(paren
id|RSNoxNo
comma
id|RS15bpp
)paren
)brace
comma
(brace
l_int|0x110
comma
id|RSCreate
c_func
(paren
id|RS640x480
comma
id|RS15bpp
)paren
)brace
comma
(brace
l_int|0x181
comma
id|RSCreate
c_func
(paren
id|RS768x576
comma
id|RS15bpp
)paren
)brace
comma
(brace
l_int|0x113
comma
id|RSCreate
c_func
(paren
id|RS800x600
comma
id|RS15bpp
)paren
)brace
comma
(brace
l_int|0x189
comma
id|RSCreate
c_func
(paren
id|RS960x720
comma
id|RS15bpp
)paren
)brace
comma
(brace
l_int|0x116
comma
id|RSCreate
c_func
(paren
id|RS1024x768
comma
id|RS15bpp
)paren
)brace
comma
(brace
l_int|0x191
comma
id|RSCreate
c_func
(paren
id|RS1152x864
comma
id|RS15bpp
)paren
)brace
comma
(brace
l_int|0x119
comma
id|RSCreate
c_func
(paren
id|RS1280x1024
comma
id|RS15bpp
)paren
)brace
comma
(brace
l_int|0x199
comma
id|RSCreate
c_func
(paren
id|RS1408x1056
comma
id|RS15bpp
)paren
)brace
comma
(brace
l_int|0x11D
comma
id|RSCreate
c_func
(paren
id|RS1600x1200
comma
id|RS15bpp
)paren
)brace
comma
(brace
l_int|0x111
comma
id|RSCreate
c_func
(paren
id|RS640x480
comma
id|RS16bpp
)paren
)brace
comma
(brace
l_int|0x182
comma
id|RSCreate
c_func
(paren
id|RS768x576
comma
id|RS16bpp
)paren
)brace
comma
(brace
l_int|0x114
comma
id|RSCreate
c_func
(paren
id|RS800x600
comma
id|RS16bpp
)paren
)brace
comma
(brace
l_int|0x18A
comma
id|RSCreate
c_func
(paren
id|RS960x720
comma
id|RS16bpp
)paren
)brace
comma
(brace
l_int|0x117
comma
id|RSCreate
c_func
(paren
id|RS1024x768
comma
id|RS16bpp
)paren
)brace
comma
(brace
l_int|0x192
comma
id|RSCreate
c_func
(paren
id|RS1152x864
comma
id|RS16bpp
)paren
)brace
comma
(brace
l_int|0x11A
comma
id|RSCreate
c_func
(paren
id|RS1280x1024
comma
id|RS16bpp
)paren
)brace
comma
(brace
l_int|0x19A
comma
id|RSCreate
c_func
(paren
id|RS1408x1056
comma
id|RS16bpp
)paren
)brace
comma
(brace
l_int|0x11E
comma
id|RSCreate
c_func
(paren
id|RS1600x1200
comma
id|RS16bpp
)paren
)brace
comma
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB24
(brace
op_complement
l_int|0
comma
id|RSCreate
c_func
(paren
id|RSNoxNo
comma
id|RS24bpp
)paren
)brace
comma
(brace
l_int|0x1B2
comma
id|RSCreate
c_func
(paren
id|RS640x480
comma
id|RS24bpp
)paren
)brace
comma
(brace
l_int|0x184
comma
id|RSCreate
c_func
(paren
id|RS768x576
comma
id|RS24bpp
)paren
)brace
comma
(brace
l_int|0x1B5
comma
id|RSCreate
c_func
(paren
id|RS800x600
comma
id|RS24bpp
)paren
)brace
comma
(brace
l_int|0x18C
comma
id|RSCreate
c_func
(paren
id|RS960x720
comma
id|RS24bpp
)paren
)brace
comma
(brace
l_int|0x1B8
comma
id|RSCreate
c_func
(paren
id|RS1024x768
comma
id|RS24bpp
)paren
)brace
comma
(brace
l_int|0x194
comma
id|RSCreate
c_func
(paren
id|RS1152x864
comma
id|RS24bpp
)paren
)brace
comma
(brace
l_int|0x1BB
comma
id|RSCreate
c_func
(paren
id|RS1280x1024
comma
id|RS24bpp
)paren
)brace
comma
(brace
l_int|0x19C
comma
id|RSCreate
c_func
(paren
id|RS1408x1056
comma
id|RS24bpp
)paren
)brace
comma
(brace
l_int|0x1BF
comma
id|RSCreate
c_func
(paren
id|RS1600x1200
comma
id|RS24bpp
)paren
)brace
comma
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB32
(brace
op_complement
l_int|0
comma
id|RSCreate
c_func
(paren
id|RSNoxNo
comma
id|RS32bpp
)paren
)brace
comma
(brace
l_int|0x112
comma
id|RSCreate
c_func
(paren
id|RS640x480
comma
id|RS32bpp
)paren
)brace
comma
(brace
l_int|0x183
comma
id|RSCreate
c_func
(paren
id|RS768x576
comma
id|RS32bpp
)paren
)brace
comma
(brace
l_int|0x115
comma
id|RSCreate
c_func
(paren
id|RS800x600
comma
id|RS32bpp
)paren
)brace
comma
(brace
l_int|0x18B
comma
id|RSCreate
c_func
(paren
id|RS960x720
comma
id|RS32bpp
)paren
)brace
comma
(brace
l_int|0x118
comma
id|RSCreate
c_func
(paren
id|RS1024x768
comma
id|RS32bpp
)paren
)brace
comma
(brace
l_int|0x193
comma
id|RSCreate
c_func
(paren
id|RS1152x864
comma
id|RS32bpp
)paren
)brace
comma
(brace
l_int|0x11B
comma
id|RSCreate
c_func
(paren
id|RS1280x1024
comma
id|RS32bpp
)paren
)brace
comma
(brace
l_int|0x19B
comma
id|RSCreate
c_func
(paren
id|RS1408x1056
comma
id|RS32bpp
)paren
)brace
comma
(brace
l_int|0x11F
comma
id|RSCreate
c_func
(paren
id|RS1600x1200
comma
id|RS32bpp
)paren
)brace
comma
macro_line|#endif
macro_line|#ifdef FBCON_HAS_VGATEXT
(brace
op_complement
l_int|0
comma
id|RSCreate
c_func
(paren
id|RSNoxNo
comma
id|RSText
)paren
)brace
comma
(brace
l_int|0x002
comma
id|RSCreate
c_func
(paren
id|RS640x400
comma
id|RSText
)paren
)brace
comma
multiline_comment|/* 80x25 */
(brace
l_int|0x003
comma
id|RSCreate
c_func
(paren
id|RS640x400
comma
id|RSText
)paren
)brace
comma
multiline_comment|/* 80x25 */
(brace
l_int|0x007
comma
id|RSCreate
c_func
(paren
id|RS640x400
comma
id|RSText
)paren
)brace
comma
multiline_comment|/* 80x25 */
(brace
l_int|0x1C0
comma
id|RSCreate
c_func
(paren
id|RS640x400
comma
id|RSText8
)paren
)brace
comma
multiline_comment|/* 80x50 */
(brace
l_int|0x108
comma
id|RSCreate
c_func
(paren
id|RS640x480
comma
id|RSText8
)paren
)brace
comma
multiline_comment|/* 80x60 */
(brace
l_int|0x109
comma
id|RSCreate
c_func
(paren
id|RS1056x400
comma
id|RSText
)paren
)brace
comma
multiline_comment|/* 132x25 */
(brace
l_int|0x10A
comma
id|RSCreate
c_func
(paren
id|RS1056x344
comma
id|RSText8
)paren
)brace
comma
multiline_comment|/* 132x43 */
(brace
l_int|0x10B
comma
id|RSCreate
c_func
(paren
id|RS1056x400
comma
id|RSText8
)paren
)brace
comma
multiline_comment|/* 132x50 */
(brace
l_int|0x10C
comma
id|RSCreate
c_func
(paren
id|RS1056x480
comma
id|RSText8
)paren
)brace
comma
multiline_comment|/* 132x60 */
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB4
(brace
op_complement
l_int|0
comma
id|RSCreate
c_func
(paren
id|RSNoxNo
comma
id|RS4bpp
)paren
)brace
comma
(brace
l_int|0x010
comma
id|RSCreate
c_func
(paren
id|RS640x350
comma
id|RS4bpp
)paren
)brace
comma
(brace
l_int|0x012
comma
id|RSCreate
c_func
(paren
id|RS640x480
comma
id|RS4bpp
)paren
)brace
comma
(brace
l_int|0x102
comma
id|RSCreate
c_func
(paren
id|RS800x600
comma
id|RS4bpp
)paren
)brace
comma
(brace
l_int|0x104
comma
id|RSCreate
c_func
(paren
id|RS1024x768
comma
id|RS4bpp
)paren
)brace
comma
(brace
l_int|0x106
comma
id|RSCreate
c_func
(paren
id|RS1280x1024
comma
id|RS4bpp
)paren
)brace
comma
macro_line|#endif
(brace
l_int|0
comma
l_int|0
)brace
)brace
suffix:semicolon
multiline_comment|/* initialized by setup, see explanation at end of file (search for MODULE_PARM_DESC) */
DECL|variable|mem
r_static
r_int
r_int
id|mem
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:mem:xxxxxM&quot; */
DECL|variable|option_precise_width
r_static
r_int
id|option_precise_width
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* cannot be changed, option_precise_width==0 must imply noaccel */
DECL|variable|inv24
r_static
r_int
id|inv24
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:inv24&quot; */
DECL|variable|cross4MB
r_static
r_int
id|cross4MB
op_assign
op_minus
l_int|1
suffix:semicolon
multiline_comment|/* &quot;matrox:cross4MB&quot; */
DECL|variable|disabled
r_static
r_int
id|disabled
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:disabled&quot; */
DECL|variable|noaccel
r_static
r_int
id|noaccel
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:noaccel&quot; */
DECL|variable|nopan
r_static
r_int
id|nopan
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:nopan&quot; */
DECL|variable|no_pci_retry
r_static
r_int
id|no_pci_retry
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:nopciretry&quot; */
DECL|variable|novga
r_static
r_int
id|novga
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:novga&quot; */
DECL|variable|nobios
r_static
r_int
id|nobios
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:nobios&quot; */
DECL|variable|noinit
r_static
r_int
id|noinit
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* &quot;matrox:init&quot; */
DECL|variable|inverse
r_static
r_int
id|inverse
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:inverse&quot; */
DECL|variable|hwcursor
r_static
r_int
id|hwcursor
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* &quot;matrox:nohwcursor&quot; */
DECL|variable|blink
r_static
r_int
id|blink
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* &quot;matrox:noblink&quot; */
DECL|variable|sgram
r_static
r_int
id|sgram
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:sgram&quot; */
macro_line|#ifdef CONFIG_MTRR
DECL|variable|mtrr
r_static
r_int
id|mtrr
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* &quot;matrox:nomtrr&quot; */
macro_line|#endif
DECL|variable|grayscale
r_static
r_int
id|grayscale
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:grayscale&quot; */
DECL|variable|fastfont
r_static
r_int
r_int
id|fastfont
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:fastfont:xxxxx&quot; */
DECL|variable|dev
r_static
r_int
id|dev
op_assign
op_minus
l_int|1
suffix:semicolon
multiline_comment|/* &quot;matrox:dev:xxxxx&quot; */
DECL|variable|vesa
r_static
r_int
r_int
id|vesa
op_assign
op_complement
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:vesa:xxxxx&quot; */
DECL|variable|depth
r_static
r_int
id|depth
op_assign
op_minus
l_int|1
suffix:semicolon
multiline_comment|/* &quot;matrox:depth:xxxxx&quot; */
DECL|variable|xres
r_static
r_int
r_int
id|xres
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:xres:xxxxx&quot; */
DECL|variable|yres
r_static
r_int
r_int
id|yres
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:yres:xxxxx&quot; */
DECL|variable|upper
r_static
r_int
r_int
id|upper
op_assign
op_complement
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:upper:xxxxx&quot; */
DECL|variable|lower
r_static
r_int
r_int
id|lower
op_assign
op_complement
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:lower:xxxxx&quot; */
DECL|variable|vslen
r_static
r_int
r_int
id|vslen
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:vslen:xxxxx&quot; */
DECL|variable|left
r_static
r_int
r_int
id|left
op_assign
op_complement
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:left:xxxxx&quot; */
DECL|variable|right
r_static
r_int
r_int
id|right
op_assign
op_complement
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:right:xxxxx&quot; */
DECL|variable|hslen
r_static
r_int
r_int
id|hslen
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:hslen:xxxxx&quot; */
DECL|variable|pixclock
r_static
r_int
r_int
id|pixclock
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:pixclock:xxxxx&quot; */
DECL|variable|sync
r_static
r_int
id|sync
op_assign
op_minus
l_int|1
suffix:semicolon
multiline_comment|/* &quot;matrox:sync:xxxxx&quot; */
DECL|variable|fv
r_static
r_int
r_int
id|fv
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:fv:xxxxx&quot; */
DECL|variable|fh
r_static
r_int
r_int
id|fh
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:fh:xxxxxk&quot; */
DECL|variable|maxclk
r_static
r_int
r_int
id|maxclk
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:maxclk:xxxxM&quot; */
DECL|variable|fontname
r_static
r_char
id|fontname
(braket
l_int|64
)braket
suffix:semicolon
multiline_comment|/* &quot;matrox:font:xxxxx&quot; */
macro_line|#ifndef MODULE
DECL|variable|videomode
r_static
r_char
id|videomode
(braket
l_int|64
)braket
suffix:semicolon
multiline_comment|/* &quot;matrox:mode:xxxxx&quot; or &quot;matrox:xxxxx&quot; */
macro_line|#endif
macro_line|#ifndef MODULE
DECL|function|matroxfb_setup
r_int
id|__init
id|matroxfb_setup
c_func
(paren
r_char
op_star
id|options
)paren
(brace
r_char
op_star
id|this_opt
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;matroxfb_setup&quot;
)paren
id|fontname
(braket
l_int|0
)braket
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|options
op_logical_or
op_logical_neg
op_star
id|options
)paren
r_return
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|this_opt
op_assign
id|strtok
c_func
(paren
id|options
comma
l_string|&quot;,&quot;
)paren
suffix:semicolon
id|this_opt
suffix:semicolon
id|this_opt
op_assign
id|strtok
c_func
(paren
l_int|NULL
comma
l_string|&quot;,&quot;
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
op_star
id|this_opt
)paren
r_continue
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;matroxfb_setup: option %s&bslash;n&quot;
comma
id|this_opt
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;dev:&quot;
comma
l_int|4
)paren
)paren
id|dev
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|4
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;depth:&quot;
comma
l_int|6
)paren
)paren
(brace
r_switch
c_cond
(paren
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|6
comma
l_int|NULL
comma
l_int|0
)paren
)paren
(brace
r_case
l_int|0
suffix:colon
id|depth
op_assign
id|RSText
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
id|depth
op_assign
id|RS4bpp
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|8
suffix:colon
id|depth
op_assign
id|RS8bpp
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|15
suffix:colon
id|depth
op_assign
id|RS15bpp
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|16
suffix:colon
id|depth
op_assign
id|RS16bpp
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|24
suffix:colon
id|depth
op_assign
id|RS24bpp
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|32
suffix:colon
id|depth
op_assign
id|RS32bpp
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: unsupported color depth&bslash;n&quot;
)paren
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;xres:&quot;
comma
l_int|5
)paren
)paren
id|xres
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|5
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;yres:&quot;
comma
l_int|5
)paren
)paren
id|yres
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|5
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;vslen:&quot;
comma
l_int|6
)paren
)paren
id|vslen
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|6
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;hslen:&quot;
comma
l_int|6
)paren
)paren
id|hslen
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|6
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;left:&quot;
comma
l_int|5
)paren
)paren
id|left
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|5
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;right:&quot;
comma
l_int|6
)paren
)paren
id|right
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|6
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;upper:&quot;
comma
l_int|6
)paren
)paren
id|upper
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|6
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;lower:&quot;
comma
l_int|6
)paren
)paren
id|lower
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|6
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;pixclock:&quot;
comma
l_int|9
)paren
)paren
id|pixclock
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|9
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;sync:&quot;
comma
l_int|5
)paren
)paren
id|sync
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|5
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;vesa:&quot;
comma
l_int|5
)paren
)paren
id|vesa
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|5
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;font:&quot;
comma
l_int|5
)paren
)paren
id|strncpy
c_func
(paren
id|fontname
comma
id|this_opt
op_plus
l_int|5
comma
r_sizeof
(paren
id|fontname
)paren
op_minus
l_int|1
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;maxclk:&quot;
comma
l_int|7
)paren
)paren
id|maxclk
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|7
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;fh:&quot;
comma
l_int|3
)paren
)paren
id|fh
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|3
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;fv:&quot;
comma
l_int|3
)paren
)paren
id|fv
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|3
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;mem:&quot;
comma
l_int|4
)paren
)paren
id|mem
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|4
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;mode:&quot;
comma
l_int|5
)paren
)paren
id|strncpy
c_func
(paren
id|videomode
comma
id|this_opt
op_plus
l_int|5
comma
r_sizeof
(paren
id|videomode
)paren
op_minus
l_int|1
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_FB_OF
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;vmode:&quot;
comma
l_int|6
)paren
)paren
(brace
r_int
r_int
id|vmode
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|6
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|vmode
OG
l_int|0
op_logical_and
id|vmode
op_le
id|VMODE_MAX
)paren
id|default_vmode
op_assign
id|vmode
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;cmode:&quot;
comma
l_int|6
)paren
)paren
(brace
r_int
r_int
id|cmode
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|6
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|cmode
)paren
(brace
r_case
l_int|0
suffix:colon
r_case
l_int|8
suffix:colon
id|default_cmode
op_assign
id|CMODE_8
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|15
suffix:colon
r_case
l_int|16
suffix:colon
id|default_cmode
op_assign
id|CMODE_16
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|24
suffix:colon
r_case
l_int|32
suffix:colon
id|default_cmode
op_assign
id|CMODE_32
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
macro_line|#endif
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;fastfont:&quot;
comma
l_int|9
)paren
)paren
id|fastfont
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|9
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;nofastfont&quot;
)paren
)paren
multiline_comment|/* fastfont:N and nofastfont (nofastfont = fastfont:0) */
id|fastfont
op_assign
l_int|0
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;disabled&quot;
)paren
)paren
multiline_comment|/* nodisabled does not exist */
id|disabled
op_assign
l_int|1
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;enabled&quot;
)paren
)paren
multiline_comment|/* noenabled does not exist */
id|disabled
op_assign
l_int|0
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;sgram&quot;
)paren
)paren
multiline_comment|/* nosgram == sdram */
id|sgram
op_assign
l_int|1
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;sdram&quot;
)paren
)paren
id|sgram
op_assign
l_int|0
suffix:semicolon
r_else
(brace
r_int
id|value
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;no&quot;
comma
l_int|2
)paren
)paren
(brace
id|value
op_assign
l_int|0
suffix:semicolon
id|this_opt
op_add_assign
l_int|2
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;inverse&quot;
)paren
)paren
id|inverse
op_assign
id|value
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;accel&quot;
)paren
)paren
id|noaccel
op_assign
op_logical_neg
id|value
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;pan&quot;
)paren
)paren
id|nopan
op_assign
op_logical_neg
id|value
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;pciretry&quot;
)paren
)paren
id|no_pci_retry
op_assign
op_logical_neg
id|value
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;vga&quot;
)paren
)paren
id|novga
op_assign
op_logical_neg
id|value
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;bios&quot;
)paren
)paren
id|nobios
op_assign
op_logical_neg
id|value
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;init&quot;
)paren
)paren
id|noinit
op_assign
op_logical_neg
id|value
suffix:semicolon
macro_line|#ifdef CONFIG_MTRR
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;mtrr&quot;
)paren
)paren
id|mtrr
op_assign
id|value
suffix:semicolon
macro_line|#endif
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;inv24&quot;
)paren
)paren
id|inv24
op_assign
id|value
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;cross4MB&quot;
)paren
)paren
id|cross4MB
op_assign
id|value
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;hwcursor&quot;
)paren
)paren
id|hwcursor
op_assign
id|value
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;blink&quot;
)paren
)paren
id|blink
op_assign
id|value
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;grayscale&quot;
)paren
)paren
id|grayscale
op_assign
id|value
suffix:semicolon
r_else
(brace
id|strncpy
c_func
(paren
id|videomode
comma
id|this_opt
comma
r_sizeof
(paren
id|videomode
)paren
op_minus
l_int|1
)paren
suffix:semicolon
)brace
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif /* !MODULE */
DECL|function|matroxfb_getmemory
r_static
r_int
(def_block
id|matroxfb_getmemory
c_func
(paren
id|WPMINFO
r_int
r_int
id|maxSize
comma
r_int
r_int
op_star
id|realOffset
comma
r_int
r_int
op_star
id|realSize
)paren
(brace
id|vaddr_t
id|vm
suffix:semicolon
r_int
r_int
id|offs
suffix:semicolon
r_int
r_int
id|offs2
suffix:semicolon
r_int
r_char
id|store
suffix:semicolon
r_int
r_char
id|bytes
(braket
l_int|32
)braket
suffix:semicolon
r_int
r_char
op_star
id|tmp
suffix:semicolon
r_int
r_int
id|cbase
suffix:semicolon
r_int
r_int
id|mbase
suffix:semicolon
r_int
r_int
id|clen
suffix:semicolon
r_int
r_int
id|mlen
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;matroxfb_getmemory&quot;
)paren
id|vm
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
suffix:semicolon
id|maxSize
op_and_assign
op_complement
l_int|0x1FFFFF
suffix:semicolon
multiline_comment|/* must be X*2MB (really it must be 2 or X*4MB) */
multiline_comment|/* at least 2MB */
r_if
c_cond
(paren
id|maxSize
OL
l_int|0x0200000
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|maxSize
OG
l_int|0x2000000
)paren
id|maxSize
op_assign
l_int|0x2000000
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_EXTVGA_INDEX
comma
l_int|0x03
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_EXTVGA_DATA
comma
id|mga_inb
c_func
(paren
id|M_EXTVGA_DATA
)paren
op_or
l_int|0x80
)paren
suffix:semicolon
id|store
op_assign
id|mga_readb
c_func
(paren
id|vm
comma
l_int|0x1234
)paren
suffix:semicolon
id|tmp
op_assign
id|bytes
suffix:semicolon
r_for
c_loop
(paren
id|offs
op_assign
l_int|0x100000
suffix:semicolon
id|offs
OL
id|maxSize
suffix:semicolon
id|offs
op_add_assign
l_int|0x200000
)paren
op_star
id|tmp
op_increment
op_assign
id|mga_readb
c_func
(paren
id|vm
comma
id|offs
)paren
suffix:semicolon
r_for
c_loop
(paren
id|offs
op_assign
l_int|0x100000
suffix:semicolon
id|offs
OL
id|maxSize
suffix:semicolon
id|offs
op_add_assign
l_int|0x200000
)paren
id|mga_writeb
c_func
(paren
id|vm
comma
id|offs
comma
l_int|0x02
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|features.accel.has_cacheflush
)paren
)paren
id|mga_outb
c_func
(paren
id|M_CACHEFLUSH
comma
l_int|0x00
)paren
suffix:semicolon
r_else
id|mga_writeb
c_func
(paren
id|vm
comma
l_int|0x1234
comma
l_int|0x99
)paren
suffix:semicolon
id|cbase
op_assign
id|mbase
op_assign
l_int|0
suffix:semicolon
id|clen
op_assign
id|mlen
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|offs
op_assign
l_int|0x100000
suffix:semicolon
id|offs
OL
id|maxSize
suffix:semicolon
id|offs
op_add_assign
l_int|0x200000
)paren
(brace
r_if
c_cond
(paren
id|mga_readb
c_func
(paren
id|vm
comma
id|offs
)paren
op_ne
l_int|0x02
)paren
r_continue
suffix:semicolon
id|mga_writeb
c_func
(paren
id|vm
comma
id|offs
comma
id|mga_readb
c_func
(paren
id|vm
comma
id|offs
)paren
op_minus
l_int|0x02
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mga_readb
c_func
(paren
id|vm
comma
id|offs
)paren
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|offs
op_minus
l_int|0x100000
op_eq
id|cbase
op_plus
id|clen
)paren
(brace
id|clen
op_add_assign
l_int|0x200000
suffix:semicolon
)brace
r_else
(brace
id|cbase
op_assign
id|offs
op_minus
l_int|0x100000
suffix:semicolon
id|clen
op_assign
l_int|0x200000
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|clen
OG
id|mlen
)paren
macro_line|#ifndef MATROX_2MB_WITH_4MB_ADDON
op_logical_and
(paren
id|cbase
op_eq
l_int|0
)paren
macro_line|#endif
)paren
(brace
id|mbase
op_assign
id|cbase
suffix:semicolon
id|mlen
op_assign
id|clen
suffix:semicolon
)brace
)brace
id|tmp
op_assign
id|bytes
suffix:semicolon
r_for
c_loop
(paren
id|offs2
op_assign
l_int|0x100000
suffix:semicolon
id|offs2
OL
id|maxSize
suffix:semicolon
id|offs2
op_add_assign
l_int|0x200000
)paren
id|mga_writeb
c_func
(paren
id|vm
comma
id|offs2
comma
op_star
id|tmp
op_increment
)paren
suffix:semicolon
id|mga_writeb
c_func
(paren
id|vm
comma
l_int|0x1234
comma
id|store
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_EXTVGA_INDEX
comma
l_int|0x03
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_EXTVGA_DATA
comma
id|mga_inb
c_func
(paren
id|M_EXTVGA_DATA
)paren
op_amp
op_complement
l_int|0x80
)paren
suffix:semicolon
op_star
id|realOffset
op_assign
id|mbase
suffix:semicolon
op_star
id|realSize
op_assign
id|mlen
suffix:semicolon
macro_line|#ifdef CONFIG_FB_MATROX_MILLENIUM
id|ACCESS_FBINFO
c_func
(paren
id|interleave
)paren
op_assign
op_logical_neg
(paren
op_logical_neg
id|isMillenium
c_func
(paren
id|MINFO
)paren
op_logical_or
(paren
id|mbase
op_amp
l_int|0x3FFFFF
)paren
op_logical_or
(paren
id|mlen
op_amp
l_int|0x3FFFFF
)paren
)paren
suffix:semicolon
macro_line|#endif
r_return
l_int|1
suffix:semicolon
)brace
)def_block
macro_line|#ifdef CONFIG_FB_MATROX_MILLENIUM
DECL|function|Ti3026_preinit
r_static
r_int
id|__init
(def_block
id|Ti3026_preinit
c_func
(paren
id|WPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
)paren
(brace
r_static
r_const
r_int
id|vxres_mill2
(braket
)braket
op_assign
(brace
l_int|512
comma
l_int|640
comma
l_int|768
comma
l_int|800
comma
l_int|832
comma
l_int|960
comma
l_int|1024
comma
l_int|1152
comma
l_int|1280
comma
l_int|1600
comma
l_int|1664
comma
l_int|1920
comma
l_int|2048
comma
l_int|0
)brace
suffix:semicolon
r_static
r_const
r_int
id|vxres_mill1
(braket
)braket
op_assign
(brace
l_int|640
comma
l_int|768
comma
l_int|800
comma
l_int|960
comma
l_int|1024
comma
l_int|1152
comma
l_int|1280
comma
l_int|1600
comma
l_int|1920
comma
l_int|2048
comma
l_int|0
)brace
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;Ti3026_preinit&quot;
)paren
id|ACCESS_FBINFO
c_func
(paren
id|millenium
)paren
op_assign
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|milleniumII
)paren
op_assign
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
op_member_access_from_pointer
id|device
op_ne
id|PCI_DEVICE_ID_MATROX_MIL
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|capable.cfb4
)paren
op_assign
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|capable.text
)paren
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* isMilleniumII(MINFO); */
id|ACCESS_FBINFO
c_func
(paren
id|capable.vxres
)paren
op_assign
id|isMilleniumII
c_func
(paren
id|MINFO
)paren
ques
c_cond
id|vxres_mill2
suffix:colon
id|vxres_mill1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|cursor.timer.function
)paren
op_assign
id|matroxfb_ti3026_flashcursor
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.noinit
)paren
)paren
r_return
l_int|0
suffix:semicolon
multiline_comment|/* preserve VGA I/O, BIOS and PPC */
id|hw-&gt;MXoptionReg
op_and_assign
l_int|0xC0000100
suffix:semicolon
id|hw-&gt;MXoptionReg
op_or_assign
l_int|0x002C0000
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.novga
)paren
)paren
id|hw-&gt;MXoptionReg
op_and_assign
op_complement
l_int|0x00000100
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.nobios
)paren
)paren
id|hw-&gt;MXoptionReg
op_and_assign
op_complement
l_int|0x40000000
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.nopciretry
)paren
)paren
id|hw-&gt;MXoptionReg
op_or_assign
l_int|0x20000000
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_OPTION_REG
comma
id|hw-&gt;MXoptionReg
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|accel.ramdac_rev
)paren
op_assign
id|inTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XSILICONREV
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XCLKCTRL
comma
id|TVP3026_XCLKCTRL_SRC_CLK0VGA
op_or
id|TVP3026_XCLKCTRL_CLKSTOPPED
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XTRUECOLORCTRL
comma
id|TVP3026_XTRUECOLORCTRL_PSEUDOCOLOR
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XMUXCTRL
comma
id|TVP3026_XMUXCTRL_VGA
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPLLADDR
comma
l_int|0x2A
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XLOOPPLLDATA
comma
l_int|0x00
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XPIXPLLDATA
comma
l_int|0x00
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_MISC_REG
comma
l_int|0x67
)paren
suffix:semicolon
id|outTi3026
c_func
(paren
id|PMINFO
id|TVP3026_XMEMPLLCTRL
comma
id|TVP3026_XMEMPLLCTRL_STROBEMKC4
op_or
id|TVP3026_XMEMPLLCTRL_MCLK_MCLKPLL
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_RESET
comma
l_int|1
)paren
suffix:semicolon
id|udelay
c_func
(paren
l_int|250
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_RESET
comma
l_int|0
)paren
suffix:semicolon
id|udelay
c_func
(paren
l_int|250
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_MACCESS
comma
l_int|0x00008000
)paren
suffix:semicolon
id|udelay
c_func
(paren
l_int|10
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
)def_block
DECL|function|Ti3026_reset
r_static
r_void
id|__init
(def_block
id|Ti3026_reset
c_func
(paren
id|WPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;Ti3026_reset&quot;
)paren
id|matroxfb_fastfont_init
c_func
(paren
id|MINFO
)paren
suffix:semicolon
id|ti3026_ramdac_init
c_func
(paren
id|PMINFO
id|hw
)paren
suffix:semicolon
)brace
)def_block
macro_line|#endif
macro_line|#ifdef CONFIG_FB_MATROX_MILLENIUM
DECL|variable|matrox_millenium
r_static
r_struct
id|matrox_switch
id|matrox_millenium
op_assign
(brace
id|Ti3026_preinit
comma
id|Ti3026_reset
comma
id|Ti3026_init
comma
id|Ti3026_restore
)brace
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_FB_MATROX_MYSTIQUE
DECL|variable|matrox_mystique
r_static
r_struct
id|matrox_switch
id|matrox_mystique
op_assign
(brace
id|MGA1064_preinit
comma
id|MGA1064_reset
comma
id|MGA1064_init
comma
id|MGA1064_restore
)brace
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_FB_MATROX_G100
DECL|variable|matrox_G100
r_static
r_struct
id|matrox_switch
id|matrox_G100
op_assign
(brace
id|MGAG100_preinit
comma
id|MGAG100_reset
comma
id|MGAG100_init
comma
id|MGAG100_restore
)brace
suffix:semicolon
macro_line|#endif
DECL|struct|video_board
r_struct
id|video_board
(brace
DECL|member|maxvram
r_int
id|maxvram
suffix:semicolon
DECL|member|maxdisplayable
r_int
id|maxdisplayable
suffix:semicolon
DECL|member|accelID
r_int
id|accelID
suffix:semicolon
DECL|member|lowlevel
r_struct
id|matrox_switch
op_star
id|lowlevel
suffix:semicolon
)brace
suffix:semicolon
macro_line|#ifdef CONFIG_FB_MATROX_MILLENIUM
DECL|variable|__initdata
r_static
r_struct
id|video_board
id|vbMillenium
id|__initdata
op_assign
(brace
l_int|0x0800000
comma
l_int|0x0800000
comma
id|FB_ACCEL_MATROX_MGA2064W
comma
op_amp
id|matrox_millenium
)brace
suffix:semicolon
DECL|variable|__initdata
r_static
r_struct
id|video_board
id|vbMillenium2
id|__initdata
op_assign
(brace
l_int|0x1000000
comma
l_int|0x0800000
comma
id|FB_ACCEL_MATROX_MGA2164W
comma
op_amp
id|matrox_millenium
)brace
suffix:semicolon
DECL|variable|__initdata
r_static
r_struct
id|video_board
id|vbMillenium2A
id|__initdata
op_assign
(brace
l_int|0x1000000
comma
l_int|0x0800000
comma
id|FB_ACCEL_MATROX_MGA2164W_AGP
comma
op_amp
id|matrox_millenium
)brace
suffix:semicolon
macro_line|#endif&t;/* CONFIG_FB_MATROX_MILLENIUM */
macro_line|#ifdef CONFIG_FB_MATROX_MYSTIQUE
DECL|variable|__initdata
r_static
r_struct
id|video_board
id|vbMystique
id|__initdata
op_assign
(brace
l_int|0x0800000
comma
l_int|0x0800000
comma
id|FB_ACCEL_MATROX_MGA1064SG
comma
op_amp
id|matrox_mystique
)brace
suffix:semicolon
macro_line|#endif&t;/* CONFIG_FB_MATROX_MYSTIQUE */
macro_line|#ifdef CONFIG_FB_MATROX_G100
DECL|variable|__initdata
r_static
r_struct
id|video_board
id|vbG100
id|__initdata
op_assign
(brace
l_int|0x0800000
comma
l_int|0x0800000
comma
id|FB_ACCEL_MATROX_MGAG100
comma
op_amp
id|matrox_G100
)brace
suffix:semicolon
DECL|variable|__initdata
r_static
r_struct
id|video_board
id|vbG200
id|__initdata
op_assign
(brace
l_int|0x1000000
comma
l_int|0x1000000
comma
id|FB_ACCEL_MATROX_MGAG200
comma
op_amp
id|matrox_G100
)brace
suffix:semicolon
macro_line|#ifdef CONFIG_FB_MATROX_32MB
multiline_comment|/* from doc it looks like that accelerator can draw only to low 16MB :-( Direct accesses &amp; displaying are OK for&n;   whole 32MB */
DECL|variable|__initdata
r_static
r_struct
id|video_board
id|vbG400
id|__initdata
op_assign
(brace
l_int|0x2000000
comma
l_int|0x1000000
comma
id|FB_ACCEL_MATROX_MGAG400
comma
op_amp
id|matrox_G100
)brace
suffix:semicolon
macro_line|#else
DECL|variable|__initdata
r_static
r_struct
id|video_board
id|vbG400
id|__initdata
op_assign
(brace
l_int|0x2000000
comma
l_int|0x1000000
comma
id|FB_ACCEL_MATROX_MGAG400
comma
op_amp
id|matrox_G100
)brace
suffix:semicolon
macro_line|#endif
macro_line|#endif
DECL|macro|DEVF_VIDEO64BIT
mdefine_line|#define DEVF_VIDEO64BIT&t;0x01
DECL|macro|DEVF_SWAPS
mdefine_line|#define&t;DEVF_SWAPS&t;0x02
DECL|macro|DEVF_MILLENIUM
mdefine_line|#define DEVF_MILLENIUM&t;0x04
DECL|macro|DEVF_MILLENIUM2
mdefine_line|#define&t;DEVF_MILLENIUM2&t;0x08
DECL|macro|DEVF_CROSS4MB
mdefine_line|#define DEVF_CROSS4MB&t;0x10
DECL|macro|DEVF_TEXT4B
mdefine_line|#define DEVF_TEXT4B&t;0x20
DECL|macro|DEVF_DDC_8_2
mdefine_line|#define DEVF_DDC_8_2&t;0x40
DECL|macro|DEVF_DMA
mdefine_line|#define DEVF_DMA&t;0x80
DECL|macro|DEVF_SUPPORT32MB
mdefine_line|#define DEVF_SUPPORT32MB&t;0x100
DECL|macro|DEVF_ANY_VXRES
mdefine_line|#define DEVF_ANY_VXRES&t;&t;0x200
DECL|macro|DEVF_TEXT16B
mdefine_line|#define DEVF_TEXT16B&t;&t;0x400
DECL|macro|DEVF_G100
mdefine_line|#define DEVF_G100&t;(DEVF_VIDEO64BIT | DEVF_SWAPS | DEVF_CROSS4MB | DEVF_DDC_8_2) /* no doc, no vxres... */
DECL|macro|DEVF_G200
mdefine_line|#define DEVF_G200&t;(DEVF_VIDEO64BIT | DEVF_SWAPS | DEVF_CROSS4MB | DEVF_DDC_8_2 | DEVF_ANY_VXRES)
DECL|macro|DEVF_G400
mdefine_line|#define DEVF_G400&t;(DEVF_VIDEO64BIT | DEVF_SWAPS | DEVF_CROSS4MB | DEVF_DDC_8_2 | DEVF_ANY_VXRES | DEVF_SUPPORT32MB | DEVF_TEXT16B)
DECL|struct|board
r_static
r_struct
id|board
(brace
DECL|member|vendor
DECL|member|device
DECL|member|rev
DECL|member|svid
DECL|member|sid
r_int
r_int
id|vendor
comma
id|device
comma
id|rev
comma
id|svid
comma
id|sid
suffix:semicolon
DECL|member|flags
r_int
r_int
id|flags
suffix:semicolon
DECL|member|maxclk
r_int
r_int
id|maxclk
suffix:semicolon
DECL|member|base
r_struct
id|video_board
op_star
id|base
suffix:semicolon
DECL|member|name
r_const
r_char
op_star
id|name
suffix:semicolon
DECL|variable|__initdata
)brace
id|dev_list
(braket
)braket
id|__initdata
op_assign
(brace
macro_line|#ifdef CONFIG_FB_MATROX_MILLENIUM
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_MIL
comma
l_int|0xFF
comma
l_int|0
comma
l_int|0
comma
id|DEVF_MILLENIUM
op_or
id|DEVF_TEXT4B
comma
l_int|230000
comma
op_amp
id|vbMillenium
comma
l_string|&quot;Millennium (PCI)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_MIL_2
comma
l_int|0xFF
comma
l_int|0
comma
l_int|0
comma
id|DEVF_MILLENIUM
op_or
id|DEVF_MILLENIUM2
op_or
id|DEVF_SWAPS
comma
l_int|220000
comma
op_amp
id|vbMillenium2
comma
l_string|&quot;Millennium II (PCI)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_MIL_2_AGP
comma
l_int|0xFF
comma
l_int|0
comma
l_int|0
comma
id|DEVF_MILLENIUM
op_or
id|DEVF_MILLENIUM2
op_or
id|DEVF_SWAPS
comma
l_int|250000
comma
op_amp
id|vbMillenium2A
comma
l_string|&quot;Millennium II (AGP)&quot;
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_MATROX_MYSTIQUE
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_MYS
comma
l_int|0x02
comma
l_int|0
comma
l_int|0
comma
id|DEVF_VIDEO64BIT
comma
l_int|180000
comma
op_amp
id|vbMystique
comma
l_string|&quot;Mystique (PCI)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_MYS
comma
l_int|0xFF
comma
l_int|0
comma
l_int|0
comma
id|DEVF_VIDEO64BIT
op_or
id|DEVF_SWAPS
comma
l_int|220000
comma
op_amp
id|vbMystique
comma
l_string|&quot;Mystique 220 (PCI)&quot;
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_MATROX_G100
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G100
comma
l_int|0xFF
comma
id|PCI_SS_VENDOR_ID_MATROX
comma
id|PCI_SS_ID_MATROX_MGA_G100_PCI
comma
id|DEVF_G100
comma
l_int|230000
comma
op_amp
id|vbG100
comma
l_string|&quot;MGA-G100 (PCI)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G100
comma
l_int|0xFF
comma
l_int|0
comma
l_int|0
comma
id|DEVF_G100
comma
l_int|230000
comma
op_amp
id|vbG100
comma
l_string|&quot;unknown G100 (PCI)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G100_AGP
comma
l_int|0xFF
comma
id|PCI_SS_VENDOR_ID_MATROX
comma
id|PCI_SS_ID_MATROX_GENERIC
comma
id|DEVF_G100
comma
l_int|230000
comma
op_amp
id|vbG100
comma
l_string|&quot;MGA-G100 (AGP)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G100_AGP
comma
l_int|0xFF
comma
id|PCI_SS_VENDOR_ID_MATROX
comma
id|PCI_SS_ID_MATROX_MGA_G100_AGP
comma
id|DEVF_G100
comma
l_int|230000
comma
op_amp
id|vbG100
comma
l_string|&quot;MGA-G100 (AGP)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G100_AGP
comma
l_int|0xFF
comma
id|PCI_SS_VENDOR_ID_SIEMENS_NIXDORF
comma
id|PCI_SS_ID_SIEMENS_MGA_G100_AGP
comma
id|DEVF_G100
comma
l_int|230000
comma
op_amp
id|vbG100
comma
l_string|&quot;MGA-G100 (AGP)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G100_AGP
comma
l_int|0xFF
comma
id|PCI_SS_VENDOR_ID_MATROX
comma
id|PCI_SS_ID_MATROX_PRODUCTIVA_G100_AGP
comma
id|DEVF_G100
comma
l_int|230000
comma
op_amp
id|vbG100
comma
l_string|&quot;Productiva G100 (AGP)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G100_AGP
comma
l_int|0xFF
comma
l_int|0
comma
l_int|0
comma
id|DEVF_G100
comma
l_int|230000
comma
op_amp
id|vbG100
comma
l_string|&quot;unknown G100 (AGP)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G200_PCI
comma
l_int|0xFF
comma
l_int|0
comma
l_int|0
comma
id|DEVF_G200
comma
l_int|250000
comma
op_amp
id|vbG200
comma
l_string|&quot;unknown G200 (PCI)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G200_AGP
comma
l_int|0xFF
comma
id|PCI_SS_VENDOR_ID_MATROX
comma
id|PCI_SS_ID_MATROX_GENERIC
comma
id|DEVF_G200
comma
l_int|220000
comma
op_amp
id|vbG200
comma
l_string|&quot;MGA-G200 (AGP)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G200_AGP
comma
l_int|0xFF
comma
id|PCI_SS_VENDOR_ID_MATROX
comma
id|PCI_SS_ID_MATROX_MYSTIQUE_G200_AGP
comma
id|DEVF_G200
comma
l_int|230000
comma
op_amp
id|vbG200
comma
l_string|&quot;Mystique G200 (AGP)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G200_AGP
comma
l_int|0xFF
comma
id|PCI_SS_VENDOR_ID_MATROX
comma
id|PCI_SS_ID_MATROX_MILLENIUM_G200_AGP
comma
id|DEVF_G200
comma
l_int|250000
comma
op_amp
id|vbG200
comma
l_string|&quot;Millennium G200 (AGP)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G200_AGP
comma
l_int|0xFF
comma
id|PCI_SS_VENDOR_ID_MATROX
comma
id|PCI_SS_ID_MATROX_MARVEL_G200_AGP
comma
id|DEVF_G200
comma
l_int|230000
comma
op_amp
id|vbG200
comma
l_string|&quot;Marvel G200 (AGP)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G200_AGP
comma
l_int|0xFF
comma
id|PCI_SS_VENDOR_ID_SIEMENS_NIXDORF
comma
id|PCI_SS_ID_SIEMENS_MGA_G200_AGP
comma
id|DEVF_G200
comma
l_int|230000
comma
op_amp
id|vbG200
comma
l_string|&quot;MGA-G200 (AGP)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G200_AGP
comma
l_int|0xFF
comma
l_int|0
comma
l_int|0
comma
id|DEVF_G200
comma
l_int|230000
comma
op_amp
id|vbG200
comma
l_string|&quot;unknown G200 (AGP)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G400_AGP
comma
l_int|0xFF
comma
l_int|0
comma
l_int|0
comma
id|DEVF_G400
comma
l_int|360000
comma
op_amp
id|vbG400
comma
l_string|&quot;unknown G400 (AGP)&quot;
)brace
comma
macro_line|#endif
(brace
l_int|0
comma
l_int|0
comma
l_int|0xFF
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|NULL
comma
l_int|NULL
)brace
)brace
suffix:semicolon
macro_line|#ifndef MODULE
multiline_comment|/* it cannot be static const struct due to __initdata&n;&t;&t;marker */
DECL|variable|__initdata
r_static
r_struct
id|fb_videomode
id|defaultmode
id|__initdata
op_assign
(brace
multiline_comment|/* 640x480 @ 60Hz, 31.5 kHz */
l_int|NULL
comma
l_int|60
comma
l_int|640
comma
l_int|480
comma
l_int|39721
comma
l_int|40
comma
l_int|24
comma
l_int|32
comma
l_int|11
comma
l_int|96
comma
l_int|2
comma
l_int|0
comma
id|FB_VMODE_NONINTERLACED
)brace
suffix:semicolon
macro_line|#endif /* !MODULE */
DECL|function|initMatrox2
r_static
r_int
id|__init
(def_block
id|initMatrox2
c_func
(paren
id|WPMINFO
r_struct
id|display
op_star
id|d
comma
r_struct
id|board
op_star
id|b
)paren
(brace
r_int
r_int
id|ctrlptr_phys
op_assign
l_int|0
suffix:semicolon
r_int
r_int
id|video_base_phys
op_assign
l_int|0
suffix:semicolon
r_int
r_int
id|memsize
suffix:semicolon
r_struct
id|matrox_hw_state
op_star
id|hw
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|currenthw
)paren
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;initMatrox2&quot;
)paren
multiline_comment|/* set default values... */
id|vesafb_defined.accel_flags
op_assign
id|FB_ACCELF_TEXT
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|hw_switch
)paren
op_assign
id|b-&gt;base-&gt;lowlevel
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.accelerator
)paren
op_assign
id|b-&gt;base-&gt;accelID
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|max_pixel_clock
)paren
op_assign
id|b-&gt;maxclk
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;matroxfb: Matrox %s detected&bslash;n&quot;
comma
id|b-&gt;name
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|capable.plnwt
)paren
op_assign
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.video64bits
)paren
op_assign
id|b-&gt;flags
op_amp
id|DEVF_VIDEO64BIT
suffix:semicolon
r_if
c_cond
(paren
id|b-&gt;flags
op_amp
id|DEVF_TEXT4B
)paren
(brace
id|ACCESS_FBINFO
c_func
(paren
id|devflags.vgastep
)paren
op_assign
l_int|4
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textmode
)paren
op_assign
l_int|4
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.text_type_aux
)paren
op_assign
id|FB_AUX_TEXT_MGA_STEP16
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|b-&gt;flags
op_amp
id|DEVF_TEXT16B
)paren
(brace
id|ACCESS_FBINFO
c_func
(paren
id|devflags.vgastep
)paren
op_assign
l_int|16
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textmode
)paren
op_assign
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.text_type_aux
)paren
op_assign
id|FB_AUX_TEXT_MGA_STEP16
suffix:semicolon
)brace
r_else
(brace
id|ACCESS_FBINFO
c_func
(paren
id|devflags.vgastep
)paren
op_assign
l_int|8
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textmode
)paren
op_assign
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.text_type_aux
)paren
op_assign
id|FB_AUX_TEXT_MGA_STEP8
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_FB_MATROX_32MB
id|ACCESS_FBINFO
c_func
(paren
id|devflags.support32MB
)paren
op_assign
id|b-&gt;flags
op_amp
id|DEVF_SUPPORT32MB
suffix:semicolon
macro_line|#endif
id|ACCESS_FBINFO
c_func
(paren
id|devflags.precise_width
)paren
op_assign
op_logical_neg
(paren
id|b-&gt;flags
op_amp
id|DEVF_ANY_VXRES
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textstep
)paren
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|devflags.vgastep
)paren
op_star
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textmode
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textvram
)paren
op_assign
l_int|65536
op_div
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textmode
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|capable.cross4MB
)paren
OL
l_int|0
)paren
id|ACCESS_FBINFO
c_func
(paren
id|capable.cross4MB
)paren
op_assign
id|b-&gt;flags
op_amp
id|DEVF_CROSS4MB
suffix:semicolon
r_if
c_cond
(paren
id|b-&gt;flags
op_amp
id|DEVF_SWAPS
)paren
(brace
id|ctrlptr_phys
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
op_member_access_from_pointer
id|resource
(braket
l_int|1
)braket
dot
id|start
suffix:semicolon
id|video_base_phys
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
op_member_access_from_pointer
id|resource
(braket
l_int|0
)braket
dot
id|start
suffix:semicolon
)brace
r_else
(brace
id|ctrlptr_phys
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
op_member_access_from_pointer
id|resource
(braket
l_int|0
)braket
dot
id|start
suffix:semicolon
id|video_base_phys
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
op_member_access_from_pointer
id|resource
(braket
l_int|1
)braket
dot
id|start
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|ctrlptr_phys
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: control registers are not available, matroxfb disabled&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|video_base_phys
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: video RAM is not available in PCI address space, matroxfb disabled&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|mga_ioremap
c_func
(paren
id|ctrlptr_phys
comma
l_int|16384
comma
id|MGA_IOREMAP_MMIO
comma
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|mmio.vbase
)paren
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: cannot ioremap(%lX, 16384), matroxfb disabled&bslash;n&quot;
comma
id|ctrlptr_phys
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|ACCESS_FBINFO
c_func
(paren
id|mmio.base
)paren
op_assign
id|ctrlptr_phys
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|mmio.len
)paren
op_assign
l_int|16384
suffix:semicolon
id|memsize
op_assign
id|b-&gt;base-&gt;maxvram
suffix:semicolon
multiline_comment|/* convert mem (autodetect k, M) */
r_if
c_cond
(paren
id|mem
OL
l_int|1024
)paren
id|mem
op_mul_assign
l_int|1024
suffix:semicolon
r_if
c_cond
(paren
id|mem
OL
l_int|0x00100000
)paren
id|mem
op_mul_assign
l_int|1024
suffix:semicolon
r_if
c_cond
(paren
id|mem
op_logical_and
(paren
id|mem
OL
id|memsize
)paren
)paren
id|memsize
op_assign
id|mem
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|video.base
)paren
op_assign
id|video_base_phys
suffix:semicolon
r_if
c_cond
(paren
id|mga_ioremap
c_func
(paren
id|video_base_phys
comma
id|memsize
comma
id|MGA_IOREMAP_FB
comma
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: cannot ioremap(%lX, %d), matroxfb disabled&bslash;n&quot;
comma
id|video_base_phys
comma
id|memsize
)paren
suffix:semicolon
id|mga_iounmap
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|mmio.vbase
)paren
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
(brace
id|u_int32_t
id|cmd
suffix:semicolon
id|u_int32_t
id|mga_option
suffix:semicolon
multiline_comment|/* Matrox MilleniumII is deactivated on bootup, but address&n;&t;&t;   regions are assigned to board. So we have to enable it */
id|pci_read_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_OPTION_REG
comma
op_amp
id|mga_option
)paren
suffix:semicolon
id|pci_read_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_COMMAND
comma
op_amp
id|cmd
)paren
suffix:semicolon
id|mga_option
op_and_assign
l_int|0x7FFFFFFF
suffix:semicolon
multiline_comment|/* clear BIG_ENDIAN */
r_if
c_cond
(paren
(paren
id|cmd
op_amp
id|PCI_COMMAND_MEMORY
)paren
op_ne
id|PCI_COMMAND_MEMORY
)paren
(brace
multiline_comment|/* But if we have to enable it, we have probably to&n;                           disable VGA I/O and BIOS... Sure? */
id|dprintk
c_func
(paren
id|KERN_WARNING
l_string|&quot;matroxfb: PCI BIOS did not enable device!&bslash;n&quot;
)paren
suffix:semicolon
id|cmd
op_assign
(paren
id|cmd
op_or
id|PCI_COMMAND_MEMORY
)paren
op_amp
op_complement
id|PCI_COMMAND_VGA_PALETTE
suffix:semicolon
id|mga_option
op_and_assign
l_int|0xBFFFFEFF
suffix:semicolon
multiline_comment|/* we must not enable VGA, BIOS if PCI BIOS did not enable device itself */
id|ACCESS_FBINFO
c_func
(paren
id|devflags.novga
)paren
op_assign
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.nobios
)paren
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* we must initialize device if PCI BIOS did not enable it.&n;&t;&t;&t;   It probably means that it is second head ... */
id|ACCESS_FBINFO
c_func
(paren
id|devflags.noinit
)paren
op_assign
l_int|0
suffix:semicolon
)brace
id|mga_option
op_or_assign
id|MX_OPTION_BSWAP
suffix:semicolon
r_if
c_cond
(paren
id|pci_find_device
c_func
(paren
id|PCI_VENDOR_ID_INTEL
comma
id|PCI_DEVICE_ID_INTEL_82437
comma
l_int|NULL
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|mga_option
op_amp
l_int|0x20000000
)paren
op_logical_and
op_logical_neg
id|ACCESS_FBINFO
c_func
(paren
id|devflags.nopciretry
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;matroxfb: Disabling PCI retries due to i82437 present&bslash;n&quot;
)paren
suffix:semicolon
)brace
id|mga_option
op_or_assign
l_int|0x20000000
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.nopciretry
)paren
op_assign
l_int|1
suffix:semicolon
)brace
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_COMMAND
comma
id|cmd
)paren
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_OPTION_REG
comma
id|mga_option
)paren
suffix:semicolon
id|hw-&gt;MXoptionReg
op_assign
id|mga_option
suffix:semicolon
multiline_comment|/* select non-DMA memory for PCI_MGA_DATA, otherwise dump of PCI cfg space can lock PCI bus */
multiline_comment|/* maybe preinit() candidate, but it is same... for all devices... at this time... */
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_MGA_INDEX
comma
l_int|0x00003C00
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|hw_switch
)paren
op_member_access_from_pointer
id|preinit
c_func
(paren
id|PMINFO
id|hw
)paren
)paren
(brace
id|mga_iounmap
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
)paren
suffix:semicolon
id|mga_iounmap
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|mmio.vbase
)paren
)paren
suffix:semicolon
r_return
op_minus
id|ENXIO
suffix:semicolon
)brace
(brace
r_int
r_int
id|offs
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|matroxfb_getmemory
c_func
(paren
id|PMINFO
id|memsize
comma
op_amp
id|offs
comma
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|video.len
)paren
)paren
op_logical_or
op_logical_neg
id|ACCESS_FBINFO
c_func
(paren
id|video.len
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: cannot determine memory size&bslash;n&quot;
)paren
suffix:semicolon
id|mga_iounmap
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
)paren
suffix:semicolon
id|mga_iounmap
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|mmio.vbase
)paren
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
macro_line|#ifdef MATROX_2MB_WITH_4MB_ADDON
macro_line|#ifdef FBCON_HAS_CFB24
(brace
r_int
r_int
id|end
op_assign
id|offs
op_plus
id|ACCESS_FBINFO
c_func
(paren
id|video.len
)paren
suffix:semicolon
r_if
c_cond
(paren
id|offs
)paren
id|offs
op_assign
(paren
(paren
id|offs
op_minus
l_int|1
)paren
op_div
(paren
l_int|4096
op_star
l_int|3
)paren
op_plus
l_int|1
)paren
op_star
l_int|4096
op_star
l_int|3
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|video.len
)paren
op_assign
id|end
op_minus
id|offs
suffix:semicolon
)brace
macro_line|#endif
id|ACCESS_FBINFO
c_func
(paren
id|devflags.ydstorg
)paren
op_assign
id|offs
suffix:semicolon
id|video_base_phys
op_add_assign
id|offs
suffix:semicolon
r_if
c_cond
(paren
id|offs
)paren
id|ACCESS_FBINFO
c_func
(paren
id|capable.text
)paren
op_assign
l_int|0
suffix:semicolon
macro_line|#else
id|ACCESS_FBINFO
c_func
(paren
id|devflags.ydstorg
)paren
op_assign
l_int|0
suffix:semicolon
macro_line|#endif
)brace
id|ACCESS_FBINFO
c_func
(paren
id|currcon
)paren
op_assign
op_minus
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|currcon_display
)paren
op_assign
id|d
suffix:semicolon
id|mga_iounmap
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|video.base
)paren
op_assign
id|video_base_phys
suffix:semicolon
r_if
c_cond
(paren
id|mga_ioremap
c_func
(paren
id|video_base_phys
comma
id|ACCESS_FBINFO
c_func
(paren
id|video.len
)paren
comma
id|MGA_IOREMAP_FB
comma
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: cannot ioremap(%lX, %d), matroxfb disabled&bslash;n&quot;
comma
id|video_base_phys
comma
id|ACCESS_FBINFO
c_func
(paren
id|video.len
)paren
)paren
suffix:semicolon
id|mga_iounmap
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|mmio.vbase
)paren
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|ACCESS_FBINFO
c_func
(paren
id|video.len_usable
)paren
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|video.len
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.len_usable
)paren
OG
id|b-&gt;base-&gt;maxdisplayable
)paren
id|ACCESS_FBINFO
c_func
(paren
id|video.len_usable
)paren
op_assign
id|b-&gt;base-&gt;maxdisplayable
suffix:semicolon
macro_line|#ifdef CONFIG_MTRR
r_if
c_cond
(paren
id|mtrr
)paren
(brace
id|ACCESS_FBINFO
c_func
(paren
id|mtrr.vram
)paren
op_assign
id|mtrr_add
c_func
(paren
id|video_base_phys
comma
id|ACCESS_FBINFO
c_func
(paren
id|video.len
)paren
comma
id|MTRR_TYPE_WRCOMB
comma
l_int|1
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|mtrr.vram_valid
)paren
op_assign
l_int|1
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;matroxfb: MTRR&squot;s turned on&bslash;n&quot;
)paren
suffix:semicolon
)brace
macro_line|#endif&t;/* CONFIG_MTRR */
r_if
c_cond
(paren
op_logical_neg
id|ACCESS_FBINFO
c_func
(paren
id|devflags.novga
)paren
)paren
id|request_region
c_func
(paren
l_int|0x3C0
comma
l_int|32
comma
l_string|&quot;matrox&quot;
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|hw_switch
op_member_access_from_pointer
id|reset
c_func
(paren
id|PMINFO
id|hw
)paren
)paren
suffix:semicolon
multiline_comment|/* validate params, autodetect k, M */
r_if
c_cond
(paren
id|fh
OL
l_int|1000
)paren
id|fh
op_mul_assign
l_int|1000
suffix:semicolon
multiline_comment|/* 1kHz minimum */
r_if
c_cond
(paren
id|maxclk
OL
l_int|1000
)paren
id|maxclk
op_mul_assign
l_int|1000
suffix:semicolon
multiline_comment|/* kHz -&gt; Hz, MHz -&gt; kHz */
r_if
c_cond
(paren
id|maxclk
OL
l_int|1000000
)paren
id|maxclk
op_mul_assign
l_int|1000
suffix:semicolon
multiline_comment|/* kHz -&gt; Hz, 1MHz minimum */
r_if
c_cond
(paren
id|vesa
op_ne
op_complement
l_int|0
)paren
id|vesa
op_and_assign
l_int|0x1DFF
suffix:semicolon
multiline_comment|/* mask out clearscreen, acceleration and so on */
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.monspecs.hfmin
)paren
op_assign
l_int|0
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.monspecs.hfmax
)paren
op_assign
id|fh
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.monspecs.vfmin
)paren
op_assign
l_int|0
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.monspecs.vfmax
)paren
op_assign
id|fv
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.monspecs.dpms
)paren
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* TBD */
multiline_comment|/* static settings */
r_for
c_loop
(paren
id|RSptr
op_assign
id|vesamap
suffix:semicolon
id|RSptr-&gt;vesa
suffix:semicolon
id|RSptr
op_increment
)paren
(brace
r_if
c_cond
(paren
id|RSptr-&gt;vesa
op_eq
id|vesa
)paren
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|RSptr-&gt;vesa
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;Invalid vesa mode 0x%04X&bslash;n&quot;
comma
id|vesa
)paren
suffix:semicolon
id|RSptr
op_assign
id|vesamap
suffix:semicolon
)brace
(brace
r_int
id|res
op_assign
id|RSResolution
c_func
(paren
id|RSptr-&gt;info
)paren
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|left
op_eq
op_complement
l_int|0
)paren
id|left
op_assign
id|timmings
(braket
id|res
)braket
dot
id|left
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|xres
)paren
id|xres
op_assign
id|timmings
(braket
id|res
)braket
dot
id|xres
suffix:semicolon
r_if
c_cond
(paren
id|right
op_eq
op_complement
l_int|0
)paren
id|right
op_assign
id|timmings
(braket
id|res
)braket
dot
id|right
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|hslen
)paren
id|hslen
op_assign
id|timmings
(braket
id|res
)braket
dot
id|hslen
suffix:semicolon
r_if
c_cond
(paren
id|upper
op_eq
op_complement
l_int|0
)paren
id|upper
op_assign
id|timmings
(braket
id|res
)braket
dot
id|upper
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|yres
)paren
id|yres
op_assign
id|timmings
(braket
id|res
)braket
dot
id|yres
suffix:semicolon
r_if
c_cond
(paren
id|lower
op_eq
op_complement
l_int|0
)paren
id|lower
op_assign
id|timmings
(braket
id|res
)braket
dot
id|lower
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|vslen
)paren
id|vslen
op_assign
id|timmings
(braket
id|res
)braket
dot
id|vslen
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|fv
op_logical_or
id|fh
op_logical_or
id|maxclk
op_logical_or
id|pixclock
)paren
)paren
id|fv
op_assign
id|timmings
(braket
id|res
)braket
dot
id|vfreq
suffix:semicolon
r_if
c_cond
(paren
id|depth
op_eq
op_minus
l_int|1
)paren
id|depth
op_assign
id|RSDepth
c_func
(paren
id|RSptr-&gt;info
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|depth
op_eq
id|RSText8
)paren
op_logical_and
(paren
op_logical_neg
op_star
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.fontname
)paren
)paren
)paren
(brace
id|strcpy
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.fontname
)paren
comma
l_string|&quot;VGA8x8&quot;
)paren
suffix:semicolon
)brace
id|vesafb_defined.red
op_assign
id|colors
(braket
id|depth
op_minus
l_int|1
)braket
dot
id|red
suffix:semicolon
id|vesafb_defined.green
op_assign
id|colors
(braket
id|depth
op_minus
l_int|1
)braket
dot
id|green
suffix:semicolon
id|vesafb_defined.blue
op_assign
id|colors
(braket
id|depth
op_minus
l_int|1
)braket
dot
id|blue
suffix:semicolon
id|vesafb_defined.bits_per_pixel
op_assign
id|colors
(braket
id|depth
op_minus
l_int|1
)braket
dot
id|bits_per_pixel
suffix:semicolon
id|vesafb_defined.grayscale
op_assign
id|grayscale
suffix:semicolon
id|vesafb_defined.vmode
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|noaccel
)paren
id|vesafb_defined.accel_flags
op_and_assign
op_complement
id|FB_ACCELF_TEXT
suffix:semicolon
id|strcpy
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.modename
)paren
comma
l_string|&quot;MATROX VGA&quot;
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.changevar
)paren
op_assign
l_int|NULL
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.node
)paren
op_assign
op_minus
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.fbops
)paren
op_assign
op_amp
id|matroxfb_ops
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.disp
)paren
op_assign
id|d
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.switch_con
)paren
op_assign
op_amp
id|matroxfb_switch
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.updatevar
)paren
op_assign
op_amp
id|matroxfb_updatevar
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.blank
)paren
op_assign
op_amp
id|matroxfb_blank
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.flags
)paren
op_assign
id|FBINFO_FLAG_DEFAULT
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|video.len_usable
)paren
op_and_assign
id|PAGE_MASK
suffix:semicolon
macro_line|#ifndef MODULE
multiline_comment|/* mode database is marked __init ... */
(brace
id|fb_find_mode
c_func
(paren
op_amp
id|vesafb_defined
comma
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
comma
id|videomode
(braket
l_int|0
)braket
ques
c_cond
id|videomode
suffix:colon
l_int|NULL
comma
l_int|NULL
comma
l_int|0
comma
op_amp
id|defaultmode
comma
id|vesafb_defined.bits_per_pixel
)paren
suffix:semicolon
)brace
macro_line|#endif /* !MODULE */
multiline_comment|/* mode modifiers */
r_if
c_cond
(paren
id|hslen
)paren
id|vesafb_defined.hsync_len
op_assign
id|hslen
suffix:semicolon
r_if
c_cond
(paren
id|vslen
)paren
id|vesafb_defined.vsync_len
op_assign
id|vslen
suffix:semicolon
r_if
c_cond
(paren
id|left
op_ne
op_complement
l_int|0
)paren
id|vesafb_defined.left_margin
op_assign
id|left
suffix:semicolon
r_if
c_cond
(paren
id|right
op_ne
op_complement
l_int|0
)paren
id|vesafb_defined.right_margin
op_assign
id|right
suffix:semicolon
r_if
c_cond
(paren
id|upper
op_ne
op_complement
l_int|0
)paren
id|vesafb_defined.upper_margin
op_assign
id|upper
suffix:semicolon
r_if
c_cond
(paren
id|lower
op_ne
op_complement
l_int|0
)paren
id|vesafb_defined.lower_margin
op_assign
id|lower
suffix:semicolon
r_if
c_cond
(paren
id|xres
)paren
id|vesafb_defined.xres
op_assign
id|xres
suffix:semicolon
r_if
c_cond
(paren
id|yres
)paren
id|vesafb_defined.yres
op_assign
id|yres
suffix:semicolon
r_if
c_cond
(paren
id|sync
op_ne
op_minus
l_int|1
)paren
id|vesafb_defined.sync
op_assign
id|sync
suffix:semicolon
r_else
r_if
c_cond
(paren
id|vesafb_defined.sync
op_eq
op_complement
l_int|0
)paren
(brace
id|vesafb_defined.sync
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|yres
OL
l_int|400
)paren
id|vesafb_defined.sync
op_or_assign
id|FB_SYNC_HOR_HIGH_ACT
suffix:semicolon
r_else
r_if
c_cond
(paren
id|yres
OL
l_int|480
)paren
id|vesafb_defined.sync
op_or_assign
id|FB_SYNC_VERT_HIGH_ACT
suffix:semicolon
)brace
multiline_comment|/* fv, fh, maxclk limits was specified */
(brace
r_int
r_int
id|tmp
suffix:semicolon
r_if
c_cond
(paren
id|fv
)paren
(brace
id|tmp
op_assign
id|fv
op_star
(paren
id|vesafb_defined.upper_margin
op_plus
id|vesafb_defined.yres
op_plus
id|vesafb_defined.lower_margin
op_plus
id|vesafb_defined.vsync_len
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|tmp
OL
id|fh
)paren
op_logical_or
(paren
id|fh
op_eq
l_int|0
)paren
)paren
id|fh
op_assign
id|tmp
suffix:semicolon
)brace
r_if
c_cond
(paren
id|fh
)paren
(brace
id|tmp
op_assign
id|fh
op_star
(paren
id|vesafb_defined.left_margin
op_plus
id|vesafb_defined.xres
op_plus
id|vesafb_defined.right_margin
op_plus
id|vesafb_defined.hsync_len
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|tmp
OL
id|maxclk
)paren
op_logical_or
(paren
id|maxclk
op_eq
l_int|0
)paren
)paren
id|maxclk
op_assign
id|tmp
suffix:semicolon
)brace
id|maxclk
op_assign
(paren
id|maxclk
op_plus
l_int|499
)paren
op_div
l_int|500
suffix:semicolon
r_if
c_cond
(paren
id|maxclk
)paren
(brace
id|tmp
op_assign
(paren
l_int|2000000000
op_plus
id|maxclk
)paren
op_div
id|maxclk
suffix:semicolon
r_if
c_cond
(paren
id|tmp
OG
id|pixclock
)paren
id|pixclock
op_assign
id|tmp
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|pixclock
)paren
(brace
r_if
c_cond
(paren
id|pixclock
OL
l_int|2000
)paren
multiline_comment|/* &gt; 500MHz */
id|pixclock
op_assign
l_int|4000
suffix:semicolon
multiline_comment|/* 250MHz */
r_if
c_cond
(paren
id|pixclock
OG
l_int|1000000
)paren
id|pixclock
op_assign
l_int|1000000
suffix:semicolon
multiline_comment|/* 1MHz */
id|vesafb_defined.pixclock
op_assign
id|pixclock
suffix:semicolon
)brace
multiline_comment|/* FIXME: Where to move this?! */
macro_line|#if defined(CONFIG_FB_OF)
macro_line|#if defined(CONFIG_FB_COMPAT_XPMAC)
id|strcpy
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|matrox_name
)paren
comma
l_string|&quot;MTRX,&quot;
)paren
suffix:semicolon
multiline_comment|/* OpenFirmware naming convension */
id|strncat
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|matrox_name
)paren
comma
id|b-&gt;name
comma
l_int|26
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|console_fb_info
)paren
id|console_fb_info
op_assign
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
(paren
id|xres
op_le
l_int|640
)paren
op_logical_and
(paren
id|yres
op_le
l_int|480
)paren
)paren
(brace
r_struct
id|fb_var_screeninfo
id|var
suffix:semicolon
r_if
c_cond
(paren
id|default_vmode
op_eq
id|VMODE_NVRAM
)paren
(brace
id|default_vmode
op_assign
id|nvram_read_byte
c_func
(paren
id|NV_VMODE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|default_vmode
op_le
l_int|0
op_logical_or
id|default_vmode
OG
id|VMODE_MAX
)paren
id|default_vmode
op_assign
id|VMODE_CHOOSE
suffix:semicolon
)brace
r_if
c_cond
(paren
id|default_vmode
op_le
l_int|0
op_logical_or
id|default_vmode
OG
id|VMODE_MAX
)paren
id|default_vmode
op_assign
id|VMODE_640_480_60
suffix:semicolon
r_if
c_cond
(paren
id|default_cmode
op_eq
id|CMODE_NVRAM
)paren
id|default_cmode
op_assign
id|nvram_read_byte
c_func
(paren
id|NV_CMODE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|default_cmode
template_param
id|CMODE_32
)paren
id|default_cmode
op_assign
id|CMODE_8
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|mac_vmode_to_var
c_func
(paren
id|default_vmode
comma
id|default_cmode
comma
op_amp
id|var
)paren
)paren
(brace
id|var.accel_flags
op_assign
id|vesafb_defined.accel_flags
suffix:semicolon
id|var.xoffset
op_assign
id|var.yoffset
op_assign
l_int|0
suffix:semicolon
id|vesafb_defined
op_assign
id|var
suffix:semicolon
multiline_comment|/* Note: mac_vmode_to_var() doesnot set all parameters */
)brace
)brace
macro_line|#endif
id|vesafb_defined.xres_virtual
op_assign
id|vesafb_defined.xres
suffix:semicolon
r_if
c_cond
(paren
id|nopan
)paren
(brace
id|vesafb_defined.yres_virtual
op_assign
id|vesafb_defined.yres
suffix:semicolon
)brace
r_else
(brace
id|vesafb_defined.yres_virtual
op_assign
l_int|65536
suffix:semicolon
multiline_comment|/* large enough to be INF, but small enough&n;&t;&t;                                        to yres_virtual * xres_virtual &lt; 2^32 */
)brace
r_if
c_cond
(paren
id|matroxfb_set_var
c_func
(paren
op_amp
id|vesafb_defined
comma
op_minus
l_int|2
comma
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: cannot set required parameters&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;matroxfb: %dx%dx%dbpp (virtual: %dx%d)&bslash;n&quot;
comma
id|vesafb_defined.xres
comma
id|vesafb_defined.yres
comma
id|vesafb_defined.bits_per_pixel
comma
id|vesafb_defined.xres_virtual
comma
id|vesafb_defined.yres_virtual
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;matroxfb: framebuffer at 0x%lX, mapped to 0x%p, size %d&bslash;n&quot;
comma
id|ACCESS_FBINFO
c_func
(paren
id|video.base
)paren
comma
id|vaddr_va
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
)paren
comma
id|ACCESS_FBINFO
c_func
(paren
id|video.len
)paren
)paren
suffix:semicolon
multiline_comment|/* We do not have to set currcon to 0... register_framebuffer do it for us on first console&n; * and we do not want currcon == 0 for subsequent framebuffers */
r_if
c_cond
(paren
id|register_framebuffer
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
)paren
OL
l_int|0
)paren
(brace
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;fb%d: %s frame buffer device&bslash;n&quot;
comma
id|GET_FB_IDX
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.node
)paren
)paren
comma
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.modename
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|currcon
)paren
OL
l_int|0
)paren
(brace
multiline_comment|/* there is no console on this fb... but we have to initialize hardware &n;&t;&t; * until someone tells me what is proper thing to do */
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;fb%d: initializing hardware&bslash;n&quot;
comma
id|GET_FB_IDX
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.node
)paren
)paren
)paren
suffix:semicolon
id|matroxfb_set_var
c_func
(paren
op_amp
id|vesafb_defined
comma
op_minus
l_int|1
comma
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
)def_block
DECL|variable|fb_list
r_static
r_struct
id|matrox_fb_info
op_star
id|fb_list
op_assign
l_int|NULL
suffix:semicolon
DECL|function|matrox_init
r_static
r_int
id|__init
(def_block
id|matrox_init
c_func
(paren
r_void
)paren
(brace
r_struct
id|pci_dev
op_star
id|pdev
op_assign
l_int|NULL
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;matrox_init&quot;
)paren
r_if
c_cond
(paren
id|disabled
)paren
r_return
op_minus
id|ENXIO
suffix:semicolon
r_while
c_loop
(paren
(paren
id|pdev
op_assign
id|pci_find_device
c_func
(paren
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
id|pdev
)paren
)paren
)paren
(brace
r_struct
id|board
op_star
id|b
suffix:semicolon
id|u_int8_t
id|rev
suffix:semicolon
id|u_int16_t
id|svid
suffix:semicolon
id|u_int16_t
id|sid
suffix:semicolon
id|pci_read_config_byte
c_func
(paren
id|pdev
comma
id|PCI_REVISION_ID
comma
op_amp
id|rev
)paren
suffix:semicolon
id|svid
op_assign
id|dev-&gt;subsystem_vendor
suffix:semicolon
id|sid
op_assign
id|dev-&gt;subsystem_device
suffix:semicolon
r_for
c_loop
(paren
id|b
op_assign
id|dev_list
suffix:semicolon
id|b-&gt;vendor
suffix:semicolon
id|b
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|b-&gt;vendor
op_ne
id|pdev-&gt;vendor
)paren
op_logical_or
(paren
id|b-&gt;device
op_ne
id|pdev-&gt;device
)paren
op_logical_or
(paren
id|b-&gt;rev
OL
id|rev
)paren
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|b-&gt;svid
)paren
r_if
c_cond
(paren
(paren
id|b-&gt;svid
op_ne
id|svid
)paren
op_logical_or
(paren
id|b-&gt;sid
op_ne
id|sid
)paren
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|dev
op_le
l_int|0
)paren
(brace
r_struct
id|matrox_fb_info
op_star
id|minfo
suffix:semicolon
r_struct
id|display
op_star
id|d
suffix:semicolon
r_int
id|err
suffix:semicolon
macro_line|#ifdef CONFIG_FB_MATROX_MULTIHEAD
id|minfo
op_assign
(paren
r_struct
id|matrox_fb_info
op_star
)paren
id|kmalloc
c_func
(paren
r_sizeof
(paren
op_star
id|minfo
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|minfo
)paren
(brace
id|d
op_assign
(paren
r_struct
id|display
op_star
)paren
id|kmalloc
c_func
(paren
r_sizeof
(paren
op_star
id|d
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|d
)paren
(brace
macro_line|#else
id|minfo
op_assign
op_amp
id|global_mxinfo
suffix:semicolon
id|d
op_assign
op_amp
id|global_disp
suffix:semicolon
macro_line|#endif
id|memset
c_func
(paren
id|MINFO
comma
l_int|0
comma
r_sizeof
(paren
op_star
id|MINFO
)paren
)paren
suffix:semicolon
id|memset
c_func
(paren
id|d
comma
l_int|0
comma
r_sizeof
(paren
op_star
id|d
)paren
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|currenthw
)paren
op_assign
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|hw1
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|newhw
)paren
op_assign
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|hw2
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
op_assign
id|pdev
suffix:semicolon
multiline_comment|/* CMDLINE */
id|memcpy
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.fontname
)paren
comma
id|fontname
comma
r_sizeof
(paren
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.fontname
)paren
)paren
)paren
suffix:semicolon
multiline_comment|/* DEVFLAGS */
id|ACCESS_FBINFO
c_func
(paren
id|devflags.inverse
)paren
op_assign
id|inverse
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.novga
)paren
op_assign
id|novga
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.nobios
)paren
op_assign
id|nobios
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.noinit
)paren
op_assign
id|noinit
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.nopciretry
)paren
op_assign
id|no_pci_retry
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.mga_24bpp_fix
)paren
op_assign
id|inv24
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.precise_width
)paren
op_assign
id|option_precise_width
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.hwcursor
)paren
op_assign
id|hwcursor
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.blink
)paren
op_assign
id|blink
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.sgram
)paren
op_assign
id|sgram
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|capable.cross4MB
)paren
op_assign
id|cross4MB
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fastfont.size
)paren
op_assign
id|fastfont
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|cursor.state
)paren
op_assign
id|CM_ERASE
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|cursor.timer.prev
)paren
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|cursor.timer.next
)paren
op_assign
l_int|NULL
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|cursor.timer.data
)paren
op_assign
(paren
r_int
r_int
)paren
id|MINFO
suffix:semicolon
id|spin_lock_init
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|lock.DAC
)paren
)paren
suffix:semicolon
id|err
op_assign
id|initMatrox2
c_func
(paren
id|PMINFO
id|d
comma
id|b
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|err
)paren
(brace
id|ACCESS_FBINFO
c_func
(paren
id|next_fb
)paren
op_assign
id|fb_list
suffix:semicolon
id|fb_list
op_assign
id|MINFO
suffix:semicolon
macro_line|#ifdef CONFIG_FB_MATROX_MULTIHEAD
r_goto
id|leave
suffix:semicolon
macro_line|#else
r_return
l_int|0
suffix:semicolon
macro_line|#endif
)brace
macro_line|#ifdef CONFIG_FB_MATROX_MULTIHEAD
id|kfree
c_func
(paren
id|d
)paren
suffix:semicolon
)brace
id|kfree
c_func
(paren
id|minfo
)paren
suffix:semicolon
)brace
macro_line|#endif
)brace
macro_line|#ifdef CONFIG_FB_MATROX_MULTIHEAD
id|leave
suffix:colon
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
id|dev
op_eq
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|dev
OG
l_int|0
)paren
id|dev
op_decrement
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
)def_block
macro_line|#ifndef MODULE
DECL|variable|initialized
r_static
r_int
id|__init
id|initialized
op_assign
l_int|0
suffix:semicolon
DECL|function|matroxfb_init
r_int
id|__init
id|matroxfb_init
c_func
(paren
r_void
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;matroxfb_init&quot;
)paren
r_if
c_cond
(paren
op_logical_neg
id|initialized
)paren
(brace
id|initialized
op_assign
l_int|1
suffix:semicolon
id|matrox_init
c_func
(paren
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|fb_list
)paren
r_return
op_minus
id|ENXIO
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#if defined(CONFIG_FB_OF)
DECL|function|matrox_of_init
r_int
id|__init
(def_block
id|matrox_of_init
c_func
(paren
r_struct
id|device_node
op_star
id|dp
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;matrox_of_init&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|initialized
)paren
(brace
id|initialized
op_assign
l_int|1
suffix:semicolon
id|matrox_init
c_func
(paren
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|fb_list
)paren
r_return
op_minus
id|ENXIO
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
)def_block
macro_line|#endif&t;/* CONFIG_FB_OF */
macro_line|#else
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;(c) 1998,1999 Petr Vandrovec &lt;vandrove@vc.cvut.cz&gt;&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;Accelerated FBDev driver for Matrox Millennium/Mystique/G100/G200/G400&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|mem
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|mem
comma
l_string|&quot;Size of available memory in MB, KB or B (2,4,8,12,16MB, default=autodetect)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|disabled
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|disabled
comma
l_string|&quot;Disabled (0 or 1=disabled), meaningless for module (default=0)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|noaccel
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|noaccel
comma
l_string|&quot;Do not use accelerating engine (0 or 1=disabled) (default=0)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|nopan
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|nopan
comma
l_string|&quot;Disable pan on startup (0 or 1=disabled) (default=0)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|no_pci_retry
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|no_pci_retry
comma
l_string|&quot;PCI retries enabled (0 or 1=disabled) (default=0)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|novga
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|novga
comma
l_string|&quot;VGA I/O (0x3C0-0x3DF) disabled (0 or 1=disabled) (default=0)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|nobios
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|nobios
comma
l_string|&quot;Disables ROM BIOS (0 or 1=disabled) (default=do not change BIOS state)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|noinit
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|noinit
comma
l_string|&quot;Disables W/SG/SD-RAM and bus interface initialization (0 or 1=do not initialize) (default=0)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|mtrr
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|mtrr
comma
l_string|&quot;This speeds up video memory accesses (0=disabled or 1) (default=1)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|sgram
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|sgram
comma
l_string|&quot;Indicates that G200/G400 has SGRAM memory (0=SDRAM, 1=SGRAM) (default=0)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|inv24
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|inv24
comma
l_string|&quot;Inverts clock polarity for 24bpp and loop frequency &gt; 100MHz (default=do not invert polarity)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|inverse
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|inverse
comma
l_string|&quot;Inverse (0 or 1) (default=0)&quot;
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_FB_MATROX_MULTIHEAD
id|MODULE_PARM
c_func
(paren
id|dev
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|dev
comma
l_string|&quot;Multihead support, attach to device ID (0..N) (default=all working)&quot;
)paren
suffix:semicolon
macro_line|#else
id|MODULE_PARM
c_func
(paren
id|dev
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|dev
comma
l_string|&quot;Multihead support, attach to device ID (0..N) (default=first working)&quot;
)paren
suffix:semicolon
macro_line|#endif
id|MODULE_PARM
c_func
(paren
id|vesa
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|vesa
comma
l_string|&quot;Startup videomode (0x000-0x1FF) (default=0x101)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|xres
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|xres
comma
l_string|&quot;Horizontal resolutioni (px), overrides xres from vesa (default=vesa)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|yres
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|yres
comma
l_string|&quot;Vertical resolution (scans), overrides yres from vesa (default=vesa)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|upper
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|upper
comma
l_string|&quot;Upper blank space (scans), overrides upper from vesa (default=vesa)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|lower
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|lower
comma
l_string|&quot;Lower blank space (scans), overrides lower from vesa (default=vesa)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|vslen
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|vslen
comma
l_string|&quot;Vertical sync length (scans), overrides lower from vesa (default=vesa)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|left
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|left
comma
l_string|&quot;Left blank space (px), overrides left from vesa (default=vesa)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|right
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|right
comma
l_string|&quot;Right blank space (px), overrides right from vesa (default=vesa)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|hslen
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|hslen
comma
l_string|&quot;Horizontal sync length (px), overrides hslen from vesa (default=vesa)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|pixclock
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|pixclock
comma
l_string|&quot;Pixelclock (ns), overrides pixclock from vesa (default=vesa)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|sync
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|sync
comma
l_string|&quot;Sync polarity, overrides sync from vesa (default=vesa)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|depth
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|depth
comma
l_string|&quot;Color depth (0=text,8,15,16,24,32) (default=vesa)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|maxclk
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|maxclk
comma
l_string|&quot;Startup maximal clock, 0-999MHz, 1000-999999kHz, 1000000-INF Hz&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|fh
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|fh
comma
l_string|&quot;Startup horizontal frequency, 0-999kHz, 1000-INF Hz&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|fv
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|fv
comma
l_string|&quot;Startup vertical frequency, 0-INF Hz&bslash;n&quot;
l_string|&quot;You should specify &bslash;&quot;fv:max_monitor_vsync,fh:max_monitor_hsync,maxclk:max_monitor_dotclock&bslash;&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|hwcursor
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|hwcursor
comma
l_string|&quot;Enables hardware cursor (0 or 1) (default=0)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|blink
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|blink
comma
l_string|&quot;Enables hardware cursor blinking (0 or 1) (default=1)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|fastfont
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|fastfont
comma
l_string|&quot;Specifies, how much memory should be used for font data (0, 1024-65536 are reasonable) (default=0)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|grayscale
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|grayscale
comma
l_string|&quot;Sets display into grayscale. Works perfectly with paletized videomode (4, 8bpp), some limitations apply to 16, 24 and 32bpp videomodes (default=nograyscale)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|cross4MB
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|cross4MB
comma
l_string|&quot;Specifies that 4MB boundary can be in middle of line. (default=autodetected)&quot;
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_FB_OF
id|MODULE_PARM
c_func
(paren
id|vmode
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|vmode
comma
l_string|&quot;Specify the vmode mode number that should be used (640x480 default)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|cmode
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|cmode
comma
l_string|&quot;Specify the video depth that should be used (8bit default)&quot;
)paren
suffix:semicolon
macro_line|#endif
DECL|function|init_module
r_int
id|__init
(def_block
id|init_module
c_func
(paren
r_void
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;init_module&quot;
)paren
macro_line|#ifdef DEBUG
r_if
c_cond
(paren
id|disabled
)paren
(brace
r_return
op_minus
id|ENXIO
suffix:semicolon
)brace
macro_line|#endif /* DEBUG */
r_if
c_cond
(paren
id|depth
op_eq
l_int|0
)paren
id|depth
op_assign
id|RSText
suffix:semicolon
r_else
r_if
c_cond
(paren
id|depth
op_eq
l_int|4
)paren
id|depth
op_assign
id|RS4bpp
suffix:semicolon
r_else
r_if
c_cond
(paren
id|depth
op_eq
l_int|8
)paren
id|depth
op_assign
id|RS8bpp
suffix:semicolon
r_else
r_if
c_cond
(paren
id|depth
op_eq
l_int|15
)paren
id|depth
op_assign
id|RS15bpp
suffix:semicolon
r_else
r_if
c_cond
(paren
id|depth
op_eq
l_int|16
)paren
id|depth
op_assign
id|RS16bpp
suffix:semicolon
r_else
r_if
c_cond
(paren
id|depth
op_eq
l_int|24
)paren
id|depth
op_assign
id|RS24bpp
suffix:semicolon
r_else
r_if
c_cond
(paren
id|depth
op_eq
l_int|32
)paren
id|depth
op_assign
id|RS32bpp
suffix:semicolon
r_else
r_if
c_cond
(paren
id|depth
op_ne
op_minus
l_int|1
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: depth %d is not supported, using default&bslash;n&quot;
comma
id|depth
)paren
suffix:semicolon
id|depth
op_assign
op_minus
l_int|1
suffix:semicolon
)brace
id|matrox_init
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|fb_list
)paren
r_return
op_minus
id|ENXIO
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
)def_block
DECL|function|cleanup_module
r_void
id|cleanup_module
c_func
(paren
r_void
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;cleanup_module&quot;
)paren
macro_line|#ifdef DEBUG
r_if
c_cond
(paren
id|disabled
)paren
(brace
r_return
suffix:semicolon
)brace
macro_line|#endif /* DEBUG */
r_while
c_loop
(paren
id|fb_list
)paren
(brace
r_struct
id|matrox_fb_info
op_star
id|minfo
suffix:semicolon
id|minfo
op_assign
id|fb_list
suffix:semicolon
id|fb_list
op_assign
id|fb_list-&gt;next_fb
suffix:semicolon
id|unregister_framebuffer
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
)paren
suffix:semicolon
id|del_timer
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|cursor.timer
)paren
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_MTRR
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|mtrr.vram_valid
)paren
)paren
id|mtrr_del
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|mtrr.vram
)paren
comma
id|ACCESS_FBINFO
c_func
(paren
id|video.base
)paren
comma
id|ACCESS_FBINFO
c_func
(paren
id|video.len
)paren
)paren
suffix:semicolon
macro_line|#endif
id|mga_iounmap
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|mmio.vbase
)paren
)paren
suffix:semicolon
id|mga_iounmap
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_FB_MATROX_MULTIHEAD
id|kfree_s
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.disp
)paren
comma
r_sizeof
(paren
r_struct
id|display
)paren
)paren
suffix:semicolon
id|kfree_s
c_func
(paren
id|minfo
comma
r_sizeof
(paren
r_struct
id|matrox_fb_info
)paren
)paren
suffix:semicolon
macro_line|#endif
)brace
)brace
macro_line|#endif&t;/* MODULE */
multiline_comment|/*&n; * Overrides for Emacs so that we follow Linus&squot;s tabbing style.&n; * ---------------------------------------------------------------------------&n; * Local variables:&n; * c-basic-offset: 8&n; * End:&n; */
eof
