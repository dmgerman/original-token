multiline_comment|/* Recently Update by v1.09.50 */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &quot;sis_300.h&quot;
macro_line|#if defined(ALLOC_PRAGMA)
macro_line|#pragma alloc_text(PAGE,SiSSetMode)
macro_line|#pragma alloc_text(PAGE,SiSInit300)
macro_line|#endif
macro_line|#ifdef NOBIOS
DECL|function|SiSInit300
id|BOOLEAN
id|SiSInit300
c_func
(paren
id|PHW_DEVICE_EXTENSION
id|HwDeviceExtension
)paren
(brace
id|ULONG
id|ROMAddr
op_assign
(paren
id|ULONG
)paren
id|HwDeviceExtension-&gt;VirtualRomBase
suffix:semicolon
id|ULONG
id|FBAddr
op_assign
(paren
id|ULONG
)paren
id|HwDeviceExtension-&gt;VirtualVideoMemoryAddress
suffix:semicolon
id|USHORT
id|BaseAddr
op_assign
(paren
id|USHORT
)paren
id|HwDeviceExtension-&gt;IOAddress
suffix:semicolon
id|UCHAR
id|i
comma
id|temp
comma
id|AGP
suffix:semicolon
id|ULONG
id|j
comma
id|k
comma
id|ulTemp
suffix:semicolon
id|UCHAR
id|SR07
comma
id|SR11
comma
id|SR19
comma
id|SR1A
comma
id|SR1F
comma
id|SR21
comma
id|SR22
comma
id|SR23
comma
id|SR24
comma
id|SR25
comma
id|SR32
suffix:semicolon
id|UCHAR
id|SR14
suffix:semicolon
id|ULONG
id|Temp
suffix:semicolon
r_if
c_cond
(paren
id|ROMAddr
op_eq
l_int|0
)paren
(brace
r_return
(paren
id|FALSE
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|FBAddr
op_eq
l_int|0
)paren
(brace
r_return
(paren
id|FALSE
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|BaseAddr
op_eq
l_int|0
)paren
(brace
r_return
(paren
id|FALSE
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipID
op_ge
id|SIS_Trojan
)paren
r_if
c_cond
(paren
op_logical_neg
id|HwDeviceExtension-&gt;bIntegratedMMEnabled
)paren
(brace
r_return
(paren
id|FALSE
)paren
suffix:semicolon
)brace
id|P3c4
op_assign
id|BaseAddr
op_plus
l_int|0x14
suffix:semicolon
id|P3d4
op_assign
id|BaseAddr
op_plus
l_int|0x24
suffix:semicolon
id|P3c0
op_assign
id|BaseAddr
op_plus
l_int|0x10
suffix:semicolon
id|P3ce
op_assign
id|BaseAddr
op_plus
l_int|0x1e
suffix:semicolon
id|P3c2
op_assign
id|BaseAddr
op_plus
l_int|0x12
suffix:semicolon
id|P3ca
op_assign
id|BaseAddr
op_plus
l_int|0x1a
suffix:semicolon
id|P3c6
op_assign
id|BaseAddr
op_plus
l_int|0x16
suffix:semicolon
id|P3c7
op_assign
id|BaseAddr
op_plus
l_int|0x17
suffix:semicolon
id|P3c8
op_assign
id|BaseAddr
op_plus
l_int|0x18
suffix:semicolon
id|P3c9
op_assign
id|BaseAddr
op_plus
l_int|0x19
suffix:semicolon
id|P3da
op_assign
id|BaseAddr
op_plus
l_int|0x2A
suffix:semicolon
id|Set_LVDS_TRUMPION
c_func
(paren
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x05
comma
l_int|0x86
)paren
suffix:semicolon
singleline_comment|// 1.Openkey
id|SR14
op_assign
(paren
id|UCHAR
)paren
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x14
)paren
suffix:semicolon
id|SR19
op_assign
(paren
id|UCHAR
)paren
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x19
)paren
suffix:semicolon
id|SR1A
op_assign
(paren
id|UCHAR
)paren
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x1A
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0x06
suffix:semicolon
id|i
OL
l_int|0x20
suffix:semicolon
id|i
op_increment
)paren
(brace
id|SetReg1
c_func
(paren
id|P3c4
comma
id|i
comma
l_int|0
)paren
suffix:semicolon
)brace
singleline_comment|// 2.Reset Extended register
r_for
c_loop
(paren
id|i
op_assign
l_int|0x21
suffix:semicolon
id|i
op_le
l_int|0x27
suffix:semicolon
id|i
op_increment
)paren
(brace
id|SetReg1
c_func
(paren
id|P3c4
comma
id|i
comma
l_int|0
)paren
suffix:semicolon
)brace
singleline_comment|//&t;Reset Extended register
r_for
c_loop
(paren
id|i
op_assign
l_int|0x31
suffix:semicolon
id|i
op_le
l_int|0x3D
suffix:semicolon
id|i
op_increment
)paren
(brace
id|SetReg1
c_func
(paren
id|P3c4
comma
id|i
comma
l_int|0
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x30
suffix:semicolon
id|i
op_le
l_int|0x37
suffix:semicolon
id|i
op_increment
)paren
(brace
id|SetReg1
c_func
(paren
id|P3d4
comma
id|i
comma
l_int|0
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipID
op_ge
id|SIS_Trojan
)paren
(brace
id|temp
op_assign
(paren
id|UCHAR
)paren
id|SR1A
suffix:semicolon
)brace
singleline_comment|// 3.Set Define Extended register
r_else
(brace
id|temp
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
id|SoftSettingAddr
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|temp
op_amp
id|SoftDRAMType
)paren
op_eq
l_int|0
)paren
(brace
id|temp
op_assign
(paren
id|UCHAR
)paren
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x3A
)paren
suffix:semicolon
singleline_comment|// 3.Set Define Extended register
)brace
)brace
id|RAMType
op_assign
id|temp
op_amp
l_int|0x07
suffix:semicolon
id|SetMemoryClock
c_func
(paren
id|ROMAddr
)paren
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
OL
l_int|5
suffix:semicolon
id|k
op_increment
)paren
(brace
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
l_int|0xffff
suffix:semicolon
id|j
op_increment
)paren
(brace
id|ulTemp
op_assign
(paren
id|ULONG
)paren
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x05
)paren
suffix:semicolon
)brace
)brace
id|Temp
op_assign
(paren
id|ULONG
)paren
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x3C
)paren
suffix:semicolon
id|Temp
op_assign
id|Temp
op_or
l_int|0x01
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x3C
comma
(paren
id|USHORT
)paren
id|Temp
)paren
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
OL
l_int|5
suffix:semicolon
id|k
op_increment
)paren
(brace
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
l_int|0xffff
suffix:semicolon
id|j
op_increment
)paren
(brace
id|Temp
op_assign
(paren
id|ULONG
)paren
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x05
)paren
suffix:semicolon
)brace
)brace
id|Temp
op_assign
(paren
id|ULONG
)paren
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x3C
)paren
suffix:semicolon
id|Temp
op_assign
id|Temp
op_amp
l_int|0xFE
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x3C
comma
(paren
id|USHORT
)paren
id|Temp
)paren
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
OL
l_int|5
suffix:semicolon
id|k
op_increment
)paren
(brace
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
l_int|0xffff
suffix:semicolon
id|j
op_increment
)paren
(brace
id|Temp
op_assign
(paren
id|ULONG
)paren
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x05
)paren
suffix:semicolon
)brace
)brace
id|SR07
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
l_int|0xA4
)paren
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x07
comma
id|SR07
)paren
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipID
op_eq
id|SIS_Glamour
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x15
suffix:semicolon
id|i
op_le
l_int|0x1C
suffix:semicolon
id|i
op_increment
)paren
(brace
id|temp
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
l_int|0xA5
op_plus
(paren
(paren
id|i
op_minus
l_int|0x15
)paren
op_star
l_int|8
)paren
op_plus
id|RAMType
)paren
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
id|i
comma
id|temp
)paren
suffix:semicolon
)brace
)brace
id|SR1F
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
l_int|0xE5
)paren
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x1F
comma
id|SR1F
)paren
suffix:semicolon
id|AGP
op_assign
l_int|1
suffix:semicolon
singleline_comment|// Get AGP
id|temp
op_assign
(paren
id|UCHAR
)paren
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x3A
)paren
suffix:semicolon
id|temp
op_assign
id|temp
op_amp
l_int|0x30
suffix:semicolon
r_if
c_cond
(paren
id|temp
op_eq
l_int|0x30
)paren
(brace
id|AGP
op_assign
l_int|0
suffix:semicolon
)brace
singleline_comment|// PCI
id|SR21
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
l_int|0xE6
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|AGP
op_eq
l_int|0
)paren
(brace
id|SR21
op_assign
id|SR21
op_amp
l_int|0xEF
suffix:semicolon
)brace
singleline_comment|// PCI
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x21
comma
id|SR21
)paren
suffix:semicolon
id|SR22
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
l_int|0xE7
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|AGP
op_eq
l_int|1
)paren
(brace
id|SR22
op_assign
id|SR22
op_amp
l_int|0x20
suffix:semicolon
)brace
singleline_comment|// AGP
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x22
comma
id|SR22
)paren
suffix:semicolon
id|SR23
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
l_int|0xE8
)paren
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x23
comma
id|SR23
)paren
suffix:semicolon
id|SR24
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
l_int|0xE9
)paren
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x24
comma
id|SR24
)paren
suffix:semicolon
id|SR25
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
l_int|0xEA
)paren
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x25
comma
id|SR25
)paren
suffix:semicolon
id|SR32
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
l_int|0xEB
)paren
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x32
comma
id|SR32
)paren
suffix:semicolon
id|SR11
op_assign
l_int|0x0F
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x11
comma
id|SR11
)paren
suffix:semicolon
r_if
c_cond
(paren
id|IF_DEF_LVDS
op_eq
l_int|1
)paren
(brace
singleline_comment|//LVDS
id|temp
op_assign
id|ExtChipLVDS
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|IF_DEF_TRUMPION
op_eq
l_int|1
)paren
(brace
singleline_comment|//Trumpion
id|temp
op_assign
id|ExtChipTrumpion
suffix:semicolon
)brace
r_else
(brace
singleline_comment|//301
id|temp
op_assign
id|ExtChip301
suffix:semicolon
)brace
id|SetReg1
c_func
(paren
id|P3d4
comma
l_int|0x37
comma
id|temp
)paren
suffix:semicolon
singleline_comment|//For SiS 630/540 Chip
singleline_comment|//Restore SR14, SR19 and SR1A
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x14
comma
id|SR14
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x19
comma
id|SR19
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x1A
comma
id|SR1A
)paren
suffix:semicolon
id|SetReg3
c_func
(paren
id|P3c6
comma
l_int|0xff
)paren
suffix:semicolon
singleline_comment|// Reset register
id|ClearDAC
c_func
(paren
id|P3c8
)paren
suffix:semicolon
singleline_comment|// Reset register
id|DetectMonitor
c_func
(paren
id|HwDeviceExtension
)paren
suffix:semicolon
singleline_comment|//sense CRT1
id|GetSenseStatus
c_func
(paren
id|HwDeviceExtension
comma
id|BaseAddr
comma
id|ROMAddr
)paren
suffix:semicolon
singleline_comment|//sense CRT2&t;&t;
r_return
id|TRUE
suffix:semicolon
)brace
DECL|function|Set_LVDS_TRUMPION
id|VOID
id|Set_LVDS_TRUMPION
c_func
(paren
id|VOID
)paren
(brace
id|IF_DEF_LVDS
op_assign
l_int|0
suffix:semicolon
id|IF_DEF_TRUMPION
op_assign
l_int|0
suffix:semicolon
)brace
DECL|function|SetMemoryClock
id|VOID
id|SetMemoryClock
c_func
(paren
id|ULONG
id|ROMAddr
)paren
(brace
id|UCHAR
id|data
comma
id|i
suffix:semicolon
id|MCLKData
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
l_int|0x20C
)paren
)paren
suffix:semicolon
singleline_comment|// MCLKData Table
id|MCLKData
op_assign
id|MCLKData
op_plus
id|RAMType
op_star
l_int|5
suffix:semicolon
id|ECLKData
op_assign
id|MCLKData
op_plus
l_int|0x28
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0x28
suffix:semicolon
id|i
op_le
l_int|0x2A
suffix:semicolon
id|i
op_increment
)paren
(brace
singleline_comment|// Set MCLK
id|data
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
id|MCLKData
)paren
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
id|i
comma
id|data
)paren
suffix:semicolon
id|MCLKData
op_increment
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x2E
suffix:semicolon
id|i
op_le
l_int|0x30
suffix:semicolon
id|i
op_increment
)paren
(brace
singleline_comment|// Set ECLK
id|data
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
id|ECLKData
)paren
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
id|i
comma
id|data
)paren
suffix:semicolon
id|ECLKData
op_increment
suffix:semicolon
)brace
)brace
macro_line|#endif   /* NOBIOS */
macro_line|#ifdef CONFIG_FB_SIS_LINUXBIOS
DECL|function|SiSInit300
id|BOOLEAN
id|SiSInit300
c_func
(paren
id|PHW_DEVICE_EXTENSION
id|HwDeviceExtension
)paren
(brace
id|ULONG
id|ROMAddr
op_assign
l_int|0
suffix:semicolon
id|USHORT
id|BaseAddr
op_assign
(paren
id|USHORT
)paren
id|HwDeviceExtension-&gt;IOAddress
suffix:semicolon
id|UCHAR
id|i
comma
id|temp
comma
id|AGP
suffix:semicolon
id|ULONG
id|j
comma
id|k
comma
id|ulTemp
suffix:semicolon
id|UCHAR
id|SR07
comma
id|SR11
comma
id|SR19
comma
id|SR1A
comma
id|SR1F
comma
id|SR21
comma
id|SR22
comma
id|SR23
comma
id|SR24
comma
id|SR25
comma
id|SR32
suffix:semicolon
id|UCHAR
id|SR14
suffix:semicolon
id|ULONG
id|Temp
suffix:semicolon
r_if
c_cond
(paren
id|BaseAddr
op_eq
l_int|0
)paren
(brace
r_return
(paren
id|FALSE
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipID
op_ge
id|SIS_Trojan
)paren
r_if
c_cond
(paren
op_logical_neg
id|HwDeviceExtension-&gt;bIntegratedMMEnabled
)paren
(brace
r_return
(paren
id|FALSE
)paren
suffix:semicolon
)brace
id|P3c4
op_assign
id|BaseAddr
op_plus
l_int|0x14
suffix:semicolon
id|P3d4
op_assign
id|BaseAddr
op_plus
l_int|0x24
suffix:semicolon
id|P3c0
op_assign
id|BaseAddr
op_plus
l_int|0x10
suffix:semicolon
id|P3ce
op_assign
id|BaseAddr
op_plus
l_int|0x1e
suffix:semicolon
id|P3c2
op_assign
id|BaseAddr
op_plus
l_int|0x12
suffix:semicolon
id|P3ca
op_assign
id|BaseAddr
op_plus
l_int|0x1a
suffix:semicolon
id|P3c6
op_assign
id|BaseAddr
op_plus
l_int|0x16
suffix:semicolon
id|P3c7
op_assign
id|BaseAddr
op_plus
l_int|0x17
suffix:semicolon
id|P3c8
op_assign
id|BaseAddr
op_plus
l_int|0x18
suffix:semicolon
id|P3c9
op_assign
id|BaseAddr
op_plus
l_int|0x19
suffix:semicolon
id|P3da
op_assign
id|BaseAddr
op_plus
l_int|0x2A
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x05
comma
l_int|0x86
)paren
suffix:semicolon
singleline_comment|// 1.Openkey
id|SR14
op_assign
(paren
id|UCHAR
)paren
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x14
)paren
suffix:semicolon
id|SR19
op_assign
(paren
id|UCHAR
)paren
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x19
)paren
suffix:semicolon
id|SR1A
op_assign
(paren
id|UCHAR
)paren
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x1A
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0x06
suffix:semicolon
id|i
OL
l_int|0x20
suffix:semicolon
id|i
op_increment
)paren
(brace
id|SetReg1
c_func
(paren
id|P3c4
comma
id|i
comma
l_int|0
)paren
suffix:semicolon
)brace
singleline_comment|// 2.Reset Extended register
r_for
c_loop
(paren
id|i
op_assign
l_int|0x21
suffix:semicolon
id|i
op_le
l_int|0x27
suffix:semicolon
id|i
op_increment
)paren
(brace
id|SetReg1
c_func
(paren
id|P3c4
comma
id|i
comma
l_int|0
)paren
suffix:semicolon
)brace
singleline_comment|//&t;Reset Extended register
r_for
c_loop
(paren
id|i
op_assign
l_int|0x31
suffix:semicolon
id|i
op_le
l_int|0x3D
suffix:semicolon
id|i
op_increment
)paren
(brace
id|SetReg1
c_func
(paren
id|P3c4
comma
id|i
comma
l_int|0
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x30
suffix:semicolon
id|i
op_le
l_int|0x37
suffix:semicolon
id|i
op_increment
)paren
(brace
id|SetReg1
c_func
(paren
id|P3d4
comma
id|i
comma
l_int|0
)paren
suffix:semicolon
)brace
id|temp
op_assign
(paren
id|UCHAR
)paren
id|SR1A
suffix:semicolon
singleline_comment|// 3.Set Define Extended register
id|RAMType
op_assign
id|temp
op_amp
l_int|0x07
suffix:semicolon
id|SetMemoryClock
c_func
(paren
id|ROMAddr
)paren
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
OL
l_int|5
suffix:semicolon
id|k
op_increment
)paren
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
l_int|0xffff
suffix:semicolon
id|j
op_increment
)paren
(brace
id|ulTemp
op_assign
(paren
id|ULONG
)paren
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x05
)paren
suffix:semicolon
)brace
id|Temp
op_assign
(paren
id|ULONG
)paren
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x3C
)paren
suffix:semicolon
id|Temp
op_assign
id|Temp
op_or
l_int|0x01
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x3C
comma
(paren
id|USHORT
)paren
id|Temp
)paren
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
OL
l_int|5
suffix:semicolon
id|k
op_increment
)paren
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
l_int|0xffff
suffix:semicolon
id|j
op_increment
)paren
(brace
id|Temp
op_assign
(paren
id|ULONG
)paren
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x05
)paren
suffix:semicolon
)brace
id|Temp
op_assign
(paren
id|ULONG
)paren
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x3C
)paren
suffix:semicolon
id|Temp
op_assign
id|Temp
op_amp
l_int|0xFE
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x3C
comma
(paren
id|USHORT
)paren
id|Temp
)paren
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
OL
l_int|5
suffix:semicolon
id|k
op_increment
)paren
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
l_int|0xffff
suffix:semicolon
id|j
op_increment
)paren
(brace
id|Temp
op_assign
(paren
id|ULONG
)paren
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x05
)paren
suffix:semicolon
)brace
id|SR07
op_assign
id|SRegsInit
(braket
l_int|0x07
)braket
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x07
comma
id|SR07
)paren
suffix:semicolon
id|SR1F
op_assign
id|SRegsInit
(braket
l_int|0x1F
)braket
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x1F
comma
id|SR1F
)paren
suffix:semicolon
id|AGP
op_assign
l_int|1
suffix:semicolon
singleline_comment|// Get AGP
id|temp
op_assign
(paren
id|UCHAR
)paren
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x3A
)paren
suffix:semicolon
id|temp
op_assign
id|temp
op_amp
l_int|0x30
suffix:semicolon
r_if
c_cond
(paren
id|temp
op_eq
l_int|0x30
)paren
(brace
id|AGP
op_assign
l_int|0
suffix:semicolon
)brace
singleline_comment|// PCI
id|SR21
op_assign
id|SRegsInit
(braket
l_int|0x21
)braket
suffix:semicolon
r_if
c_cond
(paren
id|AGP
op_eq
l_int|0
)paren
(brace
id|SR21
op_assign
id|SR21
op_amp
l_int|0xEF
suffix:semicolon
)brace
singleline_comment|// PCI
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x21
comma
id|SR21
)paren
suffix:semicolon
id|SR22
op_assign
id|SRegsInit
(braket
l_int|0x22
)braket
suffix:semicolon
r_if
c_cond
(paren
id|AGP
op_eq
l_int|1
)paren
(brace
id|SR22
op_assign
id|SR22
op_amp
l_int|0x20
suffix:semicolon
)brace
singleline_comment|// AGP
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x22
comma
id|SR22
)paren
suffix:semicolon
id|SR23
op_assign
id|SRegsInit
(braket
l_int|0x23
)braket
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x23
comma
id|SR23
)paren
suffix:semicolon
id|SR24
op_assign
id|SRegsInit
(braket
l_int|0x24
)braket
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x24
comma
id|SR24
)paren
suffix:semicolon
id|SR25
op_assign
id|SRegsInit
(braket
l_int|0x25
)braket
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x25
comma
id|SR25
)paren
suffix:semicolon
id|SR32
op_assign
id|SRegsInit
(braket
l_int|0x32
)braket
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x32
comma
id|SR32
)paren
suffix:semicolon
id|SR11
op_assign
l_int|0x0F
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x11
comma
id|SR11
)paren
suffix:semicolon
id|temp
op_assign
id|ExtChip301
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3d4
comma
l_int|0x37
comma
id|temp
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x14
comma
id|SR14
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x19
comma
id|SR19
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x1A
comma
id|SR1A
)paren
suffix:semicolon
id|SetReg3
c_func
(paren
id|P3c6
comma
l_int|0xff
)paren
suffix:semicolon
singleline_comment|// Reset register
id|ClearDAC
c_func
(paren
id|P3c8
)paren
suffix:semicolon
singleline_comment|// Reset register
id|DetectMonitor
c_func
(paren
id|HwDeviceExtension
)paren
suffix:semicolon
singleline_comment|//sense CRT1
r_return
id|TRUE
suffix:semicolon
)brace
DECL|function|SetMemoryClock
id|VOID
id|SetMemoryClock
c_func
(paren
id|ULONG
id|ROMAddr
)paren
(brace
id|UCHAR
id|i
suffix:semicolon
id|USHORT
id|idx
suffix:semicolon
id|u8
id|MCLK
(braket
)braket
op_assign
(brace
l_int|0x5A
comma
l_int|0x64
comma
l_int|0x80
comma
l_int|0x66
comma
l_int|0x00
comma
singleline_comment|// SDRAM
l_int|0xB3
comma
l_int|0x45
comma
l_int|0x80
comma
l_int|0x83
comma
l_int|0x00
comma
singleline_comment|// SGRAM
l_int|0x37
comma
l_int|0x61
comma
l_int|0x80
comma
l_int|0x00
comma
l_int|0x01
comma
singleline_comment|// ESDRAM
l_int|0x37
comma
l_int|0x22
comma
l_int|0x80
comma
l_int|0x33
comma
l_int|0x01
comma
l_int|0x37
comma
l_int|0x61
comma
l_int|0x80
comma
l_int|0x00
comma
l_int|0x01
comma
l_int|0x37
comma
l_int|0x61
comma
l_int|0x80
comma
l_int|0x00
comma
l_int|0x01
comma
l_int|0x37
comma
l_int|0x61
comma
l_int|0x80
comma
l_int|0x00
comma
l_int|0x01
comma
l_int|0x37
comma
l_int|0x61
comma
l_int|0x80
comma
l_int|0x00
comma
l_int|0x01
)brace
suffix:semicolon
id|u8
id|ECLK
(braket
)braket
op_assign
(brace
l_int|0x54
comma
l_int|0x43
comma
l_int|0x80
comma
l_int|0x00
comma
l_int|0x01
comma
l_int|0x53
comma
l_int|0x43
comma
l_int|0x80
comma
l_int|0x00
comma
l_int|0x01
comma
l_int|0x55
comma
l_int|0x43
comma
l_int|0x80
comma
l_int|0x00
comma
l_int|0x01
comma
l_int|0x52
comma
l_int|0x43
comma
l_int|0x80
comma
l_int|0x00
comma
l_int|0x01
comma
l_int|0x3f
comma
l_int|0x42
comma
l_int|0x80
comma
l_int|0x00
comma
l_int|0x01
comma
l_int|0x54
comma
l_int|0x43
comma
l_int|0x80
comma
l_int|0x00
comma
l_int|0x01
comma
l_int|0x54
comma
l_int|0x43
comma
l_int|0x80
comma
l_int|0x00
comma
l_int|0x01
comma
l_int|0x54
comma
l_int|0x43
comma
l_int|0x80
comma
l_int|0x00
comma
l_int|0x01
)brace
suffix:semicolon
id|idx
op_assign
id|RAMType
op_star
l_int|5
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0x28
suffix:semicolon
id|i
op_le
l_int|0x2A
suffix:semicolon
id|i
op_increment
)paren
(brace
singleline_comment|// Set MCLK
id|SetReg1
c_func
(paren
id|P3c4
comma
id|i
comma
id|MCLK
(braket
id|idx
)braket
)paren
suffix:semicolon
id|idx
op_increment
suffix:semicolon
)brace
id|idx
op_assign
id|RAMType
op_star
l_int|5
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0x2E
suffix:semicolon
id|i
op_le
l_int|0x30
suffix:semicolon
id|i
op_increment
)paren
(brace
singleline_comment|// Set ECLK
id|SetReg1
c_func
(paren
id|P3c4
comma
id|i
comma
id|ECLK
(braket
id|idx
)braket
)paren
suffix:semicolon
id|idx
op_increment
suffix:semicolon
)brace
)brace
macro_line|#endif   /* CONFIG_FB_SIS_LINUXBIOS */
singleline_comment|// =========================================
singleline_comment|// ======== SiS SetMode Function  ==========
singleline_comment|// =========================================
macro_line|#ifdef CONFIG_FB_SIS_LINUXBIOS
DECL|function|SiSSetMode
id|BOOLEAN
id|SiSSetMode
c_func
(paren
id|PHW_DEVICE_EXTENSION
id|HwDeviceExtension
comma
id|USHORT
id|ModeNo
)paren
(brace
id|ULONG
id|i
suffix:semicolon
id|USHORT
id|cr30flag
comma
id|cr31flag
suffix:semicolon
id|ULONG
id|ROMAddr
op_assign
(paren
id|ULONG
)paren
id|HwDeviceExtension-&gt;VirtualRomBase
suffix:semicolon
id|USHORT
id|BaseAddr
op_assign
(paren
id|USHORT
)paren
id|HwDeviceExtension-&gt;IOAddress
suffix:semicolon
id|P3c4
op_assign
id|BaseAddr
op_plus
l_int|0x14
suffix:semicolon
id|P3d4
op_assign
id|BaseAddr
op_plus
l_int|0x24
suffix:semicolon
id|P3c0
op_assign
id|BaseAddr
op_plus
l_int|0x10
suffix:semicolon
id|P3ce
op_assign
id|BaseAddr
op_plus
l_int|0x1e
suffix:semicolon
id|P3c2
op_assign
id|BaseAddr
op_plus
l_int|0x12
suffix:semicolon
id|P3ca
op_assign
id|BaseAddr
op_plus
l_int|0x1a
suffix:semicolon
id|P3c6
op_assign
id|BaseAddr
op_plus
l_int|0x16
suffix:semicolon
id|P3c7
op_assign
id|BaseAddr
op_plus
l_int|0x17
suffix:semicolon
id|P3c8
op_assign
id|BaseAddr
op_plus
l_int|0x18
suffix:semicolon
id|P3c9
op_assign
id|BaseAddr
op_plus
l_int|0x19
suffix:semicolon
id|P3da
op_assign
id|BaseAddr
op_plus
l_int|0x2A
suffix:semicolon
id|cr30flag
op_assign
(paren
id|UCHAR
)paren
id|GetReg1
c_func
(paren
id|P3d4
comma
l_int|0x30
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
id|cr30flag
op_amp
l_int|0x01
)paren
op_eq
l_int|1
)paren
op_logical_or
(paren
(paren
id|cr30flag
op_amp
l_int|0x02
)paren
op_eq
l_int|0
)paren
)paren
(brace
id|SetReg1
c_func
(paren
id|P3d4
comma
l_int|0x34
comma
id|ModeNo
)paren
suffix:semicolon
singleline_comment|//SetSeqRegs(ROMAddr);
(brace
id|UCHAR
id|SRdata
suffix:semicolon
id|SRdata
op_assign
id|SRegs
(braket
l_int|0x01
)braket
op_or
l_int|0x20
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x01
comma
id|SRdata
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|02
suffix:semicolon
id|i
op_le
l_int|04
suffix:semicolon
id|i
op_increment
)paren
id|SetReg1
c_func
(paren
id|P3c4
comma
id|i
comma
id|SRegs
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
singleline_comment|//SetMiscRegs(ROMAddr);
(brace
id|SetReg3
c_func
(paren
id|P3c2
comma
l_int|0x23
)paren
suffix:semicolon
)brace
singleline_comment|//SetCRTCRegs(ROMAddr);
(brace
id|UCHAR
id|CRTCdata
suffix:semicolon
id|CRTCdata
op_assign
(paren
id|UCHAR
)paren
id|GetReg1
c_func
(paren
id|P3d4
comma
l_int|0x11
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3d4
comma
l_int|0x11
comma
id|CRTCdata
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|0x18
suffix:semicolon
id|i
op_increment
)paren
id|SetReg1
c_func
(paren
id|P3d4
comma
id|i
comma
id|CRegs
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
singleline_comment|//SetATTRegs(ROMAddr);
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|0x13
suffix:semicolon
id|i
op_increment
)paren
(brace
id|GetReg2
c_func
(paren
id|P3da
)paren
suffix:semicolon
id|SetReg3
c_func
(paren
id|P3c0
comma
id|i
)paren
suffix:semicolon
id|SetReg3
c_func
(paren
id|P3c0
comma
id|ARegs
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
id|GetReg2
c_func
(paren
id|P3da
)paren
suffix:semicolon
id|SetReg3
c_func
(paren
id|P3c0
comma
l_int|0x14
)paren
suffix:semicolon
id|SetReg3
c_func
(paren
id|P3c0
comma
l_int|0x00
)paren
suffix:semicolon
id|GetReg2
c_func
(paren
id|P3da
)paren
suffix:semicolon
id|SetReg3
c_func
(paren
id|P3c0
comma
l_int|0x20
)paren
suffix:semicolon
)brace
singleline_comment|//SetGRCRegs(ROMAddr);
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|0x08
suffix:semicolon
id|i
op_increment
)paren
id|SetReg1
c_func
(paren
id|P3ce
comma
id|i
comma
id|GRegs
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
singleline_comment|//ClearExt1Regs();
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x0A
suffix:semicolon
id|i
op_le
l_int|0x0E
suffix:semicolon
id|i
op_increment
)paren
id|SetReg1
c_func
(paren
id|P3c4
comma
id|i
comma
l_int|0x00
)paren
suffix:semicolon
)brace
singleline_comment|//SetSync(ROMAddr);
(brace
id|SetReg3
c_func
(paren
id|P3c2
comma
id|MReg
)paren
suffix:semicolon
)brace
singleline_comment|//SetCRT1CRTC(ROMAddr);
(brace
id|UCHAR
id|data
suffix:semicolon
id|data
op_assign
(paren
id|UCHAR
)paren
id|GetReg1
c_func
(paren
id|P3d4
comma
l_int|0x11
)paren
suffix:semicolon
id|data
op_assign
id|data
op_amp
l_int|0x7F
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3d4
comma
l_int|0x11
comma
id|data
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|0x07
suffix:semicolon
id|i
op_increment
)paren
id|SetReg1
c_func
(paren
id|P3d4
comma
id|i
comma
id|CRegs
(braket
id|i
)braket
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0x10
suffix:semicolon
id|i
op_le
l_int|0x12
suffix:semicolon
id|i
op_increment
)paren
id|SetReg1
c_func
(paren
id|P3d4
comma
id|i
comma
id|CRegs
(braket
id|i
)braket
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0x15
suffix:semicolon
id|i
op_le
l_int|0x16
suffix:semicolon
id|i
op_increment
)paren
id|SetReg1
c_func
(paren
id|P3d4
comma
id|i
comma
id|CRegs
(braket
id|i
)braket
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0x0A
suffix:semicolon
id|i
op_le
l_int|0x0C
suffix:semicolon
id|i
op_increment
)paren
id|SetReg1
c_func
(paren
id|P3c4
comma
id|i
comma
id|SRegs
(braket
id|i
)braket
)paren
suffix:semicolon
id|data
op_assign
id|SRegs
(braket
l_int|0x0E
)braket
op_amp
l_int|0xE0
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x0E
comma
id|data
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3d4
comma
l_int|0x09
comma
id|CRegs
(braket
l_int|0x09
)braket
)paren
suffix:semicolon
)brace
singleline_comment|//SetCRT1Offset(ROMAddr);
(brace
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x0E
comma
id|SRegs
(braket
l_int|0x0E
)braket
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x10
comma
id|SRegs
(braket
l_int|0x10
)braket
)paren
suffix:semicolon
)brace
singleline_comment|//SetCRT1VCLK(HwDeviceExtension, ROMAddr);
(brace
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x31
comma
l_int|0
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0x2B
suffix:semicolon
id|i
op_le
l_int|0x2C
suffix:semicolon
id|i
op_increment
)paren
id|SetReg1
c_func
(paren
id|P3c4
comma
id|i
comma
id|SRegs
(braket
id|i
)braket
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x2D
comma
l_int|0x80
)paren
suffix:semicolon
)brace
singleline_comment|//SetVCLKState(HwDeviceExtension, ROMAddr, ModeNo);
(brace
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x32
comma
id|SRegs
(braket
l_int|0x32
)braket
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x07
comma
id|SRegs
(braket
l_int|0x07
)braket
)paren
suffix:semicolon
)brace
singleline_comment|//SetCRT1FIFO2(ROMAddr);
(brace
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x15
comma
id|SRegs
(braket
l_int|0x15
)braket
)paren
suffix:semicolon
id|SetReg4
c_func
(paren
l_int|0xcf8
comma
l_int|0x80000050
)paren
suffix:semicolon
id|SetReg4
c_func
(paren
l_int|0xcfc
comma
l_int|0xc5041e04
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x08
comma
id|SRegs
(braket
l_int|0x08
)braket
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x0F
comma
id|SRegs
(braket
l_int|0x0F
)braket
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x3b
comma
l_int|0x00
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x09
comma
id|SRegs
(braket
l_int|0x09
)braket
)paren
suffix:semicolon
)brace
singleline_comment|//SetCRT1ModeRegs(ROMAddr, ModeNo);
(brace
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x06
comma
id|SRegs
(braket
l_int|0x06
)braket
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x01
comma
id|SRegs
(braket
l_int|0x01
)braket
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x0F
comma
id|SRegs
(braket
l_int|0x0F
)braket
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x21
comma
id|SRegs
(braket
l_int|0x21
)braket
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipID
op_ge
id|SIS_Trojan
)paren
(brace
singleline_comment|//SetInterlace(ROMAddr,ModeNo);
id|SetReg1
c_func
(paren
id|P3d4
comma
l_int|0x19
comma
id|CRegs
(braket
l_int|0x19
)braket
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3d4
comma
l_int|0x1A
comma
id|CRegs
(braket
l_int|0x1A
)braket
)paren
suffix:semicolon
)brace
id|LoadDAC
c_func
(paren
id|ROMAddr
)paren
suffix:semicolon
id|ClearBuffer
c_func
(paren
id|HwDeviceExtension
)paren
suffix:semicolon
)brace
id|cr31flag
op_assign
(paren
id|UCHAR
)paren
id|GetReg1
c_func
(paren
id|P3d4
comma
l_int|0x31
)paren
suffix:semicolon
id|DisplayOn
c_func
(paren
)paren
suffix:semicolon
singleline_comment|// 16.DisplayOn
r_return
id|NO_ERROR
suffix:semicolon
)brace
DECL|function|LoadDAC
id|VOID
id|LoadDAC
c_func
(paren
id|ULONG
id|ROMAddr
)paren
(brace
id|USHORT
id|data
comma
id|data2
suffix:semicolon
id|USHORT
id|time
comma
id|i
comma
id|j
comma
id|k
suffix:semicolon
id|USHORT
id|m
comma
id|n
comma
id|o
suffix:semicolon
id|USHORT
id|si
comma
id|di
comma
id|bx
comma
id|dl
suffix:semicolon
id|USHORT
id|al
comma
id|ah
comma
id|dh
suffix:semicolon
id|USHORT
op_star
id|table
op_assign
id|VGA_DAC
suffix:semicolon
id|time
op_assign
l_int|256
suffix:semicolon
id|table
op_assign
id|VGA_DAC
suffix:semicolon
id|j
op_assign
l_int|16
suffix:semicolon
id|SetReg3
c_func
(paren
id|P3c6
comma
l_int|0xFF
)paren
suffix:semicolon
id|SetReg3
c_func
(paren
id|P3c8
comma
l_int|0x00
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|j
suffix:semicolon
id|i
op_increment
)paren
(brace
id|data
op_assign
id|table
(braket
id|i
)braket
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
OL
l_int|3
suffix:semicolon
id|k
op_increment
)paren
(brace
id|data2
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|data
op_amp
l_int|0x01
)paren
(brace
id|data2
op_assign
l_int|0x2A
suffix:semicolon
)brace
r_if
c_cond
(paren
id|data
op_amp
l_int|0x02
)paren
(brace
id|data2
op_assign
id|data2
op_plus
l_int|0x15
suffix:semicolon
)brace
id|SetReg3
c_func
(paren
id|P3c9
comma
id|data2
)paren
suffix:semicolon
id|data
op_assign
id|data
op_rshift
l_int|2
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|time
op_eq
l_int|256
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|16
suffix:semicolon
id|i
OL
l_int|32
suffix:semicolon
id|i
op_increment
)paren
(brace
id|data
op_assign
id|table
(braket
id|i
)braket
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
OL
l_int|3
suffix:semicolon
id|k
op_increment
)paren
(brace
id|SetReg3
c_func
(paren
id|P3c9
comma
id|data
)paren
suffix:semicolon
)brace
)brace
id|si
op_assign
l_int|32
suffix:semicolon
r_for
c_loop
(paren
id|m
op_assign
l_int|0
suffix:semicolon
id|m
OL
l_int|9
suffix:semicolon
id|m
op_increment
)paren
(brace
id|di
op_assign
id|si
suffix:semicolon
id|bx
op_assign
id|si
op_plus
l_int|0x04
suffix:semicolon
id|dl
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|n
op_assign
l_int|0
suffix:semicolon
id|n
OL
l_int|3
suffix:semicolon
id|n
op_increment
)paren
(brace
r_for
c_loop
(paren
id|o
op_assign
l_int|0
suffix:semicolon
id|o
OL
l_int|5
suffix:semicolon
id|o
op_increment
)paren
(brace
id|dh
op_assign
id|table
(braket
id|si
)braket
suffix:semicolon
id|ah
op_assign
id|table
(braket
id|di
)braket
suffix:semicolon
id|al
op_assign
id|table
(braket
id|bx
)braket
suffix:semicolon
id|si
op_increment
suffix:semicolon
id|WriteDAC
c_func
(paren
id|dl
comma
id|ah
comma
id|al
comma
id|dh
)paren
suffix:semicolon
)brace
id|si
op_assign
id|si
op_minus
l_int|2
suffix:semicolon
r_for
c_loop
(paren
id|o
op_assign
l_int|0
suffix:semicolon
id|o
OL
l_int|3
suffix:semicolon
id|o
op_increment
)paren
(brace
id|dh
op_assign
id|table
(braket
id|bx
)braket
suffix:semicolon
id|ah
op_assign
id|table
(braket
id|di
)braket
suffix:semicolon
id|al
op_assign
id|table
(braket
id|si
)braket
suffix:semicolon
id|si
op_decrement
suffix:semicolon
id|WriteDAC
c_func
(paren
id|dl
comma
id|ah
comma
id|al
comma
id|dh
)paren
suffix:semicolon
)brace
id|dl
op_increment
suffix:semicolon
)brace
id|si
op_assign
id|si
op_plus
l_int|5
suffix:semicolon
)brace
)brace
)brace
DECL|function|WriteDAC
id|VOID
id|WriteDAC
c_func
(paren
id|USHORT
id|dl
comma
id|USHORT
id|ah
comma
id|USHORT
id|al
comma
id|USHORT
id|dh
)paren
(brace
id|USHORT
id|temp
suffix:semicolon
id|USHORT
id|bh
comma
id|bl
suffix:semicolon
id|bh
op_assign
id|ah
suffix:semicolon
id|bl
op_assign
id|al
suffix:semicolon
r_if
c_cond
(paren
id|dl
op_ne
l_int|0
)paren
(brace
id|temp
op_assign
id|bh
suffix:semicolon
id|bh
op_assign
id|dh
suffix:semicolon
id|dh
op_assign
id|temp
suffix:semicolon
r_if
c_cond
(paren
id|dl
op_eq
l_int|1
)paren
(brace
id|temp
op_assign
id|bl
suffix:semicolon
id|bl
op_assign
id|dh
suffix:semicolon
id|dh
op_assign
id|temp
suffix:semicolon
)brace
r_else
(brace
id|temp
op_assign
id|bl
suffix:semicolon
id|bl
op_assign
id|bh
suffix:semicolon
id|bh
op_assign
id|temp
suffix:semicolon
)brace
)brace
id|SetReg3
c_func
(paren
id|P3c9
comma
(paren
id|USHORT
)paren
id|dh
)paren
suffix:semicolon
id|SetReg3
c_func
(paren
id|P3c9
comma
(paren
id|USHORT
)paren
id|bh
)paren
suffix:semicolon
id|SetReg3
c_func
(paren
id|P3c9
comma
(paren
id|USHORT
)paren
id|bl
)paren
suffix:semicolon
)brace
DECL|function|DisplayOn
id|VOID
id|DisplayOn
c_func
(paren
)paren
(brace
id|USHORT
id|data
suffix:semicolon
id|data
op_assign
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x01
)paren
suffix:semicolon
id|data
op_assign
id|data
op_amp
l_int|0xDF
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x01
comma
id|data
)paren
suffix:semicolon
)brace
macro_line|#else
DECL|function|SiSSetMode
id|BOOLEAN
id|SiSSetMode
c_func
(paren
id|PHW_DEVICE_EXTENSION
id|HwDeviceExtension
comma
id|USHORT
id|ModeNo
)paren
(brace
id|ULONG
id|temp
suffix:semicolon
id|USHORT
id|cr30flag
comma
id|cr31flag
suffix:semicolon
id|ULONG
id|ROMAddr
op_assign
(paren
id|ULONG
)paren
id|HwDeviceExtension-&gt;VirtualRomBase
suffix:semicolon
id|USHORT
id|BaseAddr
op_assign
(paren
id|USHORT
)paren
id|HwDeviceExtension-&gt;IOAddress
suffix:semicolon
id|P3c4
op_assign
id|BaseAddr
op_plus
l_int|0x14
suffix:semicolon
id|P3d4
op_assign
id|BaseAddr
op_plus
l_int|0x24
suffix:semicolon
id|P3c0
op_assign
id|BaseAddr
op_plus
l_int|0x10
suffix:semicolon
id|P3ce
op_assign
id|BaseAddr
op_plus
l_int|0x1e
suffix:semicolon
id|P3c2
op_assign
id|BaseAddr
op_plus
l_int|0x12
suffix:semicolon
id|P3ca
op_assign
id|BaseAddr
op_plus
l_int|0x1a
suffix:semicolon
id|P3c6
op_assign
id|BaseAddr
op_plus
l_int|0x16
suffix:semicolon
id|P3c7
op_assign
id|BaseAddr
op_plus
l_int|0x17
suffix:semicolon
id|P3c8
op_assign
id|BaseAddr
op_plus
l_int|0x18
suffix:semicolon
id|P3c9
op_assign
id|BaseAddr
op_plus
l_int|0x19
suffix:semicolon
id|P3da
op_assign
id|BaseAddr
op_plus
l_int|0x2A
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
op_amp
l_int|0x80
)paren
(brace
id|ModeNo
op_assign
id|ModeNo
op_amp
l_int|0x7F
suffix:semicolon
id|flag_clearbuffer
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|flag_clearbuffer
op_assign
l_int|1
suffix:semicolon
)brace
id|PresetScratchregister
c_func
(paren
id|P3d4
comma
id|HwDeviceExtension
)paren
suffix:semicolon
singleline_comment|//add for CRT2
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x05
comma
l_int|0x86
)paren
suffix:semicolon
singleline_comment|// 1.Openkey
id|temp
op_assign
id|SearchModeID
c_func
(paren
id|ROMAddr
comma
id|ModeNo
)paren
suffix:semicolon
singleline_comment|// 2.Get ModeID Table
r_if
c_cond
(paren
id|temp
op_eq
l_int|0
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
id|SetTVSystem
c_func
(paren
id|HwDeviceExtension
comma
id|ROMAddr
)paren
suffix:semicolon
singleline_comment|//add for CRT2
id|GetLCDDDCInfo
c_func
(paren
id|HwDeviceExtension
)paren
suffix:semicolon
singleline_comment|//add for CRT2
id|GetVBInfo
c_func
(paren
id|BaseAddr
comma
id|ROMAddr
)paren
suffix:semicolon
singleline_comment|//add for CRT2
id|GetLCDResInfo
c_func
(paren
id|ROMAddr
comma
id|P3d4
)paren
suffix:semicolon
singleline_comment|//add for CRT2
id|temp
op_assign
id|CheckMemorySize
c_func
(paren
id|ROMAddr
)paren
suffix:semicolon
singleline_comment|// 3.Check memory size
r_if
c_cond
(paren
id|temp
op_eq
l_int|0
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
id|cr30flag
op_assign
(paren
id|UCHAR
)paren
id|GetReg1
c_func
(paren
id|P3d4
comma
l_int|0x30
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
id|cr30flag
op_amp
l_int|0x01
)paren
op_eq
l_int|1
)paren
op_logical_or
(paren
(paren
id|cr30flag
op_amp
l_int|0x02
)paren
op_eq
l_int|0
)paren
)paren
(brace
singleline_comment|// if cr30 d[0]=1 or d[1]=0 set crt1  
id|SetReg1
c_func
(paren
id|P3d4
comma
l_int|0x34
comma
id|ModeNo
)paren
suffix:semicolon
singleline_comment|// set CR34-&gt;CRT1 ModeNofor CRT2 FIFO
id|GetModePtr
c_func
(paren
id|ROMAddr
comma
id|ModeNo
)paren
suffix:semicolon
singleline_comment|// 4.GetModePtr
id|SetSeqRegs
c_func
(paren
id|ROMAddr
)paren
suffix:semicolon
singleline_comment|// 5.SetSeqRegs
id|SetMiscRegs
c_func
(paren
id|ROMAddr
)paren
suffix:semicolon
singleline_comment|// 6.SetMiscRegs
id|SetCRTCRegs
c_func
(paren
id|ROMAddr
)paren
suffix:semicolon
singleline_comment|// 7.SetCRTCRegs
id|SetATTRegs
c_func
(paren
id|ROMAddr
)paren
suffix:semicolon
singleline_comment|// 8.SetATTRegs
id|SetGRCRegs
c_func
(paren
id|ROMAddr
)paren
suffix:semicolon
singleline_comment|// 9.SetGRCRegs
id|ClearExt1Regs
c_func
(paren
)paren
suffix:semicolon
singleline_comment|// 10.Clear Ext1Regs
id|temp
op_assign
id|GetRatePtr
c_func
(paren
id|ROMAddr
comma
id|ModeNo
)paren
suffix:semicolon
singleline_comment|// 11.GetRatePtr
r_if
c_cond
(paren
id|temp
)paren
(brace
id|SetSync
c_func
(paren
id|ROMAddr
)paren
suffix:semicolon
singleline_comment|// 12.SetSync
id|SetCRT1CRTC
c_func
(paren
id|ROMAddr
)paren
suffix:semicolon
singleline_comment|// 13.SetCRT1CRTC
id|SetCRT1Offset
c_func
(paren
id|ROMAddr
)paren
suffix:semicolon
singleline_comment|// 14.SetCRT1Offset
id|SetCRT1VCLK
c_func
(paren
id|HwDeviceExtension
comma
id|ROMAddr
)paren
suffix:semicolon
singleline_comment|// 15.SetCRT1VCLK
id|SetVCLKState
c_func
(paren
id|HwDeviceExtension
comma
id|ROMAddr
comma
id|ModeNo
)paren
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipID
op_ge
id|SIS_Trojan
)paren
(brace
id|SetCRT1FIFO2
c_func
(paren
id|ROMAddr
)paren
suffix:semicolon
)brace
r_else
id|SetCRT1FIFO
c_func
(paren
id|ROMAddr
)paren
suffix:semicolon
)brace
id|SetCRT1ModeRegs
c_func
(paren
id|ROMAddr
comma
id|ModeNo
)paren
suffix:semicolon
r_if
c_cond
(paren
id|HwDeviceExtension-&gt;jChipID
op_ge
id|SIS_Trojan
)paren
(brace
id|SetInterlace
c_func
(paren
id|ROMAddr
comma
id|ModeNo
)paren
suffix:semicolon
)brace
id|LoadDAC
c_func
(paren
id|ROMAddr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|flag_clearbuffer
)paren
(brace
id|ClearBuffer
c_func
(paren
id|HwDeviceExtension
)paren
suffix:semicolon
)brace
)brace
id|cr31flag
op_assign
(paren
id|UCHAR
)paren
id|GetReg1
c_func
(paren
id|P3d4
comma
l_int|0x31
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
id|cr30flag
op_amp
l_int|0x01
)paren
op_eq
l_int|1
)paren
op_logical_or
(paren
(paren
id|cr30flag
op_amp
l_int|0x03
)paren
op_eq
l_int|0x02
)paren
op_logical_or
(paren
(paren
(paren
id|cr30flag
op_amp
l_int|0x03
)paren
op_eq
l_int|0x00
)paren
op_logical_and
(paren
(paren
id|cr31flag
op_amp
l_int|0x20
)paren
op_eq
l_int|0x20
)paren
)paren
)paren
(brace
singleline_comment|//if CR30 d[0]=1 or d[1:0]=10, set CRT2 or cr30 cr31== 0x00 0x20&t;
id|SetCRT2Group
c_func
(paren
id|BaseAddr
comma
id|ROMAddr
comma
id|ModeNo
comma
id|HwDeviceExtension
)paren
suffix:semicolon
singleline_comment|//CRT2
)brace
id|DisplayOn
c_func
(paren
)paren
suffix:semicolon
singleline_comment|// 16.DisplayOn
r_return
id|NO_ERROR
suffix:semicolon
)brace
DECL|function|SearchModeID
id|BOOLEAN
id|SearchModeID
c_func
(paren
id|ULONG
id|ROMAddr
comma
id|USHORT
id|ModeNo
)paren
(brace
id|UCHAR
id|ModeID
suffix:semicolon
id|USHORT
id|usIDLength
suffix:semicolon
id|ModeIDOffset
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
l_int|0x20A
)paren
)paren
suffix:semicolon
singleline_comment|// Get EModeIDTable
id|ModeID
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
id|ModeIDOffset
)paren
)paren
suffix:semicolon
singleline_comment|// Offset 0x20A
id|usIDLength
op_assign
id|GetModeIDLength
c_func
(paren
id|ROMAddr
comma
id|ModeNo
)paren
suffix:semicolon
r_while
c_loop
(paren
id|ModeID
op_ne
l_int|0xff
op_logical_and
id|ModeID
op_ne
id|ModeNo
)paren
(brace
id|ModeIDOffset
op_assign
id|ModeIDOffset
op_plus
id|usIDLength
suffix:semicolon
id|ModeID
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
id|ModeIDOffset
)paren
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ModeID
op_eq
l_int|0xff
)paren
(brace
r_return
id|FALSE
suffix:semicolon
)brace
r_else
r_return
id|TRUE
suffix:semicolon
)brace
DECL|function|CheckMemorySize
id|BOOLEAN
id|CheckMemorySize
c_func
(paren
id|ULONG
id|ROMAddr
)paren
(brace
id|USHORT
id|memorysize
suffix:semicolon
id|USHORT
id|modeflag
suffix:semicolon
id|USHORT
id|temp
suffix:semicolon
id|modeflag
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
id|ModeIDOffset
op_plus
l_int|0x01
)paren
)paren
suffix:semicolon
singleline_comment|// si+St_ModeFlag
id|ModeType
op_assign
id|modeflag
op_amp
id|ModeInfoFlag
suffix:semicolon
singleline_comment|// Get mode type
id|memorysize
op_assign
id|modeflag
op_amp
id|MemoryInfoFlag
suffix:semicolon
id|memorysize
op_assign
id|memorysize
OG
id|MemorySizeShift
suffix:semicolon
id|memorysize
op_increment
suffix:semicolon
singleline_comment|// Get memory size
id|temp
op_assign
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x14
)paren
suffix:semicolon
singleline_comment|// Get DRAM Size
id|temp
op_assign
id|temp
op_amp
l_int|0x3F
suffix:semicolon
id|temp
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|temp
OL
id|memorysize
)paren
(brace
r_return
id|FALSE
suffix:semicolon
)brace
r_else
r_return
id|TRUE
suffix:semicolon
)brace
DECL|function|GetModePtr
id|VOID
id|GetModePtr
c_func
(paren
id|ULONG
id|ROMAddr
comma
id|USHORT
id|ModeNo
)paren
(brace
id|UCHAR
id|index
suffix:semicolon
id|StandTable
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
l_int|0x202
)paren
)paren
suffix:semicolon
singleline_comment|// Get First  0x202
singleline_comment|// StandTable Offset
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|13
)paren
(brace
id|index
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
id|ModeIDOffset
op_plus
l_int|0x03
)paren
)paren
suffix:semicolon
singleline_comment|// si+St_ModeFlag
)brace
r_else
(brace
r_if
c_cond
(paren
id|ModeType
op_le
l_int|0x02
)paren
(brace
id|index
op_assign
l_int|0x1B
suffix:semicolon
)brace
singleline_comment|// 02 -&gt; ModeEGA
r_else
id|index
op_assign
l_int|0x0F
suffix:semicolon
)brace
id|StandTable
op_assign
id|StandTable
op_plus
l_int|64
op_star
id|index
suffix:semicolon
singleline_comment|// Get ModeNo StandTable
)brace
DECL|function|SetSeqRegs
id|VOID
id|SetSeqRegs
c_func
(paren
id|ULONG
id|ROMAddr
)paren
(brace
id|UCHAR
id|SRdata
suffix:semicolon
id|USHORT
id|i
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x00
comma
l_int|0x03
)paren
suffix:semicolon
singleline_comment|// Set SR0
id|StandTable
op_assign
id|StandTable
op_plus
l_int|0x05
suffix:semicolon
id|SRdata
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
id|StandTable
)paren
)paren
suffix:semicolon
singleline_comment|// Get SR01 from file
r_if
c_cond
(paren
id|IF_DEF_LVDS
op_eq
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|VBInfo
op_amp
id|SetCRT2ToLCD
)paren
(brace
r_if
c_cond
(paren
id|VBInfo
op_amp
id|SetInSlaveMode
)paren
(brace
r_if
c_cond
(paren
id|LCDInfo
op_amp
id|LCDNonExpanding
)paren
(brace
id|SRdata
op_assign
id|SRdata
op_or
l_int|0x01
suffix:semicolon
)brace
)brace
)brace
)brace
id|SRdata
op_assign
id|SRdata
op_or
l_int|0x20
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x01
comma
id|SRdata
)paren
suffix:semicolon
singleline_comment|// Set SR1
r_for
c_loop
(paren
id|i
op_assign
l_int|02
suffix:semicolon
id|i
op_le
l_int|04
suffix:semicolon
id|i
op_increment
)paren
(brace
id|StandTable
op_increment
suffix:semicolon
id|SRdata
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
id|StandTable
)paren
)paren
suffix:semicolon
singleline_comment|// Get SR2,3,4 from file
id|SetReg1
c_func
(paren
id|P3c4
comma
id|i
comma
id|SRdata
)paren
suffix:semicolon
singleline_comment|// Set SR2 3 4
)brace
)brace
DECL|function|SetMiscRegs
id|VOID
id|SetMiscRegs
c_func
(paren
id|ULONG
id|ROMAddr
)paren
(brace
id|UCHAR
id|Miscdata
suffix:semicolon
id|StandTable
op_increment
suffix:semicolon
id|Miscdata
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
id|StandTable
)paren
)paren
suffix:semicolon
singleline_comment|// Get Misc from file
id|SetReg3
c_func
(paren
id|P3c2
comma
id|Miscdata
)paren
suffix:semicolon
singleline_comment|// Set Misc(3c2)
)brace
DECL|function|SetCRTCRegs
id|VOID
id|SetCRTCRegs
c_func
(paren
id|ULONG
id|ROMAddr
)paren
(brace
id|UCHAR
id|CRTCdata
suffix:semicolon
id|USHORT
id|i
suffix:semicolon
id|CRTCdata
op_assign
(paren
id|UCHAR
)paren
id|GetReg1
c_func
(paren
id|P3d4
comma
l_int|0x11
)paren
suffix:semicolon
id|CRTCdata
op_assign
id|CRTCdata
op_amp
l_int|0x7f
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3d4
comma
l_int|0x11
comma
id|CRTCdata
)paren
suffix:semicolon
singleline_comment|// Unlock CRTC
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|0x18
suffix:semicolon
id|i
op_increment
)paren
(brace
id|StandTable
op_increment
suffix:semicolon
id|CRTCdata
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
id|StandTable
)paren
)paren
suffix:semicolon
singleline_comment|// Get CRTC from file
id|SetReg1
c_func
(paren
id|P3d4
comma
id|i
comma
id|CRTCdata
)paren
suffix:semicolon
singleline_comment|// Set CRTC(3d4)
)brace
)brace
DECL|function|SetATTRegs
id|VOID
id|SetATTRegs
c_func
(paren
id|ULONG
id|ROMAddr
)paren
(brace
id|UCHAR
id|ARdata
suffix:semicolon
id|USHORT
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|0x13
suffix:semicolon
id|i
op_increment
)paren
(brace
id|StandTable
op_increment
suffix:semicolon
id|ARdata
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
id|StandTable
)paren
)paren
suffix:semicolon
singleline_comment|// Get AR for file
r_if
c_cond
(paren
id|IF_DEF_LVDS
op_eq
l_int|1
)paren
(brace
singleline_comment|//for LVDS
r_if
c_cond
(paren
id|VBInfo
op_amp
id|SetCRT2ToLCD
)paren
(brace
r_if
c_cond
(paren
id|VBInfo
op_amp
id|SetInSlaveMode
)paren
(brace
r_if
c_cond
(paren
id|LCDInfo
op_amp
id|LCDNonExpanding
)paren
(brace
r_if
c_cond
(paren
id|i
op_eq
l_int|0x13
)paren
(brace
id|ARdata
op_assign
l_int|0
suffix:semicolon
)brace
)brace
)brace
)brace
)brace
id|GetReg2
c_func
(paren
id|P3da
)paren
suffix:semicolon
singleline_comment|// reset 3da
id|SetReg3
c_func
(paren
id|P3c0
comma
id|i
)paren
suffix:semicolon
singleline_comment|// set index
id|SetReg3
c_func
(paren
id|P3c0
comma
id|ARdata
)paren
suffix:semicolon
singleline_comment|// set data
)brace
r_if
c_cond
(paren
id|IF_DEF_LVDS
op_eq
l_int|1
)paren
(brace
singleline_comment|//for LVDS
r_if
c_cond
(paren
id|VBInfo
op_amp
id|SetCRT2ToLCD
)paren
(brace
r_if
c_cond
(paren
id|VBInfo
op_amp
id|SetInSlaveMode
)paren
(brace
r_if
c_cond
(paren
id|LCDInfo
op_amp
id|LCDNonExpanding
)paren
(brace
)brace
)brace
)brace
)brace
id|GetReg2
c_func
(paren
id|P3da
)paren
suffix:semicolon
singleline_comment|// reset 3da
id|SetReg3
c_func
(paren
id|P3c0
comma
l_int|0x14
)paren
suffix:semicolon
singleline_comment|// set index
id|SetReg3
c_func
(paren
id|P3c0
comma
l_int|0x00
)paren
suffix:semicolon
singleline_comment|// set data
id|GetReg2
c_func
(paren
id|P3da
)paren
suffix:semicolon
singleline_comment|// Enable Attribute
id|SetReg3
c_func
(paren
id|P3c0
comma
l_int|0x20
)paren
suffix:semicolon
)brace
DECL|function|SetGRCRegs
id|VOID
id|SetGRCRegs
c_func
(paren
id|ULONG
id|ROMAddr
)paren
(brace
id|UCHAR
id|GRdata
suffix:semicolon
id|USHORT
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|0x08
suffix:semicolon
id|i
op_increment
)paren
(brace
id|StandTable
op_increment
suffix:semicolon
id|GRdata
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
id|StandTable
)paren
)paren
suffix:semicolon
singleline_comment|// Get GR from file
id|SetReg1
c_func
(paren
id|P3ce
comma
id|i
comma
id|GRdata
)paren
suffix:semicolon
singleline_comment|// Set GR(3ce)
)brace
r_if
c_cond
(paren
id|ModeType
OG
id|ModeVGA
)paren
(brace
id|GRdata
op_assign
(paren
id|UCHAR
)paren
id|GetReg1
c_func
(paren
id|P3ce
comma
l_int|0x05
)paren
suffix:semicolon
id|GRdata
op_assign
id|GRdata
op_amp
l_int|0xBF
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3ce
comma
l_int|0x05
comma
id|GRdata
)paren
suffix:semicolon
)brace
)brace
DECL|function|ClearExt1Regs
id|VOID
id|ClearExt1Regs
c_func
(paren
)paren
(brace
id|USHORT
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0x0A
suffix:semicolon
id|i
op_le
l_int|0x0E
suffix:semicolon
id|i
op_increment
)paren
(brace
id|SetReg1
c_func
(paren
id|P3c4
comma
id|i
comma
l_int|0x00
)paren
suffix:semicolon
)brace
singleline_comment|// Clear SR0A-SR0E
)brace
DECL|function|GetRatePtr
id|BOOLEAN
id|GetRatePtr
c_func
(paren
id|ULONG
id|ROMAddr
comma
id|USHORT
id|ModeNo
)paren
(brace
id|SHORT
id|index
suffix:semicolon
id|USHORT
id|temp
suffix:semicolon
id|USHORT
id|ulRefIndexLength
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
OL
l_int|0x14
)paren
(brace
r_return
id|FALSE
suffix:semicolon
)brace
singleline_comment|// Mode No &lt;= 13h then return
id|index
op_assign
id|GetReg1
c_func
(paren
id|P3d4
comma
l_int|0x33
)paren
suffix:semicolon
singleline_comment|// Get 3d4 CRTC33
id|index
op_assign
id|index
op_amp
l_int|0x0F
suffix:semicolon
singleline_comment|// Frame rate index
r_if
c_cond
(paren
id|index
op_ne
l_int|0
)paren
(brace
id|index
op_decrement
suffix:semicolon
)brace
id|REFIndex
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
id|ModeIDOffset
op_plus
l_int|0x04
)paren
)paren
suffix:semicolon
singleline_comment|// si+Ext_point
id|ulRefIndexLength
op_assign
id|GetRefindexLength
c_func
(paren
id|ROMAddr
comma
id|ModeNo
)paren
suffix:semicolon
r_do
(brace
id|temp
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
id|REFIndex
)paren
)paren
suffix:semicolon
singleline_comment|// di =&gt; REFIndex
r_if
c_cond
(paren
id|temp
op_eq
l_int|0xFFFF
)paren
(brace
r_break
suffix:semicolon
)brace
id|temp
op_assign
id|temp
op_amp
id|ModeInfoFlag
suffix:semicolon
r_if
c_cond
(paren
id|temp
OL
id|ModeType
)paren
(brace
r_break
suffix:semicolon
)brace
id|REFIndex
op_assign
id|REFIndex
op_plus
id|ulRefIndexLength
suffix:semicolon
singleline_comment|// rate size
id|index
op_decrement
suffix:semicolon
)brace
r_while
c_loop
(paren
id|index
op_ge
l_int|0
)paren
(brace
suffix:semicolon
)brace
id|REFIndex
op_assign
id|REFIndex
op_minus
id|ulRefIndexLength
suffix:semicolon
singleline_comment|// rate size
r_return
id|TRUE
suffix:semicolon
)brace
DECL|function|SetSync
id|VOID
id|SetSync
c_func
(paren
id|ULONG
id|ROMAddr
)paren
(brace
id|USHORT
id|sync
suffix:semicolon
id|USHORT
id|temp
suffix:semicolon
id|sync
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
id|REFIndex
)paren
)paren
suffix:semicolon
singleline_comment|// di+0x00
id|sync
op_assign
id|sync
op_amp
l_int|0xC0
suffix:semicolon
id|temp
op_assign
l_int|0x2F
suffix:semicolon
id|temp
op_assign
id|temp
op_or
id|sync
suffix:semicolon
id|SetReg3
c_func
(paren
id|P3c2
comma
id|temp
)paren
suffix:semicolon
singleline_comment|// Set Misc(3c2)
)brace
DECL|function|SetCRT1CRTC
id|VOID
id|SetCRT1CRTC
c_func
(paren
id|ULONG
id|ROMAddr
)paren
(brace
id|UCHAR
id|index
suffix:semicolon
id|UCHAR
id|data
suffix:semicolon
id|USHORT
id|i
suffix:semicolon
id|index
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
id|REFIndex
op_plus
l_int|0x02
)paren
)paren
suffix:semicolon
singleline_comment|// Get index
id|index
op_assign
id|index
op_amp
l_int|0x03F
suffix:semicolon
id|CRT1Table
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
l_int|0x204
)paren
)paren
suffix:semicolon
singleline_comment|// Get CRT1Table
id|CRT1Table
op_assign
id|CRT1Table
op_plus
id|index
op_star
id|CRT1Len
suffix:semicolon
id|data
op_assign
(paren
id|UCHAR
)paren
id|GetReg1
c_func
(paren
id|P3d4
comma
l_int|0x11
)paren
suffix:semicolon
id|data
op_assign
id|data
op_amp
l_int|0x7F
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3d4
comma
l_int|0x11
comma
id|data
)paren
suffix:semicolon
singleline_comment|// Unlock CRTC
id|CRT1Table
op_decrement
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
l_int|0x05
suffix:semicolon
id|i
op_increment
)paren
(brace
id|CRT1Table
op_increment
suffix:semicolon
id|data
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
id|CRT1Table
)paren
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3d4
comma
id|i
comma
id|data
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x06
suffix:semicolon
id|i
op_le
l_int|0x07
suffix:semicolon
id|i
op_increment
)paren
(brace
id|CRT1Table
op_increment
suffix:semicolon
id|data
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
id|CRT1Table
)paren
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3d4
comma
id|i
comma
id|data
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x10
suffix:semicolon
id|i
op_le
l_int|0x12
suffix:semicolon
id|i
op_increment
)paren
(brace
id|CRT1Table
op_increment
suffix:semicolon
id|data
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
id|CRT1Table
)paren
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3d4
comma
id|i
comma
id|data
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x15
suffix:semicolon
id|i
op_le
l_int|0x16
suffix:semicolon
id|i
op_increment
)paren
(brace
id|CRT1Table
op_increment
suffix:semicolon
id|data
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
id|CRT1Table
)paren
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3d4
comma
id|i
comma
id|data
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0x0A
suffix:semicolon
id|i
op_le
l_int|0x0C
suffix:semicolon
id|i
op_increment
)paren
(brace
id|CRT1Table
op_increment
suffix:semicolon
id|data
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
id|CRT1Table
)paren
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
id|i
comma
id|data
)paren
suffix:semicolon
)brace
id|CRT1Table
op_increment
suffix:semicolon
id|data
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
id|CRT1Table
)paren
)paren
suffix:semicolon
id|data
op_assign
id|data
op_amp
l_int|0xE0
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x0E
comma
id|data
)paren
suffix:semicolon
id|data
op_assign
(paren
id|UCHAR
)paren
id|GetReg1
c_func
(paren
id|P3d4
comma
l_int|0x09
)paren
suffix:semicolon
id|data
op_assign
id|data
op_amp
l_int|0xDF
suffix:semicolon
id|i
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
id|CRT1Table
)paren
)paren
suffix:semicolon
id|i
op_assign
id|i
op_amp
l_int|0x01
suffix:semicolon
id|i
op_assign
id|i
op_lshift
l_int|5
suffix:semicolon
id|data
op_assign
id|data
op_or
id|i
suffix:semicolon
id|i
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
id|ModeIDOffset
op_plus
l_int|0x01
)paren
)paren
suffix:semicolon
id|i
op_assign
id|i
op_amp
id|DoubleScanMode
suffix:semicolon
r_if
c_cond
(paren
id|i
)paren
(brace
id|data
op_assign
id|data
op_or
l_int|0x80
suffix:semicolon
)brace
id|SetReg1
c_func
(paren
id|P3d4
comma
l_int|0x09
comma
id|data
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ModeType
OG
l_int|0x03
)paren
(brace
id|SetReg1
c_func
(paren
id|P3d4
comma
l_int|0x14
comma
l_int|0x4F
)paren
suffix:semicolon
)brace
)brace
DECL|function|SetCRT1Offset
id|VOID
id|SetCRT1Offset
c_func
(paren
id|ULONG
id|ROMAddr
)paren
(brace
id|USHORT
id|temp
comma
id|ah
comma
id|al
suffix:semicolon
id|USHORT
id|temp2
comma
id|i
suffix:semicolon
id|USHORT
id|DisplayUnit
suffix:semicolon
id|temp
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
id|ModeIDOffset
op_plus
l_int|0x03
)paren
)paren
suffix:semicolon
singleline_comment|// si+Ext_ModeInfo
id|temp
op_assign
id|temp
op_rshift
l_int|4
suffix:semicolon
singleline_comment|// index
id|ScreenOffset
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
l_int|0x206
)paren
)paren
suffix:semicolon
singleline_comment|// ScreenOffset
id|temp
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
id|ScreenOffset
op_plus
id|temp
)paren
)paren
suffix:semicolon
singleline_comment|// data
id|temp2
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
id|REFIndex
op_plus
l_int|0x00
)paren
)paren
suffix:semicolon
id|temp2
op_assign
id|temp2
op_amp
id|InterlaceMode
suffix:semicolon
r_if
c_cond
(paren
id|temp2
)paren
(brace
id|temp
op_assign
id|temp
op_lshift
l_int|1
suffix:semicolon
)brace
id|temp2
op_assign
id|ModeType
op_minus
id|ModeEGA
suffix:semicolon
r_switch
c_cond
(paren
id|temp2
)paren
(brace
r_case
l_int|0
suffix:colon
id|temp2
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|temp2
op_assign
l_int|2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|temp2
op_assign
l_int|4
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|temp2
op_assign
l_int|4
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
id|temp2
op_assign
l_int|6
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
id|temp2
op_assign
l_int|8
suffix:semicolon
r_break
suffix:semicolon
)brace
id|temp
op_assign
id|temp
op_star
id|temp2
suffix:semicolon
id|DisplayUnit
op_assign
id|temp
suffix:semicolon
id|temp2
op_assign
id|temp
suffix:semicolon
id|temp
op_assign
id|temp
op_rshift
l_int|8
suffix:semicolon
id|temp
op_assign
id|temp
op_amp
l_int|0x0F
suffix:semicolon
id|i
op_assign
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x0E
)paren
suffix:semicolon
id|i
op_assign
id|i
op_amp
l_int|0xF0
suffix:semicolon
id|i
op_assign
id|i
op_or
id|temp
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x0E
comma
id|i
)paren
suffix:semicolon
id|temp
op_assign
(paren
id|UCHAR
)paren
id|temp2
suffix:semicolon
id|temp
op_assign
id|temp
op_amp
l_int|0xFF
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3d4
comma
l_int|0x13
comma
id|temp
)paren
suffix:semicolon
id|temp2
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
id|REFIndex
op_plus
l_int|0x00
)paren
)paren
suffix:semicolon
id|temp2
op_assign
id|temp2
op_amp
id|InterlaceMode
suffix:semicolon
r_if
c_cond
(paren
id|temp2
)paren
(brace
id|DisplayUnit
op_rshift_assign
l_int|1
suffix:semicolon
)brace
id|DisplayUnit
op_assign
id|DisplayUnit
op_lshift
l_int|5
suffix:semicolon
id|ah
op_assign
(paren
id|DisplayUnit
op_amp
l_int|0xff00
)paren
op_rshift
l_int|8
suffix:semicolon
id|al
op_assign
id|DisplayUnit
op_amp
l_int|0x00ff
suffix:semicolon
r_if
c_cond
(paren
id|al
op_eq
l_int|0
)paren
(brace
id|ah
op_assign
id|ah
op_plus
l_int|1
suffix:semicolon
)brace
r_else
id|ah
op_assign
id|ah
op_plus
l_int|2
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x10
comma
id|ah
)paren
suffix:semicolon
)brace
DECL|function|SetCRT1VCLK
id|VOID
id|SetCRT1VCLK
c_func
(paren
id|PHW_DEVICE_EXTENSION
id|HwDeviceExtension
comma
id|ULONG
id|ROMAddr
)paren
(brace
id|USHORT
id|i
suffix:semicolon
id|UCHAR
id|index
comma
id|data
suffix:semicolon
id|index
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
id|REFIndex
op_plus
l_int|0x03
)paren
)paren
suffix:semicolon
id|index
op_assign
id|index
op_amp
l_int|0x03F
suffix:semicolon
id|CRT1VCLKLen
op_assign
id|GetVCLKLen
c_func
(paren
id|ROMAddr
)paren
suffix:semicolon
id|data
op_assign
id|index
op_star
id|CRT1VCLKLen
suffix:semicolon
id|VCLKData
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
l_int|0x208
)paren
)paren
suffix:semicolon
id|VCLKData
op_assign
id|VCLKData
op_plus
id|data
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x31
comma
l_int|0
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0x2B
suffix:semicolon
id|i
op_le
l_int|0x2C
suffix:semicolon
id|i
op_increment
)paren
(brace
id|data
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
id|VCLKData
)paren
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
id|i
comma
id|data
)paren
suffix:semicolon
id|VCLKData
op_increment
suffix:semicolon
)brace
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x2D
comma
l_int|0x80
)paren
suffix:semicolon
)brace
DECL|function|SetCRT1ModeRegs
id|VOID
id|SetCRT1ModeRegs
c_func
(paren
id|ULONG
id|ROMAddr
comma
id|USHORT
id|ModeNo
)paren
(brace
id|USHORT
id|data
comma
id|data2
comma
id|data3
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
OG
l_int|0x13
)paren
(brace
id|data
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
id|REFIndex
op_plus
l_int|0x00
)paren
)paren
suffix:semicolon
)brace
r_else
id|data
op_assign
l_int|0
suffix:semicolon
id|data2
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
OG
l_int|0x13
)paren
r_if
c_cond
(paren
id|ModeType
OG
l_int|0x02
)paren
(brace
id|data2
op_assign
id|data2
op_or
l_int|0x02
suffix:semicolon
id|data3
op_assign
id|ModeType
op_minus
id|ModeVGA
suffix:semicolon
id|data3
op_assign
id|data3
op_lshift
l_int|2
suffix:semicolon
id|data2
op_assign
id|data2
op_or
id|data3
suffix:semicolon
)brace
id|data
op_assign
id|data
op_amp
id|InterlaceMode
suffix:semicolon
r_if
c_cond
(paren
id|data
)paren
(brace
id|data2
op_assign
id|data2
op_or
l_int|0x20
suffix:semicolon
)brace
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x06
comma
id|data2
)paren
suffix:semicolon
id|data
op_assign
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x01
)paren
suffix:semicolon
id|data
op_assign
id|data
op_amp
l_int|0xF7
suffix:semicolon
id|data2
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
id|ModeIDOffset
op_plus
l_int|0x01
)paren
)paren
suffix:semicolon
id|data2
op_assign
id|data2
op_amp
id|HalfDCLK
suffix:semicolon
r_if
c_cond
(paren
id|data2
)paren
(brace
id|data
op_assign
id|data
op_or
l_int|0x08
suffix:semicolon
)brace
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x01
comma
id|data
)paren
suffix:semicolon
id|data
op_assign
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x0F
)paren
suffix:semicolon
id|data
op_assign
id|data
op_amp
l_int|0xF7
suffix:semicolon
id|data2
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
id|ModeIDOffset
op_plus
l_int|0x01
)paren
)paren
suffix:semicolon
id|data2
op_assign
id|data2
op_amp
id|LineCompareOff
suffix:semicolon
r_if
c_cond
(paren
id|data2
)paren
(brace
id|data
op_assign
id|data
op_or
l_int|0x08
suffix:semicolon
)brace
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x0F
comma
id|data
)paren
suffix:semicolon
id|data
op_assign
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x21
)paren
suffix:semicolon
id|data
op_assign
id|data
op_amp
l_int|0x1F
suffix:semicolon
r_if
c_cond
(paren
id|ModeType
op_eq
l_int|0x00
)paren
(brace
id|data
op_assign
id|data
op_or
l_int|0x60
suffix:semicolon
)brace
singleline_comment|// Text Mode
r_else
r_if
c_cond
(paren
id|ModeType
op_le
l_int|0x02
)paren
(brace
id|data
op_assign
id|data
op_or
l_int|0x00
suffix:semicolon
)brace
singleline_comment|// EGA Mode
r_else
id|data
op_assign
id|data
op_or
l_int|0xA0
suffix:semicolon
singleline_comment|// VGA Mode
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x21
comma
id|data
)paren
suffix:semicolon
)brace
DECL|function|SetVCLKState
id|VOID
id|SetVCLKState
c_func
(paren
id|PHW_DEVICE_EXTENSION
id|HwDeviceExtension
comma
id|ULONG
id|ROMAddr
comma
id|USHORT
id|ModeNo
)paren
(brace
id|USHORT
id|data
comma
id|data2
suffix:semicolon
id|USHORT
id|VCLK
suffix:semicolon
id|UCHAR
id|index
suffix:semicolon
id|index
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
id|REFIndex
op_plus
l_int|0x03
)paren
)paren
suffix:semicolon
id|index
op_assign
id|index
op_amp
l_int|0x03F
suffix:semicolon
id|CRT1VCLKLen
op_assign
id|GetVCLKLen
c_func
(paren
id|ROMAddr
)paren
suffix:semicolon
id|data
op_assign
id|index
op_star
id|CRT1VCLKLen
suffix:semicolon
id|VCLKData
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
l_int|0x208
)paren
)paren
suffix:semicolon
id|VCLKData
op_assign
id|VCLKData
op_plus
id|data
op_plus
(paren
id|CRT1VCLKLen
op_minus
l_int|2
)paren
suffix:semicolon
id|VCLK
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
id|VCLKData
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
op_le
l_int|0x13
)paren
(brace
id|VCLK
op_assign
l_int|0
suffix:semicolon
)brace
id|data
op_assign
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x07
)paren
suffix:semicolon
id|data
op_assign
id|data
op_amp
l_int|0x7B
suffix:semicolon
r_if
c_cond
(paren
id|VCLK
op_ge
l_int|150
)paren
(brace
id|data
op_assign
id|data
op_or
l_int|0x80
suffix:semicolon
)brace
singleline_comment|// VCLK &gt; 150
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x07
comma
id|data
)paren
suffix:semicolon
id|data
op_assign
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x32
)paren
suffix:semicolon
id|data
op_assign
id|data
op_amp
l_int|0xD7
suffix:semicolon
r_if
c_cond
(paren
id|VCLK
op_ge
l_int|150
)paren
(brace
id|data
op_assign
id|data
op_or
l_int|0x08
suffix:semicolon
)brace
singleline_comment|// VCLK &gt; 150
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x32
comma
id|data
)paren
suffix:semicolon
id|data2
op_assign
l_int|0x03
suffix:semicolon
r_if
c_cond
(paren
id|VCLK
OG
l_int|135
)paren
(brace
id|data2
op_assign
l_int|0x02
suffix:semicolon
)brace
r_if
c_cond
(paren
id|VCLK
OG
l_int|160
)paren
(brace
id|data2
op_assign
l_int|0x01
suffix:semicolon
)brace
r_if
c_cond
(paren
id|VCLK
OG
l_int|260
)paren
(brace
id|data2
op_assign
l_int|0x00
suffix:semicolon
)brace
id|data
op_assign
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x07
)paren
suffix:semicolon
id|data
op_assign
id|data
op_amp
l_int|0xFC
suffix:semicolon
id|data
op_assign
id|data
op_or
id|data2
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x07
comma
id|data
)paren
suffix:semicolon
)brace
DECL|function|LoadDAC
id|VOID
id|LoadDAC
c_func
(paren
id|ULONG
id|ROMAddr
)paren
(brace
id|USHORT
id|data
comma
id|data2
suffix:semicolon
id|USHORT
id|time
comma
id|i
comma
id|j
comma
id|k
suffix:semicolon
id|USHORT
id|m
comma
id|n
comma
id|o
suffix:semicolon
id|USHORT
id|si
comma
id|di
comma
id|bx
comma
id|dl
suffix:semicolon
id|USHORT
id|al
comma
id|ah
comma
id|dh
suffix:semicolon
id|USHORT
op_star
id|table
op_assign
id|VGA_DAC
suffix:semicolon
id|data
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
id|ModeIDOffset
op_plus
l_int|0x01
)paren
)paren
suffix:semicolon
id|data
op_assign
id|data
op_amp
id|DACInfoFlag
suffix:semicolon
id|time
op_assign
l_int|64
suffix:semicolon
r_if
c_cond
(paren
id|data
op_eq
l_int|0x00
)paren
(brace
id|table
op_assign
id|MDA_DAC
suffix:semicolon
)brace
r_if
c_cond
(paren
id|data
op_eq
l_int|0x08
)paren
(brace
id|table
op_assign
id|CGA_DAC
suffix:semicolon
)brace
r_if
c_cond
(paren
id|data
op_eq
l_int|0x10
)paren
(brace
id|table
op_assign
id|EGA_DAC
suffix:semicolon
)brace
r_if
c_cond
(paren
id|data
op_eq
l_int|0x18
)paren
(brace
id|time
op_assign
l_int|256
suffix:semicolon
id|table
op_assign
id|VGA_DAC
suffix:semicolon
)brace
r_if
c_cond
(paren
id|time
op_eq
l_int|256
)paren
(brace
id|j
op_assign
l_int|16
suffix:semicolon
)brace
r_else
id|j
op_assign
id|time
suffix:semicolon
id|SetReg3
c_func
(paren
id|P3c6
comma
l_int|0xFF
)paren
suffix:semicolon
id|SetReg3
c_func
(paren
id|P3c8
comma
l_int|0x00
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|j
suffix:semicolon
id|i
op_increment
)paren
(brace
id|data
op_assign
id|table
(braket
id|i
)braket
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
OL
l_int|3
suffix:semicolon
id|k
op_increment
)paren
(brace
id|data2
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|data
op_amp
l_int|0x01
)paren
(brace
id|data2
op_assign
l_int|0x2A
suffix:semicolon
)brace
r_if
c_cond
(paren
id|data
op_amp
l_int|0x02
)paren
(brace
id|data2
op_assign
id|data2
op_plus
l_int|0x15
suffix:semicolon
)brace
id|SetReg3
c_func
(paren
id|P3c9
comma
id|data2
)paren
suffix:semicolon
id|data
op_assign
id|data
op_rshift
l_int|2
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|time
op_eq
l_int|256
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|16
suffix:semicolon
id|i
OL
l_int|32
suffix:semicolon
id|i
op_increment
)paren
(brace
id|data
op_assign
id|table
(braket
id|i
)braket
suffix:semicolon
r_for
c_loop
(paren
id|k
op_assign
l_int|0
suffix:semicolon
id|k
OL
l_int|3
suffix:semicolon
id|k
op_increment
)paren
(brace
id|SetReg3
c_func
(paren
id|P3c9
comma
id|data
)paren
suffix:semicolon
)brace
)brace
id|si
op_assign
l_int|32
suffix:semicolon
r_for
c_loop
(paren
id|m
op_assign
l_int|0
suffix:semicolon
id|m
OL
l_int|9
suffix:semicolon
id|m
op_increment
)paren
(brace
id|di
op_assign
id|si
suffix:semicolon
id|bx
op_assign
id|si
op_plus
l_int|0x04
suffix:semicolon
id|dl
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|n
op_assign
l_int|0
suffix:semicolon
id|n
OL
l_int|3
suffix:semicolon
id|n
op_increment
)paren
(brace
r_for
c_loop
(paren
id|o
op_assign
l_int|0
suffix:semicolon
id|o
OL
l_int|5
suffix:semicolon
id|o
op_increment
)paren
(brace
id|dh
op_assign
id|table
(braket
id|si
)braket
suffix:semicolon
id|ah
op_assign
id|table
(braket
id|di
)braket
suffix:semicolon
id|al
op_assign
id|table
(braket
id|bx
)braket
suffix:semicolon
id|si
op_increment
suffix:semicolon
id|WriteDAC
c_func
(paren
id|dl
comma
id|ah
comma
id|al
comma
id|dh
)paren
suffix:semicolon
)brace
id|si
op_assign
id|si
op_minus
l_int|2
suffix:semicolon
r_for
c_loop
(paren
id|o
op_assign
l_int|0
suffix:semicolon
id|o
OL
l_int|3
suffix:semicolon
id|o
op_increment
)paren
(brace
id|dh
op_assign
id|table
(braket
id|bx
)braket
suffix:semicolon
id|ah
op_assign
id|table
(braket
id|di
)braket
suffix:semicolon
id|al
op_assign
id|table
(braket
id|si
)braket
suffix:semicolon
id|si
op_decrement
suffix:semicolon
id|WriteDAC
c_func
(paren
id|dl
comma
id|ah
comma
id|al
comma
id|dh
)paren
suffix:semicolon
)brace
id|dl
op_increment
suffix:semicolon
)brace
id|si
op_assign
id|si
op_plus
l_int|5
suffix:semicolon
)brace
)brace
)brace
DECL|function|WriteDAC
id|VOID
id|WriteDAC
c_func
(paren
id|USHORT
id|dl
comma
id|USHORT
id|ah
comma
id|USHORT
id|al
comma
id|USHORT
id|dh
)paren
(brace
id|USHORT
id|temp
suffix:semicolon
id|USHORT
id|bh
comma
id|bl
suffix:semicolon
id|bh
op_assign
id|ah
suffix:semicolon
id|bl
op_assign
id|al
suffix:semicolon
r_if
c_cond
(paren
id|dl
op_ne
l_int|0
)paren
(brace
id|temp
op_assign
id|bh
suffix:semicolon
id|bh
op_assign
id|dh
suffix:semicolon
id|dh
op_assign
id|temp
suffix:semicolon
r_if
c_cond
(paren
id|dl
op_eq
l_int|1
)paren
(brace
id|temp
op_assign
id|bl
suffix:semicolon
id|bl
op_assign
id|dh
suffix:semicolon
id|dh
op_assign
id|temp
suffix:semicolon
)brace
r_else
(brace
id|temp
op_assign
id|bl
suffix:semicolon
id|bl
op_assign
id|bh
suffix:semicolon
id|bh
op_assign
id|temp
suffix:semicolon
)brace
)brace
id|SetReg3
c_func
(paren
id|P3c9
comma
(paren
id|USHORT
)paren
id|dh
)paren
suffix:semicolon
id|SetReg3
c_func
(paren
id|P3c9
comma
(paren
id|USHORT
)paren
id|bh
)paren
suffix:semicolon
id|SetReg3
c_func
(paren
id|P3c9
comma
(paren
id|USHORT
)paren
id|bl
)paren
suffix:semicolon
)brace
DECL|function|DisplayOn
id|VOID
id|DisplayOn
c_func
(paren
)paren
(brace
id|USHORT
id|data
suffix:semicolon
id|data
op_assign
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x01
)paren
suffix:semicolon
id|data
op_assign
id|data
op_amp
l_int|0xDF
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x01
comma
id|data
)paren
suffix:semicolon
)brace
DECL|function|GetModeIDLength
id|USHORT
id|GetModeIDLength
c_func
(paren
id|ULONG
id|ROMAddr
comma
id|USHORT
id|ModeNo
)paren
(brace
id|USHORT
id|modeidlength
suffix:semicolon
id|USHORT
id|usModeIDOffset
suffix:semicolon
id|USHORT
id|PreviousWord
comma
id|CurrentWord
suffix:semicolon
id|modeidlength
op_assign
l_int|0
suffix:semicolon
id|usModeIDOffset
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
l_int|0x20A
)paren
)paren
suffix:semicolon
singleline_comment|// Get EModeIDTable
singleline_comment|//&t;maybe = 2Exx or xx2E&t;&t;
id|CurrentWord
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
id|usModeIDOffset
)paren
)paren
suffix:semicolon
singleline_comment|// Offset 0x20A
id|PreviousWord
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
id|usModeIDOffset
op_minus
l_int|2
)paren
)paren
suffix:semicolon
singleline_comment|// Offset 0x20A
r_while
c_loop
(paren
(paren
id|CurrentWord
op_ne
l_int|0x2E07
)paren
op_logical_or
(paren
id|PreviousWord
op_ne
l_int|0x0801
)paren
)paren
(brace
id|modeidlength
op_increment
suffix:semicolon
id|usModeIDOffset
op_assign
id|usModeIDOffset
op_plus
l_int|1
suffix:semicolon
singleline_comment|// 10 &lt;= ExtStructSize
id|CurrentWord
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
id|usModeIDOffset
)paren
)paren
suffix:semicolon
id|PreviousWord
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
id|usModeIDOffset
op_minus
l_int|2
)paren
)paren
suffix:semicolon
)brace
id|modeidlength
op_increment
suffix:semicolon
r_return
id|modeidlength
suffix:semicolon
)brace
DECL|function|GetRefindexLength
id|USHORT
id|GetRefindexLength
c_func
(paren
id|ULONG
id|ROMAddr
comma
id|USHORT
id|ModeNo
)paren
(brace
id|UCHAR
id|ModeID
suffix:semicolon
id|UCHAR
id|temp
suffix:semicolon
id|USHORT
id|refindexlength
suffix:semicolon
id|USHORT
id|usModeIDOffset
suffix:semicolon
id|USHORT
id|usREFIndex
suffix:semicolon
id|USHORT
id|usIDLength
suffix:semicolon
id|usModeIDOffset
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
l_int|0x20A
)paren
)paren
suffix:semicolon
singleline_comment|// Get EModeIDTable
id|ModeID
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
id|usModeIDOffset
)paren
)paren
suffix:semicolon
singleline_comment|// Offset 0x20A
id|usIDLength
op_assign
id|GetModeIDLength
c_func
(paren
id|ROMAddr
comma
id|ModeNo
)paren
suffix:semicolon
r_while
c_loop
(paren
id|ModeID
op_ne
l_int|0x40
)paren
(brace
id|usModeIDOffset
op_assign
id|usModeIDOffset
op_plus
id|usIDLength
suffix:semicolon
singleline_comment|// 10 &lt;= ExtStructSize
id|ModeID
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
id|usModeIDOffset
)paren
)paren
suffix:semicolon
)brace
id|refindexlength
op_assign
l_int|1
suffix:semicolon
id|usREFIndex
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
id|usModeIDOffset
op_plus
l_int|0x04
)paren
)paren
suffix:semicolon
singleline_comment|// si+Ext_point
id|usREFIndex
op_increment
suffix:semicolon
id|temp
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
id|usREFIndex
)paren
)paren
suffix:semicolon
singleline_comment|// di =&gt; REFIndex
r_while
c_loop
(paren
id|temp
op_ne
l_int|0xFF
)paren
(brace
id|refindexlength
op_increment
suffix:semicolon
id|usREFIndex
op_increment
suffix:semicolon
id|temp
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
id|usREFIndex
)paren
)paren
suffix:semicolon
singleline_comment|// di =&gt; REFIndex
)brace
r_return
id|refindexlength
suffix:semicolon
)brace
DECL|function|SetInterlace
id|VOID
id|SetInterlace
c_func
(paren
id|ULONG
id|ROMAddr
comma
id|USHORT
id|ModeNo
)paren
(brace
id|ULONG
id|Temp
suffix:semicolon
id|USHORT
id|data
comma
id|Temp2
suffix:semicolon
id|Temp
op_assign
(paren
id|ULONG
)paren
id|GetReg1
c_func
(paren
id|P3d4
comma
l_int|0x01
)paren
suffix:semicolon
id|Temp
op_increment
suffix:semicolon
id|Temp
op_assign
id|Temp
op_star
l_int|8
suffix:semicolon
r_if
c_cond
(paren
id|Temp
op_eq
l_int|1024
)paren
(brace
id|data
op_assign
l_int|0x0035
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|Temp
op_eq
l_int|1280
)paren
(brace
id|data
op_assign
l_int|0x0048
suffix:semicolon
)brace
r_else
id|data
op_assign
l_int|0x0000
suffix:semicolon
id|Temp2
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
id|REFIndex
op_plus
l_int|0x00
)paren
)paren
suffix:semicolon
id|Temp2
op_and_assign
id|InterlaceMode
suffix:semicolon
r_if
c_cond
(paren
id|Temp2
op_eq
l_int|0
)paren
(brace
id|data
op_assign
l_int|0x0000
suffix:semicolon
)brace
id|SetReg1
c_func
(paren
id|P3d4
comma
l_int|0x19
comma
id|data
)paren
suffix:semicolon
id|Temp
op_assign
(paren
id|ULONG
)paren
id|GetReg1
c_func
(paren
id|P3d4
comma
l_int|0x1A
)paren
suffix:semicolon
id|Temp2
op_assign
(paren
id|USHORT
)paren
(paren
id|Temp
op_amp
l_int|0xFC
)paren
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3d4
comma
l_int|0x1A
comma
(paren
id|USHORT
)paren
id|Temp
)paren
suffix:semicolon
id|Temp
op_assign
(paren
id|ULONG
)paren
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x0f
)paren
suffix:semicolon
id|Temp2
op_assign
(paren
id|USHORT
)paren
id|Temp
op_amp
l_int|0xBF
suffix:semicolon
r_if
c_cond
(paren
id|ModeNo
op_eq
l_int|0x37
)paren
(brace
id|Temp2
op_assign
id|Temp2
op_or
l_int|0x40
suffix:semicolon
)brace
id|SetReg1
c_func
(paren
id|P3d4
comma
l_int|0x1A
comma
(paren
id|USHORT
)paren
id|Temp2
)paren
suffix:semicolon
)brace
DECL|function|SetCRT1FIFO
id|VOID
id|SetCRT1FIFO
c_func
(paren
id|ULONG
id|ROMAddr
)paren
(brace
id|USHORT
id|colorth
op_assign
l_int|0
comma
id|index
comma
id|data
comma
id|VCLK
comma
id|data2
comma
id|MCLKOffset
comma
id|MCLK
suffix:semicolon
id|USHORT
id|ah
comma
id|bl
comma
id|A
comma
id|B
suffix:semicolon
id|index
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
id|REFIndex
op_plus
l_int|0x03
)paren
)paren
suffix:semicolon
id|index
op_assign
id|index
op_amp
l_int|0x03F
suffix:semicolon
id|CRT1VCLKLen
op_assign
id|GetVCLKLen
c_func
(paren
id|ROMAddr
)paren
suffix:semicolon
id|data
op_assign
id|index
op_star
id|CRT1VCLKLen
suffix:semicolon
id|VCLKData
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
l_int|0x208
)paren
)paren
suffix:semicolon
id|VCLKData
op_assign
id|VCLKData
op_plus
id|data
op_plus
(paren
id|CRT1VCLKLen
op_minus
l_int|2
)paren
suffix:semicolon
id|VCLK
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
id|VCLKData
)paren
)paren
suffix:semicolon
singleline_comment|// Get VCLK
id|MCLKOffset
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
l_int|0x20C
)paren
)paren
suffix:semicolon
id|index
op_assign
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x3A
)paren
suffix:semicolon
id|index
op_assign
id|index
op_amp
l_int|07
suffix:semicolon
id|MCLKOffset
op_assign
id|MCLKOffset
op_plus
id|index
op_star
l_int|5
suffix:semicolon
id|MCLK
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
id|MCLKOffset
op_plus
l_int|0x03
)paren
)paren
suffix:semicolon
singleline_comment|// Get MCLK
id|data2
op_assign
id|ModeType
op_minus
l_int|0x02
suffix:semicolon
r_switch
c_cond
(paren
id|data2
)paren
(brace
r_case
l_int|0
suffix:colon
id|colorth
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|colorth
op_assign
l_int|2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|colorth
op_assign
l_int|4
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|colorth
op_assign
l_int|4
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
id|colorth
op_assign
l_int|6
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
id|colorth
op_assign
l_int|8
suffix:semicolon
r_break
suffix:semicolon
)brace
r_do
(brace
id|B
op_assign
(paren
id|CalcDelay
c_func
(paren
id|ROMAddr
comma
l_int|0
)paren
op_star
id|VCLK
op_star
id|colorth
)paren
suffix:semicolon
id|B
op_assign
id|B
op_div
(paren
l_int|16
op_star
id|MCLK
)paren
suffix:semicolon
id|B
op_increment
suffix:semicolon
id|A
op_assign
(paren
id|CalcDelay
c_func
(paren
id|ROMAddr
comma
l_int|1
)paren
op_star
id|VCLK
op_star
id|colorth
)paren
suffix:semicolon
id|A
op_assign
id|A
op_div
(paren
l_int|16
op_star
id|MCLK
)paren
suffix:semicolon
id|A
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|A
OL
l_int|4
)paren
(brace
id|A
op_assign
l_int|0
suffix:semicolon
)brace
r_else
id|A
op_assign
id|A
op_minus
l_int|4
suffix:semicolon
r_if
c_cond
(paren
id|A
OG
id|B
)paren
(brace
id|bl
op_assign
id|A
suffix:semicolon
)brace
r_else
id|bl
op_assign
id|B
suffix:semicolon
id|bl
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|bl
OG
l_int|0x13
)paren
(brace
id|data
op_assign
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x16
)paren
suffix:semicolon
id|data
op_assign
id|data
op_rshift
l_int|6
suffix:semicolon
r_if
c_cond
(paren
id|data
op_ne
l_int|0
)paren
(brace
id|data
op_decrement
suffix:semicolon
id|data
op_assign
id|data
op_lshift
l_int|6
suffix:semicolon
id|data2
op_assign
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x16
)paren
suffix:semicolon
id|data2
op_assign
(paren
id|data2
op_amp
l_int|0x3f
)paren
op_or
id|data
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x16
comma
id|data2
)paren
suffix:semicolon
)brace
r_else
id|bl
op_assign
l_int|0x13
suffix:semicolon
)brace
)brace
r_while
c_loop
(paren
id|bl
OG
l_int|0x13
)paren
(brace
suffix:semicolon
)brace
id|ah
op_assign
id|bl
suffix:semicolon
id|ah
op_assign
id|ah
op_lshift
l_int|4
suffix:semicolon
id|ah
op_assign
id|ah
op_or
l_int|0x0f
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x08
comma
id|ah
)paren
suffix:semicolon
id|data
op_assign
id|bl
suffix:semicolon
id|data
op_assign
id|data
op_amp
l_int|0x10
suffix:semicolon
id|data
op_assign
id|data
op_lshift
l_int|1
suffix:semicolon
id|data2
op_assign
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x0F
)paren
suffix:semicolon
id|data2
op_assign
id|data2
op_amp
l_int|0x9f
suffix:semicolon
id|data2
op_assign
id|data2
op_or
id|data
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x0F
comma
id|data2
)paren
suffix:semicolon
id|data
op_assign
id|bl
op_plus
l_int|3
suffix:semicolon
r_if
c_cond
(paren
id|data
OG
l_int|0x0f
)paren
(brace
id|data
op_assign
l_int|0x0f
suffix:semicolon
)brace
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x3b
comma
l_int|0x00
)paren
suffix:semicolon
id|data2
op_assign
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x09
)paren
suffix:semicolon
id|data2
op_assign
id|data2
op_amp
l_int|0xF0
suffix:semicolon
id|data2
op_assign
id|data2
op_or
id|data
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x09
comma
id|data2
)paren
suffix:semicolon
)brace
DECL|function|CalcDelay
r_static
id|USHORT
id|CalcDelay
c_func
(paren
id|ULONG
id|ROMAddr
comma
id|USHORT
id|key
)paren
(brace
id|USHORT
id|data
comma
id|data2
comma
id|temp0
comma
id|temp1
suffix:semicolon
id|UCHAR
id|ThLowA
(braket
)braket
op_assign
initialization_block
suffix:semicolon
id|UCHAR
id|ThLowB
(braket
)braket
op_assign
initialization_block
suffix:semicolon
id|UCHAR
id|ThTiming
(braket
)braket
op_assign
(brace
l_int|1
comma
l_int|2
comma
l_int|2
comma
l_int|3
comma
l_int|0
comma
l_int|1
comma
l_int|1
comma
l_int|2
)brace
suffix:semicolon
id|data
op_assign
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x16
)paren
suffix:semicolon
id|data
op_assign
id|data
op_rshift
l_int|6
suffix:semicolon
id|data2
op_assign
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x14
)paren
suffix:semicolon
id|data2
op_assign
(paren
id|data2
op_rshift
l_int|4
)paren
op_amp
l_int|0x0C
suffix:semicolon
id|data
op_assign
id|data
op_or
id|data2
suffix:semicolon
id|data
op_assign
id|data
OL
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|key
op_eq
l_int|0
)paren
(brace
id|temp0
op_assign
(paren
id|USHORT
)paren
id|ThLowA
(braket
id|data
)braket
suffix:semicolon
id|temp1
op_assign
(paren
id|USHORT
)paren
id|ThLowA
(braket
id|data
op_plus
l_int|1
)braket
suffix:semicolon
)brace
r_else
(brace
id|temp0
op_assign
(paren
id|USHORT
)paren
id|ThLowB
(braket
id|data
)braket
suffix:semicolon
id|temp1
op_assign
(paren
id|USHORT
)paren
id|ThLowB
(braket
id|data
op_plus
l_int|1
)braket
suffix:semicolon
)brace
id|data2
op_assign
l_int|0
suffix:semicolon
id|data
op_assign
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x18
)paren
suffix:semicolon
r_if
c_cond
(paren
id|data
op_amp
l_int|0x02
)paren
(brace
id|data2
op_assign
id|data2
op_or
l_int|0x01
suffix:semicolon
)brace
r_if
c_cond
(paren
id|data
op_amp
l_int|0x20
)paren
(brace
id|data2
op_assign
id|data2
op_or
l_int|0x02
suffix:semicolon
)brace
r_if
c_cond
(paren
id|data
op_amp
l_int|0x40
)paren
(brace
id|data2
op_assign
id|data2
op_or
l_int|0x04
suffix:semicolon
)brace
id|data
op_assign
id|temp1
op_star
id|ThTiming
(braket
id|data2
)braket
op_plus
id|temp0
suffix:semicolon
r_return
id|data
suffix:semicolon
)brace
DECL|function|SetCRT1FIFO2
id|VOID
id|SetCRT1FIFO2
c_func
(paren
id|ULONG
id|ROMAddr
)paren
(brace
id|USHORT
id|colorth
op_assign
l_int|0
comma
id|index
comma
id|data
comma
id|VCLK
comma
id|data2
comma
id|MCLKOffset
comma
id|MCLK
suffix:semicolon
id|USHORT
id|ah
comma
id|bl
comma
id|B
suffix:semicolon
id|ULONG
id|eax
suffix:semicolon
id|index
op_assign
op_star
(paren
(paren
id|UCHAR
op_star
)paren
(paren
id|ROMAddr
op_plus
id|REFIndex
op_plus
l_int|0x03
)paren
)paren
suffix:semicolon
id|index
op_assign
id|index
op_amp
l_int|0x03F
suffix:semicolon
id|CRT1VCLKLen
op_assign
id|GetVCLKLen
c_func
(paren
id|ROMAddr
)paren
suffix:semicolon
id|data
op_assign
id|index
op_star
id|CRT1VCLKLen
suffix:semicolon
id|VCLKData
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
l_int|0x208
)paren
)paren
suffix:semicolon
id|VCLKData
op_assign
id|VCLKData
op_plus
id|data
op_plus
(paren
id|CRT1VCLKLen
op_minus
l_int|2
)paren
suffix:semicolon
id|VCLK
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
id|VCLKData
)paren
)paren
suffix:semicolon
singleline_comment|// Get VCLK
id|MCLKOffset
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
l_int|0x20C
)paren
)paren
suffix:semicolon
id|index
op_assign
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x1A
)paren
suffix:semicolon
id|index
op_assign
id|index
op_amp
l_int|07
suffix:semicolon
id|MCLKOffset
op_assign
id|MCLKOffset
op_plus
id|index
op_star
l_int|5
suffix:semicolon
id|MCLK
op_assign
op_star
(paren
(paren
id|USHORT
op_star
)paren
(paren
id|ROMAddr
op_plus
id|MCLKOffset
op_plus
l_int|0x03
)paren
)paren
suffix:semicolon
singleline_comment|// Get MCLK  
id|data2
op_assign
id|ModeType
op_minus
l_int|0x02
suffix:semicolon
r_switch
c_cond
(paren
id|data2
)paren
(brace
r_case
l_int|0
suffix:colon
id|colorth
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|colorth
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|colorth
op_assign
l_int|2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|colorth
op_assign
l_int|2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
id|colorth
op_assign
l_int|3
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
id|colorth
op_assign
l_int|4
suffix:semicolon
r_break
suffix:semicolon
)brace
r_do
(brace
id|B
op_assign
(paren
id|CalcDelay2
c_func
(paren
id|ROMAddr
comma
l_int|0
)paren
op_star
id|VCLK
op_star
id|colorth
)paren
suffix:semicolon
r_if
c_cond
(paren
id|B
op_mod
(paren
l_int|16
op_star
id|MCLK
)paren
op_eq
l_int|0
)paren
(brace
id|B
op_assign
id|B
op_div
(paren
l_int|16
op_star
id|MCLK
)paren
suffix:semicolon
id|bl
op_assign
id|B
op_plus
l_int|1
suffix:semicolon
)brace
r_else
(brace
id|B
op_assign
id|B
op_div
(paren
l_int|16
op_star
id|MCLK
)paren
suffix:semicolon
id|bl
op_assign
id|B
op_plus
l_int|2
suffix:semicolon
)brace
r_if
c_cond
(paren
id|bl
OG
l_int|0x13
)paren
(brace
id|data
op_assign
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x15
)paren
suffix:semicolon
id|data
op_assign
id|data
op_amp
l_int|0xf0
suffix:semicolon
r_if
c_cond
(paren
id|data
op_ne
l_int|0xb0
)paren
(brace
id|data
op_assign
id|data
op_plus
l_int|0x20
suffix:semicolon
r_if
c_cond
(paren
id|data
op_eq
l_int|0xa0
)paren
(brace
id|data
op_assign
l_int|0x30
suffix:semicolon
)brace
id|data2
op_assign
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x15
)paren
suffix:semicolon
id|data2
op_assign
(paren
id|data2
op_amp
l_int|0x0f
)paren
op_or
id|data
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x15
comma
id|data2
)paren
suffix:semicolon
)brace
r_else
id|bl
op_assign
l_int|0x13
suffix:semicolon
)brace
)brace
r_while
c_loop
(paren
id|bl
OG
l_int|0x13
)paren
(brace
suffix:semicolon
)brace
id|data2
op_assign
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x15
)paren
suffix:semicolon
id|data2
op_assign
(paren
id|data2
op_amp
l_int|0xf0
)paren
op_rshift
l_int|4
suffix:semicolon
id|data2
op_assign
id|data2
op_lshift
l_int|24
suffix:semicolon
id|SetReg4
c_func
(paren
l_int|0xcf8
comma
l_int|0x80000050
)paren
suffix:semicolon
id|eax
op_assign
id|GetReg3
c_func
(paren
l_int|0xcfc
)paren
suffix:semicolon
id|eax
op_assign
id|eax
op_amp
l_int|0x0f0ffffff
suffix:semicolon
id|eax
op_assign
id|eax
op_or
id|data2
suffix:semicolon
id|SetReg4
c_func
(paren
l_int|0xcfc
comma
id|eax
)paren
suffix:semicolon
id|ah
op_assign
id|bl
suffix:semicolon
id|ah
op_assign
id|ah
op_lshift
l_int|4
suffix:semicolon
id|ah
op_assign
id|ah
op_or
l_int|0x0f
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x08
comma
id|ah
)paren
suffix:semicolon
id|data
op_assign
id|bl
suffix:semicolon
id|data
op_assign
id|data
op_amp
l_int|0x10
suffix:semicolon
id|data
op_assign
id|data
op_lshift
l_int|1
suffix:semicolon
id|data2
op_assign
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x0F
)paren
suffix:semicolon
id|data2
op_assign
id|data2
op_amp
l_int|0x9f
suffix:semicolon
id|data2
op_assign
id|data2
op_or
id|data
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x0F
comma
id|data2
)paren
suffix:semicolon
id|data
op_assign
id|bl
op_plus
l_int|3
suffix:semicolon
r_if
c_cond
(paren
id|data
OG
l_int|0x0f
)paren
(brace
id|data
op_assign
l_int|0x0f
suffix:semicolon
)brace
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x3b
comma
l_int|0x00
)paren
suffix:semicolon
id|data2
op_assign
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x09
)paren
suffix:semicolon
id|data2
op_assign
id|data2
op_amp
l_int|0xF0
suffix:semicolon
id|data2
op_assign
id|data2
op_or
id|data
suffix:semicolon
id|SetReg1
c_func
(paren
id|P3c4
comma
l_int|0x09
comma
id|data2
)paren
suffix:semicolon
)brace
DECL|function|CalcDelay2
id|USHORT
id|CalcDelay2
c_func
(paren
id|ULONG
id|ROMAddr
comma
id|USHORT
id|key
)paren
(brace
id|USHORT
id|data
comma
id|index
suffix:semicolon
id|UCHAR
id|LatencyFactor
(braket
)braket
op_assign
initialization_block
suffix:semicolon
id|index
op_assign
l_int|0
suffix:semicolon
id|data
op_assign
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x14
)paren
suffix:semicolon
r_if
c_cond
(paren
id|data
op_amp
l_int|0x80
)paren
(brace
id|index
op_assign
id|index
op_plus
l_int|12
suffix:semicolon
)brace
id|data
op_assign
id|GetReg1
c_func
(paren
id|P3c4
comma
l_int|0x15
)paren
suffix:semicolon
id|data
op_assign
(paren
id|data
op_amp
l_int|0xf0
)paren
op_rshift
l_int|4
suffix:semicolon
r_if
c_cond
(paren
id|data
op_amp
l_int|0x01
)paren
(brace
id|index
op_assign
id|index
op_plus
l_int|6
suffix:semicolon
)brace
id|data
op_assign
id|data
op_rshift
l_int|1
suffix:semicolon
id|index
op_assign
id|index
op_plus
id|data
suffix:semicolon
id|data
op_assign
id|LatencyFactor
(braket
id|index
)braket
suffix:semicolon
r_return
id|data
suffix:semicolon
)brace
macro_line|#endif /* CONFIG_FB_SIS_LINUXBIOS */
eof
