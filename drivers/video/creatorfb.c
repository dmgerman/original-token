multiline_comment|/* $Id: creatorfb.c,v 1.32 2000/07/26 23:02:51 davem Exp $&n; * creatorfb.c: Creator/Creator3D frame buffer driver&n; *&n; * Copyright (C) 1997,1998,1999 Jakub Jelinek (jj@ultra.linux.cz)&n; */
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/errno.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/tty.h&gt;
macro_line|#include &lt;linux/malloc.h&gt;
macro_line|#include &lt;linux/vmalloc.h&gt;
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/interrupt.h&gt;
macro_line|#include &lt;linux/fb.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/selection.h&gt;
macro_line|#include &lt;video/sbusfb.h&gt;
macro_line|#include &lt;asm/upa.h&gt;
DECL|macro|FFB_SFB8R_VOFF
mdefine_line|#define&t;FFB_SFB8R_VOFF&t;&t;0x00000000
DECL|macro|FFB_SFB8G_VOFF
mdefine_line|#define&t;FFB_SFB8G_VOFF&t;&t;0x00400000
DECL|macro|FFB_SFB8B_VOFF
mdefine_line|#define&t;FFB_SFB8B_VOFF&t;&t;0x00800000
DECL|macro|FFB_SFB8X_VOFF
mdefine_line|#define&t;FFB_SFB8X_VOFF&t;&t;0x00c00000
DECL|macro|FFB_SFB32_VOFF
mdefine_line|#define&t;FFB_SFB32_VOFF&t;&t;0x01000000
DECL|macro|FFB_SFB64_VOFF
mdefine_line|#define&t;FFB_SFB64_VOFF&t;&t;0x02000000
DECL|macro|FFB_FBC_REGS_VOFF
mdefine_line|#define&t;FFB_FBC_REGS_VOFF&t;0x04000000
DECL|macro|FFB_BM_FBC_REGS_VOFF
mdefine_line|#define&t;FFB_BM_FBC_REGS_VOFF&t;0x04002000
DECL|macro|FFB_DFB8R_VOFF
mdefine_line|#define&t;FFB_DFB8R_VOFF&t;&t;0x04004000
DECL|macro|FFB_DFB8G_VOFF
mdefine_line|#define&t;FFB_DFB8G_VOFF&t;&t;0x04404000
DECL|macro|FFB_DFB8B_VOFF
mdefine_line|#define&t;FFB_DFB8B_VOFF&t;&t;0x04804000
DECL|macro|FFB_DFB8X_VOFF
mdefine_line|#define&t;FFB_DFB8X_VOFF&t;&t;0x04c04000
DECL|macro|FFB_DFB24_VOFF
mdefine_line|#define&t;FFB_DFB24_VOFF&t;&t;0x05004000
DECL|macro|FFB_DFB32_VOFF
mdefine_line|#define&t;FFB_DFB32_VOFF&t;&t;0x06004000
DECL|macro|FFB_DFB422A_VOFF
mdefine_line|#define&t;FFB_DFB422A_VOFF&t;0x07004000&t;/* DFB 422 mode write to A */
DECL|macro|FFB_DFB422AD_VOFF
mdefine_line|#define&t;FFB_DFB422AD_VOFF&t;0x07804000&t;/* DFB 422 mode with line doubling */
DECL|macro|FFB_DFB24B_VOFF
mdefine_line|#define&t;FFB_DFB24B_VOFF&t;&t;0x08004000&t;/* DFB 24bit mode write to B */
DECL|macro|FFB_DFB422B_VOFF
mdefine_line|#define&t;FFB_DFB422B_VOFF&t;0x09004000&t;/* DFB 422 mode write to B */
DECL|macro|FFB_DFB422BD_VOFF
mdefine_line|#define&t;FFB_DFB422BD_VOFF&t;0x09804000&t;/* DFB 422 mode with line doubling */
DECL|macro|FFB_SFB16Z_VOFF
mdefine_line|#define&t;FFB_SFB16Z_VOFF&t;&t;0x0a004000&t;/* 16bit mode Z planes */
DECL|macro|FFB_SFB8Z_VOFF
mdefine_line|#define&t;FFB_SFB8Z_VOFF&t;&t;0x0a404000&t;/* 8bit mode Z planes */
DECL|macro|FFB_SFB422_VOFF
mdefine_line|#define&t;FFB_SFB422_VOFF&t;&t;0x0ac04000&t;/* SFB 422 mode write to A/B */
DECL|macro|FFB_SFB422D_VOFF
mdefine_line|#define&t;FFB_SFB422D_VOFF&t;0x0b404000&t;/* SFB 422 mode with line doubling */
DECL|macro|FFB_FBC_KREGS_VOFF
mdefine_line|#define&t;FFB_FBC_KREGS_VOFF&t;0x0bc04000
DECL|macro|FFB_DAC_VOFF
mdefine_line|#define&t;FFB_DAC_VOFF&t;&t;0x0bc06000
DECL|macro|FFB_PROM_VOFF
mdefine_line|#define&t;FFB_PROM_VOFF&t;&t;0x0bc08000
DECL|macro|FFB_EXP_VOFF
mdefine_line|#define&t;FFB_EXP_VOFF&t;&t;0x0bc18000
DECL|macro|FFB_SFB8R_POFF
mdefine_line|#define&t;FFB_SFB8R_POFF&t;&t;0x04000000UL
DECL|macro|FFB_SFB8G_POFF
mdefine_line|#define&t;FFB_SFB8G_POFF&t;&t;0x04400000UL
DECL|macro|FFB_SFB8B_POFF
mdefine_line|#define&t;FFB_SFB8B_POFF&t;&t;0x04800000UL
DECL|macro|FFB_SFB8X_POFF
mdefine_line|#define&t;FFB_SFB8X_POFF&t;&t;0x04c00000UL
DECL|macro|FFB_SFB32_POFF
mdefine_line|#define&t;FFB_SFB32_POFF&t;&t;0x05000000UL
DECL|macro|FFB_SFB64_POFF
mdefine_line|#define&t;FFB_SFB64_POFF&t;&t;0x06000000UL
DECL|macro|FFB_FBC_REGS_POFF
mdefine_line|#define&t;FFB_FBC_REGS_POFF&t;0x00600000UL
DECL|macro|FFB_BM_FBC_REGS_POFF
mdefine_line|#define&t;FFB_BM_FBC_REGS_POFF&t;0x00600000UL
DECL|macro|FFB_DFB8R_POFF
mdefine_line|#define&t;FFB_DFB8R_POFF&t;&t;0x01000000UL
DECL|macro|FFB_DFB8G_POFF
mdefine_line|#define&t;FFB_DFB8G_POFF&t;&t;0x01400000UL
DECL|macro|FFB_DFB8B_POFF
mdefine_line|#define&t;FFB_DFB8B_POFF&t;&t;0x01800000UL
DECL|macro|FFB_DFB8X_POFF
mdefine_line|#define&t;FFB_DFB8X_POFF&t;&t;0x01c00000UL
DECL|macro|FFB_DFB24_POFF
mdefine_line|#define&t;FFB_DFB24_POFF&t;&t;0x02000000UL
DECL|macro|FFB_DFB32_POFF
mdefine_line|#define&t;FFB_DFB32_POFF&t;&t;0x03000000UL
DECL|macro|FFB_FBC_KREGS_POFF
mdefine_line|#define&t;FFB_FBC_KREGS_POFF&t;0x00610000UL
DECL|macro|FFB_DAC_POFF
mdefine_line|#define&t;FFB_DAC_POFF&t;&t;0x00400000UL
DECL|macro|FFB_PROM_POFF
mdefine_line|#define&t;FFB_PROM_POFF&t;&t;0x00000000UL
DECL|macro|FFB_EXP_POFF
mdefine_line|#define&t;FFB_EXP_POFF&t;&t;0x00200000UL
multiline_comment|/* Draw operations */
DECL|macro|FFB_DRAWOP_DOT
mdefine_line|#define FFB_DRAWOP_DOT&t;&t;0x00
DECL|macro|FFB_DRAWOP_AADOT
mdefine_line|#define FFB_DRAWOP_AADOT&t;0x01
DECL|macro|FFB_DRAWOP_BRLINECAP
mdefine_line|#define FFB_DRAWOP_BRLINECAP&t;0x02
DECL|macro|FFB_DRAWOP_BRLINEOPEN
mdefine_line|#define FFB_DRAWOP_BRLINEOPEN&t;0x03
DECL|macro|FFB_DRAWOP_DDLINE
mdefine_line|#define FFB_DRAWOP_DDLINE&t;0x04
DECL|macro|FFB_DRAWOP_AALINE
mdefine_line|#define FFB_DRAWOP_AALINE&t;0x05
DECL|macro|FFB_DRAWOP_TRIANGLE
mdefine_line|#define FFB_DRAWOP_TRIANGLE&t;0x06
DECL|macro|FFB_DRAWOP_POLYGON
mdefine_line|#define FFB_DRAWOP_POLYGON&t;0x07
DECL|macro|FFB_DRAWOP_RECTANGLE
mdefine_line|#define FFB_DRAWOP_RECTANGLE&t;0x08
DECL|macro|FFB_DRAWOP_FASTFILL
mdefine_line|#define FFB_DRAWOP_FASTFILL&t;0x09
DECL|macro|FFB_DRAWOP_BCOPY
mdefine_line|#define FFB_DRAWOP_BCOPY&t;0x0a
DECL|macro|FFB_DRAWOP_VSCROLL
mdefine_line|#define FFB_DRAWOP_VSCROLL&t;0x0b
multiline_comment|/* Pixel processor control */
multiline_comment|/* Force WID */
DECL|macro|FFB_PPC_FW_DISABLE
mdefine_line|#define FFB_PPC_FW_DISABLE&t;0x800000
DECL|macro|FFB_PPC_FW_ENABLE
mdefine_line|#define FFB_PPC_FW_ENABLE&t;0xc00000
multiline_comment|/* Auxiliary clip */
DECL|macro|FFB_PPC_ACE_DISABLE
mdefine_line|#define FFB_PPC_ACE_DISABLE&t;0x040000
DECL|macro|FFB_PPC_ACE_AUX_SUB
mdefine_line|#define FFB_PPC_ACE_AUX_SUB&t;0x080000
DECL|macro|FFB_PPC_ACE_AUX_ADD
mdefine_line|#define FFB_PPC_ACE_AUX_ADD&t;0x0c0000
multiline_comment|/* Depth cue */
DECL|macro|FFB_PPC_DCE_DISABLE
mdefine_line|#define FFB_PPC_DCE_DISABLE&t;0x020000
DECL|macro|FFB_PPC_DCE_ENABLE
mdefine_line|#define FFB_PPC_DCE_ENABLE&t;0x030000
multiline_comment|/* Alpha blend */
DECL|macro|FFB_PPC_ABE_DISABLE
mdefine_line|#define FFB_PPC_ABE_DISABLE&t;0x008000
DECL|macro|FFB_PPC_ABE_ENABLE
mdefine_line|#define FFB_PPC_ABE_ENABLE&t;0x00c000
multiline_comment|/* View clip */
DECL|macro|FFB_PPC_VCE_DISABLE
mdefine_line|#define FFB_PPC_VCE_DISABLE&t;0x001000
DECL|macro|FFB_PPC_VCE_2D
mdefine_line|#define FFB_PPC_VCE_2D&t;&t;0x002000
DECL|macro|FFB_PPC_VCE_3D
mdefine_line|#define FFB_PPC_VCE_3D&t;&t;0x003000
multiline_comment|/* Area pattern */
DECL|macro|FFB_PPC_APE_DISABLE
mdefine_line|#define FFB_PPC_APE_DISABLE&t;0x000800
DECL|macro|FFB_PPC_APE_ENABLE
mdefine_line|#define FFB_PPC_APE_ENABLE&t;0x000c00
multiline_comment|/* Transparent background */
DECL|macro|FFB_PPC_TBE_OPAQUE
mdefine_line|#define FFB_PPC_TBE_OPAQUE&t;0x000200
DECL|macro|FFB_PPC_TBE_TRANSPARENT
mdefine_line|#define FFB_PPC_TBE_TRANSPARENT&t;0x000300
multiline_comment|/* Z source */
DECL|macro|FFB_PPC_ZS_VAR
mdefine_line|#define FFB_PPC_ZS_VAR&t;&t;0x000080
DECL|macro|FFB_PPC_ZS_CONST
mdefine_line|#define FFB_PPC_ZS_CONST&t;0x0000c0
multiline_comment|/* Y source */
DECL|macro|FFB_PPC_YS_VAR
mdefine_line|#define FFB_PPC_YS_VAR&t;&t;0x000020
DECL|macro|FFB_PPC_YS_CONST
mdefine_line|#define FFB_PPC_YS_CONST&t;0x000030
multiline_comment|/* X source */
DECL|macro|FFB_PPC_XS_WID
mdefine_line|#define FFB_PPC_XS_WID&t;&t;0x000004
DECL|macro|FFB_PPC_XS_VAR
mdefine_line|#define FFB_PPC_XS_VAR&t;&t;0x000008
DECL|macro|FFB_PPC_XS_CONST
mdefine_line|#define FFB_PPC_XS_CONST&t;0x00000c
multiline_comment|/* Color (BGR) source */
DECL|macro|FFB_PPC_CS_VAR
mdefine_line|#define FFB_PPC_CS_VAR&t;&t;0x000002
DECL|macro|FFB_PPC_CS_CONST
mdefine_line|#define FFB_PPC_CS_CONST&t;0x000003
DECL|macro|FFB_ROP_NEW
mdefine_line|#define FFB_ROP_NEW                  0x83
DECL|macro|FFB_UCSR_FIFO_MASK
mdefine_line|#define FFB_UCSR_FIFO_MASK     0x00000fff
DECL|macro|FFB_UCSR_FB_BUSY
mdefine_line|#define FFB_UCSR_FB_BUSY       0x01000000
DECL|macro|FFB_UCSR_RP_BUSY
mdefine_line|#define FFB_UCSR_RP_BUSY       0x02000000
DECL|macro|FFB_UCSR_ALL_BUSY
mdefine_line|#define FFB_UCSR_ALL_BUSY      (FFB_UCSR_RP_BUSY|FFB_UCSR_FB_BUSY)
DECL|macro|FFB_UCSR_READ_ERR
mdefine_line|#define FFB_UCSR_READ_ERR      0x40000000
DECL|macro|FFB_UCSR_FIFO_OVFL
mdefine_line|#define FFB_UCSR_FIFO_OVFL     0x80000000
DECL|macro|FFB_UCSR_ALL_ERRORS
mdefine_line|#define FFB_UCSR_ALL_ERRORS    (FFB_UCSR_READ_ERR|FFB_UCSR_FIFO_OVFL)
DECL|struct|ffb_fbc
r_struct
id|ffb_fbc
(brace
multiline_comment|/* Next vertex registers */
DECL|member|xxx1
id|u32
id|xxx1
(braket
l_int|3
)braket
suffix:semicolon
DECL|member|alpha
r_volatile
id|u32
id|alpha
suffix:semicolon
DECL|member|red
r_volatile
id|u32
id|red
suffix:semicolon
DECL|member|green
r_volatile
id|u32
id|green
suffix:semicolon
DECL|member|blue
r_volatile
id|u32
id|blue
suffix:semicolon
DECL|member|depth
r_volatile
id|u32
id|depth
suffix:semicolon
DECL|member|y
r_volatile
id|u32
id|y
suffix:semicolon
DECL|member|x
r_volatile
id|u32
id|x
suffix:semicolon
DECL|member|xxx2
id|u32
id|xxx2
(braket
l_int|2
)braket
suffix:semicolon
DECL|member|ryf
r_volatile
id|u32
id|ryf
suffix:semicolon
DECL|member|rxf
r_volatile
id|u32
id|rxf
suffix:semicolon
DECL|member|xxx3
id|u32
id|xxx3
(braket
l_int|2
)braket
suffix:semicolon
DECL|member|dmyf
r_volatile
id|u32
id|dmyf
suffix:semicolon
DECL|member|dmxf
r_volatile
id|u32
id|dmxf
suffix:semicolon
DECL|member|xxx4
id|u32
id|xxx4
(braket
l_int|2
)braket
suffix:semicolon
DECL|member|ebyi
r_volatile
id|u32
id|ebyi
suffix:semicolon
DECL|member|ebxi
r_volatile
id|u32
id|ebxi
suffix:semicolon
DECL|member|xxx5
id|u32
id|xxx5
(braket
l_int|2
)braket
suffix:semicolon
DECL|member|by
r_volatile
id|u32
id|by
suffix:semicolon
DECL|member|bx
r_volatile
id|u32
id|bx
suffix:semicolon
DECL|member|dy
id|u32
id|dy
suffix:semicolon
DECL|member|dx
id|u32
id|dx
suffix:semicolon
DECL|member|bh
r_volatile
id|u32
id|bh
suffix:semicolon
DECL|member|bw
r_volatile
id|u32
id|bw
suffix:semicolon
DECL|member|xxx6
id|u32
id|xxx6
(braket
l_int|2
)braket
suffix:semicolon
DECL|member|xxx7
id|u32
id|xxx7
(braket
l_int|32
)braket
suffix:semicolon
multiline_comment|/* Setup unit vertex state register */
DECL|member|suvtx
r_volatile
id|u32
id|suvtx
suffix:semicolon
DECL|member|xxx8
id|u32
id|xxx8
(braket
l_int|63
)braket
suffix:semicolon
multiline_comment|/* Control registers */
DECL|member|ppc
r_volatile
id|u32
id|ppc
suffix:semicolon
DECL|member|wid
r_volatile
id|u32
id|wid
suffix:semicolon
DECL|member|fg
r_volatile
id|u32
id|fg
suffix:semicolon
DECL|member|bg
r_volatile
id|u32
id|bg
suffix:semicolon
DECL|member|consty
r_volatile
id|u32
id|consty
suffix:semicolon
DECL|member|constz
r_volatile
id|u32
id|constz
suffix:semicolon
DECL|member|xclip
r_volatile
id|u32
id|xclip
suffix:semicolon
DECL|member|dcss
r_volatile
id|u32
id|dcss
suffix:semicolon
DECL|member|vclipmin
r_volatile
id|u32
id|vclipmin
suffix:semicolon
DECL|member|vclipmax
r_volatile
id|u32
id|vclipmax
suffix:semicolon
DECL|member|vclipzmin
r_volatile
id|u32
id|vclipzmin
suffix:semicolon
DECL|member|vclipzmax
r_volatile
id|u32
id|vclipzmax
suffix:semicolon
DECL|member|dcsf
r_volatile
id|u32
id|dcsf
suffix:semicolon
DECL|member|dcsb
r_volatile
id|u32
id|dcsb
suffix:semicolon
DECL|member|dczf
r_volatile
id|u32
id|dczf
suffix:semicolon
DECL|member|dczb
r_volatile
id|u32
id|dczb
suffix:semicolon
DECL|member|xxx9
id|u32
id|xxx9
suffix:semicolon
DECL|member|blendc
r_volatile
id|u32
id|blendc
suffix:semicolon
DECL|member|blendc1
r_volatile
id|u32
id|blendc1
suffix:semicolon
DECL|member|blendc2
r_volatile
id|u32
id|blendc2
suffix:semicolon
DECL|member|fbramitc
r_volatile
id|u32
id|fbramitc
suffix:semicolon
DECL|member|fbc
r_volatile
id|u32
id|fbc
suffix:semicolon
DECL|member|rop
r_volatile
id|u32
id|rop
suffix:semicolon
DECL|member|cmp
r_volatile
id|u32
id|cmp
suffix:semicolon
DECL|member|matchab
r_volatile
id|u32
id|matchab
suffix:semicolon
DECL|member|matchc
r_volatile
id|u32
id|matchc
suffix:semicolon
DECL|member|magnab
r_volatile
id|u32
id|magnab
suffix:semicolon
DECL|member|magnc
r_volatile
id|u32
id|magnc
suffix:semicolon
DECL|member|fbcfg0
r_volatile
id|u32
id|fbcfg0
suffix:semicolon
DECL|member|fbcfg1
r_volatile
id|u32
id|fbcfg1
suffix:semicolon
DECL|member|fbcfg2
r_volatile
id|u32
id|fbcfg2
suffix:semicolon
DECL|member|fbcfg3
r_volatile
id|u32
id|fbcfg3
suffix:semicolon
DECL|member|ppcfg
id|u32
id|ppcfg
suffix:semicolon
DECL|member|pick
r_volatile
id|u32
id|pick
suffix:semicolon
DECL|member|fillmode
r_volatile
id|u32
id|fillmode
suffix:semicolon
DECL|member|fbramwac
r_volatile
id|u32
id|fbramwac
suffix:semicolon
DECL|member|pmask
r_volatile
id|u32
id|pmask
suffix:semicolon
DECL|member|xpmask
r_volatile
id|u32
id|xpmask
suffix:semicolon
DECL|member|ypmask
r_volatile
id|u32
id|ypmask
suffix:semicolon
DECL|member|zpmask
r_volatile
id|u32
id|zpmask
suffix:semicolon
DECL|member|clip0min
r_volatile
id|u32
id|clip0min
suffix:semicolon
DECL|member|clip0max
r_volatile
id|u32
id|clip0max
suffix:semicolon
DECL|member|clip1min
r_volatile
id|u32
id|clip1min
suffix:semicolon
DECL|member|clip1max
r_volatile
id|u32
id|clip1max
suffix:semicolon
DECL|member|clip2min
r_volatile
id|u32
id|clip2min
suffix:semicolon
DECL|member|clip2max
r_volatile
id|u32
id|clip2max
suffix:semicolon
DECL|member|clip3min
r_volatile
id|u32
id|clip3min
suffix:semicolon
DECL|member|clip3max
r_volatile
id|u32
id|clip3max
suffix:semicolon
multiline_comment|/* New 3dRAM III support regs */
DECL|member|rawblend2
r_volatile
id|u32
id|rawblend2
suffix:semicolon
DECL|member|rawpreblend
r_volatile
id|u32
id|rawpreblend
suffix:semicolon
DECL|member|rawstencil
r_volatile
id|u32
id|rawstencil
suffix:semicolon
DECL|member|rawstencilctl
r_volatile
id|u32
id|rawstencilctl
suffix:semicolon
DECL|member|threedram1
r_volatile
id|u32
id|threedram1
suffix:semicolon
DECL|member|threedram2
r_volatile
id|u32
id|threedram2
suffix:semicolon
DECL|member|passin
r_volatile
id|u32
id|passin
suffix:semicolon
DECL|member|rawclrdepth
r_volatile
id|u32
id|rawclrdepth
suffix:semicolon
DECL|member|rawpmask
r_volatile
id|u32
id|rawpmask
suffix:semicolon
DECL|member|rawcsrc
r_volatile
id|u32
id|rawcsrc
suffix:semicolon
DECL|member|rawmatch
r_volatile
id|u32
id|rawmatch
suffix:semicolon
DECL|member|rawmagn
r_volatile
id|u32
id|rawmagn
suffix:semicolon
DECL|member|rawropblend
r_volatile
id|u32
id|rawropblend
suffix:semicolon
DECL|member|rawcmp
r_volatile
id|u32
id|rawcmp
suffix:semicolon
DECL|member|rawwac
r_volatile
id|u32
id|rawwac
suffix:semicolon
DECL|member|fbramid
r_volatile
id|u32
id|fbramid
suffix:semicolon
DECL|member|drawop
r_volatile
id|u32
id|drawop
suffix:semicolon
DECL|member|xxx10
id|u32
id|xxx10
(braket
l_int|2
)braket
suffix:semicolon
DECL|member|fontlpat
r_volatile
id|u32
id|fontlpat
suffix:semicolon
DECL|member|xxx11
id|u32
id|xxx11
suffix:semicolon
DECL|member|fontxy
r_volatile
id|u32
id|fontxy
suffix:semicolon
DECL|member|fontw
r_volatile
id|u32
id|fontw
suffix:semicolon
DECL|member|fontinc
r_volatile
id|u32
id|fontinc
suffix:semicolon
DECL|member|font
r_volatile
id|u32
id|font
suffix:semicolon
DECL|member|xxx12
id|u32
id|xxx12
(braket
l_int|3
)braket
suffix:semicolon
DECL|member|blend2
r_volatile
id|u32
id|blend2
suffix:semicolon
DECL|member|preblend
r_volatile
id|u32
id|preblend
suffix:semicolon
DECL|member|stencil
r_volatile
id|u32
id|stencil
suffix:semicolon
DECL|member|stencilctl
r_volatile
id|u32
id|stencilctl
suffix:semicolon
DECL|member|xxx13
id|u32
id|xxx13
(braket
l_int|4
)braket
suffix:semicolon
DECL|member|dcss1
r_volatile
id|u32
id|dcss1
suffix:semicolon
DECL|member|dcss2
r_volatile
id|u32
id|dcss2
suffix:semicolon
DECL|member|dcss3
r_volatile
id|u32
id|dcss3
suffix:semicolon
DECL|member|widpmask
r_volatile
id|u32
id|widpmask
suffix:semicolon
DECL|member|dcs2
r_volatile
id|u32
id|dcs2
suffix:semicolon
DECL|member|dcs3
r_volatile
id|u32
id|dcs3
suffix:semicolon
DECL|member|dcs4
r_volatile
id|u32
id|dcs4
suffix:semicolon
DECL|member|xxx14
id|u32
id|xxx14
suffix:semicolon
DECL|member|dcd2
r_volatile
id|u32
id|dcd2
suffix:semicolon
DECL|member|dcd3
r_volatile
id|u32
id|dcd3
suffix:semicolon
DECL|member|dcd4
r_volatile
id|u32
id|dcd4
suffix:semicolon
DECL|member|xxx15
id|u32
id|xxx15
suffix:semicolon
DECL|member|pattern
r_volatile
id|u32
id|pattern
(braket
l_int|32
)braket
suffix:semicolon
DECL|member|xxx16
id|u32
id|xxx16
(braket
l_int|256
)braket
suffix:semicolon
DECL|member|devid
r_volatile
id|u32
id|devid
suffix:semicolon
DECL|member|xxx17
id|u32
id|xxx17
(braket
l_int|63
)braket
suffix:semicolon
DECL|member|ucsr
r_volatile
id|u32
id|ucsr
suffix:semicolon
DECL|member|xxx18
id|u32
id|xxx18
(braket
l_int|31
)braket
suffix:semicolon
DECL|member|mer
r_volatile
id|u32
id|mer
suffix:semicolon
)brace
suffix:semicolon
DECL|function|FFBFifo
r_static
id|__inline__
r_void
id|FFBFifo
c_func
(paren
r_struct
id|fb_info_sbusfb
op_star
id|fb
comma
r_int
id|n
)paren
(brace
r_struct
id|ffb_fbc
op_star
id|fbc
suffix:semicolon
r_int
id|cache
op_assign
id|fb-&gt;s.ffb.fifo_cache
suffix:semicolon
r_if
c_cond
(paren
id|cache
op_minus
id|n
OL
l_int|0
)paren
(brace
id|fbc
op_assign
id|fb-&gt;s.ffb.fbc
suffix:semicolon
r_do
(brace
id|cache
op_assign
(paren
id|upa_readl
c_func
(paren
op_amp
id|fbc-&gt;ucsr
)paren
op_amp
id|FFB_UCSR_FIFO_MASK
)paren
op_minus
l_int|8
suffix:semicolon
)brace
r_while
c_loop
(paren
id|cache
op_minus
id|n
OL
l_int|0
)paren
suffix:semicolon
)brace
id|fb-&gt;s.ffb.fifo_cache
op_assign
id|cache
op_minus
id|n
suffix:semicolon
)brace
DECL|function|FFBWait
r_static
id|__inline__
r_void
id|FFBWait
c_func
(paren
r_struct
id|ffb_fbc
op_star
id|ffb
)paren
(brace
r_int
id|limit
op_assign
l_int|10000
suffix:semicolon
r_do
(brace
r_if
c_cond
(paren
(paren
id|upa_readl
c_func
(paren
op_amp
id|ffb-&gt;ucsr
)paren
op_amp
id|FFB_UCSR_ALL_BUSY
)paren
op_eq
l_int|0
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
(paren
id|upa_readl
c_func
(paren
op_amp
id|ffb-&gt;ucsr
)paren
op_amp
id|FFB_UCSR_ALL_ERRORS
)paren
op_ne
l_int|0
)paren
(brace
id|upa_writel
c_func
(paren
id|FFB_UCSR_ALL_ERRORS
comma
op_amp
id|ffb-&gt;ucsr
)paren
suffix:semicolon
)brace
)brace
r_while
c_loop
(paren
op_decrement
id|limit
OG
l_int|0
)paren
(brace
suffix:semicolon
)brace
)brace
DECL|struct|ffb_dac
r_struct
id|ffb_dac
(brace
DECL|member|type
r_volatile
id|u32
id|type
suffix:semicolon
DECL|member|value
r_volatile
id|u32
id|value
suffix:semicolon
DECL|member|type2
r_volatile
id|u32
id|type2
suffix:semicolon
DECL|member|value2
r_volatile
id|u32
id|value2
suffix:semicolon
)brace
suffix:semicolon
DECL|variable|ffb_mmap_map
r_static
r_struct
id|sbus_mmap_map
id|ffb_mmap_map
(braket
)braket
op_assign
(brace
(brace
id|FFB_SFB8R_VOFF
comma
id|FFB_SFB8R_POFF
comma
l_int|0x0400000
)brace
comma
(brace
id|FFB_SFB8G_VOFF
comma
id|FFB_SFB8G_POFF
comma
l_int|0x0400000
)brace
comma
(brace
id|FFB_SFB8B_VOFF
comma
id|FFB_SFB8B_POFF
comma
l_int|0x0400000
)brace
comma
(brace
id|FFB_SFB8X_VOFF
comma
id|FFB_SFB8X_POFF
comma
l_int|0x0400000
)brace
comma
(brace
id|FFB_SFB32_VOFF
comma
id|FFB_SFB32_POFF
comma
l_int|0x1000000
)brace
comma
(brace
id|FFB_SFB64_VOFF
comma
id|FFB_SFB64_POFF
comma
l_int|0x2000000
)brace
comma
(brace
id|FFB_FBC_REGS_VOFF
comma
id|FFB_FBC_REGS_POFF
comma
l_int|0x0002000
)brace
comma
(brace
id|FFB_BM_FBC_REGS_VOFF
comma
id|FFB_BM_FBC_REGS_POFF
comma
l_int|0x0002000
)brace
comma
(brace
id|FFB_DFB8R_VOFF
comma
id|FFB_DFB8R_POFF
comma
l_int|0x0400000
)brace
comma
(brace
id|FFB_DFB8G_VOFF
comma
id|FFB_DFB8G_POFF
comma
l_int|0x0400000
)brace
comma
(brace
id|FFB_DFB8B_VOFF
comma
id|FFB_DFB8B_POFF
comma
l_int|0x0400000
)brace
comma
(brace
id|FFB_DFB8X_VOFF
comma
id|FFB_DFB8X_POFF
comma
l_int|0x0400000
)brace
comma
(brace
id|FFB_DFB24_VOFF
comma
id|FFB_DFB24_POFF
comma
l_int|0x1000000
)brace
comma
(brace
id|FFB_DFB32_VOFF
comma
id|FFB_DFB32_POFF
comma
l_int|0x1000000
)brace
comma
(brace
id|FFB_FBC_KREGS_VOFF
comma
id|FFB_FBC_KREGS_POFF
comma
l_int|0x0002000
)brace
comma
(brace
id|FFB_DAC_VOFF
comma
id|FFB_DAC_POFF
comma
l_int|0x0002000
)brace
comma
(brace
id|FFB_PROM_VOFF
comma
id|FFB_PROM_POFF
comma
l_int|0x0010000
)brace
comma
(brace
id|FFB_EXP_VOFF
comma
id|FFB_EXP_POFF
comma
l_int|0x0002000
)brace
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
)brace
)brace
suffix:semicolon
DECL|function|ffb_setup
r_static
r_void
id|ffb_setup
c_func
(paren
r_struct
id|display
op_star
id|p
)paren
(brace
id|p-&gt;next_line
op_assign
l_int|8192
suffix:semicolon
id|p-&gt;next_plane
op_assign
l_int|0
suffix:semicolon
)brace
DECL|function|ffb_clear
r_static
r_void
id|ffb_clear
c_func
(paren
r_struct
id|vc_data
op_star
id|conp
comma
r_struct
id|display
op_star
id|p
comma
r_int
id|sy
comma
r_int
id|sx
comma
r_int
id|height
comma
r_int
id|width
)paren
(brace
r_struct
id|fb_info_sbusfb
op_star
id|fb
op_assign
(paren
r_struct
id|fb_info_sbusfb
op_star
)paren
id|p-&gt;fb_info
suffix:semicolon
r_register
r_struct
id|ffb_fbc
op_star
id|fbc
op_assign
id|fb-&gt;s.ffb.fbc
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|u64
id|yx
comma
id|hw
suffix:semicolon
r_int
id|fg
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|fb-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|fg
op_assign
(paren
(paren
id|u32
op_star
)paren
id|p-&gt;dispsw_data
)paren
(braket
id|attr_bgcol_ec
c_func
(paren
id|p
comma
id|conp
)paren
)braket
suffix:semicolon
r_if
c_cond
(paren
id|fg
op_ne
id|fb-&gt;s.ffb.fg_cache
)paren
(brace
id|FFBFifo
c_func
(paren
id|fb
comma
l_int|5
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
id|fg
comma
op_amp
id|fbc-&gt;fg
)paren
suffix:semicolon
id|fb-&gt;s.ffb.fg_cache
op_assign
id|fg
suffix:semicolon
)brace
r_else
id|FFBFifo
c_func
(paren
id|fb
comma
l_int|4
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fontheightlog
c_func
(paren
id|p
)paren
)paren
(brace
id|yx
op_assign
(paren
id|u64
)paren
id|sy
op_lshift
(paren
id|fontheightlog
c_func
(paren
id|p
)paren
op_plus
l_int|32
)paren
suffix:semicolon
id|hw
op_assign
(paren
id|u64
)paren
id|height
op_lshift
(paren
id|fontheightlog
c_func
(paren
id|p
)paren
op_plus
l_int|32
)paren
suffix:semicolon
)brace
r_else
(brace
id|yx
op_assign
(paren
id|u64
)paren
(paren
id|sy
op_star
id|fontheight
c_func
(paren
id|p
)paren
)paren
op_lshift
l_int|32
suffix:semicolon
id|hw
op_assign
(paren
id|u64
)paren
(paren
id|height
op_star
id|fontheight
c_func
(paren
id|p
)paren
)paren
op_lshift
l_int|32
suffix:semicolon
)brace
r_if
c_cond
(paren
id|fontwidthlog
c_func
(paren
id|p
)paren
)paren
(brace
id|yx
op_add_assign
id|sx
op_lshift
id|fontwidthlog
c_func
(paren
id|p
)paren
suffix:semicolon
id|hw
op_add_assign
id|width
op_lshift
id|fontwidthlog
c_func
(paren
id|p
)paren
suffix:semicolon
)brace
r_else
(brace
id|yx
op_add_assign
id|sx
op_star
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
id|hw
op_add_assign
id|width
op_star
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
)brace
id|upa_writeq
c_func
(paren
id|yx
op_plus
id|fb-&gt;s.ffb.yx_margin
comma
op_amp
id|fbc-&gt;by
)paren
suffix:semicolon
id|upa_writeq
c_func
(paren
id|hw
comma
op_amp
id|fbc-&gt;bh
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|fb-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|ffb_fill
r_static
r_void
id|ffb_fill
c_func
(paren
r_struct
id|fb_info_sbusfb
op_star
id|fb
comma
r_struct
id|display
op_star
id|p
comma
r_int
id|s
comma
r_int
id|count
comma
r_int
r_int
op_star
id|boxes
)paren
(brace
r_register
r_struct
id|ffb_fbc
op_star
id|fbc
op_assign
id|fb-&gt;s.ffb.fbc
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|fg
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|fb-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|fg
op_assign
(paren
(paren
id|u32
op_star
)paren
id|p-&gt;dispsw_data
)paren
(braket
id|attr_bgcol
c_func
(paren
id|p
comma
id|s
)paren
)braket
suffix:semicolon
r_if
c_cond
(paren
id|fg
op_ne
id|fb-&gt;s.ffb.fg_cache
)paren
(brace
id|FFBFifo
c_func
(paren
id|fb
comma
l_int|1
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
id|fg
comma
op_amp
id|fbc-&gt;fg
)paren
suffix:semicolon
id|fb-&gt;s.ffb.fg_cache
op_assign
id|fg
suffix:semicolon
)brace
r_while
c_loop
(paren
id|count
op_decrement
OG
l_int|0
)paren
(brace
id|FFBFifo
c_func
(paren
id|fb
comma
l_int|4
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
id|boxes
(braket
l_int|1
)braket
comma
op_amp
id|fbc-&gt;by
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
id|boxes
(braket
l_int|0
)braket
comma
op_amp
id|fbc-&gt;bx
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
id|boxes
(braket
l_int|3
)braket
op_minus
id|boxes
(braket
l_int|1
)braket
comma
op_amp
id|fbc-&gt;bh
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
id|boxes
(braket
l_int|2
)braket
op_minus
id|boxes
(braket
l_int|0
)braket
comma
op_amp
id|fbc-&gt;bw
)paren
suffix:semicolon
id|boxes
op_add_assign
l_int|4
suffix:semicolon
)brace
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|fb-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|ffb_putc
r_static
r_void
id|ffb_putc
c_func
(paren
r_struct
id|vc_data
op_star
id|conp
comma
r_struct
id|display
op_star
id|p
comma
r_int
id|c
comma
r_int
id|yy
comma
r_int
id|xx
)paren
(brace
r_struct
id|fb_info_sbusfb
op_star
id|fb
op_assign
(paren
r_struct
id|fb_info_sbusfb
op_star
)paren
id|p-&gt;fb_info
suffix:semicolon
r_register
r_struct
id|ffb_fbc
op_star
id|fbc
op_assign
id|fb-&gt;s.ffb.fbc
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|i
comma
id|xy
suffix:semicolon
id|u8
op_star
id|fd
suffix:semicolon
id|u64
id|fgbg
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|fb-&gt;lock
comma
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fontheightlog
c_func
(paren
id|p
)paren
)paren
(brace
id|xy
op_assign
(paren
id|yy
op_lshift
(paren
l_int|16
op_plus
id|fontheightlog
c_func
(paren
id|p
)paren
)paren
)paren
suffix:semicolon
id|i
op_assign
(paren
(paren
id|c
op_amp
id|p-&gt;charmask
)paren
op_lshift
id|fontheightlog
c_func
(paren
id|p
)paren
)paren
suffix:semicolon
)brace
r_else
(brace
id|xy
op_assign
(paren
(paren
id|yy
op_star
id|fontheight
c_func
(paren
id|p
)paren
)paren
op_lshift
l_int|16
)paren
suffix:semicolon
id|i
op_assign
(paren
id|c
op_amp
id|p-&gt;charmask
)paren
op_star
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|fontwidth
c_func
(paren
id|p
)paren
op_le
l_int|8
)paren
id|fd
op_assign
id|p-&gt;fontdata
op_plus
id|i
suffix:semicolon
r_else
id|fd
op_assign
id|p-&gt;fontdata
op_plus
(paren
id|i
op_lshift
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fontwidthlog
c_func
(paren
id|p
)paren
)paren
id|xy
op_add_assign
(paren
id|xx
op_lshift
id|fontwidthlog
c_func
(paren
id|p
)paren
)paren
op_plus
id|fb-&gt;s.ffb.xy_margin
suffix:semicolon
r_else
id|xy
op_add_assign
(paren
id|xx
op_star
id|fontwidth
c_func
(paren
id|p
)paren
)paren
op_plus
id|fb-&gt;s.ffb.xy_margin
suffix:semicolon
id|fgbg
op_assign
(paren
(paren
(paren
id|u64
)paren
(paren
(paren
(paren
id|u32
op_star
)paren
id|p-&gt;dispsw_data
)paren
(braket
id|attr_fgcol
c_func
(paren
id|p
comma
id|c
)paren
)braket
)paren
)paren
op_lshift
l_int|32
)paren
op_or
(paren
(paren
id|u32
op_star
)paren
id|p-&gt;dispsw_data
)paren
(braket
id|attr_bgcol
c_func
(paren
id|p
comma
id|c
)paren
)braket
suffix:semicolon
r_if
c_cond
(paren
id|fgbg
op_ne
op_star
(paren
id|u64
op_star
)paren
op_amp
id|fb-&gt;s.ffb.fg_cache
)paren
(brace
id|FFBFifo
c_func
(paren
id|fb
comma
l_int|2
)paren
suffix:semicolon
id|upa_writeq
c_func
(paren
id|fgbg
comma
op_amp
id|fbc-&gt;fg
)paren
suffix:semicolon
op_star
(paren
id|u64
op_star
)paren
op_amp
id|fb-&gt;s.ffb.fg_cache
op_assign
id|fgbg
suffix:semicolon
)brace
id|FFBFifo
c_func
(paren
id|fb
comma
l_int|2
op_plus
id|fontheight
c_func
(paren
id|p
)paren
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
id|xy
comma
op_amp
id|fbc-&gt;fontxy
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
id|fontwidth
c_func
(paren
id|p
)paren
comma
op_amp
id|fbc-&gt;fontw
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fontwidth
c_func
(paren
id|p
)paren
op_le
l_int|8
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
id|u32
id|val
op_assign
op_star
id|fd
op_increment
op_lshift
l_int|24
suffix:semicolon
id|upa_writel
c_func
(paren
id|val
comma
op_amp
id|fbc-&gt;font
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
id|u32
id|val
op_assign
op_star
(paren
id|u16
op_star
)paren
id|fd
op_lshift
l_int|16
suffix:semicolon
id|upa_writel
c_func
(paren
id|val
comma
op_amp
id|fbc-&gt;font
)paren
suffix:semicolon
id|fd
op_add_assign
l_int|2
suffix:semicolon
)brace
)brace
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|fb-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|ffb_putcs
r_static
r_void
id|ffb_putcs
c_func
(paren
r_struct
id|vc_data
op_star
id|conp
comma
r_struct
id|display
op_star
id|p
comma
r_const
r_int
r_int
op_star
id|s
comma
r_int
id|count
comma
r_int
id|yy
comma
r_int
id|xx
)paren
(brace
r_struct
id|fb_info_sbusfb
op_star
id|fb
op_assign
(paren
r_struct
id|fb_info_sbusfb
op_star
)paren
id|p-&gt;fb_info
suffix:semicolon
r_register
r_struct
id|ffb_fbc
op_star
id|fbc
op_assign
id|fb-&gt;s.ffb.fbc
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|i
comma
id|xy
suffix:semicolon
id|u8
op_star
id|fd1
comma
op_star
id|fd2
comma
op_star
id|fd3
comma
op_star
id|fd4
suffix:semicolon
id|u64
id|fgbg
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|fb-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|fgbg
op_assign
(paren
(paren
(paren
id|u64
)paren
(paren
(paren
(paren
id|u32
op_star
)paren
id|p-&gt;dispsw_data
)paren
(braket
id|attr_fgcol
c_func
(paren
id|p
comma
id|scr_readw
c_func
(paren
id|s
)paren
)paren
)braket
)paren
)paren
op_lshift
l_int|32
)paren
op_or
(paren
(paren
id|u32
op_star
)paren
id|p-&gt;dispsw_data
)paren
(braket
id|attr_bgcol
c_func
(paren
id|p
comma
id|scr_readw
c_func
(paren
id|s
)paren
)paren
)braket
suffix:semicolon
r_if
c_cond
(paren
id|fgbg
op_ne
op_star
(paren
id|u64
op_star
)paren
op_amp
id|fb-&gt;s.ffb.fg_cache
)paren
(brace
id|FFBFifo
c_func
(paren
id|fb
comma
l_int|2
)paren
suffix:semicolon
id|upa_writeq
c_func
(paren
id|fgbg
comma
op_amp
id|fbc-&gt;fg
)paren
suffix:semicolon
op_star
(paren
id|u64
op_star
)paren
op_amp
id|fb-&gt;s.ffb.fg_cache
op_assign
id|fgbg
suffix:semicolon
)brace
id|xy
op_assign
id|fb-&gt;s.ffb.xy_margin
suffix:semicolon
r_if
c_cond
(paren
id|fontwidthlog
c_func
(paren
id|p
)paren
)paren
id|xy
op_add_assign
(paren
id|xx
op_lshift
id|fontwidthlog
c_func
(paren
id|p
)paren
)paren
suffix:semicolon
r_else
id|xy
op_add_assign
id|xx
op_star
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fontheightlog
c_func
(paren
id|p
)paren
)paren
id|xy
op_add_assign
(paren
id|yy
op_lshift
(paren
l_int|16
op_plus
id|fontheightlog
c_func
(paren
id|p
)paren
)paren
)paren
suffix:semicolon
r_else
id|xy
op_add_assign
(paren
(paren
id|yy
op_star
id|fontheight
c_func
(paren
id|p
)paren
)paren
op_lshift
l_int|16
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fontwidth
c_func
(paren
id|p
)paren
op_le
l_int|8
)paren
(brace
r_while
c_loop
(paren
id|count
op_ge
l_int|4
)paren
(brace
id|count
op_sub_assign
l_int|4
suffix:semicolon
id|FFBFifo
c_func
(paren
id|fb
comma
l_int|2
op_plus
id|fontheight
c_func
(paren
id|p
)paren
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
l_int|4
op_star
id|fontwidth
c_func
(paren
id|p
)paren
comma
op_amp
id|fbc-&gt;fontw
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
id|xy
comma
op_amp
id|fbc-&gt;fontxy
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fontheightlog
c_func
(paren
id|p
)paren
)paren
(brace
id|fd1
op_assign
id|p-&gt;fontdata
op_plus
(paren
(paren
id|scr_readw
c_func
(paren
id|s
op_increment
)paren
op_amp
id|p-&gt;charmask
)paren
op_lshift
id|fontheightlog
c_func
(paren
id|p
)paren
)paren
suffix:semicolon
id|fd2
op_assign
id|p-&gt;fontdata
op_plus
(paren
(paren
id|scr_readw
c_func
(paren
id|s
op_increment
)paren
op_amp
id|p-&gt;charmask
)paren
op_lshift
id|fontheightlog
c_func
(paren
id|p
)paren
)paren
suffix:semicolon
id|fd3
op_assign
id|p-&gt;fontdata
op_plus
(paren
(paren
id|scr_readw
c_func
(paren
id|s
op_increment
)paren
op_amp
id|p-&gt;charmask
)paren
op_lshift
id|fontheightlog
c_func
(paren
id|p
)paren
)paren
suffix:semicolon
id|fd4
op_assign
id|p-&gt;fontdata
op_plus
(paren
(paren
id|scr_readw
c_func
(paren
id|s
op_increment
)paren
op_amp
id|p-&gt;charmask
)paren
op_lshift
id|fontheightlog
c_func
(paren
id|p
)paren
)paren
suffix:semicolon
)brace
r_else
(brace
id|fd1
op_assign
id|p-&gt;fontdata
op_plus
(paren
(paren
id|scr_readw
c_func
(paren
id|s
op_increment
)paren
op_amp
id|p-&gt;charmask
)paren
op_star
id|fontheight
c_func
(paren
id|p
)paren
)paren
suffix:semicolon
id|fd2
op_assign
id|p-&gt;fontdata
op_plus
(paren
(paren
id|scr_readw
c_func
(paren
id|s
op_increment
)paren
op_amp
id|p-&gt;charmask
)paren
op_star
id|fontheight
c_func
(paren
id|p
)paren
)paren
suffix:semicolon
id|fd3
op_assign
id|p-&gt;fontdata
op_plus
(paren
(paren
id|scr_readw
c_func
(paren
id|s
op_increment
)paren
op_amp
id|p-&gt;charmask
)paren
op_star
id|fontheight
c_func
(paren
id|p
)paren
)paren
suffix:semicolon
id|fd4
op_assign
id|p-&gt;fontdata
op_plus
(paren
(paren
id|scr_readw
c_func
(paren
id|s
op_increment
)paren
op_amp
id|p-&gt;charmask
)paren
op_star
id|fontheight
c_func
(paren
id|p
)paren
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|fontwidth
c_func
(paren
id|p
)paren
op_eq
l_int|8
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
id|u32
id|val
suffix:semicolon
id|val
op_assign
(paren
(paren
id|u32
)paren
op_star
id|fd4
op_increment
)paren
op_or
(paren
(paren
(paren
(paren
id|u32
)paren
op_star
id|fd3
op_increment
)paren
op_or
(paren
(paren
(paren
(paren
id|u32
)paren
op_star
id|fd2
op_increment
)paren
op_or
(paren
(paren
(paren
id|u32
)paren
op_star
id|fd1
op_increment
)paren
op_lshift
l_int|8
)paren
)paren
op_lshift
l_int|8
)paren
)paren
op_lshift
l_int|8
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
id|val
comma
op_amp
id|fbc-&gt;font
)paren
suffix:semicolon
)brace
id|xy
op_add_assign
l_int|32
suffix:semicolon
)brace
r_else
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
id|u32
id|val
op_assign
(paren
(paren
(paren
id|u32
)paren
op_star
id|fd4
op_increment
)paren
op_or
(paren
(paren
(paren
(paren
id|u32
)paren
op_star
id|fd3
op_increment
)paren
op_or
(paren
(paren
(paren
(paren
id|u32
)paren
op_star
id|fd2
op_increment
)paren
op_or
(paren
(paren
(paren
id|u32
)paren
op_star
id|fd1
op_increment
)paren
op_lshift
id|fontwidth
c_func
(paren
id|p
)paren
)paren
)paren
op_lshift
id|fontwidth
c_func
(paren
id|p
)paren
)paren
)paren
op_lshift
id|fontwidth
c_func
(paren
id|p
)paren
)paren
)paren
op_lshift
(paren
l_int|24
op_minus
l_int|3
op_star
id|fontwidth
c_func
(paren
id|p
)paren
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
id|val
comma
op_amp
id|fbc-&gt;font
)paren
suffix:semicolon
)brace
id|xy
op_add_assign
l_int|4
op_star
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
)brace
)brace
)brace
r_else
(brace
r_while
c_loop
(paren
id|count
op_ge
l_int|2
)paren
(brace
id|count
op_sub_assign
l_int|2
suffix:semicolon
id|FFBFifo
c_func
(paren
id|fb
comma
l_int|2
op_plus
id|fontheight
c_func
(paren
id|p
)paren
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
l_int|2
op_star
id|fontwidth
c_func
(paren
id|p
)paren
comma
op_amp
id|fbc-&gt;fontw
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
id|xy
comma
op_amp
id|fbc-&gt;fontxy
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fontheightlog
c_func
(paren
id|p
)paren
)paren
(brace
id|fd1
op_assign
id|p-&gt;fontdata
op_plus
(paren
(paren
id|scr_readw
c_func
(paren
id|s
op_increment
)paren
op_amp
id|p-&gt;charmask
)paren
op_lshift
(paren
id|fontheightlog
c_func
(paren
id|p
)paren
op_plus
l_int|1
)paren
)paren
suffix:semicolon
id|fd2
op_assign
id|p-&gt;fontdata
op_plus
(paren
(paren
id|scr_readw
c_func
(paren
id|s
op_increment
)paren
op_amp
id|p-&gt;charmask
)paren
op_lshift
(paren
id|fontheightlog
c_func
(paren
id|p
)paren
op_plus
l_int|1
)paren
)paren
suffix:semicolon
)brace
r_else
(brace
id|fd1
op_assign
id|p-&gt;fontdata
op_plus
(paren
(paren
(paren
id|scr_readw
c_func
(paren
id|s
op_increment
)paren
op_amp
id|p-&gt;charmask
)paren
op_star
id|fontheight
c_func
(paren
id|p
)paren
)paren
op_lshift
l_int|1
)paren
suffix:semicolon
id|fd2
op_assign
id|p-&gt;fontdata
op_plus
(paren
(paren
(paren
id|scr_readw
c_func
(paren
id|s
op_increment
)paren
op_amp
id|p-&gt;charmask
)paren
op_star
id|fontheight
c_func
(paren
id|p
)paren
)paren
op_lshift
l_int|1
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
id|u32
id|val
op_assign
(paren
(paren
(paren
(paren
id|u32
)paren
op_star
(paren
id|u16
op_star
)paren
id|fd1
)paren
op_lshift
id|fontwidth
c_func
(paren
id|p
)paren
)paren
op_or
(paren
(paren
id|u32
)paren
op_star
(paren
id|u16
op_star
)paren
id|fd2
)paren
)paren
op_lshift
(paren
l_int|16
op_minus
id|fontwidth
c_func
(paren
id|p
)paren
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
id|val
comma
op_amp
id|fbc-&gt;font
)paren
suffix:semicolon
id|fd1
op_add_assign
l_int|2
suffix:semicolon
id|fd2
op_add_assign
l_int|2
suffix:semicolon
)brace
id|xy
op_add_assign
l_int|2
op_star
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
)brace
)brace
r_while
c_loop
(paren
id|count
)paren
(brace
id|count
op_decrement
suffix:semicolon
id|FFBFifo
c_func
(paren
id|fb
comma
l_int|2
op_plus
id|fontheight
c_func
(paren
id|p
)paren
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
id|fontwidth
c_func
(paren
id|p
)paren
comma
op_amp
id|fbc-&gt;fontw
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
id|xy
comma
op_amp
id|fbc-&gt;fontxy
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fontheightlog
c_func
(paren
id|p
)paren
)paren
id|i
op_assign
(paren
(paren
id|scr_readw
c_func
(paren
id|s
op_increment
)paren
op_amp
id|p-&gt;charmask
)paren
op_lshift
id|fontheightlog
c_func
(paren
id|p
)paren
)paren
suffix:semicolon
r_else
id|i
op_assign
(paren
(paren
id|scr_readw
c_func
(paren
id|s
op_increment
)paren
op_amp
id|p-&gt;charmask
)paren
op_star
id|fontheight
c_func
(paren
id|p
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fontwidth
c_func
(paren
id|p
)paren
op_le
l_int|8
)paren
(brace
id|fd1
op_assign
id|p-&gt;fontdata
op_plus
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
id|u32
id|val
op_assign
op_star
id|fd1
op_increment
op_lshift
l_int|24
suffix:semicolon
id|upa_writel
c_func
(paren
id|val
comma
op_amp
id|fbc-&gt;font
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
id|fd1
op_assign
id|p-&gt;fontdata
op_plus
(paren
id|i
op_lshift
l_int|1
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
id|u32
id|val
op_assign
op_star
(paren
id|u16
op_star
)paren
id|fd1
op_lshift
l_int|16
suffix:semicolon
id|upa_writel
c_func
(paren
id|val
comma
op_amp
id|fbc-&gt;font
)paren
suffix:semicolon
id|fd1
op_add_assign
l_int|2
suffix:semicolon
)brace
)brace
id|xy
op_add_assign
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
)brace
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|fb-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|ffb_revc
r_static
r_void
id|ffb_revc
c_func
(paren
r_struct
id|display
op_star
id|p
comma
r_int
id|xx
comma
r_int
id|yy
)paren
(brace
multiline_comment|/* Not used if hw cursor */
)brace
macro_line|#if 0
r_static
r_void
id|ffb_blank
c_func
(paren
r_struct
id|fb_info_sbusfb
op_star
id|fb
)paren
(brace
r_struct
id|ffb_dac
op_star
id|dac
op_assign
id|fb-&gt;s.ffb.dac
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|u32
id|tmp
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|fb-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
l_int|0x6000
comma
op_amp
id|dac-&gt;type
)paren
suffix:semicolon
id|tmp
op_assign
(paren
id|upa_readl
c_func
(paren
op_amp
id|dac-&gt;value
)paren
op_amp
op_complement
l_int|0x1
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
l_int|0x6000
comma
op_amp
id|dac-&gt;type
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
id|tmp
comma
op_amp
id|dac-&gt;value
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|fb-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
macro_line|#endif
DECL|function|ffb_unblank
r_static
r_void
id|ffb_unblank
c_func
(paren
r_struct
id|fb_info_sbusfb
op_star
id|fb
)paren
(brace
r_struct
id|ffb_dac
op_star
id|dac
op_assign
id|fb-&gt;s.ffb.dac
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|u32
id|tmp
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|fb-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
l_int|0x6000
comma
op_amp
id|dac-&gt;type
)paren
suffix:semicolon
id|tmp
op_assign
(paren
id|upa_readl
c_func
(paren
op_amp
id|dac-&gt;value
)paren
op_or
l_int|0x1
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
l_int|0x6000
comma
op_amp
id|dac-&gt;type
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
id|tmp
comma
op_amp
id|dac-&gt;value
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|fb-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|ffb_loadcmap
r_static
r_void
id|ffb_loadcmap
(paren
r_struct
id|fb_info_sbusfb
op_star
id|fb
comma
r_struct
id|display
op_star
id|p
comma
r_int
id|index
comma
r_int
id|count
)paren
(brace
r_struct
id|ffb_dac
op_star
id|dac
op_assign
id|fb-&gt;s.ffb.dac
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|i
comma
id|j
op_assign
id|count
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|fb-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
l_int|0x2000
op_or
id|index
comma
op_amp
id|dac-&gt;type
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
id|index
suffix:semicolon
id|j
op_decrement
suffix:semicolon
id|i
op_increment
)paren
(brace
id|u32
id|val
suffix:semicolon
multiline_comment|/* Feed the colors in :)) */
id|val
op_assign
(paren
(paren
id|fb-&gt;color_map
id|CM
c_func
(paren
id|i
comma
l_int|0
)paren
)paren
)paren
op_or
(paren
(paren
id|fb-&gt;color_map
id|CM
c_func
(paren
id|i
comma
l_int|1
)paren
)paren
op_lshift
l_int|8
)paren
op_or
(paren
(paren
id|fb-&gt;color_map
id|CM
c_func
(paren
id|i
comma
l_int|2
)paren
)paren
op_lshift
l_int|16
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
id|val
comma
op_amp
id|dac-&gt;value
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|p
)paren
r_goto
id|out
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
id|index
comma
id|j
op_assign
id|count
suffix:semicolon
id|i
OL
l_int|16
op_logical_and
id|j
op_decrement
suffix:semicolon
id|i
op_increment
)paren
(paren
(paren
id|u32
op_star
)paren
id|p-&gt;dispsw_data
)paren
(braket
id|i
)braket
op_assign
(paren
(paren
id|fb-&gt;color_map
id|CM
c_func
(paren
id|i
comma
l_int|0
)paren
)paren
)paren
op_or
(paren
(paren
id|fb-&gt;color_map
id|CM
c_func
(paren
id|i
comma
l_int|1
)paren
)paren
op_lshift
l_int|8
)paren
op_or
(paren
(paren
id|fb-&gt;color_map
id|CM
c_func
(paren
id|i
comma
l_int|2
)paren
)paren
op_lshift
l_int|16
)paren
suffix:semicolon
id|out
suffix:colon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|fb-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|variable|__initdata
r_static
r_struct
id|display_switch
id|ffb_dispsw
id|__initdata
op_assign
(brace
id|setup
suffix:colon
id|ffb_setup
comma
id|bmove
suffix:colon
id|fbcon_redraw_bmove
comma
id|clear
suffix:colon
id|ffb_clear
comma
id|putc
suffix:colon
id|ffb_putc
comma
id|putcs
suffix:colon
id|ffb_putcs
comma
id|revc
suffix:colon
id|ffb_revc
comma
id|fontwidthmask
suffix:colon
id|FONTWIDTHRANGE
c_func
(paren
l_int|1
comma
l_int|16
)paren
multiline_comment|/* Allow fontwidths up to 16 */
)brace
suffix:semicolon
DECL|function|ffb_margins
r_static
r_void
id|ffb_margins
(paren
r_struct
id|fb_info_sbusfb
op_star
id|fb
comma
r_struct
id|display
op_star
id|p
comma
r_int
id|x_margin
comma
r_int
id|y_margin
)paren
(brace
r_register
r_struct
id|ffb_fbc
op_star
id|fbc
op_assign
id|fb-&gt;s.ffb.fbc
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|fb-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|fb-&gt;s.ffb.xy_margin
op_assign
(paren
id|y_margin
op_lshift
l_int|16
)paren
op_plus
id|x_margin
suffix:semicolon
id|fb-&gt;s.ffb.yx_margin
op_assign
(paren
(paren
(paren
id|u64
)paren
id|y_margin
)paren
op_lshift
l_int|32
)paren
op_plus
id|x_margin
suffix:semicolon
id|p-&gt;screen_base
op_add_assign
l_int|8192
op_star
(paren
id|y_margin
op_minus
id|fb-&gt;y_margin
)paren
op_plus
l_int|4
op_star
(paren
id|x_margin
op_minus
id|fb-&gt;x_margin
)paren
suffix:semicolon
id|FFBWait
c_func
(paren
id|fbc
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|fb-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|__ffb_curs_enable
r_static
id|__inline__
r_void
id|__ffb_curs_enable
(paren
r_struct
id|fb_info_sbusfb
op_star
id|fb
comma
r_int
id|enable
)paren
(brace
r_struct
id|ffb_dac
op_star
id|dac
op_assign
id|fb-&gt;s.ffb.dac
suffix:semicolon
id|u32
id|val
suffix:semicolon
id|upa_writel
c_func
(paren
l_int|0x100
comma
op_amp
id|dac-&gt;type2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fb-&gt;s.ffb.dac_rev
op_le
l_int|2
)paren
(brace
id|val
op_assign
id|enable
ques
c_cond
l_int|3
suffix:colon
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|val
op_assign
id|enable
ques
c_cond
l_int|0
suffix:colon
l_int|3
suffix:semicolon
)brace
id|upa_writel
c_func
(paren
id|val
comma
op_amp
id|dac-&gt;value2
)paren
suffix:semicolon
)brace
DECL|function|ffb_setcursormap
r_static
r_void
id|ffb_setcursormap
(paren
r_struct
id|fb_info_sbusfb
op_star
id|fb
comma
id|u8
op_star
id|red
comma
id|u8
op_star
id|green
comma
id|u8
op_star
id|blue
)paren
(brace
r_struct
id|ffb_dac
op_star
id|dac
op_assign
id|fb-&gt;s.ffb.dac
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|fb-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|__ffb_curs_enable
(paren
id|fb
comma
l_int|0
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
l_int|0x102
comma
op_amp
id|dac-&gt;type2
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
(paren
id|red
(braket
l_int|0
)braket
op_or
(paren
id|green
(braket
l_int|0
)braket
op_lshift
l_int|8
)paren
op_or
(paren
id|blue
(braket
l_int|0
)braket
op_lshift
l_int|16
)paren
)paren
comma
op_amp
id|dac-&gt;value2
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
(paren
id|red
(braket
l_int|1
)braket
op_or
(paren
id|green
(braket
l_int|1
)braket
op_lshift
l_int|8
)paren
op_or
(paren
id|blue
(braket
l_int|1
)braket
op_lshift
l_int|16
)paren
)paren
comma
op_amp
id|dac-&gt;value2
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|fb-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
multiline_comment|/* Set cursor shape */
DECL|function|ffb_setcurshape
r_static
r_void
id|ffb_setcurshape
(paren
r_struct
id|fb_info_sbusfb
op_star
id|fb
)paren
(brace
r_struct
id|ffb_dac
op_star
id|dac
op_assign
id|fb-&gt;s.ffb.dac
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|i
comma
id|j
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|fb-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|__ffb_curs_enable
(paren
id|fb
comma
l_int|0
)paren
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
l_int|2
suffix:semicolon
id|j
op_increment
)paren
(brace
id|u32
id|val
op_assign
id|j
ques
c_cond
l_int|0
suffix:colon
l_int|0x80
suffix:semicolon
id|upa_writel
c_func
(paren
id|val
comma
op_amp
id|dac-&gt;type2
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|0x40
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|fb-&gt;cursor.size.fbx
op_le
l_int|32
)paren
(brace
id|upa_writel
c_func
(paren
id|fb-&gt;cursor.bits
(braket
id|j
)braket
(braket
id|i
)braket
comma
op_amp
id|dac-&gt;value2
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
l_int|0
comma
op_amp
id|dac-&gt;value2
)paren
suffix:semicolon
)brace
r_else
(brace
id|upa_writel
c_func
(paren
id|fb-&gt;cursor.bits
(braket
id|j
)braket
(braket
l_int|2
op_star
id|i
)braket
comma
op_amp
id|dac-&gt;value2
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
id|fb-&gt;cursor.bits
(braket
id|j
)braket
(braket
l_int|2
op_star
id|i
op_plus
l_int|1
)braket
comma
op_amp
id|dac-&gt;value2
)paren
suffix:semicolon
)brace
)brace
)brace
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|fb-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
multiline_comment|/* Load cursor information */
DECL|function|ffb_setcursor
r_static
r_void
id|ffb_setcursor
(paren
r_struct
id|fb_info_sbusfb
op_star
id|fb
)paren
(brace
r_struct
id|ffb_dac
op_star
id|dac
op_assign
id|fb-&gt;s.ffb.dac
suffix:semicolon
r_struct
id|cg_cursor
op_star
id|c
op_assign
op_amp
id|fb-&gt;cursor
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|u32
id|val
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|fb-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
l_int|0x104
comma
op_amp
id|dac-&gt;type2
)paren
suffix:semicolon
multiline_comment|/* Should this be just 0x7ff?? &n;&t;   Should I do some margin handling and setcurshape in that case? */
id|val
op_assign
(paren
(paren
(paren
id|c-&gt;cpos.fby
op_minus
id|c-&gt;chot.fby
)paren
op_amp
l_int|0xffff
)paren
op_lshift
l_int|16
)paren
op_or
(paren
(paren
id|c-&gt;cpos.fbx
op_minus
id|c-&gt;chot.fbx
)paren
op_amp
l_int|0xffff
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
id|val
comma
op_amp
id|dac-&gt;value2
)paren
suffix:semicolon
id|__ffb_curs_enable
(paren
id|fb
comma
id|fb-&gt;cursor.enable
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|fb-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|ffb_switch_from_graph
r_static
r_void
id|ffb_switch_from_graph
(paren
r_struct
id|fb_info_sbusfb
op_star
id|fb
)paren
(brace
r_register
r_struct
id|ffb_fbc
op_star
id|fbc
op_assign
id|fb-&gt;s.ffb.fbc
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|spin_lock_irqsave
c_func
(paren
op_amp
id|fb-&gt;lock
comma
id|flags
)paren
suffix:semicolon
id|FFBWait
c_func
(paren
id|fbc
)paren
suffix:semicolon
id|fb-&gt;s.ffb.fifo_cache
op_assign
l_int|0
suffix:semicolon
id|FFBFifo
c_func
(paren
id|fb
comma
l_int|8
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
id|FFB_PPC_VCE_DISABLE
op_or
id|FFB_PPC_TBE_OPAQUE
op_or
id|FFB_PPC_APE_DISABLE
op_or
id|FFB_PPC_CS_CONST
comma
op_amp
id|fbc-&gt;ppc
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
l_int|0x2000707f
comma
op_amp
id|fbc-&gt;fbc
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
id|FFB_ROP_NEW
comma
op_amp
id|fbc-&gt;rop
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
id|FFB_DRAWOP_RECTANGLE
comma
op_amp
id|fbc-&gt;drawop
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
l_int|0xffffffff
comma
op_amp
id|fbc-&gt;pmask
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
l_int|0x10000
comma
op_amp
id|fbc-&gt;fontinc
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
id|fb-&gt;s.ffb.fg_cache
comma
op_amp
id|fbc-&gt;fg
)paren
suffix:semicolon
id|upa_writel
c_func
(paren
id|fb-&gt;s.ffb.bg_cache
comma
op_amp
id|fbc-&gt;bg
)paren
suffix:semicolon
id|FFBWait
c_func
(paren
id|fbc
)paren
suffix:semicolon
id|spin_unlock_irqrestore
c_func
(paren
op_amp
id|fb-&gt;lock
comma
id|flags
)paren
suffix:semicolon
)brace
DECL|function|ffb_rasterimg
r_static
r_int
id|__init
id|ffb_rasterimg
(paren
r_struct
id|fb_info
op_star
id|info
comma
r_int
id|start
)paren
(brace
id|ffb_switch_from_graph
(paren
id|sbusfbinfo
c_func
(paren
id|info
)paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|__initdata
r_static
r_char
id|idstring
(braket
l_int|60
)braket
id|__initdata
op_assign
(brace
l_int|0
)brace
suffix:semicolon
DECL|function|creatorfb_init
r_char
id|__init
op_star
id|creatorfb_init
c_func
(paren
r_struct
id|fb_info_sbusfb
op_star
id|fb
)paren
(brace
r_struct
id|fb_fix_screeninfo
op_star
id|fix
op_assign
op_amp
id|fb-&gt;fix
suffix:semicolon
r_struct
id|fb_var_screeninfo
op_star
id|var
op_assign
op_amp
id|fb-&gt;var
suffix:semicolon
r_struct
id|display
op_star
id|disp
op_assign
op_amp
id|fb-&gt;disp
suffix:semicolon
r_struct
id|fbtype
op_star
id|type
op_assign
op_amp
id|fb-&gt;type
suffix:semicolon
r_struct
id|linux_prom64_registers
id|regs
(braket
l_int|2
op_star
id|PROMREG_MAX
)braket
suffix:semicolon
r_int
id|i
comma
id|afb
op_assign
l_int|0
suffix:semicolon
r_int
r_int
id|btype
suffix:semicolon
r_char
id|name
(braket
l_int|64
)braket
suffix:semicolon
r_struct
id|fb_ops
op_star
id|fbops
suffix:semicolon
r_if
c_cond
(paren
id|prom_getproperty
c_func
(paren
id|fb-&gt;prom_node
comma
l_string|&quot;reg&quot;
comma
(paren
r_void
op_star
)paren
id|regs
comma
r_sizeof
(paren
id|regs
)paren
)paren
op_le
l_int|0
)paren
r_return
l_int|NULL
suffix:semicolon
id|disp-&gt;dispsw_data
op_assign
(paren
r_void
op_star
)paren
id|kmalloc
c_func
(paren
l_int|16
op_star
r_sizeof
(paren
id|u32
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|disp-&gt;dispsw_data
op_eq
l_int|NULL
)paren
r_return
l_int|NULL
suffix:semicolon
id|memset
c_func
(paren
id|disp-&gt;dispsw_data
comma
l_int|0
comma
l_int|16
op_star
r_sizeof
(paren
id|u32
)paren
)paren
suffix:semicolon
id|fbops
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
op_star
id|fbops
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fbops
op_eq
l_int|NULL
)paren
(brace
id|kfree
c_func
(paren
id|disp-&gt;dispsw_data
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
op_star
id|fbops
op_assign
op_star
id|fb-&gt;info.fbops
suffix:semicolon
id|fbops-&gt;fb_rasterimg
op_assign
id|ffb_rasterimg
suffix:semicolon
id|fb-&gt;info.fbops
op_assign
id|fbops
suffix:semicolon
id|prom_getstring
c_func
(paren
id|fb-&gt;prom_node
comma
l_string|&quot;name&quot;
comma
id|name
comma
r_sizeof
(paren
id|name
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|name
comma
l_string|&quot;SUNW,afb&quot;
)paren
)paren
id|afb
op_assign
l_int|1
suffix:semicolon
id|btype
op_assign
id|prom_getintdefault
c_func
(paren
id|fb-&gt;prom_node
comma
l_string|&quot;board_type&quot;
comma
l_int|0
)paren
suffix:semicolon
id|strcpy
c_func
(paren
id|fb-&gt;info.modename
comma
l_string|&quot;Creator&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|afb
)paren
(brace
r_if
c_cond
(paren
(paren
id|btype
op_amp
l_int|7
)paren
op_eq
l_int|3
)paren
id|strcpy
c_func
(paren
id|fix-&gt;id
comma
l_string|&quot;Creator 3D&quot;
)paren
suffix:semicolon
r_else
id|strcpy
c_func
(paren
id|fix-&gt;id
comma
l_string|&quot;Creator&quot;
)paren
suffix:semicolon
)brace
r_else
id|strcpy
c_func
(paren
id|fix-&gt;id
comma
l_string|&quot;Elite 3D&quot;
)paren
suffix:semicolon
id|fix-&gt;visual
op_assign
id|FB_VISUAL_TRUECOLOR
suffix:semicolon
id|fix-&gt;line_length
op_assign
l_int|8192
suffix:semicolon
id|fix-&gt;accel
op_assign
id|FB_ACCEL_SUN_CREATOR
suffix:semicolon
id|var-&gt;bits_per_pixel
op_assign
l_int|32
suffix:semicolon
id|var-&gt;green.offset
op_assign
l_int|8
suffix:semicolon
id|var-&gt;blue.offset
op_assign
l_int|16
suffix:semicolon
id|var-&gt;accel_flags
op_assign
id|FB_ACCELF_TEXT
suffix:semicolon
id|disp-&gt;scrollmode
op_assign
id|SCROLL_YREDRAW
suffix:semicolon
id|disp-&gt;screen_base
op_assign
(paren
r_char
op_star
)paren
id|__va
c_func
(paren
id|regs
(braket
l_int|0
)braket
dot
id|phys_addr
)paren
op_plus
id|FFB_DFB24_POFF
op_plus
l_int|8192
op_star
id|fb-&gt;y_margin
op_plus
l_int|4
op_star
id|fb-&gt;x_margin
suffix:semicolon
id|fb-&gt;s.ffb.xy_margin
op_assign
(paren
id|fb-&gt;y_margin
op_lshift
l_int|16
)paren
op_plus
id|fb-&gt;x_margin
suffix:semicolon
id|fb-&gt;s.ffb.yx_margin
op_assign
(paren
(paren
(paren
id|u64
)paren
id|fb-&gt;y_margin
)paren
op_lshift
l_int|32
)paren
op_plus
id|fb-&gt;x_margin
suffix:semicolon
id|fb-&gt;s.ffb.fbc
op_assign
(paren
r_struct
id|ffb_fbc
op_star
)paren
(paren
id|regs
(braket
l_int|0
)braket
dot
id|phys_addr
op_plus
id|FFB_FBC_REGS_POFF
)paren
suffix:semicolon
id|fb-&gt;s.ffb.dac
op_assign
(paren
r_struct
id|ffb_dac
op_star
)paren
(paren
id|regs
(braket
l_int|0
)braket
dot
id|phys_addr
op_plus
id|FFB_DAC_POFF
)paren
suffix:semicolon
id|fb-&gt;dispsw
op_assign
id|ffb_dispsw
suffix:semicolon
id|fb-&gt;margins
op_assign
id|ffb_margins
suffix:semicolon
id|fb-&gt;loadcmap
op_assign
id|ffb_loadcmap
suffix:semicolon
id|fb-&gt;setcursor
op_assign
id|ffb_setcursor
suffix:semicolon
id|fb-&gt;setcursormap
op_assign
id|ffb_setcursormap
suffix:semicolon
id|fb-&gt;setcurshape
op_assign
id|ffb_setcurshape
suffix:semicolon
id|fb-&gt;switch_from_graph
op_assign
id|ffb_switch_from_graph
suffix:semicolon
id|fb-&gt;fill
op_assign
id|ffb_fill
suffix:semicolon
macro_line|#if 0
multiline_comment|/* XXX Can&squot;t enable this for now, I&squot;ve seen cases&n;&t; * XXX where the VC was blanked, and Xsun24 was started&n;&t; * XXX via a remote login, the sunfb code did not&n;&t; * XXX unblank creator when it was mmap&squot;d for some&n;&t; * XXX reason, investigate later... -DaveM&n;&t; */
id|fb-&gt;blank
op_assign
id|ffb_blank
suffix:semicolon
id|fb-&gt;unblank
op_assign
id|ffb_unblank
suffix:semicolon
macro_line|#endif
multiline_comment|/* If there are any read errors or fifo overflow conditions,&n;&t; * clear them now.&n;&t; */
r_if
c_cond
(paren
(paren
id|upa_readl
c_func
(paren
op_amp
id|fb-&gt;s.ffb.fbc-&gt;ucsr
)paren
op_amp
id|FFB_UCSR_ALL_ERRORS
)paren
op_ne
l_int|0
)paren
(brace
id|upa_writel
c_func
(paren
id|FFB_UCSR_ALL_ERRORS
comma
op_amp
id|fb-&gt;s.ffb.fbc-&gt;ucsr
)paren
suffix:semicolon
)brace
id|ffb_switch_from_graph
c_func
(paren
id|fb
)paren
suffix:semicolon
id|fb-&gt;physbase
op_assign
id|regs
(braket
l_int|0
)braket
dot
id|phys_addr
suffix:semicolon
id|fb-&gt;mmap_map
op_assign
id|ffb_mmap_map
suffix:semicolon
id|fb-&gt;cursor.hwsize.fbx
op_assign
l_int|64
suffix:semicolon
id|fb-&gt;cursor.hwsize.fby
op_assign
l_int|64
suffix:semicolon
id|type-&gt;fb_depth
op_assign
l_int|24
suffix:semicolon
id|upa_writel
c_func
(paren
l_int|0x8000
comma
op_amp
id|fb-&gt;s.ffb.dac-&gt;type
)paren
suffix:semicolon
id|fb-&gt;s.ffb.dac_rev
op_assign
(paren
id|upa_readl
c_func
(paren
op_amp
id|fb-&gt;s.ffb.dac-&gt;value
)paren
op_rshift
l_int|0x1c
)paren
suffix:semicolon
id|i
op_assign
id|prom_getintdefault
(paren
id|fb-&gt;prom_node
comma
l_string|&quot;board_type&quot;
comma
l_int|8
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|idstring
comma
l_string|&quot;%s at %016lx type %d DAC %d&quot;
comma
id|fix-&gt;id
comma
id|regs
(braket
l_int|0
)braket
dot
id|phys_addr
comma
id|i
comma
id|fb-&gt;s.ffb.dac_rev
)paren
suffix:semicolon
multiline_comment|/* Elite3D has different DAC revision numbering, and no DAC revisions&n;&t;   have the reversed meaning of cursor enable */
r_if
c_cond
(paren
id|afb
)paren
id|fb-&gt;s.ffb.dac_rev
op_assign
l_int|10
suffix:semicolon
multiline_comment|/* Unblank it just to be sure.  When there are multiple&n;&t; * FFB/AFB cards in the system, or it is not the OBP&n;&t; * chosen console, it will have video outputs off in&n;&t; * the DAC.&n;&t; */
id|ffb_unblank
c_func
(paren
id|fb
)paren
suffix:semicolon
r_return
id|idstring
suffix:semicolon
)brace
eof
