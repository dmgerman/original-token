multiline_comment|/* $Id: creatorfb.c,v 1.4 1998/07/06 15:51:10 jj Exp $&n; * creatorfb.c: Creator/Creator3D frame buffer driver&n; *&n; * Copyright (C) 1997,1998 Jakub Jelinek (jj@ultra.linux.cz)&n; */
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/errno.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/tty.h&gt;
macro_line|#include &lt;linux/malloc.h&gt;
macro_line|#include &lt;linux/vmalloc.h&gt;
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/interrupt.h&gt;
macro_line|#include &lt;linux/fb.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/selection.h&gt;
macro_line|#include &quot;sbusfb.h&quot;
DECL|macro|FFB_SFB8R_VOFF
mdefine_line|#define&t;FFB_SFB8R_VOFF&t;&t;0x00000000
DECL|macro|FFB_SFB8G_VOFF
mdefine_line|#define&t;FFB_SFB8G_VOFF&t;&t;0x00400000
DECL|macro|FFB_SFB8B_VOFF
mdefine_line|#define&t;FFB_SFB8B_VOFF&t;&t;0x00800000
DECL|macro|FFB_SFB8X_VOFF
mdefine_line|#define&t;FFB_SFB8X_VOFF&t;&t;0x00c00000
DECL|macro|FFB_SFB32_VOFF
mdefine_line|#define&t;FFB_SFB32_VOFF&t;&t;0x01000000
DECL|macro|FFB_SFB64_VOFF
mdefine_line|#define&t;FFB_SFB64_VOFF&t;&t;0x02000000
DECL|macro|FFB_FBC_REGS_VOFF
mdefine_line|#define&t;FFB_FBC_REGS_VOFF&t;0x04000000
DECL|macro|FFB_BM_FBC_REGS_VOFF
mdefine_line|#define&t;FFB_BM_FBC_REGS_VOFF&t;0x04002000
DECL|macro|FFB_DFB8R_VOFF
mdefine_line|#define&t;FFB_DFB8R_VOFF&t;&t;0x04004000
DECL|macro|FFB_DFB8G_VOFF
mdefine_line|#define&t;FFB_DFB8G_VOFF&t;&t;0x04404000
DECL|macro|FFB_DFB8B_VOFF
mdefine_line|#define&t;FFB_DFB8B_VOFF&t;&t;0x04804000
DECL|macro|FFB_DFB8X_VOFF
mdefine_line|#define&t;FFB_DFB8X_VOFF&t;&t;0x04c04000
DECL|macro|FFB_DFB24_VOFF
mdefine_line|#define&t;FFB_DFB24_VOFF&t;&t;0x05004000
DECL|macro|FFB_DFB32_VOFF
mdefine_line|#define&t;FFB_DFB32_VOFF&t;&t;0x06004000
DECL|macro|FFB_DFB422A_VOFF
mdefine_line|#define&t;FFB_DFB422A_VOFF&t;0x07004000&t;/* DFB 422 mode write to A */
DECL|macro|FFB_DFB422AD_VOFF
mdefine_line|#define&t;FFB_DFB422AD_VOFF&t;0x07804000&t;/* DFB 422 mode with line doubling */
DECL|macro|FFB_DFB24B_VOFF
mdefine_line|#define&t;FFB_DFB24B_VOFF&t;&t;0x08004000&t;/* DFB 24bit mode write to B */
DECL|macro|FFB_DFB422B_VOFF
mdefine_line|#define&t;FFB_DFB422B_VOFF&t;0x09004000&t;/* DFB 422 mode write to B */
DECL|macro|FFB_DFB422BD_VOFF
mdefine_line|#define&t;FFB_DFB422BD_VOFF&t;0x09804000&t;/* DFB 422 mode with line doubling */
DECL|macro|FFB_SFB16Z_VOFF
mdefine_line|#define&t;FFB_SFB16Z_VOFF&t;&t;0x0a004000&t;/* 16bit mode Z planes */
DECL|macro|FFB_SFB8Z_VOFF
mdefine_line|#define&t;FFB_SFB8Z_VOFF&t;&t;0x0a404000&t;/* 8bit mode Z planes */
DECL|macro|FFB_SFB422_VOFF
mdefine_line|#define&t;FFB_SFB422_VOFF&t;&t;0x0ac04000&t;/* SFB 422 mode write to A/B */
DECL|macro|FFB_SFB422D_VOFF
mdefine_line|#define&t;FFB_SFB422D_VOFF&t;0x0b404000&t;/* SFB 422 mode with line doubling */
DECL|macro|FFB_FBC_KREGS_VOFF
mdefine_line|#define&t;FFB_FBC_KREGS_VOFF&t;0x0bc04000
DECL|macro|FFB_DAC_VOFF
mdefine_line|#define&t;FFB_DAC_VOFF&t;&t;0x0bc06000
DECL|macro|FFB_PROM_VOFF
mdefine_line|#define&t;FFB_PROM_VOFF&t;&t;0x0bc08000
DECL|macro|FFB_EXP_VOFF
mdefine_line|#define&t;FFB_EXP_VOFF&t;&t;0x0bc18000
DECL|macro|FFB_SFB8R_POFF
mdefine_line|#define&t;FFB_SFB8R_POFF&t;&t;0x04000000
DECL|macro|FFB_SFB8G_POFF
mdefine_line|#define&t;FFB_SFB8G_POFF&t;&t;0x04400000
DECL|macro|FFB_SFB8B_POFF
mdefine_line|#define&t;FFB_SFB8B_POFF&t;&t;0x04800000
DECL|macro|FFB_SFB8X_POFF
mdefine_line|#define&t;FFB_SFB8X_POFF&t;&t;0x04c00000
DECL|macro|FFB_SFB32_POFF
mdefine_line|#define&t;FFB_SFB32_POFF&t;&t;0x05000000
DECL|macro|FFB_SFB64_POFF
mdefine_line|#define&t;FFB_SFB64_POFF&t;&t;0x06000000
DECL|macro|FFB_FBC_REGS_POFF
mdefine_line|#define&t;FFB_FBC_REGS_POFF&t;0x00600000
DECL|macro|FFB_BM_FBC_REGS_POFF
mdefine_line|#define&t;FFB_BM_FBC_REGS_POFF&t;0x00600000
DECL|macro|FFB_DFB8R_POFF
mdefine_line|#define&t;FFB_DFB8R_POFF&t;&t;0x01000000
DECL|macro|FFB_DFB8G_POFF
mdefine_line|#define&t;FFB_DFB8G_POFF&t;&t;0x01400000
DECL|macro|FFB_DFB8B_POFF
mdefine_line|#define&t;FFB_DFB8B_POFF&t;&t;0x01800000
DECL|macro|FFB_DFB8X_POFF
mdefine_line|#define&t;FFB_DFB8X_POFF&t;&t;0x01c00000
DECL|macro|FFB_DFB24_POFF
mdefine_line|#define&t;FFB_DFB24_POFF&t;&t;0x02000000
DECL|macro|FFB_DFB32_POFF
mdefine_line|#define&t;FFB_DFB32_POFF&t;&t;0x03000000
DECL|macro|FFB_FBC_KREGS_POFF
mdefine_line|#define&t;FFB_FBC_KREGS_POFF&t;0x00610000
DECL|macro|FFB_DAC_POFF
mdefine_line|#define&t;FFB_DAC_POFF&t;&t;0x00400000
DECL|macro|FFB_PROM_POFF
mdefine_line|#define&t;FFB_PROM_POFF&t;&t;0x00000000
DECL|macro|FFB_EXP_POFF
mdefine_line|#define&t;FFB_EXP_POFF&t;&t;0x00200000
DECL|macro|FFB_Y_BYTE_ADDR_SHIFT
mdefine_line|#define FFB_Y_BYTE_ADDR_SHIFT          11
DECL|macro|FFB_Y_ADDR_SHIFT
mdefine_line|#define FFB_Y_ADDR_SHIFT               13
DECL|macro|FFB_PPC_ACE_DISABLE
mdefine_line|#define FFB_PPC_ACE_DISABLE             1
DECL|macro|FFB_PPC_ACE_AUX_ADD
mdefine_line|#define FFB_PPC_ACE_AUX_ADD             3
DECL|macro|FFB_PPC_ACE_SHIFT
mdefine_line|#define FFB_PPC_ACE_SHIFT              18
DECL|macro|FFB_PPC_DCE_DISABLE
mdefine_line|#define FFB_PPC_DCE_DISABLE             2
DECL|macro|FFB_PPC_DCE_SHIFT
mdefine_line|#define FFB_PPC_DCE_SHIFT              16
DECL|macro|FFB_PPC_ABE_DISABLE
mdefine_line|#define FFB_PPC_ABE_DISABLE             2
DECL|macro|FFB_PPC_ABE_SHIFT
mdefine_line|#define FFB_PPC_ABE_SHIFT              14
DECL|macro|FFB_PPC_VCE_DISABLE
mdefine_line|#define FFB_PPC_VCE_DISABLE             1
DECL|macro|FFB_PPC_VCE_2D
mdefine_line|#define FFB_PPC_VCE_2D                  2
DECL|macro|FFB_PPC_VCE_SHIFT
mdefine_line|#define FFB_PPC_VCE_SHIFT              12
DECL|macro|FFB_PPC_APE_DISABLE
mdefine_line|#define FFB_PPC_APE_DISABLE             2
DECL|macro|FFB_PPC_APE_SHIFT
mdefine_line|#define FFB_PPC_APE_SHIFT              10
DECL|macro|FFB_PPC_CS_VARIABLE
mdefine_line|#define FFB_PPC_CS_VARIABLE             2
DECL|macro|FFB_PPC_CS_SHIFT
mdefine_line|#define FFB_PPC_CS_SHIFT                0
DECL|macro|FFB_FBC_WB_A
mdefine_line|#define FFB_FBC_WB_A                    1
DECL|macro|FFB_FBC_WB_SHIFT
mdefine_line|#define FFB_FBC_WB_SHIFT               29
DECL|macro|FFB_FBC_PGE_MASK
mdefine_line|#define FFB_FBC_PGE_MASK                3
DECL|macro|FFB_FBC_BE_SHIFT
mdefine_line|#define FFB_FBC_BE_SHIFT                4
DECL|macro|FFB_FBC_GE_SHIFT
mdefine_line|#define FFB_FBC_GE_SHIFT                2
DECL|macro|FFB_FBC_RE_SHIFT
mdefine_line|#define FFB_FBC_RE_SHIFT                0
DECL|macro|FFB_ROP_NEW
mdefine_line|#define FFB_ROP_NEW                  0x83
DECL|macro|FFB_ROP_RGB_SHIFT
mdefine_line|#define FFB_ROP_RGB_SHIFT               0
DECL|macro|FFB_UCSR_FIFO_MASK
mdefine_line|#define FFB_UCSR_FIFO_MASK     0x00000fff
DECL|macro|FFB_UCSR_RP_BUSY
mdefine_line|#define FFB_UCSR_RP_BUSY       0x02000000
DECL|struct|ffb_fbc
r_struct
id|ffb_fbc
(brace
DECL|member|xxx1
id|u8
id|xxx1
(braket
l_int|0x60
)braket
suffix:semicolon
DECL|member|by
r_volatile
id|u32
id|by
suffix:semicolon
DECL|member|bx
r_volatile
id|u32
id|bx
suffix:semicolon
DECL|member|xxx2
id|u32
id|xxx2
suffix:semicolon
DECL|member|xxx3
id|u32
id|xxx3
suffix:semicolon
DECL|member|bh
r_volatile
id|u32
id|bh
suffix:semicolon
DECL|member|bw
r_volatile
id|u32
id|bw
suffix:semicolon
DECL|member|xxx4
id|u8
id|xxx4
(braket
l_int|0x188
)braket
suffix:semicolon
DECL|member|ppc
r_volatile
id|u32
id|ppc
suffix:semicolon
DECL|member|xxx5
id|u32
id|xxx5
suffix:semicolon
DECL|member|fg
r_volatile
id|u32
id|fg
suffix:semicolon
DECL|member|bg
r_volatile
id|u32
id|bg
suffix:semicolon
DECL|member|xxx6
id|u8
id|xxx6
(braket
l_int|0x44
)braket
suffix:semicolon
DECL|member|fbc
r_volatile
id|u32
id|fbc
suffix:semicolon
DECL|member|rop
r_volatile
id|u32
id|rop
suffix:semicolon
DECL|member|xxx7
id|u8
id|xxx7
(braket
l_int|0x34
)braket
suffix:semicolon
DECL|member|pmask
r_volatile
id|u32
id|pmask
suffix:semicolon
DECL|member|xxx8
id|u8
id|xxx8
(braket
l_int|12
)braket
suffix:semicolon
DECL|member|clip0min
r_volatile
id|u32
id|clip0min
suffix:semicolon
DECL|member|clip0max
r_volatile
id|u32
id|clip0max
suffix:semicolon
DECL|member|clip1min
r_volatile
id|u32
id|clip1min
suffix:semicolon
DECL|member|clip1max
r_volatile
id|u32
id|clip1max
suffix:semicolon
DECL|member|clip2min
r_volatile
id|u32
id|clip2min
suffix:semicolon
DECL|member|clip2max
r_volatile
id|u32
id|clip2max
suffix:semicolon
DECL|member|clip3min
r_volatile
id|u32
id|clip3min
suffix:semicolon
DECL|member|clip3max
r_volatile
id|u32
id|clip3max
suffix:semicolon
DECL|member|xxx9
id|u8
id|xxx9
(braket
l_int|0x3c
)braket
suffix:semicolon
DECL|member|unk1
r_volatile
id|u32
id|unk1
suffix:semicolon
DECL|member|unk2
r_volatile
id|u32
id|unk2
suffix:semicolon
DECL|member|xxx10
id|u8
id|xxx10
(braket
l_int|0x10
)braket
suffix:semicolon
DECL|member|fontxy
r_volatile
id|u32
id|fontxy
suffix:semicolon
DECL|member|fontw
r_volatile
id|u32
id|fontw
suffix:semicolon
DECL|member|fontinc
r_volatile
id|u32
id|fontinc
suffix:semicolon
DECL|member|font
r_volatile
id|u32
id|font
suffix:semicolon
DECL|member|xxx11
id|u8
id|xxx11
(braket
l_int|0x4dc
)braket
suffix:semicolon
DECL|member|unk3
r_volatile
id|u32
id|unk3
suffix:semicolon
DECL|member|xxx12
id|u8
id|xxx12
(braket
l_int|0xfc
)braket
suffix:semicolon
DECL|member|ucsr
r_volatile
id|u32
id|ucsr
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|ffb_dac
r_struct
id|ffb_dac
(brace
DECL|member|type
r_volatile
id|u32
id|type
suffix:semicolon
DECL|member|value
r_volatile
id|u32
id|value
suffix:semicolon
DECL|member|type2
r_volatile
id|u32
id|type2
suffix:semicolon
DECL|member|value2
r_volatile
id|u32
id|value2
suffix:semicolon
)brace
suffix:semicolon
DECL|variable|ffb_mmap_map
r_static
r_struct
id|sbus_mmap_map
id|ffb_mmap_map
(braket
)braket
op_assign
(brace
(brace
id|FFB_SFB8R_VOFF
comma
id|FFB_SFB8R_POFF
comma
l_int|0x0400000
)brace
comma
(brace
id|FFB_SFB8G_VOFF
comma
id|FFB_SFB8G_POFF
comma
l_int|0x0400000
)brace
comma
(brace
id|FFB_SFB8B_VOFF
comma
id|FFB_SFB8B_POFF
comma
l_int|0x0400000
)brace
comma
(brace
id|FFB_SFB8X_VOFF
comma
id|FFB_SFB8X_POFF
comma
l_int|0x0400000
)brace
comma
(brace
id|FFB_SFB32_VOFF
comma
id|FFB_SFB32_POFF
comma
l_int|0x1000000
)brace
comma
(brace
id|FFB_SFB64_VOFF
comma
id|FFB_SFB64_POFF
comma
l_int|0x2000000
)brace
comma
(brace
id|FFB_FBC_REGS_VOFF
comma
id|FFB_FBC_REGS_POFF
comma
l_int|0x0002000
)brace
comma
(brace
id|FFB_BM_FBC_REGS_VOFF
comma
id|FFB_BM_FBC_REGS_POFF
comma
l_int|0x0002000
)brace
comma
(brace
id|FFB_DFB8R_VOFF
comma
id|FFB_DFB8R_POFF
comma
l_int|0x0400000
)brace
comma
(brace
id|FFB_DFB8G_VOFF
comma
id|FFB_DFB8G_POFF
comma
l_int|0x0400000
)brace
comma
(brace
id|FFB_DFB8B_VOFF
comma
id|FFB_DFB8B_POFF
comma
l_int|0x0400000
)brace
comma
(brace
id|FFB_DFB8X_VOFF
comma
id|FFB_DFB8X_POFF
comma
l_int|0x0400000
)brace
comma
(brace
id|FFB_DFB24_VOFF
comma
id|FFB_DFB24_POFF
comma
l_int|0x1000000
)brace
comma
(brace
id|FFB_DFB32_VOFF
comma
id|FFB_DFB32_POFF
comma
l_int|0x1000000
)brace
comma
(brace
id|FFB_FBC_KREGS_VOFF
comma
id|FFB_FBC_KREGS_POFF
comma
l_int|0x0002000
)brace
comma
(brace
id|FFB_DAC_VOFF
comma
id|FFB_DAC_POFF
comma
l_int|0x0002000
)brace
comma
(brace
id|FFB_PROM_VOFF
comma
id|FFB_PROM_POFF
comma
l_int|0x0010000
)brace
comma
(brace
id|FFB_EXP_VOFF
comma
id|FFB_EXP_POFF
comma
l_int|0x0002000
)brace
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
)brace
)brace
suffix:semicolon
DECL|variable|ffb_cmap
r_static
id|u32
id|ffb_cmap
(braket
l_int|16
)braket
suffix:semicolon
DECL|function|ffb_setup
r_static
r_void
id|ffb_setup
c_func
(paren
r_struct
id|display
op_star
id|p
)paren
(brace
id|p-&gt;next_line
op_assign
l_int|8192
suffix:semicolon
id|p-&gt;next_plane
op_assign
l_int|0
suffix:semicolon
)brace
DECL|function|ffb_bmove
r_static
r_void
id|ffb_bmove
c_func
(paren
r_struct
id|display
op_star
id|p
comma
r_int
id|sy
comma
r_int
id|sx
comma
r_int
id|dy
comma
r_int
id|dx
comma
r_int
id|height
comma
r_int
id|width
)paren
(brace
r_int
id|bytes
op_assign
id|p-&gt;next_line
comma
id|linesize
op_assign
id|bytes
op_star
id|p-&gt;fontheight
comma
id|rows
suffix:semicolon
id|u8
op_star
id|src
comma
op_star
id|dst
suffix:semicolon
r_if
c_cond
(paren
id|sx
op_eq
l_int|0
op_logical_and
id|dx
op_eq
l_int|0
op_logical_and
id|width
op_star
l_int|32
op_eq
id|bytes
)paren
id|mymemmove
c_func
(paren
id|p-&gt;screen_base
op_plus
id|dy
op_star
id|linesize
comma
id|p-&gt;screen_base
op_plus
id|sy
op_star
id|linesize
comma
id|height
op_star
id|linesize
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|dy
OL
id|sy
op_logical_or
(paren
id|dy
op_eq
id|sy
op_logical_and
id|dx
OL
id|sx
)paren
)paren
(brace
id|src
op_assign
id|p-&gt;screen_base
op_plus
id|sy
op_star
id|linesize
op_plus
id|sx
op_star
l_int|32
suffix:semicolon
id|dst
op_assign
id|p-&gt;screen_base
op_plus
id|dy
op_star
id|linesize
op_plus
id|dx
op_star
l_int|32
suffix:semicolon
r_for
c_loop
(paren
id|rows
op_assign
id|height
op_star
id|p-&gt;fontheight
suffix:semicolon
id|rows
op_decrement
suffix:semicolon
)paren
(brace
id|mymemmove
c_func
(paren
id|dst
comma
id|src
comma
id|width
op_star
l_int|32
)paren
suffix:semicolon
id|src
op_add_assign
id|bytes
suffix:semicolon
id|dst
op_add_assign
id|bytes
suffix:semicolon
)brace
)brace
r_else
(brace
id|src
op_assign
id|p-&gt;screen_base
op_plus
(paren
id|sy
op_plus
id|height
)paren
op_star
id|linesize
op_plus
id|sx
op_star
l_int|32
op_minus
id|bytes
suffix:semicolon
id|dst
op_assign
id|p-&gt;screen_base
op_plus
(paren
id|dy
op_plus
id|height
)paren
op_star
id|linesize
op_plus
id|dx
op_star
l_int|32
op_minus
id|bytes
suffix:semicolon
r_for
c_loop
(paren
id|rows
op_assign
id|height
op_star
id|p-&gt;fontheight
suffix:semicolon
id|rows
op_decrement
suffix:semicolon
)paren
(brace
id|mymemmove
c_func
(paren
id|dst
comma
id|src
comma
id|width
op_star
l_int|32
)paren
suffix:semicolon
id|src
op_sub_assign
id|bytes
suffix:semicolon
id|dst
op_sub_assign
id|bytes
suffix:semicolon
)brace
)brace
)brace
DECL|function|ffb_clear
r_static
r_void
id|ffb_clear
c_func
(paren
r_struct
id|vc_data
op_star
id|conp
comma
r_struct
id|display
op_star
id|p
comma
r_int
id|sy
comma
r_int
id|sx
comma
r_int
id|height
comma
r_int
id|width
)paren
(brace
r_struct
id|fb_info_sbusfb
op_star
id|fb
op_assign
(paren
r_struct
id|fb_info_sbusfb
op_star
)paren
id|p-&gt;fb_info
suffix:semicolon
r_register
r_struct
id|ffb_fbc
op_star
id|fbc
op_assign
id|fb-&gt;s.ffb.fbc
suffix:semicolon
r_int
id|x
comma
id|y
comma
id|w
comma
id|h
suffix:semicolon
id|fbc-&gt;ppc
op_assign
l_int|0x1803
suffix:semicolon
id|fbc-&gt;fg
op_assign
id|ffb_cmap
(braket
id|attr_bg_col_ec
c_func
(paren
id|conp
)paren
)braket
suffix:semicolon
id|fbc-&gt;fbc
op_assign
l_int|0x2000707f
suffix:semicolon
id|fbc-&gt;rop
op_assign
l_int|0x83
suffix:semicolon
id|fbc-&gt;pmask
op_assign
l_int|0xffffffff
suffix:semicolon
id|fbc-&gt;unk2
op_assign
l_int|8
suffix:semicolon
multiline_comment|/* FIXME: Optimize this by allowing 8/16 fontheigh only and introduce p-&gt;fontheightlog */
r_if
c_cond
(paren
id|p-&gt;fontheight
op_eq
l_int|16
)paren
(brace
id|y
op_assign
id|sy
op_lshift
l_int|4
suffix:semicolon
id|h
op_assign
id|height
op_lshift
l_int|4
suffix:semicolon
)brace
r_else
(brace
id|y
op_assign
id|sy
op_star
id|p-&gt;fontheight
suffix:semicolon
id|h
op_assign
id|height
op_star
id|p-&gt;fontheight
suffix:semicolon
)brace
id|x
op_assign
id|sx
op_lshift
l_int|3
suffix:semicolon
id|w
op_assign
id|width
op_lshift
l_int|3
suffix:semicolon
id|fbc-&gt;by
op_assign
id|y
op_plus
id|fb-&gt;y_margin
suffix:semicolon
id|fbc-&gt;bx
op_assign
id|x
op_plus
id|fb-&gt;x_margin
suffix:semicolon
id|fbc-&gt;bh
op_assign
id|h
suffix:semicolon
id|fbc-&gt;bw
op_assign
id|w
suffix:semicolon
)brace
DECL|function|ffb_fill
r_static
r_void
id|ffb_fill
c_func
(paren
r_struct
id|fb_info_sbusfb
op_star
id|fb
comma
r_int
id|s
comma
r_int
id|count
comma
r_int
r_int
op_star
id|boxes
)paren
(brace
r_register
r_struct
id|ffb_fbc
op_star
id|fbc
op_assign
id|fb-&gt;s.ffb.fbc
suffix:semicolon
id|fbc-&gt;ppc
op_assign
l_int|0x1803
suffix:semicolon
id|fbc-&gt;fg
op_assign
id|ffb_cmap
(braket
id|attr_bg_col
c_func
(paren
id|s
)paren
)braket
suffix:semicolon
id|fbc-&gt;fbc
op_assign
l_int|0x2000707f
suffix:semicolon
id|fbc-&gt;rop
op_assign
l_int|0x83
suffix:semicolon
id|fbc-&gt;pmask
op_assign
l_int|0xffffffff
suffix:semicolon
id|fbc-&gt;unk2
op_assign
l_int|8
suffix:semicolon
r_while
c_loop
(paren
id|count
op_decrement
OG
l_int|0
)paren
(brace
id|fbc-&gt;by
op_assign
id|boxes
(braket
l_int|1
)braket
suffix:semicolon
id|fbc-&gt;bx
op_assign
id|boxes
(braket
l_int|0
)braket
suffix:semicolon
id|fbc-&gt;bh
op_assign
id|boxes
(braket
l_int|3
)braket
op_minus
id|boxes
(braket
l_int|1
)braket
suffix:semicolon
id|fbc-&gt;bw
op_assign
id|boxes
(braket
l_int|2
)braket
op_minus
id|boxes
(braket
l_int|0
)braket
suffix:semicolon
id|boxes
op_add_assign
l_int|4
suffix:semicolon
)brace
)brace
DECL|function|ffb_putc
r_static
r_void
id|ffb_putc
c_func
(paren
r_struct
id|vc_data
op_star
id|conp
comma
r_struct
id|display
op_star
id|p
comma
r_int
id|c
comma
r_int
id|yy
comma
r_int
id|xx
)paren
(brace
r_struct
id|fb_info_sbusfb
op_star
id|fb
op_assign
(paren
r_struct
id|fb_info_sbusfb
op_star
)paren
id|p-&gt;fb_info
suffix:semicolon
r_register
r_struct
id|ffb_fbc
op_star
id|fbc
op_assign
id|fb-&gt;s.ffb.fbc
suffix:semicolon
r_int
id|i
comma
id|xy
suffix:semicolon
id|u8
op_star
id|fd
suffix:semicolon
r_if
c_cond
(paren
id|p-&gt;fontheight
op_eq
l_int|16
)paren
(brace
id|xy
op_assign
(paren
id|yy
op_lshift
(paren
l_int|16
op_plus
l_int|4
)paren
)paren
suffix:semicolon
id|fd
op_assign
id|p-&gt;fontdata
op_plus
(paren
(paren
id|c
op_amp
l_int|0xff
)paren
op_lshift
l_int|4
)paren
suffix:semicolon
)brace
r_else
(brace
id|xy
op_assign
(paren
(paren
id|yy
op_star
id|p-&gt;fontheight
)paren
op_lshift
l_int|16
)paren
suffix:semicolon
id|fd
op_assign
id|p-&gt;fontdata
op_plus
(paren
id|c
op_amp
l_int|0xff
)paren
op_star
id|p-&gt;fontheight
suffix:semicolon
)brace
id|xy
op_add_assign
(paren
id|xx
op_lshift
l_int|3
)paren
op_plus
id|fb-&gt;s.ffb.xy_margin
suffix:semicolon
id|fbc-&gt;ppc
op_assign
l_int|0x203
suffix:semicolon
id|fbc-&gt;fg
op_assign
id|ffb_cmap
(braket
id|attr_fg_col
c_func
(paren
id|c
)paren
)braket
suffix:semicolon
id|fbc-&gt;fbc
op_assign
l_int|0x2000707f
suffix:semicolon
id|fbc-&gt;rop
op_assign
l_int|0x83
suffix:semicolon
id|fbc-&gt;pmask
op_assign
l_int|0xffffffff
suffix:semicolon
id|fbc-&gt;bg
op_assign
id|ffb_cmap
(braket
id|attr_bg_col
c_func
(paren
id|c
)paren
)braket
suffix:semicolon
id|fbc-&gt;fontw
op_assign
l_int|8
suffix:semicolon
id|fbc-&gt;fontinc
op_assign
l_int|0x10000
suffix:semicolon
id|fbc-&gt;fontxy
op_assign
id|xy
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|p-&gt;fontheight
suffix:semicolon
id|i
op_increment
)paren
id|fbc-&gt;font
op_assign
op_star
id|fd
op_increment
op_lshift
l_int|24
suffix:semicolon
)brace
DECL|function|ffb_putcs
r_static
r_void
id|ffb_putcs
c_func
(paren
r_struct
id|vc_data
op_star
id|conp
comma
r_struct
id|display
op_star
id|p
comma
r_const
r_int
r_int
op_star
id|s
comma
r_int
id|count
comma
r_int
id|yy
comma
r_int
id|xx
)paren
(brace
r_struct
id|fb_info_sbusfb
op_star
id|fb
op_assign
(paren
r_struct
id|fb_info_sbusfb
op_star
)paren
id|p-&gt;fb_info
suffix:semicolon
r_register
r_struct
id|ffb_fbc
op_star
id|fbc
op_assign
id|fb-&gt;s.ffb.fbc
suffix:semicolon
r_int
id|i
comma
id|xy
suffix:semicolon
id|u8
op_star
id|fd1
comma
op_star
id|fd2
comma
op_star
id|fd3
comma
op_star
id|fd4
suffix:semicolon
id|fbc-&gt;ppc
op_assign
l_int|0x203
suffix:semicolon
id|fbc-&gt;fg
op_assign
id|ffb_cmap
(braket
id|attr_fg_col
c_func
(paren
op_star
id|s
)paren
)braket
suffix:semicolon
id|fbc-&gt;fbc
op_assign
l_int|0x2000707f
suffix:semicolon
id|fbc-&gt;rop
op_assign
l_int|0x83
suffix:semicolon
id|fbc-&gt;pmask
op_assign
l_int|0xffffffff
suffix:semicolon
id|fbc-&gt;bg
op_assign
id|ffb_cmap
(braket
id|attr_bg_col
c_func
(paren
op_star
id|s
)paren
)braket
suffix:semicolon
r_if
c_cond
(paren
id|p-&gt;fontheight
op_eq
l_int|16
)paren
(brace
id|xy
op_assign
(paren
id|yy
op_lshift
(paren
l_int|16
op_plus
l_int|4
)paren
)paren
op_plus
(paren
id|xx
op_lshift
l_int|3
)paren
op_plus
id|fb-&gt;s.ffb.xy_margin
suffix:semicolon
r_while
c_loop
(paren
id|count
op_ge
l_int|4
)paren
(brace
id|count
op_sub_assign
l_int|4
suffix:semicolon
id|fbc-&gt;fontw
op_assign
l_int|32
suffix:semicolon
id|fbc-&gt;fontinc
op_assign
l_int|0x10000
suffix:semicolon
id|fbc-&gt;fontxy
op_assign
id|xy
suffix:semicolon
id|fd1
op_assign
id|p-&gt;fontdata
op_plus
(paren
(paren
op_star
id|s
op_increment
op_amp
l_int|0xff
)paren
op_lshift
l_int|4
)paren
suffix:semicolon
id|fd2
op_assign
id|p-&gt;fontdata
op_plus
(paren
(paren
op_star
id|s
op_increment
op_amp
l_int|0xff
)paren
op_lshift
l_int|4
)paren
suffix:semicolon
id|fd3
op_assign
id|p-&gt;fontdata
op_plus
(paren
(paren
op_star
id|s
op_increment
op_amp
l_int|0xff
)paren
op_lshift
l_int|4
)paren
suffix:semicolon
id|fd4
op_assign
id|p-&gt;fontdata
op_plus
(paren
(paren
op_star
id|s
op_increment
op_amp
l_int|0xff
)paren
op_lshift
l_int|4
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|16
suffix:semicolon
id|i
op_increment
)paren
id|fbc-&gt;font
op_assign
(paren
(paren
id|u32
)paren
op_star
id|fd4
op_increment
)paren
op_or
(paren
(paren
(paren
(paren
id|u32
)paren
op_star
id|fd3
op_increment
)paren
op_or
(paren
(paren
(paren
(paren
id|u32
)paren
op_star
id|fd2
op_increment
)paren
op_or
(paren
(paren
(paren
id|u32
)paren
op_star
id|fd1
op_increment
)paren
op_lshift
l_int|8
)paren
)paren
op_lshift
l_int|8
)paren
)paren
op_lshift
l_int|8
)paren
suffix:semicolon
id|xy
op_add_assign
l_int|32
suffix:semicolon
)brace
r_while
c_loop
(paren
id|count
)paren
(brace
id|count
op_decrement
suffix:semicolon
id|fbc-&gt;fontw
op_assign
l_int|8
suffix:semicolon
id|fbc-&gt;fontinc
op_assign
l_int|0x10000
suffix:semicolon
id|fbc-&gt;fontxy
op_assign
id|xy
suffix:semicolon
id|fd1
op_assign
id|p-&gt;fontdata
op_plus
(paren
(paren
op_star
id|s
op_increment
op_amp
l_int|0xff
)paren
op_lshift
l_int|4
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|16
suffix:semicolon
id|i
op_increment
)paren
id|fbc-&gt;font
op_assign
op_star
id|fd1
op_increment
op_lshift
l_int|24
suffix:semicolon
id|xy
op_add_assign
l_int|8
suffix:semicolon
)brace
)brace
r_else
(brace
id|xy
op_assign
(paren
(paren
id|yy
op_star
id|p-&gt;fontheight
)paren
op_lshift
l_int|16
)paren
op_plus
(paren
id|xx
op_lshift
l_int|3
)paren
op_plus
id|fb-&gt;s.ffb.xy_margin
suffix:semicolon
r_while
c_loop
(paren
id|count
op_ge
l_int|4
)paren
(brace
id|count
op_sub_assign
l_int|4
suffix:semicolon
id|fbc-&gt;fontw
op_assign
l_int|32
suffix:semicolon
id|fbc-&gt;fontinc
op_assign
l_int|0x10000
suffix:semicolon
id|fbc-&gt;fontxy
op_assign
id|xy
suffix:semicolon
id|fd1
op_assign
id|p-&gt;fontdata
op_plus
(paren
(paren
op_star
id|s
op_increment
op_amp
l_int|0xff
)paren
op_star
id|p-&gt;fontheight
)paren
suffix:semicolon
id|fd2
op_assign
id|p-&gt;fontdata
op_plus
(paren
(paren
op_star
id|s
op_increment
op_amp
l_int|0xff
)paren
op_star
id|p-&gt;fontheight
)paren
suffix:semicolon
id|fd3
op_assign
id|p-&gt;fontdata
op_plus
(paren
(paren
op_star
id|s
op_increment
op_amp
l_int|0xff
)paren
op_star
id|p-&gt;fontheight
)paren
suffix:semicolon
id|fd4
op_assign
id|p-&gt;fontdata
op_plus
(paren
(paren
op_star
id|s
op_increment
op_amp
l_int|0xff
)paren
op_star
id|p-&gt;fontheight
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|p-&gt;fontheight
suffix:semicolon
id|i
op_increment
)paren
id|fbc-&gt;font
op_assign
(paren
(paren
id|u32
)paren
op_star
id|fd4
op_increment
)paren
op_or
(paren
(paren
(paren
(paren
id|u32
)paren
op_star
id|fd3
op_increment
)paren
op_or
(paren
(paren
(paren
(paren
id|u32
)paren
op_star
id|fd2
op_increment
)paren
op_or
(paren
(paren
(paren
id|u32
)paren
op_star
id|fd1
op_increment
)paren
op_lshift
l_int|8
)paren
)paren
op_lshift
l_int|8
)paren
)paren
op_lshift
l_int|8
)paren
suffix:semicolon
id|xy
op_add_assign
l_int|32
suffix:semicolon
)brace
r_while
c_loop
(paren
id|count
)paren
(brace
id|count
op_decrement
suffix:semicolon
id|fbc-&gt;fontw
op_assign
l_int|8
suffix:semicolon
id|fbc-&gt;fontinc
op_assign
l_int|0x10000
suffix:semicolon
id|fbc-&gt;fontxy
op_assign
id|xy
suffix:semicolon
id|fd1
op_assign
id|p-&gt;fontdata
op_plus
(paren
(paren
op_star
id|s
op_increment
op_amp
l_int|0xff
)paren
op_star
id|p-&gt;fontheight
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|16
suffix:semicolon
id|i
op_increment
)paren
id|fbc-&gt;font
op_assign
op_star
id|fd1
op_increment
op_lshift
l_int|24
suffix:semicolon
id|xy
op_add_assign
l_int|8
suffix:semicolon
)brace
)brace
)brace
DECL|function|ffb_revc
r_static
r_void
id|ffb_revc
c_func
(paren
r_struct
id|display
op_star
id|p
comma
r_int
id|xx
comma
r_int
id|yy
)paren
(brace
id|u8
op_star
id|dest
suffix:semicolon
r_int
id|bytes
op_assign
id|p-&gt;next_line
comma
id|rows
suffix:semicolon
id|dest
op_assign
id|p-&gt;screen_base
op_plus
id|yy
op_star
id|p-&gt;fontheight
op_star
id|bytes
op_plus
id|xx
op_star
l_int|32
suffix:semicolon
r_for
c_loop
(paren
id|rows
op_assign
id|p-&gt;fontheight
suffix:semicolon
id|rows
op_decrement
suffix:semicolon
id|dest
op_add_assign
id|bytes
)paren
(brace
(paren
(paren
id|u32
op_star
)paren
id|dest
)paren
(braket
l_int|0
)braket
op_xor_assign
l_int|0xffffffff
suffix:semicolon
(paren
(paren
id|u32
op_star
)paren
id|dest
)paren
(braket
l_int|1
)braket
op_xor_assign
l_int|0xffffffff
suffix:semicolon
(paren
(paren
id|u32
op_star
)paren
id|dest
)paren
(braket
l_int|2
)braket
op_xor_assign
l_int|0xffffffff
suffix:semicolon
(paren
(paren
id|u32
op_star
)paren
id|dest
)paren
(braket
l_int|3
)braket
op_xor_assign
l_int|0xffffffff
suffix:semicolon
(paren
(paren
id|u32
op_star
)paren
id|dest
)paren
(braket
l_int|4
)braket
op_xor_assign
l_int|0xffffffff
suffix:semicolon
(paren
(paren
id|u32
op_star
)paren
id|dest
)paren
(braket
l_int|5
)braket
op_xor_assign
l_int|0xffffffff
suffix:semicolon
(paren
(paren
id|u32
op_star
)paren
id|dest
)paren
(braket
l_int|6
)braket
op_xor_assign
l_int|0xffffffff
suffix:semicolon
(paren
(paren
id|u32
op_star
)paren
id|dest
)paren
(braket
l_int|7
)braket
op_xor_assign
l_int|0xffffffff
suffix:semicolon
)brace
)brace
DECL|function|ffb_loadcmap
r_static
r_void
id|ffb_loadcmap
(paren
r_struct
id|fb_info_sbusfb
op_star
id|fb
comma
r_int
id|index
comma
r_int
id|count
)paren
(brace
r_struct
id|ffb_dac
op_star
id|dac
op_assign
id|fb-&gt;s.ffb.dac
suffix:semicolon
r_int
id|i
comma
id|j
op_assign
id|count
suffix:semicolon
id|dac-&gt;type
op_assign
l_int|0x2000
op_or
id|index
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
id|index
suffix:semicolon
id|j
op_decrement
suffix:semicolon
id|i
op_increment
)paren
multiline_comment|/* Feed the colors in :)) */
id|dac-&gt;value
op_assign
(paren
(paren
id|fb-&gt;color_map
id|CM
c_func
(paren
id|i
comma
l_int|0
)paren
)paren
)paren
op_or
(paren
(paren
id|fb-&gt;color_map
id|CM
c_func
(paren
id|i
comma
l_int|1
)paren
)paren
op_lshift
l_int|8
)paren
op_or
(paren
(paren
id|fb-&gt;color_map
id|CM
c_func
(paren
id|i
comma
l_int|2
)paren
)paren
op_lshift
l_int|16
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
id|index
comma
id|j
op_assign
id|count
suffix:semicolon
id|i
OL
l_int|16
op_logical_and
id|j
op_decrement
suffix:semicolon
id|i
op_increment
)paren
id|ffb_cmap
(braket
id|i
)braket
op_assign
(paren
(paren
id|fb-&gt;color_map
id|CM
c_func
(paren
id|i
comma
l_int|0
)paren
)paren
)paren
op_or
(paren
(paren
id|fb-&gt;color_map
id|CM
c_func
(paren
id|i
comma
l_int|1
)paren
)paren
op_lshift
l_int|8
)paren
op_or
(paren
(paren
id|fb-&gt;color_map
id|CM
c_func
(paren
id|i
comma
l_int|2
)paren
)paren
op_lshift
l_int|16
)paren
suffix:semicolon
)brace
DECL|variable|__initdata
r_static
r_struct
id|display_switch
id|ffb_dispsw
id|__initdata
op_assign
(brace
id|ffb_setup
comma
id|ffb_bmove
comma
id|ffb_clear
comma
id|ffb_putc
comma
id|ffb_putcs
comma
id|ffb_revc
comma
l_int|NULL
)brace
suffix:semicolon
DECL|function|ffb_curs_enable
r_static
r_inline
r_void
id|ffb_curs_enable
(paren
r_struct
id|fb_info_sbusfb
op_star
id|fb
comma
r_int
id|enable
)paren
(brace
r_struct
id|ffb_dac
op_star
id|dac
op_assign
id|fb-&gt;s.ffb.dac
suffix:semicolon
id|dac-&gt;type2
op_assign
l_int|0x100
suffix:semicolon
r_if
c_cond
(paren
id|fb-&gt;s.ffb.dac_rev
op_le
l_int|2
)paren
id|dac-&gt;value2
op_assign
id|enable
ques
c_cond
l_int|3
suffix:colon
l_int|0
suffix:semicolon
r_else
id|dac-&gt;value2
op_assign
id|enable
ques
c_cond
l_int|0
suffix:colon
l_int|3
suffix:semicolon
)brace
DECL|function|ffb_setcursormap
r_static
r_void
id|ffb_setcursormap
(paren
r_struct
id|fb_info_sbusfb
op_star
id|fb
comma
id|u8
op_star
id|red
comma
id|u8
op_star
id|green
comma
id|u8
op_star
id|blue
)paren
(brace
r_struct
id|ffb_dac
op_star
id|dac
op_assign
id|fb-&gt;s.ffb.dac
suffix:semicolon
id|ffb_curs_enable
(paren
id|fb
comma
l_int|0
)paren
suffix:semicolon
id|dac-&gt;type2
op_assign
l_int|0x102
suffix:semicolon
id|dac-&gt;value2
op_assign
(paren
id|red
(braket
l_int|0
)braket
op_or
(paren
id|green
(braket
l_int|0
)braket
op_lshift
l_int|8
)paren
op_or
(paren
id|blue
(braket
l_int|0
)braket
op_lshift
l_int|16
)paren
)paren
suffix:semicolon
id|dac-&gt;value2
op_assign
(paren
id|red
(braket
l_int|1
)braket
op_or
(paren
id|green
(braket
l_int|1
)braket
op_lshift
l_int|8
)paren
op_or
(paren
id|blue
(braket
l_int|1
)braket
op_lshift
l_int|16
)paren
)paren
suffix:semicolon
)brace
multiline_comment|/* Set cursor shape */
DECL|function|ffb_setcurshape
r_static
r_void
id|ffb_setcurshape
(paren
r_struct
id|fb_info_sbusfb
op_star
id|fb
)paren
(brace
r_struct
id|ffb_dac
op_star
id|dac
op_assign
id|fb-&gt;s.ffb.dac
suffix:semicolon
r_int
id|i
comma
id|j
suffix:semicolon
id|ffb_curs_enable
(paren
id|fb
comma
l_int|0
)paren
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
l_int|2
suffix:semicolon
id|j
op_increment
)paren
(brace
id|dac-&gt;type2
op_assign
id|j
ques
c_cond
l_int|0
suffix:colon
l_int|0x80
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|0x40
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|fb-&gt;cursor.size.fbx
op_le
l_int|32
)paren
(brace
id|dac-&gt;value2
op_assign
id|fb-&gt;cursor.bits
(braket
id|j
)braket
(braket
id|i
)braket
suffix:semicolon
id|dac-&gt;value2
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|dac-&gt;value2
op_assign
id|fb-&gt;cursor.bits
(braket
id|j
)braket
(braket
l_int|2
op_star
id|i
)braket
suffix:semicolon
id|dac-&gt;value2
op_assign
id|fb-&gt;cursor.bits
(braket
id|j
)braket
(braket
l_int|2
op_star
id|i
op_plus
l_int|1
)braket
suffix:semicolon
)brace
)brace
)brace
)brace
multiline_comment|/* Load cursor information */
DECL|function|ffb_setcursor
r_static
r_void
id|ffb_setcursor
(paren
r_struct
id|fb_info_sbusfb
op_star
id|fb
)paren
(brace
r_struct
id|ffb_dac
op_star
id|dac
op_assign
id|fb-&gt;s.ffb.dac
suffix:semicolon
r_struct
id|cg_cursor
op_star
id|c
op_assign
op_amp
id|fb-&gt;cursor
suffix:semicolon
id|dac-&gt;type2
op_assign
l_int|0x104
suffix:semicolon
multiline_comment|/* Should this be just 0x7ff?? &n;&t;   Should I do some margin handling and setcurshape in that case? */
id|dac-&gt;value2
op_assign
(paren
(paren
(paren
id|c-&gt;cpos.fby
op_minus
id|c-&gt;chot.fby
)paren
op_amp
l_int|0xffff
)paren
op_lshift
l_int|16
)paren
op_or
(paren
(paren
id|c-&gt;cpos.fbx
op_minus
id|c-&gt;chot.fbx
)paren
op_amp
l_int|0xffff
)paren
suffix:semicolon
id|ffb_curs_enable
(paren
id|fb
comma
id|fb-&gt;cursor.enable
)paren
suffix:semicolon
)brace
DECL|variable|__initdata
r_static
r_char
id|idstring
(braket
l_int|60
)braket
id|__initdata
op_assign
(brace
l_int|0
)brace
suffix:semicolon
DECL|function|__initfunc
id|__initfunc
c_func
(paren
r_char
op_star
id|creatorfb_init
c_func
(paren
r_struct
id|fb_info_sbusfb
op_star
id|fb
)paren
)paren
(brace
r_struct
id|fb_fix_screeninfo
op_star
id|fix
op_assign
op_amp
id|fb-&gt;fix
suffix:semicolon
r_struct
id|fb_var_screeninfo
op_star
id|var
op_assign
op_amp
id|fb-&gt;var
suffix:semicolon
r_struct
id|display
op_star
id|disp
op_assign
op_amp
id|fb-&gt;disp
suffix:semicolon
r_struct
id|fbtype
op_star
id|type
op_assign
op_amp
id|fb-&gt;type
suffix:semicolon
r_struct
id|linux_prom64_registers
id|regs
(braket
l_int|2
op_star
id|PROMREG_MAX
)braket
suffix:semicolon
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
id|prom_getproperty
c_func
(paren
id|fb-&gt;prom_node
comma
l_string|&quot;reg&quot;
comma
(paren
r_void
op_star
)paren
id|regs
comma
r_sizeof
(paren
id|regs
)paren
)paren
op_le
l_int|0
)paren
r_return
l_int|NULL
suffix:semicolon
id|strcpy
c_func
(paren
id|fb-&gt;info.modename
comma
l_string|&quot;Creator&quot;
)paren
suffix:semicolon
id|strcpy
c_func
(paren
id|fix-&gt;id
comma
l_string|&quot;Creator&quot;
)paren
suffix:semicolon
id|fix-&gt;smem_start
op_assign
(paren
r_char
op_star
)paren
(paren
id|regs
(braket
l_int|0
)braket
dot
id|phys_addr
)paren
op_plus
id|FFB_DFB24_POFF
suffix:semicolon
id|fix-&gt;visual
op_assign
id|FB_VISUAL_DIRECTCOLOR
suffix:semicolon
id|fix-&gt;line_length
op_assign
l_int|8192
suffix:semicolon
id|fix-&gt;mmio_start
op_assign
(paren
r_char
op_star
)paren
(paren
id|regs
(braket
l_int|0
)braket
dot
id|phys_addr
)paren
op_plus
id|FFB_FBC_REGS_POFF
suffix:semicolon
id|fix-&gt;mmio_len
op_assign
id|PAGE_SIZE
suffix:semicolon
id|var-&gt;bits_per_pixel
op_assign
l_int|32
suffix:semicolon
id|var-&gt;green.offset
op_assign
l_int|8
suffix:semicolon
id|var-&gt;blue.offset
op_assign
l_int|16
suffix:semicolon
id|var-&gt;accel_flags
op_assign
id|FB_ACCELF_TEXT
suffix:semicolon
id|disp-&gt;scrollmode
op_assign
id|SCROLL_YREDRAW
suffix:semicolon
id|disp-&gt;screen_base
op_assign
(paren
r_char
op_star
)paren
id|__va
c_func
(paren
id|regs
(braket
l_int|0
)braket
dot
id|phys_addr
)paren
op_plus
id|FFB_DFB24_POFF
op_plus
l_int|8192
op_star
id|fb-&gt;y_margin
op_plus
l_int|4
op_star
id|fb-&gt;x_margin
suffix:semicolon
id|fb-&gt;s.ffb.xy_margin
op_assign
(paren
id|fb-&gt;y_margin
op_lshift
l_int|16
)paren
op_plus
id|fb-&gt;x_margin
suffix:semicolon
id|fb-&gt;s.ffb.fbc
op_assign
(paren
r_struct
id|ffb_fbc
op_star
)paren
(paren
(paren
r_char
op_star
)paren
id|__va
c_func
(paren
id|regs
(braket
l_int|0
)braket
dot
id|phys_addr
)paren
op_plus
id|FFB_FBC_REGS_POFF
)paren
suffix:semicolon
id|fb-&gt;s.ffb.dac
op_assign
(paren
r_struct
id|ffb_dac
op_star
)paren
(paren
(paren
r_char
op_star
)paren
id|__va
c_func
(paren
id|regs
(braket
l_int|0
)braket
dot
id|phys_addr
)paren
op_plus
id|FFB_DAC_POFF
)paren
suffix:semicolon
id|fb-&gt;dispsw
op_assign
id|ffb_dispsw
suffix:semicolon
id|fb-&gt;loadcmap
op_assign
id|ffb_loadcmap
suffix:semicolon
id|fb-&gt;setcursor
op_assign
id|ffb_setcursor
suffix:semicolon
id|fb-&gt;setcursormap
op_assign
id|ffb_setcursormap
suffix:semicolon
id|fb-&gt;setcurshape
op_assign
id|ffb_setcurshape
suffix:semicolon
id|fb-&gt;fill
op_assign
id|ffb_fill
suffix:semicolon
id|fb-&gt;physbase
op_assign
id|regs
(braket
l_int|0
)braket
dot
id|phys_addr
suffix:semicolon
id|fb-&gt;mmap_map
op_assign
id|ffb_mmap_map
suffix:semicolon
id|fb-&gt;cursor.hwsize.fbx
op_assign
l_int|64
suffix:semicolon
id|fb-&gt;cursor.hwsize.fby
op_assign
l_int|64
suffix:semicolon
id|type-&gt;fb_depth
op_assign
l_int|24
suffix:semicolon
id|fb-&gt;s.ffb.dac-&gt;type
op_assign
l_int|0x8000
suffix:semicolon
id|fb-&gt;s.ffb.dac_rev
op_assign
(paren
id|fb-&gt;s.ffb.dac-&gt;value
op_rshift
l_int|0x1c
)paren
suffix:semicolon
id|i
op_assign
id|prom_getintdefault
(paren
id|fb-&gt;prom_node
comma
l_string|&quot;board_type&quot;
comma
l_int|8
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|idstring
comma
l_string|&quot;Creator at %016lx type %d DAC %d&quot;
comma
id|regs
(braket
l_int|0
)braket
dot
id|phys_addr
comma
id|i
comma
id|fb-&gt;s.ffb.dac_rev
)paren
suffix:semicolon
r_return
id|idstring
suffix:semicolon
)brace
eof
