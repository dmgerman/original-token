multiline_comment|/*&n; *&n; * Hardware accelerated Matrox Millennium I, II, Mystique, G100, G200 and G400&n; *&n; * (c) 1998,1999,2000 Petr Vandrovec &lt;vandrove@vc.cvut.cz&gt;&n; *&n; * Version: 1.50 2000/08/10&n; *&n; * MTRR stuff: 1998 Tom Rini &lt;trini@kernel.crashing.org&gt;&n; *&n; * Contributors: &quot;menion?&quot; &lt;menion@mindless.com&gt;&n; *                     Betatesting, fixes, ideas&n; *&n; *               &quot;Kurt Garloff&quot; &lt;garloff@suse.de&gt;&n; *                     Betatesting, fixes, ideas, videomodes, videomodes timmings&n; *&n; *               &quot;Tom Rini&quot; &lt;trini@kernel.crashing.org&gt;&n; *                     MTRR stuff, PPC cleanups, betatesting, fixes, ideas&n; *&n; *               &quot;Bibek Sahu&quot; &lt;scorpio@dodds.net&gt;&n; *                     Access device through readb|w|l and write b|w|l&n; *                     Extensive debugging stuff&n; *&n; *               &quot;Daniel Haun&quot; &lt;haund@usa.net&gt;&n; *                     Testing, hardware cursor fixes&n; *&n; *               &quot;Scott Wood&quot; &lt;sawst46+@pitt.edu&gt;&n; *                     Fixes&n; *&n; *               &quot;Gerd Knorr&quot; &lt;kraxel@goldbach.isdn.cs.tu-berlin.de&gt;&n; *                     Betatesting&n; *&n; *               &quot;Kelly French&quot; &lt;targon@hazmat.com&gt;&n; *               &quot;Fernando Herrera&quot; &lt;fherrera@eurielec.etsit.upm.es&gt;&n; *                     Betatesting, bug reporting&n; *&n; *               &quot;Pablo Bianucci&quot; &lt;pbian@pccp.com.ar&gt;&n; *                     Fixes, ideas, betatesting&n; *&n; *               &quot;Inaky Perez Gonzalez&quot; &lt;inaky@peloncho.fis.ucm.es&gt;&n; *                     Fixes, enhandcements, ideas, betatesting&n; *&n; *               &quot;Ryuichi Oikawa&quot; &lt;roikawa@rr.iiij4u.or.jp&gt;&n; *                     PPC betatesting, PPC support, backward compatibility&n; *&n; *               &quot;Paul Womar&quot; &lt;Paul@pwomar.demon.co.uk&gt;&n; *               &quot;Owen Waller&quot; &lt;O.Waller@ee.qub.ac.uk&gt;&n; *                     PPC betatesting&n; *&n; *               &quot;Thomas Pornin&quot; &lt;pornin@bolet.ens.fr&gt;&n; *                     Alpha betatesting&n; *&n; *               &quot;Pieter van Leuven&quot; &lt;pvl@iae.nl&gt;&n; *               &quot;Ulf Jaenicke-Roessler&quot; &lt;ujr@physik.phy.tu-dresden.de&gt;&n; *                     G100 testing&n; *&n; *               &quot;H. Peter Arvin&quot; &lt;hpa@transmeta.com&gt;&n; *                     Ideas&n; *&n; *               &quot;Cort Dougan&quot; &lt;cort@cs.nmt.edu&gt;&n; *                     CHRP fixes and PReP cleanup&n; *&n; *               &quot;Mark Vojkovich&quot; &lt;mvojkovi@ucsd.edu&gt;&n; *                     G400 support&n; *&n; *               &quot;Ken Aaker&quot; &lt;kdaaker@rchland.vnet.ibm.com&gt;&n; *                     memtype extension (needed for GXT130P RS/6000 adapter)&n; *&n; * (following author is not in any relation with this code, but his code&n; *  is included in this driver)&n; *&n; * Based on framebuffer driver for VBE 2.0 compliant graphic boards&n; *     (c) 1998 Gerd Knorr &lt;kraxel@cs.tu-berlin.de&gt;&n; *&n; * (following author is not in any relation with this code, but his ideas&n; *  were used when writting this driver)&n; *&n; *&t;&t; FreeVBE/AF (Matrox), &quot;Shawn Hargreaves&quot; &lt;shawn@talula.demon.co.uk&gt;&n; *&n; */
multiline_comment|/* make checkconfig does not walk through include tree :-( */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &quot;matroxfb_DAC1064.h&quot;
macro_line|#include &quot;matroxfb_misc.h&quot;
macro_line|#include &quot;matroxfb_accel.h&quot;
macro_line|#include &lt;linux/matroxfb.h&gt;
macro_line|#ifdef NEED_DAC1064
DECL|macro|outDAC1064
mdefine_line|#define outDAC1064 matroxfb_DAC_out
DECL|macro|inDAC1064
mdefine_line|#define inDAC1064 matroxfb_DAC_in
DECL|macro|DAC1064_OPT_SCLK_PCI
mdefine_line|#define DAC1064_OPT_SCLK_PCI&t;0x00
DECL|macro|DAC1064_OPT_SCLK_PLL
mdefine_line|#define DAC1064_OPT_SCLK_PLL&t;0x01
DECL|macro|DAC1064_OPT_SCLK_EXT
mdefine_line|#define DAC1064_OPT_SCLK_EXT&t;0x02
DECL|macro|DAC1064_OPT_SCLK_MASK
mdefine_line|#define DAC1064_OPT_SCLK_MASK&t;0x03
DECL|macro|DAC1064_OPT_GDIV1
mdefine_line|#define DAC1064_OPT_GDIV1&t;0x04&t;/* maybe it is GDIV2 on G100 ?! */
DECL|macro|DAC1064_OPT_GDIV3
mdefine_line|#define DAC1064_OPT_GDIV3&t;0x00
DECL|macro|DAC1064_OPT_MDIV1
mdefine_line|#define DAC1064_OPT_MDIV1&t;0x08
DECL|macro|DAC1064_OPT_MDIV2
mdefine_line|#define DAC1064_OPT_MDIV2&t;0x00
DECL|macro|DAC1064_OPT_RESERVED
mdefine_line|#define DAC1064_OPT_RESERVED&t;0x10
DECL|function|matroxfb_DAC1064_flashcursor
r_static
r_void
id|matroxfb_DAC1064_flashcursor
c_func
(paren
r_int
r_int
id|ptr
)paren
(brace
DECL|macro|minfo
mdefine_line|#define minfo ((struct matrox_fb_info*)ptr)
id|matroxfb_DAC_lock
c_func
(paren
)paren
suffix:semicolon
id|outDAC1064
c_func
(paren
id|PMINFO
id|M1064_XCURCTRL
comma
id|inDAC1064
c_func
(paren
id|PMINFO
id|M1064_XCURCTRL
)paren
op_xor
id|M1064_XCURCTRL_DIS
op_xor
id|M1064_XCURCTRL_XGA
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|cursor.timer.expires
)paren
op_assign
id|jiffies
op_plus
id|HZ
op_div
l_int|2
suffix:semicolon
id|add_timer
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|cursor.timer
)paren
)paren
suffix:semicolon
id|matroxfb_DAC_unlock
c_func
(paren
)paren
suffix:semicolon
DECL|macro|minfo
macro_line|#undef minfo
)brace
DECL|function|matroxfb_DAC1064_createcursor
r_static
r_void
id|matroxfb_DAC1064_createcursor
c_func
(paren
id|WPMINFO
r_struct
id|display
op_star
id|p
)paren
(brace
id|vaddr_t
id|cursorbase
suffix:semicolon
id|u_int32_t
id|xline
suffix:semicolon
r_int
r_int
id|i
suffix:semicolon
r_int
r_int
id|h
comma
id|to
suffix:semicolon
id|CRITFLAGS
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|currcon_display
)paren
op_ne
id|p
)paren
r_return
suffix:semicolon
id|matroxfb_createcursorshape
c_func
(paren
id|PMINFO
id|p
comma
id|p-&gt;var.vmode
)paren
suffix:semicolon
id|xline
op_assign
(paren
op_complement
l_int|0
)paren
op_lshift
(paren
l_int|32
op_minus
id|ACCESS_FBINFO
c_func
(paren
id|cursor.w
)paren
)paren
suffix:semicolon
id|cursorbase
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
suffix:semicolon
id|h
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|features.DAC1064.cursorimage
)paren
suffix:semicolon
id|CRITBEGIN
macro_line|#ifdef __BIG_ENDIAN
id|WaitTillIdle
c_func
(paren
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_OPMODE
comma
id|M_OPMODE_32BPP
)paren
suffix:semicolon
macro_line|#endif
id|to
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|cursor.u
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|to
suffix:semicolon
id|i
op_increment
)paren
(brace
id|mga_writel
c_func
(paren
id|cursorbase
comma
id|h
comma
l_int|0
)paren
suffix:semicolon
id|mga_writel
c_func
(paren
id|cursorbase
comma
id|h
op_plus
l_int|4
comma
l_int|0
)paren
suffix:semicolon
id|mga_writel
c_func
(paren
id|cursorbase
comma
id|h
op_plus
l_int|8
comma
op_complement
l_int|0
)paren
suffix:semicolon
id|mga_writel
c_func
(paren
id|cursorbase
comma
id|h
op_plus
l_int|12
comma
op_complement
l_int|0
)paren
suffix:semicolon
id|h
op_add_assign
l_int|16
suffix:semicolon
)brace
id|to
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|cursor.d
)paren
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
id|i
OL
id|to
suffix:semicolon
id|i
op_increment
)paren
(brace
id|mga_writel
c_func
(paren
id|cursorbase
comma
id|h
comma
l_int|0
)paren
suffix:semicolon
id|mga_writel
c_func
(paren
id|cursorbase
comma
id|h
op_plus
l_int|4
comma
id|xline
)paren
suffix:semicolon
id|mga_writel
c_func
(paren
id|cursorbase
comma
id|h
op_plus
l_int|8
comma
op_complement
l_int|0
)paren
suffix:semicolon
id|mga_writel
c_func
(paren
id|cursorbase
comma
id|h
op_plus
l_int|12
comma
op_complement
l_int|0
)paren
suffix:semicolon
id|h
op_add_assign
l_int|16
suffix:semicolon
)brace
r_for
c_loop
(paren
suffix:semicolon
id|i
OL
l_int|64
suffix:semicolon
id|i
op_increment
)paren
(brace
id|mga_writel
c_func
(paren
id|cursorbase
comma
id|h
comma
l_int|0
)paren
suffix:semicolon
id|mga_writel
c_func
(paren
id|cursorbase
comma
id|h
op_plus
l_int|4
comma
l_int|0
)paren
suffix:semicolon
id|mga_writel
c_func
(paren
id|cursorbase
comma
id|h
op_plus
l_int|8
comma
op_complement
l_int|0
)paren
suffix:semicolon
id|mga_writel
c_func
(paren
id|cursorbase
comma
id|h
op_plus
l_int|12
comma
op_complement
l_int|0
)paren
suffix:semicolon
id|h
op_add_assign
l_int|16
suffix:semicolon
)brace
macro_line|#ifdef __BIG_ENDIAN
id|mga_outl
c_func
(paren
id|M_OPMODE
comma
id|ACCESS_FBINFO
c_func
(paren
id|accel.m_opmode
)paren
)paren
suffix:semicolon
macro_line|#endif
id|CRITEND
)brace
DECL|function|matroxfb_DAC1064_cursor
r_static
r_void
id|matroxfb_DAC1064_cursor
c_func
(paren
r_struct
id|display
op_star
id|p
comma
r_int
id|mode
comma
r_int
id|x
comma
r_int
id|y
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
id|MINFO_FROM_DISP
c_func
(paren
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|currcon_display
)paren
op_ne
id|p
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|mode
op_eq
id|CM_ERASE
)paren
(brace
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|cursor.state
)paren
op_ne
id|CM_ERASE
)paren
(brace
id|del_timer_sync
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|cursor.timer
)paren
)paren
suffix:semicolon
id|matroxfb_DAC_lock_irqsave
c_func
(paren
id|flags
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|cursor.state
)paren
op_assign
id|CM_ERASE
suffix:semicolon
id|outDAC1064
c_func
(paren
id|PMINFO
id|M1064_XCURCTRL
comma
id|M1064_XCURCTRL_DIS
)paren
suffix:semicolon
id|matroxfb_DAC_unlock_irqrestore
c_func
(paren
id|flags
)paren
suffix:semicolon
)brace
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|p-&gt;conp-&gt;vc_cursor_type
op_amp
id|CUR_HWMASK
)paren
op_ne
id|ACCESS_FBINFO
c_func
(paren
id|cursor.type
)paren
)paren
id|matroxfb_DAC1064_createcursor
c_func
(paren
id|PMINFO
id|p
)paren
suffix:semicolon
id|x
op_mul_assign
id|fontwidth
c_func
(paren
id|p
)paren
suffix:semicolon
id|y
op_mul_assign
id|fontheight
c_func
(paren
id|p
)paren
suffix:semicolon
id|y
op_sub_assign
id|p-&gt;var.yoffset
suffix:semicolon
r_if
c_cond
(paren
id|p-&gt;var.vmode
op_amp
id|FB_VMODE_DOUBLE
)paren
id|y
op_mul_assign
l_int|2
suffix:semicolon
id|del_timer_sync
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|cursor.timer
)paren
)paren
suffix:semicolon
id|matroxfb_DAC_lock_irqsave
c_func
(paren
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|x
op_ne
id|ACCESS_FBINFO
c_func
(paren
id|cursor.x
)paren
)paren
op_logical_or
(paren
id|y
op_ne
id|ACCESS_FBINFO
c_func
(paren
id|cursor.y
)paren
)paren
op_logical_or
id|ACCESS_FBINFO
c_func
(paren
id|cursor.redraw
)paren
)paren
(brace
id|ACCESS_FBINFO
c_func
(paren
id|cursor.redraw
)paren
op_assign
l_int|0
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|cursor.x
)paren
op_assign
id|x
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|cursor.y
)paren
op_assign
id|y
suffix:semicolon
id|x
op_add_assign
l_int|64
suffix:semicolon
id|y
op_add_assign
l_int|64
suffix:semicolon
id|outDAC1064
c_func
(paren
id|PMINFO
id|M1064_XCURCTRL
comma
id|M1064_XCURCTRL_DIS
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|M1064_CURPOSXL
comma
id|x
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|M1064_CURPOSXH
comma
id|x
op_rshift
l_int|8
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|M1064_CURPOSYL
comma
id|y
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_RAMDAC_BASE
op_plus
id|M1064_CURPOSYH
comma
id|y
op_rshift
l_int|8
)paren
suffix:semicolon
)brace
id|ACCESS_FBINFO
c_func
(paren
id|cursor.state
)paren
op_assign
id|CM_DRAW
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.blink
)paren
)paren
id|mod_timer
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|cursor.timer
)paren
comma
id|jiffies
op_plus
id|HZ
op_div
l_int|2
)paren
suffix:semicolon
id|outDAC1064
c_func
(paren
id|PMINFO
id|M1064_XCURCTRL
comma
id|M1064_XCURCTRL_XGA
)paren
suffix:semicolon
id|matroxfb_DAC_unlock_irqrestore
c_func
(paren
id|flags
)paren
suffix:semicolon
)brace
DECL|function|matroxfb_DAC1064_setfont
r_static
r_int
id|matroxfb_DAC1064_setfont
c_func
(paren
r_struct
id|display
op_star
id|p
comma
r_int
id|width
comma
r_int
id|height
)paren
(brace
r_if
c_cond
(paren
id|p
op_logical_and
id|p-&gt;conp
)paren
id|matroxfb_DAC1064_createcursor
c_func
(paren
id|PMXINFO
c_func
(paren
id|p
)paren
id|p
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|DAC1064_selhwcursor
r_static
r_int
id|DAC1064_selhwcursor
c_func
(paren
id|WPMINFO
r_struct
id|display
op_star
id|p
)paren
(brace
id|ACCESS_FBINFO
c_func
(paren
id|dispsw.cursor
)paren
op_assign
id|matroxfb_DAC1064_cursor
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|dispsw.set_font
)paren
op_assign
id|matroxfb_DAC1064_setfont
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|DAC1064_calcclock
r_static
r_void
id|DAC1064_calcclock
c_func
(paren
id|CPMINFO
r_int
r_int
id|freq
comma
r_int
r_int
id|fmax
comma
r_int
r_int
op_star
id|in
comma
r_int
r_int
op_star
id|feed
comma
r_int
r_int
op_star
id|post
)paren
(brace
r_int
r_int
id|fvco
suffix:semicolon
r_int
r_int
id|p
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;DAC1064_calcclock&quot;
)paren
id|fvco
op_assign
id|PLL_calcclock
c_func
(paren
id|PMINFO
id|freq
comma
id|fmax
comma
id|in
comma
id|feed
comma
op_amp
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.g450dac
)paren
)paren
(brace
r_if
c_cond
(paren
id|fvco
op_le
l_int|300000
)paren
multiline_comment|/* 276-324 */
suffix:semicolon
r_else
r_if
c_cond
(paren
id|fvco
op_le
l_int|400000
)paren
multiline_comment|/* 378-438 */
id|p
op_or_assign
l_int|0x08
suffix:semicolon
r_else
r_if
c_cond
(paren
id|fvco
op_le
l_int|550000
)paren
multiline_comment|/* 540-567 */
id|p
op_or_assign
l_int|0x10
suffix:semicolon
r_else
r_if
c_cond
(paren
id|fvco
op_le
l_int|690000
)paren
multiline_comment|/* 675-695 */
id|p
op_or_assign
l_int|0x18
suffix:semicolon
r_else
r_if
c_cond
(paren
id|fvco
op_le
l_int|800000
)paren
multiline_comment|/* 776-803 */
id|p
op_or_assign
l_int|0x20
suffix:semicolon
r_else
r_if
c_cond
(paren
id|fvco
op_le
l_int|891000
)paren
multiline_comment|/* 891-891 */
id|p
op_or_assign
l_int|0x28
suffix:semicolon
r_else
r_if
c_cond
(paren
id|fvco
op_le
l_int|940000
)paren
multiline_comment|/* 931-945 */
id|p
op_or_assign
l_int|0x30
suffix:semicolon
r_else
multiline_comment|/* &lt;959 */
id|p
op_or_assign
l_int|0x38
suffix:semicolon
)brace
r_else
(brace
id|p
op_assign
(paren
l_int|1
op_lshift
id|p
)paren
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|fvco
op_le
l_int|100000
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|fvco
op_le
l_int|140000
)paren
id|p
op_or_assign
l_int|0x08
suffix:semicolon
r_else
r_if
c_cond
(paren
id|fvco
op_le
l_int|180000
)paren
id|p
op_or_assign
l_int|0x10
suffix:semicolon
r_else
id|p
op_or_assign
l_int|0x18
suffix:semicolon
)brace
op_star
id|post
op_assign
id|p
suffix:semicolon
)brace
multiline_comment|/* they must be in POS order */
DECL|variable|MGA1064_DAC_regs
r_static
r_const
r_int
r_char
id|MGA1064_DAC_regs
(braket
)braket
op_assign
(brace
id|M1064_XCURADDL
comma
id|M1064_XCURADDH
comma
id|M1064_XCURCTRL
comma
id|M1064_XCURCOL0RED
comma
id|M1064_XCURCOL0GREEN
comma
id|M1064_XCURCOL0BLUE
comma
id|M1064_XCURCOL1RED
comma
id|M1064_XCURCOL1GREEN
comma
id|M1064_XCURCOL1BLUE
comma
id|M1064_XCURCOL2RED
comma
id|M1064_XCURCOL2GREEN
comma
id|M1064_XCURCOL2BLUE
comma
id|DAC1064_XVREFCTRL
comma
id|M1064_XMULCTRL
comma
id|M1064_XPIXCLKCTRL
comma
id|M1064_XGENCTRL
comma
id|M1064_XMISCCTRL
comma
id|M1064_XGENIOCTRL
comma
id|M1064_XGENIODATA
comma
id|M1064_XZOOMCTRL
comma
id|M1064_XSENSETEST
comma
id|M1064_XCRCBITSEL
comma
id|M1064_XCOLKEYMASKL
comma
id|M1064_XCOLKEYMASKH
comma
id|M1064_XCOLKEYL
comma
id|M1064_XCOLKEYH
)brace
suffix:semicolon
DECL|variable|MGA1064_DAC
r_static
r_const
r_int
r_char
id|MGA1064_DAC
(braket
)braket
op_assign
(brace
l_int|0x00
comma
l_int|0x00
comma
id|M1064_XCURCTRL_DIS
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
multiline_comment|/* black */
l_int|0xFF
comma
l_int|0xFF
comma
l_int|0xFF
comma
multiline_comment|/* white */
l_int|0xFF
comma
l_int|0x00
comma
l_int|0x00
comma
multiline_comment|/* red */
l_int|0x00
comma
l_int|0
comma
id|M1064_XPIXCLKCTRL_PLL_UP
op_or
id|M1064_XPIXCLKCTRL_EN
op_or
id|M1064_XPIXCLKCTRL_SRC_PLL
comma
id|M1064_XGENCTRL_VS_0
op_or
id|M1064_XGENCTRL_ALPHA_DIS
op_or
id|M1064_XGENCTRL_BLACK_0IRE
op_or
id|M1064_XGENCTRL_NO_SYNC_ON_GREEN
comma
id|M1064_XMISCCTRL_DAC_8BIT
comma
l_int|0x00
comma
l_int|0x00
comma
id|M1064_XZOOMCTRL_1
comma
id|M1064_XSENSETEST_BCOMP
op_or
id|M1064_XSENSETEST_GCOMP
op_or
id|M1064_XSENSETEST_RCOMP
op_or
id|M1064_XSENSETEST_PDOWN
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0x00
comma
l_int|0xFF
comma
l_int|0xFF
)brace
suffix:semicolon
DECL|function|DAC1064_setpclk
r_static
r_void
id|DAC1064_setpclk
c_func
(paren
id|CPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
comma
r_int
r_int
id|fout
)paren
(brace
r_int
r_int
id|m
comma
id|n
comma
id|p
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;DAC1064_setpclk&quot;
)paren
id|DAC1064_calcclock
c_func
(paren
id|PMINFO
id|fout
comma
id|ACCESS_FBINFO
c_func
(paren
id|max_pixel_clock
)paren
comma
op_amp
id|m
comma
op_amp
id|n
comma
op_amp
id|p
)paren
suffix:semicolon
id|hw-&gt;DACclk
(braket
l_int|0
)braket
op_assign
id|m
suffix:semicolon
id|hw-&gt;DACclk
(braket
l_int|1
)braket
op_assign
id|n
suffix:semicolon
id|hw-&gt;DACclk
(braket
l_int|2
)braket
op_assign
id|p
suffix:semicolon
)brace
DECL|function|DAC1064_setmclk
r_static
r_void
(def_block
id|DAC1064_setmclk
c_func
(paren
id|CPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
comma
r_int
id|oscinfo
comma
r_int
r_int
id|fmem
)paren
(brace
id|u_int32_t
id|mx
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;DAC1064_setmclk&quot;
)paren
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.noinit
)paren
)paren
(brace
multiline_comment|/* read MCLK and give up... */
id|hw-&gt;DACclk
(braket
l_int|3
)braket
op_assign
id|inDAC1064
c_func
(paren
id|PMINFO
id|DAC1064_XSYSPLLM
)paren
suffix:semicolon
id|hw-&gt;DACclk
(braket
l_int|4
)braket
op_assign
id|inDAC1064
c_func
(paren
id|PMINFO
id|DAC1064_XSYSPLLN
)paren
suffix:semicolon
id|hw-&gt;DACclk
(braket
l_int|5
)braket
op_assign
id|inDAC1064
c_func
(paren
id|PMINFO
id|DAC1064_XSYSPLLP
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|mx
op_assign
id|hw-&gt;MXoptionReg
op_or
l_int|0x00000004
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_OPTION_REG
comma
id|mx
)paren
suffix:semicolon
id|mx
op_and_assign
op_complement
l_int|0x000000BB
suffix:semicolon
r_if
c_cond
(paren
id|oscinfo
op_amp
id|DAC1064_OPT_GDIV1
)paren
id|mx
op_or_assign
l_int|0x00000008
suffix:semicolon
r_if
c_cond
(paren
id|oscinfo
op_amp
id|DAC1064_OPT_MDIV1
)paren
id|mx
op_or_assign
l_int|0x00000010
suffix:semicolon
r_if
c_cond
(paren
id|oscinfo
op_amp
id|DAC1064_OPT_RESERVED
)paren
id|mx
op_or_assign
l_int|0x00000080
suffix:semicolon
r_if
c_cond
(paren
(paren
id|oscinfo
op_amp
id|DAC1064_OPT_SCLK_MASK
)paren
op_eq
id|DAC1064_OPT_SCLK_PLL
)paren
(brace
multiline_comment|/* select PCI clock until we have setup oscilator... */
r_int
id|clk
suffix:semicolon
r_int
r_int
id|m
comma
id|n
comma
id|p
suffix:semicolon
multiline_comment|/* powerup system PLL, select PCI clock */
id|mx
op_or_assign
l_int|0x00000020
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_OPTION_REG
comma
id|mx
)paren
suffix:semicolon
id|mx
op_and_assign
op_complement
l_int|0x00000004
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_OPTION_REG
comma
id|mx
)paren
suffix:semicolon
multiline_comment|/* !!! you must not access device if MCLK is not running !!!&n;&t;&t;   Doing so cause immediate PCI lockup :-( Maybe they should&n;&t;&t;   generate ABORT or I/O (parity...) error and Linux should&n;&t;&t;   recover from this... (kill driver/process). But world is not&n;&t;&t;   perfect... */
multiline_comment|/* (bit 2 of PCI_OPTION_REG must be 0... and bits 0,1 must not&n;&t;&t;   select PLL... because of PLL can be stopped at this time) */
id|DAC1064_calcclock
c_func
(paren
id|PMINFO
id|fmem
comma
id|ACCESS_FBINFO
c_func
(paren
id|max_pixel_clock
)paren
comma
op_amp
id|m
comma
op_amp
id|n
comma
op_amp
id|p
)paren
suffix:semicolon
id|outDAC1064
c_func
(paren
id|PMINFO
id|DAC1064_XSYSPLLM
comma
id|hw-&gt;DACclk
(braket
l_int|3
)braket
op_assign
id|m
)paren
suffix:semicolon
id|outDAC1064
c_func
(paren
id|PMINFO
id|DAC1064_XSYSPLLN
comma
id|hw-&gt;DACclk
(braket
l_int|4
)braket
op_assign
id|n
)paren
suffix:semicolon
id|outDAC1064
c_func
(paren
id|PMINFO
id|DAC1064_XSYSPLLP
comma
id|hw-&gt;DACclk
(braket
l_int|5
)braket
op_assign
id|p
)paren
suffix:semicolon
r_for
c_loop
(paren
id|clk
op_assign
l_int|65536
suffix:semicolon
id|clk
suffix:semicolon
op_decrement
id|clk
)paren
(brace
r_if
c_cond
(paren
id|inDAC1064
c_func
(paren
id|PMINFO
id|DAC1064_XSYSPLLSTAT
)paren
op_amp
l_int|0x40
)paren
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|clk
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: aiee, SYSPLL not locked&bslash;n&quot;
)paren
suffix:semicolon
multiline_comment|/* select PLL */
id|mx
op_or_assign
l_int|0x00000005
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* select specified system clock source */
id|mx
op_or_assign
id|oscinfo
op_amp
id|DAC1064_OPT_SCLK_MASK
suffix:semicolon
)brace
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_OPTION_REG
comma
id|mx
)paren
suffix:semicolon
id|mx
op_and_assign
op_complement
l_int|0x00000004
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_OPTION_REG
comma
id|mx
)paren
suffix:semicolon
id|hw-&gt;MXoptionReg
op_assign
id|mx
suffix:semicolon
)brace
)def_block
DECL|function|DAC1064_global_init
r_void
id|DAC1064_global_init
c_func
(paren
id|CPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
)paren
(brace
id|hw-&gt;DACreg
(braket
id|POS1064_XMISCCTRL
)braket
op_and_assign
id|M1064_XMISCCTRL_DAC_WIDTHMASK
suffix:semicolon
id|hw-&gt;DACreg
(braket
id|POS1064_XMISCCTRL
)braket
op_or_assign
id|M1064_XMISCCTRL_LUT_EN
suffix:semicolon
id|hw-&gt;DACreg
(braket
id|POS1064_XPIXCLKCTRL
)braket
op_assign
id|M1064_XPIXCLKCTRL_PLL_UP
op_or
id|M1064_XPIXCLKCTRL_EN
op_or
id|M1064_XPIXCLKCTRL_SRC_PLL
suffix:semicolon
id|hw-&gt;DACreg
(braket
id|POS1064_XOUTPUTCONN
)braket
op_assign
l_int|0x01
suffix:semicolon
multiline_comment|/* output #1 enabled */
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|output.ph
)paren
op_amp
id|MATROXFB_OUTPUT_CONN_SECONDARY
)paren
(brace
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.g450dac
)paren
)paren
(brace
id|hw-&gt;DACreg
(braket
id|POS1064_XPIXCLKCTRL
)braket
op_assign
id|M1064_XPIXCLKCTRL_PLL_UP
op_or
id|M1064_XPIXCLKCTRL_EN
op_or
id|M1064_XPIXCLKCTRL_SRC_PLL2
suffix:semicolon
id|hw-&gt;DACreg
(braket
id|POS1064_XOUTPUTCONN
)braket
op_assign
l_int|0x05
suffix:semicolon
multiline_comment|/* output #1 enabled; CRTC1 connected to output #2 */
)brace
r_else
(brace
id|hw-&gt;DACreg
(braket
id|POS1064_XPIXCLKCTRL
)braket
op_assign
id|M1064_XPIXCLKCTRL_PLL_UP
op_or
id|M1064_XPIXCLKCTRL_EN
op_or
id|M1064_XPIXCLKCTRL_SRC_EXT
suffix:semicolon
id|hw-&gt;DACreg
(braket
id|POS1064_XMISCCTRL
)braket
op_or_assign
id|GX00_XMISCCTRL_MFC_MAFC
op_or
id|G400_XMISCCTRL_VDO_MAFC12
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|output.sh
)paren
op_amp
id|MATROXFB_OUTPUT_CONN_SECONDARY
)paren
(brace
id|hw-&gt;DACreg
(braket
id|POS1064_XMISCCTRL
)braket
op_or_assign
id|GX00_XMISCCTRL_MFC_MAFC
op_or
id|G400_XMISCCTRL_VDO_C2_MAFC12
suffix:semicolon
id|hw-&gt;DACreg
(braket
id|POS1064_XOUTPUTCONN
)braket
op_assign
l_int|0x09
suffix:semicolon
multiline_comment|/* output #1 enabled; CRTC2 connected to output #2 */
)brace
r_else
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|output.ph
)paren
op_amp
id|MATROXFB_OUTPUT_CONN_DFP
)paren
id|hw-&gt;DACreg
(braket
id|POS1064_XMISCCTRL
)braket
op_or_assign
id|GX00_XMISCCTRL_MFC_PANELLINK
op_or
id|G400_XMISCCTRL_VDO_MAFC12
suffix:semicolon
r_else
id|hw-&gt;DACreg
(braket
id|POS1064_XMISCCTRL
)braket
op_or_assign
id|GX00_XMISCCTRL_MFC_DIS
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ACCESS_FBINFO
c_func
(paren
id|output.ph
)paren
op_or
id|ACCESS_FBINFO
c_func
(paren
id|output.sh
)paren
)paren
op_amp
id|MATROXFB_OUTPUT_CONN_PRIMARY
)paren
id|hw-&gt;DACreg
(braket
id|POS1064_XMISCCTRL
)braket
op_or_assign
id|M1064_XMISCCTRL_DAC_EN
suffix:semicolon
)brace
DECL|function|DAC1064_global_restore
r_void
id|DAC1064_global_restore
c_func
(paren
id|CPMINFO
r_const
r_struct
id|matrox_hw_state
op_star
id|hw
)paren
(brace
id|outDAC1064
c_func
(paren
id|PMINFO
id|M1064_XPIXCLKCTRL
comma
id|hw-&gt;DACreg
(braket
id|POS1064_XPIXCLKCTRL
)braket
)paren
suffix:semicolon
id|outDAC1064
c_func
(paren
id|PMINFO
id|M1064_XMISCCTRL
comma
id|hw-&gt;DACreg
(braket
id|POS1064_XMISCCTRL
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.accelerator
)paren
op_eq
id|FB_ACCEL_MATROX_MGAG400
)paren
(brace
id|outDAC1064
c_func
(paren
id|PMINFO
l_int|0x20
comma
l_int|0x04
)paren
suffix:semicolon
id|outDAC1064
c_func
(paren
id|PMINFO
l_int|0x1F
comma
l_int|0x00
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.g450dac
)paren
)paren
(brace
id|outDAC1064
c_func
(paren
id|PMINFO
id|M1064_X8B
comma
l_int|0xCC
)paren
suffix:semicolon
multiline_comment|/* only matrox know... */
id|outDAC1064
c_func
(paren
id|PMINFO
id|M1064_XOUTPUTCONN
comma
id|hw-&gt;DACreg
(braket
id|POS1064_XOUTPUTCONN
)braket
)paren
suffix:semicolon
)brace
)brace
)brace
DECL|function|DAC1064_init_1
r_static
r_int
id|DAC1064_init_1
c_func
(paren
id|CPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
comma
r_struct
id|my_timming
op_star
id|m
comma
r_struct
id|display
op_star
id|p
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;DAC1064_init_1&quot;
)paren
id|memcpy
c_func
(paren
id|hw-&gt;DACreg
comma
id|MGA1064_DAC
comma
r_sizeof
(paren
id|MGA1064_DAC_regs
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|p-&gt;type
op_eq
id|FB_TYPE_TEXT
)paren
(brace
id|hw-&gt;DACreg
(braket
id|POS1064_XMISCCTRL
)braket
op_assign
id|M1064_XMISCCTRL_DAC_6BIT
suffix:semicolon
id|hw-&gt;DACreg
(braket
id|POS1064_XMULCTRL
)braket
op_assign
id|M1064_XMULCTRL_DEPTH_8BPP
op_or
id|M1064_XMULCTRL_GRAPHICS_PALETIZED
suffix:semicolon
)brace
r_else
(brace
r_switch
c_cond
(paren
id|p-&gt;var.bits_per_pixel
)paren
(brace
multiline_comment|/* case 4: not supported by MGA1064 DAC */
r_case
l_int|8
suffix:colon
id|hw-&gt;DACreg
(braket
id|POS1064_XMULCTRL
)braket
op_assign
id|M1064_XMULCTRL_DEPTH_8BPP
op_or
id|M1064_XMULCTRL_GRAPHICS_PALETIZED
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|16
suffix:colon
r_if
c_cond
(paren
id|p-&gt;var.green.length
op_eq
l_int|5
)paren
id|hw-&gt;DACreg
(braket
id|POS1064_XMULCTRL
)braket
op_assign
id|M1064_XMULCTRL_DEPTH_15BPP_1BPP
op_or
id|M1064_XMULCTRL_GRAPHICS_PALETIZED
suffix:semicolon
r_else
id|hw-&gt;DACreg
(braket
id|POS1064_XMULCTRL
)braket
op_assign
id|M1064_XMULCTRL_DEPTH_16BPP
op_or
id|M1064_XMULCTRL_GRAPHICS_PALETIZED
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|24
suffix:colon
id|hw-&gt;DACreg
(braket
id|POS1064_XMULCTRL
)braket
op_assign
id|M1064_XMULCTRL_DEPTH_24BPP
op_or
id|M1064_XMULCTRL_GRAPHICS_PALETIZED
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|32
suffix:colon
id|hw-&gt;DACreg
(braket
id|POS1064_XMULCTRL
)braket
op_assign
id|M1064_XMULCTRL_DEPTH_32BPP
op_or
id|M1064_XMULCTRL_GRAPHICS_PALETIZED
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
l_int|1
suffix:semicolon
multiline_comment|/* unsupported depth */
)brace
)brace
id|DAC1064_global_init
c_func
(paren
id|PMINFO
id|hw
)paren
suffix:semicolon
id|hw-&gt;DACreg
(braket
id|POS1064_XVREFCTRL
)braket
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|features.DAC1064.xvrefctrl
)paren
suffix:semicolon
id|hw-&gt;DACreg
(braket
id|POS1064_XGENCTRL
)braket
op_and_assign
op_complement
id|M1064_XGENCTRL_SYNC_ON_GREEN_MASK
suffix:semicolon
id|hw-&gt;DACreg
(braket
id|POS1064_XGENCTRL
)braket
op_or_assign
(paren
id|m-&gt;sync
op_amp
id|FB_SYNC_ON_GREEN
)paren
ques
c_cond
id|M1064_XGENCTRL_SYNC_ON_GREEN
suffix:colon
id|M1064_XGENCTRL_NO_SYNC_ON_GREEN
suffix:semicolon
id|hw-&gt;DACreg
(braket
id|POS1064_XCURADDL
)braket
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|features.DAC1064.cursorimage
)paren
op_rshift
l_int|10
suffix:semicolon
id|hw-&gt;DACreg
(braket
id|POS1064_XCURADDH
)braket
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|features.DAC1064.cursorimage
)paren
op_rshift
l_int|18
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|DAC1064_init_2
r_static
r_int
id|DAC1064_init_2
c_func
(paren
id|CPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
comma
r_struct
id|my_timming
op_star
id|m
comma
r_struct
id|display
op_star
id|p
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;DAC1064_init_2&quot;
)paren
r_if
c_cond
(paren
id|p-&gt;var.bits_per_pixel
OG
l_int|16
)paren
(brace
multiline_comment|/* 256 entries */
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|256
suffix:semicolon
id|i
op_increment
)paren
(brace
id|hw-&gt;DACpal
(braket
id|i
op_star
l_int|3
op_plus
l_int|0
)braket
op_assign
id|i
suffix:semicolon
id|hw-&gt;DACpal
(braket
id|i
op_star
l_int|3
op_plus
l_int|1
)braket
op_assign
id|i
suffix:semicolon
id|hw-&gt;DACpal
(braket
id|i
op_star
l_int|3
op_plus
l_int|2
)braket
op_assign
id|i
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|p-&gt;var.bits_per_pixel
OG
l_int|8
)paren
(brace
r_if
c_cond
(paren
id|p-&gt;var.green.length
op_eq
l_int|5
)paren
(brace
multiline_comment|/* 0..31, 128..159 */
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|32
suffix:semicolon
id|i
op_increment
)paren
(brace
multiline_comment|/* with p15 == 0 */
id|hw-&gt;DACpal
(braket
id|i
op_star
l_int|3
op_plus
l_int|0
)braket
op_assign
id|i
op_lshift
l_int|3
suffix:semicolon
id|hw-&gt;DACpal
(braket
id|i
op_star
l_int|3
op_plus
l_int|1
)braket
op_assign
id|i
op_lshift
l_int|3
suffix:semicolon
id|hw-&gt;DACpal
(braket
id|i
op_star
l_int|3
op_plus
l_int|2
)braket
op_assign
id|i
op_lshift
l_int|3
suffix:semicolon
multiline_comment|/* with p15 == 1 */
id|hw-&gt;DACpal
(braket
(paren
id|i
op_plus
l_int|128
)paren
op_star
l_int|3
op_plus
l_int|0
)braket
op_assign
id|i
op_lshift
l_int|3
suffix:semicolon
id|hw-&gt;DACpal
(braket
(paren
id|i
op_plus
l_int|128
)paren
op_star
l_int|3
op_plus
l_int|1
)braket
op_assign
id|i
op_lshift
l_int|3
suffix:semicolon
id|hw-&gt;DACpal
(braket
(paren
id|i
op_plus
l_int|128
)paren
op_star
l_int|3
op_plus
l_int|2
)braket
op_assign
id|i
op_lshift
l_int|3
suffix:semicolon
)brace
)brace
r_else
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|64
suffix:semicolon
id|i
op_increment
)paren
(brace
multiline_comment|/* 0..63 */
id|hw-&gt;DACpal
(braket
id|i
op_star
l_int|3
op_plus
l_int|0
)braket
op_assign
id|i
op_lshift
l_int|3
suffix:semicolon
id|hw-&gt;DACpal
(braket
id|i
op_star
l_int|3
op_plus
l_int|1
)braket
op_assign
id|i
op_lshift
l_int|2
suffix:semicolon
id|hw-&gt;DACpal
(braket
id|i
op_star
l_int|3
op_plus
l_int|2
)braket
op_assign
id|i
op_lshift
l_int|3
suffix:semicolon
)brace
)brace
)brace
r_else
(brace
id|memset
c_func
(paren
id|hw-&gt;DACpal
comma
l_int|0
comma
l_int|768
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|DAC1064_restore_1
r_static
r_void
id|DAC1064_restore_1
c_func
(paren
id|WPMINFO
r_const
r_struct
id|matrox_hw_state
op_star
id|hw
comma
r_const
r_struct
id|matrox_hw_state
op_star
id|oldhw
)paren
(brace
id|CRITFLAGS
id|DBG
c_func
(paren
l_string|&quot;DAC1064_restore_1&quot;
)paren
id|CRITBEGIN
id|outDAC1064
c_func
(paren
id|PMINFO
id|DAC1064_XSYSPLLM
comma
id|hw-&gt;DACclk
(braket
l_int|3
)braket
)paren
suffix:semicolon
id|outDAC1064
c_func
(paren
id|PMINFO
id|DAC1064_XSYSPLLN
comma
id|hw-&gt;DACclk
(braket
l_int|4
)braket
)paren
suffix:semicolon
id|outDAC1064
c_func
(paren
id|PMINFO
id|DAC1064_XSYSPLLP
comma
id|hw-&gt;DACclk
(braket
l_int|5
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|oldhw
op_logical_or
id|memcmp
c_func
(paren
id|hw-&gt;DACreg
comma
id|oldhw-&gt;DACreg
comma
r_sizeof
(paren
id|MGA1064_DAC_regs
)paren
)paren
)paren
(brace
r_int
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
r_sizeof
(paren
id|MGA1064_DAC_regs
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|i
op_ne
id|POS1064_XPIXCLKCTRL
)paren
op_logical_and
(paren
id|i
op_ne
id|POS1064_XMISCCTRL
)paren
)paren
id|outDAC1064
c_func
(paren
id|PMINFO
id|MGA1064_DAC_regs
(braket
id|i
)braket
comma
id|hw-&gt;DACreg
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
)brace
id|DAC1064_global_restore
c_func
(paren
id|PMINFO
id|hw
)paren
suffix:semicolon
id|CRITEND
)brace
suffix:semicolon
DECL|function|DAC1064_restore_2
r_static
r_void
id|DAC1064_restore_2
c_func
(paren
id|WPMINFO
r_const
r_struct
id|matrox_hw_state
op_star
id|hw
comma
r_const
r_struct
id|matrox_hw_state
op_star
id|oldhw
comma
r_struct
id|display
op_star
id|p
)paren
(brace
macro_line|#ifdef DEBUG
r_int
r_int
id|i
suffix:semicolon
macro_line|#endif
id|DBG
c_func
(paren
l_string|&quot;DAC1064_restore_2&quot;
)paren
id|matrox_init_putc
c_func
(paren
id|PMINFO
id|p
comma
id|matroxfb_DAC1064_createcursor
)paren
suffix:semicolon
macro_line|#ifdef DEBUG
id|dprintk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;DAC1064regs &quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
r_sizeof
(paren
id|MGA1064_DAC_regs
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
id|dprintk
c_func
(paren
l_string|&quot;R%02X=%02X &quot;
comma
id|MGA1064_DAC_regs
(braket
id|i
)braket
comma
id|hw-&gt;DACreg
(braket
id|i
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|i
op_amp
l_int|0x7
)paren
op_eq
l_int|0x7
)paren
id|dprintk
c_func
(paren
l_string|&quot;&bslash;n&quot;
id|KERN_DEBUG
l_string|&quot;continuing... &quot;
)paren
suffix:semicolon
)brace
id|dprintk
c_func
(paren
l_string|&quot;&bslash;n&quot;
id|KERN_DEBUG
l_string|&quot;DAC1064clk &quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|6
suffix:semicolon
id|i
op_increment
)paren
id|dprintk
c_func
(paren
l_string|&quot;C%02X=%02X &quot;
comma
id|i
comma
id|hw-&gt;DACclk
(braket
id|i
)braket
)paren
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#endif
)brace
DECL|function|m1064_compute
r_static
r_int
id|m1064_compute
c_func
(paren
r_void
op_star
id|outdev
comma
r_struct
id|my_timming
op_star
id|m
comma
r_struct
id|matrox_hw_state
op_star
id|hw
)paren
(brace
DECL|macro|minfo
mdefine_line|#define minfo ((struct matrox_fb_info*)outdev)
id|DAC1064_setpclk
c_func
(paren
id|PMINFO
id|hw
comma
id|m-&gt;pixclock
)paren
suffix:semicolon
DECL|macro|minfo
macro_line|#undef minfo
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|m1064_program
r_static
r_int
id|m1064_program
c_func
(paren
r_void
op_star
id|outdev
comma
r_const
r_struct
id|matrox_hw_state
op_star
id|hw
)paren
(brace
DECL|macro|minfo
mdefine_line|#define minfo ((struct matrox_fb_info*)outdev)
r_int
id|i
suffix:semicolon
r_int
id|tmout
suffix:semicolon
id|CRITFLAGS
id|CRITBEGIN
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|3
suffix:semicolon
id|i
op_increment
)paren
id|outDAC1064
c_func
(paren
id|PMINFO
id|M1064_XPIXPLLCM
op_plus
id|i
comma
id|hw-&gt;DACclk
(braket
id|i
)braket
)paren
suffix:semicolon
r_for
c_loop
(paren
id|tmout
op_assign
l_int|500000
suffix:semicolon
id|tmout
suffix:semicolon
id|tmout
op_decrement
)paren
(brace
r_if
c_cond
(paren
id|inDAC1064
c_func
(paren
id|PMINFO
id|M1064_XPIXPLLSTAT
)paren
op_amp
l_int|0x40
)paren
r_break
suffix:semicolon
id|udelay
c_func
(paren
l_int|10
)paren
suffix:semicolon
)brace
suffix:semicolon
id|CRITEND
r_if
c_cond
(paren
op_logical_neg
id|tmout
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: Pixel PLL not locked after 5 secs&bslash;n&quot;
)paren
suffix:semicolon
DECL|macro|minfo
macro_line|#undef minfo
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|m1064_start
r_static
r_int
id|m1064_start
c_func
(paren
r_void
op_star
id|outdev
)paren
(brace
multiline_comment|/* nothing */
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|m1064_incuse
r_static
r_void
id|m1064_incuse
c_func
(paren
r_void
op_star
id|outdev
)paren
(brace
multiline_comment|/* nothing yet; MODULE_INC_USE in future... */
)brace
DECL|function|m1064_decuse
r_static
r_void
id|m1064_decuse
c_func
(paren
r_void
op_star
id|outdev
)paren
(brace
multiline_comment|/* nothing yet; MODULE_DEC_USE in future... */
)brace
DECL|function|m1064_setmode
r_static
r_int
id|m1064_setmode
c_func
(paren
r_void
op_star
id|outdev
comma
id|u_int32_t
id|mode
)paren
(brace
r_if
c_cond
(paren
id|mode
op_ne
id|MATROXFB_OUTPUT_MODE_MONITOR
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|m1064
r_static
r_struct
id|matrox_altout
id|m1064
op_assign
(brace
id|m1064_compute
comma
id|m1064_program
comma
id|m1064_start
comma
id|m1064_incuse
comma
id|m1064_decuse
comma
id|m1064_setmode
)brace
suffix:semicolon
macro_line|#endif /* NEED_DAC1064 */
macro_line|#ifdef CONFIG_FB_MATROX_MYSTIQUE
DECL|function|MGA1064_init
r_static
r_int
id|MGA1064_init
c_func
(paren
id|CPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
comma
r_struct
id|my_timming
op_star
id|m
comma
r_struct
id|display
op_star
id|p
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;MGA1064_init&quot;
)paren
r_if
c_cond
(paren
id|DAC1064_init_1
c_func
(paren
id|PMINFO
id|hw
comma
id|m
comma
id|p
)paren
)paren
r_return
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|matroxfb_vgaHWinit
c_func
(paren
id|PMINFO
id|hw
comma
id|m
comma
id|p
)paren
)paren
r_return
l_int|1
suffix:semicolon
id|hw-&gt;MiscOutReg
op_assign
l_int|0xCB
suffix:semicolon
r_if
c_cond
(paren
id|m-&gt;sync
op_amp
id|FB_SYNC_HOR_HIGH_ACT
)paren
id|hw-&gt;MiscOutReg
op_and_assign
op_complement
l_int|0x40
suffix:semicolon
r_if
c_cond
(paren
id|m-&gt;sync
op_amp
id|FB_SYNC_VERT_HIGH_ACT
)paren
id|hw-&gt;MiscOutReg
op_and_assign
op_complement
l_int|0x80
suffix:semicolon
r_if
c_cond
(paren
id|m-&gt;sync
op_amp
id|FB_SYNC_COMP_HIGH_ACT
)paren
multiline_comment|/* should be only FB_SYNC_COMP */
id|hw-&gt;CRTCEXT
(braket
l_int|3
)braket
op_or_assign
l_int|0x40
suffix:semicolon
r_if
c_cond
(paren
id|DAC1064_init_2
c_func
(paren
id|PMINFO
id|hw
comma
id|m
comma
id|p
)paren
)paren
r_return
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif
macro_line|#ifdef CONFIG_FB_MATROX_G100
DECL|function|MGAG100_init
r_static
r_int
id|MGAG100_init
c_func
(paren
id|CPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
comma
r_struct
id|my_timming
op_star
id|m
comma
r_struct
id|display
op_star
id|p
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;MGAG100_init&quot;
)paren
r_if
c_cond
(paren
id|DAC1064_init_1
c_func
(paren
id|PMINFO
id|hw
comma
id|m
comma
id|p
)paren
)paren
r_return
l_int|1
suffix:semicolon
id|hw-&gt;MXoptionReg
op_and_assign
op_complement
l_int|0x2000
suffix:semicolon
r_if
c_cond
(paren
id|matroxfb_vgaHWinit
c_func
(paren
id|PMINFO
id|hw
comma
id|m
comma
id|p
)paren
)paren
r_return
l_int|1
suffix:semicolon
id|hw-&gt;MiscOutReg
op_assign
l_int|0xEF
suffix:semicolon
r_if
c_cond
(paren
id|m-&gt;sync
op_amp
id|FB_SYNC_HOR_HIGH_ACT
)paren
id|hw-&gt;MiscOutReg
op_and_assign
op_complement
l_int|0x40
suffix:semicolon
r_if
c_cond
(paren
id|m-&gt;sync
op_amp
id|FB_SYNC_VERT_HIGH_ACT
)paren
id|hw-&gt;MiscOutReg
op_and_assign
op_complement
l_int|0x80
suffix:semicolon
r_if
c_cond
(paren
id|m-&gt;sync
op_amp
id|FB_SYNC_COMP_HIGH_ACT
)paren
multiline_comment|/* should be only FB_SYNC_COMP */
id|hw-&gt;CRTCEXT
(braket
l_int|3
)braket
op_or_assign
l_int|0x40
suffix:semicolon
r_if
c_cond
(paren
id|DAC1064_init_2
c_func
(paren
id|PMINFO
id|hw
comma
id|m
comma
id|p
)paren
)paren
r_return
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif&t;/* G100 */
macro_line|#ifdef CONFIG_FB_MATROX_MYSTIQUE
DECL|function|MGA1064_ramdac_init
r_static
r_void
(def_block
id|MGA1064_ramdac_init
c_func
(paren
id|WPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;MGA1064_ramdac_init&quot;
)paren
suffix:semicolon
multiline_comment|/* ACCESS_FBINFO(features.DAC1064.vco_freq_min) = 120000; */
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.vco_freq_min
)paren
op_assign
l_int|62000
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.ref_freq
)paren
op_assign
l_int|14318
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.feed_div_min
)paren
op_assign
l_int|100
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.feed_div_max
)paren
op_assign
l_int|127
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.in_div_min
)paren
op_assign
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.in_div_max
)paren
op_assign
l_int|31
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.post_shift_max
)paren
op_assign
l_int|3
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.DAC1064.xvrefctrl
)paren
op_assign
id|DAC1064_XVREFCTRL_EXTERNAL
suffix:semicolon
multiline_comment|/* maybe cmdline MCLK= ?, doc says gclk=44MHz, mclk=66MHz... it was 55/83 with old values */
id|DAC1064_setmclk
c_func
(paren
id|PMINFO
id|hw
comma
id|DAC1064_OPT_MDIV2
op_or
id|DAC1064_OPT_GDIV3
op_or
id|DAC1064_OPT_SCLK_PLL
comma
l_int|133333
)paren
suffix:semicolon
)brace
)def_block
macro_line|#endif
macro_line|#ifdef CONFIG_FB_MATROX_G100
multiline_comment|/* BIOS environ */
DECL|variable|x7AF4
r_static
r_int
id|x7AF4
op_assign
l_int|0x10
suffix:semicolon
multiline_comment|/* flags, maybe 0x10 = SDRAM, 0x00 = SGRAM??? */
multiline_comment|/* G100 wants 0x10, G200 SGRAM does not care... */
macro_line|#if 0
r_static
r_int
id|def50
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* reg50, &amp; 0x0F, &amp; 0x3000 (only 0x0000, 0x1000, 0x2000 (0x3000 disallowed and treated as 0) */
macro_line|#endif
DECL|function|MGAG100_progPixClock
r_static
r_void
(def_block
id|MGAG100_progPixClock
c_func
(paren
id|CPMINFO
r_int
id|flags
comma
r_int
id|m
comma
r_int
id|n
comma
r_int
id|p
)paren
(brace
r_int
id|reg
suffix:semicolon
r_int
id|selClk
suffix:semicolon
r_int
id|clk
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;MGAG100_progPixClock&quot;
)paren
id|outDAC1064
c_func
(paren
id|PMINFO
id|M1064_XPIXCLKCTRL
comma
id|inDAC1064
c_func
(paren
id|PMINFO
id|M1064_XPIXCLKCTRL
)paren
op_or
id|M1064_XPIXCLKCTRL_DIS
op_or
id|M1064_XPIXCLKCTRL_PLL_UP
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|flags
op_amp
l_int|3
)paren
(brace
r_case
l_int|0
suffix:colon
id|reg
op_assign
id|M1064_XPIXPLLAM
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|reg
op_assign
id|M1064_XPIXPLLBM
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|reg
op_assign
id|M1064_XPIXPLLCM
suffix:semicolon
r_break
suffix:semicolon
)brace
id|outDAC1064
c_func
(paren
id|PMINFO
id|reg
op_increment
comma
id|m
)paren
suffix:semicolon
id|outDAC1064
c_func
(paren
id|PMINFO
id|reg
op_increment
comma
id|n
)paren
suffix:semicolon
id|outDAC1064
c_func
(paren
id|PMINFO
id|reg
comma
id|p
)paren
suffix:semicolon
id|selClk
op_assign
id|mga_inb
c_func
(paren
id|M_MISC_REG_READ
)paren
op_amp
op_complement
l_int|0xC
suffix:semicolon
multiline_comment|/* there should be flags &amp; 0x03 &amp; case 0/1/else */
multiline_comment|/* and we should first select source and after that we should wait for PLL */
multiline_comment|/* and we are waiting for PLL with oscilator disabled... Is it right? */
r_switch
c_cond
(paren
id|flags
op_amp
l_int|0x03
)paren
(brace
r_case
l_int|0x00
suffix:colon
r_break
suffix:semicolon
r_case
l_int|0x01
suffix:colon
id|selClk
op_or_assign
l_int|4
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|selClk
op_or_assign
l_int|0x0C
suffix:semicolon
r_break
suffix:semicolon
)brace
id|mga_outb
c_func
(paren
id|M_MISC_REG
comma
id|selClk
)paren
suffix:semicolon
r_for
c_loop
(paren
id|clk
op_assign
l_int|500000
suffix:semicolon
id|clk
suffix:semicolon
id|clk
op_decrement
)paren
(brace
r_if
c_cond
(paren
id|inDAC1064
c_func
(paren
id|PMINFO
id|M1064_XPIXPLLSTAT
)paren
op_amp
l_int|0x40
)paren
r_break
suffix:semicolon
id|udelay
c_func
(paren
l_int|10
)paren
suffix:semicolon
)brace
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|clk
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: Pixel PLL%c not locked after usual time&bslash;n&quot;
comma
(paren
id|reg
op_minus
id|M1064_XPIXPLLAM
op_minus
l_int|2
)paren
op_div
l_int|4
op_plus
l_char|&squot;A&squot;
)paren
suffix:semicolon
id|selClk
op_assign
id|inDAC1064
c_func
(paren
id|PMINFO
id|M1064_XPIXCLKCTRL
)paren
op_amp
op_complement
id|M1064_XPIXCLKCTRL_SRC_MASK
suffix:semicolon
r_switch
c_cond
(paren
id|flags
op_amp
l_int|0x0C
)paren
(brace
r_case
l_int|0x00
suffix:colon
id|selClk
op_or_assign
id|M1064_XPIXCLKCTRL_SRC_PCI
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x04
suffix:colon
id|selClk
op_or_assign
id|M1064_XPIXCLKCTRL_SRC_PLL
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|selClk
op_or_assign
id|M1064_XPIXCLKCTRL_SRC_EXT
suffix:semicolon
r_break
suffix:semicolon
)brace
id|outDAC1064
c_func
(paren
id|PMINFO
id|M1064_XPIXCLKCTRL
comma
id|selClk
)paren
suffix:semicolon
id|outDAC1064
c_func
(paren
id|PMINFO
id|M1064_XPIXCLKCTRL
comma
id|inDAC1064
c_func
(paren
id|PMINFO
id|M1064_XPIXCLKCTRL
)paren
op_amp
op_complement
id|M1064_XPIXCLKCTRL_DIS
)paren
suffix:semicolon
)brace
)def_block
DECL|function|MGAG100_setPixClock
r_static
r_void
(def_block
id|MGAG100_setPixClock
c_func
(paren
id|CPMINFO
r_int
id|flags
comma
r_int
id|freq
)paren
(brace
r_int
r_int
id|m
comma
id|n
comma
id|p
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;MGAG100_setPixClock&quot;
)paren
id|DAC1064_calcclock
c_func
(paren
id|PMINFO
id|freq
comma
id|ACCESS_FBINFO
c_func
(paren
id|max_pixel_clock
)paren
comma
op_amp
id|m
comma
op_amp
id|n
comma
op_amp
id|p
)paren
suffix:semicolon
id|MGAG100_progPixClock
c_func
(paren
id|PMINFO
id|flags
comma
id|m
comma
id|n
comma
id|p
)paren
suffix:semicolon
)brace
)def_block
macro_line|#endif
macro_line|#ifdef CONFIG_FB_MATROX_MYSTIQUE
DECL|function|MGA1064_preinit
r_static
r_int
(def_block
id|MGA1064_preinit
c_func
(paren
id|WPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
)paren
(brace
r_static
r_const
r_int
id|vxres_mystique
(braket
)braket
op_assign
(brace
l_int|512
comma
l_int|640
comma
l_int|768
comma
l_int|800
comma
l_int|832
comma
l_int|960
comma
l_int|1024
comma
l_int|1152
comma
l_int|1280
comma
l_int|1600
comma
l_int|1664
comma
l_int|1920
comma
l_int|2048
comma
l_int|0
)brace
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;MGA1064_preinit&quot;
)paren
multiline_comment|/* ACCESS_FBINFO(capable.cfb4) = 0; ... preinitialized by 0 */
id|ACCESS_FBINFO
c_func
(paren
id|capable.text
)paren
op_assign
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|capable.vxres
)paren
op_assign
id|vxres_mystique
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.accel.has_cacheflush
)paren
op_assign
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|cursor.timer.function
)paren
op_assign
id|matroxfb_DAC1064_flashcursor
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|primout
)paren
op_assign
op_amp
id|m1064
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.noinit
)paren
)paren
r_return
l_int|0
suffix:semicolon
multiline_comment|/* do not modify settings */
id|hw-&gt;MXoptionReg
op_and_assign
l_int|0xC0000100
suffix:semicolon
id|hw-&gt;MXoptionReg
op_or_assign
l_int|0x00094E20
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.novga
)paren
)paren
id|hw-&gt;MXoptionReg
op_and_assign
op_complement
l_int|0x00000100
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.nobios
)paren
)paren
id|hw-&gt;MXoptionReg
op_and_assign
op_complement
l_int|0x40000000
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.nopciretry
)paren
)paren
id|hw-&gt;MXoptionReg
op_or_assign
l_int|0x20000000
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_OPTION_REG
comma
id|hw-&gt;MXoptionReg
)paren
suffix:semicolon
id|mga_setr
c_func
(paren
id|M_SEQ_INDEX
comma
l_int|0x01
comma
l_int|0x20
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_CTLWTST
comma
l_int|0x00000000
)paren
suffix:semicolon
id|udelay
c_func
(paren
l_int|200
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_MACCESS
comma
l_int|0x00008000
)paren
suffix:semicolon
id|udelay
c_func
(paren
l_int|100
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_MACCESS
comma
l_int|0x0000C000
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
)def_block
DECL|function|MGA1064_reset
r_static
r_void
(def_block
id|MGA1064_reset
c_func
(paren
id|WPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;MGA1064_reset&quot;
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.DAC1064.cursorimage
)paren
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|video.len_usable
)paren
op_minus
l_int|1024
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.hwcursor
)paren
)paren
id|ACCESS_FBINFO
c_func
(paren
id|video.len_usable
)paren
op_sub_assign
l_int|1024
suffix:semicolon
id|matroxfb_fastfont_init
c_func
(paren
id|MINFO
)paren
suffix:semicolon
id|MGA1064_ramdac_init
c_func
(paren
id|PMINFO
id|hw
)paren
suffix:semicolon
)brace
)def_block
macro_line|#endif
macro_line|#ifdef CONFIG_FB_MATROX_G100
DECL|function|MGAG100_preinit
r_static
r_int
(def_block
id|MGAG100_preinit
c_func
(paren
id|WPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
)paren
(brace
r_static
r_const
r_int
id|vxres_g100
(braket
)braket
op_assign
(brace
l_int|512
comma
l_int|640
comma
l_int|768
comma
l_int|800
comma
l_int|832
comma
l_int|960
comma
l_int|1024
comma
l_int|1152
comma
l_int|1280
comma
l_int|1600
comma
l_int|1664
comma
l_int|1920
comma
l_int|2048
comma
l_int|0
)brace
suffix:semicolon
id|u_int32_t
id|reg50
suffix:semicolon
macro_line|#if 0
id|u_int32_t
id|q
suffix:semicolon
macro_line|#endif
id|DBG
c_func
(paren
l_string|&quot;MGAG100_preinit&quot;
)paren
multiline_comment|/* there are some instabilities if in_div &gt; 19 &amp;&amp; vco &lt; 61000 */
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.g450dac
)paren
)paren
(brace
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.vco_freq_min
)paren
op_assign
l_int|130000
suffix:semicolon
multiline_comment|/* my sample: &gt;118 */
)brace
r_else
(brace
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.vco_freq_min
)paren
op_assign
l_int|62000
suffix:semicolon
)brace
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.ref_freq
)paren
op_assign
l_int|27000
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.feed_div_min
)paren
op_assign
l_int|7
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.feed_div_max
)paren
op_assign
l_int|127
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.in_div_min
)paren
op_assign
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.in_div_max
)paren
op_assign
l_int|31
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.pll.post_shift_max
)paren
op_assign
l_int|3
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.DAC1064.xvrefctrl
)paren
op_assign
id|DAC1064_XVREFCTRL_G100_DEFAULT
suffix:semicolon
multiline_comment|/* ACCESS_FBINFO(capable.cfb4) = 0; ... preinitialized by 0 */
id|ACCESS_FBINFO
c_func
(paren
id|capable.text
)paren
op_assign
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|capable.vxres
)paren
op_assign
id|vxres_g100
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|features.accel.has_cacheflush
)paren
op_assign
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|cursor.timer.function
)paren
op_assign
id|matroxfb_DAC1064_flashcursor
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|capable.plnwt
)paren
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|devflags.accelerator
)paren
op_ne
id|FB_ACCEL_MATROX_MGAG100
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|primout
)paren
op_assign
op_amp
id|m1064
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.noinit
)paren
)paren
r_return
l_int|0
suffix:semicolon
id|hw-&gt;MXoptionReg
op_and_assign
l_int|0xC0000100
suffix:semicolon
id|hw-&gt;MXoptionReg
op_or_assign
l_int|0x00000020
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.novga
)paren
)paren
id|hw-&gt;MXoptionReg
op_and_assign
op_complement
l_int|0x00000100
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.nobios
)paren
)paren
id|hw-&gt;MXoptionReg
op_and_assign
op_complement
l_int|0x40000000
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.nopciretry
)paren
)paren
id|hw-&gt;MXoptionReg
op_or_assign
l_int|0x20000000
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_OPTION_REG
comma
id|hw-&gt;MXoptionReg
)paren
suffix:semicolon
id|DAC1064_setmclk
c_func
(paren
id|PMINFO
id|hw
comma
id|DAC1064_OPT_MDIV2
op_or
id|DAC1064_OPT_GDIV3
op_or
id|DAC1064_OPT_SCLK_PCI
comma
l_int|133333
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.accelerator
)paren
op_eq
id|FB_ACCEL_MATROX_MGAG100
)paren
(brace
id|pci_read_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
l_int|0x50
comma
op_amp
id|reg50
)paren
suffix:semicolon
id|reg50
op_and_assign
op_complement
l_int|0x3000
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
l_int|0x50
comma
id|reg50
)paren
suffix:semicolon
id|hw-&gt;MXoptionReg
op_or_assign
l_int|0x1080
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_OPTION_REG
comma
id|hw-&gt;MXoptionReg
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_CTLWTST
comma
l_int|0x00000300
)paren
suffix:semicolon
multiline_comment|/* mga_outl(M_CTLWTST, 0x03258A31); */
id|udelay
c_func
(paren
l_int|100
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
l_int|0x1C05
comma
l_int|0x00
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
l_int|0x1C05
comma
l_int|0x80
)paren
suffix:semicolon
id|udelay
c_func
(paren
l_int|100
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
l_int|0x1C05
comma
l_int|0x40
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
l_int|0x1C05
comma
l_int|0xC0
)paren
suffix:semicolon
id|udelay
c_func
(paren
l_int|100
)paren
suffix:semicolon
id|reg50
op_and_assign
op_complement
l_int|0xFF
suffix:semicolon
id|reg50
op_or_assign
l_int|0x07
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
l_int|0x50
comma
id|reg50
)paren
suffix:semicolon
multiline_comment|/* it should help with G100 */
id|mga_outb
c_func
(paren
id|M_GRAPHICS_INDEX
comma
l_int|6
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_GRAPHICS_DATA
comma
(paren
id|mga_inb
c_func
(paren
id|M_GRAPHICS_DATA
)paren
op_amp
l_int|3
)paren
op_or
l_int|4
)paren
suffix:semicolon
id|mga_setr
c_func
(paren
id|M_EXTVGA_INDEX
comma
l_int|0x03
comma
l_int|0x81
)paren
suffix:semicolon
id|mga_setr
c_func
(paren
id|M_EXTVGA_INDEX
comma
l_int|0x04
comma
l_int|0x00
)paren
suffix:semicolon
id|mga_writeb
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
comma
l_int|0x0000
comma
l_int|0xAA
)paren
suffix:semicolon
id|mga_writeb
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
comma
l_int|0x0800
comma
l_int|0x55
)paren
suffix:semicolon
id|mga_writeb
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
comma
l_int|0x4000
comma
l_int|0x55
)paren
suffix:semicolon
macro_line|#if 0
r_if
c_cond
(paren
id|mga_readb
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
comma
l_int|0x0000
)paren
op_ne
l_int|0xAA
)paren
(brace
id|hw-&gt;MXoptionReg
op_and_assign
op_complement
l_int|0x1000
suffix:semicolon
)brace
macro_line|#endif
id|hw-&gt;MXoptionReg
op_or_assign
l_int|0x00078020
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.accelerator
)paren
op_eq
id|FB_ACCEL_MATROX_MGAG200
)paren
(brace
id|pci_read_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
l_int|0x50
comma
op_amp
id|reg50
)paren
suffix:semicolon
id|reg50
op_and_assign
op_complement
l_int|0x3000
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
l_int|0x50
comma
id|reg50
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.memtype
)paren
op_eq
op_minus
l_int|1
)paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.memtype
)paren
op_assign
l_int|3
suffix:semicolon
id|hw-&gt;MXoptionReg
op_or_assign
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.memtype
)paren
op_amp
l_int|7
)paren
op_lshift
l_int|10
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.sgram
)paren
)paren
id|hw-&gt;MXoptionReg
op_or_assign
l_int|0x4000
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_CTLWTST
comma
l_int|0x042450A1
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_MEMRDBK
comma
l_int|0x00000108
)paren
suffix:semicolon
id|udelay
c_func
(paren
l_int|200
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_MACCESS
comma
l_int|0x00000000
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_MACCESS
comma
l_int|0x00008000
)paren
suffix:semicolon
id|udelay
c_func
(paren
l_int|100
)paren
suffix:semicolon
id|mga_outw
c_func
(paren
id|M_MEMRDBK
comma
l_int|0x00000108
)paren
suffix:semicolon
id|hw-&gt;MXoptionReg
op_or_assign
l_int|0x00078020
suffix:semicolon
)brace
r_else
(brace
id|pci_read_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
l_int|0x50
comma
op_amp
id|reg50
)paren
suffix:semicolon
id|reg50
op_and_assign
op_complement
l_int|0x00000100
suffix:semicolon
id|reg50
op_or_assign
l_int|0x00000000
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
l_int|0x50
comma
id|reg50
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.memtype
)paren
op_eq
op_minus
l_int|1
)paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.memtype
)paren
op_assign
l_int|0
suffix:semicolon
id|hw-&gt;MXoptionReg
op_or_assign
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.memtype
)paren
op_amp
l_int|7
)paren
op_lshift
l_int|10
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.sgram
)paren
)paren
id|hw-&gt;MXoptionReg
op_or_assign
l_int|0x4000
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_CTLWTST
comma
l_int|0x042450A1
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_MEMRDBK
comma
l_int|0x00000108
)paren
suffix:semicolon
id|udelay
c_func
(paren
l_int|200
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_MACCESS
comma
l_int|0x00000000
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_MACCESS
comma
l_int|0x00008000
)paren
suffix:semicolon
id|udelay
c_func
(paren
l_int|100
)paren
suffix:semicolon
id|mga_outl
c_func
(paren
id|M_MEMRDBK
comma
l_int|0x00000108
)paren
suffix:semicolon
id|hw-&gt;MXoptionReg
op_or_assign
l_int|0x00040020
suffix:semicolon
)brace
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_OPTION_REG
comma
id|hw-&gt;MXoptionReg
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
)def_block
DECL|function|MGAG100_reset
r_static
r_void
(def_block
id|MGAG100_reset
c_func
(paren
id|WPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
)paren
(brace
id|u_int8_t
id|b
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;MGAG100_reset&quot;
)paren
id|ACCESS_FBINFO
c_func
(paren
id|features.DAC1064.cursorimage
)paren
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|video.len_usable
)paren
op_minus
l_int|1024
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.hwcursor
)paren
)paren
id|ACCESS_FBINFO
c_func
(paren
id|video.len_usable
)paren
op_sub_assign
l_int|1024
suffix:semicolon
id|matroxfb_fastfont_init
c_func
(paren
id|MINFO
)paren
suffix:semicolon
(brace
macro_line|#ifdef G100_BROKEN_IBM_82351
id|u_int32_t
id|d
suffix:semicolon
id|find
l_int|1014
op_div
l_int|22
(paren
id|IBM
op_div
l_int|82351
)paren
suffix:semicolon
multiline_comment|/* if found and bridging Matrox, do some strange stuff */
id|pci_read_config_byte
c_func
(paren
id|ibm
comma
id|PCI_SECONDARY_BUS
comma
op_amp
id|b
)paren
suffix:semicolon
r_if
c_cond
(paren
id|b
op_eq
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
op_member_access_from_pointer
id|bus-&gt;number
)paren
(brace
id|pci_write_config_byte
c_func
(paren
id|ibm
comma
id|PCI_COMMAND
op_plus
l_int|1
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* disable back-to-back &amp; SERR */
id|pci_write_config_byte
c_func
(paren
id|ibm
comma
l_int|0x41
comma
l_int|0xF4
)paren
suffix:semicolon
multiline_comment|/* ??? */
id|pci_write_config_byte
c_func
(paren
id|ibm
comma
id|PCI_IO_BASE
comma
l_int|0xF0
)paren
suffix:semicolon
multiline_comment|/* ??? */
id|pci_write_config_byte
c_func
(paren
id|ibm
comma
id|PCI_IO_LIMIT
comma
l_int|0x00
)paren
suffix:semicolon
multiline_comment|/* ??? */
)brace
macro_line|#endif
r_if
c_cond
(paren
op_logical_neg
id|ACCESS_FBINFO
c_func
(paren
id|devflags.noinit
)paren
)paren
(brace
r_if
c_cond
(paren
id|x7AF4
op_amp
l_int|8
)paren
(brace
id|hw-&gt;MXoptionReg
op_or_assign
l_int|0x40
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_OPTION_REG
comma
id|hw-&gt;MXoptionReg
)paren
suffix:semicolon
)brace
id|mga_setr
c_func
(paren
id|M_EXTVGA_INDEX
comma
l_int|0x06
comma
l_int|0x50
)paren
suffix:semicolon
)brace
)brace
id|DAC1064_setmclk
c_func
(paren
id|PMINFO
id|hw
comma
id|DAC1064_OPT_RESERVED
op_or
id|DAC1064_OPT_MDIV2
op_or
id|DAC1064_OPT_GDIV1
op_or
id|DAC1064_OPT_SCLK_PLL
comma
l_int|133333
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.noinit
)paren
)paren
r_return
suffix:semicolon
id|MGAG100_setPixClock
c_func
(paren
id|PMINFO
l_int|4
comma
l_int|25175
)paren
suffix:semicolon
id|MGAG100_setPixClock
c_func
(paren
id|PMINFO
l_int|5
comma
l_int|28322
)paren
suffix:semicolon
r_if
c_cond
(paren
id|x7AF4
op_amp
l_int|0x10
)paren
(brace
id|b
op_assign
id|inDAC1064
c_func
(paren
id|PMINFO
id|M1064_XGENIODATA
)paren
op_amp
op_complement
l_int|1
suffix:semicolon
id|outDAC1064
c_func
(paren
id|PMINFO
id|M1064_XGENIODATA
comma
id|b
)paren
suffix:semicolon
id|b
op_assign
id|inDAC1064
c_func
(paren
id|PMINFO
id|M1064_XGENIOCTRL
)paren
op_or
l_int|1
suffix:semicolon
id|outDAC1064
c_func
(paren
id|PMINFO
id|M1064_XGENIOCTRL
comma
id|b
)paren
suffix:semicolon
)brace
)brace
)def_block
macro_line|#endif
macro_line|#ifdef CONFIG_FB_MATROX_MYSTIQUE
DECL|function|MGA1064_restore
r_static
r_void
id|MGA1064_restore
c_func
(paren
id|WPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
comma
r_struct
id|matrox_hw_state
op_star
id|oldhw
comma
r_struct
id|display
op_star
id|p
)paren
(brace
r_int
id|i
suffix:semicolon
id|CRITFLAGS
id|DBG
c_func
(paren
l_string|&quot;MGA1064_restore&quot;
)paren
id|CRITBEGIN
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_OPTION_REG
comma
id|hw-&gt;MXoptionReg
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_IEN
comma
l_int|0x00
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_CACHEFLUSH
comma
l_int|0x00
)paren
suffix:semicolon
id|CRITEND
id|DAC1064_restore_1
c_func
(paren
id|PMINFO
id|hw
comma
id|oldhw
)paren
suffix:semicolon
id|matroxfb_vgaHWrestore
c_func
(paren
id|PMINFO
id|hw
comma
id|oldhw
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|6
suffix:semicolon
id|i
op_increment
)paren
id|mga_setr
c_func
(paren
id|M_EXTVGA_INDEX
comma
id|i
comma
id|hw-&gt;CRTCEXT
(braket
id|i
)braket
)paren
suffix:semicolon
id|DAC1064_restore_2
c_func
(paren
id|PMINFO
id|hw
comma
id|oldhw
comma
id|p
)paren
suffix:semicolon
)brace
macro_line|#endif
macro_line|#ifdef CONFIG_FB_MATROX_G100
DECL|function|MGAG100_restore
r_static
r_void
id|MGAG100_restore
c_func
(paren
id|WPMINFO
r_struct
id|matrox_hw_state
op_star
id|hw
comma
r_struct
id|matrox_hw_state
op_star
id|oldhw
comma
r_struct
id|display
op_star
id|p
)paren
(brace
r_int
id|i
suffix:semicolon
id|CRITFLAGS
id|DBG
c_func
(paren
l_string|&quot;MGAG100_restore&quot;
)paren
id|CRITBEGIN
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_OPTION_REG
comma
id|hw-&gt;MXoptionReg
)paren
suffix:semicolon
id|CRITEND
id|DAC1064_restore_1
c_func
(paren
id|PMINFO
id|hw
comma
id|oldhw
)paren
suffix:semicolon
id|matroxfb_vgaHWrestore
c_func
(paren
id|PMINFO
id|hw
comma
id|oldhw
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_FB_MATROX_32MB
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.support32MB
)paren
)paren
id|mga_setr
c_func
(paren
id|M_EXTVGA_INDEX
comma
l_int|8
comma
id|hw-&gt;CRTCEXT
(braket
l_int|8
)braket
)paren
suffix:semicolon
macro_line|#endif
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|6
suffix:semicolon
id|i
op_increment
)paren
id|mga_setr
c_func
(paren
id|M_EXTVGA_INDEX
comma
id|i
comma
id|hw-&gt;CRTCEXT
(braket
id|i
)braket
)paren
suffix:semicolon
id|DAC1064_restore_2
c_func
(paren
id|PMINFO
id|hw
comma
id|oldhw
comma
id|p
)paren
suffix:semicolon
)brace
macro_line|#endif
macro_line|#ifdef CONFIG_FB_MATROX_MYSTIQUE
DECL|variable|matrox_mystique
r_struct
id|matrox_switch
id|matrox_mystique
op_assign
(brace
id|MGA1064_preinit
comma
id|MGA1064_reset
comma
id|MGA1064_init
comma
id|MGA1064_restore
comma
id|DAC1064_selhwcursor
)brace
suffix:semicolon
DECL|variable|matrox_mystique
id|EXPORT_SYMBOL
c_func
(paren
id|matrox_mystique
)paren
suffix:semicolon
macro_line|#endif
macro_line|#ifdef CONFIG_FB_MATROX_G100
DECL|variable|matrox_G100
r_struct
id|matrox_switch
id|matrox_G100
op_assign
(brace
id|MGAG100_preinit
comma
id|MGAG100_reset
comma
id|MGAG100_init
comma
id|MGAG100_restore
comma
id|DAC1064_selhwcursor
)brace
suffix:semicolon
DECL|variable|matrox_G100
id|EXPORT_SYMBOL
c_func
(paren
id|matrox_G100
)paren
suffix:semicolon
macro_line|#endif
macro_line|#ifdef NEED_DAC1064
DECL|variable|DAC1064_global_init
id|EXPORT_SYMBOL
c_func
(paren
id|DAC1064_global_init
)paren
suffix:semicolon
DECL|variable|DAC1064_global_restore
id|EXPORT_SYMBOL
c_func
(paren
id|DAC1064_global_restore
)paren
suffix:semicolon
macro_line|#endif
eof
