multiline_comment|/*&n; *&n; * Hardware accelerated Matrox Millennium I, II, Mystique, G100, G200 and G400&n; *&n; * (c) 1998,1999,2000 Petr Vandrovec &lt;vandrove@vc.cvut.cz&gt;&n; *&n; * Version: 1.50 2000/08/10&n; *&n; * MTRR stuff: 1998 Tom Rini &lt;trini@kernel.crashing.org&gt;&n; *&n; * Contributors: &quot;menion?&quot; &lt;menion@mindless.com&gt;&n; *                     Betatesting, fixes, ideas&n; *&n; *               &quot;Kurt Garloff&quot; &lt;garloff@suse.de&gt;&n; *                     Betatesting, fixes, ideas, videomodes, videomodes timmings&n; *&n; *               &quot;Tom Rini&quot; &lt;trini@kernel.crashing.org&gt;&n; *                     MTRR stuff, PPC cleanups, betatesting, fixes, ideas&n; *&n; *               &quot;Bibek Sahu&quot; &lt;scorpio@dodds.net&gt;&n; *                     Access device through readb|w|l and write b|w|l&n; *                     Extensive debugging stuff&n; *&n; *               &quot;Daniel Haun&quot; &lt;haund@usa.net&gt;&n; *                     Testing, hardware cursor fixes&n; *&n; *               &quot;Scott Wood&quot; &lt;sawst46+@pitt.edu&gt;&n; *                     Fixes&n; *&n; *               &quot;Gerd Knorr&quot; &lt;kraxel@goldbach.isdn.cs.tu-berlin.de&gt;&n; *                     Betatesting&n; *&n; *               &quot;Kelly French&quot; &lt;targon@hazmat.com&gt;&n; *               &quot;Fernando Herrera&quot; &lt;fherrera@eurielec.etsit.upm.es&gt;&n; *                     Betatesting, bug reporting&n; *&n; *               &quot;Pablo Bianucci&quot; &lt;pbian@pccp.com.ar&gt;&n; *                     Fixes, ideas, betatesting&n; *&n; *               &quot;Inaky Perez Gonzalez&quot; &lt;inaky@peloncho.fis.ucm.es&gt;&n; *                     Fixes, enhandcements, ideas, betatesting&n; *&n; *               &quot;Ryuichi Oikawa&quot; &lt;roikawa@rr.iiij4u.or.jp&gt;&n; *                     PPC betatesting, PPC support, backward compatibility&n; *&n; *               &quot;Paul Womar&quot; &lt;Paul@pwomar.demon.co.uk&gt;&n; *               &quot;Owen Waller&quot; &lt;O.Waller@ee.qub.ac.uk&gt;&n; *                     PPC betatesting&n; *&n; *               &quot;Thomas Pornin&quot; &lt;pornin@bolet.ens.fr&gt;&n; *                     Alpha betatesting&n; *&n; *               &quot;Pieter van Leuven&quot; &lt;pvl@iae.nl&gt;&n; *               &quot;Ulf Jaenicke-Roessler&quot; &lt;ujr@physik.phy.tu-dresden.de&gt;&n; *                     G100 testing&n; *&n; *               &quot;H. Peter Arvin&quot; &lt;hpa@transmeta.com&gt;&n; *                     Ideas&n; *&n; *               &quot;Cort Dougan&quot; &lt;cort@cs.nmt.edu&gt;&n; *                     CHRP fixes and PReP cleanup&n; *&n; *               &quot;Mark Vojkovich&quot; &lt;mvojkovi@ucsd.edu&gt;&n; *                     G400 support&n; *&n; *               &quot;Samuel Hocevar&quot; &lt;sam@via.ecp.fr&gt;&n; *                     Fixes&n; *&n; *               &quot;Anton Altaparmakov&quot; &lt;AntonA@bigfoot.com&gt;&n; *                     G400 MAX/non-MAX distinction&n; *&n; *               &quot;Ken Aaker&quot; &lt;kdaaker@rchland.vnet.ibm.com&gt;&n; *                     memtype extension (needed for GXT130P RS/6000 adapter)&n; *&n; * (following author is not in any relation with this code, but his code&n; *  is included in this driver)&n; *&n; * Based on framebuffer driver for VBE 2.0 compliant graphic boards&n; *     (c) 1998 Gerd Knorr &lt;kraxel@cs.tu-berlin.de&gt;&n; *&n; * (following author is not in any relation with this code, but his ideas&n; *  were used when writting this driver)&n; *&n; *&t;&t; FreeVBE/AF (Matrox), &quot;Shawn Hargreaves&quot; &lt;shawn@talula.demon.co.uk&gt;&n; *&n; */
multiline_comment|/* make checkconfig does not check included files... */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &quot;matroxfb_base.h&quot;
macro_line|#include &quot;matroxfb_misc.h&quot;
macro_line|#include &quot;matroxfb_accel.h&quot;
macro_line|#include &quot;matroxfb_DAC1064.h&quot;
macro_line|#include &quot;matroxfb_Ti3026.h&quot;
macro_line|#include &quot;matroxfb_maven.h&quot;
macro_line|#include &quot;matroxfb_crtc2.h&quot;
macro_line|#include &lt;linux/matroxfb.h&gt;
macro_line|#include &lt;asm/uaccess.h&gt;
macro_line|#ifdef CONFIG_PPC
r_int
r_char
id|nvram_read_byte
c_func
(paren
r_int
)paren
suffix:semicolon
DECL|variable|default_vmode
r_static
r_int
id|default_vmode
op_assign
id|VMODE_NVRAM
suffix:semicolon
DECL|variable|default_cmode
r_static
r_int
id|default_cmode
op_assign
id|CMODE_NVRAM
suffix:semicolon
macro_line|#endif
r_static
r_void
id|matroxfb_unregister_device
c_func
(paren
r_struct
id|matrox_fb_info
op_star
id|minfo
)paren
suffix:semicolon
multiline_comment|/* --------------------------------------------------------------------- */
multiline_comment|/*&n; * card parameters&n; */
multiline_comment|/* --------------------------------------------------------------------- */
DECL|variable|vesafb_defined
r_static
r_struct
id|fb_var_screeninfo
id|vesafb_defined
op_assign
(brace
l_int|640
comma
l_int|480
comma
l_int|640
comma
l_int|480
comma
multiline_comment|/* W,H, W, H (virtual) load xres,xres_virtual*/
l_int|0
comma
l_int|0
comma
multiline_comment|/* virtual -&gt; visible no offset */
l_int|8
comma
multiline_comment|/* depth -&gt; load bits_per_pixel */
l_int|0
comma
multiline_comment|/* greyscale ? */
(brace
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
multiline_comment|/* R */
(brace
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
multiline_comment|/* G */
(brace
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
multiline_comment|/* B */
(brace
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
multiline_comment|/* transparency */
l_int|0
comma
multiline_comment|/* standard pixel format */
id|FB_ACTIVATE_NOW
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
id|FB_ACCELF_TEXT
comma
multiline_comment|/* accel flags */
l_int|39721L
comma
l_int|48L
comma
l_int|16L
comma
l_int|33L
comma
l_int|10L
comma
l_int|96L
comma
l_int|2L
comma
op_complement
l_int|0
comma
multiline_comment|/* No sync info */
id|FB_VMODE_NONINTERLACED
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
)brace
suffix:semicolon
multiline_comment|/* --------------------------------------------------------------------- */
DECL|function|matrox_pan_var
r_static
r_void
id|matrox_pan_var
c_func
(paren
id|WPMINFO
r_struct
id|fb_var_screeninfo
op_star
id|var
)paren
(brace
r_int
r_int
id|pos
suffix:semicolon
r_int
r_int
id|p0
comma
id|p1
comma
id|p2
suffix:semicolon
macro_line|#ifdef CONFIG_FB_MATROX_32MB
r_int
r_int
id|p3
suffix:semicolon
macro_line|#endif
r_struct
id|display
op_star
id|disp
suffix:semicolon
id|CRITFLAGS
id|DBG
c_func
(paren
l_string|&quot;matrox_pan_var&quot;
)paren
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|dead
)paren
)paren
r_return
suffix:semicolon
id|disp
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|currcon_display
)paren
suffix:semicolon
r_if
c_cond
(paren
id|disp-&gt;type
op_eq
id|FB_TYPE_TEXT
)paren
(brace
id|pos
op_assign
id|var-&gt;yoffset
op_div
id|fontheight
c_func
(paren
id|disp
)paren
op_star
id|disp-&gt;next_line
op_div
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textstep
)paren
op_plus
id|var-&gt;xoffset
op_div
(paren
id|fontwidth
c_func
(paren
id|disp
)paren
ques
c_cond
id|fontwidth
c_func
(paren
id|disp
)paren
suffix:colon
l_int|8
)paren
suffix:semicolon
)brace
r_else
(brace
id|pos
op_assign
(paren
id|var-&gt;yoffset
op_star
id|var-&gt;xres_virtual
op_plus
id|var-&gt;xoffset
)paren
op_star
id|ACCESS_FBINFO
c_func
(paren
id|curr.final_bppShift
)paren
op_div
l_int|32
suffix:semicolon
id|pos
op_add_assign
id|ACCESS_FBINFO
c_func
(paren
id|curr.ydstorg.chunks
)paren
suffix:semicolon
)brace
id|p0
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|currenthw
)paren
op_member_access_from_pointer
id|CRTC
(braket
l_int|0x0D
)braket
op_assign
id|pos
op_amp
l_int|0xFF
suffix:semicolon
id|p1
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|currenthw
)paren
op_member_access_from_pointer
id|CRTC
(braket
l_int|0x0C
)braket
op_assign
(paren
id|pos
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
suffix:semicolon
id|p2
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|currenthw
)paren
op_member_access_from_pointer
id|CRTCEXT
(braket
l_int|0
)braket
op_assign
(paren
id|ACCESS_FBINFO
c_func
(paren
id|currenthw
)paren
op_member_access_from_pointer
id|CRTCEXT
(braket
l_int|0
)braket
op_amp
l_int|0xB0
)paren
op_or
(paren
(paren
id|pos
op_rshift
l_int|16
)paren
op_amp
l_int|0x0F
)paren
op_or
(paren
(paren
id|pos
op_rshift
l_int|14
)paren
op_amp
l_int|0x40
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_FB_MATROX_32MB
id|p3
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|currenthw
)paren
op_member_access_from_pointer
id|CRTCEXT
(braket
l_int|8
)braket
op_assign
id|pos
op_rshift
l_int|21
suffix:semicolon
macro_line|#endif
id|CRITBEGIN
id|mga_setr
c_func
(paren
id|M_CRTC_INDEX
comma
l_int|0x0D
comma
id|p0
)paren
suffix:semicolon
id|mga_setr
c_func
(paren
id|M_CRTC_INDEX
comma
l_int|0x0C
comma
id|p1
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_FB_MATROX_32MB
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.support32MB
)paren
)paren
id|mga_setr
c_func
(paren
id|M_EXTVGA_INDEX
comma
l_int|0x08
comma
id|p3
)paren
suffix:semicolon
macro_line|#endif
id|mga_setr
c_func
(paren
id|M_EXTVGA_INDEX
comma
l_int|0x00
comma
id|p2
)paren
suffix:semicolon
id|CRITEND
)brace
DECL|function|matroxfb_remove
r_static
r_void
id|matroxfb_remove
c_func
(paren
id|WPMINFO
r_int
id|dummy
)paren
(brace
multiline_comment|/* Currently we are holding big kernel lock on all dead &amp; usecount updates.&n;&t; * Destroy everything after all users release it. Especially do not unregister&n;&t; * framebuffer and iounmap memory, neither fbmem nor fbcon-cfb* does not check&n;&t; * for device unplugged when in use.&n;&t; * In future we should point mmio.vbase &amp; video.vbase somewhere where we can&n;&t; * write data without causing too much damage...&n;&t; */
id|ACCESS_FBINFO
c_func
(paren
id|dead
)paren
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|usecount
)paren
)paren
(brace
multiline_comment|/* destroy it later */
r_return
suffix:semicolon
)brace
id|matroxfb_unregister_device
c_func
(paren
id|MINFO
)paren
suffix:semicolon
id|unregister_framebuffer
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
)paren
suffix:semicolon
id|del_timer_sync
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|cursor.timer
)paren
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_MTRR
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|mtrr.vram_valid
)paren
)paren
id|mtrr_del
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|mtrr.vram
)paren
comma
id|ACCESS_FBINFO
c_func
(paren
id|video.base
)paren
comma
id|ACCESS_FBINFO
c_func
(paren
id|video.len
)paren
)paren
suffix:semicolon
macro_line|#endif
id|mga_iounmap
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|mmio.vbase
)paren
)paren
suffix:semicolon
id|mga_iounmap
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
)paren
suffix:semicolon
id|release_mem_region
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.base
)paren
comma
id|ACCESS_FBINFO
c_func
(paren
id|video.len_maximum
)paren
)paren
suffix:semicolon
id|release_mem_region
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|mmio.base
)paren
comma
l_int|16384
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_FB_MATROX_MULTIHEAD
id|kfree
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.disp
)paren
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|minfo
)paren
suffix:semicolon
macro_line|#endif
)brace
multiline_comment|/*&n;&t; * Open/Release the frame buffer device&n;&t; */
DECL|function|matroxfb_open
r_static
r_int
id|matroxfb_open
c_func
(paren
r_struct
id|fb_info
op_star
id|info
comma
r_int
id|user
)paren
(brace
DECL|macro|minfo
mdefine_line|#define minfo ((struct matrox_fb_info*)info)
id|DBG_LOOP
c_func
(paren
l_string|&quot;matroxfb_open&quot;
)paren
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|dead
)paren
)paren
(brace
r_return
op_minus
id|ENXIO
suffix:semicolon
)brace
id|ACCESS_FBINFO
c_func
(paren
id|usecount
)paren
op_increment
suffix:semicolon
DECL|macro|minfo
macro_line|#undef minfo
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|matroxfb_release
r_static
r_int
id|matroxfb_release
c_func
(paren
r_struct
id|fb_info
op_star
id|info
comma
r_int
id|user
)paren
(brace
DECL|macro|minfo
mdefine_line|#define minfo ((struct matrox_fb_info*)info)
id|DBG_LOOP
c_func
(paren
l_string|&quot;matroxfb_release&quot;
)paren
r_if
c_cond
(paren
op_logical_neg
(paren
op_decrement
id|ACCESS_FBINFO
c_func
(paren
id|usecount
)paren
)paren
op_logical_and
id|ACCESS_FBINFO
c_func
(paren
id|dead
)paren
)paren
(brace
id|matroxfb_remove
c_func
(paren
id|PMINFO
l_int|0
)paren
suffix:semicolon
)brace
DECL|macro|minfo
macro_line|#undef minfo
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|matroxfb_pan_display
r_static
r_int
id|matroxfb_pan_display
c_func
(paren
r_struct
id|fb_var_screeninfo
op_star
id|var
comma
r_int
id|con
comma
r_struct
id|fb_info
op_star
id|info
)paren
(brace
DECL|macro|minfo
mdefine_line|#define minfo ((struct matrox_fb_info*)info)
id|DBG
c_func
(paren
l_string|&quot;matroxfb_pan_display&quot;
)paren
r_if
c_cond
(paren
id|var-&gt;vmode
op_amp
id|FB_VMODE_YWRAP
)paren
(brace
r_if
c_cond
(paren
id|var-&gt;yoffset
OL
l_int|0
op_logical_or
id|var-&gt;yoffset
op_ge
id|fb_display
(braket
id|con
)braket
dot
id|var.yres_virtual
op_logical_or
id|var-&gt;xoffset
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|var-&gt;xoffset
op_plus
id|fb_display
(braket
id|con
)braket
dot
id|var.xres
OG
id|fb_display
(braket
id|con
)braket
dot
id|var.xres_virtual
op_logical_or
id|var-&gt;yoffset
op_plus
id|fb_display
(braket
id|con
)braket
dot
id|var.yres
OG
id|fb_display
(braket
id|con
)braket
dot
id|var.yres_virtual
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|con
op_eq
id|ACCESS_FBINFO
c_func
(paren
id|currcon
)paren
)paren
id|matrox_pan_var
c_func
(paren
id|PMINFO
id|var
)paren
suffix:semicolon
id|fb_display
(braket
id|con
)braket
dot
id|var.xoffset
op_assign
id|var-&gt;xoffset
suffix:semicolon
id|fb_display
(braket
id|con
)braket
dot
id|var.yoffset
op_assign
id|var-&gt;yoffset
suffix:semicolon
r_if
c_cond
(paren
id|var-&gt;vmode
op_amp
id|FB_VMODE_YWRAP
)paren
id|fb_display
(braket
id|con
)braket
dot
id|var.vmode
op_or_assign
id|FB_VMODE_YWRAP
suffix:semicolon
r_else
id|fb_display
(braket
id|con
)braket
dot
id|var.vmode
op_and_assign
op_complement
id|FB_VMODE_YWRAP
suffix:semicolon
r_return
l_int|0
suffix:semicolon
DECL|macro|minfo
macro_line|#undef minfo
)brace
DECL|function|matroxfb_updatevar
r_static
r_int
id|matroxfb_updatevar
c_func
(paren
r_int
id|con
comma
r_struct
id|fb_info
op_star
id|info
)paren
(brace
DECL|macro|minfo
mdefine_line|#define minfo ((struct matrox_fb_info*)info)
id|DBG
c_func
(paren
l_string|&quot;matroxfb_updatevar&quot;
)paren
suffix:semicolon
id|matrox_pan_var
c_func
(paren
id|PMINFO
op_amp
id|fb_display
(braket
id|con
)braket
dot
id|var
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
DECL|macro|minfo
macro_line|#undef minfo
)brace
DECL|function|matroxfb_get_final_bppShift
r_static
r_int
id|matroxfb_get_final_bppShift
c_func
(paren
id|CPMINFO
r_int
id|bpp
)paren
(brace
r_int
id|bppshft2
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;matroxfb_get_final_bppShift&quot;
)paren
id|bppshft2
op_assign
id|bpp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|bppshft2
)paren
(brace
r_return
l_int|8
suffix:semicolon
)brace
r_if
c_cond
(paren
id|isInterleave
c_func
(paren
id|MINFO
)paren
)paren
id|bppshft2
op_rshift_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.video64bits
)paren
)paren
id|bppshft2
op_rshift_assign
l_int|1
suffix:semicolon
r_return
id|bppshft2
suffix:semicolon
)brace
DECL|function|matroxfb_test_and_set_rounding
r_static
r_int
id|matroxfb_test_and_set_rounding
c_func
(paren
id|CPMINFO
r_int
id|xres
comma
r_int
id|bpp
)paren
(brace
r_int
id|over
suffix:semicolon
r_int
id|rounding
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;matroxfb_test_and_set_rounding&quot;
)paren
r_switch
c_cond
(paren
id|bpp
)paren
(brace
r_case
l_int|0
suffix:colon
r_return
id|xres
suffix:semicolon
r_case
l_int|4
suffix:colon
id|rounding
op_assign
l_int|128
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|8
suffix:colon
id|rounding
op_assign
l_int|64
suffix:semicolon
multiline_comment|/* doc says 64; 32 is OK for G400 */
r_break
suffix:semicolon
r_case
l_int|16
suffix:colon
id|rounding
op_assign
l_int|32
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|24
suffix:colon
id|rounding
op_assign
l_int|64
suffix:semicolon
multiline_comment|/* doc says 64; 32 is OK for G400 */
r_break
suffix:semicolon
r_default
suffix:colon
id|rounding
op_assign
l_int|16
suffix:semicolon
multiline_comment|/* on G400, 16 really does not work */
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.accelerator
)paren
op_eq
id|FB_ACCEL_MATROX_MGAG400
)paren
id|rounding
op_assign
l_int|32
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|isInterleave
c_func
(paren
id|MINFO
)paren
)paren
(brace
id|rounding
op_mul_assign
l_int|2
suffix:semicolon
)brace
id|over
op_assign
id|xres
op_mod
id|rounding
suffix:semicolon
r_if
c_cond
(paren
id|over
)paren
id|xres
op_add_assign
id|rounding
op_minus
id|over
suffix:semicolon
r_return
id|xres
suffix:semicolon
)brace
DECL|function|matroxfb_pitch_adjust
r_static
r_int
id|matroxfb_pitch_adjust
c_func
(paren
id|CPMINFO
r_int
id|xres
comma
r_int
id|bpp
)paren
(brace
r_const
r_int
op_star
id|width
suffix:semicolon
r_int
id|xres_new
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;matroxfb_pitch_adjust&quot;
)paren
r_if
c_cond
(paren
op_logical_neg
id|bpp
)paren
r_return
id|xres
suffix:semicolon
id|width
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|capable.vxres
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|devflags.precise_width
)paren
)paren
(brace
r_while
c_loop
(paren
op_star
id|width
)paren
(brace
r_if
c_cond
(paren
(paren
op_star
id|width
op_ge
id|xres
)paren
op_logical_and
(paren
id|matroxfb_test_and_set_rounding
c_func
(paren
id|PMINFO
op_star
id|width
comma
id|bpp
)paren
op_eq
op_star
id|width
)paren
)paren
(brace
r_break
suffix:semicolon
)brace
id|width
op_increment
suffix:semicolon
)brace
id|xres_new
op_assign
op_star
id|width
suffix:semicolon
)brace
r_else
(brace
id|xres_new
op_assign
id|matroxfb_test_and_set_rounding
c_func
(paren
id|PMINFO
id|xres
comma
id|bpp
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|xres_new
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|xres
op_ne
id|xres_new
)paren
(brace
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;matroxfb: cannot set xres to %d, rounded up to %d&bslash;n&quot;
comma
id|xres
comma
id|xres_new
)paren
suffix:semicolon
)brace
r_return
id|xres_new
suffix:semicolon
)brace
DECL|function|matroxfb_get_cmap_len
r_static
r_int
id|matroxfb_get_cmap_len
c_func
(paren
r_struct
id|fb_var_screeninfo
op_star
id|var
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;matroxfb_get_cmap_len&quot;
)paren
r_switch
c_cond
(paren
id|var-&gt;bits_per_pixel
)paren
(brace
macro_line|#ifdef FBCON_HAS_VGATEXT
r_case
l_int|0
suffix:colon
r_return
l_int|16
suffix:semicolon
multiline_comment|/* pseudocolor... 16 entries HW palette */
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB4
r_case
l_int|4
suffix:colon
r_return
l_int|16
suffix:semicolon
multiline_comment|/* pseudocolor... 16 entries HW palette */
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB8
r_case
l_int|8
suffix:colon
r_return
l_int|256
suffix:semicolon
multiline_comment|/* pseudocolor... 256 entries HW palette */
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB16
r_case
l_int|16
suffix:colon
r_return
l_int|16
suffix:semicolon
multiline_comment|/* directcolor... 16 entries SW palette */
multiline_comment|/* Mystique: truecolor, 16 entries SW palette, HW palette hardwired into 1:1 mapping */
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB24
r_case
l_int|24
suffix:colon
r_return
l_int|16
suffix:semicolon
multiline_comment|/* directcolor... 16 entries SW palette */
multiline_comment|/* Mystique: truecolor, 16 entries SW palette, HW palette hardwired into 1:1 mapping */
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB32
r_case
l_int|32
suffix:colon
r_return
l_int|16
suffix:semicolon
multiline_comment|/* directcolor... 16 entries SW palette */
multiline_comment|/* Mystique: truecolor, 16 entries SW palette, HW palette hardwired into 1:1 mapping */
macro_line|#endif
)brace
r_return
l_int|16
suffix:semicolon
multiline_comment|/* return something reasonable... or panic()? */
)brace
DECL|function|matroxfb_decode_var
r_static
r_int
id|matroxfb_decode_var
c_func
(paren
id|CPMINFO
r_struct
id|display
op_star
id|p
comma
r_struct
id|fb_var_screeninfo
op_star
id|var
comma
r_int
op_star
id|visual
comma
r_int
op_star
id|video_cmap_len
comma
r_int
r_int
op_star
id|ydstorg
)paren
(brace
r_int
r_int
id|vramlen
suffix:semicolon
r_int
r_int
id|memlen
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;matroxfb_decode_var&quot;
)paren
r_switch
c_cond
(paren
id|var-&gt;bits_per_pixel
)paren
(brace
macro_line|#ifdef FBCON_HAS_VGATEXT
r_case
l_int|0
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|ACCESS_FBINFO
c_func
(paren
id|capable.text
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB4
r_case
l_int|4
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|ACCESS_FBINFO
c_func
(paren
id|capable.cfb4
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB8
r_case
l_int|8
suffix:colon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB16
r_case
l_int|16
suffix:colon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB24
r_case
l_int|24
suffix:colon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB32
r_case
l_int|32
suffix:colon
r_break
suffix:semicolon
macro_line|#endif
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
op_star
id|ydstorg
op_assign
l_int|0
suffix:semicolon
id|vramlen
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|video.len_usable
)paren
suffix:semicolon
r_if
c_cond
(paren
id|var-&gt;yres_virtual
OL
id|var-&gt;yres
)paren
id|var-&gt;yres_virtual
op_assign
id|var-&gt;yres
suffix:semicolon
r_if
c_cond
(paren
id|var-&gt;xres_virtual
OL
id|var-&gt;xres
)paren
id|var-&gt;xres_virtual
op_assign
id|var-&gt;xres
suffix:semicolon
r_if
c_cond
(paren
id|var-&gt;bits_per_pixel
)paren
(brace
id|var-&gt;xres_virtual
op_assign
id|matroxfb_pitch_adjust
c_func
(paren
id|PMINFO
id|var-&gt;xres_virtual
comma
id|var-&gt;bits_per_pixel
)paren
suffix:semicolon
id|memlen
op_assign
id|var-&gt;xres_virtual
op_star
id|var-&gt;bits_per_pixel
op_star
id|var-&gt;yres_virtual
op_div
l_int|8
suffix:semicolon
r_if
c_cond
(paren
id|memlen
OG
id|vramlen
)paren
(brace
id|var-&gt;yres_virtual
op_assign
id|vramlen
op_star
l_int|8
op_div
(paren
id|var-&gt;xres_virtual
op_star
id|var-&gt;bits_per_pixel
)paren
suffix:semicolon
id|memlen
op_assign
id|var-&gt;xres_virtual
op_star
id|var-&gt;bits_per_pixel
op_star
id|var-&gt;yres_virtual
op_div
l_int|8
suffix:semicolon
)brace
multiline_comment|/* There is hardware bug that no line can cross 4MB boundary */
multiline_comment|/* give up for CFB24, it is impossible to easy workaround it */
multiline_comment|/* for other try to do something */
r_if
c_cond
(paren
op_logical_neg
id|ACCESS_FBINFO
c_func
(paren
id|capable.cross4MB
)paren
op_logical_and
(paren
id|memlen
OG
l_int|0x400000
)paren
)paren
(brace
r_if
c_cond
(paren
id|var-&gt;bits_per_pixel
op_eq
l_int|24
)paren
(brace
multiline_comment|/* sorry */
)brace
r_else
(brace
r_int
r_int
id|linelen
suffix:semicolon
r_int
r_int
id|m1
op_assign
id|linelen
op_assign
id|var-&gt;xres_virtual
op_star
id|var-&gt;bits_per_pixel
op_div
l_int|8
suffix:semicolon
r_int
r_int
id|m2
op_assign
id|PAGE_SIZE
suffix:semicolon
multiline_comment|/* or 128 if you do not need PAGE ALIGNED address */
r_int
r_int
id|max_yres
suffix:semicolon
r_while
c_loop
(paren
id|m1
)paren
(brace
r_int
id|t
suffix:semicolon
r_while
c_loop
(paren
id|m2
op_ge
id|m1
)paren
id|m2
op_sub_assign
id|m1
suffix:semicolon
id|t
op_assign
id|m1
suffix:semicolon
id|m1
op_assign
id|m2
suffix:semicolon
id|m2
op_assign
id|t
suffix:semicolon
)brace
id|m2
op_assign
id|linelen
op_star
id|PAGE_SIZE
op_div
id|m2
suffix:semicolon
op_star
id|ydstorg
op_assign
id|m2
op_assign
l_int|0x400000
op_mod
id|m2
suffix:semicolon
id|max_yres
op_assign
(paren
id|vramlen
op_minus
id|m2
)paren
op_div
id|linelen
suffix:semicolon
r_if
c_cond
(paren
id|var-&gt;yres_virtual
OG
id|max_yres
)paren
id|var-&gt;yres_virtual
op_assign
id|max_yres
suffix:semicolon
)brace
)brace
)brace
r_else
(brace
id|matrox_text_round
c_func
(paren
id|PMINFO
id|var
comma
id|p
)paren
suffix:semicolon
macro_line|#if 0
multiline_comment|/* we must limit pixclock by mclk...&n;   Millennium I:    66 MHz = 15000&n;   Millennium II:   61 MHz = 16300&n;   Millennium G200: 83 MHz = 12000 */
r_if
c_cond
(paren
id|var-&gt;pixclock
OL
l_int|15000
)paren
id|var-&gt;pixclock
op_assign
l_int|15000
suffix:semicolon
multiline_comment|/* limit for &quot;normal&quot; gclk &amp; mclk */
macro_line|#endif
)brace
multiline_comment|/* YDSTLEN contains only signed 16bit value */
r_if
c_cond
(paren
id|var-&gt;yres_virtual
OG
l_int|32767
)paren
id|var-&gt;yres_virtual
op_assign
l_int|32767
suffix:semicolon
multiline_comment|/* we must round yres/xres down, we already rounded y/xres_virtual up&n;&t;   if it was possible. We should return -EINVAL, but I disagree */
r_if
c_cond
(paren
id|var-&gt;yres_virtual
OL
id|var-&gt;yres
)paren
id|var-&gt;yres
op_assign
id|var-&gt;yres_virtual
suffix:semicolon
r_if
c_cond
(paren
id|var-&gt;xres_virtual
OL
id|var-&gt;xres
)paren
id|var-&gt;xres
op_assign
id|var-&gt;xres_virtual
suffix:semicolon
r_if
c_cond
(paren
id|var-&gt;xoffset
op_plus
id|var-&gt;xres
OG
id|var-&gt;xres_virtual
)paren
id|var-&gt;xoffset
op_assign
id|var-&gt;xres_virtual
op_minus
id|var-&gt;xres
suffix:semicolon
r_if
c_cond
(paren
id|var-&gt;yoffset
op_plus
id|var-&gt;yres
OG
id|var-&gt;yres_virtual
)paren
id|var-&gt;yoffset
op_assign
id|var-&gt;yres_virtual
op_minus
id|var-&gt;yres
suffix:semicolon
r_if
c_cond
(paren
id|var-&gt;bits_per_pixel
op_eq
l_int|0
)paren
(brace
id|var-&gt;red.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;red.length
op_assign
l_int|6
suffix:semicolon
id|var-&gt;green.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;green.length
op_assign
l_int|6
suffix:semicolon
id|var-&gt;blue.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;blue.length
op_assign
l_int|6
suffix:semicolon
id|var-&gt;transp.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;transp.length
op_assign
l_int|0
suffix:semicolon
op_star
id|visual
op_assign
id|MX_VISUAL_PSEUDOCOLOR
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|var-&gt;bits_per_pixel
op_eq
l_int|4
)paren
(brace
id|var-&gt;red.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;red.length
op_assign
l_int|8
suffix:semicolon
id|var-&gt;green.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;green.length
op_assign
l_int|8
suffix:semicolon
id|var-&gt;blue.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;blue.length
op_assign
l_int|8
suffix:semicolon
id|var-&gt;transp.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;transp.length
op_assign
l_int|0
suffix:semicolon
op_star
id|visual
op_assign
id|MX_VISUAL_PSEUDOCOLOR
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|var-&gt;bits_per_pixel
op_le
l_int|8
)paren
(brace
id|var-&gt;red.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;red.length
op_assign
l_int|8
suffix:semicolon
id|var-&gt;green.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;green.length
op_assign
l_int|8
suffix:semicolon
id|var-&gt;blue.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;blue.length
op_assign
l_int|8
suffix:semicolon
id|var-&gt;transp.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;transp.length
op_assign
l_int|0
suffix:semicolon
op_star
id|visual
op_assign
id|MX_VISUAL_PSEUDOCOLOR
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|var-&gt;bits_per_pixel
op_le
l_int|16
)paren
(brace
r_if
c_cond
(paren
id|var-&gt;green.length
op_eq
l_int|5
)paren
(brace
id|var-&gt;red.offset
op_assign
l_int|10
suffix:semicolon
id|var-&gt;red.length
op_assign
l_int|5
suffix:semicolon
id|var-&gt;green.offset
op_assign
l_int|5
suffix:semicolon
id|var-&gt;green.length
op_assign
l_int|5
suffix:semicolon
id|var-&gt;blue.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;blue.length
op_assign
l_int|5
suffix:semicolon
id|var-&gt;transp.offset
op_assign
l_int|15
suffix:semicolon
id|var-&gt;transp.length
op_assign
l_int|1
suffix:semicolon
)brace
r_else
(brace
id|var-&gt;red.offset
op_assign
l_int|11
suffix:semicolon
id|var-&gt;red.length
op_assign
l_int|5
suffix:semicolon
id|var-&gt;green.offset
op_assign
l_int|5
suffix:semicolon
id|var-&gt;green.length
op_assign
l_int|6
suffix:semicolon
id|var-&gt;blue.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;blue.length
op_assign
l_int|5
suffix:semicolon
id|var-&gt;transp.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;transp.length
op_assign
l_int|0
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|var-&gt;bits_per_pixel
op_le
l_int|24
)paren
(brace
id|var-&gt;red.offset
op_assign
l_int|16
suffix:semicolon
id|var-&gt;red.length
op_assign
l_int|8
suffix:semicolon
id|var-&gt;green.offset
op_assign
l_int|8
suffix:semicolon
id|var-&gt;green.length
op_assign
l_int|8
suffix:semicolon
id|var-&gt;blue.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;blue.length
op_assign
l_int|8
suffix:semicolon
id|var-&gt;transp.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;transp.length
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|var-&gt;red.offset
op_assign
l_int|16
suffix:semicolon
id|var-&gt;red.length
op_assign
l_int|8
suffix:semicolon
id|var-&gt;green.offset
op_assign
l_int|8
suffix:semicolon
id|var-&gt;green.length
op_assign
l_int|8
suffix:semicolon
id|var-&gt;blue.offset
op_assign
l_int|0
suffix:semicolon
id|var-&gt;blue.length
op_assign
l_int|8
suffix:semicolon
id|var-&gt;transp.offset
op_assign
l_int|24
suffix:semicolon
id|var-&gt;transp.length
op_assign
l_int|8
suffix:semicolon
)brace
id|dprintk
c_func
(paren
l_string|&quot;matroxfb: truecolor: &quot;
l_string|&quot;size=%d:%d:%d:%d, shift=%d:%d:%d:%d&bslash;n&quot;
comma
id|var-&gt;transp.length
comma
id|var-&gt;red.length
comma
id|var-&gt;green.length
comma
id|var-&gt;blue.length
comma
id|var-&gt;transp.offset
comma
id|var-&gt;red.offset
comma
id|var-&gt;green.offset
comma
id|var-&gt;blue.offset
)paren
suffix:semicolon
op_star
id|visual
op_assign
id|MX_VISUAL_DIRECTCOLOR
suffix:semicolon
)brace
op_star
id|video_cmap_len
op_assign
id|matroxfb_get_cmap_len
c_func
(paren
id|var
)paren
suffix:semicolon
id|dprintk
c_func
(paren
id|KERN_INFO
l_string|&quot;requested %d*%d/%dbpp (%d*%d)&bslash;n&quot;
comma
id|var-&gt;xres
comma
id|var-&gt;yres
comma
id|var-&gt;bits_per_pixel
comma
id|var-&gt;xres_virtual
comma
id|var-&gt;yres_virtual
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|matrox_setcolreg
r_static
r_int
id|matrox_setcolreg
c_func
(paren
r_int
id|regno
comma
r_int
id|red
comma
r_int
id|green
comma
r_int
id|blue
comma
r_int
id|transp
comma
r_struct
id|fb_info
op_star
id|fb_info
)paren
(brace
r_struct
id|display
op_star
id|p
suffix:semicolon
macro_line|#ifdef CONFIG_FB_MATROX_MULTIHEAD
r_struct
id|matrox_fb_info
op_star
id|minfo
op_assign
(paren
r_struct
id|matrox_fb_info
op_star
)paren
id|fb_info
suffix:semicolon
macro_line|#endif
id|DBG
c_func
(paren
l_string|&quot;matrox_setcolreg&quot;
)paren
multiline_comment|/*&n;&t; *  Set a single color register. The values supplied are&n;&t; *  already rounded down to the hardware&squot;s capabilities&n;&t; *  (according to the entries in the `var&squot; structure). Return&n;&t; *  != 0 for invalid regno.&n;&t; */
r_if
c_cond
(paren
id|regno
op_ge
id|ACCESS_FBINFO
c_func
(paren
id|curr.cmap_len
)paren
)paren
r_return
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|palette
(braket
id|regno
)braket
dot
id|red
)paren
op_assign
id|red
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|palette
(braket
id|regno
)braket
dot
id|green
)paren
op_assign
id|green
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|palette
(braket
id|regno
)braket
dot
id|blue
)paren
op_assign
id|blue
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|palette
(braket
id|regno
)braket
dot
id|transp
)paren
op_assign
id|transp
suffix:semicolon
id|p
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|currcon_display
)paren
suffix:semicolon
r_if
c_cond
(paren
id|p-&gt;var.grayscale
)paren
(brace
multiline_comment|/* gray = 0.30*R + 0.59*G + 0.11*B */
id|red
op_assign
id|green
op_assign
id|blue
op_assign
(paren
id|red
op_star
l_int|77
op_plus
id|green
op_star
l_int|151
op_plus
id|blue
op_star
l_int|28
)paren
op_rshift
l_int|8
suffix:semicolon
)brace
id|red
op_assign
id|CNVT_TOHW
c_func
(paren
id|red
comma
id|p-&gt;var.red.length
)paren
suffix:semicolon
id|green
op_assign
id|CNVT_TOHW
c_func
(paren
id|green
comma
id|p-&gt;var.green.length
)paren
suffix:semicolon
id|blue
op_assign
id|CNVT_TOHW
c_func
(paren
id|blue
comma
id|p-&gt;var.blue.length
)paren
suffix:semicolon
id|transp
op_assign
id|CNVT_TOHW
c_func
(paren
id|transp
comma
id|p-&gt;var.transp.length
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|p-&gt;var.bits_per_pixel
)paren
(brace
macro_line|#if defined(FBCON_HAS_CFB8) || defined(FBCON_HAS_CFB4) || defined(FBCON_HAS_VGATEXT)
macro_line|#ifdef FBCON_HAS_VGATEXT
r_case
l_int|0
suffix:colon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB4
r_case
l_int|4
suffix:colon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB8
r_case
l_int|8
suffix:colon
macro_line|#endif
id|mga_outb
c_func
(paren
id|M_DAC_REG
comma
id|regno
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_DAC_VAL
comma
id|red
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_DAC_VAL
comma
id|green
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_DAC_VAL
comma
id|blue
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB16
r_case
l_int|16
suffix:colon
id|ACCESS_FBINFO
c_func
(paren
id|cmap.cfb16
(braket
id|regno
)braket
)paren
op_assign
(paren
id|red
op_lshift
id|p-&gt;var.red.offset
)paren
op_or
(paren
id|green
op_lshift
id|p-&gt;var.green.offset
)paren
op_or
(paren
id|blue
op_lshift
id|p-&gt;var.blue.offset
)paren
op_or
(paren
id|transp
op_lshift
id|p-&gt;var.transp.offset
)paren
suffix:semicolon
multiline_comment|/* for 1:5:5:5 */
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB24
r_case
l_int|24
suffix:colon
id|ACCESS_FBINFO
c_func
(paren
id|cmap.cfb24
(braket
id|regno
)braket
)paren
op_assign
(paren
id|red
op_lshift
id|p-&gt;var.red.offset
)paren
op_or
(paren
id|green
op_lshift
id|p-&gt;var.green.offset
)paren
op_or
(paren
id|blue
op_lshift
id|p-&gt;var.blue.offset
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB32
r_case
l_int|32
suffix:colon
id|ACCESS_FBINFO
c_func
(paren
id|cmap.cfb32
(braket
id|regno
)braket
)paren
op_assign
(paren
id|red
op_lshift
id|p-&gt;var.red.offset
)paren
op_or
(paren
id|green
op_lshift
id|p-&gt;var.green.offset
)paren
op_or
(paren
id|blue
op_lshift
id|p-&gt;var.blue.offset
)paren
op_or
(paren
id|transp
op_lshift
id|p-&gt;var.transp.offset
)paren
suffix:semicolon
multiline_comment|/* 8:8:8:8 */
r_break
suffix:semicolon
macro_line|#endif
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|do_install_cmap
r_static
r_void
id|do_install_cmap
c_func
(paren
id|WPMINFO
r_struct
id|display
op_star
id|dsp
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;do_install_cmap&quot;
)paren
r_if
c_cond
(paren
id|dsp-&gt;cmap.len
)paren
id|fb_set_cmap
c_func
(paren
op_amp
id|dsp-&gt;cmap
comma
l_int|1
comma
id|matrox_setcolreg
comma
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
)paren
suffix:semicolon
r_else
id|fb_set_cmap
c_func
(paren
id|fb_default_cmap
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|curr.cmap_len
)paren
)paren
comma
l_int|1
comma
id|matrox_setcolreg
comma
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
)paren
suffix:semicolon
)brace
DECL|function|matroxfb_get_fix
r_static
r_int
id|matroxfb_get_fix
c_func
(paren
r_struct
id|fb_fix_screeninfo
op_star
id|fix
comma
r_int
id|con
comma
r_struct
id|fb_info
op_star
id|info
)paren
(brace
r_struct
id|display
op_star
id|p
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;matroxfb_get_fix&quot;
)paren
DECL|macro|minfo
mdefine_line|#define minfo ((struct matrox_fb_info*)info)
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|dead
)paren
)paren
(brace
r_return
op_minus
id|ENXIO
suffix:semicolon
)brace
r_if
c_cond
(paren
id|con
op_ge
l_int|0
)paren
id|p
op_assign
id|fb_display
op_plus
id|con
suffix:semicolon
r_else
id|p
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.disp
)paren
suffix:semicolon
id|memset
c_func
(paren
id|fix
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|fb_fix_screeninfo
)paren
)paren
suffix:semicolon
id|strcpy
c_func
(paren
id|fix-&gt;id
comma
l_string|&quot;MATROX&quot;
)paren
suffix:semicolon
id|fix-&gt;smem_start
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|video.base
)paren
op_plus
id|ACCESS_FBINFO
c_func
(paren
id|curr.ydstorg.bytes
)paren
suffix:semicolon
id|fix-&gt;smem_len
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|video.len_usable
)paren
op_minus
id|ACCESS_FBINFO
c_func
(paren
id|curr.ydstorg.bytes
)paren
suffix:semicolon
id|fix-&gt;type
op_assign
id|p-&gt;type
suffix:semicolon
id|fix-&gt;type_aux
op_assign
id|p-&gt;type_aux
suffix:semicolon
id|fix-&gt;visual
op_assign
id|p-&gt;visual
suffix:semicolon
id|fix-&gt;xpanstep
op_assign
l_int|8
suffix:semicolon
multiline_comment|/* 8 for 8bpp, 4 for 16bpp, 2 for 32bpp */
id|fix-&gt;ypanstep
op_assign
l_int|1
suffix:semicolon
id|fix-&gt;ywrapstep
op_assign
l_int|0
suffix:semicolon
id|fix-&gt;line_length
op_assign
id|p-&gt;line_length
suffix:semicolon
id|fix-&gt;mmio_start
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|mmio.base
)paren
suffix:semicolon
id|fix-&gt;mmio_len
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|mmio.len
)paren
suffix:semicolon
id|fix-&gt;accel
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|devflags.accelerator
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
DECL|macro|minfo
macro_line|#undef minfo
)brace
DECL|function|matroxfb_get_var
r_static
r_int
id|matroxfb_get_var
c_func
(paren
r_struct
id|fb_var_screeninfo
op_star
id|var
comma
r_int
id|con
comma
r_struct
id|fb_info
op_star
id|info
)paren
(brace
DECL|macro|minfo
mdefine_line|#define minfo ((struct matrox_fb_info*)info)
id|DBG
c_func
(paren
l_string|&quot;matroxfb_get_var&quot;
)paren
r_if
c_cond
(paren
id|con
OL
l_int|0
)paren
(brace
op_star
id|var
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.disp
)paren
op_member_access_from_pointer
id|var
suffix:semicolon
)brace
r_else
op_star
id|var
op_assign
id|fb_display
(braket
id|con
)braket
dot
id|var
suffix:semicolon
r_return
l_int|0
suffix:semicolon
DECL|macro|minfo
macro_line|#undef minfo
)brace
DECL|function|matroxfb_set_var
r_static
r_int
id|matroxfb_set_var
c_func
(paren
r_struct
id|fb_var_screeninfo
op_star
id|var
comma
r_int
id|con
comma
r_struct
id|fb_info
op_star
id|info
)paren
(brace
DECL|macro|minfo
mdefine_line|#define minfo ((struct matrox_fb_info*)info)
r_int
id|err
suffix:semicolon
r_int
id|visual
suffix:semicolon
r_int
id|cmap_len
suffix:semicolon
r_int
r_int
id|ydstorg
suffix:semicolon
r_struct
id|display
op_star
id|display
suffix:semicolon
r_int
id|chgvar
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;matroxfb_set_var&quot;
)paren
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|dead
)paren
)paren
(brace
r_return
op_minus
id|ENXIO
suffix:semicolon
)brace
r_if
c_cond
(paren
id|con
op_ge
l_int|0
)paren
id|display
op_assign
id|fb_display
op_plus
id|con
suffix:semicolon
r_else
id|display
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.disp
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|err
op_assign
id|matroxfb_decode_var
c_func
(paren
id|PMINFO
id|display
comma
id|var
comma
op_amp
id|visual
comma
op_amp
id|cmap_len
comma
op_amp
id|ydstorg
)paren
)paren
op_ne
l_int|0
)paren
r_return
id|err
suffix:semicolon
r_switch
c_cond
(paren
id|var-&gt;activate
op_amp
id|FB_ACTIVATE_MASK
)paren
(brace
r_case
id|FB_ACTIVATE_TEST
suffix:colon
r_return
l_int|0
suffix:semicolon
r_case
id|FB_ACTIVATE_NXTOPEN
suffix:colon
multiline_comment|/* ?? */
r_case
id|FB_ACTIVATE_NOW
suffix:colon
r_break
suffix:semicolon
multiline_comment|/* continue */
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
multiline_comment|/* unknown */
)brace
r_if
c_cond
(paren
id|con
op_ge
l_int|0
)paren
(brace
id|chgvar
op_assign
(paren
(paren
id|display-&gt;var.xres
op_ne
id|var-&gt;xres
)paren
op_logical_or
(paren
id|display-&gt;var.yres
op_ne
id|var-&gt;yres
)paren
op_logical_or
(paren
id|display-&gt;var.xres_virtual
op_ne
id|var-&gt;xres_virtual
)paren
op_logical_or
(paren
id|display-&gt;var.yres_virtual
op_ne
id|var-&gt;yres_virtual
)paren
op_logical_or
(paren
id|display-&gt;var.bits_per_pixel
op_ne
id|var-&gt;bits_per_pixel
)paren
op_logical_or
id|memcmp
c_func
(paren
op_amp
id|display-&gt;var.red
comma
op_amp
id|var-&gt;red
comma
r_sizeof
(paren
id|var-&gt;red
)paren
)paren
op_logical_or
id|memcmp
c_func
(paren
op_amp
id|display-&gt;var.green
comma
op_amp
id|var-&gt;green
comma
r_sizeof
(paren
id|var-&gt;green
)paren
)paren
op_logical_or
id|memcmp
c_func
(paren
op_amp
id|display-&gt;var.blue
comma
op_amp
id|var-&gt;blue
comma
r_sizeof
(paren
id|var-&gt;blue
)paren
)paren
)paren
suffix:semicolon
)brace
r_else
(brace
id|chgvar
op_assign
l_int|0
suffix:semicolon
)brace
id|display-&gt;var
op_assign
op_star
id|var
suffix:semicolon
multiline_comment|/* cmap */
id|display-&gt;screen_base
op_assign
id|vaddr_va
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
)paren
op_plus
id|ydstorg
suffix:semicolon
id|display-&gt;visual
op_assign
id|visual
suffix:semicolon
id|display-&gt;ypanstep
op_assign
l_int|1
suffix:semicolon
id|display-&gt;ywrapstep
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|var-&gt;bits_per_pixel
)paren
(brace
id|display-&gt;type
op_assign
id|FB_TYPE_PACKED_PIXELS
suffix:semicolon
id|display-&gt;type_aux
op_assign
l_int|0
suffix:semicolon
id|display-&gt;next_line
op_assign
id|display-&gt;line_length
op_assign
(paren
id|var-&gt;xres_virtual
op_star
id|var-&gt;bits_per_pixel
)paren
op_rshift
l_int|3
suffix:semicolon
)brace
r_else
(brace
id|display-&gt;type
op_assign
id|FB_TYPE_TEXT
suffix:semicolon
id|display-&gt;type_aux
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|devflags.text_type_aux
)paren
suffix:semicolon
id|display-&gt;next_line
op_assign
id|display-&gt;line_length
op_assign
(paren
id|var-&gt;xres_virtual
op_div
(paren
id|fontwidth
c_func
(paren
id|display
)paren
ques
c_cond
id|fontwidth
c_func
(paren
id|display
)paren
suffix:colon
l_int|8
)paren
)paren
op_star
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textstep
)paren
suffix:semicolon
)brace
id|display-&gt;can_soft_blank
op_assign
l_int|1
suffix:semicolon
id|display-&gt;inverse
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|devflags.inverse
)paren
suffix:semicolon
multiline_comment|/* conp, fb_info, vrows, cursor_x, cursor_y, fgcol, bgcol */
multiline_comment|/* next_plane, fontdata, _font*, userfont */
id|initMatrox
c_func
(paren
id|PMINFO
id|display
)paren
suffix:semicolon
multiline_comment|/* dispsw */
multiline_comment|/* dispsw, scrollmode, yscroll */
multiline_comment|/* fgshift, bgshift, charmask */
r_if
c_cond
(paren
id|chgvar
op_logical_and
id|info
op_logical_and
id|info-&gt;changevar
)paren
id|info
op_member_access_from_pointer
id|changevar
c_func
(paren
id|con
)paren
suffix:semicolon
r_if
c_cond
(paren
id|con
op_eq
id|ACCESS_FBINFO
c_func
(paren
id|currcon
)paren
)paren
(brace
r_int
r_int
id|pos
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|curr.cmap_len
)paren
op_assign
id|cmap_len
suffix:semicolon
r_if
c_cond
(paren
id|display-&gt;type
op_eq
id|FB_TYPE_TEXT
)paren
(brace
multiline_comment|/* textmode must be in first megabyte, so no ydstorg allowed */
id|ACCESS_FBINFO
c_func
(paren
id|curr.ydstorg.bytes
)paren
op_assign
l_int|0
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|curr.ydstorg.chunks
)paren
op_assign
l_int|0
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|curr.ydstorg.pixels
)paren
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|ydstorg
op_add_assign
id|ACCESS_FBINFO
c_func
(paren
id|devflags.ydstorg
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|curr.ydstorg.bytes
)paren
op_assign
id|ydstorg
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|curr.ydstorg.chunks
)paren
op_assign
id|ydstorg
op_rshift
(paren
id|isInterleave
c_func
(paren
id|MINFO
)paren
ques
c_cond
l_int|3
suffix:colon
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|var-&gt;bits_per_pixel
op_eq
l_int|4
)paren
id|ACCESS_FBINFO
c_func
(paren
id|curr.ydstorg.pixels
)paren
op_assign
id|ydstorg
suffix:semicolon
r_else
id|ACCESS_FBINFO
c_func
(paren
id|curr.ydstorg.pixels
)paren
op_assign
(paren
id|ydstorg
op_star
l_int|8
)paren
op_div
id|var-&gt;bits_per_pixel
suffix:semicolon
)brace
id|ACCESS_FBINFO
c_func
(paren
id|curr.final_bppShift
)paren
op_assign
id|matroxfb_get_final_bppShift
c_func
(paren
id|PMINFO
id|var-&gt;bits_per_pixel
)paren
suffix:semicolon
r_if
c_cond
(paren
id|visual
op_eq
id|MX_VISUAL_PSEUDOCOLOR
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|16
suffix:semicolon
id|i
op_increment
)paren
(brace
r_int
id|j
suffix:semicolon
id|j
op_assign
id|color_table
(braket
id|i
)braket
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|palette
(braket
id|i
)braket
dot
id|red
)paren
op_assign
id|default_red
(braket
id|j
)braket
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|palette
(braket
id|i
)braket
dot
id|green
)paren
op_assign
id|default_grn
(braket
id|j
)braket
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|palette
(braket
id|i
)braket
dot
id|blue
)paren
op_assign
id|default_blu
(braket
id|j
)braket
suffix:semicolon
)brace
)brace
(brace
r_struct
id|my_timming
id|mt
suffix:semicolon
r_struct
id|matrox_hw_state
op_star
id|hw
suffix:semicolon
r_struct
id|matrox_hw_state
op_star
id|ohw
suffix:semicolon
id|matroxfb_var2my
c_func
(paren
id|var
comma
op_amp
id|mt
)paren
suffix:semicolon
multiline_comment|/* CRTC1 delays */
r_switch
c_cond
(paren
id|var-&gt;bits_per_pixel
)paren
(brace
r_case
l_int|0
suffix:colon
id|mt.delay
op_assign
l_int|31
op_plus
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|16
suffix:colon
id|mt.delay
op_assign
l_int|21
op_plus
l_int|8
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|24
suffix:colon
id|mt.delay
op_assign
l_int|17
op_plus
l_int|8
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|32
suffix:colon
id|mt.delay
op_assign
l_int|16
op_plus
l_int|8
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|mt.delay
op_assign
l_int|31
op_plus
l_int|8
suffix:semicolon
r_break
suffix:semicolon
)brace
id|hw
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|newhw
)paren
suffix:semicolon
id|ohw
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|currenthw
)paren
suffix:semicolon
multiline_comment|/* copy last setting... */
id|memcpy
c_func
(paren
id|hw
comma
id|ohw
comma
r_sizeof
(paren
op_star
id|hw
)paren
)paren
suffix:semicolon
id|del_timer_sync
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|cursor.timer
)paren
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|cursor.state
)paren
op_assign
id|CM_ERASE
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|hw_switch
op_member_access_from_pointer
id|init
c_func
(paren
id|PMINFO
id|hw
comma
op_amp
id|mt
comma
id|display
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|display-&gt;type
op_eq
id|FB_TYPE_TEXT
)paren
(brace
r_if
c_cond
(paren
id|fontheight
c_func
(paren
id|display
)paren
)paren
id|pos
op_assign
id|var-&gt;yoffset
op_div
id|fontheight
c_func
(paren
id|display
)paren
op_star
id|display-&gt;next_line
op_div
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textstep
)paren
op_plus
id|var-&gt;xoffset
op_div
(paren
id|fontwidth
c_func
(paren
id|display
)paren
ques
c_cond
id|fontwidth
c_func
(paren
id|display
)paren
suffix:colon
l_int|8
)paren
suffix:semicolon
r_else
id|pos
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|pos
op_assign
(paren
id|var-&gt;yoffset
op_star
id|var-&gt;xres_virtual
op_plus
id|var-&gt;xoffset
)paren
op_star
id|ACCESS_FBINFO
c_func
(paren
id|curr.final_bppShift
)paren
op_div
l_int|32
suffix:semicolon
id|pos
op_add_assign
id|ACCESS_FBINFO
c_func
(paren
id|curr.ydstorg.chunks
)paren
suffix:semicolon
)brace
id|hw-&gt;CRTC
(braket
l_int|0x0D
)braket
op_assign
id|pos
op_amp
l_int|0xFF
suffix:semicolon
id|hw-&gt;CRTC
(braket
l_int|0x0C
)braket
op_assign
(paren
id|pos
op_amp
l_int|0xFF00
)paren
op_rshift
l_int|8
suffix:semicolon
id|hw-&gt;CRTCEXT
(braket
l_int|0
)braket
op_assign
(paren
id|hw-&gt;CRTCEXT
(braket
l_int|0
)braket
op_amp
l_int|0xF0
)paren
op_or
(paren
(paren
id|pos
op_rshift
l_int|16
)paren
op_amp
l_int|0x0F
)paren
op_or
(paren
(paren
id|pos
op_rshift
l_int|14
)paren
op_amp
l_int|0x40
)paren
suffix:semicolon
id|hw-&gt;CRTCEXT
(braket
l_int|8
)braket
op_assign
id|pos
op_rshift
l_int|21
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|output.ph
)paren
op_amp
(paren
id|MATROXFB_OUTPUT_CONN_PRIMARY
op_or
id|MATROXFB_OUTPUT_CONN_DFP
)paren
)paren
(brace
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|primout
)paren
)paren
id|ACCESS_FBINFO
c_func
(paren
id|primout
)paren
op_member_access_from_pointer
id|compute
c_func
(paren
id|MINFO
comma
op_amp
id|mt
comma
id|hw
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|output.ph
)paren
op_amp
id|MATROXFB_OUTPUT_CONN_SECONDARY
)paren
(brace
id|down_read
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|altout.lock
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|altout.output
)paren
)paren
id|ACCESS_FBINFO
c_func
(paren
id|altout.output
)paren
op_member_access_from_pointer
id|compute
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|altout.device
)paren
comma
op_amp
id|mt
comma
id|hw
)paren
suffix:semicolon
id|up_read
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|altout.lock
)paren
)paren
suffix:semicolon
)brace
id|ACCESS_FBINFO
c_func
(paren
id|hw_switch
op_member_access_from_pointer
id|restore
c_func
(paren
id|PMINFO
id|hw
comma
id|ohw
comma
id|display
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|output.ph
)paren
op_amp
(paren
id|MATROXFB_OUTPUT_CONN_PRIMARY
op_or
id|MATROXFB_OUTPUT_CONN_DFP
)paren
)paren
(brace
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|primout
)paren
)paren
id|ACCESS_FBINFO
c_func
(paren
id|primout
)paren
op_member_access_from_pointer
id|program
c_func
(paren
id|MINFO
comma
id|hw
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|output.ph
)paren
op_amp
id|MATROXFB_OUTPUT_CONN_SECONDARY
)paren
(brace
id|down_read
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|altout.lock
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|altout.output
)paren
)paren
id|ACCESS_FBINFO
c_func
(paren
id|altout.output
)paren
op_member_access_from_pointer
id|program
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|altout.device
)paren
comma
id|hw
)paren
suffix:semicolon
id|up_read
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|altout.lock
)paren
)paren
suffix:semicolon
)brace
id|ACCESS_FBINFO
c_func
(paren
id|cursor.redraw
)paren
op_assign
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|currenthw
)paren
op_assign
id|hw
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|newhw
)paren
op_assign
id|ohw
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|output.ph
)paren
op_amp
(paren
id|MATROXFB_OUTPUT_CONN_PRIMARY
op_or
id|MATROXFB_OUTPUT_CONN_DFP
)paren
)paren
(brace
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|primout
)paren
)paren
id|ACCESS_FBINFO
c_func
(paren
id|primout
)paren
op_member_access_from_pointer
id|start
c_func
(paren
id|MINFO
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|output.ph
)paren
op_amp
id|MATROXFB_OUTPUT_CONN_SECONDARY
)paren
(brace
id|down_read
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|altout.lock
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|altout.output
)paren
)paren
id|ACCESS_FBINFO
c_func
(paren
id|altout.output
)paren
op_member_access_from_pointer
id|start
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|altout.device
)paren
)paren
suffix:semicolon
id|up_read
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|altout.lock
)paren
)paren
suffix:semicolon
)brace
id|matrox_cfbX_init
c_func
(paren
id|PMINFO
id|display
)paren
suffix:semicolon
id|do_install_cmap
c_func
(paren
id|PMINFO
id|display
)paren
suffix:semicolon
macro_line|#if defined(CONFIG_FB_COMPAT_XPMAC)
r_if
c_cond
(paren
id|console_fb_info
op_eq
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
)paren
(brace
r_int
id|vmode
comma
id|cmode
suffix:semicolon
id|display_info.width
op_assign
id|var-&gt;xres
suffix:semicolon
id|display_info.height
op_assign
id|var-&gt;yres
suffix:semicolon
id|display_info.depth
op_assign
id|var-&gt;bits_per_pixel
suffix:semicolon
id|display_info.pitch
op_assign
(paren
id|var-&gt;xres_virtual
)paren
op_star
(paren
id|var-&gt;bits_per_pixel
)paren
op_div
l_int|8
suffix:semicolon
r_if
c_cond
(paren
id|mac_var_to_vmode
c_func
(paren
id|var
comma
op_amp
id|vmode
comma
op_amp
id|cmode
)paren
)paren
id|display_info.mode
op_assign
l_int|0
suffix:semicolon
r_else
id|display_info.mode
op_assign
id|vmode
suffix:semicolon
id|strcpy
c_func
(paren
id|display_info.name
comma
id|ACCESS_FBINFO
c_func
(paren
id|matrox_name
)paren
)paren
suffix:semicolon
id|display_info.fb_address
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|video.base
)paren
suffix:semicolon
id|display_info.cmap_adr_address
op_assign
l_int|0
suffix:semicolon
id|display_info.cmap_data_address
op_assign
l_int|0
suffix:semicolon
id|display_info.disp_reg_address
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|mmio.base
)paren
suffix:semicolon
)brace
macro_line|#endif /* CONFIG_FB_COMPAT_XPMAC */
)brace
)brace
r_return
l_int|0
suffix:semicolon
DECL|macro|minfo
macro_line|#undef minfo
)brace
DECL|function|matrox_getcolreg
r_static
r_int
id|matrox_getcolreg
c_func
(paren
r_int
id|regno
comma
r_int
op_star
id|red
comma
r_int
op_star
id|green
comma
r_int
op_star
id|blue
comma
r_int
op_star
id|transp
comma
r_struct
id|fb_info
op_star
id|info
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;matrox_getcolreg&quot;
)paren
DECL|macro|minfo
mdefine_line|#define minfo ((struct matrox_fb_info*)info)
multiline_comment|/*&n;&t; *  Read a single color register and split it into colors/transparent.&n;&t; *  Return != 0 for invalid regno.&n;&t; */
r_if
c_cond
(paren
id|regno
op_ge
id|ACCESS_FBINFO
c_func
(paren
id|curr.cmap_len
)paren
)paren
r_return
l_int|1
suffix:semicolon
op_star
id|red
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|palette
(braket
id|regno
)braket
dot
id|red
)paren
suffix:semicolon
op_star
id|green
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|palette
(braket
id|regno
)braket
dot
id|green
)paren
suffix:semicolon
op_star
id|blue
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|palette
(braket
id|regno
)braket
dot
id|blue
)paren
suffix:semicolon
op_star
id|transp
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|palette
(braket
id|regno
)braket
dot
id|transp
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
DECL|macro|minfo
macro_line|#undef minfo
)brace
DECL|function|matroxfb_get_cmap
r_static
r_int
id|matroxfb_get_cmap
c_func
(paren
r_struct
id|fb_cmap
op_star
id|cmap
comma
r_int
id|kspc
comma
r_int
id|con
comma
r_struct
id|fb_info
op_star
id|info
)paren
(brace
DECL|macro|minfo
mdefine_line|#define minfo ((struct matrox_fb_info*)info)
r_struct
id|display
op_star
id|dsp
op_assign
(paren
id|con
OL
l_int|0
)paren
ques
c_cond
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.disp
)paren
suffix:colon
id|fb_display
op_plus
id|con
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;matroxfb_get_cmap&quot;
)paren
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|dead
)paren
)paren
(brace
r_return
op_minus
id|ENXIO
suffix:semicolon
)brace
r_if
c_cond
(paren
id|con
op_eq
id|ACCESS_FBINFO
c_func
(paren
id|currcon
)paren
)paren
multiline_comment|/* current console? */
r_return
id|fb_get_cmap
c_func
(paren
id|cmap
comma
id|kspc
comma
id|matrox_getcolreg
comma
id|info
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|dsp-&gt;cmap.len
)paren
multiline_comment|/* non default colormap? */
id|fb_copy_cmap
c_func
(paren
op_amp
id|dsp-&gt;cmap
comma
id|cmap
comma
id|kspc
ques
c_cond
l_int|0
suffix:colon
l_int|2
)paren
suffix:semicolon
r_else
id|fb_copy_cmap
c_func
(paren
id|fb_default_cmap
c_func
(paren
id|matroxfb_get_cmap_len
c_func
(paren
op_amp
id|dsp-&gt;var
)paren
)paren
comma
id|cmap
comma
id|kspc
ques
c_cond
l_int|0
suffix:colon
l_int|2
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
DECL|macro|minfo
macro_line|#undef minfo
)brace
DECL|function|matroxfb_set_cmap
r_static
r_int
id|matroxfb_set_cmap
c_func
(paren
r_struct
id|fb_cmap
op_star
id|cmap
comma
r_int
id|kspc
comma
r_int
id|con
comma
r_struct
id|fb_info
op_star
id|info
)paren
(brace
r_int
r_int
id|cmap_len
suffix:semicolon
r_struct
id|display
op_star
id|dsp
op_assign
(paren
id|con
OL
l_int|0
)paren
ques
c_cond
id|info-&gt;disp
suffix:colon
(paren
id|fb_display
op_plus
id|con
)paren
suffix:semicolon
DECL|macro|minfo
mdefine_line|#define minfo ((struct matrox_fb_info*)info)
id|DBG
c_func
(paren
l_string|&quot;matroxfb_set_cmap&quot;
)paren
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|dead
)paren
)paren
(brace
r_return
op_minus
id|ENXIO
suffix:semicolon
)brace
id|cmap_len
op_assign
id|matroxfb_get_cmap_len
c_func
(paren
op_amp
id|dsp-&gt;var
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dsp-&gt;cmap.len
op_ne
id|cmap_len
)paren
(brace
r_int
id|err
suffix:semicolon
id|err
op_assign
id|fb_alloc_cmap
c_func
(paren
op_amp
id|dsp-&gt;cmap
comma
id|cmap_len
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
)brace
r_if
c_cond
(paren
id|con
op_eq
id|ACCESS_FBINFO
c_func
(paren
id|currcon
)paren
)paren
(brace
multiline_comment|/* current console? */
r_return
id|fb_set_cmap
c_func
(paren
id|cmap
comma
id|kspc
comma
id|matrox_setcolreg
comma
id|info
)paren
suffix:semicolon
)brace
r_else
id|fb_copy_cmap
c_func
(paren
id|cmap
comma
op_amp
id|dsp-&gt;cmap
comma
id|kspc
ques
c_cond
l_int|0
suffix:colon
l_int|1
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
DECL|macro|minfo
macro_line|#undef minfo
)brace
r_static
r_int
id|matroxfb_switch
c_func
(paren
r_int
id|con
comma
r_struct
id|fb_info
op_star
id|info
)paren
suffix:semicolon
DECL|function|matroxfb_get_vblank
r_static
r_int
id|matroxfb_get_vblank
c_func
(paren
id|CPMINFO
r_struct
id|fb_vblank
op_star
id|vblank
)paren
(brace
r_int
r_int
id|sts1
suffix:semicolon
id|memset
c_func
(paren
id|vblank
comma
l_int|0
comma
r_sizeof
(paren
op_star
id|vblank
)paren
)paren
suffix:semicolon
id|vblank-&gt;flags
op_assign
id|FB_VBLANK_HAVE_VCOUNT
op_or
id|FB_VBLANK_HAVE_VSYNC
op_or
id|FB_VBLANK_HAVE_VBLANK
op_or
id|FB_VBLANK_HAVE_HBLANK
suffix:semicolon
id|sts1
op_assign
id|mga_inb
c_func
(paren
id|M_INSTS1
)paren
suffix:semicolon
id|vblank-&gt;vcount
op_assign
id|mga_inl
c_func
(paren
id|M_VCOUNT
)paren
suffix:semicolon
multiline_comment|/* BTW, on my PIII/450 with G400, reading M_INSTS1&n;&t;   byte makes this call about 12% slower (1.70 vs. 2.05 us&n;&t;   per ioctl()) */
r_if
c_cond
(paren
id|sts1
op_amp
l_int|1
)paren
id|vblank-&gt;flags
op_or_assign
id|FB_VBLANK_HBLANKING
suffix:semicolon
r_if
c_cond
(paren
id|sts1
op_amp
l_int|8
)paren
id|vblank-&gt;flags
op_or_assign
id|FB_VBLANK_VSYNCING
suffix:semicolon
r_if
c_cond
(paren
id|vblank-&gt;count
op_ge
id|ACCESS_FBINFO
c_func
(paren
id|currcon_display
)paren
op_member_access_from_pointer
id|var.yres
)paren
id|vblank-&gt;flags
op_or_assign
id|FB_VBLANK_VBLANKING
suffix:semicolon
id|vblank-&gt;hcount
op_assign
l_int|0
suffix:semicolon
id|vblank-&gt;count
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|matroxfb_ioctl
r_static
r_int
id|matroxfb_ioctl
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
comma
r_int
r_int
id|cmd
comma
r_int
r_int
id|arg
comma
r_int
id|con
comma
r_struct
id|fb_info
op_star
id|info
)paren
(brace
DECL|macro|minfo
mdefine_line|#define minfo ((struct matrox_fb_info*)info)
id|DBG
c_func
(paren
l_string|&quot;matroxfb_ioctl&quot;
)paren
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|dead
)paren
)paren
(brace
r_return
op_minus
id|ENXIO
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|FBIOGET_VBLANK
suffix:colon
(brace
r_struct
id|fb_vblank
id|vblank
suffix:semicolon
r_int
id|err
suffix:semicolon
id|err
op_assign
id|matroxfb_get_vblank
c_func
(paren
id|PMINFO
op_amp
id|vblank
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
r_return
id|err
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
(paren
r_struct
id|fb_vblank
op_star
)paren
id|arg
comma
op_amp
id|vblank
comma
r_sizeof
(paren
id|vblank
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|MATROXFB_SET_OUTPUT_MODE
suffix:colon
(brace
r_struct
id|matroxioc_output_mode
id|mom
suffix:semicolon
r_int
id|val
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|mom
comma
(paren
r_struct
id|matroxioc_output_mode
op_star
)paren
id|arg
comma
r_sizeof
(paren
id|mom
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|mom.output
op_ge
r_sizeof
(paren
id|u_int32_t
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_switch
c_cond
(paren
id|mom.output
)paren
(brace
r_case
id|MATROXFB_OUTPUT_PRIMARY
suffix:colon
r_if
c_cond
(paren
id|mom.mode
op_ne
id|MATROXFB_OUTPUT_MODE_MONITOR
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
multiline_comment|/* mode did not change... */
r_return
l_int|0
suffix:semicolon
r_case
id|MATROXFB_OUTPUT_SECONDARY
suffix:colon
id|val
op_assign
op_minus
id|EINVAL
suffix:semicolon
id|down_read
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|altout.lock
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|altout.output
)paren
op_logical_and
id|ACCESS_FBINFO
c_func
(paren
id|altout.device
)paren
)paren
id|val
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|altout.output
)paren
op_member_access_from_pointer
id|setmode
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|altout.device
)paren
comma
id|mom.mode
)paren
suffix:semicolon
id|up_read
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|altout.lock
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
op_ne
l_int|1
)paren
r_return
id|val
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|output.ph
)paren
op_amp
id|MATROXFB_OUTPUT_CONN_SECONDARY
)paren
id|matroxfb_switch
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|currcon
)paren
comma
id|info
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|output.sh
)paren
op_amp
id|MATROXFB_OUTPUT_CONN_SECONDARY
)paren
(brace
r_struct
id|matroxfb_dh_fb_info
op_star
id|crtc2
suffix:semicolon
id|down_read
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|crtc2.lock
)paren
)paren
suffix:semicolon
id|crtc2
op_assign
(paren
r_struct
id|matroxfb_dh_fb_info
op_star
)paren
(paren
id|ACCESS_FBINFO
c_func
(paren
id|crtc2.info
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|crtc2
)paren
id|crtc2-&gt;fbcon
dot
id|switch_con
c_func
(paren
id|crtc2-&gt;currcon
comma
op_amp
id|crtc2-&gt;fbcon
)paren
suffix:semicolon
id|up_read
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|crtc2.lock
)paren
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
r_case
id|MATROXFB_OUTPUT_DFP
suffix:colon
r_if
c_cond
(paren
op_logical_neg
(paren
id|ACCESS_FBINFO
c_func
(paren
id|output.all
)paren
op_amp
id|MATROXFB_OUTPUT_CONN_DFP
)paren
)paren
r_return
op_minus
id|ENXIO
suffix:semicolon
r_if
c_cond
(paren
id|mom.mode
op_ne
id|MATROXFB_OUTPUT_MODE_MONITOR
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
multiline_comment|/* mode did not change... */
r_return
l_int|0
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|MATROXFB_GET_OUTPUT_MODE
suffix:colon
(brace
r_struct
id|matroxioc_output_mode
id|mom
suffix:semicolon
r_int
id|val
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|mom
comma
(paren
r_struct
id|matroxioc_output_mode
op_star
)paren
id|arg
comma
r_sizeof
(paren
id|mom
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|mom.output
op_ge
r_sizeof
(paren
id|u_int32_t
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_switch
c_cond
(paren
id|mom.output
)paren
(brace
r_case
id|MATROXFB_OUTPUT_PRIMARY
suffix:colon
id|mom.mode
op_assign
id|MATROXFB_OUTPUT_MODE_MONITOR
suffix:semicolon
r_break
suffix:semicolon
r_case
id|MATROXFB_OUTPUT_SECONDARY
suffix:colon
id|val
op_assign
op_minus
id|EINVAL
suffix:semicolon
id|down_read
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|altout.lock
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|altout.output
)paren
op_logical_and
id|ACCESS_FBINFO
c_func
(paren
id|altout.device
)paren
)paren
id|val
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|altout.output
)paren
op_member_access_from_pointer
id|getmode
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|altout.device
)paren
comma
op_amp
id|mom.mode
)paren
suffix:semicolon
id|up_read
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|altout.lock
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
)paren
r_return
id|val
suffix:semicolon
r_break
suffix:semicolon
r_case
id|MATROXFB_OUTPUT_DFP
suffix:colon
r_if
c_cond
(paren
op_logical_neg
(paren
id|ACCESS_FBINFO
c_func
(paren
id|output.all
)paren
op_amp
id|MATROXFB_OUTPUT_CONN_DFP
)paren
)paren
r_return
op_minus
id|ENXIO
suffix:semicolon
id|mom.mode
op_assign
id|MATROXFB_OUTPUT_MODE_MONITOR
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
(paren
r_struct
id|matroxioc_output_mode
op_star
)paren
id|arg
comma
op_amp
id|mom
comma
r_sizeof
(paren
id|mom
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|MATROXFB_SET_OUTPUT_CONNECTION
suffix:colon
(brace
id|u_int32_t
id|tmp
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
op_amp
id|tmp
comma
(paren
id|u_int32_t
op_star
)paren
id|arg
comma
r_sizeof
(paren
id|tmp
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|tmp
op_amp
op_complement
id|ACCESS_FBINFO
c_func
(paren
id|output.all
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|tmp
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|output.sh
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|tmp
op_amp
id|MATROXFB_OUTPUT_CONN_DFP
)paren
(brace
r_if
c_cond
(paren
id|tmp
op_amp
id|MATROXFB_OUTPUT_CONN_SECONDARY
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|output.sh
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|tmp
op_eq
id|ACCESS_FBINFO
c_func
(paren
id|output.ph
)paren
)paren
r_return
l_int|0
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|output.ph
)paren
op_assign
id|tmp
suffix:semicolon
id|matroxfb_switch
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|currcon
)paren
comma
id|info
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|MATROXFB_GET_OUTPUT_CONNECTION
suffix:colon
(brace
r_if
c_cond
(paren
id|put_user
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|output.ph
)paren
comma
(paren
id|u_int32_t
op_star
)paren
id|arg
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|MATROXFB_GET_AVAILABLE_OUTPUTS
suffix:colon
(brace
id|u_int32_t
id|tmp
suffix:semicolon
id|tmp
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|output.all
)paren
op_amp
op_complement
id|ACCESS_FBINFO
c_func
(paren
id|output.sh
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|output.ph
)paren
op_amp
id|MATROXFB_OUTPUT_CONN_DFP
)paren
id|tmp
op_and_assign
op_complement
id|MATROXFB_OUTPUT_CONN_SECONDARY
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|output.ph
)paren
op_amp
id|MATROXFB_OUTPUT_CONN_SECONDARY
)paren
id|tmp
op_and_assign
op_complement
id|MATROXFB_OUTPUT_CONN_DFP
suffix:semicolon
r_if
c_cond
(paren
id|put_user
c_func
(paren
id|tmp
comma
(paren
id|u_int32_t
op_star
)paren
id|arg
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_case
id|MATROXFB_GET_ALL_OUTPUTS
suffix:colon
(brace
r_if
c_cond
(paren
id|put_user
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|output.all
)paren
comma
(paren
id|u_int32_t
op_star
)paren
id|arg
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
)brace
r_return
op_minus
id|EINVAL
suffix:semicolon
DECL|macro|minfo
macro_line|#undef minfo
)brace
DECL|variable|matroxfb_ops
r_static
r_struct
id|fb_ops
id|matroxfb_ops
op_assign
(brace
id|owner
suffix:colon
id|THIS_MODULE
comma
id|fb_open
suffix:colon
id|matroxfb_open
comma
id|fb_release
suffix:colon
id|matroxfb_release
comma
id|fb_get_fix
suffix:colon
id|matroxfb_get_fix
comma
id|fb_get_var
suffix:colon
id|matroxfb_get_var
comma
id|fb_set_var
suffix:colon
id|matroxfb_set_var
comma
id|fb_get_cmap
suffix:colon
id|matroxfb_get_cmap
comma
id|fb_set_cmap
suffix:colon
id|matroxfb_set_cmap
comma
id|fb_pan_display
suffix:colon
id|matroxfb_pan_display
comma
id|fb_ioctl
suffix:colon
id|matroxfb_ioctl
comma
)brace
suffix:semicolon
DECL|function|matroxfb_switch
r_static
r_int
id|matroxfb_switch
c_func
(paren
r_int
id|con
comma
r_struct
id|fb_info
op_star
id|info
)paren
(brace
DECL|macro|minfo
mdefine_line|#define minfo ((struct matrox_fb_info*)info)
r_struct
id|fb_cmap
op_star
id|cmap
suffix:semicolon
r_struct
id|display
op_star
id|p
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;matroxfb_switch&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|currcon
)paren
op_ge
l_int|0
)paren
(brace
multiline_comment|/* Do we have to save the colormap? */
id|cmap
op_assign
op_amp
(paren
id|ACCESS_FBINFO
c_func
(paren
id|currcon_display
)paren
op_member_access_from_pointer
id|cmap
)paren
suffix:semicolon
id|dprintk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;switch1: con = %d, cmap.len = %d&bslash;n&quot;
comma
id|ACCESS_FBINFO
c_func
(paren
id|currcon
)paren
comma
id|cmap-&gt;len
)paren
suffix:semicolon
r_if
c_cond
(paren
id|cmap-&gt;len
)paren
(brace
id|dprintk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;switch1a: %p %p %p %p&bslash;n&quot;
comma
id|cmap-&gt;red
comma
id|cmap-&gt;green
comma
id|cmap-&gt;blue
comma
id|cmap-&gt;transp
)paren
suffix:semicolon
id|fb_get_cmap
c_func
(paren
id|cmap
comma
l_int|1
comma
id|matrox_getcolreg
comma
id|info
)paren
suffix:semicolon
macro_line|#ifdef DEBUG
r_if
c_cond
(paren
id|cmap-&gt;red
)paren
(brace
id|dprintk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;switch1r: %X&bslash;n&quot;
comma
id|cmap-&gt;red
(braket
l_int|0
)braket
)paren
suffix:semicolon
)brace
macro_line|#endif
)brace
)brace
id|ACCESS_FBINFO
c_func
(paren
id|currcon
)paren
op_assign
id|con
suffix:semicolon
r_if
c_cond
(paren
id|con
OL
l_int|0
)paren
id|p
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.disp
)paren
suffix:semicolon
r_else
id|p
op_assign
id|fb_display
op_plus
id|con
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|currcon_display
)paren
op_assign
id|p
suffix:semicolon
id|p-&gt;var.activate
op_assign
id|FB_ACTIVATE_NOW
suffix:semicolon
macro_line|#ifdef DEBUG
id|cmap
op_assign
op_amp
id|p-&gt;cmap
suffix:semicolon
id|dprintk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;switch2: con = %d, cmap.len = %d&bslash;n&quot;
comma
id|con
comma
id|cmap-&gt;len
)paren
suffix:semicolon
id|dprintk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;switch2a: %p %p %p %p&bslash;n&quot;
comma
id|cmap-&gt;red
comma
id|cmap-&gt;green
comma
id|cmap-&gt;blue
comma
id|cmap-&gt;transp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|p-&gt;cmap.red
)paren
(brace
id|dprintk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;switch2r: %X&bslash;n&quot;
comma
id|cmap-&gt;red
(braket
l_int|0
)braket
)paren
suffix:semicolon
)brace
macro_line|#endif
id|matroxfb_set_var
c_func
(paren
op_amp
id|p-&gt;var
comma
id|con
comma
id|info
)paren
suffix:semicolon
macro_line|#ifdef DEBUG
id|dprintk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;switch3: con = %d, cmap.len = %d&bslash;n&quot;
comma
id|con
comma
id|cmap-&gt;len
)paren
suffix:semicolon
id|dprintk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;switch3a: %p %p %p %p&bslash;n&quot;
comma
id|cmap-&gt;red
comma
id|cmap-&gt;green
comma
id|cmap-&gt;blue
comma
id|cmap-&gt;transp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|p-&gt;cmap.red
)paren
(brace
id|dprintk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;switch3r: %X&bslash;n&quot;
comma
id|cmap-&gt;red
(braket
l_int|0
)braket
)paren
suffix:semicolon
)brace
macro_line|#endif
r_return
l_int|0
suffix:semicolon
DECL|macro|minfo
macro_line|#undef minfo
)brace
multiline_comment|/* 0 unblank, 1 blank, 2 no vsync, 3 no hsync, 4 off */
DECL|function|matroxfb_blank
r_static
r_void
id|matroxfb_blank
c_func
(paren
r_int
id|blank
comma
r_struct
id|fb_info
op_star
id|info
)paren
(brace
DECL|macro|minfo
mdefine_line|#define minfo ((struct matrox_fb_info*)info)
r_int
id|seq
suffix:semicolon
r_int
id|crtc
suffix:semicolon
id|CRITFLAGS
id|DBG
c_func
(paren
l_string|&quot;matroxfb_blank&quot;
)paren
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|dead
)paren
)paren
r_return
suffix:semicolon
r_switch
c_cond
(paren
id|blank
)paren
(brace
r_case
l_int|1
suffix:colon
id|seq
op_assign
l_int|0x20
suffix:semicolon
id|crtc
op_assign
l_int|0x00
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* works ??? */
r_case
l_int|2
suffix:colon
id|seq
op_assign
l_int|0x20
suffix:semicolon
id|crtc
op_assign
l_int|0x10
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|seq
op_assign
l_int|0x20
suffix:semicolon
id|crtc
op_assign
l_int|0x20
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
id|seq
op_assign
l_int|0x20
suffix:semicolon
id|crtc
op_assign
l_int|0x30
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|seq
op_assign
l_int|0x00
suffix:semicolon
id|crtc
op_assign
l_int|0x00
suffix:semicolon
r_break
suffix:semicolon
)brace
id|CRITBEGIN
id|mga_outb
c_func
(paren
id|M_SEQ_INDEX
comma
l_int|1
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_SEQ_DATA
comma
(paren
id|mga_inb
c_func
(paren
id|M_SEQ_DATA
)paren
op_amp
op_complement
l_int|0x20
)paren
op_or
id|seq
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_EXTVGA_INDEX
comma
l_int|1
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_EXTVGA_DATA
comma
(paren
id|mga_inb
c_func
(paren
id|M_EXTVGA_DATA
)paren
op_amp
op_complement
l_int|0x30
)paren
op_or
id|crtc
)paren
suffix:semicolon
id|CRITEND
DECL|macro|minfo
macro_line|#undef minfo
)brace
DECL|macro|RSDepth
mdefine_line|#define RSDepth(X)&t;(((X) &gt;&gt; 8) &amp; 0x0F)
DECL|macro|RS8bpp
mdefine_line|#define RS8bpp&t;&t;0x1
DECL|macro|RS15bpp
mdefine_line|#define RS15bpp&t;&t;0x2
DECL|macro|RS16bpp
mdefine_line|#define RS16bpp&t;&t;0x3
DECL|macro|RS32bpp
mdefine_line|#define RS32bpp&t;&t;0x4
DECL|macro|RS4bpp
mdefine_line|#define RS4bpp&t;&t;0x5
DECL|macro|RS24bpp
mdefine_line|#define RS24bpp&t;&t;0x6
DECL|macro|RSText
mdefine_line|#define RSText&t;&t;0x7
DECL|macro|RSText8
mdefine_line|#define RSText8&t;&t;0x8
multiline_comment|/* 9-F */
DECL|member|red
DECL|member|green
DECL|member|blue
DECL|member|transp
DECL|member|bits_per_pixel
DECL|variable|colors
r_static
r_struct
(brace
r_struct
id|fb_bitfield
id|red
comma
id|green
comma
id|blue
comma
id|transp
suffix:semicolon
r_int
id|bits_per_pixel
suffix:semicolon
)brace
id|colors
(braket
)braket
op_assign
(brace
(brace
(brace
l_int|0
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
l_int|8
)brace
comma
(brace
(brace
l_int|10
comma
l_int|5
comma
l_int|0
)brace
comma
(brace
l_int|5
comma
l_int|5
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|5
comma
l_int|0
)brace
comma
(brace
l_int|15
comma
l_int|1
comma
l_int|0
)brace
comma
l_int|16
)brace
comma
(brace
(brace
l_int|11
comma
l_int|5
comma
l_int|0
)brace
comma
(brace
l_int|5
comma
l_int|6
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|5
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
l_int|16
)brace
comma
(brace
(brace
l_int|16
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|8
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|24
comma
l_int|8
comma
l_int|0
)brace
comma
l_int|32
)brace
comma
(brace
(brace
l_int|0
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
l_int|4
)brace
comma
(brace
(brace
l_int|16
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|8
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|8
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
l_int|24
)brace
comma
(brace
(brace
l_int|0
comma
l_int|6
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|6
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|6
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
l_int|0
)brace
comma
multiline_comment|/* textmode with (default) VGA8x16 */
(brace
(brace
l_int|0
comma
l_int|6
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|6
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|6
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
l_int|0
)brace
comma
multiline_comment|/* textmode hardwired to VGA8x8 */
)brace
suffix:semicolon
multiline_comment|/* initialized by setup, see explanation at end of file (search for MODULE_PARM_DESC) */
DECL|variable|mem
r_static
r_int
r_int
id|mem
suffix:semicolon
multiline_comment|/* &quot;matrox:mem:xxxxxM&quot; */
DECL|variable|option_precise_width
r_static
r_int
id|option_precise_width
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* cannot be changed, option_precise_width==0 must imply noaccel */
DECL|variable|inv24
r_static
r_int
id|inv24
suffix:semicolon
multiline_comment|/* &quot;matrox:inv24&quot; */
DECL|variable|cross4MB
r_static
r_int
id|cross4MB
op_assign
op_minus
l_int|1
suffix:semicolon
multiline_comment|/* &quot;matrox:cross4MB&quot; */
DECL|variable|disabled
r_static
r_int
id|disabled
suffix:semicolon
multiline_comment|/* &quot;matrox:disabled&quot; */
DECL|variable|noaccel
r_static
r_int
id|noaccel
suffix:semicolon
multiline_comment|/* &quot;matrox:noaccel&quot; */
DECL|variable|nopan
r_static
r_int
id|nopan
suffix:semicolon
multiline_comment|/* &quot;matrox:nopan&quot; */
DECL|variable|no_pci_retry
r_static
r_int
id|no_pci_retry
suffix:semicolon
multiline_comment|/* &quot;matrox:nopciretry&quot; */
DECL|variable|novga
r_static
r_int
id|novga
suffix:semicolon
multiline_comment|/* &quot;matrox:novga&quot; */
DECL|variable|nobios
r_static
r_int
id|nobios
suffix:semicolon
multiline_comment|/* &quot;matrox:nobios&quot; */
DECL|variable|noinit
r_static
r_int
id|noinit
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* &quot;matrox:init&quot; */
DECL|variable|inverse
r_static
r_int
id|inverse
suffix:semicolon
multiline_comment|/* &quot;matrox:inverse&quot; */
DECL|variable|hwcursor
r_static
r_int
id|hwcursor
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* &quot;matrox:nohwcursor&quot; */
DECL|variable|blink
r_static
r_int
id|blink
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* &quot;matrox:noblink&quot; */
DECL|variable|sgram
r_static
r_int
id|sgram
suffix:semicolon
multiline_comment|/* &quot;matrox:sgram&quot; */
macro_line|#ifdef CONFIG_MTRR
DECL|variable|mtrr
r_static
r_int
id|mtrr
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* &quot;matrox:nomtrr&quot; */
macro_line|#endif
DECL|variable|grayscale
r_static
r_int
id|grayscale
suffix:semicolon
multiline_comment|/* &quot;matrox:grayscale&quot; */
DECL|variable|fastfont
r_static
r_int
r_int
id|fastfont
suffix:semicolon
multiline_comment|/* &quot;matrox:fastfont:xxxxx&quot; */
DECL|variable|dev
r_static
r_int
id|dev
op_assign
op_minus
l_int|1
suffix:semicolon
multiline_comment|/* &quot;matrox:dev:xxxxx&quot; */
DECL|variable|vesa
r_static
r_int
r_int
id|vesa
op_assign
op_complement
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:vesa:xxxxx&quot; */
DECL|variable|depth
r_static
r_int
id|depth
op_assign
op_minus
l_int|1
suffix:semicolon
multiline_comment|/* &quot;matrox:depth:xxxxx&quot; */
DECL|variable|xres
r_static
r_int
r_int
id|xres
suffix:semicolon
multiline_comment|/* &quot;matrox:xres:xxxxx&quot; */
DECL|variable|yres
r_static
r_int
r_int
id|yres
suffix:semicolon
multiline_comment|/* &quot;matrox:yres:xxxxx&quot; */
DECL|variable|upper
r_static
r_int
r_int
id|upper
op_assign
op_complement
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:upper:xxxxx&quot; */
DECL|variable|lower
r_static
r_int
r_int
id|lower
op_assign
op_complement
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:lower:xxxxx&quot; */
DECL|variable|vslen
r_static
r_int
r_int
id|vslen
suffix:semicolon
multiline_comment|/* &quot;matrox:vslen:xxxxx&quot; */
DECL|variable|left
r_static
r_int
r_int
id|left
op_assign
op_complement
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:left:xxxxx&quot; */
DECL|variable|right
r_static
r_int
r_int
id|right
op_assign
op_complement
l_int|0
suffix:semicolon
multiline_comment|/* &quot;matrox:right:xxxxx&quot; */
DECL|variable|hslen
r_static
r_int
r_int
id|hslen
suffix:semicolon
multiline_comment|/* &quot;matrox:hslen:xxxxx&quot; */
DECL|variable|pixclock
r_static
r_int
r_int
id|pixclock
suffix:semicolon
multiline_comment|/* &quot;matrox:pixclock:xxxxx&quot; */
DECL|variable|sync
r_static
r_int
id|sync
op_assign
op_minus
l_int|1
suffix:semicolon
multiline_comment|/* &quot;matrox:sync:xxxxx&quot; */
DECL|variable|fv
r_static
r_int
r_int
id|fv
suffix:semicolon
multiline_comment|/* &quot;matrox:fv:xxxxx&quot; */
DECL|variable|fh
r_static
r_int
r_int
id|fh
suffix:semicolon
multiline_comment|/* &quot;matrox:fh:xxxxxk&quot; */
DECL|variable|maxclk
r_static
r_int
r_int
id|maxclk
suffix:semicolon
multiline_comment|/* &quot;matrox:maxclk:xxxxM&quot; */
DECL|variable|dfp
r_static
r_int
id|dfp
suffix:semicolon
multiline_comment|/* &quot;matrox:dfp */
DECL|variable|memtype
r_static
r_int
id|memtype
op_assign
op_minus
l_int|1
suffix:semicolon
multiline_comment|/* &quot;matrox:memtype:xxx&quot; */
DECL|variable|fontname
r_static
r_char
id|fontname
(braket
l_int|64
)braket
suffix:semicolon
multiline_comment|/* &quot;matrox:font:xxxxx&quot; */
macro_line|#ifndef MODULE
DECL|variable|videomode
r_static
r_char
id|videomode
(braket
l_int|64
)braket
suffix:semicolon
multiline_comment|/* &quot;matrox:mode:xxxxx&quot; or &quot;matrox:xxxxx&quot; */
macro_line|#endif
DECL|function|matroxfb_getmemory
r_static
r_int
(def_block
id|matroxfb_getmemory
c_func
(paren
id|WPMINFO
r_int
r_int
id|maxSize
comma
r_int
r_int
op_star
id|realSize
)paren
(brace
id|vaddr_t
id|vm
suffix:semicolon
r_int
r_int
id|offs
suffix:semicolon
r_int
r_int
id|offs2
suffix:semicolon
r_int
r_char
id|store
suffix:semicolon
r_int
r_char
id|bytes
(braket
l_int|32
)braket
suffix:semicolon
r_int
r_char
op_star
id|tmp
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;matroxfb_getmemory&quot;
)paren
id|vm
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
suffix:semicolon
id|maxSize
op_and_assign
op_complement
l_int|0x1FFFFF
suffix:semicolon
multiline_comment|/* must be X*2MB (really it must be 2 or X*4MB) */
multiline_comment|/* at least 2MB */
r_if
c_cond
(paren
id|maxSize
OL
l_int|0x0200000
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|maxSize
OG
l_int|0x2000000
)paren
id|maxSize
op_assign
l_int|0x2000000
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_EXTVGA_INDEX
comma
l_int|0x03
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_EXTVGA_DATA
comma
id|mga_inb
c_func
(paren
id|M_EXTVGA_DATA
)paren
op_or
l_int|0x80
)paren
suffix:semicolon
id|store
op_assign
id|mga_readb
c_func
(paren
id|vm
comma
l_int|0x1234
)paren
suffix:semicolon
id|tmp
op_assign
id|bytes
suffix:semicolon
r_for
c_loop
(paren
id|offs
op_assign
l_int|0x100000
suffix:semicolon
id|offs
OL
id|maxSize
suffix:semicolon
id|offs
op_add_assign
l_int|0x200000
)paren
op_star
id|tmp
op_increment
op_assign
id|mga_readb
c_func
(paren
id|vm
comma
id|offs
)paren
suffix:semicolon
r_for
c_loop
(paren
id|offs
op_assign
l_int|0x100000
suffix:semicolon
id|offs
OL
id|maxSize
suffix:semicolon
id|offs
op_add_assign
l_int|0x200000
)paren
id|mga_writeb
c_func
(paren
id|vm
comma
id|offs
comma
l_int|0x02
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|features.accel.has_cacheflush
)paren
)paren
id|mga_outb
c_func
(paren
id|M_CACHEFLUSH
comma
l_int|0x00
)paren
suffix:semicolon
r_else
id|mga_writeb
c_func
(paren
id|vm
comma
l_int|0x1234
comma
l_int|0x99
)paren
suffix:semicolon
r_for
c_loop
(paren
id|offs
op_assign
l_int|0x100000
suffix:semicolon
id|offs
OL
id|maxSize
suffix:semicolon
id|offs
op_add_assign
l_int|0x200000
)paren
(brace
r_if
c_cond
(paren
id|mga_readb
c_func
(paren
id|vm
comma
id|offs
)paren
op_ne
l_int|0x02
)paren
r_break
suffix:semicolon
id|mga_writeb
c_func
(paren
id|vm
comma
id|offs
comma
id|mga_readb
c_func
(paren
id|vm
comma
id|offs
)paren
op_minus
l_int|0x02
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mga_readb
c_func
(paren
id|vm
comma
id|offs
)paren
)paren
r_break
suffix:semicolon
)brace
id|tmp
op_assign
id|bytes
suffix:semicolon
r_for
c_loop
(paren
id|offs2
op_assign
l_int|0x100000
suffix:semicolon
id|offs2
OL
id|maxSize
suffix:semicolon
id|offs2
op_add_assign
l_int|0x200000
)paren
id|mga_writeb
c_func
(paren
id|vm
comma
id|offs2
comma
op_star
id|tmp
op_increment
)paren
suffix:semicolon
id|mga_writeb
c_func
(paren
id|vm
comma
l_int|0x1234
comma
id|store
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_EXTVGA_INDEX
comma
l_int|0x03
)paren
suffix:semicolon
id|mga_outb
c_func
(paren
id|M_EXTVGA_DATA
comma
id|mga_inb
c_func
(paren
id|M_EXTVGA_DATA
)paren
op_amp
op_complement
l_int|0x80
)paren
suffix:semicolon
op_star
id|realSize
op_assign
id|offs
op_minus
l_int|0x100000
suffix:semicolon
macro_line|#ifdef CONFIG_FB_MATROX_MILLENIUM
id|ACCESS_FBINFO
c_func
(paren
id|interleave
)paren
op_assign
op_logical_neg
(paren
op_logical_neg
id|isMillenium
c_func
(paren
id|MINFO
)paren
op_logical_or
(paren
(paren
id|offs
op_minus
l_int|0x100000
)paren
op_amp
l_int|0x3FFFFF
)paren
)paren
suffix:semicolon
macro_line|#endif
r_return
l_int|1
suffix:semicolon
)brace
)def_block
DECL|struct|video_board
r_struct
id|video_board
(brace
DECL|member|maxvram
r_int
id|maxvram
suffix:semicolon
DECL|member|maxdisplayable
r_int
id|maxdisplayable
suffix:semicolon
DECL|member|accelID
r_int
id|accelID
suffix:semicolon
DECL|member|lowlevel
r_struct
id|matrox_switch
op_star
id|lowlevel
suffix:semicolon
)brace
suffix:semicolon
macro_line|#ifdef CONFIG_FB_MATROX_MILLENIUM
DECL|variable|vbMillennium
r_static
r_struct
id|video_board
id|vbMillennium
op_assign
(brace
l_int|0x0800000
comma
l_int|0x0800000
comma
id|FB_ACCEL_MATROX_MGA2064W
comma
op_amp
id|matrox_millennium
)brace
suffix:semicolon
DECL|variable|vbMillennium2
r_static
r_struct
id|video_board
id|vbMillennium2
op_assign
(brace
l_int|0x1000000
comma
l_int|0x0800000
comma
id|FB_ACCEL_MATROX_MGA2164W
comma
op_amp
id|matrox_millennium
)brace
suffix:semicolon
DECL|variable|vbMillennium2A
r_static
r_struct
id|video_board
id|vbMillennium2A
op_assign
(brace
l_int|0x1000000
comma
l_int|0x0800000
comma
id|FB_ACCEL_MATROX_MGA2164W_AGP
comma
op_amp
id|matrox_millennium
)brace
suffix:semicolon
macro_line|#endif&t;/* CONFIG_FB_MATROX_MILLENIUM */
macro_line|#ifdef CONFIG_FB_MATROX_MYSTIQUE
DECL|variable|vbMystique
r_static
r_struct
id|video_board
id|vbMystique
op_assign
(brace
l_int|0x0800000
comma
l_int|0x0800000
comma
id|FB_ACCEL_MATROX_MGA1064SG
comma
op_amp
id|matrox_mystique
)brace
suffix:semicolon
macro_line|#endif&t;/* CONFIG_FB_MATROX_MYSTIQUE */
macro_line|#ifdef CONFIG_FB_MATROX_G100
DECL|variable|vbG100
r_static
r_struct
id|video_board
id|vbG100
op_assign
(brace
l_int|0x0800000
comma
l_int|0x0800000
comma
id|FB_ACCEL_MATROX_MGAG100
comma
op_amp
id|matrox_G100
)brace
suffix:semicolon
DECL|variable|vbG200
r_static
r_struct
id|video_board
id|vbG200
op_assign
(brace
l_int|0x1000000
comma
l_int|0x1000000
comma
id|FB_ACCEL_MATROX_MGAG200
comma
op_amp
id|matrox_G100
)brace
suffix:semicolon
macro_line|#ifdef CONFIG_FB_MATROX_32MB
multiline_comment|/* from doc it looks like that accelerator can draw only to low 16MB :-( Direct accesses &amp; displaying are OK for&n;   whole 32MB */
DECL|variable|vbG400
r_static
r_struct
id|video_board
id|vbG400
op_assign
(brace
l_int|0x2000000
comma
l_int|0x1000000
comma
id|FB_ACCEL_MATROX_MGAG400
comma
op_amp
id|matrox_G100
)brace
suffix:semicolon
macro_line|#else
DECL|variable|vbG400
r_static
r_struct
id|video_board
id|vbG400
op_assign
(brace
l_int|0x2000000
comma
l_int|0x1000000
comma
id|FB_ACCEL_MATROX_MGAG400
comma
op_amp
id|matrox_G100
)brace
suffix:semicolon
macro_line|#endif
macro_line|#endif
DECL|macro|DEVF_VIDEO64BIT
mdefine_line|#define DEVF_VIDEO64BIT&t;&t;0x0001
DECL|macro|DEVF_SWAPS
mdefine_line|#define&t;DEVF_SWAPS&t;&t;0x0002
DECL|macro|DEVF_MILLENNIUM
mdefine_line|#define DEVF_MILLENNIUM&t;&t;0x0004
DECL|macro|DEVF_MILLENNIUM2
mdefine_line|#define&t;DEVF_MILLENNIUM2&t;0x0008
DECL|macro|DEVF_CROSS4MB
mdefine_line|#define DEVF_CROSS4MB&t;&t;0x0010
DECL|macro|DEVF_TEXT4B
mdefine_line|#define DEVF_TEXT4B&t;&t;0x0020
DECL|macro|DEVF_DDC_8_2
mdefine_line|#define DEVF_DDC_8_2&t;&t;0x0040
DECL|macro|DEVF_DMA
mdefine_line|#define DEVF_DMA&t;&t;0x0080
DECL|macro|DEVF_SUPPORT32MB
mdefine_line|#define DEVF_SUPPORT32MB&t;0x0100
DECL|macro|DEVF_ANY_VXRES
mdefine_line|#define DEVF_ANY_VXRES&t;&t;0x0200
DECL|macro|DEVF_TEXT16B
mdefine_line|#define DEVF_TEXT16B&t;&t;0x0400
DECL|macro|DEVF_CRTC2
mdefine_line|#define DEVF_CRTC2&t;&t;0x0800
DECL|macro|DEVF_MAVEN_CAPABLE
mdefine_line|#define DEVF_MAVEN_CAPABLE&t;0x1000
DECL|macro|DEVF_PANELLINK_CAPABLE
mdefine_line|#define DEVF_PANELLINK_CAPABLE&t;0x2000
DECL|macro|DEVF_G450DAC
mdefine_line|#define DEVF_G450DAC&t;&t;0x4000
DECL|macro|DEVF_GCORE
mdefine_line|#define DEVF_GCORE&t;(DEVF_VIDEO64BIT | DEVF_SWAPS | DEVF_CROSS4MB | DEVF_DDC_8_2)
DECL|macro|DEVF_G2CORE
mdefine_line|#define DEVF_G2CORE&t;(DEVF_GCORE | DEVF_ANY_VXRES | DEVF_MAVEN_CAPABLE | DEVF_PANELLINK_CAPABLE)
DECL|macro|DEVF_G100
mdefine_line|#define DEVF_G100&t;(DEVF_GCORE) /* no doc, no vxres... */
DECL|macro|DEVF_G200
mdefine_line|#define DEVF_G200&t;(DEVF_G2CORE)
DECL|macro|DEVF_G400
mdefine_line|#define DEVF_G400&t;(DEVF_G2CORE | DEVF_SUPPORT32MB | DEVF_TEXT16B | DEVF_CRTC2)
multiline_comment|/* if you&squot;ll find how to drive DFP... */
DECL|macro|DEVF_G450
mdefine_line|#define DEVF_G450&t;(DEVF_GCORE | DEVF_ANY_VXRES | DEVF_SUPPORT32MB | DEVF_TEXT16B | DEVF_CRTC2 | DEVF_G450DAC)
DECL|struct|board
r_static
r_struct
id|board
(brace
DECL|member|vendor
DECL|member|device
DECL|member|rev
DECL|member|svid
DECL|member|sid
r_int
r_int
id|vendor
comma
id|device
comma
id|rev
comma
id|svid
comma
id|sid
suffix:semicolon
DECL|member|flags
r_int
r_int
id|flags
suffix:semicolon
DECL|member|maxclk
r_int
r_int
id|maxclk
suffix:semicolon
DECL|member|base
r_struct
id|video_board
op_star
id|base
suffix:semicolon
DECL|member|name
r_const
r_char
op_star
id|name
suffix:semicolon
DECL|variable|dev_list
)brace
id|dev_list
(braket
)braket
op_assign
(brace
macro_line|#ifdef CONFIG_FB_MATROX_MILLENIUM
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_MIL
comma
l_int|0xFF
comma
l_int|0
comma
l_int|0
comma
id|DEVF_MILLENNIUM
op_or
id|DEVF_TEXT4B
comma
l_int|230000
comma
op_amp
id|vbMillennium
comma
l_string|&quot;Millennium (PCI)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_MIL_2
comma
l_int|0xFF
comma
l_int|0
comma
l_int|0
comma
id|DEVF_MILLENNIUM
op_or
id|DEVF_MILLENNIUM2
op_or
id|DEVF_SWAPS
comma
l_int|220000
comma
op_amp
id|vbMillennium2
comma
l_string|&quot;Millennium II (PCI)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_MIL_2_AGP
comma
l_int|0xFF
comma
l_int|0
comma
l_int|0
comma
id|DEVF_MILLENNIUM
op_or
id|DEVF_MILLENNIUM2
op_or
id|DEVF_SWAPS
comma
l_int|250000
comma
op_amp
id|vbMillennium2A
comma
l_string|&quot;Millennium II (AGP)&quot;
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_MATROX_MYSTIQUE
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_MYS
comma
l_int|0x02
comma
l_int|0
comma
l_int|0
comma
id|DEVF_VIDEO64BIT
comma
l_int|180000
comma
op_amp
id|vbMystique
comma
l_string|&quot;Mystique (PCI)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_MYS
comma
l_int|0xFF
comma
l_int|0
comma
l_int|0
comma
id|DEVF_VIDEO64BIT
op_or
id|DEVF_SWAPS
comma
l_int|220000
comma
op_amp
id|vbMystique
comma
l_string|&quot;Mystique 220 (PCI)&quot;
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_MATROX_G100
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G100
comma
l_int|0xFF
comma
id|PCI_SS_VENDOR_ID_MATROX
comma
id|PCI_SS_ID_MATROX_MGA_G100_PCI
comma
id|DEVF_G100
comma
l_int|230000
comma
op_amp
id|vbG100
comma
l_string|&quot;MGA-G100 (PCI)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G100
comma
l_int|0xFF
comma
l_int|0
comma
l_int|0
comma
id|DEVF_G100
comma
l_int|230000
comma
op_amp
id|vbG100
comma
l_string|&quot;unknown G100 (PCI)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G100_AGP
comma
l_int|0xFF
comma
id|PCI_SS_VENDOR_ID_MATROX
comma
id|PCI_SS_ID_MATROX_GENERIC
comma
id|DEVF_G100
comma
l_int|230000
comma
op_amp
id|vbG100
comma
l_string|&quot;MGA-G100 (AGP)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G100_AGP
comma
l_int|0xFF
comma
id|PCI_SS_VENDOR_ID_MATROX
comma
id|PCI_SS_ID_MATROX_MGA_G100_AGP
comma
id|DEVF_G100
comma
l_int|230000
comma
op_amp
id|vbG100
comma
l_string|&quot;MGA-G100 (AGP)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G100_AGP
comma
l_int|0xFF
comma
id|PCI_SS_VENDOR_ID_SIEMENS_NIXDORF
comma
id|PCI_SS_ID_SIEMENS_MGA_G100_AGP
comma
id|DEVF_G100
comma
l_int|230000
comma
op_amp
id|vbG100
comma
l_string|&quot;MGA-G100 (AGP)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G100_AGP
comma
l_int|0xFF
comma
id|PCI_SS_VENDOR_ID_MATROX
comma
id|PCI_SS_ID_MATROX_PRODUCTIVA_G100_AGP
comma
id|DEVF_G100
comma
l_int|230000
comma
op_amp
id|vbG100
comma
l_string|&quot;Productiva G100 (AGP)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G100_AGP
comma
l_int|0xFF
comma
l_int|0
comma
l_int|0
comma
id|DEVF_G100
comma
l_int|230000
comma
op_amp
id|vbG100
comma
l_string|&quot;unknown G100 (AGP)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G200_PCI
comma
l_int|0xFF
comma
l_int|0
comma
l_int|0
comma
id|DEVF_G200
comma
l_int|250000
comma
op_amp
id|vbG200
comma
l_string|&quot;unknown G200 (PCI)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G200_AGP
comma
l_int|0xFF
comma
id|PCI_SS_VENDOR_ID_MATROX
comma
id|PCI_SS_ID_MATROX_GENERIC
comma
id|DEVF_G200
comma
l_int|220000
comma
op_amp
id|vbG200
comma
l_string|&quot;MGA-G200 (AGP)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G200_AGP
comma
l_int|0xFF
comma
id|PCI_SS_VENDOR_ID_MATROX
comma
id|PCI_SS_ID_MATROX_MYSTIQUE_G200_AGP
comma
id|DEVF_G200
comma
l_int|230000
comma
op_amp
id|vbG200
comma
l_string|&quot;Mystique G200 (AGP)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G200_AGP
comma
l_int|0xFF
comma
id|PCI_SS_VENDOR_ID_MATROX
comma
id|PCI_SS_ID_MATROX_MILLENIUM_G200_AGP
comma
id|DEVF_G200
comma
l_int|250000
comma
op_amp
id|vbG200
comma
l_string|&quot;Millennium G200 (AGP)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G200_AGP
comma
l_int|0xFF
comma
id|PCI_SS_VENDOR_ID_MATROX
comma
id|PCI_SS_ID_MATROX_MARVEL_G200_AGP
comma
id|DEVF_G200
comma
l_int|230000
comma
op_amp
id|vbG200
comma
l_string|&quot;Marvel G200 (AGP)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G200_AGP
comma
l_int|0xFF
comma
id|PCI_SS_VENDOR_ID_SIEMENS_NIXDORF
comma
id|PCI_SS_ID_SIEMENS_MGA_G200_AGP
comma
id|DEVF_G200
comma
l_int|230000
comma
op_amp
id|vbG200
comma
l_string|&quot;MGA-G200 (AGP)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G200_AGP
comma
l_int|0xFF
comma
l_int|0
comma
l_int|0
comma
id|DEVF_G200
comma
l_int|230000
comma
op_amp
id|vbG200
comma
l_string|&quot;unknown G200 (AGP)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G400_AGP
comma
l_int|0x80
comma
id|PCI_SS_VENDOR_ID_MATROX
comma
id|PCI_SS_ID_MATROX_MILLENNIUM_G400_MAX_AGP
comma
id|DEVF_G400
comma
l_int|360000
comma
op_amp
id|vbG400
comma
l_string|&quot;Millennium G400 MAX (AGP)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G400_AGP
comma
l_int|0x80
comma
l_int|0
comma
l_int|0
comma
id|DEVF_G400
comma
l_int|300000
comma
op_amp
id|vbG400
comma
l_string|&quot;unknown G400 (AGP)&quot;
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G400_AGP
comma
l_int|0xFF
comma
l_int|0
comma
l_int|0
comma
id|DEVF_G450
comma
l_int|500000
comma
multiline_comment|/* ??? vco goes up to 900MHz... */
op_amp
id|vbG400
comma
l_string|&quot;unknown G450 (AGP)&quot;
)brace
comma
macro_line|#endif
(brace
l_int|0
comma
l_int|0
comma
l_int|0xFF
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|NULL
comma
l_int|NULL
)brace
)brace
suffix:semicolon
macro_line|#ifndef MODULE
DECL|variable|defaultmode
r_static
r_struct
id|fb_videomode
id|defaultmode
op_assign
(brace
multiline_comment|/* 640x480 @ 60Hz, 31.5 kHz */
l_int|NULL
comma
l_int|60
comma
l_int|640
comma
l_int|480
comma
l_int|39721
comma
l_int|40
comma
l_int|24
comma
l_int|32
comma
l_int|11
comma
l_int|96
comma
l_int|2
comma
l_int|0
comma
id|FB_VMODE_NONINTERLACED
)brace
suffix:semicolon
macro_line|#endif /* !MODULE */
DECL|variable|hotplug
r_static
r_int
id|hotplug
op_assign
l_int|0
suffix:semicolon
DECL|function|initMatrox2
r_static
r_int
(def_block
id|initMatrox2
c_func
(paren
id|WPMINFO
r_struct
id|display
op_star
id|d
comma
r_struct
id|board
op_star
id|b
)paren
(brace
r_int
r_int
id|ctrlptr_phys
op_assign
l_int|0
suffix:semicolon
r_int
r_int
id|video_base_phys
op_assign
l_int|0
suffix:semicolon
r_int
r_int
id|memsize
suffix:semicolon
r_struct
id|matrox_hw_state
op_star
id|hw
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|currenthw
)paren
suffix:semicolon
r_int
id|err
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;initMatrox2&quot;
)paren
multiline_comment|/* set default values... */
id|vesafb_defined.accel_flags
op_assign
id|FB_ACCELF_TEXT
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|hw_switch
)paren
op_assign
id|b-&gt;base-&gt;lowlevel
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.accelerator
)paren
op_assign
id|b-&gt;base-&gt;accelID
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|max_pixel_clock
)paren
op_assign
id|b-&gt;maxclk
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;matroxfb: Matrox %s detected&bslash;n&quot;
comma
id|b-&gt;name
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|capable.plnwt
)paren
op_assign
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.video64bits
)paren
op_assign
id|b-&gt;flags
op_amp
id|DEVF_VIDEO64BIT
suffix:semicolon
r_if
c_cond
(paren
id|b-&gt;flags
op_amp
id|DEVF_TEXT4B
)paren
(brace
id|ACCESS_FBINFO
c_func
(paren
id|devflags.vgastep
)paren
op_assign
l_int|4
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textmode
)paren
op_assign
l_int|4
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.text_type_aux
)paren
op_assign
id|FB_AUX_TEXT_MGA_STEP16
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|b-&gt;flags
op_amp
id|DEVF_TEXT16B
)paren
(brace
id|ACCESS_FBINFO
c_func
(paren
id|devflags.vgastep
)paren
op_assign
l_int|16
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textmode
)paren
op_assign
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.text_type_aux
)paren
op_assign
id|FB_AUX_TEXT_MGA_STEP16
suffix:semicolon
)brace
r_else
(brace
id|ACCESS_FBINFO
c_func
(paren
id|devflags.vgastep
)paren
op_assign
l_int|8
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textmode
)paren
op_assign
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.text_type_aux
)paren
op_assign
id|FB_AUX_TEXT_MGA_STEP8
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_FB_MATROX_32MB
id|ACCESS_FBINFO
c_func
(paren
id|devflags.support32MB
)paren
op_assign
id|b-&gt;flags
op_amp
id|DEVF_SUPPORT32MB
suffix:semicolon
macro_line|#endif
id|ACCESS_FBINFO
c_func
(paren
id|devflags.precise_width
)paren
op_assign
op_logical_neg
(paren
id|b-&gt;flags
op_amp
id|DEVF_ANY_VXRES
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.crtc2
)paren
op_assign
id|b-&gt;flags
op_amp
id|DEVF_CRTC2
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.maven_capable
)paren
op_assign
id|b-&gt;flags
op_amp
id|DEVF_MAVEN_CAPABLE
suffix:semicolon
r_if
c_cond
(paren
id|b-&gt;flags
op_amp
id|DEVF_PANELLINK_CAPABLE
)paren
(brace
id|ACCESS_FBINFO
c_func
(paren
id|output.all
)paren
op_or_assign
id|MATROXFB_OUTPUT_CONN_DFP
suffix:semicolon
r_if
c_cond
(paren
id|dfp
)paren
id|ACCESS_FBINFO
c_func
(paren
id|output.ph
)paren
op_or_assign
id|MATROXFB_OUTPUT_CONN_DFP
suffix:semicolon
)brace
id|ACCESS_FBINFO
c_func
(paren
id|devflags.g450dac
)paren
op_assign
id|b-&gt;flags
op_amp
id|DEVF_G450DAC
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textstep
)paren
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|devflags.vgastep
)paren
op_star
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textmode
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textvram
)paren
op_assign
l_int|65536
op_div
id|ACCESS_FBINFO
c_func
(paren
id|devflags.textmode
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|capable.cross4MB
)paren
OL
l_int|0
)paren
id|ACCESS_FBINFO
c_func
(paren
id|capable.cross4MB
)paren
op_assign
id|b-&gt;flags
op_amp
id|DEVF_CROSS4MB
suffix:semicolon
r_if
c_cond
(paren
id|b-&gt;flags
op_amp
id|DEVF_SWAPS
)paren
(brace
id|ctrlptr_phys
op_assign
id|pci_resource_start
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
l_int|1
)paren
suffix:semicolon
id|video_base_phys
op_assign
id|pci_resource_start
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
l_int|0
)paren
suffix:semicolon
)brace
r_else
(brace
id|ctrlptr_phys
op_assign
id|pci_resource_start
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
l_int|0
)paren
suffix:semicolon
id|video_base_phys
op_assign
id|pci_resource_start
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
l_int|1
)paren
suffix:semicolon
)brace
id|err
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ctrlptr_phys
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: control registers are not available, matroxfb disabled&bslash;n&quot;
)paren
suffix:semicolon
r_goto
id|fail
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|video_base_phys
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: video RAM is not available in PCI address space, matroxfb disabled&bslash;n&quot;
)paren
suffix:semicolon
r_goto
id|fail
suffix:semicolon
)brace
id|memsize
op_assign
id|b-&gt;base-&gt;maxvram
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|request_mem_region
c_func
(paren
id|ctrlptr_phys
comma
l_int|16384
comma
l_string|&quot;matroxfb MMIO&quot;
)paren
)paren
(brace
r_goto
id|fail
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|request_mem_region
c_func
(paren
id|video_base_phys
comma
id|memsize
comma
l_string|&quot;matroxfb FB&quot;
)paren
)paren
(brace
r_goto
id|failCtrlMR
suffix:semicolon
)brace
id|ACCESS_FBINFO
c_func
(paren
id|video.len_maximum
)paren
op_assign
id|memsize
suffix:semicolon
multiline_comment|/* convert mem (autodetect k, M) */
r_if
c_cond
(paren
id|mem
OL
l_int|1024
)paren
id|mem
op_mul_assign
l_int|1024
suffix:semicolon
r_if
c_cond
(paren
id|mem
OL
l_int|0x00100000
)paren
id|mem
op_mul_assign
l_int|1024
suffix:semicolon
r_if
c_cond
(paren
id|mem
op_logical_and
(paren
id|mem
OL
id|memsize
)paren
)paren
id|memsize
op_assign
id|mem
suffix:semicolon
id|err
op_assign
op_minus
id|ENOMEM
suffix:semicolon
r_if
c_cond
(paren
id|mga_ioremap
c_func
(paren
id|ctrlptr_phys
comma
l_int|16384
comma
id|MGA_IOREMAP_MMIO
comma
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|mmio.vbase
)paren
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: cannot ioremap(%lX, 16384), matroxfb disabled&bslash;n&quot;
comma
id|ctrlptr_phys
)paren
suffix:semicolon
r_goto
id|failVideoMR
suffix:semicolon
)brace
id|ACCESS_FBINFO
c_func
(paren
id|mmio.base
)paren
op_assign
id|ctrlptr_phys
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|mmio.len
)paren
op_assign
l_int|16384
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|video.base
)paren
op_assign
id|video_base_phys
suffix:semicolon
r_if
c_cond
(paren
id|mga_ioremap
c_func
(paren
id|video_base_phys
comma
id|memsize
comma
id|MGA_IOREMAP_FB
comma
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: cannot ioremap(%lX, %d), matroxfb disabled&bslash;n&quot;
comma
id|video_base_phys
comma
id|memsize
)paren
suffix:semicolon
r_goto
id|failCtrlIO
suffix:semicolon
)brace
(brace
id|u_int32_t
id|cmd
suffix:semicolon
id|u_int32_t
id|mga_option
suffix:semicolon
id|pci_read_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_OPTION_REG
comma
op_amp
id|mga_option
)paren
suffix:semicolon
id|pci_read_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_COMMAND
comma
op_amp
id|cmd
)paren
suffix:semicolon
id|mga_option
op_and_assign
l_int|0x7FFFFFFF
suffix:semicolon
multiline_comment|/* clear BIG_ENDIAN */
id|mga_option
op_or_assign
id|MX_OPTION_BSWAP
suffix:semicolon
multiline_comment|/* disable palette snooping */
id|cmd
op_and_assign
op_complement
id|PCI_COMMAND_VGA_PALETTE
suffix:semicolon
r_if
c_cond
(paren
id|pci_find_device
c_func
(paren
id|PCI_VENDOR_ID_INTEL
comma
id|PCI_DEVICE_ID_INTEL_82437
comma
l_int|NULL
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|mga_option
op_amp
l_int|0x20000000
)paren
op_logical_and
op_logical_neg
id|ACCESS_FBINFO
c_func
(paren
id|devflags.nopciretry
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;matroxfb: Disabling PCI retries due to i82437 present&bslash;n&quot;
)paren
suffix:semicolon
)brace
id|mga_option
op_or_assign
l_int|0x20000000
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.nopciretry
)paren
op_assign
l_int|1
suffix:semicolon
)brace
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_COMMAND
comma
id|cmd
)paren
suffix:semicolon
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_OPTION_REG
comma
id|mga_option
)paren
suffix:semicolon
id|hw-&gt;MXoptionReg
op_assign
id|mga_option
suffix:semicolon
multiline_comment|/* select non-DMA memory for PCI_MGA_DATA, otherwise dump of PCI cfg space can lock PCI bus */
multiline_comment|/* maybe preinit() candidate, but it is same... for all devices... at this time... */
id|pci_write_config_dword
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
comma
id|PCI_MGA_INDEX
comma
l_int|0x00003C00
)paren
suffix:semicolon
)brace
id|err
op_assign
op_minus
id|ENXIO
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|hw_switch
)paren
op_member_access_from_pointer
id|preinit
c_func
(paren
id|PMINFO
id|hw
)paren
)paren
(brace
r_goto
id|failVideoIO
suffix:semicolon
)brace
id|err
op_assign
op_minus
id|ENOMEM
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|matroxfb_getmemory
c_func
(paren
id|PMINFO
id|memsize
comma
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|video.len
)paren
)paren
op_logical_or
op_logical_neg
id|ACCESS_FBINFO
c_func
(paren
id|video.len
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: cannot determine memory size&bslash;n&quot;
)paren
suffix:semicolon
r_goto
id|failVideoIO
suffix:semicolon
)brace
id|ACCESS_FBINFO
c_func
(paren
id|devflags.ydstorg
)paren
op_assign
l_int|0
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|currcon
)paren
op_assign
op_minus
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|currcon_display
)paren
op_assign
id|d
suffix:semicolon
id|mga_iounmap
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|video.base
)paren
op_assign
id|video_base_phys
suffix:semicolon
r_if
c_cond
(paren
id|mga_ioremap
c_func
(paren
id|video_base_phys
comma
id|ACCESS_FBINFO
c_func
(paren
id|video.len
)paren
comma
id|MGA_IOREMAP_FB
comma
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: cannot ioremap(%lX, %d), matroxfb disabled&bslash;n&quot;
comma
id|video_base_phys
comma
id|ACCESS_FBINFO
c_func
(paren
id|video.len
)paren
)paren
suffix:semicolon
r_goto
id|failCtrlIO
suffix:semicolon
)brace
id|ACCESS_FBINFO
c_func
(paren
id|video.len_usable
)paren
op_assign
id|ACCESS_FBINFO
c_func
(paren
id|video.len
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.len_usable
)paren
OG
id|b-&gt;base-&gt;maxdisplayable
)paren
id|ACCESS_FBINFO
c_func
(paren
id|video.len_usable
)paren
op_assign
id|b-&gt;base-&gt;maxdisplayable
suffix:semicolon
macro_line|#ifdef CONFIG_MTRR
r_if
c_cond
(paren
id|mtrr
)paren
(brace
id|ACCESS_FBINFO
c_func
(paren
id|mtrr.vram
)paren
op_assign
id|mtrr_add
c_func
(paren
id|video_base_phys
comma
id|ACCESS_FBINFO
c_func
(paren
id|video.len
)paren
comma
id|MTRR_TYPE_WRCOMB
comma
l_int|1
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|mtrr.vram_valid
)paren
op_assign
l_int|1
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;matroxfb: MTRR&squot;s turned on&bslash;n&quot;
)paren
suffix:semicolon
)brace
macro_line|#endif&t;/* CONFIG_MTRR */
r_if
c_cond
(paren
op_logical_neg
id|ACCESS_FBINFO
c_func
(paren
id|devflags.novga
)paren
)paren
id|request_region
c_func
(paren
l_int|0x3C0
comma
l_int|32
comma
l_string|&quot;matrox&quot;
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|hw_switch
op_member_access_from_pointer
id|reset
c_func
(paren
id|PMINFO
id|hw
)paren
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.monspecs.hfmin
)paren
op_assign
l_int|0
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.monspecs.hfmax
)paren
op_assign
id|fh
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.monspecs.vfmin
)paren
op_assign
l_int|0
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.monspecs.vfmax
)paren
op_assign
id|fv
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.monspecs.dpms
)paren
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* TBD */
multiline_comment|/* static settings */
r_if
c_cond
(paren
(paren
id|depth
op_eq
id|RSText8
)paren
op_logical_and
(paren
op_logical_neg
op_star
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.fontname
)paren
)paren
)paren
(brace
id|strcpy
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.fontname
)paren
comma
l_string|&quot;VGA8x8&quot;
)paren
suffix:semicolon
)brace
id|vesafb_defined.red
op_assign
id|colors
(braket
id|depth
op_minus
l_int|1
)braket
dot
id|red
suffix:semicolon
id|vesafb_defined.green
op_assign
id|colors
(braket
id|depth
op_minus
l_int|1
)braket
dot
id|green
suffix:semicolon
id|vesafb_defined.blue
op_assign
id|colors
(braket
id|depth
op_minus
l_int|1
)braket
dot
id|blue
suffix:semicolon
id|vesafb_defined.bits_per_pixel
op_assign
id|colors
(braket
id|depth
op_minus
l_int|1
)braket
dot
id|bits_per_pixel
suffix:semicolon
id|vesafb_defined.grayscale
op_assign
id|grayscale
suffix:semicolon
id|vesafb_defined.vmode
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|noaccel
)paren
id|vesafb_defined.accel_flags
op_and_assign
op_complement
id|FB_ACCELF_TEXT
suffix:semicolon
id|strcpy
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.modename
)paren
comma
l_string|&quot;MATROX VGA&quot;
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.changevar
)paren
op_assign
l_int|NULL
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.node
)paren
op_assign
op_minus
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.fbops
)paren
op_assign
op_amp
id|matroxfb_ops
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.disp
)paren
op_assign
id|d
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.switch_con
)paren
op_assign
op_amp
id|matroxfb_switch
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.updatevar
)paren
op_assign
op_amp
id|matroxfb_updatevar
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.blank
)paren
op_assign
op_amp
id|matroxfb_blank
suffix:semicolon
multiline_comment|/* after __init time we are like module... no logo */
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.flags
)paren
op_assign
id|hotplug
ques
c_cond
id|FBINFO_FLAG_MODULE
suffix:colon
id|FBINFO_FLAG_DEFAULT
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|video.len_usable
)paren
op_and_assign
id|PAGE_MASK
suffix:semicolon
macro_line|#ifndef MODULE
multiline_comment|/* mode database is marked __init!!! */
r_if
c_cond
(paren
op_logical_neg
id|hotplug
)paren
(brace
id|fb_find_mode
c_func
(paren
op_amp
id|vesafb_defined
comma
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
comma
id|videomode
(braket
l_int|0
)braket
ques
c_cond
id|videomode
suffix:colon
l_int|NULL
comma
l_int|NULL
comma
l_int|0
comma
op_amp
id|defaultmode
comma
id|vesafb_defined.bits_per_pixel
)paren
suffix:semicolon
)brace
macro_line|#endif /* !MODULE */
multiline_comment|/* mode modifiers */
r_if
c_cond
(paren
id|hslen
)paren
id|vesafb_defined.hsync_len
op_assign
id|hslen
suffix:semicolon
r_if
c_cond
(paren
id|vslen
)paren
id|vesafb_defined.vsync_len
op_assign
id|vslen
suffix:semicolon
r_if
c_cond
(paren
id|left
op_ne
op_complement
l_int|0
)paren
id|vesafb_defined.left_margin
op_assign
id|left
suffix:semicolon
r_if
c_cond
(paren
id|right
op_ne
op_complement
l_int|0
)paren
id|vesafb_defined.right_margin
op_assign
id|right
suffix:semicolon
r_if
c_cond
(paren
id|upper
op_ne
op_complement
l_int|0
)paren
id|vesafb_defined.upper_margin
op_assign
id|upper
suffix:semicolon
r_if
c_cond
(paren
id|lower
op_ne
op_complement
l_int|0
)paren
id|vesafb_defined.lower_margin
op_assign
id|lower
suffix:semicolon
r_if
c_cond
(paren
id|xres
)paren
id|vesafb_defined.xres
op_assign
id|xres
suffix:semicolon
r_if
c_cond
(paren
id|yres
)paren
id|vesafb_defined.yres
op_assign
id|yres
suffix:semicolon
r_if
c_cond
(paren
id|sync
op_ne
op_minus
l_int|1
)paren
id|vesafb_defined.sync
op_assign
id|sync
suffix:semicolon
r_else
r_if
c_cond
(paren
id|vesafb_defined.sync
op_eq
op_complement
l_int|0
)paren
(brace
id|vesafb_defined.sync
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|yres
OL
l_int|400
)paren
id|vesafb_defined.sync
op_or_assign
id|FB_SYNC_HOR_HIGH_ACT
suffix:semicolon
r_else
r_if
c_cond
(paren
id|yres
OL
l_int|480
)paren
id|vesafb_defined.sync
op_or_assign
id|FB_SYNC_VERT_HIGH_ACT
suffix:semicolon
)brace
multiline_comment|/* fv, fh, maxclk limits was specified */
(brace
r_int
r_int
id|tmp
suffix:semicolon
r_if
c_cond
(paren
id|fv
)paren
(brace
id|tmp
op_assign
id|fv
op_star
(paren
id|vesafb_defined.upper_margin
op_plus
id|vesafb_defined.yres
op_plus
id|vesafb_defined.lower_margin
op_plus
id|vesafb_defined.vsync_len
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|tmp
OL
id|fh
)paren
op_logical_or
(paren
id|fh
op_eq
l_int|0
)paren
)paren
id|fh
op_assign
id|tmp
suffix:semicolon
)brace
r_if
c_cond
(paren
id|fh
)paren
(brace
id|tmp
op_assign
id|fh
op_star
(paren
id|vesafb_defined.left_margin
op_plus
id|vesafb_defined.xres
op_plus
id|vesafb_defined.right_margin
op_plus
id|vesafb_defined.hsync_len
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|tmp
OL
id|maxclk
)paren
op_logical_or
(paren
id|maxclk
op_eq
l_int|0
)paren
)paren
id|maxclk
op_assign
id|tmp
suffix:semicolon
)brace
id|maxclk
op_assign
(paren
id|maxclk
op_plus
l_int|499
)paren
op_div
l_int|500
suffix:semicolon
r_if
c_cond
(paren
id|maxclk
)paren
(brace
id|tmp
op_assign
(paren
l_int|2000000000
op_plus
id|maxclk
)paren
op_div
id|maxclk
suffix:semicolon
r_if
c_cond
(paren
id|tmp
OG
id|pixclock
)paren
id|pixclock
op_assign
id|tmp
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|pixclock
)paren
(brace
r_if
c_cond
(paren
id|pixclock
OL
l_int|2000
)paren
multiline_comment|/* &gt; 500MHz */
id|pixclock
op_assign
l_int|4000
suffix:semicolon
multiline_comment|/* 250MHz */
r_if
c_cond
(paren
id|pixclock
OG
l_int|1000000
)paren
id|pixclock
op_assign
l_int|1000000
suffix:semicolon
multiline_comment|/* 1MHz */
id|vesafb_defined.pixclock
op_assign
id|pixclock
suffix:semicolon
)brace
multiline_comment|/* FIXME: Where to move this?! */
macro_line|#if defined(CONFIG_PPC)
macro_line|#if defined(CONFIG_FB_COMPAT_XPMAC)
id|strcpy
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|matrox_name
)paren
comma
l_string|&quot;MTRX,&quot;
)paren
suffix:semicolon
multiline_comment|/* OpenFirmware naming convension */
id|strncat
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|matrox_name
)paren
comma
id|b-&gt;name
comma
l_int|26
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|console_fb_info
)paren
id|console_fb_info
op_assign
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
(paren
id|xres
op_le
l_int|640
)paren
op_logical_and
(paren
id|yres
op_le
l_int|480
)paren
)paren
(brace
r_struct
id|fb_var_screeninfo
id|var
suffix:semicolon
r_if
c_cond
(paren
id|default_vmode
op_eq
id|VMODE_NVRAM
)paren
(brace
id|default_vmode
op_assign
id|nvram_read_byte
c_func
(paren
id|NV_VMODE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|default_vmode
op_le
l_int|0
op_logical_or
id|default_vmode
OG
id|VMODE_MAX
)paren
id|default_vmode
op_assign
id|VMODE_CHOOSE
suffix:semicolon
)brace
r_if
c_cond
(paren
id|default_vmode
op_le
l_int|0
op_logical_or
id|default_vmode
OG
id|VMODE_MAX
)paren
id|default_vmode
op_assign
id|VMODE_640_480_60
suffix:semicolon
r_if
c_cond
(paren
id|default_cmode
op_eq
id|CMODE_NVRAM
)paren
id|default_cmode
op_assign
id|nvram_read_byte
c_func
(paren
id|NV_CMODE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|default_cmode
template_param
id|CMODE_32
)paren
id|default_cmode
op_assign
id|CMODE_8
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|mac_vmode_to_var
c_func
(paren
id|default_vmode
comma
id|default_cmode
comma
op_amp
id|var
)paren
)paren
(brace
id|var.accel_flags
op_assign
id|vesafb_defined.accel_flags
suffix:semicolon
id|var.xoffset
op_assign
id|var.yoffset
op_assign
l_int|0
suffix:semicolon
id|vesafb_defined
op_assign
id|var
suffix:semicolon
multiline_comment|/* Note: mac_vmode_to_var() doesnot set all parameters */
)brace
)brace
macro_line|#endif /* CONFIG_PPC */
id|vesafb_defined.xres_virtual
op_assign
id|vesafb_defined.xres
suffix:semicolon
r_if
c_cond
(paren
id|nopan
)paren
(brace
id|vesafb_defined.yres_virtual
op_assign
id|vesafb_defined.yres
suffix:semicolon
)brace
r_else
(brace
id|vesafb_defined.yres_virtual
op_assign
l_int|65536
suffix:semicolon
multiline_comment|/* large enough to be INF, but small enough&n;&t;&t;&t;&t;&t;&t;&t;to yres_virtual * xres_virtual &lt; 2^32 */
)brace
id|err
op_assign
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|matroxfb_set_var
c_func
(paren
op_amp
id|vesafb_defined
comma
op_minus
l_int|2
comma
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: cannot set required parameters&bslash;n&quot;
)paren
suffix:semicolon
r_goto
id|failVideoIO
suffix:semicolon
)brace
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;matroxfb: %dx%dx%dbpp (virtual: %dx%d)&bslash;n&quot;
comma
id|vesafb_defined.xres
comma
id|vesafb_defined.yres
comma
id|vesafb_defined.bits_per_pixel
comma
id|vesafb_defined.xres_virtual
comma
id|vesafb_defined.yres_virtual
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;matroxfb: framebuffer at 0x%lX, mapped to 0x%p, size %d&bslash;n&quot;
comma
id|ACCESS_FBINFO
c_func
(paren
id|video.base
)paren
comma
id|vaddr_va
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
)paren
comma
id|ACCESS_FBINFO
c_func
(paren
id|video.len
)paren
)paren
suffix:semicolon
multiline_comment|/* We do not have to set currcon to 0... register_framebuffer do it for us on first console&n; * and we do not want currcon == 0 for subsequent framebuffers */
r_if
c_cond
(paren
id|register_framebuffer
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
)paren
OL
l_int|0
)paren
(brace
r_goto
id|failVideoIO
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;fb%d: %s frame buffer device&bslash;n&quot;
comma
id|GET_FB_IDX
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.node
)paren
)paren
comma
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.modename
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ACCESS_FBINFO
c_func
(paren
id|currcon
)paren
OL
l_int|0
)paren
(brace
multiline_comment|/* there is no console on this fb... but we have to initialize hardware&n;&t;&t; * until someone tells me what is proper thing to do */
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;fb%d: initializing hardware&bslash;n&quot;
comma
id|GET_FB_IDX
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.node
)paren
)paren
)paren
suffix:semicolon
id|matroxfb_set_var
c_func
(paren
op_amp
id|vesafb_defined
comma
op_minus
l_int|1
comma
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|fbcon
)paren
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
id|failVideoIO
suffix:colon
suffix:semicolon
id|mga_iounmap
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|video.vbase
)paren
)paren
suffix:semicolon
id|failCtrlIO
suffix:colon
suffix:semicolon
id|mga_iounmap
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|mmio.vbase
)paren
)paren
suffix:semicolon
id|failVideoMR
suffix:colon
suffix:semicolon
id|release_mem_region
c_func
(paren
id|video_base_phys
comma
id|ACCESS_FBINFO
c_func
(paren
id|video.len_maximum
)paren
)paren
suffix:semicolon
id|failCtrlMR
suffix:colon
suffix:semicolon
id|release_mem_region
c_func
(paren
id|ctrlptr_phys
comma
l_int|16384
)paren
suffix:semicolon
id|fail
suffix:colon
suffix:semicolon
r_return
id|err
suffix:semicolon
)brace
)def_block
DECL|variable|matroxfb_list
id|LIST_HEAD
c_func
(paren
id|matroxfb_list
)paren
suffix:semicolon
DECL|variable|matroxfb_driver_list
id|LIST_HEAD
c_func
(paren
id|matroxfb_driver_list
)paren
suffix:semicolon
DECL|macro|matroxfb_l
mdefine_line|#define matroxfb_l(x) list_entry(x, struct matrox_fb_info, next_fb)
DECL|macro|matroxfb_driver_l
mdefine_line|#define matroxfb_driver_l(x) list_entry(x, struct matroxfb_driver, node)
DECL|function|matroxfb_register_driver
r_int
id|matroxfb_register_driver
c_func
(paren
r_struct
id|matroxfb_driver
op_star
id|drv
)paren
(brace
r_struct
id|matrox_fb_info
op_star
id|minfo
suffix:semicolon
id|list_add
c_func
(paren
op_amp
id|drv-&gt;node
comma
op_amp
id|matroxfb_driver_list
)paren
suffix:semicolon
r_for
c_loop
(paren
id|minfo
op_assign
id|matroxfb_l
c_func
(paren
id|matroxfb_list.next
)paren
suffix:semicolon
id|minfo
op_ne
id|matroxfb_l
c_func
(paren
op_amp
id|matroxfb_list
)paren
suffix:semicolon
id|minfo
op_assign
id|matroxfb_l
c_func
(paren
id|minfo-&gt;next_fb.next
)paren
)paren
(brace
r_void
op_star
id|p
suffix:semicolon
r_if
c_cond
(paren
id|minfo-&gt;drivers_count
op_eq
id|MATROXFB_MAX_FB_DRIVERS
)paren
r_continue
suffix:semicolon
id|p
op_assign
id|drv
op_member_access_from_pointer
id|probe
c_func
(paren
id|minfo
)paren
suffix:semicolon
r_if
c_cond
(paren
id|p
)paren
(brace
id|minfo-&gt;drivers_data
(braket
id|minfo-&gt;drivers_count
)braket
op_assign
id|p
suffix:semicolon
id|minfo-&gt;drivers
(braket
id|minfo-&gt;drivers_count
op_increment
)braket
op_assign
id|drv
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|matroxfb_unregister_driver
r_void
id|matroxfb_unregister_driver
c_func
(paren
r_struct
id|matroxfb_driver
op_star
id|drv
)paren
(brace
r_struct
id|matrox_fb_info
op_star
id|minfo
suffix:semicolon
id|list_del
c_func
(paren
op_amp
id|drv-&gt;node
)paren
suffix:semicolon
r_for
c_loop
(paren
id|minfo
op_assign
id|matroxfb_l
c_func
(paren
id|matroxfb_list.next
)paren
suffix:semicolon
id|minfo
op_ne
id|matroxfb_l
c_func
(paren
op_amp
id|matroxfb_list
)paren
suffix:semicolon
id|minfo
op_assign
id|matroxfb_l
c_func
(paren
id|minfo-&gt;next_fb.next
)paren
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|minfo-&gt;drivers_count
suffix:semicolon
)paren
(brace
r_if
c_cond
(paren
id|minfo-&gt;drivers
(braket
id|i
)braket
op_eq
id|drv
)paren
(brace
r_if
c_cond
(paren
id|drv
op_logical_and
id|drv-&gt;remove
)paren
id|drv
op_member_access_from_pointer
id|remove
c_func
(paren
id|minfo
comma
id|minfo-&gt;drivers_data
(braket
id|i
)braket
)paren
suffix:semicolon
id|minfo-&gt;drivers
(braket
id|i
)braket
op_assign
id|minfo-&gt;drivers
(braket
op_decrement
id|minfo-&gt;drivers_count
)braket
suffix:semicolon
id|minfo-&gt;drivers_data
(braket
id|i
)braket
op_assign
id|minfo-&gt;drivers_data
(braket
id|minfo-&gt;drivers_count
)braket
suffix:semicolon
)brace
r_else
id|i
op_increment
suffix:semicolon
)brace
)brace
)brace
DECL|function|matroxfb_register_device
r_static
r_void
id|matroxfb_register_device
c_func
(paren
r_struct
id|matrox_fb_info
op_star
id|minfo
)paren
(brace
r_struct
id|matroxfb_driver
op_star
id|drv
suffix:semicolon
r_int
id|i
op_assign
l_int|0
suffix:semicolon
id|list_add
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|next_fb
)paren
comma
op_amp
id|matroxfb_list
)paren
suffix:semicolon
r_for
c_loop
(paren
id|drv
op_assign
id|matroxfb_driver_l
c_func
(paren
id|matroxfb_driver_list.next
)paren
suffix:semicolon
id|drv
op_ne
id|matroxfb_driver_l
c_func
(paren
op_amp
id|matroxfb_driver_list
)paren
suffix:semicolon
id|drv
op_assign
id|matroxfb_driver_l
c_func
(paren
id|drv-&gt;node.next
)paren
)paren
(brace
r_if
c_cond
(paren
id|drv
op_logical_and
id|drv-&gt;probe
)paren
(brace
r_void
op_star
id|p
op_assign
id|drv
op_member_access_from_pointer
id|probe
c_func
(paren
id|minfo
)paren
suffix:semicolon
r_if
c_cond
(paren
id|p
)paren
(brace
id|minfo-&gt;drivers_data
(braket
id|i
)braket
op_assign
id|p
suffix:semicolon
id|minfo-&gt;drivers
(braket
id|i
op_increment
)braket
op_assign
id|drv
suffix:semicolon
r_if
c_cond
(paren
id|i
op_eq
id|MATROXFB_MAX_FB_DRIVERS
)paren
r_break
suffix:semicolon
)brace
)brace
)brace
id|minfo-&gt;drivers_count
op_assign
id|i
suffix:semicolon
)brace
DECL|function|matroxfb_unregister_device
r_static
r_void
id|matroxfb_unregister_device
c_func
(paren
r_struct
id|matrox_fb_info
op_star
id|minfo
)paren
(brace
r_int
id|i
suffix:semicolon
id|list_del
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|next_fb
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|minfo-&gt;drivers_count
suffix:semicolon
id|i
op_increment
)paren
(brace
r_struct
id|matroxfb_driver
op_star
id|drv
op_assign
id|minfo-&gt;drivers
(braket
id|i
)braket
suffix:semicolon
r_if
c_cond
(paren
id|drv
op_logical_and
id|drv-&gt;remove
)paren
id|drv
op_member_access_from_pointer
id|remove
c_func
(paren
id|minfo
comma
id|minfo-&gt;drivers_data
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
)brace
DECL|function|matroxfb_probe
r_static
r_int
id|matroxfb_probe
c_func
(paren
r_struct
id|pci_dev
op_star
id|pdev
comma
r_const
r_struct
id|pci_device_id
op_star
id|dummy
)paren
(brace
r_struct
id|board
op_star
id|b
suffix:semicolon
id|u_int8_t
id|rev
suffix:semicolon
id|u_int16_t
id|svid
suffix:semicolon
id|u_int16_t
id|sid
suffix:semicolon
r_struct
id|matrox_fb_info
op_star
id|minfo
suffix:semicolon
r_struct
id|display
op_star
id|d
suffix:semicolon
r_int
id|err
suffix:semicolon
id|u_int32_t
id|cmd
suffix:semicolon
macro_line|#ifndef CONFIG_FB_MATROX_MULTIHEAD
r_static
r_int
id|registered
op_assign
l_int|0
suffix:semicolon
macro_line|#endif
id|DBG
c_func
(paren
l_string|&quot;matroxfb_probe&quot;
)paren
id|pci_read_config_byte
c_func
(paren
id|pdev
comma
id|PCI_REVISION_ID
comma
op_amp
id|rev
)paren
suffix:semicolon
id|svid
op_assign
id|pdev-&gt;subsystem_vendor
suffix:semicolon
id|sid
op_assign
id|pdev-&gt;subsystem_device
suffix:semicolon
r_for
c_loop
(paren
id|b
op_assign
id|dev_list
suffix:semicolon
id|b-&gt;vendor
suffix:semicolon
id|b
op_increment
)paren
(brace
r_if
c_cond
(paren
(paren
id|b-&gt;vendor
op_ne
id|pdev-&gt;vendor
)paren
op_logical_or
(paren
id|b-&gt;device
op_ne
id|pdev-&gt;device
)paren
op_logical_or
(paren
id|b-&gt;rev
OL
id|rev
)paren
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|b-&gt;svid
)paren
r_if
c_cond
(paren
(paren
id|b-&gt;svid
op_ne
id|svid
)paren
op_logical_or
(paren
id|b-&gt;sid
op_ne
id|sid
)paren
)paren
r_continue
suffix:semicolon
r_break
suffix:semicolon
)brace
multiline_comment|/* not match... */
r_if
c_cond
(paren
op_logical_neg
id|b-&gt;vendor
)paren
r_return
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|dev
OG
l_int|0
)paren
(brace
multiline_comment|/* not requested one... */
id|dev
op_decrement
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
id|pci_read_config_dword
c_func
(paren
id|pdev
comma
id|PCI_COMMAND
comma
op_amp
id|cmd
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pci_enable_device
c_func
(paren
id|pdev
)paren
)paren
(brace
r_return
op_minus
l_int|1
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_FB_MATROX_MULTIHEAD
id|minfo
op_assign
(paren
r_struct
id|matrox_fb_info
op_star
)paren
id|kmalloc
c_func
(paren
r_sizeof
(paren
op_star
id|minfo
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|minfo
)paren
r_return
op_minus
l_int|1
suffix:semicolon
id|d
op_assign
(paren
r_struct
id|display
op_star
)paren
id|kmalloc
c_func
(paren
r_sizeof
(paren
op_star
id|d
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|d
)paren
(brace
id|kfree
c_func
(paren
id|minfo
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
macro_line|#else
r_if
c_cond
(paren
id|registered
)paren
multiline_comment|/* singlehead driver... */
r_return
op_minus
l_int|1
suffix:semicolon
id|minfo
op_assign
op_amp
id|matroxfb_global_mxinfo
suffix:semicolon
id|d
op_assign
op_amp
id|global_disp
suffix:semicolon
macro_line|#endif
id|memset
c_func
(paren
id|MINFO
comma
l_int|0
comma
r_sizeof
(paren
op_star
id|MINFO
)paren
)paren
suffix:semicolon
id|memset
c_func
(paren
id|d
comma
l_int|0
comma
r_sizeof
(paren
op_star
id|d
)paren
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|currenthw
)paren
op_assign
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|hw1
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|newhw
)paren
op_assign
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|hw2
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|pcidev
)paren
op_assign
id|pdev
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|dead
)paren
op_assign
l_int|0
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|usecount
)paren
op_assign
l_int|0
suffix:semicolon
id|pdev-&gt;driver_data
op_assign
id|MINFO
suffix:semicolon
multiline_comment|/* CMDLINE */
id|memcpy
c_func
(paren
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.fontname
)paren
comma
id|fontname
comma
r_sizeof
(paren
id|ACCESS_FBINFO
c_func
(paren
id|fbcon.fontname
)paren
)paren
)paren
suffix:semicolon
multiline_comment|/* DEVFLAGS */
id|ACCESS_FBINFO
c_func
(paren
id|devflags.inverse
)paren
op_assign
id|inverse
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.memtype
)paren
op_assign
id|memtype
suffix:semicolon
r_if
c_cond
(paren
id|memtype
op_ne
op_minus
l_int|1
)paren
id|noinit
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|cmd
op_amp
id|PCI_COMMAND_MEMORY
)paren
(brace
id|ACCESS_FBINFO
c_func
(paren
id|devflags.novga
)paren
op_assign
id|novga
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.nobios
)paren
op_assign
id|nobios
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.noinit
)paren
op_assign
id|noinit
suffix:semicolon
multiline_comment|/* subsequent heads always needs initialization and must not enable BIOS */
id|novga
op_assign
l_int|1
suffix:semicolon
id|nobios
op_assign
l_int|1
suffix:semicolon
id|noinit
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|ACCESS_FBINFO
c_func
(paren
id|devflags.novga
)paren
op_assign
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.nobios
)paren
op_assign
l_int|1
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.noinit
)paren
op_assign
l_int|0
suffix:semicolon
)brace
id|ACCESS_FBINFO
c_func
(paren
id|devflags.nopciretry
)paren
op_assign
id|no_pci_retry
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.mga_24bpp_fix
)paren
op_assign
id|inv24
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.precise_width
)paren
op_assign
id|option_precise_width
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.hwcursor
)paren
op_assign
id|hwcursor
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.blink
)paren
op_assign
id|blink
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|devflags.sgram
)paren
op_assign
id|sgram
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|capable.cross4MB
)paren
op_assign
id|cross4MB
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|fastfont.size
)paren
op_assign
id|fastfont
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|cursor.state
)paren
op_assign
id|CM_ERASE
suffix:semicolon
id|init_timer
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|cursor.timer
)paren
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|cursor.timer.data
)paren
op_assign
(paren
r_int
r_int
)paren
id|MINFO
suffix:semicolon
id|spin_lock_init
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|lock.DAC
)paren
)paren
suffix:semicolon
id|spin_lock_init
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|lock.accel
)paren
)paren
suffix:semicolon
id|init_rwsem
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|crtc2.lock
)paren
)paren
suffix:semicolon
id|init_rwsem
c_func
(paren
op_amp
id|ACCESS_FBINFO
c_func
(paren
id|altout.lock
)paren
)paren
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|output.all
)paren
op_assign
id|MATROXFB_OUTPUT_CONN_PRIMARY
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|output.ph
)paren
op_assign
id|MATROXFB_OUTPUT_CONN_PRIMARY
suffix:semicolon
id|ACCESS_FBINFO
c_func
(paren
id|output.sh
)paren
op_assign
l_int|0
suffix:semicolon
id|err
op_assign
id|initMatrox2
c_func
(paren
id|PMINFO
id|d
comma
id|b
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|err
)paren
(brace
macro_line|#ifndef CONFIG_FB_MATROX_MULTIHEAD
id|registered
op_assign
l_int|1
suffix:semicolon
macro_line|#endif
id|matroxfb_register_device
c_func
(paren
id|MINFO
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#ifdef CONFIG_FB_MATROX_MULTIHEAD
id|kfree
c_func
(paren
id|d
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|minfo
)paren
suffix:semicolon
macro_line|#endif
r_return
op_minus
l_int|1
suffix:semicolon
)brace
DECL|function|pci_remove_matrox
r_static
r_void
id|pci_remove_matrox
c_func
(paren
r_struct
id|pci_dev
op_star
id|pdev
)paren
(brace
r_struct
id|matrox_fb_info
op_star
id|minfo
suffix:semicolon
id|minfo
op_assign
id|pdev-&gt;driver_data
suffix:semicolon
id|matroxfb_remove
c_func
(paren
id|PMINFO
l_int|1
)paren
suffix:semicolon
)brace
DECL|variable|__devinitdata
r_static
r_struct
id|pci_device_id
id|matroxfb_devices
(braket
)braket
id|__devinitdata
op_assign
(brace
macro_line|#ifdef CONFIG_FB_MATROX_MILLENIUM
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_MIL
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_MIL_2
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_MIL_2_AGP
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_MATROX_MYSTIQUE
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_MYS
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
macro_line|#endif
macro_line|#ifdef CONFIG_FB_MATROX_G100
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G100
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G100_AGP
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G200_PCI
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G200_AGP
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
(brace
id|PCI_VENDOR_ID_MATROX
comma
id|PCI_DEVICE_ID_MATROX_G400_AGP
comma
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
comma
macro_line|#endif
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
)brace
suffix:semicolon
id|MODULE_DEVICE_TABLE
c_func
(paren
id|pci
comma
id|matroxfb_devices
)paren
suffix:semicolon
DECL|variable|matroxfb_driver
r_static
r_struct
id|pci_driver
id|matroxfb_driver
op_assign
(brace
id|name
suffix:colon
l_string|&quot;matroxfb&quot;
comma
id|id_table
suffix:colon
id|matroxfb_devices
comma
id|probe
suffix:colon
id|matroxfb_probe
comma
id|remove
suffix:colon
id|pci_remove_matrox
comma
)brace
suffix:semicolon
multiline_comment|/* **************************** init-time only **************************** */
DECL|macro|RSResolution
mdefine_line|#define RSResolution(X)&t;((X) &amp; 0x0F)
DECL|macro|RS640x400
mdefine_line|#define RS640x400&t;1
DECL|macro|RS640x480
mdefine_line|#define RS640x480&t;2
DECL|macro|RS800x600
mdefine_line|#define RS800x600&t;3
DECL|macro|RS1024x768
mdefine_line|#define RS1024x768&t;4
DECL|macro|RS1280x1024
mdefine_line|#define RS1280x1024&t;5
DECL|macro|RS1600x1200
mdefine_line|#define RS1600x1200&t;6
DECL|macro|RS768x576
mdefine_line|#define RS768x576&t;7
DECL|macro|RS960x720
mdefine_line|#define RS960x720&t;8
DECL|macro|RS1152x864
mdefine_line|#define RS1152x864&t;9
DECL|macro|RS1408x1056
mdefine_line|#define RS1408x1056&t;10
DECL|macro|RS640x350
mdefine_line|#define RS640x350&t;11
DECL|macro|RS1056x344
mdefine_line|#define RS1056x344&t;12&t;/* 132 x 43 text */
DECL|macro|RS1056x400
mdefine_line|#define RS1056x400&t;13&t;/* 132 x 50 text */
DECL|macro|RS1056x480
mdefine_line|#define RS1056x480&t;14&t;/* 132 x 60 text */
DECL|macro|RSNoxNo
mdefine_line|#define RSNoxNo&t;&t;15
multiline_comment|/* 10-FF */
DECL|member|xres
DECL|member|yres
DECL|member|left
DECL|member|right
DECL|member|upper
DECL|member|lower
DECL|member|hslen
DECL|member|vslen
DECL|member|vfreq
DECL|variable|__initdata
r_static
r_struct
(brace
r_int
id|xres
comma
id|yres
comma
id|left
comma
id|right
comma
id|upper
comma
id|lower
comma
id|hslen
comma
id|vslen
comma
id|vfreq
suffix:semicolon
)brace
id|timmings
(braket
)braket
id|__initdata
op_assign
(brace
(brace
l_int|640
comma
l_int|400
comma
l_int|48
comma
l_int|16
comma
l_int|39
comma
l_int|8
comma
l_int|96
comma
l_int|2
comma
l_int|70
)brace
comma
(brace
l_int|640
comma
l_int|480
comma
l_int|48
comma
l_int|16
comma
l_int|33
comma
l_int|10
comma
l_int|96
comma
l_int|2
comma
l_int|60
)brace
comma
(brace
l_int|800
comma
l_int|600
comma
l_int|144
comma
l_int|24
comma
l_int|28
comma
l_int|8
comma
l_int|112
comma
l_int|6
comma
l_int|60
)brace
comma
(brace
l_int|1024
comma
l_int|768
comma
l_int|160
comma
l_int|32
comma
l_int|30
comma
l_int|4
comma
l_int|128
comma
l_int|4
comma
l_int|60
)brace
comma
(brace
l_int|1280
comma
l_int|1024
comma
l_int|224
comma
l_int|32
comma
l_int|32
comma
l_int|4
comma
l_int|136
comma
l_int|4
comma
l_int|60
)brace
comma
(brace
l_int|1600
comma
l_int|1200
comma
l_int|272
comma
l_int|48
comma
l_int|32
comma
l_int|5
comma
l_int|152
comma
l_int|5
comma
l_int|60
)brace
comma
(brace
l_int|768
comma
l_int|576
comma
l_int|144
comma
l_int|16
comma
l_int|28
comma
l_int|6
comma
l_int|112
comma
l_int|4
comma
l_int|60
)brace
comma
(brace
l_int|960
comma
l_int|720
comma
l_int|144
comma
l_int|24
comma
l_int|28
comma
l_int|8
comma
l_int|112
comma
l_int|4
comma
l_int|60
)brace
comma
(brace
l_int|1152
comma
l_int|864
comma
l_int|192
comma
l_int|32
comma
l_int|30
comma
l_int|4
comma
l_int|128
comma
l_int|4
comma
l_int|60
)brace
comma
(brace
l_int|1408
comma
l_int|1056
comma
l_int|256
comma
l_int|40
comma
l_int|32
comma
l_int|5
comma
l_int|144
comma
l_int|5
comma
l_int|60
)brace
comma
(brace
l_int|640
comma
l_int|350
comma
l_int|48
comma
l_int|16
comma
l_int|39
comma
l_int|8
comma
l_int|96
comma
l_int|2
comma
l_int|70
)brace
comma
(brace
l_int|1056
comma
l_int|344
comma
l_int|96
comma
l_int|24
comma
l_int|59
comma
l_int|44
comma
l_int|160
comma
l_int|2
comma
l_int|70
)brace
comma
(brace
l_int|1056
comma
l_int|400
comma
l_int|96
comma
l_int|24
comma
l_int|39
comma
l_int|8
comma
l_int|160
comma
l_int|2
comma
l_int|70
)brace
comma
(brace
l_int|1056
comma
l_int|480
comma
l_int|96
comma
l_int|24
comma
l_int|36
comma
l_int|12
comma
l_int|160
comma
l_int|3
comma
l_int|60
)brace
comma
(brace
l_int|0
comma
l_int|0
comma
op_complement
l_int|0
comma
op_complement
l_int|0
comma
op_complement
l_int|0
comma
op_complement
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
)brace
suffix:semicolon
DECL|macro|RSCreate
mdefine_line|#define RSCreate(X,Y)&t;((X) | ((Y) &lt;&lt; 8))
DECL|member|vesa
DECL|member|info
DECL|variable|RSptr
DECL|variable|__initdata
r_static
r_struct
(brace
r_int
r_int
id|vesa
suffix:semicolon
r_int
r_int
id|info
suffix:semicolon
)brace
op_star
id|RSptr
comma
id|vesamap
(braket
)braket
id|__initdata
op_assign
(brace
multiline_comment|/* default must be first */
macro_line|#ifdef FBCON_HAS_CFB8
(brace
op_complement
l_int|0
comma
id|RSCreate
c_func
(paren
id|RSNoxNo
comma
id|RS8bpp
)paren
)brace
comma
(brace
l_int|0x101
comma
id|RSCreate
c_func
(paren
id|RS640x480
comma
id|RS8bpp
)paren
)brace
comma
(brace
l_int|0x100
comma
id|RSCreate
c_func
(paren
id|RS640x400
comma
id|RS8bpp
)paren
)brace
comma
(brace
l_int|0x180
comma
id|RSCreate
c_func
(paren
id|RS768x576
comma
id|RS8bpp
)paren
)brace
comma
(brace
l_int|0x103
comma
id|RSCreate
c_func
(paren
id|RS800x600
comma
id|RS8bpp
)paren
)brace
comma
(brace
l_int|0x188
comma
id|RSCreate
c_func
(paren
id|RS960x720
comma
id|RS8bpp
)paren
)brace
comma
(brace
l_int|0x105
comma
id|RSCreate
c_func
(paren
id|RS1024x768
comma
id|RS8bpp
)paren
)brace
comma
(brace
l_int|0x190
comma
id|RSCreate
c_func
(paren
id|RS1152x864
comma
id|RS8bpp
)paren
)brace
comma
(brace
l_int|0x107
comma
id|RSCreate
c_func
(paren
id|RS1280x1024
comma
id|RS8bpp
)paren
)brace
comma
(brace
l_int|0x198
comma
id|RSCreate
c_func
(paren
id|RS1408x1056
comma
id|RS8bpp
)paren
)brace
comma
(brace
l_int|0x11C
comma
id|RSCreate
c_func
(paren
id|RS1600x1200
comma
id|RS8bpp
)paren
)brace
comma
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB16
(brace
op_complement
l_int|0
comma
id|RSCreate
c_func
(paren
id|RSNoxNo
comma
id|RS15bpp
)paren
)brace
comma
(brace
l_int|0x110
comma
id|RSCreate
c_func
(paren
id|RS640x480
comma
id|RS15bpp
)paren
)brace
comma
(brace
l_int|0x181
comma
id|RSCreate
c_func
(paren
id|RS768x576
comma
id|RS15bpp
)paren
)brace
comma
(brace
l_int|0x113
comma
id|RSCreate
c_func
(paren
id|RS800x600
comma
id|RS15bpp
)paren
)brace
comma
(brace
l_int|0x189
comma
id|RSCreate
c_func
(paren
id|RS960x720
comma
id|RS15bpp
)paren
)brace
comma
(brace
l_int|0x116
comma
id|RSCreate
c_func
(paren
id|RS1024x768
comma
id|RS15bpp
)paren
)brace
comma
(brace
l_int|0x191
comma
id|RSCreate
c_func
(paren
id|RS1152x864
comma
id|RS15bpp
)paren
)brace
comma
(brace
l_int|0x119
comma
id|RSCreate
c_func
(paren
id|RS1280x1024
comma
id|RS15bpp
)paren
)brace
comma
(brace
l_int|0x199
comma
id|RSCreate
c_func
(paren
id|RS1408x1056
comma
id|RS15bpp
)paren
)brace
comma
(brace
l_int|0x11D
comma
id|RSCreate
c_func
(paren
id|RS1600x1200
comma
id|RS15bpp
)paren
)brace
comma
(brace
l_int|0x111
comma
id|RSCreate
c_func
(paren
id|RS640x480
comma
id|RS16bpp
)paren
)brace
comma
(brace
l_int|0x182
comma
id|RSCreate
c_func
(paren
id|RS768x576
comma
id|RS16bpp
)paren
)brace
comma
(brace
l_int|0x114
comma
id|RSCreate
c_func
(paren
id|RS800x600
comma
id|RS16bpp
)paren
)brace
comma
(brace
l_int|0x18A
comma
id|RSCreate
c_func
(paren
id|RS960x720
comma
id|RS16bpp
)paren
)brace
comma
(brace
l_int|0x117
comma
id|RSCreate
c_func
(paren
id|RS1024x768
comma
id|RS16bpp
)paren
)brace
comma
(brace
l_int|0x192
comma
id|RSCreate
c_func
(paren
id|RS1152x864
comma
id|RS16bpp
)paren
)brace
comma
(brace
l_int|0x11A
comma
id|RSCreate
c_func
(paren
id|RS1280x1024
comma
id|RS16bpp
)paren
)brace
comma
(brace
l_int|0x19A
comma
id|RSCreate
c_func
(paren
id|RS1408x1056
comma
id|RS16bpp
)paren
)brace
comma
(brace
l_int|0x11E
comma
id|RSCreate
c_func
(paren
id|RS1600x1200
comma
id|RS16bpp
)paren
)brace
comma
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB24
(brace
op_complement
l_int|0
comma
id|RSCreate
c_func
(paren
id|RSNoxNo
comma
id|RS24bpp
)paren
)brace
comma
(brace
l_int|0x1B2
comma
id|RSCreate
c_func
(paren
id|RS640x480
comma
id|RS24bpp
)paren
)brace
comma
(brace
l_int|0x184
comma
id|RSCreate
c_func
(paren
id|RS768x576
comma
id|RS24bpp
)paren
)brace
comma
(brace
l_int|0x1B5
comma
id|RSCreate
c_func
(paren
id|RS800x600
comma
id|RS24bpp
)paren
)brace
comma
(brace
l_int|0x18C
comma
id|RSCreate
c_func
(paren
id|RS960x720
comma
id|RS24bpp
)paren
)brace
comma
(brace
l_int|0x1B8
comma
id|RSCreate
c_func
(paren
id|RS1024x768
comma
id|RS24bpp
)paren
)brace
comma
(brace
l_int|0x194
comma
id|RSCreate
c_func
(paren
id|RS1152x864
comma
id|RS24bpp
)paren
)brace
comma
(brace
l_int|0x1BB
comma
id|RSCreate
c_func
(paren
id|RS1280x1024
comma
id|RS24bpp
)paren
)brace
comma
(brace
l_int|0x19C
comma
id|RSCreate
c_func
(paren
id|RS1408x1056
comma
id|RS24bpp
)paren
)brace
comma
(brace
l_int|0x1BF
comma
id|RSCreate
c_func
(paren
id|RS1600x1200
comma
id|RS24bpp
)paren
)brace
comma
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB32
(brace
op_complement
l_int|0
comma
id|RSCreate
c_func
(paren
id|RSNoxNo
comma
id|RS32bpp
)paren
)brace
comma
(brace
l_int|0x112
comma
id|RSCreate
c_func
(paren
id|RS640x480
comma
id|RS32bpp
)paren
)brace
comma
(brace
l_int|0x183
comma
id|RSCreate
c_func
(paren
id|RS768x576
comma
id|RS32bpp
)paren
)brace
comma
(brace
l_int|0x115
comma
id|RSCreate
c_func
(paren
id|RS800x600
comma
id|RS32bpp
)paren
)brace
comma
(brace
l_int|0x18B
comma
id|RSCreate
c_func
(paren
id|RS960x720
comma
id|RS32bpp
)paren
)brace
comma
(brace
l_int|0x118
comma
id|RSCreate
c_func
(paren
id|RS1024x768
comma
id|RS32bpp
)paren
)brace
comma
(brace
l_int|0x193
comma
id|RSCreate
c_func
(paren
id|RS1152x864
comma
id|RS32bpp
)paren
)brace
comma
(brace
l_int|0x11B
comma
id|RSCreate
c_func
(paren
id|RS1280x1024
comma
id|RS32bpp
)paren
)brace
comma
(brace
l_int|0x19B
comma
id|RSCreate
c_func
(paren
id|RS1408x1056
comma
id|RS32bpp
)paren
)brace
comma
(brace
l_int|0x11F
comma
id|RSCreate
c_func
(paren
id|RS1600x1200
comma
id|RS32bpp
)paren
)brace
comma
macro_line|#endif
macro_line|#ifdef FBCON_HAS_VGATEXT
(brace
op_complement
l_int|0
comma
id|RSCreate
c_func
(paren
id|RSNoxNo
comma
id|RSText
)paren
)brace
comma
(brace
l_int|0x002
comma
id|RSCreate
c_func
(paren
id|RS640x400
comma
id|RSText
)paren
)brace
comma
multiline_comment|/* 80x25 */
(brace
l_int|0x003
comma
id|RSCreate
c_func
(paren
id|RS640x400
comma
id|RSText
)paren
)brace
comma
multiline_comment|/* 80x25 */
(brace
l_int|0x007
comma
id|RSCreate
c_func
(paren
id|RS640x400
comma
id|RSText
)paren
)brace
comma
multiline_comment|/* 80x25 */
(brace
l_int|0x1C0
comma
id|RSCreate
c_func
(paren
id|RS640x400
comma
id|RSText8
)paren
)brace
comma
multiline_comment|/* 80x50 */
(brace
l_int|0x108
comma
id|RSCreate
c_func
(paren
id|RS640x480
comma
id|RSText8
)paren
)brace
comma
multiline_comment|/* 80x60 */
(brace
l_int|0x109
comma
id|RSCreate
c_func
(paren
id|RS1056x400
comma
id|RSText
)paren
)brace
comma
multiline_comment|/* 132x25 */
(brace
l_int|0x10A
comma
id|RSCreate
c_func
(paren
id|RS1056x344
comma
id|RSText8
)paren
)brace
comma
multiline_comment|/* 132x43 */
(brace
l_int|0x10B
comma
id|RSCreate
c_func
(paren
id|RS1056x400
comma
id|RSText8
)paren
)brace
comma
multiline_comment|/* 132x50 */
(brace
l_int|0x10C
comma
id|RSCreate
c_func
(paren
id|RS1056x480
comma
id|RSText8
)paren
)brace
comma
multiline_comment|/* 132x60 */
macro_line|#endif
macro_line|#ifdef FBCON_HAS_CFB4
(brace
op_complement
l_int|0
comma
id|RSCreate
c_func
(paren
id|RSNoxNo
comma
id|RS4bpp
)paren
)brace
comma
(brace
l_int|0x010
comma
id|RSCreate
c_func
(paren
id|RS640x350
comma
id|RS4bpp
)paren
)brace
comma
(brace
l_int|0x012
comma
id|RSCreate
c_func
(paren
id|RS640x480
comma
id|RS4bpp
)paren
)brace
comma
(brace
l_int|0x102
comma
id|RSCreate
c_func
(paren
id|RS800x600
comma
id|RS4bpp
)paren
)brace
comma
(brace
l_int|0x104
comma
id|RSCreate
c_func
(paren
id|RS1024x768
comma
id|RS4bpp
)paren
)brace
comma
(brace
l_int|0x106
comma
id|RSCreate
c_func
(paren
id|RS1280x1024
comma
id|RS4bpp
)paren
)brace
comma
macro_line|#endif
(brace
l_int|0
comma
l_int|0
)brace
)brace
suffix:semicolon
DECL|function|matroxfb_init_params
r_static
r_void
id|__init
id|matroxfb_init_params
c_func
(paren
r_void
)paren
(brace
multiline_comment|/* fh from kHz to Hz */
r_if
c_cond
(paren
id|fh
OL
l_int|1000
)paren
id|fh
op_mul_assign
l_int|1000
suffix:semicolon
multiline_comment|/* 1kHz minimum */
multiline_comment|/* maxclk */
r_if
c_cond
(paren
id|maxclk
OL
l_int|1000
)paren
id|maxclk
op_mul_assign
l_int|1000
suffix:semicolon
multiline_comment|/* kHz -&gt; Hz, MHz -&gt; kHz */
r_if
c_cond
(paren
id|maxclk
OL
l_int|1000000
)paren
id|maxclk
op_mul_assign
l_int|1000
suffix:semicolon
multiline_comment|/* kHz -&gt; Hz, 1MHz minimum */
multiline_comment|/* fix VESA number */
r_if
c_cond
(paren
id|vesa
op_ne
op_complement
l_int|0
)paren
id|vesa
op_and_assign
l_int|0x1DFF
suffix:semicolon
multiline_comment|/* mask out clearscreen, acceleration and so on */
multiline_comment|/* static settings */
r_for
c_loop
(paren
id|RSptr
op_assign
id|vesamap
suffix:semicolon
id|RSptr-&gt;vesa
suffix:semicolon
id|RSptr
op_increment
)paren
(brace
r_if
c_cond
(paren
id|RSptr-&gt;vesa
op_eq
id|vesa
)paren
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|RSptr-&gt;vesa
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;Invalid vesa mode 0x%04X&bslash;n&quot;
comma
id|vesa
)paren
suffix:semicolon
id|RSptr
op_assign
id|vesamap
suffix:semicolon
)brace
(brace
r_int
id|res
op_assign
id|RSResolution
c_func
(paren
id|RSptr-&gt;info
)paren
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|left
op_eq
op_complement
l_int|0
)paren
id|left
op_assign
id|timmings
(braket
id|res
)braket
dot
id|left
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|xres
)paren
id|xres
op_assign
id|timmings
(braket
id|res
)braket
dot
id|xres
suffix:semicolon
r_if
c_cond
(paren
id|right
op_eq
op_complement
l_int|0
)paren
id|right
op_assign
id|timmings
(braket
id|res
)braket
dot
id|right
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|hslen
)paren
id|hslen
op_assign
id|timmings
(braket
id|res
)braket
dot
id|hslen
suffix:semicolon
r_if
c_cond
(paren
id|upper
op_eq
op_complement
l_int|0
)paren
id|upper
op_assign
id|timmings
(braket
id|res
)braket
dot
id|upper
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|yres
)paren
id|yres
op_assign
id|timmings
(braket
id|res
)braket
dot
id|yres
suffix:semicolon
r_if
c_cond
(paren
id|lower
op_eq
op_complement
l_int|0
)paren
id|lower
op_assign
id|timmings
(braket
id|res
)braket
dot
id|lower
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|vslen
)paren
id|vslen
op_assign
id|timmings
(braket
id|res
)braket
dot
id|vslen
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|fv
op_logical_or
id|fh
op_logical_or
id|maxclk
op_logical_or
id|pixclock
)paren
)paren
id|fv
op_assign
id|timmings
(braket
id|res
)braket
dot
id|vfreq
suffix:semicolon
r_if
c_cond
(paren
id|depth
op_eq
op_minus
l_int|1
)paren
id|depth
op_assign
id|RSDepth
c_func
(paren
id|RSptr-&gt;info
)paren
suffix:semicolon
)brace
)brace
DECL|function|matrox_init
r_static
r_void
id|__init
id|matrox_init
c_func
(paren
r_void
)paren
(brace
id|matroxfb_init_params
c_func
(paren
)paren
suffix:semicolon
id|pci_register_driver
c_func
(paren
op_amp
id|matroxfb_driver
)paren
suffix:semicolon
id|dev
op_assign
op_minus
l_int|1
suffix:semicolon
multiline_comment|/* accept all new devices... */
)brace
multiline_comment|/* **************************** exit-time only **************************** */
DECL|function|matrox_done
r_static
r_void
id|__exit
id|matrox_done
c_func
(paren
r_void
)paren
(brace
id|pci_unregister_driver
c_func
(paren
op_amp
id|matroxfb_driver
)paren
suffix:semicolon
)brace
macro_line|#ifndef MODULE
multiline_comment|/* ************************* init in-kernel code ************************** */
DECL|function|matroxfb_setup
r_int
id|__init
id|matroxfb_setup
c_func
(paren
r_char
op_star
id|options
)paren
(brace
r_char
op_star
id|this_opt
suffix:semicolon
id|DBG
c_func
(paren
l_string|&quot;matroxfb_setup&quot;
)paren
id|fontname
(braket
l_int|0
)braket
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|options
op_logical_or
op_logical_neg
op_star
id|options
)paren
r_return
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|this_opt
op_assign
id|strtok
c_func
(paren
id|options
comma
l_string|&quot;,&quot;
)paren
suffix:semicolon
id|this_opt
suffix:semicolon
id|this_opt
op_assign
id|strtok
c_func
(paren
l_int|NULL
comma
l_string|&quot;,&quot;
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
op_star
id|this_opt
)paren
r_continue
suffix:semicolon
id|dprintk
c_func
(paren
l_string|&quot;matroxfb_setup: option %s&bslash;n&quot;
comma
id|this_opt
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;dev:&quot;
comma
l_int|4
)paren
)paren
id|dev
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|4
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;depth:&quot;
comma
l_int|6
)paren
)paren
(brace
r_switch
c_cond
(paren
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|6
comma
l_int|NULL
comma
l_int|0
)paren
)paren
(brace
r_case
l_int|0
suffix:colon
id|depth
op_assign
id|RSText
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
id|depth
op_assign
id|RS4bpp
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|8
suffix:colon
id|depth
op_assign
id|RS8bpp
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|15
suffix:colon
id|depth
op_assign
id|RS15bpp
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|16
suffix:colon
id|depth
op_assign
id|RS16bpp
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|24
suffix:colon
id|depth
op_assign
id|RS24bpp
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|32
suffix:colon
id|depth
op_assign
id|RS32bpp
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: unsupported color depth&bslash;n&quot;
)paren
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;xres:&quot;
comma
l_int|5
)paren
)paren
id|xres
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|5
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;yres:&quot;
comma
l_int|5
)paren
)paren
id|yres
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|5
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;vslen:&quot;
comma
l_int|6
)paren
)paren
id|vslen
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|6
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;hslen:&quot;
comma
l_int|6
)paren
)paren
id|hslen
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|6
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;left:&quot;
comma
l_int|5
)paren
)paren
id|left
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|5
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;right:&quot;
comma
l_int|6
)paren
)paren
id|right
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|6
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;upper:&quot;
comma
l_int|6
)paren
)paren
id|upper
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|6
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;lower:&quot;
comma
l_int|6
)paren
)paren
id|lower
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|6
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;pixclock:&quot;
comma
l_int|9
)paren
)paren
id|pixclock
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|9
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;sync:&quot;
comma
l_int|5
)paren
)paren
id|sync
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|5
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;vesa:&quot;
comma
l_int|5
)paren
)paren
id|vesa
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|5
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;font:&quot;
comma
l_int|5
)paren
)paren
id|strncpy
c_func
(paren
id|fontname
comma
id|this_opt
op_plus
l_int|5
comma
r_sizeof
(paren
id|fontname
)paren
op_minus
l_int|1
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;maxclk:&quot;
comma
l_int|7
)paren
)paren
id|maxclk
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|7
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;fh:&quot;
comma
l_int|3
)paren
)paren
id|fh
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|3
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;fv:&quot;
comma
l_int|3
)paren
)paren
id|fv
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|3
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;mem:&quot;
comma
l_int|4
)paren
)paren
id|mem
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|4
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;mode:&quot;
comma
l_int|5
)paren
)paren
id|strncpy
c_func
(paren
id|videomode
comma
id|this_opt
op_plus
l_int|5
comma
r_sizeof
(paren
id|videomode
)paren
op_minus
l_int|1
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_PPC
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;vmode:&quot;
comma
l_int|6
)paren
)paren
(brace
r_int
r_int
id|vmode
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|6
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|vmode
OG
l_int|0
op_logical_and
id|vmode
op_le
id|VMODE_MAX
)paren
id|default_vmode
op_assign
id|vmode
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;cmode:&quot;
comma
l_int|6
)paren
)paren
(brace
r_int
r_int
id|cmode
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|6
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|cmode
)paren
(brace
r_case
l_int|0
suffix:colon
r_case
l_int|8
suffix:colon
id|default_cmode
op_assign
id|CMODE_8
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|15
suffix:colon
r_case
l_int|16
suffix:colon
id|default_cmode
op_assign
id|CMODE_16
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|24
suffix:colon
r_case
l_int|32
suffix:colon
id|default_cmode
op_assign
id|CMODE_32
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
macro_line|#endif
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;fastfont:&quot;
comma
l_int|9
)paren
)paren
id|fastfont
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|9
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;nofastfont&quot;
)paren
)paren
multiline_comment|/* fastfont:N and nofastfont (nofastfont = fastfont:0) */
id|fastfont
op_assign
l_int|0
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;disabled&quot;
)paren
)paren
multiline_comment|/* nodisabled does not exist */
id|disabled
op_assign
l_int|1
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;enabled&quot;
)paren
)paren
multiline_comment|/* noenabled does not exist */
id|disabled
op_assign
l_int|0
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;sgram&quot;
)paren
)paren
multiline_comment|/* nosgram == sdram */
id|sgram
op_assign
l_int|1
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;sdram&quot;
)paren
)paren
id|sgram
op_assign
l_int|0
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;memtype:&quot;
comma
l_int|8
)paren
)paren
id|memtype
op_assign
id|simple_strtoul
c_func
(paren
id|this_opt
op_plus
l_int|8
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_else
(brace
r_int
id|value
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|this_opt
comma
l_string|&quot;no&quot;
comma
l_int|2
)paren
)paren
(brace
id|value
op_assign
l_int|0
suffix:semicolon
id|this_opt
op_add_assign
l_int|2
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;inverse&quot;
)paren
)paren
id|inverse
op_assign
id|value
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;accel&quot;
)paren
)paren
id|noaccel
op_assign
op_logical_neg
id|value
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;pan&quot;
)paren
)paren
id|nopan
op_assign
op_logical_neg
id|value
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;pciretry&quot;
)paren
)paren
id|no_pci_retry
op_assign
op_logical_neg
id|value
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;vga&quot;
)paren
)paren
id|novga
op_assign
op_logical_neg
id|value
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;bios&quot;
)paren
)paren
id|nobios
op_assign
op_logical_neg
id|value
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;init&quot;
)paren
)paren
id|noinit
op_assign
op_logical_neg
id|value
suffix:semicolon
macro_line|#ifdef CONFIG_MTRR
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;mtrr&quot;
)paren
)paren
id|mtrr
op_assign
id|value
suffix:semicolon
macro_line|#endif
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;inv24&quot;
)paren
)paren
id|inv24
op_assign
id|value
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;cross4MB&quot;
)paren
)paren
id|cross4MB
op_assign
id|value
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;hwcursor&quot;
)paren
)paren
id|hwcursor
op_assign
id|value
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;blink&quot;
)paren
)paren
id|blink
op_assign
id|value
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;grayscale&quot;
)paren
)paren
id|grayscale
op_assign
id|value
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|this_opt
comma
l_string|&quot;dfp&quot;
)paren
)paren
id|dfp
op_assign
id|value
suffix:semicolon
r_else
(brace
id|strncpy
c_func
(paren
id|videomode
comma
id|this_opt
comma
r_sizeof
(paren
id|videomode
)paren
op_minus
l_int|1
)paren
suffix:semicolon
)brace
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|initialized
r_static
r_int
id|__init
id|initialized
op_assign
l_int|0
suffix:semicolon
DECL|function|matroxfb_init
r_int
id|__init
id|matroxfb_init
c_func
(paren
r_void
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;matroxfb_init&quot;
)paren
r_if
c_cond
(paren
id|disabled
)paren
r_return
op_minus
id|ENXIO
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|initialized
)paren
(brace
id|initialized
op_assign
l_int|1
suffix:semicolon
id|matrox_init
c_func
(paren
)paren
suffix:semicolon
)brace
multiline_comment|/* never return failure, user can hotplug matrox later... */
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#else
multiline_comment|/* *************************** init module code **************************** */
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;(c) 1998,1999 Petr Vandrovec &lt;vandrove@vc.cvut.cz&gt;&quot;
)paren
suffix:semicolon
id|MODULE_DESCRIPTION
c_func
(paren
l_string|&quot;Accelerated FBDev driver for Matrox Millennium/Mystique/G100/G200/G400&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|mem
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|mem
comma
l_string|&quot;Size of available memory in MB, KB or B (2,4,8,12,16MB, default=autodetect)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|disabled
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|disabled
comma
l_string|&quot;Disabled (0 or 1=disabled) (default=0)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|noaccel
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|noaccel
comma
l_string|&quot;Do not use accelerating engine (0 or 1=disabled) (default=0)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|nopan
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|nopan
comma
l_string|&quot;Disable pan on startup (0 or 1=disabled) (default=0)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|no_pci_retry
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|no_pci_retry
comma
l_string|&quot;PCI retries enabled (0 or 1=disabled) (default=0)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|novga
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|novga
comma
l_string|&quot;VGA I/O (0x3C0-0x3DF) disabled (0 or 1=disabled) (default=0)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|nobios
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|nobios
comma
l_string|&quot;Disables ROM BIOS (0 or 1=disabled) (default=do not change BIOS state)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|noinit
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|noinit
comma
l_string|&quot;Disables W/SG/SD-RAM and bus interface initialization (0 or 1=do not initialize) (default=0)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|memtype
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|memtype
comma
l_string|&quot;Memory type for G200/G400 (see Documentation/fb/matroxfb.txt for explanation) (default=3 for G200, 0 for G400)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|mtrr
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|mtrr
comma
l_string|&quot;This speeds up video memory accesses (0=disabled or 1) (default=1)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|sgram
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|sgram
comma
l_string|&quot;Indicates that G200/G400 has SGRAM memory (0=SDRAM, 1=SGRAM) (default=0)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|inv24
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|inv24
comma
l_string|&quot;Inverts clock polarity for 24bpp and loop frequency &gt; 100MHz (default=do not invert polarity)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|inverse
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|inverse
comma
l_string|&quot;Inverse (0 or 1) (default=0)&quot;
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_FB_MATROX_MULTIHEAD
id|MODULE_PARM
c_func
(paren
id|dev
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|dev
comma
l_string|&quot;Multihead support, attach to device ID (0..N) (default=all working)&quot;
)paren
suffix:semicolon
macro_line|#else
id|MODULE_PARM
c_func
(paren
id|dev
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|dev
comma
l_string|&quot;Multihead support, attach to device ID (0..N) (default=first working)&quot;
)paren
suffix:semicolon
macro_line|#endif
id|MODULE_PARM
c_func
(paren
id|vesa
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|vesa
comma
l_string|&quot;Startup videomode (0x000-0x1FF) (default=0x101)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|xres
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|xres
comma
l_string|&quot;Horizontal resolution (px), overrides xres from vesa (default=vesa)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|yres
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|yres
comma
l_string|&quot;Vertical resolution (scans), overrides yres from vesa (default=vesa)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|upper
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|upper
comma
l_string|&quot;Upper blank space (scans), overrides upper from vesa (default=vesa)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|lower
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|lower
comma
l_string|&quot;Lower blank space (scans), overrides lower from vesa (default=vesa)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|vslen
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|vslen
comma
l_string|&quot;Vertical sync length (scans), overrides lower from vesa (default=vesa)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|left
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|left
comma
l_string|&quot;Left blank space (px), overrides left from vesa (default=vesa)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|right
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|right
comma
l_string|&quot;Right blank space (px), overrides right from vesa (default=vesa)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|hslen
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|hslen
comma
l_string|&quot;Horizontal sync length (px), overrides hslen from vesa (default=vesa)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|pixclock
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|pixclock
comma
l_string|&quot;Pixelclock (ns), overrides pixclock from vesa (default=vesa)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|sync
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|sync
comma
l_string|&quot;Sync polarity, overrides sync from vesa (default=vesa)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|depth
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|depth
comma
l_string|&quot;Color depth (0=text,8,15,16,24,32) (default=vesa)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|maxclk
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|maxclk
comma
l_string|&quot;Startup maximal clock, 0-999MHz, 1000-999999kHz, 1000000-INF Hz&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|fh
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|fh
comma
l_string|&quot;Startup horizontal frequency, 0-999kHz, 1000-INF Hz&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|fv
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|fv
comma
l_string|&quot;Startup vertical frequency, 0-INF Hz&bslash;n&quot;
l_string|&quot;You should specify &bslash;&quot;fv:max_monitor_vsync,fh:max_monitor_hsync,maxclk:max_monitor_dotclock&bslash;&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|hwcursor
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|hwcursor
comma
l_string|&quot;Enables hardware cursor (0 or 1) (default=0)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|blink
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|blink
comma
l_string|&quot;Enables hardware cursor blinking (0 or 1) (default=1)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|fastfont
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|fastfont
comma
l_string|&quot;Specifies, how much memory should be used for font data (0, 1024-65536 are reasonable) (default=0)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|grayscale
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|grayscale
comma
l_string|&quot;Sets display into grayscale. Works perfectly with paletized videomode (4, 8bpp), some limitations apply to 16, 24 and 32bpp videomodes (default=nograyscale)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|cross4MB
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|cross4MB
comma
l_string|&quot;Specifies that 4MB boundary can be in middle of line. (default=autodetected)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|dfp
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|dfp
comma
l_string|&quot;Specifies whether to use digital flat panel interface of G200/G400 (0 or 1) (default=0)&quot;
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_PPC
id|MODULE_PARM
c_func
(paren
id|vmode
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|vmode
comma
l_string|&quot;Specify the vmode mode number that should be used (640x480 default)&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|cmode
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM_DESC
c_func
(paren
id|cmode
comma
l_string|&quot;Specify the video depth that should be used (8bit default)&quot;
)paren
suffix:semicolon
macro_line|#endif
DECL|function|init_module
r_int
id|__init
(def_block
id|init_module
c_func
(paren
r_void
)paren
(brace
id|DBG
c_func
(paren
l_string|&quot;init_module&quot;
)paren
r_if
c_cond
(paren
id|disabled
)paren
r_return
op_minus
id|ENXIO
suffix:semicolon
r_if
c_cond
(paren
id|depth
op_eq
l_int|0
)paren
id|depth
op_assign
id|RSText
suffix:semicolon
r_else
r_if
c_cond
(paren
id|depth
op_eq
l_int|4
)paren
id|depth
op_assign
id|RS4bpp
suffix:semicolon
r_else
r_if
c_cond
(paren
id|depth
op_eq
l_int|8
)paren
id|depth
op_assign
id|RS8bpp
suffix:semicolon
r_else
r_if
c_cond
(paren
id|depth
op_eq
l_int|15
)paren
id|depth
op_assign
id|RS15bpp
suffix:semicolon
r_else
r_if
c_cond
(paren
id|depth
op_eq
l_int|16
)paren
id|depth
op_assign
id|RS16bpp
suffix:semicolon
r_else
r_if
c_cond
(paren
id|depth
op_eq
l_int|24
)paren
id|depth
op_assign
id|RS24bpp
suffix:semicolon
r_else
r_if
c_cond
(paren
id|depth
op_eq
l_int|32
)paren
id|depth
op_assign
id|RS32bpp
suffix:semicolon
r_else
r_if
c_cond
(paren
id|depth
op_ne
op_minus
l_int|1
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;matroxfb: depth %d is not supported, using default&bslash;n&quot;
comma
id|depth
)paren
suffix:semicolon
id|depth
op_assign
op_minus
l_int|1
suffix:semicolon
)brace
id|matrox_init
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* never return failure; user can hotplug matrox later... */
r_return
l_int|0
suffix:semicolon
)brace
)def_block
macro_line|#endif&t;/* MODULE */
DECL|variable|matrox_done
id|module_exit
c_func
(paren
id|matrox_done
)paren
suffix:semicolon
DECL|variable|matroxfb_register_driver
id|EXPORT_SYMBOL
c_func
(paren
id|matroxfb_register_driver
)paren
suffix:semicolon
DECL|variable|matroxfb_unregister_driver
id|EXPORT_SYMBOL
c_func
(paren
id|matroxfb_unregister_driver
)paren
suffix:semicolon
multiline_comment|/*&n; * Overrides for Emacs so that we follow Linus&squot;s tabbing style.&n; * ---------------------------------------------------------------------------&n; * Local variables:&n; * c-basic-offset: 8&n; * End:&n; */
eof
