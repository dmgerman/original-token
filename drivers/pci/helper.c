multiline_comment|/*&n; * $Id$&n; *&n; * drivers/pci/helper.c&n; *&n; * Copyright 1999 Jeff Garzik &lt;jgarzik@pobox.com&gt;&n; * This software is free.  See the file COPYING for licensing details.&n; *&n; */
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/pci.h&gt;
DECL|function|pci_simple_probe
r_int
id|pci_simple_probe
(paren
r_struct
id|pci_simple_probe_entry
op_star
id|list
comma
r_int
id|match_limit
comma
id|pci_simple_probe_callback
id|cb
comma
r_void
op_star
id|drvr_data
)paren
(brace
r_struct
id|pci_dev
op_star
id|dev
suffix:semicolon
r_struct
id|pci_simple_probe_entry
op_star
id|ent
suffix:semicolon
r_int
id|matches
op_assign
l_int|0
suffix:semicolon
r_int
r_int
id|vendor
comma
id|device
suffix:semicolon
r_int
id|rc
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|list
op_logical_or
op_logical_neg
id|cb
)paren
r_return
op_minus
l_int|1
suffix:semicolon
id|dev
op_assign
id|pci_find_device
(paren
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
l_int|NULL
)paren
suffix:semicolon
r_while
c_loop
(paren
id|dev
)paren
(brace
id|ent
op_assign
id|list
suffix:semicolon
r_while
c_loop
(paren
id|ent-&gt;vendor
op_logical_and
id|ent-&gt;device
)paren
(brace
id|vendor
op_assign
id|ent-&gt;vendor
suffix:semicolon
id|device
op_assign
id|ent-&gt;device
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
id|vendor
op_ne
l_int|0xFFFF
)paren
op_logical_and
(paren
id|vendor
op_ne
id|dev-&gt;vendor
)paren
)paren
op_logical_or
(paren
(paren
id|device
op_ne
l_int|0xFFFF
)paren
op_logical_and
(paren
id|device
op_ne
id|dev-&gt;device
)paren
)paren
)paren
(brace
id|ent
op_increment
suffix:semicolon
r_continue
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
(paren
id|ent-&gt;subsys_vendor
)paren
op_logical_and
(paren
id|ent-&gt;subsys_vendor
op_ne
id|dev-&gt;subsystem_vendor
)paren
)paren
op_logical_or
(paren
(paren
id|ent-&gt;subsys_device
)paren
op_logical_and
(paren
id|ent-&gt;subsys_device
op_ne
id|dev-&gt;subsystem_device
)paren
)paren
)paren
(brace
id|ent
op_increment
suffix:semicolon
r_continue
suffix:semicolon
)brace
id|rc
op_assign
(paren
op_star
id|cb
)paren
(paren
id|dev
comma
id|matches
comma
id|ent
comma
id|drvr_data
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rc
OL
l_int|0
)paren
r_return
id|rc
suffix:semicolon
id|matches
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|match_limit
op_logical_and
id|match_limit
op_eq
id|matches
)paren
r_return
id|matches
suffix:semicolon
id|ent
op_increment
suffix:semicolon
)brace
id|dev
op_assign
id|pci_find_device
(paren
id|PCI_ANY_ID
comma
id|PCI_ANY_ID
comma
id|dev
)paren
suffix:semicolon
)brace
r_return
id|matches
suffix:semicolon
)brace
eof
