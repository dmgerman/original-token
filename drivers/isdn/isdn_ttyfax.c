multiline_comment|/* $Id: isdn_ttyfax.c,v 1.7 2000/05/11 22:29:21 kai Exp $&n;&n; * Linux ISDN subsystem, tty_fax AT-command emulator (linklevel).&n; *&n; * Copyright 1999    by Armin Schindler (mac@melware.de)&n; * Copyright 1999    by Ralf Spachmann (mel@melware.de)&n; * Copyright 1999    by Cytronics &amp; Melware&n; *&n; * This program is free software; you can redistribute it and/or modify&n; * it under the terms of the GNU General Public License as published by&n; * the Free Software Foundation; either version 2, or (at your option)&n; * any later version.&n; *&n; * This program is distributed in the hope that it will be useful,&n; * but WITHOUT ANY WARRANTY; without even the implied warranty of&n; * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; * GNU General Public License for more details.&n; *&n; * You should have received a copy of the GNU General Public License&n; * along with this program; if not, write to the Free Software&n; * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.&n; *&n; */
DECL|macro|ISDN_TTY_FAX_STAT_DEBUG
macro_line|#undef ISDN_TTY_FAX_STAT_DEBUG
DECL|macro|ISDN_TTY_FAX_CMD_DEBUG
macro_line|#undef ISDN_TTY_FAX_CMD_DEBUG
DECL|macro|__NO_VERSION__
mdefine_line|#define __NO_VERSION__
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/isdn.h&gt;
macro_line|#include &quot;isdn_common.h&quot;
macro_line|#include &quot;isdn_tty.h&quot;
macro_line|#include &quot;isdn_ttyfax.h&quot;
DECL|variable|isdn_tty_fax_revision
r_static
r_char
op_star
id|isdn_tty_fax_revision
op_assign
l_string|&quot;$Revision: 1.7 $&quot;
suffix:semicolon
DECL|macro|PARSE_ERROR1
mdefine_line|#define PARSE_ERROR1 { isdn_tty_fax_modem_result(1, info); return 1; }
r_static
r_char
op_star
DECL|function|isdn_getrev
id|isdn_getrev
c_func
(paren
r_const
r_char
op_star
id|revision
)paren
(brace
r_char
op_star
id|rev
suffix:semicolon
r_char
op_star
id|p
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|strchr
c_func
(paren
id|revision
comma
l_char|&squot;:&squot;
)paren
)paren
)paren
(brace
id|rev
op_assign
id|p
op_plus
l_int|2
suffix:semicolon
id|p
op_assign
id|strchr
c_func
(paren
id|rev
comma
l_char|&squot;$&squot;
)paren
suffix:semicolon
op_star
op_decrement
id|p
op_assign
l_int|0
suffix:semicolon
)brace
r_else
id|rev
op_assign
l_string|&quot;???&quot;
suffix:semicolon
r_return
id|rev
suffix:semicolon
)brace
multiline_comment|/*&n; * Fax Class 2 Modem results&n; *&n; */
r_static
r_void
DECL|function|isdn_tty_fax_modem_result
id|isdn_tty_fax_modem_result
c_func
(paren
r_int
id|code
comma
id|modem_info
op_star
id|info
)paren
(brace
id|atemu
op_star
id|m
op_assign
op_amp
id|info-&gt;emu
suffix:semicolon
id|T30_s
op_star
id|f
op_assign
id|info-&gt;fax
suffix:semicolon
r_char
id|rs
(braket
l_int|50
)braket
suffix:semicolon
r_char
id|rss
(braket
l_int|50
)braket
suffix:semicolon
r_char
op_star
id|rp
suffix:semicolon
r_int
id|i
suffix:semicolon
r_static
r_char
op_star
id|msg
(braket
)braket
op_assign
(brace
l_string|&quot;OK&quot;
comma
l_string|&quot;ERROR&quot;
comma
l_string|&quot;+FCON&quot;
comma
l_string|&quot;+FCSI:&quot;
comma
l_string|&quot;+FDIS:&quot;
comma
l_string|&quot;+FHNG:&quot;
comma
l_string|&quot;+FDCS:&quot;
comma
l_string|&quot;CONNECT&quot;
comma
l_string|&quot;+FTSI:&quot;
comma
l_string|&quot;+FCFR&quot;
comma
l_string|&quot;+FPTS:&quot;
comma
l_string|&quot;+FET:&quot;
)brace
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
l_string|&quot;&bslash;r&bslash;n&quot;
comma
id|info
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|msg
(braket
id|code
)braket
comma
id|info
)paren
suffix:semicolon
macro_line|#ifdef ISDN_TTY_FAX_CMD_DEBUG
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;isdn_tty: Fax send %s on ttyI%d&bslash;n&quot;
comma
id|msg
(braket
id|code
)braket
comma
id|info-&gt;line
)paren
suffix:semicolon
macro_line|#endif
r_switch
c_cond
(paren
id|code
)paren
(brace
r_case
l_int|0
suffix:colon
multiline_comment|/* OK */
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
multiline_comment|/* ERROR */
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
multiline_comment|/* +FCON */
multiline_comment|/* Append CPN, if enabled */
r_if
c_cond
(paren
(paren
id|m-&gt;mdmreg
(braket
id|REG_CPN
)braket
op_amp
id|BIT_CPNFCON
)paren
op_logical_and
(paren
op_logical_neg
(paren
id|dev-&gt;usage
(braket
id|info-&gt;isdn_channel
)braket
op_amp
id|ISDN_USAGE_OUTGOING
)paren
)paren
)paren
(brace
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;/%s&quot;
comma
id|m-&gt;cpn
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
)brace
id|info-&gt;online
op_assign
l_int|1
suffix:semicolon
id|f-&gt;fet
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|f-&gt;phase
op_eq
id|ISDN_FAX_PHASE_A
)paren
id|f-&gt;phase
op_assign
id|ISDN_FAX_PHASE_B
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
multiline_comment|/* +FCSI */
r_case
l_int|8
suffix:colon
multiline_comment|/* +FTSI */
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;&bslash;&quot;%s&bslash;&quot;&quot;
comma
id|f-&gt;r_id
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
multiline_comment|/* +FDIS */
id|rs
(braket
l_int|0
)braket
op_assign
l_int|0
suffix:semicolon
id|rp
op_assign
op_amp
id|f-&gt;r_resolution
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|8
suffix:semicolon
id|i
op_increment
)paren
(brace
id|sprintf
c_func
(paren
id|rss
comma
l_string|&quot;%c%s&quot;
comma
id|rp
(braket
id|i
)braket
op_plus
l_int|48
comma
(paren
id|i
OL
l_int|7
)paren
ques
c_cond
l_string|&quot;,&quot;
suffix:colon
l_string|&quot;&quot;
)paren
suffix:semicolon
id|strcat
c_func
(paren
id|rs
comma
id|rss
)paren
suffix:semicolon
)brace
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
macro_line|#ifdef ISDN_TTY_FAX_CMD_DEBUG
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;isdn_tty: Fax DIS=%s on ttyI%d&bslash;n&quot;
comma
id|rs
comma
id|info-&gt;line
)paren
suffix:semicolon
macro_line|#endif
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
multiline_comment|/* +FHNG */
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;%d&quot;
comma
id|f-&gt;code
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
id|info-&gt;faxonline
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|6
suffix:colon
multiline_comment|/* +FDCS */
id|rs
(braket
l_int|0
)braket
op_assign
l_int|0
suffix:semicolon
id|rp
op_assign
op_amp
id|f-&gt;r_resolution
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|8
suffix:semicolon
id|i
op_increment
)paren
(brace
id|sprintf
c_func
(paren
id|rss
comma
l_string|&quot;%c%s&quot;
comma
id|rp
(braket
id|i
)braket
op_plus
l_int|48
comma
(paren
id|i
OL
l_int|7
)paren
ques
c_cond
l_string|&quot;,&quot;
suffix:colon
l_string|&quot;&quot;
)paren
suffix:semicolon
id|strcat
c_func
(paren
id|rs
comma
id|rss
)paren
suffix:semicolon
)brace
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
macro_line|#ifdef ISDN_TTY_FAX_CMD_DEBUG
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;isdn_tty: Fax DCS=%s on ttyI%d&bslash;n&quot;
comma
id|rs
comma
id|info-&gt;line
)paren
suffix:semicolon
macro_line|#endif
r_break
suffix:semicolon
r_case
l_int|7
suffix:colon
multiline_comment|/* CONNECT */
id|info-&gt;faxonline
op_or_assign
l_int|2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|9
suffix:colon
multiline_comment|/* FCFR */
r_break
suffix:semicolon
r_case
l_int|10
suffix:colon
multiline_comment|/* FPTS */
id|isdn_tty_at_cout
c_func
(paren
l_string|&quot;1&quot;
comma
id|info
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|11
suffix:colon
multiline_comment|/* FET */
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;%d&quot;
comma
id|f-&gt;fet
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|isdn_tty_at_cout
c_func
(paren
l_string|&quot;&bslash;r&bslash;n&quot;
comma
id|info
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|code
)paren
(brace
r_case
l_int|7
suffix:colon
multiline_comment|/* CONNECT */
id|info-&gt;online
op_assign
l_int|2
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;faxonline
op_amp
l_int|1
)paren
(brace
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;%c&quot;
comma
id|XON
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
)brace
)brace
r_int
DECL|function|isdn_tty_fax_command1
id|isdn_tty_fax_command1
c_func
(paren
id|modem_info
op_star
id|info
comma
id|isdn_ctrl
op_star
id|c
)paren
(brace
r_static
r_char
op_star
id|msg
(braket
)braket
op_assign
(brace
l_string|&quot;OK&quot;
comma
l_string|&quot;CONNECT&quot;
comma
l_string|&quot;NO CARRIER&quot;
comma
l_string|&quot;ERROR&quot;
comma
l_string|&quot;FCERROR&quot;
)brace
suffix:semicolon
macro_line|#ifdef ISDN_TTY_FAX_CMD_DEBUG
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;isdn_tty: FCLASS1 cmd(%d)&bslash;n&quot;
comma
id|c-&gt;parm.aux.cmd
)paren
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
id|c-&gt;parm.aux.cmd
OL
id|ISDN_FAX_CLASS1_QUERY
)paren
(brace
r_if
c_cond
(paren
id|info-&gt;online
)paren
id|info-&gt;online
op_assign
l_int|1
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
l_string|&quot;&bslash;r&bslash;n&quot;
comma
id|info
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|msg
(braket
id|c-&gt;parm.aux.cmd
)braket
comma
id|info
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
l_string|&quot;&bslash;r&bslash;n&quot;
comma
id|info
)paren
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|c-&gt;parm.aux.cmd
)paren
(brace
r_case
id|ISDN_FAX_CLASS1_CONNECT
suffix:colon
id|info-&gt;online
op_assign
l_int|2
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ISDN_FAX_CLASS1_OK
suffix:colon
r_case
id|ISDN_FAX_CLASS1_FCERROR
suffix:colon
r_case
id|ISDN_FAX_CLASS1_ERROR
suffix:colon
r_case
id|ISDN_FAX_CLASS1_NOCARR
suffix:colon
r_break
suffix:semicolon
r_case
id|ISDN_FAX_CLASS1_QUERY
suffix:colon
id|isdn_tty_at_cout
c_func
(paren
l_string|&quot;&bslash;r&bslash;n&quot;
comma
id|info
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|c-&gt;parm.aux.para
(braket
l_int|0
)braket
)paren
(brace
id|isdn_tty_at_cout
c_func
(paren
id|msg
(braket
id|ISDN_FAX_CLASS1_ERROR
)braket
comma
id|info
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
l_string|&quot;&bslash;r&bslash;n&quot;
comma
id|info
)paren
suffix:semicolon
)brace
r_else
(brace
id|isdn_tty_at_cout
c_func
(paren
id|c-&gt;parm.aux.para
comma
id|info
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
l_string|&quot;&bslash;r&bslash;nOK&bslash;r&bslash;n&quot;
comma
id|info
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
)brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_int
DECL|function|isdn_tty_fax_command
id|isdn_tty_fax_command
c_func
(paren
id|modem_info
op_star
id|info
comma
id|isdn_ctrl
op_star
id|c
)paren
(brace
id|T30_s
op_star
id|f
op_assign
id|info-&gt;fax
suffix:semicolon
r_char
id|rs
(braket
l_int|10
)braket
suffix:semicolon
r_if
c_cond
(paren
id|TTY_IS_FCLASS1
c_func
(paren
id|info
)paren
)paren
r_return
(paren
id|isdn_tty_fax_command1
c_func
(paren
id|info
comma
id|c
)paren
)paren
suffix:semicolon
macro_line|#ifdef ISDN_TTY_FAX_CMD_DEBUG
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;isdn_tty: Fax cmd %d on ttyI%d&bslash;n&quot;
comma
id|f-&gt;r_code
comma
id|info-&gt;line
)paren
suffix:semicolon
macro_line|#endif
r_switch
c_cond
(paren
id|f-&gt;r_code
)paren
(brace
r_case
id|ISDN_TTY_FAX_FCON
suffix:colon
id|info-&gt;faxonline
op_assign
l_int|1
suffix:semicolon
id|isdn_tty_fax_modem_result
c_func
(paren
l_int|2
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* +FCON */
r_return
(paren
l_int|0
)paren
suffix:semicolon
r_case
id|ISDN_TTY_FAX_FCON_I
suffix:colon
id|info-&gt;faxonline
op_assign
l_int|16
suffix:semicolon
id|isdn_tty_fax_modem_result
c_func
(paren
l_int|2
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* +FCON */
r_return
(paren
l_int|0
)paren
suffix:semicolon
r_case
id|ISDN_TTY_FAX_RID
suffix:colon
r_if
c_cond
(paren
id|info-&gt;faxonline
op_amp
l_int|1
)paren
id|isdn_tty_fax_modem_result
c_func
(paren
l_int|3
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* +FCSI */
r_if
c_cond
(paren
id|info-&gt;faxonline
op_amp
l_int|16
)paren
id|isdn_tty_fax_modem_result
c_func
(paren
l_int|8
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* +FTSI */
r_return
(paren
l_int|0
)paren
suffix:semicolon
r_case
id|ISDN_TTY_FAX_DIS
suffix:colon
id|isdn_tty_fax_modem_result
c_func
(paren
l_int|4
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* +FDIS */
r_return
(paren
l_int|0
)paren
suffix:semicolon
r_case
id|ISDN_TTY_FAX_HNG
suffix:colon
r_if
c_cond
(paren
id|f-&gt;phase
op_eq
id|ISDN_FAX_PHASE_C
)paren
(brace
r_if
c_cond
(paren
id|f-&gt;direction
op_eq
id|ISDN_TTY_FAX_CONN_IN
)paren
(brace
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;%c%c&quot;
comma
id|DLE
comma
id|ETX
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
)brace
r_else
(brace
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;%c&quot;
comma
l_int|0x18
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
)brace
id|info-&gt;faxonline
op_and_assign
op_complement
l_int|2
suffix:semicolon
multiline_comment|/* leave data mode */
id|info-&gt;online
op_assign
l_int|1
suffix:semicolon
)brace
id|f-&gt;phase
op_assign
id|ISDN_FAX_PHASE_E
suffix:semicolon
id|isdn_tty_fax_modem_result
c_func
(paren
l_int|5
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* +FHNG */
id|isdn_tty_fax_modem_result
c_func
(paren
l_int|0
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* OK */
r_return
(paren
l_int|0
)paren
suffix:semicolon
r_case
id|ISDN_TTY_FAX_DCS
suffix:colon
id|isdn_tty_fax_modem_result
c_func
(paren
l_int|6
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* +FDCS */
id|isdn_tty_fax_modem_result
c_func
(paren
l_int|7
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* CONNECT */
id|f-&gt;phase
op_assign
id|ISDN_FAX_PHASE_C
suffix:semicolon
r_return
(paren
l_int|0
)paren
suffix:semicolon
r_case
id|ISDN_TTY_FAX_TRAIN_OK
suffix:colon
id|isdn_tty_fax_modem_result
c_func
(paren
l_int|6
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* +FDCS */
id|isdn_tty_fax_modem_result
c_func
(paren
l_int|0
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* OK */
r_return
(paren
l_int|0
)paren
suffix:semicolon
r_case
id|ISDN_TTY_FAX_SENT
suffix:colon
id|isdn_tty_fax_modem_result
c_func
(paren
l_int|0
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* OK */
r_return
(paren
l_int|0
)paren
suffix:semicolon
r_case
id|ISDN_TTY_FAX_CFR
suffix:colon
id|isdn_tty_fax_modem_result
c_func
(paren
l_int|9
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* +FCFR */
r_return
(paren
l_int|0
)paren
suffix:semicolon
r_case
id|ISDN_TTY_FAX_ET
suffix:colon
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;%c%c&quot;
comma
id|DLE
comma
id|ETX
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
id|isdn_tty_fax_modem_result
c_func
(paren
l_int|10
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* +FPTS */
id|isdn_tty_fax_modem_result
c_func
(paren
l_int|11
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* +FET */
id|isdn_tty_fax_modem_result
c_func
(paren
l_int|0
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* OK */
id|info-&gt;faxonline
op_and_assign
op_complement
l_int|2
suffix:semicolon
multiline_comment|/* leave data mode */
id|info-&gt;online
op_assign
l_int|1
suffix:semicolon
id|f-&gt;phase
op_assign
id|ISDN_FAX_PHASE_D
suffix:semicolon
r_return
(paren
l_int|0
)paren
suffix:semicolon
r_case
id|ISDN_TTY_FAX_PTS
suffix:colon
id|isdn_tty_fax_modem_result
c_func
(paren
l_int|10
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* +FPTS */
r_if
c_cond
(paren
id|f-&gt;direction
op_eq
id|ISDN_TTY_FAX_CONN_OUT
)paren
(brace
r_if
c_cond
(paren
id|f-&gt;fet
op_eq
l_int|1
)paren
id|f-&gt;phase
op_assign
id|ISDN_FAX_PHASE_B
suffix:semicolon
r_if
c_cond
(paren
id|f-&gt;fet
op_eq
l_int|0
)paren
id|isdn_tty_fax_modem_result
c_func
(paren
l_int|0
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* OK */
)brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
r_case
id|ISDN_TTY_FAX_EOP
suffix:colon
id|info-&gt;faxonline
op_and_assign
op_complement
l_int|2
suffix:semicolon
multiline_comment|/* leave data mode */
id|info-&gt;online
op_assign
l_int|1
suffix:semicolon
id|f-&gt;phase
op_assign
id|ISDN_FAX_PHASE_D
suffix:semicolon
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_return
(paren
op_minus
l_int|1
)paren
suffix:semicolon
)brace
r_void
DECL|function|isdn_tty_fax_bitorder
id|isdn_tty_fax_bitorder
c_func
(paren
id|modem_info
op_star
id|info
comma
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
id|__u8
id|LeftMask
suffix:semicolon
id|__u8
id|RightMask
suffix:semicolon
id|__u8
id|fBit
suffix:semicolon
id|__u8
id|Data
suffix:semicolon
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|info-&gt;fax-&gt;bor
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|skb-&gt;len
suffix:semicolon
id|i
op_increment
)paren
(brace
id|Data
op_assign
id|skb-&gt;data
(braket
id|i
)braket
suffix:semicolon
r_for
c_loop
(paren
id|LeftMask
op_assign
l_int|0x80
comma
id|RightMask
op_assign
l_int|0x01
suffix:semicolon
id|LeftMask
OG
id|RightMask
suffix:semicolon
id|LeftMask
op_rshift_assign
l_int|1
comma
id|RightMask
op_lshift_assign
l_int|1
)paren
(brace
id|fBit
op_assign
(paren
id|Data
op_amp
id|LeftMask
)paren
suffix:semicolon
r_if
c_cond
(paren
id|Data
op_amp
id|RightMask
)paren
id|Data
op_or_assign
id|LeftMask
suffix:semicolon
r_else
id|Data
op_and_assign
op_complement
id|LeftMask
suffix:semicolon
r_if
c_cond
(paren
id|fBit
)paren
id|Data
op_or_assign
id|RightMask
suffix:semicolon
r_else
id|Data
op_and_assign
op_complement
id|RightMask
suffix:semicolon
)brace
id|skb-&gt;data
(braket
id|i
)braket
op_assign
id|Data
suffix:semicolon
)brace
)brace
)brace
multiline_comment|/*&n; * Parse AT+F.. FAX class 1 commands&n; */
r_int
DECL|function|isdn_tty_cmd_FCLASS1
id|isdn_tty_cmd_FCLASS1
c_func
(paren
r_char
op_star
op_star
id|p
comma
id|modem_info
op_star
id|info
)paren
(brace
r_static
r_char
op_star
id|cmd
(braket
)braket
op_assign
(brace
l_string|&quot;AE&quot;
comma
l_string|&quot;TS&quot;
comma
l_string|&quot;RS&quot;
comma
l_string|&quot;TM&quot;
comma
l_string|&quot;RM&quot;
comma
l_string|&quot;TH&quot;
comma
l_string|&quot;RH&quot;
)brace
suffix:semicolon
id|isdn_ctrl
id|c
suffix:semicolon
r_int
id|par
comma
id|i
suffix:semicolon
r_int
id|flags
suffix:semicolon
r_for
c_loop
(paren
id|c.parm.aux.cmd
op_assign
l_int|0
suffix:semicolon
id|c.parm.aux.cmd
OL
l_int|7
suffix:semicolon
id|c.parm.aux.cmd
op_increment
)paren
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|p
(braket
l_int|0
)braket
comma
id|cmd
(braket
id|c.parm.aux.cmd
)braket
comma
l_int|2
)paren
)paren
r_break
suffix:semicolon
macro_line|#ifdef ISDN_TTY_FAX_CMD_DEBUG
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;isdn_tty_cmd_FCLASS1 (%s,%d)&bslash;n&quot;
comma
id|p
(braket
l_int|0
)braket
comma
id|c.parm.aux.cmd
)paren
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
id|c.parm.aux.cmd
op_eq
l_int|7
)paren
id|PARSE_ERROR1
suffix:semicolon
id|p
(braket
l_int|0
)braket
op_add_assign
l_int|2
suffix:semicolon
r_switch
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
)paren
(brace
r_case
l_char|&squot;?&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|c.parm.aux.subcmd
op_assign
id|AT_QUERY
suffix:semicolon
r_break
suffix:semicolon
r_case
l_char|&squot;=&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
op_eq
l_char|&squot;?&squot;
)paren
(brace
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|c.parm.aux.subcmd
op_assign
id|AT_EQ_QUERY
suffix:semicolon
)brace
r_else
(brace
id|par
op_assign
id|isdn_getnum
c_func
(paren
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|par
OL
l_int|0
)paren
op_logical_or
(paren
id|par
OG
l_int|255
)paren
)paren
id|PARSE_ERROR1
suffix:semicolon
id|c.parm.aux.subcmd
op_assign
id|AT_EQ_VALUE
suffix:semicolon
id|c.parm.aux.para
(braket
l_int|0
)braket
op_assign
id|par
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
l_int|0
suffix:colon
id|c.parm.aux.subcmd
op_assign
id|AT_COMMAND
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|PARSE_ERROR1
suffix:semicolon
)brace
id|c.command
op_assign
id|ISDN_CMD_FAXCMD
suffix:semicolon
macro_line|#ifdef ISDN_TTY_FAX_CMD_DEBUG
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;isdn_tty_cmd_FCLASS1 %d/%d/%d)&bslash;n&quot;
comma
id|c.parm.aux.cmd
comma
id|c.parm.aux.subcmd
comma
id|c.parm.aux.para
(braket
l_int|0
)braket
)paren
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
id|info-&gt;isdn_driver
OL
l_int|0
)paren
(brace
id|save_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
id|cli
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|c.parm.aux.subcmd
op_eq
id|AT_EQ_VALUE
)paren
op_logical_or
(paren
id|c.parm.aux.subcmd
op_eq
id|AT_COMMAND
)paren
)paren
(brace
id|restore_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
id|PARSE_ERROR1
suffix:semicolon
)brace
multiline_comment|/* get a temporary connection to the first free fax driver */
id|i
op_assign
id|isdn_get_free_channel
c_func
(paren
id|ISDN_USAGE_FAX
comma
id|ISDN_PROTO_L2_FAX
comma
id|ISDN_PROTO_L3_FCLASS1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
l_string|&quot;00&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|i
OL
l_int|0
)paren
(brace
id|restore_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
id|PARSE_ERROR1
suffix:semicolon
)brace
id|info-&gt;isdn_driver
op_assign
id|dev-&gt;drvmap
(braket
id|i
)braket
suffix:semicolon
id|info-&gt;isdn_channel
op_assign
id|dev-&gt;chanmap
(braket
id|i
)braket
suffix:semicolon
id|info-&gt;drv_index
op_assign
id|i
suffix:semicolon
id|dev-&gt;m_idx
(braket
id|i
)braket
op_assign
id|info-&gt;line
suffix:semicolon
id|c.driver
op_assign
id|info-&gt;isdn_driver
suffix:semicolon
id|c.arg
op_assign
id|info-&gt;isdn_channel
suffix:semicolon
id|isdn_command
c_func
(paren
op_amp
id|c
)paren
suffix:semicolon
id|isdn_free_channel
c_func
(paren
id|info-&gt;isdn_driver
comma
id|info-&gt;isdn_channel
comma
id|ISDN_USAGE_FAX
)paren
suffix:semicolon
id|info-&gt;isdn_driver
op_assign
op_minus
l_int|1
suffix:semicolon
id|info-&gt;isdn_channel
op_assign
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|info-&gt;drv_index
op_ge
l_int|0
)paren
(brace
id|dev-&gt;m_idx
(braket
id|info-&gt;drv_index
)braket
op_assign
op_minus
l_int|1
suffix:semicolon
id|info-&gt;drv_index
op_assign
op_minus
l_int|1
suffix:semicolon
)brace
id|restore_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
)brace
r_else
(brace
id|c.driver
op_assign
id|info-&gt;isdn_driver
suffix:semicolon
id|c.arg
op_assign
id|info-&gt;isdn_channel
suffix:semicolon
id|isdn_command
c_func
(paren
op_amp
id|c
)paren
suffix:semicolon
)brace
r_return
l_int|1
suffix:semicolon
)brace
multiline_comment|/*&n; * Parse AT+F.. FAX class 2 commands&n; */
r_int
DECL|function|isdn_tty_cmd_FCLASS2
id|isdn_tty_cmd_FCLASS2
c_func
(paren
r_char
op_star
op_star
id|p
comma
id|modem_info
op_star
id|info
)paren
(brace
id|atemu
op_star
id|m
op_assign
op_amp
id|info-&gt;emu
suffix:semicolon
id|T30_s
op_star
id|f
op_assign
id|info-&gt;fax
suffix:semicolon
id|isdn_ctrl
id|cmd
suffix:semicolon
r_int
id|par
suffix:semicolon
r_char
id|rs
(braket
l_int|50
)braket
suffix:semicolon
r_char
id|rss
(braket
l_int|50
)braket
suffix:semicolon
r_int
id|maxdccval
(braket
)braket
op_assign
(brace
l_int|1
comma
l_int|5
comma
l_int|2
comma
l_int|2
comma
l_int|3
comma
l_int|2
comma
l_int|0
comma
l_int|7
)brace
suffix:semicolon
multiline_comment|/* FAA still unchanged */
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|p
(braket
l_int|0
)braket
comma
l_string|&quot;AA&quot;
comma
l_int|2
)paren
)paren
(brace
multiline_comment|/* TODO */
id|p
(braket
l_int|0
)braket
op_add_assign
l_int|2
suffix:semicolon
r_switch
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
)paren
(brace
r_case
l_char|&squot;?&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;&bslash;r&bslash;n%d&quot;
comma
l_int|0
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_char|&squot;=&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|par
op_assign
id|isdn_getnum
c_func
(paren
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|par
OL
l_int|0
)paren
op_logical_or
(paren
id|par
OG
l_int|255
)paren
)paren
id|PARSE_ERROR1
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|PARSE_ERROR1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* BADLIN=value - dummy 0=disable errorchk disabled, 1-255 nr. of lines for making page bad */
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|p
(braket
l_int|0
)braket
comma
l_string|&quot;BADLIN&quot;
comma
l_int|6
)paren
)paren
(brace
id|p
(braket
l_int|0
)braket
op_add_assign
l_int|6
suffix:semicolon
r_switch
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
)paren
(brace
r_case
l_char|&squot;?&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;&bslash;r&bslash;n%d&quot;
comma
id|f-&gt;badlin
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_char|&squot;=&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
op_eq
l_char|&squot;?&squot;
)paren
(brace
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;&bslash;r&bslash;n0-255&quot;
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
)brace
r_else
(brace
id|par
op_assign
id|isdn_getnum
c_func
(paren
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|par
OL
l_int|0
)paren
op_logical_or
(paren
id|par
OG
l_int|255
)paren
)paren
id|PARSE_ERROR1
suffix:semicolon
id|f-&gt;badlin
op_assign
id|par
suffix:semicolon
macro_line|#ifdef ISDN_TTY_FAX_STAT_DEBUG
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;isdn_tty: Fax FBADLIN=%d&bslash;n&quot;
comma
id|par
)paren
suffix:semicolon
macro_line|#endif
)brace
r_break
suffix:semicolon
r_default
suffix:colon
id|PARSE_ERROR1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* BADMUL=value - dummy 0=disable errorchk disabled (treshold multiplier) */
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|p
(braket
l_int|0
)braket
comma
l_string|&quot;BADMUL&quot;
comma
l_int|6
)paren
)paren
(brace
id|p
(braket
l_int|0
)braket
op_add_assign
l_int|6
suffix:semicolon
r_switch
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
)paren
(brace
r_case
l_char|&squot;?&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;&bslash;r&bslash;n%d&quot;
comma
id|f-&gt;badmul
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_char|&squot;=&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
op_eq
l_char|&squot;?&squot;
)paren
(brace
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;&bslash;r&bslash;n0-255&quot;
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
)brace
r_else
(brace
id|par
op_assign
id|isdn_getnum
c_func
(paren
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|par
OL
l_int|0
)paren
op_logical_or
(paren
id|par
OG
l_int|255
)paren
)paren
id|PARSE_ERROR1
suffix:semicolon
id|f-&gt;badmul
op_assign
id|par
suffix:semicolon
macro_line|#ifdef ISDN_TTY_FAX_STAT_DEBUG
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;isdn_tty: Fax FBADMUL=%d&bslash;n&quot;
comma
id|par
)paren
suffix:semicolon
macro_line|#endif
)brace
r_break
suffix:semicolon
r_default
suffix:colon
id|PARSE_ERROR1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* BOR=n - Phase C bit order, 0=direct, 1=reverse */
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|p
(braket
l_int|0
)braket
comma
l_string|&quot;BOR&quot;
comma
l_int|3
)paren
)paren
(brace
id|p
(braket
l_int|0
)braket
op_add_assign
l_int|3
suffix:semicolon
r_switch
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
)paren
(brace
r_case
l_char|&squot;?&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;&bslash;r&bslash;n%d&quot;
comma
id|f-&gt;bor
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_char|&squot;=&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
op_eq
l_char|&squot;?&squot;
)paren
(brace
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;&bslash;r&bslash;n0,1&quot;
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
)brace
r_else
(brace
id|par
op_assign
id|isdn_getnum
c_func
(paren
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|par
OL
l_int|0
)paren
op_logical_or
(paren
id|par
OG
l_int|1
)paren
)paren
id|PARSE_ERROR1
suffix:semicolon
id|f-&gt;bor
op_assign
id|par
suffix:semicolon
macro_line|#ifdef ISDN_TTY_FAX_STAT_DEBUG
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;isdn_tty: Fax FBOR=%d&bslash;n&quot;
comma
id|par
)paren
suffix:semicolon
macro_line|#endif
)brace
r_break
suffix:semicolon
r_default
suffix:colon
id|PARSE_ERROR1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* NBC=n - No Best Capabilities */
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|p
(braket
l_int|0
)braket
comma
l_string|&quot;NBC&quot;
comma
l_int|3
)paren
)paren
(brace
id|p
(braket
l_int|0
)braket
op_add_assign
l_int|3
suffix:semicolon
r_switch
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
)paren
(brace
r_case
l_char|&squot;?&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;&bslash;r&bslash;n%d&quot;
comma
id|f-&gt;nbc
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_char|&squot;=&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
op_eq
l_char|&squot;?&squot;
)paren
(brace
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;&bslash;r&bslash;n0,1&quot;
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
)brace
r_else
(brace
id|par
op_assign
id|isdn_getnum
c_func
(paren
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|par
OL
l_int|0
)paren
op_logical_or
(paren
id|par
OG
l_int|1
)paren
)paren
id|PARSE_ERROR1
suffix:semicolon
id|f-&gt;nbc
op_assign
id|par
suffix:semicolon
macro_line|#ifdef ISDN_TTY_FAX_STAT_DEBUG
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;isdn_tty: Fax FNBC=%d&bslash;n&quot;
comma
id|par
)paren
suffix:semicolon
macro_line|#endif
)brace
r_break
suffix:semicolon
r_default
suffix:colon
id|PARSE_ERROR1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* BUF? - Readonly buffersize readout  */
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|p
(braket
l_int|0
)braket
comma
l_string|&quot;BUF?&quot;
comma
l_int|4
)paren
)paren
(brace
id|p
(braket
l_int|0
)braket
op_add_assign
l_int|4
suffix:semicolon
macro_line|#ifdef ISDN_TTY_FAX_STAT_DEBUG
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;isdn_tty: Fax FBUF? (%d) &bslash;n&quot;
comma
(paren
l_int|16
op_star
id|m-&gt;mdmreg
(braket
id|REG_PSIZE
)braket
)paren
)paren
suffix:semicolon
macro_line|#endif
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;&bslash;r&bslash;n %d &quot;
comma
(paren
l_int|16
op_star
id|m-&gt;mdmreg
(braket
id|REG_PSIZE
)braket
)paren
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* CIG=string - local fax station id string for polling rx */
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|p
(braket
l_int|0
)braket
comma
l_string|&quot;CIG&quot;
comma
l_int|3
)paren
)paren
(brace
r_int
id|i
comma
id|r
suffix:semicolon
id|p
(braket
l_int|0
)braket
op_add_assign
l_int|3
suffix:semicolon
r_switch
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
)paren
(brace
r_case
l_char|&squot;?&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;&bslash;r&bslash;n&bslash;&quot;%s&bslash;&quot;&quot;
comma
id|f-&gt;pollid
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_char|&squot;=&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
op_eq
l_char|&squot;?&squot;
)paren
(brace
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;&bslash;r&bslash;n&bslash;&quot;STRING&bslash;&quot;&quot;
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
op_eq
l_char|&squot;&quot;&squot;
)paren
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
(paren
op_star
id|p
(braket
l_int|0
)braket
)paren
op_logical_and
id|i
OL
(paren
id|FAXIDLEN
op_minus
l_int|1
)paren
op_logical_and
(paren
op_star
id|p
(braket
l_int|0
)braket
op_ne
l_char|&squot;&quot;&squot;
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
id|f-&gt;pollid
(braket
id|i
)braket
op_assign
op_star
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
)brace
r_if
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
op_eq
l_char|&squot;&quot;&squot;
)paren
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
r_for
c_loop
(paren
id|r
op_assign
id|i
suffix:semicolon
id|r
OL
id|FAXIDLEN
suffix:semicolon
id|r
op_increment
)paren
(brace
id|f-&gt;pollid
(braket
id|r
)braket
op_assign
l_int|32
suffix:semicolon
)brace
id|f-&gt;pollid
(braket
id|FAXIDLEN
op_minus
l_int|1
)braket
op_assign
l_int|0
suffix:semicolon
macro_line|#ifdef ISDN_TTY_FAX_STAT_DEBUG
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;isdn_tty: Fax local poll ID rx &bslash;&quot;%s&bslash;&quot;&bslash;n&quot;
comma
id|f-&gt;pollid
)paren
suffix:semicolon
macro_line|#endif
)brace
r_break
suffix:semicolon
r_default
suffix:colon
id|PARSE_ERROR1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* CQ=n - copy qlty chk, 0= no chk, 1=only 1D chk, 2=1D+2D chk */
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|p
(braket
l_int|0
)braket
comma
l_string|&quot;CQ&quot;
comma
l_int|2
)paren
)paren
(brace
id|p
(braket
l_int|0
)braket
op_add_assign
l_int|2
suffix:semicolon
r_switch
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
)paren
(brace
r_case
l_char|&squot;?&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;&bslash;r&bslash;n%d&quot;
comma
id|f-&gt;cq
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_char|&squot;=&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
op_eq
l_char|&squot;?&squot;
)paren
(brace
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;&bslash;r&bslash;n0,1,2&quot;
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
)brace
r_else
(brace
id|par
op_assign
id|isdn_getnum
c_func
(paren
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|par
OL
l_int|0
)paren
op_logical_or
(paren
id|par
OG
l_int|2
)paren
)paren
id|PARSE_ERROR1
suffix:semicolon
id|f-&gt;cq
op_assign
id|par
suffix:semicolon
macro_line|#ifdef ISDN_TTY_FAX_STAT_DEBUG
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;isdn_tty: Fax FCQ=%d&bslash;n&quot;
comma
id|par
)paren
suffix:semicolon
macro_line|#endif
)brace
r_break
suffix:semicolon
r_default
suffix:colon
id|PARSE_ERROR1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* CR=n - can receive? 0= no data rx or poll remote dev, 1=do receive data or poll remote dev */
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|p
(braket
l_int|0
)braket
comma
l_string|&quot;CR&quot;
comma
l_int|2
)paren
)paren
(brace
id|p
(braket
l_int|0
)braket
op_add_assign
l_int|2
suffix:semicolon
r_switch
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
)paren
(brace
r_case
l_char|&squot;?&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;&bslash;r&bslash;n%d&quot;
comma
id|f-&gt;cr
)paren
suffix:semicolon
multiline_comment|/* read actual value from struct and print */
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_char|&squot;=&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
op_eq
l_char|&squot;?&squot;
)paren
(brace
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;&bslash;r&bslash;n0,1&quot;
)paren
suffix:semicolon
multiline_comment|/* display online help */
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
)brace
r_else
(brace
id|par
op_assign
id|isdn_getnum
c_func
(paren
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|par
OL
l_int|0
)paren
op_logical_or
(paren
id|par
OG
l_int|1
)paren
)paren
id|PARSE_ERROR1
suffix:semicolon
id|f-&gt;cr
op_assign
id|par
suffix:semicolon
macro_line|#ifdef ISDN_TTY_FAX_STAT_DEBUG
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;isdn_tty: Fax FCR=%d&bslash;n&quot;
comma
id|par
)paren
suffix:semicolon
macro_line|#endif
)brace
r_break
suffix:semicolon
r_default
suffix:colon
id|PARSE_ERROR1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* CTCRTY=value - ECM retry count */
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|p
(braket
l_int|0
)braket
comma
l_string|&quot;CTCRTY&quot;
comma
l_int|6
)paren
)paren
(brace
id|p
(braket
l_int|0
)braket
op_add_assign
l_int|6
suffix:semicolon
r_switch
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
)paren
(brace
r_case
l_char|&squot;?&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;&bslash;r&bslash;n%d&quot;
comma
id|f-&gt;ctcrty
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_char|&squot;=&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
op_eq
l_char|&squot;?&squot;
)paren
(brace
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;&bslash;r&bslash;n0-255&quot;
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
)brace
r_else
(brace
id|par
op_assign
id|isdn_getnum
c_func
(paren
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|par
OL
l_int|0
)paren
op_logical_or
(paren
id|par
OG
l_int|255
)paren
)paren
id|PARSE_ERROR1
suffix:semicolon
id|f-&gt;ctcrty
op_assign
id|par
suffix:semicolon
macro_line|#ifdef ISDN_TTY_FAX_STAT_DEBUG
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;isdn_tty: Fax FCTCRTY=%d&bslash;n&quot;
comma
id|par
)paren
suffix:semicolon
macro_line|#endif
)brace
r_break
suffix:semicolon
r_default
suffix:colon
id|PARSE_ERROR1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* DCC=vr,br,wd,ln,df,ec,bf,st - DCE capabilities parms */
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|p
(braket
l_int|0
)braket
comma
l_string|&quot;DCC&quot;
comma
l_int|3
)paren
)paren
(brace
r_char
op_star
id|rp
op_assign
op_amp
id|f-&gt;resolution
suffix:semicolon
r_int
id|i
suffix:semicolon
id|p
(braket
l_int|0
)braket
op_add_assign
l_int|3
suffix:semicolon
r_switch
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
)paren
(brace
r_case
l_char|&squot;?&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|strcpy
c_func
(paren
id|rs
comma
l_string|&quot;&bslash;r&bslash;n&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|8
suffix:semicolon
id|i
op_increment
)paren
(brace
id|sprintf
c_func
(paren
id|rss
comma
l_string|&quot;%c%s&quot;
comma
id|rp
(braket
id|i
)braket
op_plus
l_int|48
comma
(paren
id|i
OL
l_int|7
)paren
ques
c_cond
l_string|&quot;,&quot;
suffix:colon
l_string|&quot;&quot;
)paren
suffix:semicolon
id|strcat
c_func
(paren
id|rs
comma
id|rss
)paren
suffix:semicolon
)brace
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_char|&squot;=&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
op_eq
l_char|&squot;?&squot;
)paren
(brace
id|isdn_tty_at_cout
c_func
(paren
l_string|&quot;&bslash;r&bslash;n(0,1),(0-5),(0-2),(0-2),(0-3),(0-2),(0),(0-7)&quot;
comma
id|info
)paren
suffix:semicolon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
)brace
r_else
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
(paren
(paren
(paren
op_star
id|p
(braket
l_int|0
)braket
op_ge
l_char|&squot;0&squot;
)paren
op_logical_and
(paren
op_star
id|p
(braket
l_int|0
)braket
op_le
l_char|&squot;9&squot;
)paren
)paren
op_logical_or
(paren
op_star
id|p
(braket
l_int|0
)braket
op_eq
l_char|&squot;,&squot;
)paren
)paren
op_logical_and
(paren
id|i
OL
l_int|8
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
op_ne
l_char|&squot;,&squot;
)paren
(brace
r_if
c_cond
(paren
(paren
op_star
id|p
(braket
l_int|0
)braket
op_minus
l_int|48
)paren
OG
id|maxdccval
(braket
id|i
)braket
)paren
(brace
id|PARSE_ERROR1
suffix:semicolon
)brace
id|rp
(braket
id|i
)braket
op_assign
op_star
id|p
(braket
l_int|0
)braket
op_minus
l_int|48
suffix:semicolon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
op_eq
l_char|&squot;,&squot;
)paren
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
)brace
r_else
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
)brace
macro_line|#ifdef ISDN_TTY_FAX_STAT_DEBUG
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;isdn_tty: Fax FDCC capabilities DCE=%d,%d,%d,%d,%d,%d,%d,%d&bslash;n&quot;
comma
id|rp
(braket
l_int|0
)braket
comma
id|rp
(braket
l_int|1
)braket
comma
id|rp
(braket
l_int|2
)braket
comma
id|rp
(braket
l_int|3
)braket
comma
id|rp
(braket
l_int|4
)braket
comma
id|rp
(braket
l_int|5
)braket
comma
id|rp
(braket
l_int|6
)braket
comma
id|rp
(braket
l_int|7
)braket
)paren
suffix:semicolon
macro_line|#endif
)brace
r_break
suffix:semicolon
r_default
suffix:colon
id|PARSE_ERROR1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* DIS=vr,br,wd,ln,df,ec,bf,st - current session parms */
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|p
(braket
l_int|0
)braket
comma
l_string|&quot;DIS&quot;
comma
l_int|3
)paren
)paren
(brace
r_char
op_star
id|rp
op_assign
op_amp
id|f-&gt;resolution
suffix:semicolon
r_int
id|i
suffix:semicolon
id|p
(braket
l_int|0
)braket
op_add_assign
l_int|3
suffix:semicolon
r_switch
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
)paren
(brace
r_case
l_char|&squot;?&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|strcpy
c_func
(paren
id|rs
comma
l_string|&quot;&bslash;r&bslash;n&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|8
suffix:semicolon
id|i
op_increment
)paren
(brace
id|sprintf
c_func
(paren
id|rss
comma
l_string|&quot;%c%s&quot;
comma
id|rp
(braket
id|i
)braket
op_plus
l_int|48
comma
(paren
id|i
OL
l_int|7
)paren
ques
c_cond
l_string|&quot;,&quot;
suffix:colon
l_string|&quot;&quot;
)paren
suffix:semicolon
id|strcat
c_func
(paren
id|rs
comma
id|rss
)paren
suffix:semicolon
)brace
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_char|&squot;=&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
op_eq
l_char|&squot;?&squot;
)paren
(brace
id|isdn_tty_at_cout
c_func
(paren
l_string|&quot;&bslash;r&bslash;n(0,1),(0-5),(0-2),(0-2),(0-3),(0-2),(0),(0-7)&quot;
comma
id|info
)paren
suffix:semicolon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
)brace
r_else
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
(paren
(paren
(paren
op_star
id|p
(braket
l_int|0
)braket
op_ge
l_char|&squot;0&squot;
)paren
op_logical_and
(paren
op_star
id|p
(braket
l_int|0
)braket
op_le
l_char|&squot;9&squot;
)paren
)paren
op_logical_or
(paren
op_star
id|p
(braket
l_int|0
)braket
op_eq
l_char|&squot;,&squot;
)paren
)paren
op_logical_and
(paren
id|i
OL
l_int|8
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
op_ne
l_char|&squot;,&squot;
)paren
(brace
r_if
c_cond
(paren
(paren
op_star
id|p
(braket
l_int|0
)braket
op_minus
l_int|48
)paren
OG
id|maxdccval
(braket
id|i
)braket
)paren
(brace
id|PARSE_ERROR1
suffix:semicolon
)brace
id|rp
(braket
id|i
)braket
op_assign
op_star
id|p
(braket
l_int|0
)braket
op_minus
l_int|48
suffix:semicolon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
op_eq
l_char|&squot;,&squot;
)paren
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
)brace
r_else
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
)brace
macro_line|#ifdef ISDN_TTY_FAX_STAT_DEBUG
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;isdn_tty: Fax FDIS session parms=%d,%d,%d,%d,%d,%d,%d,%d&bslash;n&quot;
comma
id|rp
(braket
l_int|0
)braket
comma
id|rp
(braket
l_int|1
)braket
comma
id|rp
(braket
l_int|2
)braket
comma
id|rp
(braket
l_int|3
)braket
comma
id|rp
(braket
l_int|4
)braket
comma
id|rp
(braket
l_int|5
)braket
comma
id|rp
(braket
l_int|6
)braket
comma
id|rp
(braket
l_int|7
)braket
)paren
suffix:semicolon
macro_line|#endif
)brace
r_break
suffix:semicolon
r_default
suffix:colon
id|PARSE_ERROR1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* DR - Receive Phase C data command, initiates document reception */
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|p
(braket
l_int|0
)braket
comma
l_string|&quot;DR&quot;
comma
l_int|2
)paren
)paren
(brace
id|p
(braket
l_int|0
)braket
op_add_assign
l_int|2
suffix:semicolon
r_if
c_cond
(paren
(paren
id|info-&gt;faxonline
op_amp
l_int|16
)paren
op_logical_and
multiline_comment|/* incoming connection */
(paren
(paren
id|f-&gt;phase
op_eq
id|ISDN_FAX_PHASE_B
)paren
op_logical_or
(paren
id|f-&gt;phase
op_eq
id|ISDN_FAX_PHASE_D
)paren
)paren
)paren
(brace
macro_line|#ifdef ISDN_TTY_FAX_STAT_DEBUG
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;isdn_tty: Fax FDR&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#endif
id|f-&gt;code
op_assign
id|ISDN_TTY_FAX_DR
suffix:semicolon
id|cmd.driver
op_assign
id|info-&gt;isdn_driver
suffix:semicolon
id|cmd.arg
op_assign
id|info-&gt;isdn_channel
suffix:semicolon
id|cmd.command
op_assign
id|ISDN_CMD_FAXCMD
suffix:semicolon
id|isdn_command
c_func
(paren
op_amp
id|cmd
)paren
suffix:semicolon
r_if
c_cond
(paren
id|f-&gt;phase
op_eq
id|ISDN_FAX_PHASE_B
)paren
(brace
id|f-&gt;phase
op_assign
id|ISDN_FAX_PHASE_C
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|f-&gt;phase
op_eq
id|ISDN_FAX_PHASE_D
)paren
(brace
r_switch
c_cond
(paren
id|f-&gt;fet
)paren
(brace
r_case
l_int|0
suffix:colon
multiline_comment|/* next page will be received */
id|f-&gt;phase
op_assign
id|ISDN_FAX_PHASE_C
suffix:semicolon
id|isdn_tty_fax_modem_result
c_func
(paren
l_int|7
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* CONNECT */
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
multiline_comment|/* next doc will be received */
id|f-&gt;phase
op_assign
id|ISDN_FAX_PHASE_B
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
multiline_comment|/* fax session is terminating */
id|f-&gt;phase
op_assign
id|ISDN_FAX_PHASE_E
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|PARSE_ERROR1
suffix:semicolon
)brace
)brace
)brace
r_else
(brace
id|PARSE_ERROR1
suffix:semicolon
)brace
r_return
l_int|1
suffix:semicolon
)brace
multiline_comment|/* DT=df,vr,wd,ln - TX phase C data command (release DCE to proceed with negotiation) */
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|p
(braket
l_int|0
)braket
comma
l_string|&quot;DT&quot;
comma
l_int|2
)paren
)paren
(brace
r_int
id|i
comma
id|val
(braket
)braket
op_assign
(brace
l_int|4
comma
l_int|0
comma
l_int|2
comma
l_int|3
)brace
suffix:semicolon
r_char
op_star
id|rp
op_assign
op_amp
id|f-&gt;resolution
suffix:semicolon
id|p
(braket
l_int|0
)braket
op_add_assign
l_int|2
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|info-&gt;faxonline
op_amp
l_int|1
)paren
multiline_comment|/* not outgoing connection */
id|PARSE_ERROR1
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
(paren
(paren
(paren
op_star
id|p
(braket
l_int|0
)braket
op_ge
l_char|&squot;0&squot;
)paren
op_logical_and
(paren
op_star
id|p
(braket
l_int|0
)braket
op_le
l_char|&squot;9&squot;
)paren
)paren
op_logical_or
(paren
op_star
id|p
(braket
l_int|0
)braket
op_eq
l_char|&squot;,&squot;
)paren
)paren
op_logical_and
(paren
id|i
OL
l_int|4
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
op_ne
l_char|&squot;,&squot;
)paren
(brace
r_if
c_cond
(paren
(paren
op_star
id|p
(braket
l_int|0
)braket
op_minus
l_int|48
)paren
OG
id|maxdccval
(braket
id|val
(braket
id|i
)braket
)braket
)paren
(brace
id|PARSE_ERROR1
suffix:semicolon
)brace
id|rp
(braket
id|val
(braket
id|i
)braket
)braket
op_assign
op_star
id|p
(braket
l_int|0
)braket
op_minus
l_int|48
suffix:semicolon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
op_eq
l_char|&squot;,&squot;
)paren
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
)brace
r_else
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
)brace
macro_line|#ifdef ISDN_TTY_FAX_STAT_DEBUG
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;isdn_tty: Fax FDT tx data command parms=%d,%d,%d,%d&bslash;n&quot;
comma
id|rp
(braket
l_int|4
)braket
comma
id|rp
(braket
l_int|0
)braket
comma
id|rp
(braket
l_int|2
)braket
comma
id|rp
(braket
l_int|3
)braket
)paren
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
(paren
id|f-&gt;phase
op_eq
id|ISDN_FAX_PHASE_B
)paren
op_logical_or
(paren
id|f-&gt;phase
op_eq
id|ISDN_FAX_PHASE_D
)paren
)paren
(brace
id|f-&gt;code
op_assign
id|ISDN_TTY_FAX_DT
suffix:semicolon
id|cmd.driver
op_assign
id|info-&gt;isdn_driver
suffix:semicolon
id|cmd.arg
op_assign
id|info-&gt;isdn_channel
suffix:semicolon
id|cmd.command
op_assign
id|ISDN_CMD_FAXCMD
suffix:semicolon
id|isdn_command
c_func
(paren
op_amp
id|cmd
)paren
suffix:semicolon
r_if
c_cond
(paren
id|f-&gt;phase
op_eq
id|ISDN_FAX_PHASE_D
)paren
(brace
id|f-&gt;phase
op_assign
id|ISDN_FAX_PHASE_C
suffix:semicolon
id|isdn_tty_fax_modem_result
c_func
(paren
l_int|7
comma
id|info
)paren
suffix:semicolon
multiline_comment|/* CONNECT */
)brace
)brace
r_else
(brace
id|PARSE_ERROR1
suffix:semicolon
)brace
r_return
l_int|1
suffix:semicolon
)brace
multiline_comment|/* ECM=n - Error mode control 0=disabled, 2=enabled, handled by DCE alone incl. buff of partial pages */
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|p
(braket
l_int|0
)braket
comma
l_string|&quot;ECM&quot;
comma
l_int|3
)paren
)paren
(brace
id|p
(braket
l_int|0
)braket
op_add_assign
l_int|3
suffix:semicolon
r_switch
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
)paren
(brace
r_case
l_char|&squot;?&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;&bslash;r&bslash;n%d&quot;
comma
id|f-&gt;ecm
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_char|&squot;=&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
op_eq
l_char|&squot;?&squot;
)paren
(brace
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;&bslash;r&bslash;n0,2&quot;
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
)brace
r_else
(brace
id|par
op_assign
id|isdn_getnum
c_func
(paren
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|par
op_ne
l_int|0
)paren
op_logical_and
(paren
id|par
op_ne
l_int|2
)paren
)paren
id|PARSE_ERROR1
suffix:semicolon
id|f-&gt;ecm
op_assign
id|par
suffix:semicolon
macro_line|#ifdef ISDN_TTY_FAX_STAT_DEBUG
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;isdn_tty: Fax FECM=%d&bslash;n&quot;
comma
id|par
)paren
suffix:semicolon
macro_line|#endif
)brace
r_break
suffix:semicolon
r_default
suffix:colon
id|PARSE_ERROR1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* ET=n - End of page or document */
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|p
(braket
l_int|0
)braket
comma
l_string|&quot;ET=&quot;
comma
l_int|3
)paren
)paren
(brace
id|p
(braket
l_int|0
)braket
op_add_assign
l_int|3
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
op_eq
l_char|&squot;?&squot;
)paren
(brace
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;&bslash;r&bslash;n0-2&quot;
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
(paren
id|f-&gt;phase
op_ne
id|ISDN_FAX_PHASE_D
)paren
op_logical_or
(paren
op_logical_neg
id|info-&gt;faxonline
op_amp
l_int|1
)paren
)paren
id|PARSE_ERROR1
suffix:semicolon
id|par
op_assign
id|isdn_getnum
c_func
(paren
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|par
OL
l_int|0
)paren
op_logical_or
(paren
id|par
OG
l_int|2
)paren
)paren
id|PARSE_ERROR1
suffix:semicolon
id|f-&gt;fet
op_assign
id|par
suffix:semicolon
id|f-&gt;code
op_assign
id|ISDN_TTY_FAX_ET
suffix:semicolon
id|cmd.driver
op_assign
id|info-&gt;isdn_driver
suffix:semicolon
id|cmd.arg
op_assign
id|info-&gt;isdn_channel
suffix:semicolon
id|cmd.command
op_assign
id|ISDN_CMD_FAXCMD
suffix:semicolon
id|isdn_command
c_func
(paren
op_amp
id|cmd
)paren
suffix:semicolon
macro_line|#ifdef ISDN_TTY_FAX_STAT_DEBUG
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;isdn_tty: Fax FET=%d&bslash;n&quot;
comma
id|par
)paren
suffix:semicolon
macro_line|#endif
r_return
l_int|1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* K - terminate */
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|p
(braket
l_int|0
)braket
comma
l_string|&quot;K&quot;
comma
l_int|1
)paren
)paren
(brace
id|p
(braket
l_int|0
)braket
op_add_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
(paren
id|f-&gt;phase
op_eq
id|ISDN_FAX_PHASE_IDLE
)paren
op_logical_or
(paren
id|f-&gt;phase
op_eq
id|ISDN_FAX_PHASE_E
)paren
)paren
id|PARSE_ERROR1
suffix:semicolon
id|isdn_tty_modem_hup
c_func
(paren
id|info
comma
l_int|1
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
multiline_comment|/* LID=string - local fax ID */
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|p
(braket
l_int|0
)braket
comma
l_string|&quot;LID&quot;
comma
l_int|3
)paren
)paren
(brace
r_int
id|i
comma
id|r
suffix:semicolon
id|p
(braket
l_int|0
)braket
op_add_assign
l_int|3
suffix:semicolon
r_switch
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
)paren
(brace
r_case
l_char|&squot;?&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;&bslash;r&bslash;n&bslash;&quot;%s&bslash;&quot;&quot;
comma
id|f-&gt;id
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_char|&squot;=&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
op_eq
l_char|&squot;?&squot;
)paren
(brace
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;&bslash;r&bslash;n&bslash;&quot;STRING&bslash;&quot;&quot;
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
op_eq
l_char|&squot;&quot;&squot;
)paren
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
(paren
op_star
id|p
(braket
l_int|0
)braket
)paren
op_logical_and
id|i
OL
(paren
id|FAXIDLEN
op_minus
l_int|1
)paren
op_logical_and
(paren
op_star
id|p
(braket
l_int|0
)braket
op_ne
l_char|&squot;&quot;&squot;
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
id|f-&gt;id
(braket
id|i
)braket
op_assign
op_star
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
)brace
r_if
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
op_eq
l_char|&squot;&quot;&squot;
)paren
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
r_for
c_loop
(paren
id|r
op_assign
id|i
suffix:semicolon
id|r
OL
id|FAXIDLEN
suffix:semicolon
id|r
op_increment
)paren
(brace
id|f-&gt;id
(braket
id|r
)braket
op_assign
l_int|32
suffix:semicolon
)brace
id|f-&gt;id
(braket
id|FAXIDLEN
op_minus
l_int|1
)braket
op_assign
l_int|0
suffix:semicolon
macro_line|#ifdef ISDN_TTY_FAX_STAT_DEBUG
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;isdn_tty: Fax local ID &bslash;&quot;%s&bslash;&quot;&bslash;n&quot;
comma
id|f-&gt;id
)paren
suffix:semicolon
macro_line|#endif
)brace
r_break
suffix:semicolon
r_default
suffix:colon
id|PARSE_ERROR1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* MDL? - DCE Model       */
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|p
(braket
l_int|0
)braket
comma
l_string|&quot;MDL?&quot;
comma
l_int|4
)paren
)paren
(brace
id|p
(braket
l_int|0
)braket
op_add_assign
l_int|4
suffix:semicolon
macro_line|#ifdef ISDN_TTY_FAX_STAT_DEBUG
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;isdn_tty: FMDL?&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#endif
id|isdn_tty_at_cout
c_func
(paren
l_string|&quot;&bslash;r&bslash;nisdn4linux&quot;
comma
id|info
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* MFR? - DCE Manufacturer */
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|p
(braket
l_int|0
)braket
comma
l_string|&quot;MFR?&quot;
comma
l_int|4
)paren
)paren
(brace
id|p
(braket
l_int|0
)braket
op_add_assign
l_int|4
suffix:semicolon
macro_line|#ifdef ISDN_TTY_FAX_STAT_DEBUG
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;isdn_tty: FMFR?&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#endif
id|isdn_tty_at_cout
c_func
(paren
l_string|&quot;&bslash;r&bslash;nisdn4linux&quot;
comma
id|info
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* MINSP=n - Minimum Speed for Phase C */
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|p
(braket
l_int|0
)braket
comma
l_string|&quot;MINSP&quot;
comma
l_int|5
)paren
)paren
(brace
id|p
(braket
l_int|0
)braket
op_add_assign
l_int|5
suffix:semicolon
r_switch
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
)paren
(brace
r_case
l_char|&squot;?&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;&bslash;r&bslash;n%d&quot;
comma
id|f-&gt;minsp
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_char|&squot;=&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
op_eq
l_char|&squot;?&squot;
)paren
(brace
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;&bslash;r&bslash;n0-5&quot;
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
)brace
r_else
(brace
id|par
op_assign
id|isdn_getnum
c_func
(paren
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|par
OL
l_int|0
)paren
op_logical_or
(paren
id|par
OG
l_int|5
)paren
)paren
id|PARSE_ERROR1
suffix:semicolon
id|f-&gt;minsp
op_assign
id|par
suffix:semicolon
macro_line|#ifdef ISDN_TTY_FAX_STAT_DEBUG
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;isdn_tty: Fax FMINSP=%d&bslash;n&quot;
comma
id|par
)paren
suffix:semicolon
macro_line|#endif
)brace
r_break
suffix:semicolon
r_default
suffix:colon
id|PARSE_ERROR1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* PHCTO=value - DTE phase C timeout */
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|p
(braket
l_int|0
)braket
comma
l_string|&quot;PHCTO&quot;
comma
l_int|5
)paren
)paren
(brace
id|p
(braket
l_int|0
)braket
op_add_assign
l_int|5
suffix:semicolon
r_switch
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
)paren
(brace
r_case
l_char|&squot;?&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;&bslash;r&bslash;n%d&quot;
comma
id|f-&gt;phcto
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_char|&squot;=&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
op_eq
l_char|&squot;?&squot;
)paren
(brace
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;&bslash;r&bslash;n0-255&quot;
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
)brace
r_else
(brace
id|par
op_assign
id|isdn_getnum
c_func
(paren
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|par
OL
l_int|0
)paren
op_logical_or
(paren
id|par
OG
l_int|255
)paren
)paren
id|PARSE_ERROR1
suffix:semicolon
id|f-&gt;phcto
op_assign
id|par
suffix:semicolon
macro_line|#ifdef ISDN_TTY_FAX_STAT_DEBUG
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;isdn_tty: Fax FPHCTO=%d&bslash;n&quot;
comma
id|par
)paren
suffix:semicolon
macro_line|#endif
)brace
r_break
suffix:semicolon
r_default
suffix:colon
id|PARSE_ERROR1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* REL=n - Phase C received EOL alignment */
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|p
(braket
l_int|0
)braket
comma
l_string|&quot;REL&quot;
comma
l_int|3
)paren
)paren
(brace
id|p
(braket
l_int|0
)braket
op_add_assign
l_int|3
suffix:semicolon
r_switch
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
)paren
(brace
r_case
l_char|&squot;?&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;&bslash;r&bslash;n%d&quot;
comma
id|f-&gt;rel
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_char|&squot;=&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
op_eq
l_char|&squot;?&squot;
)paren
(brace
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;&bslash;r&bslash;n0,1&quot;
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
)brace
r_else
(brace
id|par
op_assign
id|isdn_getnum
c_func
(paren
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|par
OL
l_int|0
)paren
op_logical_or
(paren
id|par
OG
l_int|1
)paren
)paren
id|PARSE_ERROR1
suffix:semicolon
id|f-&gt;rel
op_assign
id|par
suffix:semicolon
macro_line|#ifdef ISDN_TTY_FAX_STAT_DEBUG
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;isdn_tty: Fax FREL=%d&bslash;n&quot;
comma
id|par
)paren
suffix:semicolon
macro_line|#endif
)brace
r_break
suffix:semicolon
r_default
suffix:colon
id|PARSE_ERROR1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* REV? - DCE Revision */
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|p
(braket
l_int|0
)braket
comma
l_string|&quot;REV?&quot;
comma
l_int|4
)paren
)paren
(brace
id|p
(braket
l_int|0
)braket
op_add_assign
l_int|4
suffix:semicolon
macro_line|#ifdef ISDN_TTY_FAX_STAT_DEBUG
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;isdn_tty: FREV?&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#endif
id|strcpy
c_func
(paren
id|rss
comma
id|isdn_tty_fax_revision
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|rs
comma
l_string|&quot;&bslash;r&bslash;nRev: %s&quot;
comma
id|isdn_getrev
c_func
(paren
id|rss
)paren
)paren
suffix:semicolon
id|isdn_tty_at_cout
c_func
(paren
id|rs
comma
id|info
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* Phase C Transmit Data Block Size */
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|p
(braket
l_int|0
)braket
comma
l_string|&quot;TBC=&quot;
comma
l_int|4
)paren
)paren
(brace
multiline_comment|/* dummy, not used */
id|p
(braket
l_int|0
)braket
op_add_assign
l_int|4
suffix:semicolon
macro_line|#ifdef ISDN_TTY_FAX_STAT_DEBUG
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;isdn_tty: Fax FTBC=%c&bslash;n&quot;
comma
op_star
id|p
(braket
l_int|0
)braket
)paren
suffix:semicolon
macro_line|#endif
r_switch
c_cond
(paren
op_star
id|p
(braket
l_int|0
)braket
)paren
(brace
r_case
l_char|&squot;0&squot;
suffix:colon
id|p
(braket
l_int|0
)braket
op_increment
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|PARSE_ERROR1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;isdn_tty: unknown token=&gt;AT+F%s&lt;&bslash;n&quot;
comma
id|p
(braket
l_int|0
)braket
)paren
suffix:semicolon
id|PARSE_ERROR1
suffix:semicolon
)brace
r_int
DECL|function|isdn_tty_cmd_PLUSF_FAX
id|isdn_tty_cmd_PLUSF_FAX
c_func
(paren
r_char
op_star
op_star
id|p
comma
id|modem_info
op_star
id|info
)paren
(brace
r_if
c_cond
(paren
id|TTY_IS_FCLASS2
c_func
(paren
id|info
)paren
)paren
r_return
(paren
id|isdn_tty_cmd_FCLASS2
c_func
(paren
id|p
comma
id|info
)paren
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|TTY_IS_FCLASS1
c_func
(paren
id|info
)paren
)paren
r_return
(paren
id|isdn_tty_cmd_FCLASS1
c_func
(paren
id|p
comma
id|info
)paren
)paren
suffix:semicolon
id|PARSE_ERROR1
suffix:semicolon
)brace
eof
