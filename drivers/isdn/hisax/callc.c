multiline_comment|/* $Id: callc.c,v 2.13 1998/02/12 23:07:16 keil Exp $&n;&n; * Author       Karsten Keil (keil@temic-ech.spacenet.de)&n; *              based on the teles driver from Jan den Ouden&n; *&n; * Thanks to    Jan den Ouden&n; *              Fritz Elfert&n; *&n; * $Log: callc.c,v $&n; * Revision 2.13  1998/02/12 23:07:16  keil&n; * change for 2.1.86 (removing FREE_READ/FREE_WRITE from [dev]_kfree_skb()&n; *&n; * Revision 2.12  1998/02/09 10:55:54  keil&n; * New leased line mode&n; *&n; * Revision 2.11  1998/02/02 13:35:19  keil&n; * config B-channel delay&n; *&n; * Revision 2.10  1997/11/06 17:09:15  keil&n; * New 2.1 init code&n; *&n; * Revision 2.9  1997/10/29 19:01:58  keil&n; * new LL interface&n; *&n; * Revision 2.8  1997/10/10 20:56:44  fritz&n; * New HL interface.&n; *&n; * Revision 2.7  1997/10/01 09:21:28  fritz&n; * Removed old compatibility stuff for 2.0.X kernels.&n; * From now on, this code is for 2.1.X ONLY!&n; * Old stuff is still in the separate branch.&n; *&n; * Revision 2.6  1997/09/11 17:26:58  keil&n; * Open B-channel if here are incomming packets&n; *&n; * Revision 2.5  1997/08/07 17:46:05  keil&n; * Fix Incomming Call without broadcast&n; *&n; * Revision 2.4  1997/08/03 14:37:58  keil&n; * Activate Layer2 in PtP mode&n; *&n; * Revision 2.3  1997/07/31 19:23:40  keil&n; * LAYER2_WATCHING for PtP&n; *&n; * Revision 2.2  1997/07/31 11:48:18  keil&n; * experimental REJECT after ALERTING&n; *&n; * Revision 2.1  1997/07/30 17:12:59  keil&n; * more changes for &squot;One TEI per card&squot;&n; *&n; * Revision 2.0  1997/07/27 21:12:21  keil&n; * CRef based L3; new channel handling; many other stuff&n; *&n; * Revision 1.31  1997/06/26 11:09:23  keil&n; * New managment and minor changes&n; *&n; * old logs removed /KKe&n; *&n; */
DECL|macro|__NO_VERSION__
mdefine_line|#define __NO_VERSION__
macro_line|#include &quot;hisax.h&quot;
macro_line|#ifdef MODULE
DECL|macro|MOD_USE_COUNT
mdefine_line|#define MOD_USE_COUNT ( GET_USE_COUNT (&amp;__this_module))
macro_line|#endif&t;&t;&t;&t;/* MODULE */
DECL|variable|lli_revision
r_const
r_char
op_star
id|lli_revision
op_assign
l_string|&quot;$Revision: 2.13 $&quot;
suffix:semicolon
r_extern
r_struct
id|IsdnCard
id|cards
(braket
)braket
suffix:semicolon
r_extern
r_int
id|nrcards
suffix:semicolon
r_extern
r_void
id|HiSax_mod_dec_use_count
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_void
id|HiSax_mod_inc_use_count
c_func
(paren
r_void
)paren
suffix:semicolon
r_static
r_int
id|init_b_st
c_func
(paren
r_struct
id|Channel
op_star
id|chanp
comma
r_int
id|incoming
)paren
suffix:semicolon
r_static
r_void
id|release_b_st
c_func
(paren
r_struct
id|Channel
op_star
id|chanp
)paren
suffix:semicolon
DECL|variable|callcfsm
r_static
r_struct
id|Fsm
id|callcfsm
op_assign
(brace
l_int|NULL
comma
l_int|0
comma
l_int|0
comma
l_int|NULL
comma
l_int|NULL
)brace
suffix:semicolon
DECL|variable|lcfsm
r_static
r_struct
id|Fsm
id|lcfsm
op_assign
(brace
l_int|NULL
comma
l_int|0
comma
l_int|0
comma
l_int|NULL
comma
l_int|NULL
)brace
suffix:semicolon
DECL|variable|chancount
r_static
r_int
id|chancount
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* experimental REJECT after ALERTING for CALLBACK to beat the 4s delay */
DECL|macro|ALERT_REJECT
mdefine_line|#define ALERT_REJECT 1
multiline_comment|/* Value to delay the sending of the first B-channel paket after CONNECT&n; * here is no value given by ITU, but experience shows that 300 ms will&n; * work on many networks, if you or your other side is behind local exchanges&n; * a greater value may be recommented. If the delay is to short the first paket&n; * will be lost and autodetect on many comercial routers goes wrong !&n; * You can adjust this value on runtime with &n; * hisaxctrl &lt;id&gt; 2 &lt;value&gt;&n; * value is in milliseconds&n; */
DECL|macro|DEFAULT_B_DELAY
mdefine_line|#define DEFAULT_B_DELAY&t;300
multiline_comment|/* Flags for remembering action done in lli */
DECL|macro|FLG_START_D
mdefine_line|#define  FLG_START_D&t;0
DECL|macro|FLG_ESTAB_D
mdefine_line|#define  FLG_ESTAB_D&t;1
DECL|macro|FLG_CALL_SEND
mdefine_line|#define  FLG_CALL_SEND&t;2
DECL|macro|FLG_CALL_REC
mdefine_line|#define  FLG_CALL_REC   3
DECL|macro|FLG_CALL_ALERT
mdefine_line|#define  FLG_CALL_ALERT&t;4
DECL|macro|FLG_START_B
mdefine_line|#define  FLG_START_B&t;5
DECL|macro|FLG_CONNECT_B
mdefine_line|#define  FLG_CONNECT_B&t;6
DECL|macro|FLG_LL_DCONN
mdefine_line|#define  FLG_LL_DCONN&t;7
DECL|macro|FLG_LL_BCONN
mdefine_line|#define  FLG_LL_BCONN&t;8
DECL|macro|FLG_DISC_SEND
mdefine_line|#define  FLG_DISC_SEND&t;9
DECL|macro|FLG_DISC_REC
mdefine_line|#define  FLG_DISC_REC&t;10
DECL|macro|FLG_REL_REC
mdefine_line|#define  FLG_REL_REC&t;11
DECL|macro|FLG_DO_ALERT
mdefine_line|#define  FLG_DO_ALERT&t;12
DECL|macro|FLG_DO_HANGUP
mdefine_line|#define  FLG_DO_HANGUP&t;13
DECL|macro|FLG_DO_CONNECT
mdefine_line|#define  FLG_DO_CONNECT&t;14
DECL|macro|FLG_DO_ESTAB
mdefine_line|#define  FLG_DO_ESTAB&t;15
multiline_comment|/*&n; * Because of callback it&squot;s a good idea to delay the shutdown of the d-channel&n; */
DECL|macro|DREL_TIMER_VALUE
mdefine_line|#define&t;DREL_TIMER_VALUE 10000
multiline_comment|/*&n; * Find card with given driverId&n; */
r_static
r_inline
r_struct
id|IsdnCardState
op_star
DECL|function|hisax_findcard
id|hisax_findcard
c_func
(paren
r_int
id|driverid
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|nrcards
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|cards
(braket
id|i
)braket
dot
id|cs
)paren
r_if
c_cond
(paren
id|cards
(braket
id|i
)braket
dot
id|cs-&gt;myid
op_eq
id|driverid
)paren
r_return
(paren
id|cards
(braket
id|i
)braket
dot
id|cs
)paren
suffix:semicolon
r_return
(paren
r_struct
id|IsdnCardState
op_star
)paren
l_int|0
suffix:semicolon
)brace
r_static
r_void
DECL|function|link_debug
id|link_debug
c_func
(paren
r_struct
id|Channel
op_star
id|chanp
comma
r_char
op_star
id|s
comma
r_int
id|direction
)paren
(brace
r_char
id|tmp
(braket
l_int|100
)braket
comma
id|tm
(braket
l_int|32
)braket
suffix:semicolon
id|jiftime
c_func
(paren
id|tm
comma
id|jiffies
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;%s Channel %d %s %s&bslash;n&quot;
comma
id|tm
comma
id|chanp-&gt;chan
comma
id|direction
ques
c_cond
l_string|&quot;LL-&gt;HL&quot;
suffix:colon
l_string|&quot;HL-&gt;LL&quot;
comma
id|s
)paren
suffix:semicolon
id|HiSax_putstatus
c_func
(paren
id|chanp-&gt;cs
comma
id|tmp
)paren
suffix:semicolon
)brace
r_enum
(brace
DECL|enumerator|ST_NULL
id|ST_NULL
comma
multiline_comment|/*  0 inactive */
DECL|enumerator|ST_OUT_WAIT_D
id|ST_OUT_WAIT_D
comma
multiline_comment|/*  1 outgoing, awaiting d-channel establishment */
DECL|enumerator|ST_IN_WAIT_D
id|ST_IN_WAIT_D
comma
multiline_comment|/*  2 incoming, awaiting d-channel establishment */
DECL|enumerator|ST_OUT_DIAL
id|ST_OUT_DIAL
comma
multiline_comment|/*  3 outgoing, SETUP send; awaiting confirm */
DECL|enumerator|ST_IN_WAIT_LL
id|ST_IN_WAIT_LL
comma
multiline_comment|/*  4 incoming call received; wait for LL confirm */
DECL|enumerator|ST_IN_ALERT_SEND
id|ST_IN_ALERT_SEND
comma
multiline_comment|/*  5 incoming call received; ALERT send */
DECL|enumerator|ST_IN_WAIT_CONN_ACK
id|ST_IN_WAIT_CONN_ACK
comma
multiline_comment|/*  6 incoming CONNECT send; awaiting CONN_ACK */
DECL|enumerator|ST_WAIT_BCONN
id|ST_WAIT_BCONN
comma
multiline_comment|/*  7 CONNECT/CONN_ACK received, awaiting b-channel prot. estbl. */
DECL|enumerator|ST_ACTIVE
id|ST_ACTIVE
comma
multiline_comment|/*  8 active, b channel prot. established */
DECL|enumerator|ST_WAIT_BRELEASE
id|ST_WAIT_BRELEASE
comma
multiline_comment|/*  9 call clear. (initiator), awaiting b channel prot. rel. */
DECL|enumerator|ST_WAIT_BREL_DISC
id|ST_WAIT_BREL_DISC
comma
multiline_comment|/* 10 call clear. (receiver), DISCONNECT req. received */
DECL|enumerator|ST_WAIT_DCOMMAND
id|ST_WAIT_DCOMMAND
comma
multiline_comment|/* 11 call clear. (receiver), awaiting DCHANNEL message */
DECL|enumerator|ST_WAIT_DRELEASE
id|ST_WAIT_DRELEASE
comma
multiline_comment|/* 12 DISCONNECT sent, awaiting RELEASE */
DECL|enumerator|ST_WAIT_D_REL_CNF
id|ST_WAIT_D_REL_CNF
comma
multiline_comment|/* 13 RELEASE sent, awaiting RELEASE confirm */
DECL|enumerator|ST_WAIT_DSHUTDOWN
id|ST_WAIT_DSHUTDOWN
comma
multiline_comment|/*  14 awaiting d-channel shutdown */
)brace
suffix:semicolon
DECL|macro|STATE_COUNT
mdefine_line|#define STATE_COUNT (ST_WAIT_DSHUTDOWN +1)
DECL|variable|strState
r_static
r_char
op_star
id|strState
(braket
)braket
op_assign
(brace
l_string|&quot;ST_NULL&quot;
comma
l_string|&quot;ST_OUT_WAIT_D&quot;
comma
l_string|&quot;ST_IN_WAIT_D&quot;
comma
l_string|&quot;ST_OUT_DIAL&quot;
comma
l_string|&quot;ST_IN_WAIT_LL&quot;
comma
l_string|&quot;ST_IN_ALERT_SEND&quot;
comma
l_string|&quot;ST_IN_WAIT_CONN_ACK&quot;
comma
l_string|&quot;ST_WAIT_BCONN&quot;
comma
l_string|&quot;ST_ACTIVE&quot;
comma
l_string|&quot;ST_WAIT_BRELEASE&quot;
comma
l_string|&quot;ST_WAIT_BREL_DISC&quot;
comma
l_string|&quot;ST_WAIT_DCOMMAND&quot;
comma
l_string|&quot;ST_WAIT_DRELEASE&quot;
comma
l_string|&quot;ST_WAIT_D_REL_CNF&quot;
comma
l_string|&quot;ST_WAIT_DSHUTDOWN&quot;
comma
)brace
suffix:semicolon
r_enum
(brace
DECL|enumerator|EV_DIAL
id|EV_DIAL
comma
multiline_comment|/*  0 */
DECL|enumerator|EV_SETUP_CNF
id|EV_SETUP_CNF
comma
multiline_comment|/*  1 */
DECL|enumerator|EV_ACCEPTB
id|EV_ACCEPTB
comma
multiline_comment|/*  2 */
DECL|enumerator|EV_DISCONNECT_IND
id|EV_DISCONNECT_IND
comma
multiline_comment|/*  3 */
DECL|enumerator|EV_RELEASE_CNF
id|EV_RELEASE_CNF
comma
multiline_comment|/*  4 */
DECL|enumerator|EV_DLEST
id|EV_DLEST
comma
multiline_comment|/*  5 */
DECL|enumerator|EV_DLRL
id|EV_DLRL
comma
multiline_comment|/*  6 */
DECL|enumerator|EV_SETUP_IND
id|EV_SETUP_IND
comma
multiline_comment|/*  7 */
DECL|enumerator|EV_RELEASE_IND
id|EV_RELEASE_IND
comma
multiline_comment|/*  8 */
DECL|enumerator|EV_ACCEPTD
id|EV_ACCEPTD
comma
multiline_comment|/*  9 */
DECL|enumerator|EV_SETUP_CMPL_IND
id|EV_SETUP_CMPL_IND
comma
multiline_comment|/* 10 */
DECL|enumerator|EV_BC_EST
id|EV_BC_EST
comma
multiline_comment|/* 11 */
DECL|enumerator|EV_WRITEBUF
id|EV_WRITEBUF
comma
multiline_comment|/* 12 */
DECL|enumerator|EV_ESTABLISH
id|EV_ESTABLISH
comma
multiline_comment|/* 13 */
DECL|enumerator|EV_HANGUP
id|EV_HANGUP
comma
multiline_comment|/* 14 */
DECL|enumerator|EV_BC_REL
id|EV_BC_REL
comma
multiline_comment|/* 15 */
DECL|enumerator|EV_CINF
id|EV_CINF
comma
multiline_comment|/* 16 */
DECL|enumerator|EV_SUSPEND
id|EV_SUSPEND
comma
multiline_comment|/* 17 */
DECL|enumerator|EV_RESUME
id|EV_RESUME
comma
multiline_comment|/* 18 */
DECL|enumerator|EV_SHUTDOWN_D
id|EV_SHUTDOWN_D
comma
multiline_comment|/* 19 */
DECL|enumerator|EV_NOSETUP_RSP
id|EV_NOSETUP_RSP
comma
multiline_comment|/* 20 */
DECL|enumerator|EV_SETUP_ERR
id|EV_SETUP_ERR
comma
multiline_comment|/* 21 */
DECL|enumerator|EV_CONNECT_ERR
id|EV_CONNECT_ERR
comma
multiline_comment|/* 22 */
DECL|enumerator|EV_RELEASE_ERR
id|EV_RELEASE_ERR
comma
multiline_comment|/* 23 */
)brace
suffix:semicolon
DECL|macro|EVENT_COUNT
mdefine_line|#define EVENT_COUNT (EV_RELEASE_ERR +1)
DECL|variable|strEvent
r_static
r_char
op_star
id|strEvent
(braket
)braket
op_assign
(brace
l_string|&quot;EV_DIAL&quot;
comma
l_string|&quot;EV_SETUP_CNF&quot;
comma
l_string|&quot;EV_ACCEPTB&quot;
comma
l_string|&quot;EV_DISCONNECT_IND&quot;
comma
l_string|&quot;EV_RELEASE_CNF&quot;
comma
l_string|&quot;EV_DLEST&quot;
comma
l_string|&quot;EV_DLRL&quot;
comma
l_string|&quot;EV_SETUP_IND&quot;
comma
l_string|&quot;EV_RELEASE_IND&quot;
comma
l_string|&quot;EV_ACCEPTD&quot;
comma
l_string|&quot;EV_SETUP_CMPL_IND&quot;
comma
l_string|&quot;EV_BC_EST&quot;
comma
l_string|&quot;EV_WRITEBUF&quot;
comma
l_string|&quot;EV_ESTABLISH&quot;
comma
l_string|&quot;EV_HANGUP&quot;
comma
l_string|&quot;EV_BC_REL&quot;
comma
l_string|&quot;EV_CINF&quot;
comma
l_string|&quot;EV_SUSPEND&quot;
comma
l_string|&quot;EV_RESUME&quot;
comma
l_string|&quot;EV_SHUTDOWN_D&quot;
comma
l_string|&quot;EV_NOSETUP_RSP&quot;
comma
l_string|&quot;EV_SETUP_ERR&quot;
comma
l_string|&quot;EV_CONNECT_ERR&quot;
comma
l_string|&quot;EV_RELEASE_ERR&quot;
comma
)brace
suffix:semicolon
r_enum
(brace
DECL|enumerator|ST_LC_NULL
id|ST_LC_NULL
comma
DECL|enumerator|ST_LC_ACTIVATE_WAIT
id|ST_LC_ACTIVATE_WAIT
comma
DECL|enumerator|ST_LC_DELAY
id|ST_LC_DELAY
comma
DECL|enumerator|ST_LC_ESTABLISH_WAIT
id|ST_LC_ESTABLISH_WAIT
comma
DECL|enumerator|ST_LC_CONNECTED
id|ST_LC_CONNECTED
comma
DECL|enumerator|ST_LC_FLUSH_WAIT
id|ST_LC_FLUSH_WAIT
comma
DECL|enumerator|ST_LC_RELEASE_WAIT
id|ST_LC_RELEASE_WAIT
comma
)brace
suffix:semicolon
DECL|macro|LC_STATE_COUNT
mdefine_line|#define LC_STATE_COUNT (ST_LC_RELEASE_WAIT+1)
DECL|variable|strLcState
r_static
r_char
op_star
id|strLcState
(braket
)braket
op_assign
(brace
l_string|&quot;ST_LC_NULL&quot;
comma
l_string|&quot;ST_LC_ACTIVATE_WAIT&quot;
comma
l_string|&quot;ST_LC_DELAY&quot;
comma
l_string|&quot;ST_LC_ESTABLISH_WAIT&quot;
comma
l_string|&quot;ST_LC_CONNECTED&quot;
comma
l_string|&quot;ST_LC_FLUSH_WAIT&quot;
comma
l_string|&quot;ST_LC_RELEASE_WAIT&quot;
comma
)brace
suffix:semicolon
r_enum
(brace
DECL|enumerator|EV_LC_ESTABLISH
id|EV_LC_ESTABLISH
comma
DECL|enumerator|EV_LC_PH_ACTIVATE
id|EV_LC_PH_ACTIVATE
comma
DECL|enumerator|EV_LC_PH_DEACTIVATE
id|EV_LC_PH_DEACTIVATE
comma
DECL|enumerator|EV_LC_DL_ESTABLISH
id|EV_LC_DL_ESTABLISH
comma
DECL|enumerator|EV_LC_TIMER
id|EV_LC_TIMER
comma
DECL|enumerator|EV_LC_DL_RELEASE
id|EV_LC_DL_RELEASE
comma
DECL|enumerator|EV_LC_RELEASE
id|EV_LC_RELEASE
comma
)brace
suffix:semicolon
DECL|macro|LC_EVENT_COUNT
mdefine_line|#define LC_EVENT_COUNT (EV_LC_RELEASE+1)
DECL|variable|strLcEvent
r_static
r_char
op_star
id|strLcEvent
(braket
)braket
op_assign
(brace
l_string|&quot;EV_LC_ESTABLISH&quot;
comma
l_string|&quot;EV_LC_PH_ACTIVATE&quot;
comma
l_string|&quot;EV_LC_PH_DEACTIVATE&quot;
comma
l_string|&quot;EV_LC_DL_ESTABLISH&quot;
comma
l_string|&quot;EV_LC_TIMER&quot;
comma
l_string|&quot;EV_LC_DL_RELEASE&quot;
comma
l_string|&quot;EV_LC_RELEASE&quot;
comma
)brace
suffix:semicolon
DECL|macro|LC_D
mdefine_line|#define LC_D  0
DECL|macro|LC_B
mdefine_line|#define LC_B  1
r_static
r_inline
r_void
DECL|function|lli_deliver_cause
id|lli_deliver_cause
c_func
(paren
r_struct
id|Channel
op_star
id|chanp
)paren
(brace
id|isdn_ctrl
id|ic
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;proc-&gt;para.cause
OL
l_int|0
)paren
r_return
suffix:semicolon
id|ic.driver
op_assign
id|chanp-&gt;cs-&gt;myid
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_CAUSE
suffix:semicolon
id|ic.arg
op_assign
id|chanp-&gt;chan
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;cs-&gt;protocol
op_eq
id|ISDN_PTYPE_EURO
)paren
id|sprintf
c_func
(paren
id|ic.parm.num
comma
l_string|&quot;E%02X%02X&quot;
comma
id|chanp-&gt;proc-&gt;para.loc
op_amp
l_int|0x7f
comma
id|chanp-&gt;proc-&gt;para.cause
op_amp
l_int|0x7f
)paren
suffix:semicolon
r_else
id|sprintf
c_func
(paren
id|ic.parm.num
comma
l_string|&quot;%02X%02X&quot;
comma
id|chanp-&gt;proc-&gt;para.loc
op_amp
l_int|0x7f
comma
id|chanp-&gt;proc-&gt;para.cause
op_amp
l_int|0x7f
)paren
suffix:semicolon
id|chanp-&gt;cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|lli_d_established
id|lli_d_established
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_ESTAB_D
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;leased
)paren
(brace
id|isdn_ctrl
id|ic
suffix:semicolon
r_int
id|ret
suffix:semicolon
r_char
id|txt
(braket
l_int|32
)braket
suffix:semicolon
id|chanp-&gt;cs
op_member_access_from_pointer
id|cardmsg
c_func
(paren
id|chanp-&gt;cs
comma
id|MDL_INFO_SETUP
comma
(paren
r_void
op_star
)paren
id|chanp-&gt;chan
)paren
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_IN_WAIT_LL
)paren
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_CALL_REC
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
id|link_debug
c_func
(paren
id|chanp
comma
l_string|&quot;STAT_ICALL_LEASED&quot;
comma
l_int|0
)paren
suffix:semicolon
id|ic.driver
op_assign
id|chanp-&gt;cs-&gt;myid
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_ICALL
suffix:semicolon
id|ic.arg
op_assign
id|chanp-&gt;chan
suffix:semicolon
id|ic.parm.setup.si1
op_assign
l_int|7
suffix:semicolon
id|ic.parm.setup.si2
op_assign
l_int|0
suffix:semicolon
id|ic.parm.setup.plan
op_assign
l_int|0
suffix:semicolon
id|ic.parm.setup.screen
op_assign
l_int|0
suffix:semicolon
id|sprintf
c_func
(paren
id|ic.parm.setup.eazmsn
comma
l_string|&quot;%d&quot;
comma
id|chanp-&gt;chan
op_plus
l_int|1
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|ic.parm.setup.phone
comma
l_string|&quot;LEASED%d&quot;
comma
id|chanp-&gt;cs-&gt;myid
)paren
suffix:semicolon
id|ret
op_assign
id|chanp-&gt;cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
(brace
id|sprintf
c_func
(paren
id|txt
comma
l_string|&quot;statcallb ret=%d&quot;
comma
id|ret
)paren
suffix:semicolon
id|link_debug
c_func
(paren
id|chanp
comma
id|txt
comma
l_int|1
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|ret
)paren
(brace
id|chanp-&gt;cs
op_member_access_from_pointer
id|cardmsg
c_func
(paren
id|chanp-&gt;cs
comma
id|MDL_INFO_REL
comma
(paren
r_void
op_star
)paren
id|chanp-&gt;chan
)paren
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_NULL
)paren
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|fi-&gt;state
op_eq
id|ST_WAIT_DSHUTDOWN
)paren
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|lli_d_released
id|lli_d_released
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|test_and_clear_bit
c_func
(paren
id|FLG_START_D
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Dial out&n; */
r_static
r_void
DECL|function|lli_prep_dialout
id|lli_prep_dialout
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_OUT_WAIT_D
)paren
suffix:semicolon
id|FsmDelTimer
c_func
(paren
op_amp
id|chanp-&gt;drel_timer
comma
l_int|60
)paren
suffix:semicolon
id|FsmDelTimer
c_func
(paren
op_amp
id|chanp-&gt;dial_timer
comma
l_int|73
)paren
suffix:semicolon
id|chanp-&gt;l2_active_protocol
op_assign
id|chanp-&gt;l2_protocol
suffix:semicolon
id|chanp-&gt;incoming
op_assign
l_int|0
suffix:semicolon
id|chanp-&gt;lc_b-&gt;l2_start
op_assign
op_logical_neg
l_int|0
suffix:semicolon
r_switch
c_cond
(paren
id|chanp-&gt;l2_active_protocol
)paren
(brace
r_case
(paren
id|ISDN_PROTO_L2_X75I
)paren
suffix:colon
id|chanp-&gt;lc_b-&gt;l2_establish
op_assign
op_logical_neg
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|ISDN_PROTO_L2_HDLC
)paren
suffix:colon
r_case
(paren
id|ISDN_PROTO_L2_TRANS
)paren
suffix:colon
id|chanp-&gt;lc_b-&gt;l2_establish
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;lli_prep_dialout unknown protocol&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_ESTAB_D
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
(brace
id|FsmEvent
c_func
(paren
id|fi
comma
id|EV_DLEST
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_else
(brace
id|chanp-&gt;Flags
op_assign
l_int|0
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_START_D
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;leased
)paren
(brace
id|chanp-&gt;lc_d-&gt;l2_establish
op_assign
l_int|0
suffix:semicolon
)brace
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;lc_d-&gt;lcfi
comma
id|EV_LC_ESTABLISH
comma
l_int|NULL
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|lli_do_dialout
id|lli_do_dialout
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_OUT_DIAL
)paren
suffix:semicolon
id|chanp-&gt;cs
op_member_access_from_pointer
id|cardmsg
c_func
(paren
id|chanp-&gt;cs
comma
id|MDL_INFO_SETUP
comma
(paren
r_void
op_star
)paren
id|chanp-&gt;chan
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;leased
)paren
(brace
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;fi
comma
id|EV_SETUP_CNF
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_else
(brace
id|test_and_set_bit
c_func
(paren
id|FLG_ESTAB_D
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
id|chanp-&gt;d_st-&gt;lli
dot
id|l4l3
c_func
(paren
id|chanp-&gt;d_st
comma
id|CC_SETUP_REQ
comma
id|chanp
)paren
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_CALL_SEND
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|lli_init_bchan_out
id|lli_init_bchan_out
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|isdn_ctrl
id|ic
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_WAIT_BCONN
)paren
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_LL_DCONN
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
id|link_debug
c_func
(paren
id|chanp
comma
l_string|&quot;STAT_DCONN&quot;
comma
l_int|0
)paren
suffix:semicolon
id|ic.driver
op_assign
id|chanp-&gt;cs-&gt;myid
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_DCONN
suffix:semicolon
id|ic.arg
op_assign
id|chanp-&gt;chan
suffix:semicolon
id|chanp-&gt;cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
id|init_b_st
c_func
(paren
id|chanp
comma
l_int|0
)paren
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_START_B
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;lc_b-&gt;lcfi
comma
id|EV_LC_ESTABLISH
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|lli_go_active
id|lli_go_active
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|isdn_ctrl
id|ic
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_ACTIVE
)paren
suffix:semicolon
id|chanp-&gt;data_open
op_assign
op_logical_neg
l_int|0
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_CONNECT_B
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
id|link_debug
c_func
(paren
id|chanp
comma
l_string|&quot;STAT_BCONN&quot;
comma
l_int|0
)paren
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_LL_BCONN
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
id|ic.driver
op_assign
id|chanp-&gt;cs-&gt;myid
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_BCONN
suffix:semicolon
id|ic.arg
op_assign
id|chanp-&gt;chan
suffix:semicolon
id|chanp-&gt;cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
id|chanp-&gt;cs
op_member_access_from_pointer
id|cardmsg
c_func
(paren
id|chanp-&gt;cs
comma
id|MDL_INFO_CONN
comma
(paren
r_void
op_star
)paren
id|chanp-&gt;chan
)paren
suffix:semicolon
)brace
multiline_comment|/* incomming call */
r_static
r_void
DECL|function|lli_start_dchan
id|lli_start_dchan
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_IN_WAIT_D
)paren
suffix:semicolon
id|FsmDelTimer
c_func
(paren
op_amp
id|chanp-&gt;drel_timer
comma
l_int|61
)paren
suffix:semicolon
r_if
c_cond
(paren
id|event
op_eq
id|EV_ACCEPTD
)paren
id|test_and_set_bit
c_func
(paren
id|FLG_DO_CONNECT
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|event
op_eq
id|EV_HANGUP
)paren
(brace
id|test_and_set_bit
c_func
(paren
id|FLG_DO_HANGUP
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
macro_line|#ifdef ALERT_REJECT&t;&t;
id|test_and_set_bit
c_func
(paren
id|FLG_DO_ALERT
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
macro_line|#endif
)brace
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_ESTAB_D
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
(brace
id|FsmEvent
c_func
(paren
id|fi
comma
id|EV_DLEST
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|test_and_set_bit
c_func
(paren
id|FLG_START_D
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;lc_d-&gt;lcfi
comma
id|EV_LC_ESTABLISH
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|lli_deliver_call
id|lli_deliver_call
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|isdn_ctrl
id|ic
suffix:semicolon
r_int
id|ret
suffix:semicolon
r_char
id|txt
(braket
l_int|32
)braket
suffix:semicolon
id|chanp-&gt;cs
op_member_access_from_pointer
id|cardmsg
c_func
(paren
id|chanp-&gt;cs
comma
id|MDL_INFO_SETUP
comma
(paren
r_void
op_star
)paren
id|chanp-&gt;chan
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Report incoming calls only once to linklevel, use CallFlags&n;&t; * which is set to 3 with each broadcast message in isdnl1.c&n;&t; * and resetted if a interface  answered the STAT_ICALL.&n;&t; */
r_if
c_cond
(paren
l_int|1
)paren
(brace
multiline_comment|/* for only one TEI */
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_IN_WAIT_LL
)paren
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_CALL_REC
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
id|link_debug
c_func
(paren
id|chanp
comma
l_string|&quot;STAT_ICALL&quot;
comma
l_int|0
)paren
suffix:semicolon
id|ic.driver
op_assign
id|chanp-&gt;cs-&gt;myid
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_ICALL
suffix:semicolon
id|ic.arg
op_assign
id|chanp-&gt;chan
suffix:semicolon
multiline_comment|/*&n;&t;&t; * No need to return &quot;unknown&quot; for calls without OAD,&n;&t;&t; * cause that&squot;s handled in linklevel now (replaced by &squot;0&squot;)&n;&t;&t; */
id|ic.parm.setup
op_assign
id|chanp-&gt;proc-&gt;para.setup
suffix:semicolon
id|ret
op_assign
id|chanp-&gt;cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
(brace
id|sprintf
c_func
(paren
id|txt
comma
l_string|&quot;statcallb ret=%d&quot;
comma
id|ret
)paren
suffix:semicolon
id|link_debug
c_func
(paren
id|chanp
comma
id|txt
comma
l_int|1
)paren
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|ret
)paren
(brace
r_case
l_int|1
suffix:colon
multiline_comment|/* OK, anybody likes this call */
id|FsmDelTimer
c_func
(paren
op_amp
id|chanp-&gt;drel_timer
comma
l_int|61
)paren
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_ESTAB_D
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
(brace
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_IN_ALERT_SEND
)paren
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_CALL_ALERT
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
id|chanp-&gt;d_st-&gt;lli
dot
id|l4l3
c_func
(paren
id|chanp-&gt;d_st
comma
id|CC_ALERTING_REQ
comma
id|chanp-&gt;proc
)paren
suffix:semicolon
)brace
r_else
(brace
id|test_and_set_bit
c_func
(paren
id|FLG_DO_ALERT
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_IN_WAIT_D
)paren
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_START_D
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;lc_d-&gt;lcfi
comma
id|EV_LC_ESTABLISH
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
multiline_comment|/* Rejecting Call */
id|test_and_clear_bit
c_func
(paren
id|FLG_CALL_REC
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0
suffix:colon
multiline_comment|/* OK, nobody likes this call */
r_default
suffix:colon
multiline_comment|/* statcallb problems */
id|chanp-&gt;d_st-&gt;lli
dot
id|l4l3
c_func
(paren
id|chanp-&gt;d_st
comma
id|CC_IGNORE
comma
id|chanp-&gt;proc
)paren
suffix:semicolon
id|chanp-&gt;cs
op_member_access_from_pointer
id|cardmsg
c_func
(paren
id|chanp-&gt;cs
comma
id|MDL_INFO_REL
comma
(paren
r_void
op_star
)paren
id|chanp-&gt;chan
)paren
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_NULL
)paren
suffix:semicolon
macro_line|#ifndef LAYER2_WATCHING
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_ESTAB_D
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
id|FsmRestartTimer
c_func
(paren
op_amp
id|chanp-&gt;drel_timer
comma
id|DREL_TIMER_VALUE
comma
id|EV_SHUTDOWN_D
comma
l_int|NULL
comma
l_int|61
)paren
suffix:semicolon
macro_line|#endif
r_break
suffix:semicolon
)brace
)brace
r_else
(brace
id|chanp-&gt;d_st-&gt;lli
dot
id|l4l3
c_func
(paren
id|chanp-&gt;d_st
comma
id|CC_IGNORE
comma
id|chanp-&gt;proc
)paren
suffix:semicolon
id|chanp-&gt;cs
op_member_access_from_pointer
id|cardmsg
c_func
(paren
id|chanp-&gt;cs
comma
id|MDL_INFO_REL
comma
(paren
r_void
op_star
)paren
id|chanp-&gt;chan
)paren
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_NULL
)paren
suffix:semicolon
macro_line|#ifndef LAYER2_WATCHING
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_ESTAB_D
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
id|FsmRestartTimer
c_func
(paren
op_amp
id|chanp-&gt;drel_timer
comma
id|DREL_TIMER_VALUE
comma
id|EV_SHUTDOWN_D
comma
l_int|NULL
comma
l_int|62
)paren
suffix:semicolon
macro_line|#endif
)brace
)brace
r_static
r_void
DECL|function|lli_establish_d
id|lli_establish_d
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
multiline_comment|/* This establish the D-channel for pending L3 messages &n;&t; * without blocking th channel&n;&t; */
r_struct
id|Channel
op_star
id|chanp
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_DO_ESTAB
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_IN_WAIT_D
)paren
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_START_D
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;lc_d-&gt;lcfi
comma
id|EV_LC_ESTABLISH
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|lli_do_action
id|lli_do_action
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_ESTAB_D
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;leased
)paren
(brace
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_IN_WAIT_CONN_ACK
)paren
suffix:semicolon
id|test_and_clear_bit
c_func
(paren
id|FLG_DO_ALERT
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
id|test_and_clear_bit
c_func
(paren
id|FLG_DO_CONNECT
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;fi
comma
id|EV_SETUP_CMPL_IND
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_DO_CONNECT
comma
op_amp
id|chanp-&gt;Flags
)paren
op_logical_and
op_logical_neg
id|test_bit
c_func
(paren
id|FLG_DO_HANGUP
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
(brace
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_IN_WAIT_CONN_ACK
)paren
suffix:semicolon
id|test_and_clear_bit
c_func
(paren
id|FLG_DO_ALERT
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
id|chanp-&gt;d_st-&gt;lli
dot
id|l4l3
c_func
(paren
id|chanp-&gt;d_st
comma
id|CC_SETUP_RSP
comma
id|chanp-&gt;proc
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_DO_ALERT
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
(brace
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_DO_HANGUP
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
id|FsmRestartTimer
c_func
(paren
op_amp
id|chanp-&gt;drel_timer
comma
l_int|40
comma
id|EV_HANGUP
comma
l_int|NULL
comma
l_int|63
)paren
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_IN_ALERT_SEND
)paren
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_CALL_ALERT
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
id|chanp-&gt;d_st-&gt;lli
dot
id|l4l3
c_func
(paren
id|chanp-&gt;d_st
comma
id|CC_ALERTING_REQ
comma
id|chanp-&gt;proc
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_DO_HANGUP
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
(brace
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_WAIT_DRELEASE
)paren
suffix:semicolon
id|chanp-&gt;proc-&gt;para.cause
op_assign
l_int|0x15
suffix:semicolon
multiline_comment|/* Call Rejected */
id|chanp-&gt;d_st-&gt;lli
dot
id|l4l3
c_func
(paren
id|chanp-&gt;d_st
comma
id|CC_REJECT_REQ
comma
id|chanp-&gt;proc
)paren
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_DISC_SEND
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_DO_ESTAB
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
(brace
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_NULL
)paren
suffix:semicolon
id|chanp-&gt;Flags
op_assign
l_int|0
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_ESTAB_D
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
id|chanp-&gt;d_st-&gt;lli
dot
id|l4l3
c_func
(paren
id|chanp-&gt;d_st
comma
id|CC_ESTABLISH
comma
id|chanp-&gt;proc
)paren
suffix:semicolon
id|chanp-&gt;proc
op_assign
l_int|NULL
suffix:semicolon
macro_line|#ifndef LAYER2_WATCHING
id|FsmAddTimer
c_func
(paren
op_amp
id|chanp-&gt;drel_timer
comma
id|DREL_TIMER_VALUE
comma
id|EV_SHUTDOWN_D
comma
l_int|NULL
comma
l_int|60
)paren
suffix:semicolon
macro_line|#endif
)brace
)brace
r_static
r_void
DECL|function|lli_send_dconnect
id|lli_send_dconnect
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_IN_WAIT_CONN_ACK
)paren
suffix:semicolon
id|chanp-&gt;d_st-&gt;lli
dot
id|l4l3
c_func
(paren
id|chanp-&gt;d_st
comma
id|CC_SETUP_RSP
comma
id|chanp-&gt;proc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|lli_init_bchan_in
id|lli_init_bchan_in
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|isdn_ctrl
id|ic
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_WAIT_BCONN
)paren
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_LL_DCONN
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
id|link_debug
c_func
(paren
id|chanp
comma
l_string|&quot;STAT_DCONN&quot;
comma
l_int|0
)paren
suffix:semicolon
id|ic.driver
op_assign
id|chanp-&gt;cs-&gt;myid
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_DCONN
suffix:semicolon
id|ic.arg
op_assign
id|chanp-&gt;chan
suffix:semicolon
id|chanp-&gt;cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
id|chanp-&gt;l2_active_protocol
op_assign
id|chanp-&gt;l2_protocol
suffix:semicolon
id|chanp-&gt;incoming
op_assign
op_logical_neg
l_int|0
suffix:semicolon
id|chanp-&gt;lc_b-&gt;l2_start
op_assign
l_int|0
suffix:semicolon
r_switch
c_cond
(paren
id|chanp-&gt;l2_active_protocol
)paren
(brace
r_case
(paren
id|ISDN_PROTO_L2_X75I
)paren
suffix:colon
id|chanp-&gt;lc_b-&gt;l2_establish
op_assign
op_logical_neg
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|ISDN_PROTO_L2_HDLC
)paren
suffix:colon
r_case
(paren
id|ISDN_PROTO_L2_TRANS
)paren
suffix:colon
id|chanp-&gt;lc_b-&gt;l2_establish
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;bchannel unknown protocol&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|init_b_st
c_func
(paren
id|chanp
comma
op_logical_neg
l_int|0
)paren
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_START_B
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;lc_b-&gt;lcfi
comma
id|EV_LC_ESTABLISH
comma
l_int|NULL
)paren
suffix:semicolon
)brace
multiline_comment|/* Call clearing */
r_static
r_void
DECL|function|lli_cancel_call
id|lli_cancel_call
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|isdn_ctrl
id|ic
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_WAIT_DRELEASE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_LL_BCONN
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
(brace
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
id|link_debug
c_func
(paren
id|chanp
comma
l_string|&quot;STAT_BHUP&quot;
comma
l_int|0
)paren
suffix:semicolon
id|ic.driver
op_assign
id|chanp-&gt;cs-&gt;myid
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_BHUP
suffix:semicolon
id|ic.arg
op_assign
id|chanp-&gt;chan
suffix:semicolon
id|chanp-&gt;cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_START_B
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
id|release_b_st
c_func
(paren
id|chanp
)paren
suffix:semicolon
id|chanp-&gt;proc-&gt;para.cause
op_assign
l_int|0x10
suffix:semicolon
multiline_comment|/* Normal Call Clearing */
id|chanp-&gt;d_st-&gt;lli
dot
id|l4l3
c_func
(paren
id|chanp-&gt;d_st
comma
id|CC_DISCONNECT_REQ
comma
id|chanp-&gt;proc
)paren
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_DISC_SEND
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|lli_shutdown_d
id|lli_shutdown_d
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|FsmDelTimer
c_func
(paren
op_amp
id|chanp-&gt;drel_timer
comma
l_int|62
)paren
suffix:semicolon
macro_line|#ifdef LAYER2_WATCHING
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_NULL
)paren
suffix:semicolon
macro_line|#else
r_if
c_cond
(paren
op_logical_neg
id|test_bit
c_func
(paren
id|FLG_TWO_DCHAN
comma
op_amp
id|chanp-&gt;cs-&gt;HW_Flags
)paren
)paren
(brace
r_if
c_cond
(paren
id|chanp-&gt;chan
)paren
(brace
r_if
c_cond
(paren
id|chanp-&gt;cs-&gt;channel
(braket
l_int|0
)braket
dot
id|fi.state
op_ne
id|ST_NULL
)paren
r_return
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|chanp-&gt;cs-&gt;channel
(braket
l_int|1
)braket
dot
id|fi.state
op_ne
id|ST_NULL
)paren
r_return
suffix:semicolon
)brace
)brace
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_WAIT_DSHUTDOWN
)paren
suffix:semicolon
id|test_and_clear_bit
c_func
(paren
id|FLG_ESTAB_D
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;lc_d-&gt;lcfi
comma
id|EV_LC_RELEASE
comma
l_int|NULL
)paren
suffix:semicolon
macro_line|#endif
)brace
r_static
r_void
DECL|function|lli_timeout_d
id|lli_timeout_d
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|isdn_ctrl
id|ic
suffix:semicolon
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_LL_DCONN
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
(brace
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
id|link_debug
c_func
(paren
id|chanp
comma
l_string|&quot;STAT_DHUP&quot;
comma
l_int|0
)paren
suffix:semicolon
id|lli_deliver_cause
c_func
(paren
id|chanp
)paren
suffix:semicolon
id|ic.driver
op_assign
id|chanp-&gt;cs-&gt;myid
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_DHUP
suffix:semicolon
id|ic.arg
op_assign
id|chanp-&gt;chan
suffix:semicolon
id|chanp-&gt;cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
)brace
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_NULL
)paren
suffix:semicolon
id|chanp-&gt;Flags
op_assign
l_int|0
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_ESTAB_D
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
macro_line|#ifndef LAYER2_WATCHING
id|FsmAddTimer
c_func
(paren
op_amp
id|chanp-&gt;drel_timer
comma
id|DREL_TIMER_VALUE
comma
id|EV_SHUTDOWN_D
comma
l_int|NULL
comma
l_int|60
)paren
suffix:semicolon
macro_line|#endif
id|chanp-&gt;cs
op_member_access_from_pointer
id|cardmsg
c_func
(paren
id|chanp-&gt;cs
comma
id|MDL_INFO_REL
comma
(paren
r_void
op_star
)paren
id|chanp-&gt;chan
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|lli_go_null
id|lli_go_null
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_NULL
)paren
suffix:semicolon
id|chanp-&gt;Flags
op_assign
l_int|0
suffix:semicolon
id|FsmDelTimer
c_func
(paren
op_amp
id|chanp-&gt;drel_timer
comma
l_int|63
)paren
suffix:semicolon
id|chanp-&gt;cs
op_member_access_from_pointer
id|cardmsg
c_func
(paren
id|chanp-&gt;cs
comma
id|MDL_INFO_REL
comma
(paren
r_void
op_star
)paren
id|chanp-&gt;chan
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|lli_disconn_bchan
id|lli_disconn_bchan
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|chanp-&gt;data_open
op_assign
l_int|0
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_WAIT_BRELEASE
)paren
suffix:semicolon
id|test_and_clear_bit
c_func
(paren
id|FLG_CONNECT_B
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;lc_b-&gt;lcfi
comma
id|EV_LC_RELEASE
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|lli_send_d_disc
id|lli_send_d_disc
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|isdn_ctrl
id|ic
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_DISC_REC
comma
op_amp
id|chanp-&gt;Flags
)paren
op_logical_or
id|test_bit
c_func
(paren
id|FLG_REL_REC
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
r_return
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_WAIT_DRELEASE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_LL_BCONN
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
(brace
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
id|link_debug
c_func
(paren
id|chanp
comma
l_string|&quot;STAT_BHUP&quot;
comma
l_int|0
)paren
suffix:semicolon
id|ic.driver
op_assign
id|chanp-&gt;cs-&gt;myid
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_BHUP
suffix:semicolon
id|ic.arg
op_assign
id|chanp-&gt;chan
suffix:semicolon
id|chanp-&gt;cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_START_B
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
id|release_b_st
c_func
(paren
id|chanp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;leased
)paren
(brace
id|ic.command
op_assign
id|ISDN_STAT_CAUSE
suffix:semicolon
id|ic.arg
op_assign
id|chanp-&gt;chan
suffix:semicolon
id|sprintf
c_func
(paren
id|ic.parm.num
comma
l_string|&quot;L0010&quot;
)paren
suffix:semicolon
id|chanp-&gt;cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
id|link_debug
c_func
(paren
id|chanp
comma
l_string|&quot;STAT_DHUP&quot;
comma
l_int|0
)paren
suffix:semicolon
id|ic.driver
op_assign
id|chanp-&gt;cs-&gt;myid
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_DHUP
suffix:semicolon
id|ic.arg
op_assign
id|chanp-&gt;chan
suffix:semicolon
id|chanp-&gt;cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_WAIT_DSHUTDOWN
)paren
suffix:semicolon
id|test_and_clear_bit
c_func
(paren
id|FLG_ESTAB_D
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;lc_d-&gt;lcfi
comma
id|EV_LC_RELEASE
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_DO_HANGUP
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
id|chanp-&gt;proc-&gt;para.cause
op_assign
l_int|0x15
suffix:semicolon
multiline_comment|/* Call Reject */
r_else
id|chanp-&gt;proc-&gt;para.cause
op_assign
l_int|0x10
suffix:semicolon
multiline_comment|/* Normal Call Clearing */
id|chanp-&gt;d_st-&gt;lli
dot
id|l4l3
c_func
(paren
id|chanp-&gt;d_st
comma
id|CC_DISCONNECT_REQ
comma
id|chanp-&gt;proc
)paren
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_DISC_SEND
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|lli_released_bchan
id|lli_released_bchan
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|isdn_ctrl
id|ic
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_WAIT_DCOMMAND
)paren
suffix:semicolon
id|chanp-&gt;data_open
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_LL_BCONN
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
(brace
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
id|link_debug
c_func
(paren
id|chanp
comma
l_string|&quot;STAT_BHUP&quot;
comma
l_int|0
)paren
suffix:semicolon
id|ic.driver
op_assign
id|chanp-&gt;cs-&gt;myid
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_BHUP
suffix:semicolon
id|ic.arg
op_assign
id|chanp-&gt;chan
suffix:semicolon
id|chanp-&gt;cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
)brace
id|release_b_st
c_func
(paren
id|chanp
)paren
suffix:semicolon
id|test_and_clear_bit
c_func
(paren
id|FLG_START_B
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|lli_release_bchan
id|lli_release_bchan
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|chanp-&gt;data_open
op_assign
l_int|0
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_DISC_REC
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_WAIT_BREL_DISC
)paren
suffix:semicolon
id|test_and_clear_bit
c_func
(paren
id|FLG_CONNECT_B
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;lc_b-&gt;lcfi
comma
id|EV_LC_RELEASE
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|lli_received_d_rel
id|lli_received_d_rel
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|isdn_ctrl
id|ic
suffix:semicolon
id|chanp-&gt;data_open
op_assign
l_int|0
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_NULL
)paren
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_REL_REC
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_CONNECT_B
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
(brace
id|chanp-&gt;lc_b-&gt;l2_establish
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* direct reset in lc_b-&gt;lcfi */
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;lc_b-&gt;lcfi
comma
id|EV_LC_RELEASE
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_LL_BCONN
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
(brace
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
id|link_debug
c_func
(paren
id|chanp
comma
l_string|&quot;STAT_BHUP&quot;
comma
l_int|0
)paren
suffix:semicolon
id|ic.driver
op_assign
id|chanp-&gt;cs-&gt;myid
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_BHUP
suffix:semicolon
id|ic.arg
op_assign
id|chanp-&gt;chan
suffix:semicolon
id|chanp-&gt;cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_START_B
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
id|release_b_st
c_func
(paren
id|chanp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_LL_DCONN
comma
op_amp
id|chanp-&gt;Flags
)paren
op_logical_or
id|test_bit
c_func
(paren
id|FLG_CALL_SEND
comma
op_amp
id|chanp-&gt;Flags
)paren
op_logical_or
id|test_bit
c_func
(paren
id|FLG_CALL_ALERT
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
(brace
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
id|link_debug
c_func
(paren
id|chanp
comma
l_string|&quot;STAT_DHUP&quot;
comma
l_int|0
)paren
suffix:semicolon
id|lli_deliver_cause
c_func
(paren
id|chanp
)paren
suffix:semicolon
id|ic.driver
op_assign
id|chanp-&gt;cs-&gt;myid
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_DHUP
suffix:semicolon
id|ic.arg
op_assign
id|chanp-&gt;chan
suffix:semicolon
id|chanp-&gt;cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
)brace
id|test_and_clear_bit
c_func
(paren
id|FLG_DISC_SEND
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
id|test_and_clear_bit
c_func
(paren
id|FLG_CALL_REC
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
id|test_and_clear_bit
c_func
(paren
id|FLG_CALL_ALERT
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
id|test_and_clear_bit
c_func
(paren
id|FLG_LL_DCONN
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
id|test_and_clear_bit
c_func
(paren
id|FLG_CALL_SEND
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
id|lli_timeout_d
c_func
(paren
id|fi
comma
id|event
comma
id|arg
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|lli_received_d_relcnf
id|lli_received_d_relcnf
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|isdn_ctrl
id|ic
suffix:semicolon
id|chanp-&gt;data_open
op_assign
l_int|0
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_CONNECT_B
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
(brace
id|chanp-&gt;lc_b-&gt;l2_establish
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* direct reset in lc_b-&gt;lcfi */
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;lc_b-&gt;lcfi
comma
id|EV_LC_RELEASE
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_LL_BCONN
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
(brace
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
id|link_debug
c_func
(paren
id|chanp
comma
l_string|&quot;STAT_BHUP&quot;
comma
l_int|0
)paren
suffix:semicolon
id|ic.driver
op_assign
id|chanp-&gt;cs-&gt;myid
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_BHUP
suffix:semicolon
id|ic.arg
op_assign
id|chanp-&gt;chan
suffix:semicolon
id|chanp-&gt;cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_START_B
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
id|release_b_st
c_func
(paren
id|chanp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_LL_DCONN
comma
op_amp
id|chanp-&gt;Flags
)paren
op_logical_or
id|test_bit
c_func
(paren
id|FLG_CALL_SEND
comma
op_amp
id|chanp-&gt;Flags
)paren
op_logical_or
id|test_bit
c_func
(paren
id|FLG_CALL_ALERT
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
(brace
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
id|link_debug
c_func
(paren
id|chanp
comma
l_string|&quot;STAT_DHUP&quot;
comma
l_int|0
)paren
suffix:semicolon
id|lli_deliver_cause
c_func
(paren
id|chanp
)paren
suffix:semicolon
id|ic.driver
op_assign
id|chanp-&gt;cs-&gt;myid
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_DHUP
suffix:semicolon
id|ic.arg
op_assign
id|chanp-&gt;chan
suffix:semicolon
id|chanp-&gt;cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
)brace
id|test_and_clear_bit
c_func
(paren
id|FLG_DISC_SEND
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
id|test_and_clear_bit
c_func
(paren
id|FLG_CALL_REC
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
id|test_and_clear_bit
c_func
(paren
id|FLG_CALL_ALERT
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
id|test_and_clear_bit
c_func
(paren
id|FLG_LL_DCONN
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
id|test_and_clear_bit
c_func
(paren
id|FLG_CALL_SEND
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
id|lli_timeout_d
c_func
(paren
id|fi
comma
id|event
comma
id|arg
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|lli_received_d_disc
id|lli_received_d_disc
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|isdn_ctrl
id|ic
suffix:semicolon
id|chanp-&gt;data_open
op_assign
l_int|0
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_WAIT_D_REL_CNF
)paren
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_DISC_REC
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_LL_BCONN
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
(brace
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
id|link_debug
c_func
(paren
id|chanp
comma
l_string|&quot;STAT_BHUP&quot;
comma
l_int|0
)paren
suffix:semicolon
id|ic.driver
op_assign
id|chanp-&gt;cs-&gt;myid
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_BHUP
suffix:semicolon
id|ic.arg
op_assign
id|chanp-&gt;chan
suffix:semicolon
id|chanp-&gt;cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_START_B
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
id|release_b_st
c_func
(paren
id|chanp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_LL_DCONN
comma
op_amp
id|chanp-&gt;Flags
)paren
op_logical_or
id|test_bit
c_func
(paren
id|FLG_CALL_SEND
comma
op_amp
id|chanp-&gt;Flags
)paren
op_logical_or
id|test_bit
c_func
(paren
id|FLG_CALL_ALERT
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
(brace
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
id|link_debug
c_func
(paren
id|chanp
comma
l_string|&quot;STAT_DHUP&quot;
comma
l_int|0
)paren
suffix:semicolon
id|lli_deliver_cause
c_func
(paren
id|chanp
)paren
suffix:semicolon
id|ic.driver
op_assign
id|chanp-&gt;cs-&gt;myid
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_DHUP
suffix:semicolon
id|ic.arg
op_assign
id|chanp-&gt;chan
suffix:semicolon
id|chanp-&gt;cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
)brace
id|test_and_clear_bit
c_func
(paren
id|FLG_CALL_ALERT
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
id|test_and_clear_bit
c_func
(paren
id|FLG_LL_DCONN
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
id|test_and_clear_bit
c_func
(paren
id|FLG_CALL_SEND
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
id|chanp-&gt;d_st-&gt;lli
dot
id|l4l3
c_func
(paren
id|chanp-&gt;d_st
comma
id|CC_RELEASE_REQ
comma
id|chanp-&gt;proc
)paren
suffix:semicolon
)brace
multiline_comment|/* processing charge info */
r_static
r_void
DECL|function|lli_charge_info
id|lli_charge_info
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|isdn_ctrl
id|ic
suffix:semicolon
id|ic.driver
op_assign
id|chanp-&gt;cs-&gt;myid
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_CINF
suffix:semicolon
id|ic.arg
op_assign
id|chanp-&gt;chan
suffix:semicolon
id|sprintf
c_func
(paren
id|ic.parm.num
comma
l_string|&quot;%d&quot;
comma
id|chanp-&gt;proc-&gt;para.chargeinfo
)paren
suffix:semicolon
id|chanp-&gt;cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
)brace
multiline_comment|/* error procedures */
r_static
r_void
DECL|function|lli_no_dchan
id|lli_no_dchan
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|isdn_ctrl
id|ic
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
id|link_debug
c_func
(paren
id|chanp
comma
l_string|&quot;STAT_NODCH&quot;
comma
l_int|0
)paren
suffix:semicolon
id|ic.driver
op_assign
id|chanp-&gt;cs-&gt;myid
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_NODCH
suffix:semicolon
id|ic.arg
op_assign
id|chanp-&gt;chan
suffix:semicolon
id|chanp-&gt;cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
id|chanp-&gt;Flags
op_assign
l_int|0
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_NULL
)paren
suffix:semicolon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;lc_d-&gt;lcfi
comma
id|EV_LC_RELEASE
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|lli_no_dchan_ready
id|lli_no_dchan_ready
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|isdn_ctrl
id|ic
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
id|link_debug
c_func
(paren
id|chanp
comma
l_string|&quot;STAT_DHUP&quot;
comma
l_int|0
)paren
suffix:semicolon
id|ic.driver
op_assign
id|chanp-&gt;cs-&gt;myid
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_DHUP
suffix:semicolon
id|ic.arg
op_assign
id|chanp-&gt;chan
suffix:semicolon
id|chanp-&gt;cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|lli_no_dchan_in
id|lli_no_dchan_in
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|isdn_ctrl
id|ic
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
id|link_debug
c_func
(paren
id|chanp
comma
l_string|&quot;STAT_DHUP&quot;
comma
l_int|0
)paren
suffix:semicolon
id|ic.driver
op_assign
id|chanp-&gt;cs-&gt;myid
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_DHUP
suffix:semicolon
id|ic.arg
op_assign
id|chanp-&gt;chan
suffix:semicolon
id|chanp-&gt;cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
id|chanp-&gt;d_st-&gt;lli
dot
id|l4l3
c_func
(paren
id|chanp-&gt;d_st
comma
id|CC_DLRL
comma
id|chanp-&gt;proc
)paren
suffix:semicolon
id|chanp-&gt;Flags
op_assign
l_int|0
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_NULL
)paren
suffix:semicolon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;lc_d-&gt;lcfi
comma
id|EV_LC_RELEASE
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|lli_no_setup_rsp
id|lli_no_setup_rsp
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|isdn_ctrl
id|ic
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_NULL
)paren
suffix:semicolon
id|test_and_clear_bit
c_func
(paren
id|FLG_CALL_SEND
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
id|link_debug
c_func
(paren
id|chanp
comma
l_string|&quot;STAT_DHUP&quot;
comma
l_int|0
)paren
suffix:semicolon
id|ic.driver
op_assign
id|chanp-&gt;cs-&gt;myid
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_DHUP
suffix:semicolon
id|ic.arg
op_assign
id|chanp-&gt;chan
suffix:semicolon
id|chanp-&gt;cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
id|lli_shutdown_d
c_func
(paren
id|fi
comma
id|event
comma
id|arg
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|lli_setup_err
id|lli_setup_err
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|isdn_ctrl
id|ic
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_WAIT_DRELEASE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_LL_DCONN
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
(brace
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
id|link_debug
c_func
(paren
id|chanp
comma
l_string|&quot;STAT_DHUP&quot;
comma
l_int|0
)paren
suffix:semicolon
id|lli_deliver_cause
c_func
(paren
id|chanp
)paren
suffix:semicolon
id|ic.driver
op_assign
id|chanp-&gt;cs-&gt;myid
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_DHUP
suffix:semicolon
id|ic.arg
op_assign
id|chanp-&gt;chan
suffix:semicolon
id|chanp-&gt;cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
)brace
id|test_and_set_bit
c_func
(paren
id|FLG_DISC_SEND
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
multiline_comment|/* DISCONN was sent from L3 */
)brace
r_static
r_void
DECL|function|lli_connect_err
id|lli_connect_err
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|isdn_ctrl
id|ic
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_WAIT_DRELEASE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_LL_DCONN
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
(brace
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
id|link_debug
c_func
(paren
id|chanp
comma
l_string|&quot;STAT_DHUP&quot;
comma
l_int|0
)paren
suffix:semicolon
id|lli_deliver_cause
c_func
(paren
id|chanp
)paren
suffix:semicolon
id|ic.driver
op_assign
id|chanp-&gt;cs-&gt;myid
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_DHUP
suffix:semicolon
id|ic.arg
op_assign
id|chanp-&gt;chan
suffix:semicolon
id|chanp-&gt;cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
)brace
id|test_and_set_bit
c_func
(paren
id|FLG_DISC_SEND
comma
op_amp
id|chanp-&gt;Flags
)paren
suffix:semicolon
multiline_comment|/* DISCONN was sent from L3 */
)brace
r_static
r_void
DECL|function|lli_got_dlrl
id|lli_got_dlrl
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|isdn_ctrl
id|ic
suffix:semicolon
id|chanp-&gt;data_open
op_assign
l_int|0
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_CONNECT_B
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
(brace
id|chanp-&gt;lc_b-&gt;l2_establish
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* direct reset in lc_b-&gt;lcfi */
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;lc_b-&gt;lcfi
comma
id|EV_LC_RELEASE
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_LL_BCONN
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
(brace
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
id|link_debug
c_func
(paren
id|chanp
comma
l_string|&quot;STAT_BHUP&quot;
comma
l_int|0
)paren
suffix:semicolon
id|ic.driver
op_assign
id|chanp-&gt;cs-&gt;myid
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_BHUP
suffix:semicolon
id|ic.arg
op_assign
id|chanp-&gt;chan
suffix:semicolon
id|chanp-&gt;cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_START_B
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
id|release_b_st
c_func
(paren
id|chanp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;leased
)paren
(brace
id|ic.driver
op_assign
id|chanp-&gt;cs-&gt;myid
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_CAUSE
suffix:semicolon
id|ic.arg
op_assign
id|chanp-&gt;chan
suffix:semicolon
id|sprintf
c_func
(paren
id|ic.parm.num
comma
l_string|&quot;L%02X%02X&quot;
comma
l_int|0
comma
l_int|0x2f
)paren
suffix:semicolon
id|chanp-&gt;cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
id|ic.driver
op_assign
id|chanp-&gt;cs-&gt;myid
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_DHUP
suffix:semicolon
id|ic.arg
op_assign
id|chanp-&gt;chan
suffix:semicolon
id|chanp-&gt;cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
id|chanp-&gt;Flags
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_LL_DCONN
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
(brace
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
id|link_debug
c_func
(paren
id|chanp
comma
l_string|&quot;STAT_DHUP&quot;
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;cs-&gt;protocol
op_eq
id|ISDN_PTYPE_EURO
)paren
(brace
id|chanp-&gt;proc-&gt;para.cause
op_assign
l_int|0x2f
suffix:semicolon
id|chanp-&gt;proc-&gt;para.loc
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|chanp-&gt;proc-&gt;para.cause
op_assign
l_int|0x70
suffix:semicolon
id|chanp-&gt;proc-&gt;para.loc
op_assign
l_int|0
suffix:semicolon
)brace
id|lli_deliver_cause
c_func
(paren
id|chanp
)paren
suffix:semicolon
id|ic.driver
op_assign
id|chanp-&gt;cs-&gt;myid
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_DHUP
suffix:semicolon
id|ic.arg
op_assign
id|chanp-&gt;chan
suffix:semicolon
id|chanp-&gt;cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
)brace
id|chanp-&gt;d_st-&gt;lli
dot
id|l4l3
c_func
(paren
id|chanp-&gt;d_st
comma
id|CC_DLRL
comma
id|chanp-&gt;proc
)paren
suffix:semicolon
id|chanp-&gt;Flags
op_assign
l_int|0
suffix:semicolon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;lc_d-&gt;lcfi
comma
id|EV_LC_RELEASE
comma
l_int|NULL
)paren
suffix:semicolon
)brace
id|chanp-&gt;cs
op_member_access_from_pointer
id|cardmsg
c_func
(paren
id|chanp-&gt;cs
comma
id|MDL_INFO_REL
comma
(paren
r_void
op_star
)paren
id|chanp-&gt;chan
)paren
suffix:semicolon
)brace
multiline_comment|/* *INDENT-OFF* */
DECL|variable|HISAX_INITDATA
r_static
r_struct
id|FsmNode
id|fnlist
(braket
)braket
id|HISAX_INITDATA
op_assign
(brace
(brace
id|ST_NULL
comma
id|EV_DIAL
comma
id|lli_prep_dialout
)brace
comma
(brace
id|ST_NULL
comma
id|EV_SETUP_IND
comma
id|lli_deliver_call
)brace
comma
(brace
id|ST_NULL
comma
id|EV_SHUTDOWN_D
comma
id|lli_shutdown_d
)brace
comma
(brace
id|ST_NULL
comma
id|EV_DLRL
comma
id|lli_go_null
)brace
comma
(brace
id|ST_NULL
comma
id|EV_DLEST
comma
id|lli_d_established
)brace
comma
(brace
id|ST_NULL
comma
id|EV_ESTABLISH
comma
id|lli_establish_d
)brace
comma
(brace
id|ST_OUT_WAIT_D
comma
id|EV_DLEST
comma
id|lli_do_dialout
)brace
comma
(brace
id|ST_OUT_WAIT_D
comma
id|EV_DLRL
comma
id|lli_no_dchan
)brace
comma
(brace
id|ST_OUT_WAIT_D
comma
id|EV_HANGUP
comma
id|lli_no_dchan
)brace
comma
(brace
id|ST_IN_WAIT_D
comma
id|EV_DLEST
comma
id|lli_do_action
)brace
comma
(brace
id|ST_IN_WAIT_D
comma
id|EV_DLRL
comma
id|lli_no_dchan_in
)brace
comma
(brace
id|ST_IN_WAIT_D
comma
id|EV_ACCEPTD
comma
id|lli_start_dchan
)brace
comma
(brace
id|ST_IN_WAIT_D
comma
id|EV_HANGUP
comma
id|lli_start_dchan
)brace
comma
(brace
id|ST_OUT_DIAL
comma
id|EV_SETUP_CNF
comma
id|lli_init_bchan_out
)brace
comma
(brace
id|ST_OUT_DIAL
comma
id|EV_HANGUP
comma
id|lli_cancel_call
)brace
comma
(brace
id|ST_OUT_DIAL
comma
id|EV_DISCONNECT_IND
comma
id|lli_received_d_disc
)brace
comma
(brace
id|ST_OUT_DIAL
comma
id|EV_RELEASE_IND
comma
id|lli_received_d_rel
)brace
comma
(brace
id|ST_OUT_DIAL
comma
id|EV_RELEASE_CNF
comma
id|lli_received_d_relcnf
)brace
comma
(brace
id|ST_OUT_DIAL
comma
id|EV_NOSETUP_RSP
comma
id|lli_no_setup_rsp
)brace
comma
(brace
id|ST_OUT_DIAL
comma
id|EV_SETUP_ERR
comma
id|lli_setup_err
)brace
comma
(brace
id|ST_OUT_DIAL
comma
id|EV_DLRL
comma
id|lli_got_dlrl
)brace
comma
(brace
id|ST_IN_WAIT_LL
comma
id|EV_DLEST
comma
id|lli_d_established
)brace
comma
(brace
id|ST_IN_WAIT_LL
comma
id|EV_DLRL
comma
id|lli_d_released
)brace
comma
(brace
id|ST_IN_WAIT_LL
comma
id|EV_ACCEPTD
comma
id|lli_start_dchan
)brace
comma
(brace
id|ST_IN_WAIT_LL
comma
id|EV_HANGUP
comma
id|lli_start_dchan
)brace
comma
(brace
id|ST_IN_WAIT_LL
comma
id|EV_DISCONNECT_IND
comma
id|lli_received_d_disc
)brace
comma
(brace
id|ST_IN_WAIT_LL
comma
id|EV_RELEASE_IND
comma
id|lli_received_d_rel
)brace
comma
(brace
id|ST_IN_WAIT_LL
comma
id|EV_RELEASE_CNF
comma
id|lli_received_d_relcnf
)brace
comma
(brace
id|ST_IN_ALERT_SEND
comma
id|EV_SETUP_CMPL_IND
comma
id|lli_init_bchan_in
)brace
comma
(brace
id|ST_IN_ALERT_SEND
comma
id|EV_ACCEPTD
comma
id|lli_send_dconnect
)brace
comma
(brace
id|ST_IN_ALERT_SEND
comma
id|EV_HANGUP
comma
id|lli_send_d_disc
)brace
comma
(brace
id|ST_IN_ALERT_SEND
comma
id|EV_DISCONNECT_IND
comma
id|lli_received_d_disc
)brace
comma
(brace
id|ST_IN_ALERT_SEND
comma
id|EV_RELEASE_IND
comma
id|lli_received_d_rel
)brace
comma
(brace
id|ST_IN_ALERT_SEND
comma
id|EV_RELEASE_CNF
comma
id|lli_received_d_relcnf
)brace
comma
(brace
id|ST_IN_ALERT_SEND
comma
id|EV_DLRL
comma
id|lli_got_dlrl
)brace
comma
(brace
id|ST_IN_WAIT_CONN_ACK
comma
id|EV_SETUP_CMPL_IND
comma
id|lli_init_bchan_in
)brace
comma
(brace
id|ST_IN_WAIT_CONN_ACK
comma
id|EV_HANGUP
comma
id|lli_send_d_disc
)brace
comma
(brace
id|ST_IN_WAIT_CONN_ACK
comma
id|EV_DISCONNECT_IND
comma
id|lli_received_d_disc
)brace
comma
(brace
id|ST_IN_WAIT_CONN_ACK
comma
id|EV_RELEASE_IND
comma
id|lli_received_d_rel
)brace
comma
(brace
id|ST_IN_WAIT_CONN_ACK
comma
id|EV_RELEASE_CNF
comma
id|lli_received_d_relcnf
)brace
comma
(brace
id|ST_IN_WAIT_CONN_ACK
comma
id|EV_CONNECT_ERR
comma
id|lli_connect_err
)brace
comma
(brace
id|ST_IN_WAIT_CONN_ACK
comma
id|EV_DLRL
comma
id|lli_got_dlrl
)brace
comma
(brace
id|ST_WAIT_BCONN
comma
id|EV_BC_EST
comma
id|lli_go_active
)brace
comma
(brace
id|ST_WAIT_BCONN
comma
id|EV_BC_REL
comma
id|lli_send_d_disc
)brace
comma
(brace
id|ST_WAIT_BCONN
comma
id|EV_HANGUP
comma
id|lli_send_d_disc
)brace
comma
(brace
id|ST_WAIT_BCONN
comma
id|EV_DISCONNECT_IND
comma
id|lli_received_d_disc
)brace
comma
(brace
id|ST_WAIT_BCONN
comma
id|EV_RELEASE_IND
comma
id|lli_received_d_rel
)brace
comma
(brace
id|ST_WAIT_BCONN
comma
id|EV_RELEASE_CNF
comma
id|lli_received_d_relcnf
)brace
comma
(brace
id|ST_WAIT_BCONN
comma
id|EV_DLRL
comma
id|lli_got_dlrl
)brace
comma
(brace
id|ST_WAIT_BCONN
comma
id|EV_CINF
comma
id|lli_charge_info
)brace
comma
(brace
id|ST_ACTIVE
comma
id|EV_CINF
comma
id|lli_charge_info
)brace
comma
(brace
id|ST_ACTIVE
comma
id|EV_BC_REL
comma
id|lli_released_bchan
)brace
comma
(brace
id|ST_ACTIVE
comma
id|EV_HANGUP
comma
id|lli_disconn_bchan
)brace
comma
(brace
id|ST_ACTIVE
comma
id|EV_DISCONNECT_IND
comma
id|lli_release_bchan
)brace
comma
(brace
id|ST_ACTIVE
comma
id|EV_RELEASE_CNF
comma
id|lli_received_d_relcnf
)brace
comma
(brace
id|ST_ACTIVE
comma
id|EV_RELEASE_IND
comma
id|lli_received_d_rel
)brace
comma
(brace
id|ST_ACTIVE
comma
id|EV_DLRL
comma
id|lli_got_dlrl
)brace
comma
(brace
id|ST_WAIT_BRELEASE
comma
id|EV_BC_REL
comma
id|lli_send_d_disc
)brace
comma
(brace
id|ST_WAIT_BRELEASE
comma
id|EV_DISCONNECT_IND
comma
id|lli_received_d_disc
)brace
comma
(brace
id|ST_WAIT_BRELEASE
comma
id|EV_RELEASE_CNF
comma
id|lli_received_d_relcnf
)brace
comma
(brace
id|ST_WAIT_BRELEASE
comma
id|EV_RELEASE_IND
comma
id|lli_received_d_rel
)brace
comma
(brace
id|ST_WAIT_BRELEASE
comma
id|EV_DLRL
comma
id|lli_got_dlrl
)brace
comma
(brace
id|ST_WAIT_BREL_DISC
comma
id|EV_BC_REL
comma
id|lli_received_d_disc
)brace
comma
(brace
id|ST_WAIT_BREL_DISC
comma
id|EV_RELEASE_CNF
comma
id|lli_received_d_relcnf
)brace
comma
(brace
id|ST_WAIT_BREL_DISC
comma
id|EV_RELEASE_IND
comma
id|lli_received_d_rel
)brace
comma
(brace
id|ST_WAIT_BREL_DISC
comma
id|EV_DLRL
comma
id|lli_got_dlrl
)brace
comma
(brace
id|ST_WAIT_DCOMMAND
comma
id|EV_HANGUP
comma
id|lli_send_d_disc
)brace
comma
(brace
id|ST_WAIT_DCOMMAND
comma
id|EV_DISCONNECT_IND
comma
id|lli_received_d_disc
)brace
comma
(brace
id|ST_WAIT_DCOMMAND
comma
id|EV_RELEASE_CNF
comma
id|lli_received_d_relcnf
)brace
comma
(brace
id|ST_WAIT_DCOMMAND
comma
id|EV_RELEASE_IND
comma
id|lli_received_d_rel
)brace
comma
(brace
id|ST_WAIT_DCOMMAND
comma
id|EV_DLRL
comma
id|lli_got_dlrl
)brace
comma
(brace
id|ST_WAIT_DRELEASE
comma
id|EV_RELEASE_IND
comma
id|lli_timeout_d
)brace
comma
(brace
id|ST_WAIT_DRELEASE
comma
id|EV_RELEASE_CNF
comma
id|lli_timeout_d
)brace
comma
(brace
id|ST_WAIT_DRELEASE
comma
id|EV_RELEASE_ERR
comma
id|lli_timeout_d
)brace
comma
(brace
id|ST_WAIT_DRELEASE
comma
id|EV_DIAL
comma
id|lli_no_dchan_ready
)brace
comma
(brace
id|ST_WAIT_DRELEASE
comma
id|EV_DLRL
comma
id|lli_got_dlrl
)brace
comma
(brace
id|ST_WAIT_D_REL_CNF
comma
id|EV_RELEASE_CNF
comma
id|lli_timeout_d
)brace
comma
(brace
id|ST_WAIT_D_REL_CNF
comma
id|EV_RELEASE_ERR
comma
id|lli_timeout_d
)brace
comma
multiline_comment|/* ETS 300-104 16.1 */
(brace
id|ST_WAIT_D_REL_CNF
comma
id|EV_RELEASE_IND
comma
id|lli_timeout_d
)brace
comma
(brace
id|ST_WAIT_D_REL_CNF
comma
id|EV_DIAL
comma
id|lli_no_dchan_ready
)brace
comma
(brace
id|ST_WAIT_D_REL_CNF
comma
id|EV_DLRL
comma
id|lli_got_dlrl
)brace
comma
(brace
id|ST_WAIT_DSHUTDOWN
comma
id|EV_DLRL
comma
id|lli_go_null
)brace
comma
(brace
id|ST_WAIT_DSHUTDOWN
comma
id|EV_DLEST
comma
id|lli_d_established
)brace
comma
(brace
id|ST_WAIT_DSHUTDOWN
comma
id|EV_DIAL
comma
id|lli_prep_dialout
)brace
comma
(brace
id|ST_WAIT_DSHUTDOWN
comma
id|EV_SETUP_IND
comma
id|lli_deliver_call
)brace
comma
)brace
suffix:semicolon
multiline_comment|/* *INDENT-ON* */
DECL|macro|FNCOUNT
mdefine_line|#define FNCOUNT (sizeof(fnlist)/sizeof(struct FsmNode))
r_static
r_void
DECL|function|lc_activate_l1
id|lc_activate_l1
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|LcFsm
op_star
id|lf
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|FsmDelTimer
c_func
(paren
op_amp
id|lf-&gt;act_timer
comma
l_int|50
)paren
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_LC_ACTIVATE_WAIT
)paren
suffix:semicolon
multiline_comment|/* This timeout is to avoid a hang if no L1 activation is possible */
id|FsmAddTimer
c_func
(paren
op_amp
id|lf-&gt;act_timer
comma
l_int|30000
comma
id|EV_LC_TIMER
comma
l_int|NULL
comma
l_int|50
)paren
suffix:semicolon
id|lf-&gt;st-&gt;ma
dot
id|manl1
c_func
(paren
id|lf-&gt;st
comma
id|PH_ACTIVATE_REQ
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|lc_activated_from_l1
id|lc_activated_from_l1
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|LcFsm
op_star
id|lf
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_if
c_cond
(paren
id|lf-&gt;l2_establish
)paren
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_LC_DELAY
)paren
suffix:semicolon
r_else
(brace
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_LC_CONNECTED
)paren
suffix:semicolon
id|lf
op_member_access_from_pointer
id|lccall
c_func
(paren
id|lf
comma
id|LC_ESTABLISH
comma
l_int|NULL
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|lc_l1_activated
id|lc_l1_activated
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|LcFsm
op_star
id|lf
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|FsmDelTimer
c_func
(paren
op_amp
id|lf-&gt;act_timer
comma
l_int|50
)paren
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_LC_DELAY
)paren
suffix:semicolon
multiline_comment|/* This timer is needed for delay the first paket on a channel&n;&t;   to be shure that the other side is ready too */
r_if
c_cond
(paren
id|lf-&gt;delay
)paren
id|FsmAddTimer
c_func
(paren
op_amp
id|lf-&gt;act_timer
comma
id|lf-&gt;delay
comma
id|EV_LC_TIMER
comma
l_int|NULL
comma
l_int|51
)paren
suffix:semicolon
r_else
id|FsmEvent
c_func
(paren
id|fi
comma
id|EV_LC_TIMER
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|lc_start_l2
id|lc_start_l2
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|LcFsm
op_star
id|lf
op_assign
id|fi-&gt;userdata
suffix:semicolon
multiline_comment|/*&t;if (!lf-&gt;st-&gt;l1.act_state)&n;&t;&t;lf-&gt;st-&gt;l1.act_state = 2;&n;*/
r_if
c_cond
(paren
id|lf-&gt;l2_establish
)paren
(brace
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_LC_ESTABLISH_WAIT
)paren
suffix:semicolon
r_if
c_cond
(paren
id|lf-&gt;l2_start
)paren
id|lf-&gt;st-&gt;ma
dot
id|manl2
c_func
(paren
id|lf-&gt;st
comma
id|DL_ESTABLISH
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_else
(brace
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_LC_CONNECTED
)paren
suffix:semicolon
id|lf
op_member_access_from_pointer
id|lccall
c_func
(paren
id|lf
comma
id|LC_ESTABLISH
comma
l_int|NULL
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|lc_connected
id|lc_connected
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|LcFsm
op_star
id|lf
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|FsmDelTimer
c_func
(paren
op_amp
id|lf-&gt;act_timer
comma
l_int|50
)paren
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_LC_CONNECTED
)paren
suffix:semicolon
id|lf
op_member_access_from_pointer
id|lccall
c_func
(paren
id|lf
comma
id|LC_ESTABLISH
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|lc_release_l2
id|lc_release_l2
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|LcFsm
op_star
id|lf
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_if
c_cond
(paren
id|lf-&gt;l2_establish
)paren
(brace
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_LC_RELEASE_WAIT
)paren
suffix:semicolon
id|lf-&gt;st-&gt;ma
dot
id|manl2
c_func
(paren
id|lf-&gt;st
comma
id|DL_RELEASE
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_else
(brace
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_LC_NULL
)paren
suffix:semicolon
id|lf-&gt;st-&gt;ma
dot
id|manl1
c_func
(paren
id|lf-&gt;st
comma
id|PH_DEACTIVATE_REQ
comma
l_int|NULL
)paren
suffix:semicolon
id|lf
op_member_access_from_pointer
id|lccall
c_func
(paren
id|lf
comma
id|LC_RELEASE
comma
l_int|NULL
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|lc_l2_released
id|lc_l2_released
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|LcFsm
op_star
id|lf
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_LC_RELEASE_WAIT
)paren
suffix:semicolon
id|FsmDelTimer
c_func
(paren
op_amp
id|lf-&gt;act_timer
comma
l_int|51
)paren
suffix:semicolon
multiline_comment|/* This delay is needed for send out the UA frame before&n;&t; * PH_DEACTIVATE the interface&n;&t; */
id|FsmAddTimer
c_func
(paren
op_amp
id|lf-&gt;act_timer
comma
l_int|20
comma
id|EV_LC_TIMER
comma
l_int|NULL
comma
l_int|54
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|lc_release_l1
id|lc_release_l1
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|LcFsm
op_star
id|lf
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|FsmDelTimer
c_func
(paren
op_amp
id|lf-&gt;act_timer
comma
l_int|54
)paren
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_LC_NULL
)paren
suffix:semicolon
id|lf-&gt;st-&gt;ma
dot
id|manl1
c_func
(paren
id|lf-&gt;st
comma
id|PH_DEACTIVATE_REQ
comma
l_int|NULL
)paren
suffix:semicolon
id|lf
op_member_access_from_pointer
id|lccall
c_func
(paren
id|lf
comma
id|LC_RELEASE
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|lc_l1_deactivated
id|lc_l1_deactivated
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|LcFsm
op_star
id|lf
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|FsmDelTimer
c_func
(paren
op_amp
id|lf-&gt;act_timer
comma
l_int|54
)paren
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_LC_NULL
)paren
suffix:semicolon
id|lf
op_member_access_from_pointer
id|lccall
c_func
(paren
id|lf
comma
id|LC_RELEASE
comma
l_int|NULL
)paren
suffix:semicolon
)brace
multiline_comment|/* *INDENT-OFF* */
DECL|variable|HISAX_INITDATA
r_static
r_struct
id|FsmNode
id|LcFnList
(braket
)braket
id|HISAX_INITDATA
op_assign
(brace
(brace
id|ST_LC_NULL
comma
id|EV_LC_ESTABLISH
comma
id|lc_activate_l1
)brace
comma
(brace
id|ST_LC_NULL
comma
id|EV_LC_PH_ACTIVATE
comma
id|lc_activated_from_l1
)brace
comma
(brace
id|ST_LC_NULL
comma
id|EV_LC_DL_ESTABLISH
comma
id|lc_connected
)brace
comma
(brace
id|ST_LC_ACTIVATE_WAIT
comma
id|EV_LC_PH_ACTIVATE
comma
id|lc_l1_activated
)brace
comma
(brace
id|ST_LC_ACTIVATE_WAIT
comma
id|EV_LC_TIMER
comma
id|lc_release_l1
)brace
comma
(brace
id|ST_LC_ACTIVATE_WAIT
comma
id|EV_LC_PH_DEACTIVATE
comma
id|lc_l1_deactivated
)brace
comma
(brace
id|ST_LC_DELAY
comma
id|EV_LC_ESTABLISH
comma
id|lc_start_l2
)brace
comma
(brace
id|ST_LC_DELAY
comma
id|EV_LC_TIMER
comma
id|lc_start_l2
)brace
comma
(brace
id|ST_LC_DELAY
comma
id|EV_LC_DL_ESTABLISH
comma
id|lc_connected
)brace
comma
(brace
id|ST_LC_DELAY
comma
id|EV_LC_PH_DEACTIVATE
comma
id|lc_l1_deactivated
)brace
comma
(brace
id|ST_LC_ESTABLISH_WAIT
comma
id|EV_LC_DL_ESTABLISH
comma
id|lc_connected
)brace
comma
(brace
id|ST_LC_ESTABLISH_WAIT
comma
id|EV_LC_RELEASE
comma
id|lc_release_l1
)brace
comma
(brace
id|ST_LC_ESTABLISH_WAIT
comma
id|EV_LC_DL_RELEASE
comma
id|lc_release_l1
)brace
comma
(brace
id|ST_LC_ESTABLISH_WAIT
comma
id|EV_LC_PH_DEACTIVATE
comma
id|lc_l1_deactivated
)brace
comma
(brace
id|ST_LC_CONNECTED
comma
id|EV_LC_ESTABLISH
comma
id|lc_connected
)brace
comma
(brace
id|ST_LC_CONNECTED
comma
id|EV_LC_RELEASE
comma
id|lc_release_l2
)brace
comma
(brace
id|ST_LC_CONNECTED
comma
id|EV_LC_DL_RELEASE
comma
id|lc_l2_released
)brace
comma
(brace
id|ST_LC_CONNECTED
comma
id|EV_LC_PH_DEACTIVATE
comma
id|lc_l1_deactivated
)brace
comma
(brace
id|ST_LC_FLUSH_WAIT
comma
id|EV_LC_TIMER
comma
id|lc_release_l2
)brace
comma
(brace
id|ST_LC_FLUSH_WAIT
comma
id|EV_LC_PH_DEACTIVATE
comma
id|lc_l1_deactivated
)brace
comma
(brace
id|ST_LC_RELEASE_WAIT
comma
id|EV_LC_DL_RELEASE
comma
id|lc_release_l1
)brace
comma
(brace
id|ST_LC_RELEASE_WAIT
comma
id|EV_LC_TIMER
comma
id|lc_release_l1
)brace
comma
(brace
id|ST_LC_FLUSH_WAIT
comma
id|EV_LC_PH_DEACTIVATE
comma
id|lc_l1_deactivated
)brace
comma
)brace
suffix:semicolon
multiline_comment|/* *INDENT-ON* */
DECL|macro|LC_FN_COUNT
mdefine_line|#define LC_FN_COUNT (sizeof(LcFnList)/sizeof(struct FsmNode))
DECL|function|HISAX_INITFUNC
id|HISAX_INITFUNC
c_func
(paren
r_void
id|CallcNew
c_func
(paren
r_void
)paren
)paren
(brace
id|callcfsm.state_count
op_assign
id|STATE_COUNT
suffix:semicolon
id|callcfsm.event_count
op_assign
id|EVENT_COUNT
suffix:semicolon
id|callcfsm.strEvent
op_assign
id|strEvent
suffix:semicolon
id|callcfsm.strState
op_assign
id|strState
suffix:semicolon
id|FsmNew
c_func
(paren
op_amp
id|callcfsm
comma
id|fnlist
comma
id|FNCOUNT
)paren
suffix:semicolon
id|lcfsm.state_count
op_assign
id|LC_STATE_COUNT
suffix:semicolon
id|lcfsm.event_count
op_assign
id|LC_EVENT_COUNT
suffix:semicolon
id|lcfsm.strEvent
op_assign
id|strLcEvent
suffix:semicolon
id|lcfsm.strState
op_assign
id|strLcState
suffix:semicolon
id|FsmNew
c_func
(paren
op_amp
id|lcfsm
comma
id|LcFnList
comma
id|LC_FN_COUNT
)paren
suffix:semicolon
)brace
r_void
DECL|function|CallcFree
id|CallcFree
c_func
(paren
r_void
)paren
(brace
id|FsmFree
c_func
(paren
op_amp
id|lcfsm
)paren
suffix:semicolon
id|FsmFree
c_func
(paren
op_amp
id|callcfsm
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|release_b_st
id|release_b_st
c_func
(paren
r_struct
id|Channel
op_star
id|chanp
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|chanp-&gt;b_st
suffix:semicolon
id|chanp-&gt;bcs
op_member_access_from_pointer
id|BC_Close
c_func
(paren
id|chanp-&gt;bcs
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|chanp-&gt;l2_active_protocol
)paren
(brace
r_case
(paren
id|ISDN_PROTO_L2_X75I
)paren
suffix:colon
id|releasestack_isdnl2
c_func
(paren
id|st
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|ISDN_PROTO_L2_HDLC
)paren
suffix:colon
r_case
(paren
id|ISDN_PROTO_L2_TRANS
)paren
suffix:colon
id|releasestack_transl2
c_func
(paren
id|st
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
multiline_comment|/* Reset B-Channel Statemachine */
id|FsmDelTimer
c_func
(paren
op_amp
id|chanp-&gt;lc_b-&gt;act_timer
comma
l_int|79
)paren
suffix:semicolon
id|FsmChangeState
c_func
(paren
op_amp
id|chanp-&gt;lc_b-&gt;lcfi
comma
id|ST_LC_NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|dc_l1man
id|dc_l1man
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
suffix:semicolon
id|chanp
op_assign
(paren
r_struct
id|Channel
op_star
)paren
id|st-&gt;lli.userdata
suffix:semicolon
r_switch
c_cond
(paren
id|pr
)paren
(brace
r_case
(paren
id|PH_ACTIVATE_CNF
)paren
suffix:colon
r_case
(paren
id|PH_ACTIVATE_IND
)paren
suffix:colon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;lc_d-&gt;lcfi
comma
id|EV_LC_PH_ACTIVATE
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|PH_DEACTIVATE_IND
)paren
suffix:colon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;lc_d-&gt;lcfi
comma
id|EV_LC_PH_DEACTIVATE
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|dc_l2man
id|dc_l2man
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
(paren
r_struct
id|Channel
op_star
)paren
id|st-&gt;lli.userdata
suffix:semicolon
r_switch
c_cond
(paren
id|pr
)paren
(brace
r_case
(paren
id|DL_ESTABLISH
)paren
suffix:colon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;lc_d-&gt;lcfi
comma
id|EV_LC_DL_ESTABLISH
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|DL_RELEASE
)paren
suffix:colon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;lc_d-&gt;lcfi
comma
id|EV_LC_DL_RELEASE
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|bc_l1man
id|bc_l1man
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
(paren
r_struct
id|Channel
op_star
)paren
id|st-&gt;lli.userdata
suffix:semicolon
r_switch
c_cond
(paren
id|pr
)paren
(brace
r_case
(paren
id|PH_ACTIVATE_IND
)paren
suffix:colon
r_case
(paren
id|PH_ACTIVATE_CNF
)paren
suffix:colon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;lc_b-&gt;lcfi
comma
id|EV_LC_PH_ACTIVATE
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|PH_DEACTIVATE_IND
)paren
suffix:colon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;lc_b-&gt;lcfi
comma
id|EV_LC_PH_DEACTIVATE
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|bc_l2man
id|bc_l2man
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
(paren
r_struct
id|Channel
op_star
)paren
id|st-&gt;lli.userdata
suffix:semicolon
r_switch
c_cond
(paren
id|pr
)paren
(brace
r_case
(paren
id|DL_ESTABLISH
)paren
suffix:colon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;lc_b-&gt;lcfi
comma
id|EV_LC_DL_ESTABLISH
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|DL_RELEASE
)paren
suffix:colon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;lc_b-&gt;lcfi
comma
id|EV_LC_DL_RELEASE
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_struct
id|Channel
DECL|function|selectfreechannel
op_star
id|selectfreechannel
c_func
(paren
r_struct
id|PStack
op_star
id|st
)paren
(brace
r_struct
id|IsdnCardState
op_star
id|cs
op_assign
id|st-&gt;l1.hardware
suffix:semicolon
r_struct
id|Channel
op_star
id|chanp
op_assign
id|st-&gt;lli.userdata
suffix:semicolon
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_TWO_DCHAN
comma
op_amp
id|cs-&gt;HW_Flags
)paren
)paren
id|i
op_assign
l_int|1
suffix:semicolon
r_else
id|i
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|i
OL
l_int|2
)paren
(brace
r_if
c_cond
(paren
id|chanp-&gt;fi.state
op_eq
id|ST_NULL
)paren
r_return
(paren
id|chanp
)paren
suffix:semicolon
id|chanp
op_increment
suffix:semicolon
id|i
op_increment
suffix:semicolon
)brace
r_return
(paren
l_int|NULL
)paren
suffix:semicolon
)brace
r_int
DECL|function|is_activ
id|is_activ
c_func
(paren
r_struct
id|PStack
op_star
id|st
)paren
(brace
r_struct
id|IsdnCardState
op_star
id|cs
op_assign
id|st-&gt;l1.hardware
suffix:semicolon
r_struct
id|Channel
op_star
id|chanp
op_assign
id|st-&gt;lli.userdata
suffix:semicolon
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_TWO_DCHAN
comma
op_amp
id|cs-&gt;HW_Flags
)paren
)paren
id|i
op_assign
l_int|1
suffix:semicolon
r_else
id|i
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|i
OL
l_int|2
)paren
(brace
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_ESTAB_D
comma
op_amp
id|chanp-&gt;Flags
)paren
)paren
r_return
(paren
l_int|1
)paren
suffix:semicolon
id|chanp
op_increment
suffix:semicolon
id|i
op_increment
suffix:semicolon
)brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|ll_handler
id|ll_handler
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
r_int
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
suffix:semicolon
r_char
id|tmp
(braket
l_int|64
)braket
comma
id|tm
(braket
l_int|32
)braket
suffix:semicolon
r_if
c_cond
(paren
id|pr
op_eq
id|CC_SETUP_IND
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|chanp
op_assign
id|selectfreechannel
c_func
(paren
id|pc-&gt;st
)paren
)paren
)paren
(brace
id|pc-&gt;st-&gt;lli
dot
id|l4l3
c_func
(paren
id|pc-&gt;st
comma
id|CC_DLRL
comma
id|pc
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_else
(brace
id|chanp-&gt;proc
op_assign
id|pc
suffix:semicolon
id|pc-&gt;chan
op_assign
id|chanp
suffix:semicolon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;fi
comma
id|EV_SETUP_IND
comma
l_int|NULL
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|pr
op_eq
id|CC_ESTABLISH
)paren
(brace
r_if
c_cond
(paren
id|is_activ
c_func
(paren
id|pc-&gt;st
)paren
)paren
(brace
id|pc-&gt;st-&gt;lli
dot
id|l4l3
c_func
(paren
id|pc-&gt;st
comma
id|CC_ESTABLISH
comma
id|pc
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
(paren
id|chanp
op_assign
id|selectfreechannel
c_func
(paren
id|pc-&gt;st
)paren
)paren
)paren
(brace
id|pc-&gt;st-&gt;lli
dot
id|l4l3
c_func
(paren
id|pc-&gt;st
comma
id|CC_DLRL
comma
id|pc
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_else
(brace
id|chanp-&gt;proc
op_assign
id|pc
suffix:semicolon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;fi
comma
id|EV_ESTABLISH
comma
l_int|NULL
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
)brace
id|chanp
op_assign
id|pc-&gt;chan
suffix:semicolon
r_switch
c_cond
(paren
id|pr
)paren
(brace
r_case
(paren
id|CC_DISCONNECT_IND
)paren
suffix:colon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;fi
comma
id|EV_DISCONNECT_IND
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|CC_RELEASE_CNF
)paren
suffix:colon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;fi
comma
id|EV_RELEASE_CNF
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|CC_RELEASE_IND
)paren
suffix:colon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;fi
comma
id|EV_RELEASE_IND
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|CC_SETUP_COMPLETE_IND
)paren
suffix:colon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;fi
comma
id|EV_SETUP_CMPL_IND
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|CC_SETUP_CNF
)paren
suffix:colon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;fi
comma
id|EV_SETUP_CNF
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|CC_INFO_CHARGE
)paren
suffix:colon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;fi
comma
id|EV_CINF
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|CC_NOSETUP_RSP_ERR
)paren
suffix:colon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;fi
comma
id|EV_NOSETUP_RSP
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|CC_SETUP_ERR
)paren
suffix:colon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;fi
comma
id|EV_SETUP_ERR
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|CC_CONNECT_ERR
)paren
suffix:colon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;fi
comma
id|EV_CONNECT_ERR
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|CC_RELEASE_ERR
)paren
suffix:colon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;fi
comma
id|EV_RELEASE_ERR
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|CC_PROCEEDING_IND
)paren
suffix:colon
r_case
(paren
id|CC_ALERTING_IND
)paren
suffix:colon
r_break
suffix:semicolon
r_default
suffix:colon
(brace
)brace
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|0x800
)paren
(brace
id|jiftime
c_func
(paren
id|tm
comma
id|jiffies
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;%s Channel %d L3-&gt;L4 unknown primitiv %d&bslash;n&quot;
comma
id|tm
comma
id|chanp-&gt;chan
comma
id|pr
)paren
suffix:semicolon
id|HiSax_putstatus
c_func
(paren
id|chanp-&gt;cs
comma
id|tmp
)paren
suffix:semicolon
)brace
)brace
)brace
r_static
r_void
DECL|function|init_d_st
id|init_d_st
c_func
(paren
r_struct
id|Channel
op_star
id|chanp
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|chanp-&gt;d_st
suffix:semicolon
r_struct
id|IsdnCardState
op_star
id|cs
op_assign
id|chanp-&gt;cs
suffix:semicolon
r_char
id|tmp
(braket
l_int|128
)braket
suffix:semicolon
id|HiSax_addlist
c_func
(paren
id|cs
comma
id|st
)paren
suffix:semicolon
id|setstack_HiSax
c_func
(paren
id|st
comma
id|cs
)paren
suffix:semicolon
id|st-&gt;l2.sap
op_assign
l_int|0
suffix:semicolon
id|st-&gt;l2.tei
op_assign
op_minus
l_int|1
suffix:semicolon
id|st-&gt;l2.flag
op_assign
l_int|0
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_MOD128
comma
op_amp
id|st-&gt;l2.flag
)paren
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_LAPD
comma
op_amp
id|st-&gt;l2.flag
)paren
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_ORIG
comma
op_amp
id|st-&gt;l2.flag
)paren
suffix:semicolon
id|st-&gt;l2.maxlen
op_assign
id|MAX_DFRAME_LEN
suffix:semicolon
id|st-&gt;l2.window
op_assign
l_int|1
suffix:semicolon
id|st-&gt;l2.T200
op_assign
l_int|1000
suffix:semicolon
multiline_comment|/* 1000 milliseconds  */
id|st-&gt;l2.N200
op_assign
l_int|3
suffix:semicolon
multiline_comment|/* try 3 times        */
r_if
c_cond
(paren
id|st-&gt;protocol
op_eq
id|ISDN_PTYPE_1TR6
)paren
id|st-&gt;l2.T203
op_assign
l_int|10000
suffix:semicolon
multiline_comment|/* 10000 milliseconds */
r_else
id|st-&gt;l2.T203
op_assign
l_int|10000
suffix:semicolon
multiline_comment|/* 5000 milliseconds  */
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;Channel %d q.921&quot;
comma
id|chanp-&gt;chan
)paren
suffix:semicolon
id|setstack_isdnl2
c_func
(paren
id|st
comma
id|tmp
)paren
suffix:semicolon
id|setstack_isdnl3
c_func
(paren
id|st
comma
id|chanp
)paren
suffix:semicolon
id|st-&gt;lli.userdata
op_assign
id|chanp
suffix:semicolon
id|st-&gt;lli.l2writewakeup
op_assign
l_int|NULL
suffix:semicolon
id|st-&gt;l3.l3l4
op_assign
id|ll_handler
suffix:semicolon
id|st-&gt;l1.l1man
op_assign
id|dc_l1man
suffix:semicolon
id|st-&gt;l2.l2man
op_assign
id|dc_l2man
suffix:semicolon
)brace
r_static
r_void
DECL|function|callc_debug
id|callc_debug
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_char
op_star
id|s
)paren
(brace
r_char
id|str
(braket
l_int|80
)braket
comma
id|tm
(braket
l_int|32
)braket
suffix:semicolon
r_struct
id|Channel
op_star
id|chanp
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|jiftime
c_func
(paren
id|tm
comma
id|jiffies
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|str
comma
l_string|&quot;%s Channel %d callc %s&bslash;n&quot;
comma
id|tm
comma
id|chanp-&gt;chan
comma
id|s
)paren
suffix:semicolon
id|HiSax_putstatus
c_func
(paren
id|chanp-&gt;cs
comma
id|str
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|lc_debug
id|lc_debug
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_char
op_star
id|s
)paren
(brace
r_char
id|str
(braket
l_int|256
)braket
comma
id|tm
(braket
l_int|32
)braket
suffix:semicolon
r_struct
id|LcFsm
op_star
id|lf
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|jiftime
c_func
(paren
id|tm
comma
id|jiffies
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|str
comma
l_string|&quot;%s Channel %d dc %s&bslash;n&quot;
comma
id|tm
comma
id|lf-&gt;ch-&gt;chan
comma
id|s
)paren
suffix:semicolon
id|HiSax_putstatus
c_func
(paren
id|lf-&gt;ch-&gt;cs
comma
id|str
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|dlc_debug
id|dlc_debug
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_char
op_star
id|s
)paren
(brace
r_char
id|str
(braket
l_int|256
)braket
comma
id|tm
(braket
l_int|32
)braket
suffix:semicolon
r_struct
id|LcFsm
op_star
id|lf
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|jiftime
c_func
(paren
id|tm
comma
id|jiffies
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|str
comma
l_string|&quot;%s Channel %d bc %s&bslash;n&quot;
comma
id|tm
comma
id|lf-&gt;ch-&gt;chan
comma
id|s
)paren
suffix:semicolon
id|HiSax_putstatus
c_func
(paren
id|lf-&gt;ch-&gt;cs
comma
id|str
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|lccall_d
id|lccall_d
c_func
(paren
r_struct
id|LcFsm
op_star
id|lf
comma
r_int
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|IsdnCardState
op_star
id|cs
op_assign
id|lf-&gt;st-&gt;l1.hardware
suffix:semicolon
r_struct
id|Channel
op_star
id|chanp
suffix:semicolon
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_TWO_DCHAN
comma
op_amp
id|cs-&gt;HW_Flags
)paren
)paren
(brace
id|chanp
op_assign
id|lf-&gt;ch
suffix:semicolon
id|i
op_assign
l_int|1
suffix:semicolon
)brace
r_else
(brace
id|chanp
op_assign
id|cs-&gt;channel
suffix:semicolon
id|i
op_assign
l_int|0
suffix:semicolon
)brace
r_while
c_loop
(paren
id|i
OL
l_int|2
)paren
(brace
r_switch
c_cond
(paren
id|pr
)paren
(brace
r_case
(paren
id|LC_ESTABLISH
)paren
suffix:colon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;fi
comma
id|EV_DLEST
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|LC_RELEASE
)paren
suffix:colon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;fi
comma
id|EV_DLRL
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|chanp
op_increment
suffix:semicolon
id|i
op_increment
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|lccall_b
id|lccall_b
c_func
(paren
r_struct
id|LcFsm
op_star
id|lf
comma
r_int
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
id|lf-&gt;ch
suffix:semicolon
r_switch
c_cond
(paren
id|pr
)paren
(brace
r_case
(paren
id|LC_ESTABLISH
)paren
suffix:colon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;fi
comma
id|EV_BC_EST
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|LC_RELEASE
)paren
suffix:colon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;fi
comma
id|EV_BC_REL
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|init_chan
id|init_chan
c_func
(paren
r_int
id|chan
comma
r_struct
id|IsdnCardState
op_star
id|csta
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
id|csta-&gt;channel
op_plus
id|chan
suffix:semicolon
id|chanp-&gt;cs
op_assign
id|csta
suffix:semicolon
id|chanp-&gt;bcs
op_assign
id|csta-&gt;bcs
op_plus
id|chan
suffix:semicolon
id|chanp-&gt;chan
op_assign
id|chan
suffix:semicolon
id|chanp-&gt;incoming
op_assign
l_int|0
suffix:semicolon
id|chanp-&gt;debug
op_assign
l_int|0
suffix:semicolon
id|chanp-&gt;Flags
op_assign
l_int|0
suffix:semicolon
id|chanp-&gt;leased
op_assign
l_int|0
suffix:semicolon
id|chanp-&gt;b_st
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|PStack
)paren
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
id|chanp-&gt;b_st-&gt;next
op_assign
l_int|NULL
suffix:semicolon
id|chanp-&gt;fi.fsm
op_assign
op_amp
id|callcfsm
suffix:semicolon
id|chanp-&gt;fi.state
op_assign
id|ST_NULL
suffix:semicolon
id|chanp-&gt;fi.debug
op_assign
l_int|0
suffix:semicolon
id|chanp-&gt;fi.userdata
op_assign
id|chanp
suffix:semicolon
id|chanp-&gt;fi.printdebug
op_assign
id|callc_debug
suffix:semicolon
id|FsmInitTimer
c_func
(paren
op_amp
id|chanp-&gt;fi
comma
op_amp
id|chanp-&gt;dial_timer
)paren
suffix:semicolon
id|FsmInitTimer
c_func
(paren
op_amp
id|chanp-&gt;fi
comma
op_amp
id|chanp-&gt;drel_timer
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|chan
op_logical_or
id|test_bit
c_func
(paren
id|FLG_TWO_DCHAN
comma
op_amp
id|csta-&gt;HW_Flags
)paren
)paren
(brace
id|chanp-&gt;d_st
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|PStack
)paren
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
id|chanp-&gt;d_st-&gt;next
op_assign
l_int|NULL
suffix:semicolon
id|init_d_st
c_func
(paren
id|chanp
)paren
suffix:semicolon
id|chanp-&gt;lc_d
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|LcFsm
)paren
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
id|chanp-&gt;lc_d-&gt;lcfi.fsm
op_assign
op_amp
id|lcfsm
suffix:semicolon
id|chanp-&gt;lc_d-&gt;lcfi.state
op_assign
id|ST_LC_NULL
suffix:semicolon
id|chanp-&gt;lc_d-&gt;lcfi.debug
op_assign
l_int|0
suffix:semicolon
id|chanp-&gt;lc_d-&gt;lcfi.userdata
op_assign
id|chanp-&gt;lc_d
suffix:semicolon
id|chanp-&gt;lc_d-&gt;lcfi.printdebug
op_assign
id|lc_debug
suffix:semicolon
id|chanp-&gt;lc_d-&gt;type
op_assign
id|LC_D
suffix:semicolon
id|chanp-&gt;lc_d-&gt;delay
op_assign
l_int|0
suffix:semicolon
id|chanp-&gt;lc_d-&gt;ch
op_assign
id|chanp
suffix:semicolon
id|chanp-&gt;lc_d-&gt;st
op_assign
id|chanp-&gt;d_st
suffix:semicolon
id|chanp-&gt;lc_d-&gt;l2_establish
op_assign
op_logical_neg
l_int|0
suffix:semicolon
id|chanp-&gt;lc_d-&gt;l2_start
op_assign
op_logical_neg
l_int|0
suffix:semicolon
id|chanp-&gt;lc_d-&gt;lccall
op_assign
id|lccall_d
suffix:semicolon
id|FsmInitTimer
c_func
(paren
op_amp
id|chanp-&gt;lc_d-&gt;lcfi
comma
op_amp
id|chanp-&gt;lc_d-&gt;act_timer
)paren
suffix:semicolon
)brace
r_else
(brace
id|chanp-&gt;d_st
op_assign
id|csta-&gt;channel-&gt;d_st
suffix:semicolon
id|chanp-&gt;lc_d
op_assign
id|csta-&gt;channel-&gt;lc_d
suffix:semicolon
)brace
id|chanp-&gt;lc_b
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|LcFsm
)paren
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
id|chanp-&gt;lc_b-&gt;lcfi.fsm
op_assign
op_amp
id|lcfsm
suffix:semicolon
id|chanp-&gt;lc_b-&gt;lcfi.state
op_assign
id|ST_LC_NULL
suffix:semicolon
id|chanp-&gt;lc_b-&gt;lcfi.debug
op_assign
l_int|0
suffix:semicolon
id|chanp-&gt;lc_b-&gt;lcfi.userdata
op_assign
id|chanp-&gt;lc_b
suffix:semicolon
id|chanp-&gt;lc_b-&gt;lcfi.printdebug
op_assign
id|dlc_debug
suffix:semicolon
id|chanp-&gt;lc_b-&gt;type
op_assign
id|LC_B
suffix:semicolon
id|chanp-&gt;lc_b-&gt;delay
op_assign
id|DEFAULT_B_DELAY
suffix:semicolon
id|chanp-&gt;lc_b-&gt;ch
op_assign
id|chanp
suffix:semicolon
id|chanp-&gt;lc_b-&gt;st
op_assign
id|chanp-&gt;b_st
suffix:semicolon
id|chanp-&gt;lc_b-&gt;l2_establish
op_assign
op_logical_neg
l_int|0
suffix:semicolon
id|chanp-&gt;lc_b-&gt;l2_start
op_assign
op_logical_neg
l_int|0
suffix:semicolon
id|chanp-&gt;lc_b-&gt;lccall
op_assign
id|lccall_b
suffix:semicolon
id|FsmInitTimer
c_func
(paren
op_amp
id|chanp-&gt;lc_b-&gt;lcfi
comma
op_amp
id|chanp-&gt;lc_b-&gt;act_timer
)paren
suffix:semicolon
id|chanp-&gt;data_open
op_assign
l_int|0
suffix:semicolon
)brace
r_int
DECL|function|CallcNewChan
id|CallcNewChan
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|csta
)paren
(brace
id|chancount
op_add_assign
l_int|2
suffix:semicolon
id|init_chan
c_func
(paren
l_int|0
comma
id|csta
)paren
suffix:semicolon
id|init_chan
c_func
(paren
l_int|1
comma
id|csta
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;HiSax: 2 channels added&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#ifdef LAYER2_WATCHING
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;LAYER2 ESTABLISH&bslash;n&quot;
)paren
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_START_D
comma
op_amp
id|csta-&gt;channel-&gt;Flags
)paren
suffix:semicolon
id|FsmEvent
c_func
(paren
op_amp
id|csta-&gt;channel-&gt;lc_d-&gt;lcfi
comma
id|EV_LC_ESTABLISH
comma
l_int|NULL
)paren
suffix:semicolon
macro_line|#endif
r_return
(paren
l_int|2
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|release_d_st
id|release_d_st
c_func
(paren
r_struct
id|Channel
op_star
id|chanp
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|chanp-&gt;d_st
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|st
)paren
r_return
suffix:semicolon
id|releasestack_isdnl2
c_func
(paren
id|st
)paren
suffix:semicolon
id|releasestack_isdnl3
c_func
(paren
id|st
)paren
suffix:semicolon
id|HiSax_rmlist
c_func
(paren
id|st-&gt;l1.hardware
comma
id|st
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|st
)paren
suffix:semicolon
id|chanp-&gt;d_st
op_assign
l_int|NULL
suffix:semicolon
)brace
r_void
DECL|function|CallcFreeChan
id|CallcFreeChan
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|csta
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|2
suffix:semicolon
id|i
op_increment
)paren
(brace
id|FsmDelTimer
c_func
(paren
op_amp
id|csta-&gt;channel
(braket
id|i
)braket
dot
id|drel_timer
comma
l_int|74
)paren
suffix:semicolon
id|FsmDelTimer
c_func
(paren
op_amp
id|csta-&gt;channel
(braket
id|i
)braket
dot
id|dial_timer
comma
l_int|75
)paren
suffix:semicolon
id|FsmDelTimer
c_func
(paren
op_amp
id|csta-&gt;channel
(braket
id|i
)braket
dot
id|lc_d-&gt;act_timer
comma
l_int|77
)paren
suffix:semicolon
id|FsmDelTimer
c_func
(paren
op_amp
id|csta-&gt;channel
(braket
id|i
)braket
dot
id|lc_b-&gt;act_timer
comma
l_int|76
)paren
suffix:semicolon
r_if
c_cond
(paren
id|i
op_logical_or
id|test_bit
c_func
(paren
id|FLG_TWO_DCHAN
comma
op_amp
id|csta-&gt;HW_Flags
)paren
)paren
id|release_d_st
c_func
(paren
id|csta-&gt;channel
op_plus
id|i
)paren
suffix:semicolon
r_if
c_cond
(paren
id|csta-&gt;channel
(braket
id|i
)braket
dot
id|b_st
)paren
(brace
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_START_B
comma
op_amp
id|csta-&gt;channel
(braket
id|i
)braket
dot
id|Flags
)paren
)paren
id|release_b_st
c_func
(paren
id|csta-&gt;channel
op_plus
id|i
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|csta-&gt;channel
(braket
id|i
)braket
dot
id|b_st
)paren
suffix:semicolon
id|csta-&gt;channel
(braket
id|i
)braket
dot
id|b_st
op_assign
l_int|NULL
suffix:semicolon
)brace
r_else
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;CallcFreeChan b_st ch%d allready freed&bslash;n&quot;
comma
id|i
)paren
suffix:semicolon
r_if
c_cond
(paren
id|csta-&gt;channel
(braket
id|i
)braket
dot
id|lc_b
)paren
(brace
id|kfree
c_func
(paren
id|csta-&gt;channel
(braket
id|i
)braket
dot
id|lc_b
)paren
suffix:semicolon
id|csta-&gt;channel
(braket
id|i
)braket
dot
id|b_st
op_assign
l_int|NULL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|i
op_logical_or
id|test_bit
c_func
(paren
id|FLG_TWO_DCHAN
comma
op_amp
id|csta-&gt;HW_Flags
)paren
)paren
(brace
id|release_d_st
c_func
(paren
id|csta-&gt;channel
op_plus
id|i
)paren
suffix:semicolon
id|FsmDelTimer
c_func
(paren
op_amp
id|csta-&gt;channel
(braket
id|i
)braket
dot
id|lc_d-&gt;act_timer
comma
l_int|77
)paren
suffix:semicolon
r_if
c_cond
(paren
id|csta-&gt;channel
(braket
id|i
)braket
dot
id|lc_d
)paren
(brace
id|kfree
c_func
(paren
id|csta-&gt;channel
(braket
id|i
)braket
dot
id|lc_d
)paren
suffix:semicolon
id|csta-&gt;channel
(braket
id|i
)braket
dot
id|d_st
op_assign
l_int|NULL
suffix:semicolon
)brace
r_else
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;CallcFreeChan lc_d ch%d allready freed&bslash;n&quot;
comma
id|i
)paren
suffix:semicolon
)brace
r_else
id|csta-&gt;channel
(braket
id|i
)braket
dot
id|d_st
op_assign
l_int|NULL
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|lldata_handler
id|lldata_handler
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
(paren
r_struct
id|Channel
op_star
)paren
id|st-&gt;lli.userdata
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_switch
c_cond
(paren
id|pr
)paren
(brace
r_case
(paren
id|DL_DATA
)paren
suffix:colon
r_if
c_cond
(paren
id|chanp-&gt;data_open
)paren
id|chanp-&gt;cs-&gt;iif
dot
id|rcvcallb_skb
c_func
(paren
id|chanp-&gt;cs-&gt;myid
comma
id|chanp-&gt;chan
comma
id|skb
)paren
suffix:semicolon
r_else
(brace
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_default
suffix:colon
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;lldata_handler unknown primitive %d&bslash;n&quot;
comma
id|pr
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|lltrans_handler
id|lltrans_handler
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
(paren
r_struct
id|Channel
op_star
)paren
id|st-&gt;lli.userdata
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_switch
c_cond
(paren
id|pr
)paren
(brace
r_case
(paren
id|PH_DATA_IND
)paren
suffix:colon
r_if
c_cond
(paren
id|chanp-&gt;data_open
)paren
id|chanp-&gt;cs-&gt;iif
dot
id|rcvcallb_skb
c_func
(paren
id|chanp-&gt;cs-&gt;myid
comma
id|chanp-&gt;chan
comma
id|skb
)paren
suffix:semicolon
r_else
(brace
r_if
c_cond
(paren
id|chanp-&gt;lc_b-&gt;lcfi.state
op_eq
id|ST_LC_DELAY
)paren
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;lc_b-&gt;lcfi
comma
id|EV_LC_DL_ESTABLISH
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;data_open
)paren
(brace
id|link_debug
c_func
(paren
id|chanp
comma
l_string|&quot;channel now open&quot;
comma
l_int|0
)paren
suffix:semicolon
id|chanp-&gt;cs-&gt;iif
dot
id|rcvcallb_skb
c_func
(paren
id|chanp-&gt;cs-&gt;myid
comma
id|chanp-&gt;chan
comma
id|skb
)paren
suffix:semicolon
)brace
r_else
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_default
suffix:colon
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;lltrans_handler unknown primitive %d&bslash;n&quot;
comma
id|pr
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|ll_writewakeup
id|ll_writewakeup
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|len
)paren
(brace
r_struct
id|Channel
op_star
id|chanp
op_assign
id|st-&gt;lli.userdata
suffix:semicolon
id|isdn_ctrl
id|ic
suffix:semicolon
id|ic.driver
op_assign
id|chanp-&gt;cs-&gt;myid
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_BSENT
suffix:semicolon
id|ic.arg
op_assign
id|chanp-&gt;chan
suffix:semicolon
id|ic.parm.length
op_assign
id|len
suffix:semicolon
id|chanp-&gt;cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|init_b_st
id|init_b_st
c_func
(paren
r_struct
id|Channel
op_star
id|chanp
comma
r_int
id|incoming
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|chanp-&gt;b_st
suffix:semicolon
r_struct
id|IsdnCardState
op_star
id|cs
op_assign
id|chanp-&gt;cs
suffix:semicolon
r_char
id|tmp
(braket
l_int|128
)braket
suffix:semicolon
id|st-&gt;l1.hardware
op_assign
id|cs
suffix:semicolon
id|chanp-&gt;bcs-&gt;mode
op_assign
l_int|2
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;bcs
op_member_access_from_pointer
id|BC_SetStack
c_func
(paren
id|st
comma
id|chanp-&gt;bcs
)paren
)paren
r_return
(paren
op_minus
l_int|1
)paren
suffix:semicolon
id|st-&gt;l2.flag
op_assign
l_int|0
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_LAPB
comma
op_amp
id|st-&gt;l2.flag
)paren
suffix:semicolon
id|st-&gt;l2.maxlen
op_assign
id|MAX_DATA_SIZE
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|incoming
)paren
id|test_and_set_bit
c_func
(paren
id|FLG_ORIG
comma
op_amp
id|st-&gt;l2.flag
)paren
suffix:semicolon
id|st-&gt;l2.T200
op_assign
l_int|1000
suffix:semicolon
multiline_comment|/* 1000 milliseconds */
id|st-&gt;l2.window
op_assign
l_int|7
suffix:semicolon
id|st-&gt;l2.N200
op_assign
l_int|4
suffix:semicolon
multiline_comment|/* try 4 times       */
id|st-&gt;l2.T203
op_assign
l_int|5000
suffix:semicolon
multiline_comment|/* 5000 milliseconds */
id|st-&gt;l3.debug
op_assign
l_int|0
suffix:semicolon
r_switch
c_cond
(paren
id|chanp-&gt;l2_active_protocol
)paren
(brace
r_case
(paren
id|ISDN_PROTO_L2_X75I
)paren
suffix:colon
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;Channel %d x.75&quot;
comma
id|chanp-&gt;chan
)paren
suffix:semicolon
id|setstack_isdnl2
c_func
(paren
id|st
comma
id|tmp
)paren
suffix:semicolon
id|st-&gt;l2.l2l3
op_assign
id|lldata_handler
suffix:semicolon
id|st-&gt;l1.l1man
op_assign
id|bc_l1man
suffix:semicolon
id|st-&gt;l2.l2man
op_assign
id|bc_l2man
suffix:semicolon
id|st-&gt;lli.userdata
op_assign
id|chanp
suffix:semicolon
id|st-&gt;lli.l1writewakeup
op_assign
l_int|NULL
suffix:semicolon
id|st-&gt;lli.l2writewakeup
op_assign
id|ll_writewakeup
suffix:semicolon
id|st-&gt;l2.l2m.debug
op_assign
id|chanp-&gt;debug
op_amp
l_int|16
suffix:semicolon
id|st-&gt;l2.debug
op_assign
id|chanp-&gt;debug
op_amp
l_int|64
suffix:semicolon
id|st-&gt;ma
dot
id|manl2
c_func
(paren
id|st
comma
id|MDL_NOTEIPROC
comma
l_int|NULL
)paren
suffix:semicolon
id|st-&gt;l1.mode
op_assign
id|L1_MODE_HDLC
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;leased
)paren
id|st-&gt;l1.bc
op_assign
id|chanp-&gt;chan
op_amp
l_int|1
suffix:semicolon
r_else
id|st-&gt;l1.bc
op_assign
id|chanp-&gt;proc-&gt;para.bchannel
op_minus
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|ISDN_PROTO_L2_HDLC
)paren
suffix:colon
id|st-&gt;l1.l1l2
op_assign
id|lltrans_handler
suffix:semicolon
id|st-&gt;l1.l1man
op_assign
id|bc_l1man
suffix:semicolon
id|st-&gt;lli.userdata
op_assign
id|chanp
suffix:semicolon
id|st-&gt;lli.l1writewakeup
op_assign
id|ll_writewakeup
suffix:semicolon
id|st-&gt;l1.mode
op_assign
id|L1_MODE_HDLC
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;leased
)paren
id|st-&gt;l1.bc
op_assign
id|chanp-&gt;chan
op_amp
l_int|1
suffix:semicolon
r_else
id|st-&gt;l1.bc
op_assign
id|chanp-&gt;proc-&gt;para.bchannel
op_minus
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|ISDN_PROTO_L2_TRANS
)paren
suffix:colon
id|st-&gt;l1.l1l2
op_assign
id|lltrans_handler
suffix:semicolon
id|st-&gt;l1.l1man
op_assign
id|bc_l1man
suffix:semicolon
id|st-&gt;lli.userdata
op_assign
id|chanp
suffix:semicolon
id|st-&gt;lli.l1writewakeup
op_assign
id|ll_writewakeup
suffix:semicolon
id|st-&gt;l1.mode
op_assign
id|L1_MODE_TRANS
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;leased
)paren
id|st-&gt;l1.bc
op_assign
id|chanp-&gt;chan
op_amp
l_int|1
suffix:semicolon
r_else
id|st-&gt;l1.bc
op_assign
id|chanp-&gt;proc-&gt;para.bchannel
op_minus
l_int|1
suffix:semicolon
r_break
suffix:semicolon
)brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|channel_report
id|channel_report
c_func
(paren
r_struct
id|Channel
op_star
id|chanp
)paren
(brace
)brace
r_static
r_void
DECL|function|distr_debug
id|distr_debug
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|csta
comma
r_int
id|debugflags
)paren
(brace
r_int
id|i
suffix:semicolon
r_struct
id|Channel
op_star
id|chanp
op_assign
id|csta-&gt;channel
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|2
suffix:semicolon
id|i
op_increment
)paren
(brace
id|chanp
(braket
id|i
)braket
dot
id|debug
op_assign
id|debugflags
suffix:semicolon
id|chanp
(braket
id|i
)braket
dot
id|fi.debug
op_assign
id|debugflags
op_amp
l_int|2
suffix:semicolon
id|chanp
(braket
id|i
)braket
dot
id|d_st-&gt;l2.l2m.debug
op_assign
id|debugflags
op_amp
l_int|8
suffix:semicolon
id|chanp
(braket
id|i
)braket
dot
id|b_st-&gt;l2.l2m.debug
op_assign
id|debugflags
op_amp
l_int|0x10
suffix:semicolon
id|chanp
(braket
id|i
)braket
dot
id|d_st-&gt;l2.debug
op_assign
id|debugflags
op_amp
l_int|0x20
suffix:semicolon
id|chanp
(braket
id|i
)braket
dot
id|b_st-&gt;l2.debug
op_assign
id|debugflags
op_amp
l_int|0x40
suffix:semicolon
id|chanp
(braket
id|i
)braket
dot
id|lc_d-&gt;lcfi.debug
op_assign
id|debugflags
op_amp
l_int|0x80
suffix:semicolon
id|chanp
(braket
id|i
)braket
dot
id|lc_b-&gt;lcfi.debug
op_assign
id|debugflags
op_amp
l_int|0x100
suffix:semicolon
id|chanp
(braket
id|i
)braket
dot
id|b_st-&gt;ma.tei_m.debug
op_assign
id|debugflags
op_amp
l_int|0x200
suffix:semicolon
id|chanp
(braket
id|i
)braket
dot
id|b_st-&gt;ma.debug
op_assign
id|debugflags
op_amp
l_int|0x200
suffix:semicolon
id|chanp
(braket
id|i
)braket
dot
id|d_st-&gt;l1.l1m.debug
op_assign
id|debugflags
op_amp
l_int|0x1000
suffix:semicolon
)brace
id|csta-&gt;dlogflag
op_assign
id|debugflags
op_amp
l_int|4
suffix:semicolon
)brace
r_int
DECL|function|HiSax_command
id|HiSax_command
c_func
(paren
id|isdn_ctrl
op_star
id|ic
)paren
(brace
r_struct
id|IsdnCardState
op_star
id|csta
op_assign
id|hisax_findcard
c_func
(paren
id|ic-&gt;driver
)paren
suffix:semicolon
r_struct
id|Channel
op_star
id|chanp
suffix:semicolon
r_char
id|tmp
(braket
l_int|128
)braket
suffix:semicolon
r_int
id|i
suffix:semicolon
r_int
r_int
id|num
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|csta
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;HiSax: if_command %d called with invalid driverId %d!&bslash;n&quot;
comma
id|ic-&gt;command
comma
id|ic-&gt;driver
)paren
suffix:semicolon
r_return
op_minus
id|ENODEV
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|ic-&gt;command
)paren
(brace
r_case
(paren
id|ISDN_CMD_SETEAZ
)paren
suffix:colon
id|chanp
op_assign
id|csta-&gt;channel
op_plus
id|ic-&gt;arg
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;SETEAZ card %d %s&quot;
comma
id|csta-&gt;cardnr
op_plus
l_int|1
comma
id|ic-&gt;parm.num
)paren
suffix:semicolon
id|link_debug
c_func
(paren
id|chanp
comma
id|tmp
comma
l_int|1
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
(paren
id|ISDN_CMD_SETL2
)paren
suffix:colon
id|chanp
op_assign
id|csta-&gt;channel
op_plus
(paren
id|ic-&gt;arg
op_amp
l_int|0xff
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;SETL2 card %d %ld&quot;
comma
id|csta-&gt;cardnr
op_plus
l_int|1
comma
id|ic-&gt;arg
op_rshift
l_int|8
)paren
suffix:semicolon
id|link_debug
c_func
(paren
id|chanp
comma
id|tmp
comma
l_int|1
)paren
suffix:semicolon
)brace
id|chanp-&gt;l2_protocol
op_assign
id|ic-&gt;arg
op_rshift
l_int|8
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|ISDN_CMD_DIAL
)paren
suffix:colon
id|chanp
op_assign
id|csta-&gt;channel
op_plus
(paren
id|ic-&gt;arg
op_amp
l_int|0xff
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;DIAL %s -&gt; %s (%d,%d)&quot;
comma
id|ic-&gt;parm.setup.eazmsn
comma
id|ic-&gt;parm.setup.phone
comma
id|ic-&gt;parm.setup.si1
comma
id|ic-&gt;parm.setup.si2
)paren
suffix:semicolon
id|link_debug
c_func
(paren
id|chanp
comma
id|tmp
comma
l_int|1
)paren
suffix:semicolon
)brace
id|chanp-&gt;setup
op_assign
id|ic-&gt;parm.setup
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|chanp-&gt;setup.eazmsn
comma
l_string|&quot;0&quot;
)paren
)paren
id|chanp-&gt;setup.eazmsn
(braket
l_int|0
)braket
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
multiline_comment|/* this solution is dirty and may be change, if&n;&t;&t;&t; * we make a callreference based callmanager */
r_if
c_cond
(paren
id|chanp-&gt;fi.state
op_eq
id|ST_NULL
)paren
(brace
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;fi
comma
id|EV_DIAL
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_else
(brace
id|FsmDelTimer
c_func
(paren
op_amp
id|chanp-&gt;dial_timer
comma
l_int|70
)paren
suffix:semicolon
id|FsmAddTimer
c_func
(paren
op_amp
id|chanp-&gt;dial_timer
comma
l_int|50
comma
id|EV_DIAL
comma
l_int|NULL
comma
l_int|71
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
(paren
id|ISDN_CMD_ACCEPTB
)paren
suffix:colon
id|chanp
op_assign
id|csta-&gt;channel
op_plus
id|ic-&gt;arg
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
id|link_debug
c_func
(paren
id|chanp
comma
l_string|&quot;ACCEPTB&quot;
comma
l_int|1
)paren
suffix:semicolon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;fi
comma
id|EV_ACCEPTB
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|ISDN_CMD_ACCEPTD
)paren
suffix:colon
id|chanp
op_assign
id|csta-&gt;channel
op_plus
id|ic-&gt;arg
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
id|link_debug
c_func
(paren
id|chanp
comma
l_string|&quot;ACCEPTD&quot;
comma
l_int|1
)paren
suffix:semicolon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;fi
comma
id|EV_ACCEPTD
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|ISDN_CMD_HANGUP
)paren
suffix:colon
id|chanp
op_assign
id|csta-&gt;channel
op_plus
id|ic-&gt;arg
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
id|link_debug
c_func
(paren
id|chanp
comma
l_string|&quot;HANGUP&quot;
comma
l_int|1
)paren
suffix:semicolon
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;fi
comma
id|EV_HANGUP
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|ISDN_CMD_SUSPEND
)paren
suffix:colon
id|chanp
op_assign
id|csta-&gt;channel
op_plus
id|ic-&gt;arg
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;SUSPEND %s&quot;
comma
id|ic-&gt;parm.num
)paren
suffix:semicolon
id|link_debug
c_func
(paren
id|chanp
comma
id|tmp
comma
l_int|1
)paren
suffix:semicolon
)brace
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;fi
comma
id|EV_SUSPEND
comma
id|ic
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|ISDN_CMD_RESUME
)paren
suffix:colon
id|chanp
op_assign
id|csta-&gt;channel
op_plus
id|ic-&gt;arg
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|1
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;RESUME %s&quot;
comma
id|ic-&gt;parm.num
)paren
suffix:semicolon
id|link_debug
c_func
(paren
id|chanp
comma
id|tmp
comma
l_int|1
)paren
suffix:semicolon
)brace
id|FsmEvent
c_func
(paren
op_amp
id|chanp-&gt;fi
comma
id|EV_RESUME
comma
id|ic
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|ISDN_CMD_LOCK
)paren
suffix:colon
id|HiSax_mod_inc_use_count
c_func
(paren
)paren
suffix:semicolon
macro_line|#ifdef MODULE
r_if
c_cond
(paren
id|csta-&gt;channel
(braket
l_int|0
)braket
dot
id|debug
op_amp
l_int|0x400
)paren
(brace
id|jiftime
c_func
(paren
id|tmp
comma
id|jiffies
)paren
suffix:semicolon
id|i
op_assign
id|strlen
c_func
(paren
id|tmp
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|tmp
op_plus
id|i
comma
l_string|&quot;   LOCK modcnt %d&bslash;n&quot;
comma
id|MOD_USE_COUNT
)paren
suffix:semicolon
id|HiSax_putstatus
c_func
(paren
id|csta
comma
id|tmp
)paren
suffix:semicolon
)brace
macro_line|#endif&t;&t;&t;&t;/* MODULE */
r_break
suffix:semicolon
r_case
(paren
id|ISDN_CMD_UNLOCK
)paren
suffix:colon
id|HiSax_mod_dec_use_count
c_func
(paren
)paren
suffix:semicolon
macro_line|#ifdef MODULE
r_if
c_cond
(paren
id|csta-&gt;channel
(braket
l_int|0
)braket
dot
id|debug
op_amp
l_int|0x400
)paren
(brace
id|jiftime
c_func
(paren
id|tmp
comma
id|jiffies
)paren
suffix:semicolon
id|i
op_assign
id|strlen
c_func
(paren
id|tmp
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|tmp
op_plus
id|i
comma
l_string|&quot; UNLOCK modcnt %d&bslash;n&quot;
comma
id|MOD_USE_COUNT
)paren
suffix:semicolon
id|HiSax_putstatus
c_func
(paren
id|csta
comma
id|tmp
)paren
suffix:semicolon
)brace
macro_line|#endif&t;&t;&t;&t;/* MODULE */
r_break
suffix:semicolon
r_case
(paren
id|ISDN_CMD_IOCTL
)paren
suffix:colon
r_switch
c_cond
(paren
id|ic-&gt;arg
)paren
(brace
r_case
(paren
l_int|0
)paren
suffix:colon
id|HiSax_reportcard
c_func
(paren
id|csta-&gt;cardnr
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|2
suffix:semicolon
id|i
op_increment
)paren
id|channel_report
c_func
(paren
op_amp
id|csta-&gt;channel
(braket
id|i
)braket
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
l_int|1
)paren
suffix:colon
id|num
op_assign
op_star
(paren
r_int
r_int
op_star
)paren
id|ic-&gt;parm.num
suffix:semicolon
id|distr_debug
c_func
(paren
id|csta
comma
id|num
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;debugging flags card %d set to %x&bslash;n&quot;
comma
id|csta-&gt;cardnr
op_plus
l_int|1
comma
id|num
)paren
suffix:semicolon
id|HiSax_putstatus
c_func
(paren
id|csta
comma
id|tmp
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;HiSax: %s&quot;
comma
id|tmp
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
l_int|2
)paren
suffix:colon
id|num
op_assign
op_star
(paren
r_int
r_int
op_star
)paren
id|ic-&gt;parm.num
suffix:semicolon
id|csta-&gt;channel
(braket
l_int|0
)braket
dot
id|lc_b-&gt;delay
op_assign
id|num
suffix:semicolon
id|csta-&gt;channel
(braket
l_int|1
)braket
dot
id|lc_b-&gt;delay
op_assign
id|num
suffix:semicolon
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;delay card %d set to %d ms&bslash;n&quot;
comma
id|csta-&gt;cardnr
op_plus
l_int|1
comma
id|num
)paren
suffix:semicolon
id|HiSax_putstatus
c_func
(paren
id|csta
comma
id|tmp
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;HiSax: %s&quot;
comma
id|tmp
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
l_int|3
)paren
suffix:colon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
op_star
(paren
r_int
r_int
op_star
)paren
id|ic-&gt;parm.num
suffix:semicolon
id|i
op_increment
)paren
id|HiSax_mod_dec_use_count
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
l_int|4
)paren
suffix:colon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
op_star
(paren
r_int
r_int
op_star
)paren
id|ic-&gt;parm.num
suffix:semicolon
id|i
op_increment
)paren
id|HiSax_mod_inc_use_count
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
l_int|5
)paren
suffix:colon
multiline_comment|/* set card in leased mode */
id|num
op_assign
op_star
(paren
r_int
r_int
op_star
)paren
id|ic-&gt;parm.num
suffix:semicolon
r_if
c_cond
(paren
(paren
id|num
OL
l_int|1
)paren
op_logical_or
(paren
id|num
OG
l_int|2
)paren
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;Set LEASED wrong channel %d&bslash;n&quot;
comma
id|num
)paren
suffix:semicolon
id|HiSax_putstatus
c_func
(paren
id|csta
comma
id|tmp
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;HiSax: %s&quot;
comma
id|tmp
)paren
suffix:semicolon
)brace
r_else
(brace
id|num
op_decrement
suffix:semicolon
id|csta-&gt;channel
(braket
id|num
)braket
dot
id|leased
op_assign
l_int|1
suffix:semicolon
id|csta-&gt;channel
(braket
id|num
)braket
dot
id|lc_d-&gt;l2_establish
op_assign
l_int|0
suffix:semicolon
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;card %d channel %d set leased mode&bslash;n&quot;
comma
id|csta-&gt;cardnr
op_plus
l_int|1
comma
id|num
op_plus
l_int|1
)paren
suffix:semicolon
id|HiSax_putstatus
c_func
(paren
id|csta
comma
id|tmp
)paren
suffix:semicolon
id|FsmEvent
c_func
(paren
op_amp
id|csta-&gt;channel
(braket
id|num
)braket
dot
id|lc_d-&gt;lcfi
comma
id|EV_LC_ESTABLISH
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
(paren
l_int|6
)paren
suffix:colon
multiline_comment|/* set B-channel test loop */
id|num
op_assign
op_star
(paren
r_int
r_int
op_star
)paren
id|ic-&gt;parm.num
suffix:semicolon
r_if
c_cond
(paren
id|csta-&gt;stlist
)paren
id|csta-&gt;stlist-&gt;ma
dot
id|manl1
c_func
(paren
id|csta-&gt;stlist
comma
id|PH_TESTLOOP_REQ
comma
(paren
r_void
op_star
)paren
id|num
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#ifdef MODULE
r_case
(paren
l_int|55
)paren
suffix:colon
r_while
c_loop
(paren
id|MOD_USE_COUNT
OG
l_int|0
)paren
id|MOD_DEC_USE_COUNT
suffix:semicolon
id|HiSax_mod_inc_use_count
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif&t;&t;&t;&t;/* MODULE */
r_case
(paren
l_int|11
)paren
suffix:colon
id|csta-&gt;debug
op_assign
op_star
(paren
r_int
r_int
op_star
)paren
id|ic-&gt;parm.num
suffix:semicolon
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;l1 debugging flags card %d set to %x&bslash;n&quot;
comma
id|csta-&gt;cardnr
op_plus
l_int|1
comma
id|csta-&gt;debug
)paren
suffix:semicolon
id|HiSax_putstatus
c_func
(paren
id|cards
(braket
l_int|0
)braket
dot
id|cs
comma
id|tmp
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;HiSax: %s&quot;
comma
id|tmp
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
l_int|13
)paren
suffix:colon
id|csta-&gt;channel
(braket
l_int|0
)braket
dot
id|d_st-&gt;l3.debug
op_assign
op_star
(paren
r_int
r_int
op_star
)paren
id|ic-&gt;parm.num
suffix:semicolon
id|csta-&gt;channel
(braket
l_int|1
)braket
dot
id|d_st-&gt;l3.debug
op_assign
op_star
(paren
r_int
r_int
op_star
)paren
id|ic-&gt;parm.num
suffix:semicolon
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;l3 debugging flags card %d set to %x&bslash;n&quot;
comma
id|csta-&gt;cardnr
op_plus
l_int|1
comma
op_star
(paren
r_int
r_int
op_star
)paren
id|ic-&gt;parm.num
)paren
suffix:semicolon
id|HiSax_putstatus
c_func
(paren
id|cards
(braket
l_int|0
)braket
dot
id|cs
comma
id|tmp
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;HiSax: %s&quot;
comma
id|tmp
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;HiSax: invalid ioclt %d&bslash;n&quot;
comma
(paren
r_int
)paren
id|ic-&gt;arg
)paren
suffix:semicolon
r_return
(paren
op_minus
id|EINVAL
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_default
suffix:colon
r_break
suffix:semicolon
)brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_int
DECL|function|HiSax_writebuf_skb
id|HiSax_writebuf_skb
c_func
(paren
r_int
id|id
comma
r_int
id|chan
comma
r_int
id|ack
comma
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
r_struct
id|IsdnCardState
op_star
id|csta
op_assign
id|hisax_findcard
c_func
(paren
id|id
)paren
suffix:semicolon
r_struct
id|Channel
op_star
id|chanp
suffix:semicolon
r_struct
id|PStack
op_star
id|st
suffix:semicolon
r_int
id|len
op_assign
id|skb-&gt;len
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_struct
id|sk_buff
op_star
id|nskb
suffix:semicolon
r_char
id|tmp
(braket
l_int|64
)braket
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|csta
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;HiSax: if_sendbuf called with invalid driverId!&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|ENODEV
suffix:semicolon
)brace
id|chanp
op_assign
id|csta-&gt;channel
op_plus
id|chan
suffix:semicolon
id|st
op_assign
id|chanp-&gt;b_st
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|chanp-&gt;data_open
)paren
(brace
id|link_debug
c_func
(paren
id|chanp
comma
l_string|&quot;writebuf: channel not open&quot;
comma
l_int|1
)paren
suffix:semicolon
r_return
op_minus
id|EIO
suffix:semicolon
)brace
r_if
c_cond
(paren
id|len
OG
id|MAX_DATA_SIZE
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;writebuf: packet too large (%d bytes)&quot;
comma
id|len
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;HiSax_%s !&bslash;n&quot;
comma
id|tmp
)paren
suffix:semicolon
id|link_debug
c_func
(paren
id|chanp
comma
id|tmp
comma
l_int|1
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|len
)paren
(brace
r_if
c_cond
(paren
(paren
id|len
op_plus
id|chanp-&gt;bcs-&gt;tx_cnt
)paren
OG
id|MAX_DATA_MEM
)paren
(brace
multiline_comment|/* Must return 0 here, since this is not an error&n;&t;&t;&t; * but a temporary lack of resources.&n;&t;&t;&t; */
r_if
c_cond
(paren
id|chanp-&gt;debug
op_amp
l_int|0x800
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;writebuf: no buffers for %d bytes&quot;
comma
id|len
)paren
suffix:semicolon
id|link_debug
c_func
(paren
id|chanp
comma
id|tmp
comma
l_int|1
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
id|save_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
id|cli
c_func
(paren
)paren
suffix:semicolon
id|nskb
op_assign
id|skb_clone
c_func
(paren
id|skb
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
r_if
c_cond
(paren
id|nskb
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|ack
)paren
id|nskb-&gt;pkt_type
op_assign
id|PACKET_NOACK
suffix:semicolon
r_if
c_cond
(paren
id|chanp-&gt;lc_b-&gt;l2_establish
)paren
id|st-&gt;l3
dot
id|l3l2
c_func
(paren
id|st
comma
id|DL_DATA
comma
id|nskb
)paren
suffix:semicolon
r_else
(brace
id|chanp-&gt;bcs-&gt;tx_cnt
op_add_assign
id|len
suffix:semicolon
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_DATA_REQ
comma
id|nskb
)paren
suffix:semicolon
)brace
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
)brace
r_else
id|len
op_assign
l_int|0
suffix:semicolon
id|restore_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
)brace
r_return
(paren
id|len
)paren
suffix:semicolon
)brace
eof
