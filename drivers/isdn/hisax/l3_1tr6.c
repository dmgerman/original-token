multiline_comment|/* $Id: l3_1tr6.c,v 2.4 1998/02/12 23:07:57 keil Exp $&n;&n; *  German 1TR6 D-channel protocol&n; *&n; * Author       Karsten Keil (keil@temic-ech.spacenet.de)&n; *&n; *&n; * $Log: l3_1tr6.c,v $&n; * Revision 2.4  1998/02/12 23:07:57  keil&n; * change for 2.1.86 (removing FREE_READ/FREE_WRITE from [dev]_kfree_skb()&n; *&n; * Revision 2.3  1997/11/06 17:12:24  keil&n; * KERN_NOTICE --&gt; KERN_INFO&n; *&n; * Revision 2.2  1997/10/29 19:03:00  keil&n; * changes for 2.1&n; *&n; * Revision 2.1  1997/08/03 15:28:09  keil&n; * release L3 empty processes&n; *&n; * Revision 2.0  1997/07/27 21:15:45  keil&n; * New Callref based layer3&n; *&n; * Revision 1.12  1997/06/26 11:11:45  keil&n; * SET_SKBFREE now on creation of a SKB&n; *&n; * Revision 1.11  1997/04/06 22:54:18  keil&n; * Using SKB&squot;s&n; *&n; * Old Log removed /KKe&n; *&n; */
DECL|macro|__NO_VERSION__
mdefine_line|#define __NO_VERSION__
macro_line|#include &quot;hisax.h&quot;
macro_line|#include &quot;l3_1tr6.h&quot;
macro_line|#include &quot;isdnl3.h&quot;
macro_line|#include &lt;linux/ctype.h&gt;
r_extern
r_char
op_star
id|HiSax_getrev
c_func
(paren
r_const
r_char
op_star
id|revision
)paren
suffix:semicolon
DECL|variable|l3_1tr6_revision
r_const
r_char
op_star
id|l3_1tr6_revision
op_assign
l_string|&quot;$Revision: 2.4 $&quot;
suffix:semicolon
DECL|macro|MsgHead
mdefine_line|#define MsgHead(ptr, cref, mty, dis) &bslash;&n;&t;*ptr++ = dis; &bslash;&n;&t;*ptr++ = 0x1; &bslash;&n;&t;*ptr++ = cref ^ 0x80; &bslash;&n;&t;*ptr++ = mty
r_static
r_void
DECL|function|l3_1TR6_message
id|l3_1TR6_message
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|mt
comma
id|u_char
id|pd
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|u_char
op_star
id|p
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|l3_alloc_skb
c_func
(paren
l_int|4
)paren
)paren
)paren
r_return
suffix:semicolon
id|p
op_assign
id|skb_put
c_func
(paren
id|skb
comma
l_int|4
)paren
suffix:semicolon
id|MsgHead
c_func
(paren
id|p
comma
id|pc-&gt;callref
comma
id|mt
comma
id|pd
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l2
c_func
(paren
id|pc-&gt;st
comma
id|DL_DATA
comma
id|skb
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|l31tr6_check_messagetype_validity
id|l31tr6_check_messagetype_validity
c_func
(paren
r_int
id|mt
comma
r_int
id|pd
)paren
(brace
multiline_comment|/* verify if a message type exists */
r_if
c_cond
(paren
id|pd
op_eq
id|PROTO_DIS_N0
)paren
r_switch
c_cond
(paren
id|mt
)paren
(brace
r_case
id|MT_N0_REG_IND
suffix:colon
r_case
id|MT_N0_CANC_IND
suffix:colon
r_case
id|MT_N0_FAC_STA
suffix:colon
r_case
id|MT_N0_STA_ACK
suffix:colon
r_case
id|MT_N0_STA_REJ
suffix:colon
r_case
id|MT_N0_FAC_INF
suffix:colon
r_case
id|MT_N0_INF_ACK
suffix:colon
r_case
id|MT_N0_INF_REJ
suffix:colon
r_case
id|MT_N0_CLOSE
suffix:colon
r_case
id|MT_N0_CLO_ACK
suffix:colon
r_return
l_int|1
suffix:semicolon
r_default
suffix:colon
r_return
l_int|0
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|pd
op_eq
id|PROTO_DIS_N1
)paren
r_switch
c_cond
(paren
id|mt
)paren
(brace
r_case
id|MT_N1_ESC
suffix:colon
r_case
id|MT_N1_ALERT
suffix:colon
r_case
id|MT_N1_CALL_SENT
suffix:colon
r_case
id|MT_N1_CONN
suffix:colon
r_case
id|MT_N1_CONN_ACK
suffix:colon
r_case
id|MT_N1_SETUP
suffix:colon
r_case
id|MT_N1_SETUP_ACK
suffix:colon
r_case
id|MT_N1_RES
suffix:colon
r_case
id|MT_N1_RES_ACK
suffix:colon
r_case
id|MT_N1_RES_REJ
suffix:colon
r_case
id|MT_N1_SUSP
suffix:colon
r_case
id|MT_N1_SUSP_ACK
suffix:colon
r_case
id|MT_N1_SUSP_REJ
suffix:colon
r_case
id|MT_N1_USER_INFO
suffix:colon
r_case
id|MT_N1_DET
suffix:colon
r_case
id|MT_N1_DISC
suffix:colon
r_case
id|MT_N1_REL
suffix:colon
r_case
id|MT_N1_REL_ACK
suffix:colon
r_case
id|MT_N1_CANC_ACK
suffix:colon
r_case
id|MT_N1_CANC_REJ
suffix:colon
r_case
id|MT_N1_CON_CON
suffix:colon
r_case
id|MT_N1_FAC
suffix:colon
r_case
id|MT_N1_FAC_ACK
suffix:colon
r_case
id|MT_N1_FAC_CAN
suffix:colon
r_case
id|MT_N1_FAC_REG
suffix:colon
r_case
id|MT_N1_FAC_REJ
suffix:colon
r_case
id|MT_N1_INFO
suffix:colon
r_case
id|MT_N1_REG_ACK
suffix:colon
r_case
id|MT_N1_REG_REJ
suffix:colon
r_case
id|MT_N1_STAT
suffix:colon
r_return
(paren
l_int|1
)paren
suffix:semicolon
r_default
suffix:colon
r_return
l_int|0
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3_1tr6_setup_req
id|l3_1tr6_setup_req
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|u_char
id|tmp
(braket
l_int|128
)braket
suffix:semicolon
id|u_char
op_star
id|p
op_assign
id|tmp
suffix:semicolon
id|u_char
op_star
id|teln
suffix:semicolon
id|u_char
op_star
id|eaz
suffix:semicolon
id|u_char
id|channel
op_assign
l_int|0
suffix:semicolon
r_int
id|l
suffix:semicolon
id|MsgHead
c_func
(paren
id|p
comma
id|pc-&gt;callref
comma
id|MT_N1_SETUP
comma
id|PROTO_DIS_N1
)paren
suffix:semicolon
id|teln
op_assign
id|pc-&gt;para.setup.phone
suffix:semicolon
id|pc-&gt;para.spv
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|isdigit
c_func
(paren
op_star
id|teln
)paren
)paren
(brace
r_switch
c_cond
(paren
l_int|0x5f
op_amp
op_star
id|teln
)paren
(brace
r_case
l_char|&squot;S&squot;
suffix:colon
id|pc-&gt;para.spv
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_char|&squot;C&squot;
suffix:colon
id|channel
op_assign
l_int|0x08
suffix:semicolon
r_case
l_char|&squot;P&squot;
suffix:colon
id|channel
op_or_assign
l_int|0x80
suffix:semicolon
id|teln
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|teln
op_eq
l_char|&squot;1&squot;
)paren
id|channel
op_or_assign
l_int|0x01
suffix:semicolon
r_else
id|channel
op_or_assign
l_int|0x02
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
(brace
)brace
r_if
c_cond
(paren
id|pc-&gt;st-&gt;l3.debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;Wrong MSN Code&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|teln
op_increment
suffix:semicolon
)brace
r_if
c_cond
(paren
id|channel
)paren
(brace
op_star
id|p
op_increment
op_assign
l_int|0x18
suffix:semicolon
multiline_comment|/* channel indicator */
op_star
id|p
op_increment
op_assign
l_int|1
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|channel
suffix:semicolon
)brace
r_if
c_cond
(paren
id|pc-&gt;para.spv
)paren
(brace
multiline_comment|/* SPV ? */
multiline_comment|/* NSF SPV */
op_star
id|p
op_increment
op_assign
id|WE0_netSpecFac
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|4
suffix:semicolon
multiline_comment|/* Laenge */
op_star
id|p
op_increment
op_assign
l_int|0
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|FAC_SPV
suffix:semicolon
multiline_comment|/* SPV */
op_star
id|p
op_increment
op_assign
id|pc-&gt;para.setup.si1
suffix:semicolon
multiline_comment|/* 0 for all Services */
op_star
id|p
op_increment
op_assign
id|pc-&gt;para.setup.si2
suffix:semicolon
multiline_comment|/* 0 for all Services */
op_star
id|p
op_increment
op_assign
id|WE0_netSpecFac
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|4
suffix:semicolon
multiline_comment|/* Laenge */
op_star
id|p
op_increment
op_assign
l_int|0
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|FAC_Activate
suffix:semicolon
multiline_comment|/* aktiviere SPV (default) */
op_star
id|p
op_increment
op_assign
id|pc-&gt;para.setup.si1
suffix:semicolon
multiline_comment|/* 0 for all Services */
op_star
id|p
op_increment
op_assign
id|pc-&gt;para.setup.si2
suffix:semicolon
multiline_comment|/* 0 for all Services */
)brace
id|eaz
op_assign
id|pc-&gt;para.setup.eazmsn
suffix:semicolon
r_if
c_cond
(paren
op_star
id|eaz
)paren
(brace
op_star
id|p
op_increment
op_assign
id|WE0_origAddr
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|strlen
c_func
(paren
id|eaz
)paren
op_plus
l_int|1
suffix:semicolon
multiline_comment|/* Classify as AnyPref. */
op_star
id|p
op_increment
op_assign
l_int|0x81
suffix:semicolon
multiline_comment|/* Ext = &squot;1&squot;B, Type = &squot;000&squot;B, Plan = &squot;0001&squot;B. */
r_while
c_loop
(paren
op_star
id|eaz
)paren
op_star
id|p
op_increment
op_assign
op_star
id|eaz
op_increment
op_amp
l_int|0x7f
suffix:semicolon
)brace
op_star
id|p
op_increment
op_assign
id|WE0_destAddr
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|strlen
c_func
(paren
id|teln
)paren
op_plus
l_int|1
suffix:semicolon
multiline_comment|/* Classify as AnyPref. */
op_star
id|p
op_increment
op_assign
l_int|0x81
suffix:semicolon
multiline_comment|/* Ext = &squot;1&squot;B, Type = &squot;000&squot;B, Plan = &squot;0001&squot;B. */
r_while
c_loop
(paren
op_star
id|teln
)paren
op_star
id|p
op_increment
op_assign
op_star
id|teln
op_increment
op_amp
l_int|0x7f
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|WE_Shift_F6
suffix:semicolon
multiline_comment|/* Codesatz 6 fuer Service */
op_star
id|p
op_increment
op_assign
id|WE6_serviceInd
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|2
suffix:semicolon
multiline_comment|/* len=2 info,info2 */
op_star
id|p
op_increment
op_assign
id|pc-&gt;para.setup.si1
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|pc-&gt;para.setup.si2
suffix:semicolon
id|l
op_assign
id|p
op_minus
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|l3_alloc_skb
c_func
(paren
id|l
)paren
)paren
)paren
r_return
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|l
)paren
comma
id|tmp
comma
id|l
)paren
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|pc-&gt;timer
comma
id|T303
comma
id|CC_T303
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|1
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l2
c_func
(paren
id|pc-&gt;st
comma
id|DL_DATA
comma
id|skb
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3_1tr6_setup
id|l3_1tr6_setup
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|u_char
op_star
id|p
suffix:semicolon
r_int
id|bcfound
op_assign
l_int|0
suffix:semicolon
r_char
id|tmp
(braket
l_int|80
)braket
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
multiline_comment|/* Channel Identification */
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
id|WE0_chanID
comma
l_int|0
)paren
)paren
)paren
(brace
id|pc-&gt;para.bchannel
op_assign
id|p
(braket
l_int|2
)braket
op_amp
l_int|0x3
suffix:semicolon
id|bcfound
op_increment
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|pc-&gt;st-&gt;l3.debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;setup without bchannel&quot;
)paren
suffix:semicolon
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
id|WE6_serviceInd
comma
l_int|6
)paren
)paren
)paren
(brace
id|pc-&gt;para.setup.si1
op_assign
id|p
(braket
l_int|2
)braket
suffix:semicolon
id|pc-&gt;para.setup.si2
op_assign
id|p
(braket
l_int|3
)braket
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|pc-&gt;st-&gt;l3.debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;setup without service indicator&quot;
)paren
suffix:semicolon
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
id|WE0_destAddr
comma
l_int|0
)paren
)paren
)paren
id|iecpy
c_func
(paren
id|pc-&gt;para.setup.eazmsn
comma
id|p
comma
l_int|1
)paren
suffix:semicolon
r_else
id|pc-&gt;para.setup.eazmsn
(braket
l_int|0
)braket
op_assign
l_int|0
suffix:semicolon
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
id|WE0_origAddr
comma
l_int|0
)paren
)paren
)paren
(brace
id|iecpy
c_func
(paren
id|pc-&gt;para.setup.phone
comma
id|p
comma
l_int|1
)paren
suffix:semicolon
)brace
r_else
id|pc-&gt;para.setup.phone
(braket
l_int|0
)braket
op_assign
l_int|0
suffix:semicolon
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
id|pc-&gt;para.spv
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
id|WE0_netSpecFac
comma
l_int|0
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
id|FAC_SPV
op_eq
id|p
(braket
l_int|3
)braket
)paren
op_logical_or
(paren
id|FAC_Activate
op_eq
id|p
(braket
l_int|3
)braket
)paren
)paren
id|pc-&gt;para.spv
op_assign
l_int|1
suffix:semicolon
)brace
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
multiline_comment|/* Signal all services, linklevel takes care of Service-Indicator */
r_if
c_cond
(paren
id|bcfound
)paren
(brace
r_if
c_cond
(paren
(paren
id|pc-&gt;para.setup.si1
op_ne
l_int|7
)paren
op_logical_and
(paren
id|pc-&gt;st-&gt;l3.debug
op_amp
id|L3_DEB_WARN
)paren
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;non-digital call: %s -&gt; %s&quot;
comma
id|pc-&gt;para.setup.phone
comma
id|pc-&gt;para.setup.eazmsn
)paren
suffix:semicolon
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
id|tmp
)paren
suffix:semicolon
)brace
id|newl3state
c_func
(paren
id|pc
comma
l_int|6
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_SETUP_IND
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_else
id|release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3_1tr6_setup_ack
id|l3_1tr6_setup_ack
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|u_char
op_star
id|p
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
id|WE0_chanID
comma
l_int|0
)paren
)paren
)paren
(brace
id|pc-&gt;para.bchannel
op_assign
id|p
(braket
l_int|2
)braket
op_amp
l_int|0x3
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|pc-&gt;st-&gt;l3.debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;setup answer without bchannel&quot;
)paren
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|pc-&gt;timer
comma
id|T304
comma
id|CC_T304
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_MORE_INFO
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3_1tr6_call_sent
id|l3_1tr6_call_sent
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|u_char
op_star
id|p
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
id|WE0_chanID
comma
l_int|0
)paren
)paren
)paren
(brace
id|pc-&gt;para.bchannel
op_assign
id|p
(braket
l_int|2
)braket
op_amp
l_int|0x3
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|pc-&gt;st-&gt;l3.debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;setup answer without bchannel&quot;
)paren
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|pc-&gt;timer
comma
id|T310
comma
id|CC_T310
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|3
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_PROCEEDING_IND
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3_1tr6_alert
id|l3_1tr6_alert
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
multiline_comment|/* T304 */
id|newl3state
c_func
(paren
id|pc
comma
l_int|4
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_ALERTING_IND
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3_1tr6_info
id|l3_1tr6_info
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|u_char
op_star
id|p
suffix:semicolon
r_int
id|i
comma
id|tmpcharge
op_assign
l_int|0
suffix:semicolon
r_char
id|a_charge
(braket
l_int|8
)braket
comma
id|tmp
(braket
l_int|32
)braket
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
id|WE6_chargingInfo
comma
l_int|6
)paren
)paren
)paren
(brace
id|iecpy
c_func
(paren
id|a_charge
comma
id|p
comma
l_int|1
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|strlen
c_func
(paren
id|a_charge
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
id|tmpcharge
op_mul_assign
l_int|10
suffix:semicolon
id|tmpcharge
op_add_assign
id|a_charge
(braket
id|i
)braket
op_amp
l_int|0xf
suffix:semicolon
)brace
r_if
c_cond
(paren
id|tmpcharge
OG
id|pc-&gt;para.chargeinfo
)paren
(brace
id|pc-&gt;para.chargeinfo
op_assign
id|tmpcharge
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_INFO_CHARGE
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|pc-&gt;st-&gt;l3.debug
op_amp
id|L3_DEB_CHARGE
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;charging info %d&quot;
comma
id|pc-&gt;para.chargeinfo
)paren
suffix:semicolon
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
id|tmp
)paren
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|pc-&gt;st-&gt;l3.debug
op_amp
id|L3_DEB_CHARGE
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;charging info not found&quot;
)paren
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3_1tr6_info_s2
id|l3_1tr6_info_s2
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3_1tr6_connect
id|l3_1tr6_connect
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
multiline_comment|/* T310 */
id|newl3state
c_func
(paren
id|pc
comma
l_int|10
)paren
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|pc-&gt;para.chargeinfo
op_assign
l_int|0
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_SETUP_CNF
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3_1tr6_rel
id|l3_1tr6_rel
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|u_char
op_star
id|p
suffix:semicolon
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
id|WE0_cause
comma
l_int|0
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
id|p
(braket
l_int|1
)braket
OG
l_int|0
)paren
(brace
id|pc-&gt;para.cause
op_assign
id|p
(braket
l_int|2
)braket
suffix:semicolon
r_if
c_cond
(paren
id|p
(braket
l_int|1
)braket
OG
l_int|1
)paren
id|pc-&gt;para.loc
op_assign
id|p
(braket
l_int|3
)braket
suffix:semicolon
r_else
id|pc-&gt;para.loc
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|pc-&gt;para.cause
op_assign
l_int|0
suffix:semicolon
id|pc-&gt;para.loc
op_assign
l_int|0
suffix:semicolon
)brace
)brace
r_else
id|pc-&gt;para.cause
op_assign
op_minus
l_int|1
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|StopAllL3Timer
c_func
(paren
id|pc
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|0
)paren
suffix:semicolon
id|l3_1TR6_message
c_func
(paren
id|pc
comma
id|MT_N1_REL_ACK
comma
id|PROTO_DIS_N1
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_RELEASE_IND
comma
l_int|NULL
)paren
suffix:semicolon
id|release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3_1tr6_rel_ack
id|l3_1tr6_rel_ack
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|StopAllL3Timer
c_func
(paren
id|pc
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|0
)paren
suffix:semicolon
id|pc-&gt;para.cause
op_assign
op_minus
l_int|1
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_RELEASE_CNF
comma
l_int|NULL
)paren
suffix:semicolon
id|release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3_1tr6_disc
id|l3_1tr6_disc
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|u_char
op_star
id|p
suffix:semicolon
r_int
id|i
comma
id|tmpcharge
op_assign
l_int|0
suffix:semicolon
r_char
id|a_charge
(braket
l_int|8
)braket
comma
id|tmp
(braket
l_int|32
)braket
suffix:semicolon
id|StopAllL3Timer
c_func
(paren
id|pc
)paren
suffix:semicolon
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
id|WE6_chargingInfo
comma
l_int|6
)paren
)paren
)paren
(brace
id|iecpy
c_func
(paren
id|a_charge
comma
id|p
comma
l_int|1
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|strlen
c_func
(paren
id|a_charge
)paren
suffix:semicolon
id|i
op_increment
)paren
(brace
id|tmpcharge
op_mul_assign
l_int|10
suffix:semicolon
id|tmpcharge
op_add_assign
id|a_charge
(braket
id|i
)braket
op_amp
l_int|0xf
suffix:semicolon
)brace
r_if
c_cond
(paren
id|tmpcharge
OG
id|pc-&gt;para.chargeinfo
)paren
(brace
id|pc-&gt;para.chargeinfo
op_assign
id|tmpcharge
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_INFO_CHARGE
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|pc-&gt;st-&gt;l3.debug
op_amp
id|L3_DEB_CHARGE
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;charging info %d&quot;
comma
id|pc-&gt;para.chargeinfo
)paren
suffix:semicolon
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
id|tmp
)paren
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|pc-&gt;st-&gt;l3.debug
op_amp
id|L3_DEB_CHARGE
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;charging info not found&quot;
)paren
suffix:semicolon
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
id|WE0_cause
comma
l_int|0
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
id|p
(braket
l_int|1
)braket
OG
l_int|0
)paren
(brace
id|pc-&gt;para.cause
op_assign
id|p
(braket
l_int|2
)braket
suffix:semicolon
r_if
c_cond
(paren
id|p
(braket
l_int|1
)braket
OG
l_int|1
)paren
id|pc-&gt;para.loc
op_assign
id|p
(braket
l_int|3
)braket
suffix:semicolon
r_else
id|pc-&gt;para.loc
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|pc-&gt;para.cause
op_assign
l_int|0
suffix:semicolon
id|pc-&gt;para.loc
op_assign
l_int|0
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|pc-&gt;st-&gt;l3.debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;cause not found&quot;
)paren
suffix:semicolon
id|pc-&gt;para.cause
op_assign
op_minus
l_int|1
suffix:semicolon
)brace
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|12
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_DISCONNECT_IND
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3_1tr6_connect_ack
id|l3_1tr6_connect_ack
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|10
)paren
suffix:semicolon
id|pc-&gt;para.chargeinfo
op_assign
l_int|0
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_SETUP_COMPLETE_IND
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3_1tr6_alert_req
id|l3_1tr6_alert_req
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|newl3state
c_func
(paren
id|pc
comma
l_int|7
)paren
suffix:semicolon
id|l3_1TR6_message
c_func
(paren
id|pc
comma
id|MT_N1_ALERT
comma
id|PROTO_DIS_N1
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3_1tr6_setup_rsp
id|l3_1tr6_setup_rsp
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|u_char
id|tmp
(braket
l_int|24
)braket
suffix:semicolon
id|u_char
op_star
id|p
op_assign
id|tmp
suffix:semicolon
r_int
id|l
suffix:semicolon
id|MsgHead
c_func
(paren
id|p
comma
id|pc-&gt;callref
comma
id|MT_N1_CONN
comma
id|PROTO_DIS_N1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pc-&gt;para.spv
)paren
(brace
multiline_comment|/* SPV ? */
multiline_comment|/* NSF SPV */
op_star
id|p
op_increment
op_assign
id|WE0_netSpecFac
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|4
suffix:semicolon
multiline_comment|/* Laenge */
op_star
id|p
op_increment
op_assign
l_int|0
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|FAC_SPV
suffix:semicolon
multiline_comment|/* SPV */
op_star
id|p
op_increment
op_assign
id|pc-&gt;para.setup.si1
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|pc-&gt;para.setup.si2
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|WE0_netSpecFac
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|4
suffix:semicolon
multiline_comment|/* Laenge */
op_star
id|p
op_increment
op_assign
l_int|0
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|FAC_Activate
suffix:semicolon
multiline_comment|/* aktiviere SPV */
op_star
id|p
op_increment
op_assign
id|pc-&gt;para.setup.si1
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|pc-&gt;para.setup.si2
suffix:semicolon
)brace
id|newl3state
c_func
(paren
id|pc
comma
l_int|8
)paren
suffix:semicolon
id|l
op_assign
id|p
op_minus
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|l3_alloc_skb
c_func
(paren
id|l
)paren
)paren
)paren
r_return
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|l
)paren
comma
id|tmp
comma
id|l
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l2
c_func
(paren
id|pc-&gt;st
comma
id|DL_DATA
comma
id|skb
)paren
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|pc-&gt;timer
comma
id|T313
comma
id|CC_T313
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3_1tr6_reset
id|l3_1tr6_reset
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3_1tr6_disconnect_req
id|l3_1tr6_disconnect_req
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|u_char
id|tmp
(braket
l_int|16
)braket
suffix:semicolon
id|u_char
op_star
id|p
op_assign
id|tmp
suffix:semicolon
r_int
id|l
suffix:semicolon
id|u_char
id|cause
op_assign
l_int|0x10
suffix:semicolon
id|u_char
id|clen
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|pc-&gt;para.cause
OG
l_int|0
)paren
id|cause
op_assign
id|pc-&gt;para.cause
suffix:semicolon
multiline_comment|/* Map DSS1 causes */
r_switch
c_cond
(paren
id|cause
op_amp
l_int|0x7f
)paren
(brace
r_case
l_int|0x10
suffix:colon
id|clen
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x15
suffix:colon
id|cause
op_assign
id|CAUSE_CallRejected
suffix:semicolon
r_break
suffix:semicolon
)brace
id|StopAllL3Timer
c_func
(paren
id|pc
)paren
suffix:semicolon
id|MsgHead
c_func
(paren
id|p
comma
id|pc-&gt;callref
comma
id|MT_N1_DISC
comma
id|PROTO_DIS_N1
)paren
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|WE0_cause
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|clen
suffix:semicolon
multiline_comment|/* Laenge */
r_if
c_cond
(paren
id|clen
)paren
op_star
id|p
op_increment
op_assign
id|cause
op_or
l_int|0x80
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|11
)paren
suffix:semicolon
id|l
op_assign
id|p
op_minus
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|l3_alloc_skb
c_func
(paren
id|l
)paren
)paren
)paren
r_return
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|l
)paren
comma
id|tmp
comma
id|l
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l2
c_func
(paren
id|pc-&gt;st
comma
id|DL_DATA
comma
id|skb
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|pc-&gt;timer
comma
id|T305
comma
id|CC_T305
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3_1tr6_release_req
id|l3_1tr6_release_req
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|StopAllL3Timer
c_func
(paren
id|pc
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|19
)paren
suffix:semicolon
id|l3_1TR6_message
c_func
(paren
id|pc
comma
id|MT_N1_REL
comma
id|PROTO_DIS_N1
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|pc-&gt;timer
comma
id|T308
comma
id|CC_T308_1
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3_1tr6_t303
id|l3_1tr6_t303
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_if
c_cond
(paren
id|pc-&gt;N303
OG
l_int|0
)paren
(brace
id|pc-&gt;N303
op_decrement
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|l3_1tr6_setup_req
c_func
(paren
id|pc
comma
id|pr
comma
id|arg
)paren
suffix:semicolon
)brace
r_else
(brace
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_NOSETUP_RSP_ERR
comma
l_int|NULL
)paren
suffix:semicolon
id|release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|l3_1tr6_t304
id|l3_1tr6_t304
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|pc-&gt;para.cause
op_assign
l_int|0xE6
suffix:semicolon
id|l3_1tr6_disconnect_req
c_func
(paren
id|pc
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_SETUP_ERR
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3_1tr6_t305
id|l3_1tr6_t305
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|u_char
id|tmp
(braket
l_int|16
)braket
suffix:semicolon
id|u_char
op_star
id|p
op_assign
id|tmp
suffix:semicolon
r_int
id|l
suffix:semicolon
id|u_char
id|cause
op_assign
l_int|0x90
suffix:semicolon
id|u_char
id|clen
op_assign
l_int|1
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pc-&gt;para.cause
OG
l_int|0
)paren
id|cause
op_assign
id|pc-&gt;para.cause
suffix:semicolon
multiline_comment|/* Map DSS1 causes */
r_switch
c_cond
(paren
id|cause
op_amp
l_int|0x7f
)paren
(brace
r_case
l_int|0x10
suffix:colon
id|clen
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x15
suffix:colon
id|cause
op_assign
id|CAUSE_CallRejected
suffix:semicolon
r_break
suffix:semicolon
)brace
id|MsgHead
c_func
(paren
id|p
comma
id|pc-&gt;callref
comma
id|MT_N1_REL
comma
id|PROTO_DIS_N1
)paren
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|WE0_cause
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|clen
suffix:semicolon
multiline_comment|/* Laenge */
r_if
c_cond
(paren
id|clen
)paren
op_star
id|p
op_increment
op_assign
id|cause
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|19
)paren
suffix:semicolon
id|l
op_assign
id|p
op_minus
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|l3_alloc_skb
c_func
(paren
id|l
)paren
)paren
)paren
r_return
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|l
)paren
comma
id|tmp
comma
id|l
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l2
c_func
(paren
id|pc-&gt;st
comma
id|DL_DATA
comma
id|skb
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|pc-&gt;timer
comma
id|T308
comma
id|CC_T308_1
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3_1tr6_t310
id|l3_1tr6_t310
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|pc-&gt;para.cause
op_assign
l_int|0xE6
suffix:semicolon
id|l3_1tr6_disconnect_req
c_func
(paren
id|pc
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_SETUP_ERR
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3_1tr6_t313
id|l3_1tr6_t313
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|pc-&gt;para.cause
op_assign
l_int|0xE6
suffix:semicolon
id|l3_1tr6_disconnect_req
c_func
(paren
id|pc
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_CONNECT_ERR
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3_1tr6_t308_1
id|l3_1tr6_t308_1
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|l3_1TR6_message
c_func
(paren
id|pc
comma
id|MT_N1_REL
comma
id|PROTO_DIS_N1
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|pc-&gt;timer
comma
id|T308
comma
id|CC_T308_2
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|19
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3_1tr6_t308_2
id|l3_1tr6_t308_2
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_RELEASE_ERR
comma
l_int|NULL
)paren
suffix:semicolon
id|release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
)brace
multiline_comment|/* *INDENT-OFF* */
DECL|variable|downstl
r_static
r_struct
id|stateentry
id|downstl
(braket
)braket
op_assign
(brace
(brace
id|SBIT
c_func
(paren
l_int|0
)paren
comma
id|CC_SETUP_REQ
comma
id|l3_1tr6_setup_req
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|1
)paren
op_or
id|SBIT
c_func
(paren
l_int|2
)paren
op_or
id|SBIT
c_func
(paren
l_int|3
)paren
op_or
id|SBIT
c_func
(paren
l_int|4
)paren
op_or
id|SBIT
c_func
(paren
l_int|6
)paren
op_or
id|SBIT
c_func
(paren
l_int|7
)paren
op_or
id|SBIT
c_func
(paren
l_int|8
)paren
op_or
id|SBIT
c_func
(paren
l_int|10
)paren
comma
id|CC_DISCONNECT_REQ
comma
id|l3_1tr6_disconnect_req
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|12
)paren
comma
id|CC_RELEASE_REQ
comma
id|l3_1tr6_release_req
)brace
comma
(brace
id|ALL_STATES
comma
id|CC_DLRL
comma
id|l3_1tr6_reset
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|6
)paren
comma
id|CC_IGNORE
comma
id|l3_1tr6_reset
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|6
)paren
comma
id|CC_REJECT_REQ
comma
id|l3_1tr6_disconnect_req
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|6
)paren
comma
id|CC_ALERTING_REQ
comma
id|l3_1tr6_alert_req
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|6
)paren
op_or
id|SBIT
c_func
(paren
l_int|7
)paren
comma
id|CC_SETUP_RSP
comma
id|l3_1tr6_setup_rsp
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|1
)paren
comma
id|CC_T303
comma
id|l3_1tr6_t303
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|2
)paren
comma
id|CC_T304
comma
id|l3_1tr6_t304
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|3
)paren
comma
id|CC_T310
comma
id|l3_1tr6_t310
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|8
)paren
comma
id|CC_T313
comma
id|l3_1tr6_t313
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|11
)paren
comma
id|CC_T305
comma
id|l3_1tr6_t305
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|19
)paren
comma
id|CC_T308_1
comma
id|l3_1tr6_t308_1
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|19
)paren
comma
id|CC_T308_2
comma
id|l3_1tr6_t308_2
)brace
comma
)brace
suffix:semicolon
DECL|variable|downstl_len
r_static
r_int
id|downstl_len
op_assign
r_sizeof
(paren
id|downstl
)paren
op_div
r_sizeof
(paren
r_struct
id|stateentry
)paren
suffix:semicolon
DECL|variable|datastln1
r_static
r_struct
id|stateentry
id|datastln1
(braket
)braket
op_assign
(brace
(brace
id|SBIT
c_func
(paren
l_int|0
)paren
comma
id|MT_N1_SETUP
comma
id|l3_1tr6_setup
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|1
)paren
comma
id|MT_N1_SETUP_ACK
comma
id|l3_1tr6_setup_ack
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|1
)paren
op_or
id|SBIT
c_func
(paren
l_int|2
)paren
comma
id|MT_N1_CALL_SENT
comma
id|l3_1tr6_call_sent
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|1
)paren
op_or
id|SBIT
c_func
(paren
l_int|2
)paren
op_or
id|SBIT
c_func
(paren
l_int|3
)paren
op_or
id|SBIT
c_func
(paren
l_int|4
)paren
op_or
id|SBIT
c_func
(paren
l_int|7
)paren
op_or
id|SBIT
c_func
(paren
l_int|8
)paren
op_or
id|SBIT
c_func
(paren
l_int|10
)paren
comma
id|MT_N1_DISC
comma
id|l3_1tr6_disc
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|2
)paren
op_or
id|SBIT
c_func
(paren
l_int|3
)paren
op_or
id|SBIT
c_func
(paren
l_int|4
)paren
comma
id|MT_N1_ALERT
comma
id|l3_1tr6_alert
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|2
)paren
op_or
id|SBIT
c_func
(paren
l_int|3
)paren
op_or
id|SBIT
c_func
(paren
l_int|4
)paren
comma
id|MT_N1_CONN
comma
id|l3_1tr6_connect
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|2
)paren
comma
id|MT_N1_INFO
comma
id|l3_1tr6_info_s2
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|8
)paren
comma
id|MT_N1_CONN_ACK
comma
id|l3_1tr6_connect_ack
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|10
)paren
comma
id|MT_N1_INFO
comma
id|l3_1tr6_info
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|0
)paren
op_or
id|SBIT
c_func
(paren
l_int|1
)paren
op_or
id|SBIT
c_func
(paren
l_int|2
)paren
op_or
id|SBIT
c_func
(paren
l_int|3
)paren
op_or
id|SBIT
c_func
(paren
l_int|4
)paren
op_or
id|SBIT
c_func
(paren
l_int|7
)paren
op_or
id|SBIT
c_func
(paren
l_int|8
)paren
op_or
id|SBIT
c_func
(paren
l_int|10
)paren
op_or
id|SBIT
c_func
(paren
l_int|11
)paren
op_or
id|SBIT
c_func
(paren
l_int|12
)paren
op_or
id|SBIT
c_func
(paren
l_int|15
)paren
op_or
id|SBIT
c_func
(paren
l_int|17
)paren
op_or
id|SBIT
c_func
(paren
l_int|19
)paren
comma
id|MT_N1_REL
comma
id|l3_1tr6_rel
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|19
)paren
comma
id|MT_N1_REL_ACK
comma
id|l3_1tr6_rel_ack
)brace
)brace
suffix:semicolon
multiline_comment|/* *INDENT-ON* */
DECL|variable|datastln1_len
r_static
r_int
id|datastln1_len
op_assign
r_sizeof
(paren
id|datastln1
)paren
op_div
r_sizeof
(paren
r_struct
id|stateentry
)paren
suffix:semicolon
r_static
r_void
DECL|function|up1tr6
id|up1tr6
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_int
id|i
comma
id|mt
comma
id|cr
suffix:semicolon
r_struct
id|l3_process
op_star
id|proc
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_char
id|tmp
(braket
l_int|80
)braket
suffix:semicolon
r_if
c_cond
(paren
id|skb-&gt;len
OL
l_int|4
)paren
(brace
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_PROTERR
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;up1tr6 len only %d&quot;
comma
id|skb-&gt;len
)paren
suffix:semicolon
id|l3_debug
c_func
(paren
id|st
comma
id|tmp
)paren
suffix:semicolon
)brace
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|skb-&gt;data
(braket
l_int|0
)braket
op_amp
l_int|0xfe
)paren
op_ne
id|PROTO_DIS_N0
)paren
(brace
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_PROTERR
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;up1tr6%sunexpected discriminator %x message len %d&quot;
comma
(paren
id|pr
op_eq
id|DL_DATA
)paren
ques
c_cond
l_string|&quot; &quot;
suffix:colon
l_string|&quot;(broadcast) &quot;
comma
id|skb-&gt;data
(braket
l_int|0
)braket
comma
id|skb-&gt;len
)paren
suffix:semicolon
id|l3_debug
c_func
(paren
id|st
comma
id|tmp
)paren
suffix:semicolon
)brace
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|skb-&gt;data
(braket
l_int|1
)braket
op_ne
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_PROTERR
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;up1tr6 CR len not 1&quot;
)paren
suffix:semicolon
id|l3_debug
c_func
(paren
id|st
comma
id|tmp
)paren
suffix:semicolon
)brace
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|cr
op_assign
id|skb-&gt;data
(braket
l_int|2
)braket
suffix:semicolon
id|mt
op_assign
id|skb-&gt;data
(braket
l_int|3
)braket
suffix:semicolon
r_if
c_cond
(paren
id|skb-&gt;data
(braket
l_int|0
)braket
op_eq
id|PROTO_DIS_N0
)paren
(brace
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_STATE
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;up1tr6%s N0 mt %x unhandled&quot;
comma
(paren
id|pr
op_eq
id|DL_DATA
)paren
ques
c_cond
l_string|&quot; &quot;
suffix:colon
l_string|&quot;(broadcast) &quot;
comma
id|mt
)paren
suffix:semicolon
id|l3_debug
c_func
(paren
id|st
comma
id|tmp
)paren
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|skb-&gt;data
(braket
l_int|0
)braket
op_eq
id|PROTO_DIS_N1
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|proc
op_assign
id|getl3proc
c_func
(paren
id|st
comma
id|cr
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
id|mt
op_eq
id|MT_N1_SETUP
)paren
op_logical_and
(paren
id|cr
OL
l_int|128
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|proc
op_assign
id|new_l3_process
c_func
(paren
id|st
comma
id|cr
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_PROTERR
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;up1tr6 no roc mem&quot;
)paren
suffix:semicolon
id|l3_debug
c_func
(paren
id|st
comma
id|tmp
)paren
suffix:semicolon
)brace
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
)brace
r_else
(brace
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|datastln1_len
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
(paren
id|mt
op_eq
id|datastln1
(braket
id|i
)braket
dot
id|primitive
)paren
op_logical_and
(paren
(paren
l_int|1
op_lshift
id|proc-&gt;state
)paren
op_amp
id|datastln1
(braket
id|i
)braket
dot
id|state
)paren
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|i
op_eq
id|datastln1_len
)paren
(brace
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_STATE
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;up1tr6%sstate %d mt %x unhandled&quot;
comma
(paren
id|pr
op_eq
id|DL_DATA
)paren
ques
c_cond
l_string|&quot; &quot;
suffix:colon
l_string|&quot;(broadcast) &quot;
comma
id|proc-&gt;state
comma
id|mt
)paren
suffix:semicolon
id|l3_debug
c_func
(paren
id|st
comma
id|tmp
)paren
suffix:semicolon
)brace
r_return
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_STATE
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;up1tr6%sstate %d mt %x&quot;
comma
(paren
id|pr
op_eq
id|DL_DATA
)paren
ques
c_cond
l_string|&quot; &quot;
suffix:colon
l_string|&quot;(broadcast) &quot;
comma
id|proc-&gt;state
comma
id|mt
)paren
suffix:semicolon
id|l3_debug
c_func
(paren
id|st
comma
id|tmp
)paren
suffix:semicolon
)brace
id|datastln1
(braket
id|i
)braket
dot
id|rout
c_func
(paren
id|proc
comma
id|pr
comma
id|skb
)paren
suffix:semicolon
)brace
)brace
)brace
r_static
r_void
DECL|function|down1tr6
id|down1tr6
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_int
id|i
comma
id|cr
suffix:semicolon
r_struct
id|l3_process
op_star
id|proc
suffix:semicolon
r_struct
id|Channel
op_star
id|chan
suffix:semicolon
r_char
id|tmp
(braket
l_int|80
)braket
suffix:semicolon
r_if
c_cond
(paren
id|CC_SETUP_REQ
op_eq
id|pr
)paren
(brace
id|chan
op_assign
id|arg
suffix:semicolon
id|cr
op_assign
id|newcallref
c_func
(paren
)paren
suffix:semicolon
id|cr
op_or_assign
l_int|0x80
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|proc
op_assign
id|new_l3_process
c_func
(paren
id|st
comma
id|cr
)paren
)paren
)paren
(brace
r_return
suffix:semicolon
)brace
r_else
(brace
id|proc-&gt;chan
op_assign
id|chan
suffix:semicolon
id|chan-&gt;proc
op_assign
id|proc
suffix:semicolon
id|proc-&gt;para.setup
op_assign
id|chan-&gt;setup
suffix:semicolon
id|proc-&gt;callref
op_assign
id|cr
suffix:semicolon
)brace
)brace
r_else
(brace
id|proc
op_assign
id|arg
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|downstl_len
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
(paren
id|pr
op_eq
id|downstl
(braket
id|i
)braket
dot
id|primitive
)paren
op_logical_and
(paren
(paren
l_int|1
op_lshift
id|proc-&gt;state
)paren
op_amp
id|downstl
(braket
id|i
)braket
dot
id|state
)paren
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|i
op_eq
id|downstl_len
)paren
(brace
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_STATE
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;down1tr6 state %d prim %d unhandled&quot;
comma
id|proc-&gt;state
comma
id|pr
)paren
suffix:semicolon
id|l3_debug
c_func
(paren
id|st
comma
id|tmp
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_STATE
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;down1tr6 state %d prim %d&quot;
comma
id|proc-&gt;state
comma
id|pr
)paren
suffix:semicolon
id|l3_debug
c_func
(paren
id|st
comma
id|tmp
)paren
suffix:semicolon
)brace
id|downstl
(braket
id|i
)braket
dot
id|rout
c_func
(paren
id|proc
comma
id|pr
comma
id|arg
)paren
suffix:semicolon
)brace
)brace
r_void
DECL|function|setstack_1tr6
id|setstack_1tr6
c_func
(paren
r_struct
id|PStack
op_star
id|st
)paren
(brace
r_char
id|tmp
(braket
l_int|64
)braket
suffix:semicolon
id|st-&gt;lli.l4l3
op_assign
id|down1tr6
suffix:semicolon
id|st-&gt;l2.l2l3
op_assign
id|up1tr6
suffix:semicolon
id|st-&gt;l3.N303
op_assign
l_int|0
suffix:semicolon
id|strcpy
c_func
(paren
id|tmp
comma
id|l3_1tr6_revision
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;HiSax: 1TR6 Rev. %s&bslash;n&quot;
comma
id|HiSax_getrev
c_func
(paren
id|tmp
)paren
)paren
suffix:semicolon
)brace
eof
