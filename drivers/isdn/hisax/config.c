multiline_comment|/* $Id: config.c,v 1.15 1997/04/06 22:57:24 keil Exp $&n;&n; * Author       Karsten Keil (keil@temic-ech.spacenet.de)&n; *              based on the teles driver from Jan den Ouden&n; *&n; *&n; * $Log: config.c,v $&n; * Revision 1.15  1997/04/06 22:57:24  keil&n; * Hisax version 2.1&n; *&n; * Revision 1.14  1997/03/25 23:11:22  keil&n; * US NI-1 protocol&n; *&n; * Revision 1.13  1997/03/23 21:45:49  keil&n; * Add support for ELSA PCMCIA&n; *&n; * Revision 1.12  1997/03/11 21:01:43  keil&n; * nzproto is only used with modules&n; *&n; * Revision 1.11  1997/02/14 12:23:12  fritz&n; * Added support for new insmod parameter handling.&n; *&n; * Revision 1.10  1997/02/14 09:22:09  keil&n; * Final 2.0 version&n; *&n; * Revision 1.9  1997/02/10 11:45:09  fritz&n; * More changes for Kernel 2.1.X compatibility.&n; *&n; * Revision 1.8  1997/02/09 00:28:05  keil&n; * new interface handling, one interface per card&n; * default protocol now works again&n; *&n; * Revision 1.7  1997/01/27 15:56:57  keil&n; * Teles PCMCIA ITK ix1 micro added&n; *&n; * Revision 1.6  1997/01/21 22:17:56  keil&n; * new module load syntax&n; *&n; * Revision 1.5  1997/01/09 18:28:20  keil&n; * cosmetic cleanups&n; *&n; * Revision 1.4  1996/11/05 19:35:17  keil&n; * using config.h; some spelling fixes&n; *&n; * Revision 1.3  1996/10/23 17:23:28  keil&n; * default config changes&n; *&n; * Revision 1.2  1996/10/23 11:58:48  fritz&n; * Changed default setup to reflect user&squot;s selection of supported&n; * cards/protocols.&n; *&n; * Revision 1.1  1996/10/13 20:04:51  keil&n; * Initial revision&n; *&n; *&n; *&n; */
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/stddef.h&gt;
macro_line|#include &lt;linux/timer.h&gt;
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &quot;hisax.h&quot;
multiline_comment|/*&n; * This structure array contains one entry per card. An entry looks&n; * like this:&n; *&n; * { type, protocol, p0, p1, p2, NULL }&n; *&n; * type&n; *    1 Teles 16.0      p0=irq p1=membase p2=iobase&n; *    2 Teles  8.0      p0=irq p1=membase&n; *    3 Teles 16.3      p0=irq p1=iobase&n; *    4 Creatix PNP     p0=irq p1=IO0 (ISAC)  p2=IO1 (HSCX)&n; *    5 AVM A1 (Fritz)  p0=irq p1=iobase&n; *    6 ELSA PC         [p0=iobase] or nothing (autodetect)&n; *    7 ELSA Quickstep  p0=irq p1=iobase&n; *      ELSA PCMCIA     p0=irq p1=iobase&n; *    8 Teles PCMCIA    p0=irq p1=iobase&n; *    9 ITK ix1-micro   p0=irq p1=iobase&n; *&n; *&n; * protocol can be either ISDN_PTYPE_EURO or ISDN_PTYPE_1TR6 or ISDN_PTYPE_NI1&n; *&n; *&n; */
macro_line|#ifdef CONFIG_HISAX_ELSA_PCC
DECL|macro|DEFAULT_CARD
mdefine_line|#define DEFAULT_CARD ISDN_CTYPE_ELSA
DECL|macro|DEFAULT_CFG
mdefine_line|#define DEFAULT_CFG {0,0,0}
macro_line|#endif
macro_line|#ifdef CONFIG_HISAX_ELSA_PCMCIA
DECL|macro|DEFAULT_CARD
mdefine_line|#define DEFAULT_CARD ISDN_CTYPE_ELSA_QS1000
DECL|macro|DEFAULT_CFG
mdefine_line|#define DEFAULT_CFG {3,0x2f8,0}
macro_line|#endif
macro_line|#ifdef CONFIG_HISAX_AVM_A1
DECL|macro|DEFAULT_CARD
macro_line|#undef DEFAULT_CARD
DECL|macro|DEFAULT_CFG
macro_line|#undef DEFAULT_CFG
DECL|macro|DEFAULT_CARD
mdefine_line|#define DEFAULT_CARD ISDN_CTYPE_A1
DECL|macro|DEFAULT_CFG
mdefine_line|#define DEFAULT_CFG {10,0x340,0}
macro_line|#endif
macro_line|#ifdef CONFIG_HISAX_16_3
DECL|macro|DEFAULT_CARD
macro_line|#undef DEFAULT_CARD
DECL|macro|DEFAULT_CFG
macro_line|#undef DEFAULT_CFG
DECL|macro|DEFAULT_CARD
mdefine_line|#define DEFAULT_CARD ISDN_CTYPE_16_3
DECL|macro|DEFAULT_CFG
mdefine_line|#define DEFAULT_CFG {15,0x180,0}
macro_line|#endif
macro_line|#ifdef CONFIG_HISAX_16_0
DECL|macro|DEFAULT_CARD
macro_line|#undef DEFAULT_CARD
DECL|macro|DEFAULT_CFG
macro_line|#undef DEFAULT_CFG
DECL|macro|DEFAULT_CARD
mdefine_line|#define DEFAULT_CARD ISDN_CTYPE_16_0
DECL|macro|DEFAULT_CFG
mdefine_line|#define DEFAULT_CFG {15,0xd0000,0xd80}
macro_line|#endif
macro_line|#ifdef CONFIG_HISAX_IX1MICROR2
DECL|macro|DEFAULT_CARD
macro_line|#undef DEFAULT_CARD
DECL|macro|DEFAULT_CFG
macro_line|#undef DEFAULT_CFG
DECL|macro|DEFAULT_CARD
mdefine_line|#define DEFAULT_CARD ISDN_CTYPE_IX1MICROR2
DECL|macro|DEFAULT_CFG
mdefine_line|#define DEFAULT_CFG {5,0x390,0}
macro_line|#endif
macro_line|#ifdef CONFIG_HISAX_1TR6
DECL|macro|DEFAULT_PROTO
mdefine_line|#define DEFAULT_PROTO ISDN_PTYPE_1TR6
DECL|macro|DEFAULT_PROTO_NAME
mdefine_line|#define DEFAULT_PROTO_NAME &quot;1TR6&quot;
macro_line|#endif
macro_line|#ifdef CONFIG_HISAX_EURO
DECL|macro|DEFAULT_PROTO
macro_line|#undef DEFAULT_PROTO
DECL|macro|DEFAULT_PROTO
mdefine_line|#define DEFAULT_PROTO ISDN_PTYPE_EURO
DECL|macro|DEFAULT_PROTO_NAME
macro_line|#undef DEFAULT_PROTO_NAME
DECL|macro|DEFAULT_PROTO_NAME
mdefine_line|#define DEFAULT_PROTO_NAME &quot;EURO&quot;
macro_line|#endif
macro_line|#ifdef CONFIG_HISAX_NI1
DECL|macro|DEFAULT_PROTO
macro_line|#undef DEFAULT_PROTO
DECL|macro|DEFAULT_PROTO
mdefine_line|#define DEFAULT_PROTO ISDN_PTYPE_NI1
DECL|macro|DEFAULT_PROTO_NAME
macro_line|#undef DEFAULT_PROTO_NAME
DECL|macro|DEFAULT_PROTO_NAME
mdefine_line|#define DEFAULT_PROTO_NAME &quot;NI1&quot;
macro_line|#endif
macro_line|#ifndef DEFAULT_PROTO
DECL|macro|DEFAULT_PROTO
mdefine_line|#define DEFAULT_PROTO ISDN_PTYPE_UNKNOWN
DECL|macro|DEFAULT_PROTO_NAME
mdefine_line|#define DEFAULT_PROTO_NAME &quot;UNKNOWN&quot;
macro_line|#endif
macro_line|#ifndef DEFAULT_CARD
macro_line|#error &quot;HiSax: No cards configured&quot;
macro_line|#endif
DECL|macro|FIRST_CARD
mdefine_line|#define FIRST_CARD { &bslash;&n;  DEFAULT_CARD, &bslash;&n;  DEFAULT_PROTO, &bslash;&n;  DEFAULT_CFG, &bslash;&n;  NULL, &bslash;&n;}
DECL|macro|EMPTY_CARD
mdefine_line|#define EMPTY_CARD&t;{0, DEFAULT_PROTO, {0, 0, 0}, NULL}
DECL|variable|cards
r_struct
id|IsdnCard
id|cards
(braket
)braket
op_assign
(brace
id|FIRST_CARD
comma
id|EMPTY_CARD
comma
id|EMPTY_CARD
comma
id|EMPTY_CARD
comma
id|EMPTY_CARD
comma
id|EMPTY_CARD
comma
id|EMPTY_CARD
comma
id|EMPTY_CARD
comma
id|EMPTY_CARD
comma
id|EMPTY_CARD
comma
id|EMPTY_CARD
comma
id|EMPTY_CARD
comma
id|EMPTY_CARD
comma
id|EMPTY_CARD
comma
id|EMPTY_CARD
comma
id|EMPTY_CARD
comma
)brace
suffix:semicolon
DECL|variable|HiSaxID
r_static
r_char
id|HiSaxID
(braket
l_int|96
)braket
op_assign
l_string|&quot;&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&quot;
"&bslash;"
l_string|&quot;&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&quot;
"&bslash;"
l_string|&quot;&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&quot;
"&bslash;"
l_string|&quot;&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&bslash;0&quot;
suffix:semicolon
DECL|variable|HiSax_id
r_char
op_star
id|HiSax_id
op_assign
id|HiSaxID
suffix:semicolon
macro_line|#ifdef MODULE
multiline_comment|/* Variables for insmod */
DECL|variable|type
r_int
id|type
(braket
)braket
op_assign
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
suffix:semicolon
DECL|variable|protocol
r_int
id|protocol
(braket
)braket
op_assign
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
suffix:semicolon
DECL|variable|io
r_int
id|io
(braket
)braket
op_assign
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
suffix:semicolon
macro_line|#ifdef CONFIG_HISAX_16_3&t;/* For Creatix/Teles PnP */
DECL|variable|io0
r_int
id|io0
(braket
)braket
op_assign
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
suffix:semicolon
DECL|variable|io1
r_int
id|io1
(braket
)braket
op_assign
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
suffix:semicolon
macro_line|#endif
DECL|variable|irq
r_int
id|irq
(braket
)braket
op_assign
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
suffix:semicolon
DECL|variable|mem
r_int
id|mem
(braket
)braket
op_assign
(brace
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
suffix:semicolon
DECL|variable|id
r_char
op_star
id|id
op_assign
id|HiSaxID
suffix:semicolon
macro_line|#if (LINUX_VERSION_CODE &gt; 0x020111)
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Karsten Keil&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|type
comma
l_string|&quot;1-16i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|protocol
comma
l_string|&quot;1-16i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|io
comma
l_string|&quot;1-16i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|irq
comma
l_string|&quot;1-16i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|mem
comma
l_string|&quot;1-16i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|id
comma
l_string|&quot;s&quot;
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_HISAX_16_3&t;/* For Creatix/Teles PnP */
id|MODULE_PARM
c_func
(paren
id|io0
comma
l_string|&quot;1-16i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|io1
comma
l_string|&quot;1-16i&quot;
)paren
suffix:semicolon
macro_line|#endif
macro_line|#endif
macro_line|#endif
r_extern
r_char
op_star
id|l1_revision
suffix:semicolon
r_extern
r_char
op_star
id|l2_revision
suffix:semicolon
r_extern
r_char
op_star
id|l3_revision
suffix:semicolon
r_extern
r_char
op_star
id|l4_revision
suffix:semicolon
r_extern
r_char
op_star
id|tei_revision
suffix:semicolon
r_char
op_star
DECL|function|HiSax_getrev
id|HiSax_getrev
c_func
(paren
r_const
r_char
op_star
id|revision
)paren
(brace
r_char
op_star
id|rev
suffix:semicolon
r_char
op_star
id|p
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|strchr
c_func
(paren
id|revision
comma
l_char|&squot;:&squot;
)paren
)paren
)paren
(brace
id|rev
op_assign
id|p
op_plus
l_int|2
suffix:semicolon
id|p
op_assign
id|strchr
c_func
(paren
id|rev
comma
l_char|&squot;$&squot;
)paren
suffix:semicolon
op_star
op_decrement
id|p
op_assign
l_int|0
suffix:semicolon
)brace
r_else
id|rev
op_assign
l_string|&quot;???&quot;
suffix:semicolon
r_return
id|rev
suffix:semicolon
)brace
DECL|variable|nrcards
r_int
id|nrcards
suffix:semicolon
r_void
DECL|function|HiSax_mod_dec_use_count
id|HiSax_mod_dec_use_count
c_func
(paren
r_void
)paren
(brace
id|MOD_DEC_USE_COUNT
suffix:semicolon
)brace
r_void
DECL|function|HiSax_mod_inc_use_count
id|HiSax_mod_inc_use_count
c_func
(paren
r_void
)paren
(brace
id|MOD_INC_USE_COUNT
suffix:semicolon
)brace
macro_line|#ifdef MODULE
DECL|macro|HiSax_init
mdefine_line|#define HiSax_init init_module
macro_line|#else
r_void
DECL|function|HiSax_setup
id|HiSax_setup
c_func
(paren
r_char
op_star
id|str
comma
r_int
op_star
id|ints
)paren
(brace
r_int
id|i
comma
id|j
comma
id|argc
suffix:semicolon
id|argc
op_assign
id|ints
(braket
l_int|0
)braket
suffix:semicolon
id|i
op_assign
l_int|0
suffix:semicolon
id|j
op_assign
l_int|1
suffix:semicolon
r_while
c_loop
(paren
id|argc
op_logical_and
(paren
id|i
OL
l_int|16
)paren
)paren
(brace
r_if
c_cond
(paren
id|argc
)paren
(brace
id|cards
(braket
id|i
)braket
dot
id|typ
op_assign
id|ints
(braket
id|j
)braket
suffix:semicolon
id|j
op_increment
suffix:semicolon
id|argc
op_decrement
suffix:semicolon
)brace
r_if
c_cond
(paren
id|argc
)paren
(brace
id|cards
(braket
id|i
)braket
dot
id|protocol
op_assign
id|ints
(braket
id|j
)braket
suffix:semicolon
id|j
op_increment
suffix:semicolon
id|argc
op_decrement
suffix:semicolon
)brace
r_if
c_cond
(paren
id|argc
)paren
(brace
id|cards
(braket
id|i
)braket
dot
id|para
(braket
l_int|0
)braket
op_assign
id|ints
(braket
id|j
)braket
suffix:semicolon
id|j
op_increment
suffix:semicolon
id|argc
op_decrement
suffix:semicolon
)brace
r_if
c_cond
(paren
id|argc
)paren
(brace
id|cards
(braket
id|i
)braket
dot
id|para
(braket
l_int|1
)braket
op_assign
id|ints
(braket
id|j
)braket
suffix:semicolon
id|j
op_increment
suffix:semicolon
id|argc
op_decrement
suffix:semicolon
)brace
r_if
c_cond
(paren
id|argc
)paren
(brace
id|cards
(braket
id|i
)braket
dot
id|para
(braket
l_int|2
)braket
op_assign
id|ints
(braket
id|j
)braket
suffix:semicolon
id|j
op_increment
suffix:semicolon
id|argc
op_decrement
suffix:semicolon
)brace
id|i
op_increment
suffix:semicolon
)brace
r_if
c_cond
(paren
id|strlen
c_func
(paren
id|str
)paren
)paren
(brace
id|strcpy
c_func
(paren
id|HiSaxID
comma
id|str
)paren
suffix:semicolon
id|HiSax_id
op_assign
id|HiSaxID
suffix:semicolon
)brace
r_else
(brace
id|strcpy
c_func
(paren
id|HiSaxID
comma
l_string|&quot;HiSax&quot;
)paren
suffix:semicolon
id|HiSax_id
op_assign
id|HiSaxID
suffix:semicolon
)brace
)brace
macro_line|#endif
r_int
DECL|function|HiSax_init
id|HiSax_init
c_func
(paren
r_void
)paren
(brace
r_int
id|i
suffix:semicolon
r_char
id|tmp
(braket
l_int|64
)braket
comma
id|rev
(braket
l_int|64
)braket
suffix:semicolon
r_char
op_star
id|r
op_assign
id|rev
suffix:semicolon
macro_line|#ifdef MODULE
r_int
id|nzproto
op_assign
l_int|0
suffix:semicolon
macro_line|#endif
id|nrcards
op_assign
l_int|0
suffix:semicolon
id|strcpy
c_func
(paren
id|tmp
comma
id|l1_revision
)paren
suffix:semicolon
id|r
op_add_assign
id|sprintf
c_func
(paren
id|r
comma
l_string|&quot;%s/&quot;
comma
id|HiSax_getrev
c_func
(paren
id|tmp
)paren
)paren
suffix:semicolon
id|strcpy
c_func
(paren
id|tmp
comma
id|l2_revision
)paren
suffix:semicolon
id|r
op_add_assign
id|sprintf
c_func
(paren
id|r
comma
l_string|&quot;%s/&quot;
comma
id|HiSax_getrev
c_func
(paren
id|tmp
)paren
)paren
suffix:semicolon
id|strcpy
c_func
(paren
id|tmp
comma
id|l3_revision
)paren
suffix:semicolon
id|r
op_add_assign
id|sprintf
c_func
(paren
id|r
comma
l_string|&quot;%s/&quot;
comma
id|HiSax_getrev
c_func
(paren
id|tmp
)paren
)paren
suffix:semicolon
id|strcpy
c_func
(paren
id|tmp
comma
id|l4_revision
)paren
suffix:semicolon
id|r
op_add_assign
id|sprintf
c_func
(paren
id|r
comma
l_string|&quot;%s/&quot;
comma
id|HiSax_getrev
c_func
(paren
id|tmp
)paren
)paren
suffix:semicolon
id|strcpy
c_func
(paren
id|tmp
comma
id|tei_revision
)paren
suffix:semicolon
id|r
op_add_assign
id|sprintf
c_func
(paren
id|r
comma
l_string|&quot;%s&quot;
comma
id|HiSax_getrev
c_func
(paren
id|tmp
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_NOTICE
l_string|&quot;HiSax: Driver for Siemens chip set ISDN cards&bslash;n&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_NOTICE
l_string|&quot;HiSax: Version 2.1&bslash;n&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_NOTICE
l_string|&quot;HiSax: Revisions %s&bslash;n&quot;
comma
id|rev
)paren
suffix:semicolon
macro_line|#ifdef MODULE
r_if
c_cond
(paren
id|id
)paren
multiline_comment|/* If id= string used */
id|HiSax_id
op_assign
id|id
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|16
suffix:semicolon
id|i
op_increment
)paren
(brace
id|cards
(braket
id|i
)braket
dot
id|typ
op_assign
id|type
(braket
id|i
)braket
suffix:semicolon
r_if
c_cond
(paren
id|protocol
(braket
id|i
)braket
)paren
(brace
id|cards
(braket
id|i
)braket
dot
id|protocol
op_assign
id|protocol
(braket
id|i
)braket
suffix:semicolon
id|nzproto
op_increment
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|type
(braket
id|i
)braket
)paren
(brace
r_case
id|ISDN_CTYPE_16_0
suffix:colon
id|cards
(braket
id|i
)braket
dot
id|para
(braket
l_int|0
)braket
op_assign
id|irq
(braket
id|i
)braket
suffix:semicolon
id|cards
(braket
id|i
)braket
dot
id|para
(braket
l_int|1
)braket
op_assign
id|mem
(braket
id|i
)braket
suffix:semicolon
id|cards
(braket
id|i
)braket
dot
id|para
(braket
l_int|2
)braket
op_assign
id|io
(braket
id|i
)braket
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ISDN_CTYPE_8_0
suffix:colon
id|cards
(braket
id|i
)braket
dot
id|para
(braket
l_int|0
)braket
op_assign
id|irq
(braket
id|i
)braket
suffix:semicolon
id|cards
(braket
id|i
)braket
dot
id|para
(braket
l_int|1
)braket
op_assign
id|mem
(braket
id|i
)braket
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ISDN_CTYPE_16_3
suffix:colon
r_case
id|ISDN_CTYPE_TELESPCMCIA
suffix:colon
id|cards
(braket
id|i
)braket
dot
id|para
(braket
l_int|0
)braket
op_assign
id|irq
(braket
id|i
)braket
suffix:semicolon
id|cards
(braket
id|i
)braket
dot
id|para
(braket
l_int|1
)braket
op_assign
id|io
(braket
id|i
)braket
suffix:semicolon
r_break
suffix:semicolon
macro_line|#ifdef CONFIG_HISAX_16_3&t;/* For Creatix/Teles PnP */
r_case
id|ISDN_CTYPE_PNP
suffix:colon
id|cards
(braket
id|i
)braket
dot
id|para
(braket
l_int|0
)braket
op_assign
id|irq
(braket
id|i
)braket
suffix:semicolon
id|cards
(braket
id|i
)braket
dot
id|para
(braket
l_int|1
)braket
op_assign
id|io0
(braket
id|i
)braket
suffix:semicolon
id|cards
(braket
id|i
)braket
dot
id|para
(braket
l_int|2
)braket
op_assign
id|io1
(braket
id|i
)braket
suffix:semicolon
r_break
suffix:semicolon
macro_line|#endif
r_case
id|ISDN_CTYPE_A1
suffix:colon
id|cards
(braket
id|i
)braket
dot
id|para
(braket
l_int|0
)braket
op_assign
id|irq
(braket
id|i
)braket
suffix:semicolon
id|cards
(braket
id|i
)braket
dot
id|para
(braket
l_int|1
)braket
op_assign
id|io
(braket
id|i
)braket
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ISDN_CTYPE_ELSA
suffix:colon
id|cards
(braket
id|i
)braket
dot
id|para
(braket
l_int|0
)braket
op_assign
id|io
(braket
id|i
)braket
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ISDN_CTYPE_ELSA_QS1000
suffix:colon
id|cards
(braket
id|i
)braket
dot
id|para
(braket
l_int|0
)braket
op_assign
id|irq
(braket
id|i
)braket
suffix:semicolon
id|cards
(braket
id|i
)braket
dot
id|para
(braket
l_int|1
)braket
op_assign
id|io
(braket
id|i
)braket
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ISDN_CTYPE_IX1MICROR2
suffix:colon
id|cards
(braket
id|i
)braket
dot
id|para
(braket
l_int|0
)braket
op_assign
id|irq
(braket
id|i
)braket
suffix:semicolon
id|cards
(braket
id|i
)braket
dot
id|para
(braket
l_int|1
)braket
op_assign
id|io
(braket
id|i
)braket
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
op_logical_neg
id|nzproto
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;HiSax: Warning - no protocol specified&bslash;n&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;HiSax: Note! module load syntax has changed.&bslash;n&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;HiSax: using protocol %s&bslash;n&quot;
comma
id|DEFAULT_PROTO_NAME
)paren
suffix:semicolon
)brace
macro_line|#endif
r_if
c_cond
(paren
op_logical_neg
id|HiSax_id
)paren
id|HiSax_id
op_assign
id|HiSaxID
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|HiSaxID
(braket
l_int|0
)braket
)paren
id|strcpy
c_func
(paren
id|HiSaxID
comma
l_string|&quot;HiSax&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|16
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|cards
(braket
id|i
)braket
dot
id|typ
OG
l_int|0
)paren
id|nrcards
op_increment
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;HiSax: Total %d card%s defined&bslash;n&quot;
comma
id|nrcards
comma
(paren
id|nrcards
OG
l_int|1
)paren
ques
c_cond
l_string|&quot;s&quot;
suffix:colon
l_string|&quot;&quot;
)paren
suffix:semicolon
id|CallcNew
c_func
(paren
)paren
suffix:semicolon
id|Isdnl2New
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|HiSax_inithardware
c_func
(paren
)paren
)paren
(brace
multiline_comment|/* Install only, if at least one card found */
multiline_comment|/* No symbols to export, hide all symbols */
macro_line|#ifdef MODULE
macro_line|#if (LINUX_VERSION_CODE &lt; 0x020111)
id|register_symtab
c_func
(paren
l_int|NULL
)paren
suffix:semicolon
macro_line|#else
id|EXPORT_NO_SYMBOLS
suffix:semicolon
macro_line|#endif
id|printk
c_func
(paren
id|KERN_NOTICE
l_string|&quot;HiSax: module installed&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#endif
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_else
(brace
id|Isdnl2Free
c_func
(paren
)paren
suffix:semicolon
id|CallcFree
c_func
(paren
)paren
suffix:semicolon
r_return
op_minus
id|EIO
suffix:semicolon
)brace
)brace
macro_line|#ifdef MODULE
r_void
DECL|function|cleanup_module
id|cleanup_module
c_func
(paren
r_void
)paren
(brace
id|HiSax_closehardware
c_func
(paren
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_NOTICE
l_string|&quot;HiSax module removed&bslash;n&quot;
)paren
suffix:semicolon
)brace
macro_line|#endif
eof
