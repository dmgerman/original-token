multiline_comment|/* $Id: isdnl2.c,v 1.10 1997/05/06 09:38:13 keil Exp $&n;&n; * Author       Karsten Keil (keil@temic-ech.spacenet.de)&n; *              based on the teles driver from Jan den Ouden&n; *&n; * Thanks to    Jan den Ouden&n; *              Fritz Elfert&n; *&n; * $Log: isdnl2.c,v $&n; * Revision 1.10  1997/05/06 09:38:13  keil&n; * Bugfixes: - clear ack queue entries after resend&n; *           - acknowlege each frame to linklevel&n; *           - UA for SABM is Response, not command&n; *           - only RR was send as supervisor frame (X.75 hangs after a&n; *             sequence error)&n; *&n; * Revision 1.9  1997/04/07 23:02:11  keil&n; * missing braces&n; *&n; * Revision 1.8  1997/04/06 22:59:59  keil&n; * Using SKB&squot;s; changing function names; some minor changes&n; *&n; * Revision 1.7  1997/02/09 00:25:44  keil&n; * new interface handling, one interface per card&n; *&n; * Revision 1.6  1997/01/21 22:23:42  keil&n; * D-channel log changed&n; *&n; * Revision 1.5  1997/01/04 13:47:06  keil&n; * handling of MDL_REMOVE added (Thanks to Sim Yskes)&n; *&n; * Revision 1.4  1996/12/08 19:51:51  keil&n; * many fixes from Pekka Sarnila&n; *&n; * Revision 1.3  1996/11/05 19:39:12  keil&n; * X.75 bugfixes Thank to Martin Maurer&n; *&n; * Revision 1.2  1996/10/30 10:20:58  keil&n; * X.75 answer of SABMX fixed to response address (AVM X.75 problem)&n; *&n; * Revision 1.1  1996/10/13 20:04:54  keil&n; * Initial revision&n; *&n; *&n; *&n; */
DECL|macro|__NO_VERSION__
mdefine_line|#define __NO_VERSION__
macro_line|#include &quot;hisax.h&quot;
macro_line|#include &quot;isdnl2.h&quot;
DECL|variable|l2_revision
r_const
r_char
op_star
id|l2_revision
op_assign
l_string|&quot;$Revision: 1.10 $&quot;
suffix:semicolon
r_static
r_void
id|l2m_debug
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_char
op_star
id|s
)paren
suffix:semicolon
DECL|variable|l2fsm
r_struct
id|Fsm
id|l2fsm
op_assign
(brace
l_int|NULL
comma
l_int|0
comma
l_int|0
comma
l_int|NULL
comma
l_int|NULL
)brace
suffix:semicolon
r_enum
(brace
DECL|enumerator|ST_L2_1
id|ST_L2_1
comma
DECL|enumerator|ST_L2_3
id|ST_L2_3
comma
DECL|enumerator|ST_L2_4
id|ST_L2_4
comma
DECL|enumerator|ST_L2_5
id|ST_L2_5
comma
DECL|enumerator|ST_L2_6
id|ST_L2_6
comma
DECL|enumerator|ST_L2_7
id|ST_L2_7
comma
DECL|enumerator|ST_L2_8
id|ST_L2_8
comma
)brace
suffix:semicolon
DECL|macro|L2_STATE_COUNT
mdefine_line|#define L2_STATE_COUNT (ST_L2_8+1)
DECL|variable|strL2State
r_static
r_char
op_star
id|strL2State
(braket
)braket
op_assign
(brace
l_string|&quot;ST_L2_1&quot;
comma
l_string|&quot;ST_L2_3&quot;
comma
l_string|&quot;ST_L2_4&quot;
comma
l_string|&quot;ST_L2_5&quot;
comma
l_string|&quot;ST_L2_6&quot;
comma
l_string|&quot;ST_L2_7&quot;
comma
l_string|&quot;ST_L2_8&quot;
comma
)brace
suffix:semicolon
r_enum
(brace
DECL|enumerator|EV_L2_UI
id|EV_L2_UI
comma
DECL|enumerator|EV_L2_SABMX
id|EV_L2_SABMX
comma
DECL|enumerator|EV_L2_UA
id|EV_L2_UA
comma
DECL|enumerator|EV_L2_DISC
id|EV_L2_DISC
comma
DECL|enumerator|EV_L2_I
id|EV_L2_I
comma
DECL|enumerator|EV_L2_RR
id|EV_L2_RR
comma
DECL|enumerator|EV_L2_REJ
id|EV_L2_REJ
comma
DECL|enumerator|EV_L2_FRMR
id|EV_L2_FRMR
comma
DECL|enumerator|EV_L2_DL_DATA
id|EV_L2_DL_DATA
comma
DECL|enumerator|EV_L2_DL_ESTABLISH
id|EV_L2_DL_ESTABLISH
comma
DECL|enumerator|EV_L2_MDL_ASSIGN
id|EV_L2_MDL_ASSIGN
comma
DECL|enumerator|EV_L2_MDL_REMOVE
id|EV_L2_MDL_REMOVE
comma
DECL|enumerator|EV_L2_DL_UNIT_DATA
id|EV_L2_DL_UNIT_DATA
comma
DECL|enumerator|EV_L2_DL_RELEASE
id|EV_L2_DL_RELEASE
comma
DECL|enumerator|EV_L2_MDL_NOTEIPROC
id|EV_L2_MDL_NOTEIPROC
comma
DECL|enumerator|EV_L2_T200
id|EV_L2_T200
comma
DECL|enumerator|EV_L2_ACK_PULL
id|EV_L2_ACK_PULL
comma
DECL|enumerator|EV_L2_T203
id|EV_L2_T203
comma
DECL|enumerator|EV_L2_RNR
id|EV_L2_RNR
comma
)brace
suffix:semicolon
DECL|macro|L2_EVENT_COUNT
mdefine_line|#define L2_EVENT_COUNT (EV_L2_RNR+1)
DECL|variable|strL2Event
r_static
r_char
op_star
id|strL2Event
(braket
)braket
op_assign
(brace
l_string|&quot;EV_L2_UI&quot;
comma
l_string|&quot;EV_L2_SABMX&quot;
comma
l_string|&quot;EV_L2_UA&quot;
comma
l_string|&quot;EV_L2_DISC&quot;
comma
l_string|&quot;EV_L2_I&quot;
comma
l_string|&quot;EV_L2_RR&quot;
comma
l_string|&quot;EV_L2_REJ&quot;
comma
l_string|&quot;EV_L2_FRMR&quot;
comma
l_string|&quot;EV_L2_DL_DATA&quot;
comma
l_string|&quot;EV_L2_DL_ESTABLISH&quot;
comma
l_string|&quot;EV_L2_MDL_ASSIGN&quot;
comma
l_string|&quot;EV_L2_MDL_REMOVE&quot;
comma
l_string|&quot;EV_L2_DL_UNIT_DATA&quot;
comma
l_string|&quot;EV_L2_DL_RELEASE&quot;
comma
l_string|&quot;EV_L2_MDL_NOTEIPROC&quot;
comma
l_string|&quot;EV_L2_T200&quot;
comma
l_string|&quot;EV_L2_ACK_PULL&quot;
comma
l_string|&quot;EV_L2_T203&quot;
comma
l_string|&quot;EV_L2_RNR&quot;
comma
)brace
suffix:semicolon
DECL|variable|errcount
r_int
id|errcount
op_assign
l_int|0
suffix:semicolon
r_static
r_int
id|l2addrsize
c_func
(paren
r_struct
id|Layer2
op_star
id|tsp
)paren
suffix:semicolon
r_static
r_void
DECL|function|InitWin
id|InitWin
c_func
(paren
r_struct
id|Layer2
op_star
id|l2
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|MAX_WINDOW
suffix:semicolon
id|i
op_increment
)paren
id|l2-&gt;windowar
(braket
id|i
)braket
op_assign
l_int|NULL
suffix:semicolon
)brace
r_static
r_void
DECL|function|ReleaseWin
id|ReleaseWin
c_func
(paren
r_struct
id|Layer2
op_star
id|l2
)paren
(brace
r_int
id|i
comma
id|cnt
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|MAX_WINDOW
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|l2-&gt;windowar
(braket
id|i
)braket
)paren
(brace
id|cnt
op_increment
suffix:semicolon
id|SET_SKB_FREE
c_func
(paren
id|l2-&gt;windowar
(braket
id|i
)braket
)paren
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|l2-&gt;windowar
(braket
id|i
)braket
)paren
suffix:semicolon
id|l2-&gt;windowar
(braket
id|i
)braket
op_assign
l_int|NULL
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|cnt
)paren
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;isdl2 freed %d skbuffs in release&bslash;n&quot;
comma
id|cnt
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|cansend
id|cansend
c_func
(paren
r_struct
id|PStack
op_star
id|st
)paren
(brace
r_int
id|p1
suffix:semicolon
id|p1
op_assign
(paren
id|st-&gt;l2.va
op_plus
id|st-&gt;l2.window
)paren
op_mod
(paren
id|st-&gt;l2.extended
ques
c_cond
l_int|128
suffix:colon
l_int|8
)paren
suffix:semicolon
r_return
(paren
id|st-&gt;l2.vs
op_ne
id|p1
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|discard_i_queue
id|discard_i_queue
c_func
(paren
r_struct
id|PStack
op_star
id|st
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_while
c_loop
(paren
(paren
id|skb
op_assign
id|skb_dequeue
c_func
(paren
op_amp
id|st-&gt;l2.i_queue
)paren
)paren
)paren
(brace
id|SET_SKB_FREE
c_func
(paren
id|skb
)paren
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
)brace
)brace
r_int
DECL|function|l2headersize
id|l2headersize
c_func
(paren
r_struct
id|Layer2
op_star
id|tsp
comma
r_int
id|ui
)paren
(brace
r_return
(paren
(paren
id|tsp-&gt;extended
op_logical_and
(paren
op_logical_neg
id|ui
)paren
ques
c_cond
l_int|2
suffix:colon
l_int|1
)paren
op_plus
(paren
id|tsp-&gt;laptype
op_eq
id|LAPD
ques
c_cond
l_int|2
suffix:colon
l_int|1
)paren
)paren
suffix:semicolon
)brace
r_int
DECL|function|l2addrsize
id|l2addrsize
c_func
(paren
r_struct
id|Layer2
op_star
id|tsp
)paren
(brace
r_return
(paren
id|tsp-&gt;laptype
op_eq
id|LAPD
ques
c_cond
l_int|2
suffix:colon
l_int|1
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|sethdraddr
id|sethdraddr
c_func
(paren
r_struct
id|Layer2
op_star
id|tsp
comma
id|u_char
op_star
id|header
comma
r_int
id|rsp
)paren
(brace
id|u_char
op_star
id|ptr
op_assign
id|header
suffix:semicolon
r_int
id|crbit
suffix:semicolon
r_if
c_cond
(paren
id|tsp-&gt;laptype
op_eq
id|LAPD
)paren
(brace
id|crbit
op_assign
id|rsp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|tsp-&gt;orig
)paren
id|crbit
op_assign
op_logical_neg
id|crbit
suffix:semicolon
op_star
id|ptr
op_increment
op_assign
(paren
id|tsp-&gt;sap
op_lshift
l_int|2
)paren
op_or
(paren
id|crbit
ques
c_cond
l_int|2
suffix:colon
l_int|0
)paren
suffix:semicolon
op_star
id|ptr
op_increment
op_assign
(paren
id|tsp-&gt;tei
op_lshift
l_int|1
)paren
op_or
l_int|1
suffix:semicolon
r_return
(paren
l_int|2
)paren
suffix:semicolon
)brace
r_else
(brace
id|crbit
op_assign
id|rsp
suffix:semicolon
r_if
c_cond
(paren
id|tsp-&gt;orig
)paren
id|crbit
op_assign
op_logical_neg
id|crbit
suffix:semicolon
r_if
c_cond
(paren
id|crbit
)paren
op_star
id|ptr
op_increment
op_assign
l_int|1
suffix:semicolon
r_else
op_star
id|ptr
op_increment
op_assign
l_int|3
suffix:semicolon
r_return
(paren
l_int|1
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|enqueue_ui
id|enqueue_ui
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_DATA
comma
id|skb
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|enqueue_super
id|enqueue_super
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_DATA
comma
id|skb
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|legalnr
id|legalnr
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|nr
)paren
(brace
r_struct
id|Layer2
op_star
id|l2
op_assign
op_amp
id|st-&gt;l2
suffix:semicolon
r_int
id|lnr
comma
id|lvs
suffix:semicolon
id|lvs
op_assign
(paren
id|l2-&gt;vs
op_ge
id|l2-&gt;va
)paren
ques
c_cond
id|l2-&gt;vs
suffix:colon
(paren
id|l2-&gt;vs
op_plus
id|l2-&gt;extended
ques
c_cond
l_int|128
suffix:colon
l_int|8
)paren
suffix:semicolon
id|lnr
op_assign
(paren
id|nr
op_ge
id|l2-&gt;va
)paren
ques
c_cond
id|nr
suffix:colon
(paren
id|nr
op_plus
id|l2-&gt;extended
ques
c_cond
l_int|128
suffix:colon
l_int|8
)paren
suffix:semicolon
r_return
(paren
id|lnr
op_le
id|lvs
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|setva
id|setva
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|nr
)paren
(brace
r_struct
id|Layer2
op_star
id|l2
op_assign
op_amp
id|st-&gt;l2
suffix:semicolon
r_if
c_cond
(paren
id|l2-&gt;va
op_ne
id|nr
)paren
(brace
r_while
c_loop
(paren
id|l2-&gt;va
op_ne
id|nr
)paren
(brace
id|l2-&gt;va
op_assign
(paren
id|l2-&gt;va
op_plus
l_int|1
)paren
op_mod
(paren
id|l2-&gt;extended
ques
c_cond
l_int|128
suffix:colon
l_int|8
)paren
suffix:semicolon
id|SET_SKB_FREE
c_func
(paren
id|l2-&gt;windowar
(braket
id|l2-&gt;sow
)braket
)paren
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|l2-&gt;windowar
(braket
id|l2-&gt;sow
)braket
)paren
suffix:semicolon
id|l2-&gt;windowar
(braket
id|l2-&gt;sow
)braket
op_assign
l_int|NULL
suffix:semicolon
id|l2-&gt;sow
op_assign
(paren
id|l2-&gt;sow
op_plus
l_int|1
)paren
op_mod
id|l2-&gt;window
suffix:semicolon
r_if
c_cond
(paren
id|st-&gt;l4.l2writewakeup
)paren
id|st-&gt;l4
dot
id|l2writewakeup
c_func
(paren
id|st
)paren
suffix:semicolon
)brace
)brace
)brace
r_static
r_void
DECL|function|l2s1
id|l2s1
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|st-&gt;l2
dot
id|l2tei
c_func
(paren
id|st
comma
id|MDL_ASSIGN
comma
(paren
r_void
op_star
)paren
id|st-&gt;l2.ces
)paren
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_3
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l2_send_ui
id|l2_send_ui
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|u_char
id|header
(braket
id|MAX_HEADER_LEN
)braket
suffix:semicolon
r_int
id|i
suffix:semicolon
id|i
op_assign
id|sethdraddr
c_func
(paren
op_amp
(paren
id|st-&gt;l2
)paren
comma
id|header
comma
id|CMD
)paren
suffix:semicolon
id|header
(braket
id|i
op_increment
)braket
op_assign
id|UI
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_push
c_func
(paren
id|skb
comma
id|i
)paren
comma
id|header
comma
id|i
)paren
suffix:semicolon
id|enqueue_ui
c_func
(paren
id|st
comma
id|skb
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l2_receive_ui
id|l2_receive_ui
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|skb_pull
c_func
(paren
id|skb
comma
id|l2headersize
c_func
(paren
op_amp
id|st-&gt;l2
comma
l_int|1
)paren
)paren
suffix:semicolon
id|st-&gt;l2
dot
id|l2l3
c_func
(paren
id|st
comma
id|DL_UNIT_DATA
comma
id|skb
)paren
suffix:semicolon
)brace
r_inline
r_void
DECL|function|send_uframe
id|send_uframe
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
id|u_char
id|cmd
comma
id|u_char
id|cr
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|u_char
id|tmp
(braket
id|MAX_HEADER_LEN
)braket
suffix:semicolon
r_int
id|i
suffix:semicolon
id|i
op_assign
id|sethdraddr
c_func
(paren
op_amp
id|st-&gt;l2
comma
id|tmp
comma
id|cr
)paren
suffix:semicolon
id|tmp
(braket
id|i
op_increment
)braket
op_assign
id|cmd
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|alloc_skb
c_func
(paren
id|i
comma
id|GFP_ATOMIC
)paren
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;isdl2 can&squot;t alloc sbbuff for send_uframe&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|i
)paren
comma
id|tmp
comma
id|i
)paren
suffix:semicolon
id|enqueue_super
c_func
(paren
id|st
comma
id|skb
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|establishlink
id|establishlink
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|u_char
id|cmd
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_5
)paren
suffix:semicolon
id|st-&gt;l2.rc
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|FsmAddTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200_timer
comma
id|st-&gt;l2.t200
comma
id|EV_L2_T200
comma
l_int|NULL
comma
l_int|1
)paren
)paren
r_if
c_cond
(paren
id|st-&gt;l2.l2m.debug
)paren
id|l2m_debug
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
l_string|&quot;FAT 1&quot;
)paren
suffix:semicolon
id|cmd
op_assign
(paren
id|st-&gt;l2.extended
ques
c_cond
id|SABME
suffix:colon
id|SABM
)paren
op_or
l_int|0x10
suffix:semicolon
id|send_uframe
c_func
(paren
id|st
comma
id|cmd
comma
id|CMD
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l2_establish
id|l2_establish
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
id|establishlink
c_func
(paren
id|fi
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l2_send_disconn
id|l2_send_disconn
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_struct
id|Channel
op_star
id|chanp
op_assign
id|st-&gt;l4.userdata
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_6
)paren
suffix:semicolon
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t203_timer
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|st-&gt;l2.t200_running
)paren
(brace
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200_timer
comma
l_int|2
)paren
suffix:semicolon
id|st-&gt;l2.t200_running
op_assign
l_int|0
suffix:semicolon
)brace
id|st-&gt;l2.rc
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|FsmAddTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200_timer
comma
id|st-&gt;l2.t200
comma
id|EV_L2_T200
comma
l_int|NULL
comma
l_int|2
)paren
)paren
r_if
c_cond
(paren
id|st-&gt;l2.l2m.debug
)paren
id|l2m_debug
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
l_string|&quot;FAT 2&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
(paren
id|chanp-&gt;impair
op_eq
l_int|2
)paren
op_logical_and
(paren
id|st-&gt;l2.laptype
op_eq
id|LAPB
)paren
)paren
)paren
id|send_uframe
c_func
(paren
id|st
comma
id|DISC
op_or
l_int|0x10
comma
id|CMD
)paren
suffix:semicolon
id|discard_i_queue
c_func
(paren
id|st
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l2_got_SABMX
id|l2_got_SABMX
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_int
id|est
op_assign
l_int|1
comma
id|state
suffix:semicolon
id|u_char
id|PollFlag
suffix:semicolon
id|state
op_assign
id|fi-&gt;state
suffix:semicolon
id|skb_pull
c_func
(paren
id|skb
comma
id|l2addrsize
c_func
(paren
op_amp
(paren
id|st-&gt;l2
)paren
)paren
)paren
suffix:semicolon
id|PollFlag
op_assign
op_star
id|skb-&gt;data
op_amp
l_int|0x10
suffix:semicolon
id|SET_SKB_FREE
c_func
(paren
id|skb
)paren
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ST_L2_4
op_ne
id|state
)paren
r_if
c_cond
(paren
id|st-&gt;l2.vs
op_ne
id|st-&gt;l2.va
)paren
(brace
id|discard_i_queue
c_func
(paren
id|st
)paren
suffix:semicolon
id|est
op_assign
l_int|1
suffix:semicolon
)brace
r_else
id|est
op_assign
l_int|0
suffix:semicolon
id|st-&gt;l2.vs
op_assign
l_int|0
suffix:semicolon
id|st-&gt;l2.va
op_assign
l_int|0
suffix:semicolon
id|st-&gt;l2.vr
op_assign
l_int|0
suffix:semicolon
id|st-&gt;l2.sow
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|ST_L2_7
op_ne
id|state
)paren
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_7
)paren
suffix:semicolon
id|send_uframe
c_func
(paren
id|st
comma
id|UA
op_or
id|PollFlag
comma
id|RSP
)paren
suffix:semicolon
r_if
c_cond
(paren
id|st-&gt;l2.t200_running
)paren
(brace
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200_timer
comma
l_int|15
)paren
suffix:semicolon
id|st-&gt;l2.t200_running
op_assign
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|FsmAddTimer
c_func
(paren
op_amp
id|st-&gt;l2.t203_timer
comma
id|st-&gt;l2.t203
comma
id|EV_L2_T203
comma
l_int|NULL
comma
l_int|3
)paren
)paren
r_if
c_cond
(paren
id|st-&gt;l2.l2m.debug
)paren
id|l2m_debug
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
l_string|&quot;FAT 3&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|est
)paren
id|st-&gt;l2
dot
id|l2man
c_func
(paren
id|st
comma
id|DL_ESTABLISH
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ST_L2_8
op_eq
id|state
)paren
r_if
c_cond
(paren
id|skb_queue_len
c_func
(paren
op_amp
id|st-&gt;l2.i_queue
)paren
op_logical_and
id|cansend
c_func
(paren
id|st
)paren
)paren
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_REQUEST_PULL
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l2_got_disconn
id|l2_got_disconn
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_struct
id|Channel
op_star
id|chanp
op_assign
id|st-&gt;l4.userdata
suffix:semicolon
id|u_char
id|PollFlag
suffix:semicolon
id|skb_pull
c_func
(paren
id|skb
comma
id|l2addrsize
c_func
(paren
op_amp
(paren
id|st-&gt;l2
)paren
)paren
)paren
suffix:semicolon
id|PollFlag
op_assign
op_star
id|skb-&gt;data
op_amp
l_int|0x10
suffix:semicolon
id|SET_SKB_FREE
c_func
(paren
id|skb
)paren
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_4
)paren
suffix:semicolon
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t203_timer
comma
l_int|3
)paren
suffix:semicolon
r_if
c_cond
(paren
id|st-&gt;l2.t200_running
)paren
(brace
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200_timer
comma
l_int|4
)paren
suffix:semicolon
id|st-&gt;l2.t200_running
op_assign
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
(paren
id|chanp-&gt;impair
op_eq
l_int|1
)paren
op_logical_and
(paren
id|st-&gt;l2.laptype
op_eq
id|LAPB
)paren
)paren
)paren
id|send_uframe
c_func
(paren
id|st
comma
id|UA
op_or
id|PollFlag
comma
id|RSP
)paren
suffix:semicolon
id|st-&gt;l2
dot
id|l2man
c_func
(paren
id|st
comma
id|DL_RELEASE
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l2_got_st4_disc
id|l2_got_st4_disc
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_struct
id|Channel
op_star
id|chanp
op_assign
id|st-&gt;l4.userdata
suffix:semicolon
id|u_char
id|PollFlag
suffix:semicolon
id|skb_pull
c_func
(paren
id|skb
comma
id|l2addrsize
c_func
(paren
op_amp
(paren
id|st-&gt;l2
)paren
)paren
)paren
suffix:semicolon
id|PollFlag
op_assign
op_star
id|skb-&gt;data
op_amp
l_int|0x10
suffix:semicolon
id|SET_SKB_FREE
c_func
(paren
id|skb
)paren
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
(paren
id|chanp-&gt;impair
op_eq
l_int|1
)paren
op_logical_and
(paren
id|st-&gt;l2.laptype
op_eq
id|LAPB
)paren
)paren
)paren
id|send_uframe
c_func
(paren
id|st
comma
id|DM
op_or
(paren
id|PollFlag
ques
c_cond
l_int|0x10
suffix:colon
l_int|0x0
)paren
comma
id|RSP
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l2_got_ua_establish
id|l2_got_ua_establish
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|u_char
id|f
suffix:semicolon
id|skb_pull
c_func
(paren
id|skb
comma
id|l2addrsize
c_func
(paren
op_amp
(paren
id|st-&gt;l2
)paren
)paren
)paren
suffix:semicolon
id|f
op_assign
op_star
id|skb-&gt;data
op_amp
l_int|0x10
suffix:semicolon
id|SET_SKB_FREE
c_func
(paren
id|skb
)paren
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
id|f
)paren
(brace
id|st-&gt;l2.vs
op_assign
l_int|0
suffix:semicolon
id|st-&gt;l2.va
op_assign
l_int|0
suffix:semicolon
id|st-&gt;l2.vr
op_assign
l_int|0
suffix:semicolon
id|st-&gt;l2.sow
op_assign
l_int|0
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_7
)paren
suffix:semicolon
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200_timer
comma
l_int|5
)paren
suffix:semicolon
r_if
c_cond
(paren
id|FsmAddTimer
c_func
(paren
op_amp
id|st-&gt;l2.t203_timer
comma
id|st-&gt;l2.t203
comma
id|EV_L2_T203
comma
l_int|NULL
comma
l_int|4
)paren
)paren
r_if
c_cond
(paren
id|st-&gt;l2.l2m.debug
)paren
id|l2m_debug
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
l_string|&quot;FAT 4&quot;
)paren
suffix:semicolon
id|st-&gt;l2
dot
id|l2man
c_func
(paren
id|st
comma
id|DL_ESTABLISH
comma
l_int|NULL
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|l2_got_ua_disconn
id|l2_got_ua_disconn
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|u_char
id|f
suffix:semicolon
id|skb_pull
c_func
(paren
id|skb
comma
id|l2addrsize
c_func
(paren
op_amp
(paren
id|st-&gt;l2
)paren
)paren
)paren
suffix:semicolon
id|f
op_assign
op_star
id|skb-&gt;data
op_amp
l_int|0x10
suffix:semicolon
id|SET_SKB_FREE
c_func
(paren
id|skb
)paren
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
id|f
)paren
(brace
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200_timer
comma
l_int|6
)paren
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_4
)paren
suffix:semicolon
id|st-&gt;l2
dot
id|l2man
c_func
(paren
id|st
comma
id|DL_RELEASE
comma
l_int|NULL
)paren
suffix:semicolon
)brace
)brace
r_inline
r_void
DECL|function|enquiry_cr
id|enquiry_cr
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
id|u_char
id|typ
comma
id|u_char
id|cr
comma
id|u_char
id|pf
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_struct
id|Layer2
op_star
id|l2
suffix:semicolon
id|u_char
id|tmp
(braket
id|MAX_HEADER_LEN
)braket
suffix:semicolon
r_int
id|i
suffix:semicolon
id|l2
op_assign
op_amp
id|st-&gt;l2
suffix:semicolon
id|i
op_assign
id|sethdraddr
c_func
(paren
id|l2
comma
id|tmp
comma
id|cr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|l2-&gt;extended
)paren
(brace
id|tmp
(braket
id|i
op_increment
)braket
op_assign
id|typ
suffix:semicolon
id|tmp
(braket
id|i
op_increment
)braket
op_assign
(paren
id|l2-&gt;vr
op_lshift
l_int|1
)paren
op_or
(paren
id|pf
ques
c_cond
l_int|1
suffix:colon
l_int|0
)paren
suffix:semicolon
)brace
r_else
id|tmp
(braket
id|i
op_increment
)braket
op_assign
(paren
id|l2-&gt;vr
op_lshift
l_int|5
)paren
op_or
id|typ
op_or
(paren
id|pf
ques
c_cond
l_int|0x10
suffix:colon
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|alloc_skb
c_func
(paren
id|i
comma
id|GFP_ATOMIC
)paren
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;isdl2 can&squot;t alloc sbbuff for enquiry_cr&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|i
)paren
comma
id|tmp
comma
id|i
)paren
suffix:semicolon
id|enqueue_super
c_func
(paren
id|st
comma
id|skb
)paren
suffix:semicolon
)brace
r_inline
r_void
DECL|function|enquiry_response
id|enquiry_response
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
id|u_char
id|typ
comma
id|u_char
id|final
)paren
(brace
id|enquiry_cr
c_func
(paren
id|st
comma
id|typ
comma
id|RSP
comma
id|final
)paren
suffix:semicolon
)brace
r_inline
r_void
DECL|function|enquiry_command
id|enquiry_command
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
id|u_char
id|typ
comma
id|u_char
id|poll
)paren
(brace
id|enquiry_cr
c_func
(paren
id|st
comma
id|typ
comma
id|CMD
comma
id|poll
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|nrerrorrecovery
id|nrerrorrecovery
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
)paren
(brace
multiline_comment|/* should log error here */
id|establishlink
c_func
(paren
id|fi
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l2_got_st7_RR
id|l2_got_st7_RR
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_struct
id|Channel
op_star
id|chanp
op_assign
id|st-&gt;l4.userdata
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_int
id|PollFlag
comma
id|seq
comma
id|rsp
suffix:semicolon
r_struct
id|Layer2
op_star
id|l2
suffix:semicolon
id|l2
op_assign
op_amp
id|st-&gt;l2
suffix:semicolon
r_if
c_cond
(paren
id|l2-&gt;laptype
op_eq
id|LAPD
)paren
id|rsp
op_assign
op_star
id|skb-&gt;data
op_amp
l_int|0x2
suffix:semicolon
r_else
id|rsp
op_assign
op_star
id|skb-&gt;data
op_eq
l_int|0x3
suffix:semicolon
r_if
c_cond
(paren
id|l2-&gt;orig
)paren
id|rsp
op_assign
op_logical_neg
id|rsp
suffix:semicolon
id|skb_pull
c_func
(paren
id|skb
comma
id|l2addrsize
c_func
(paren
id|l2
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|l2-&gt;extended
)paren
(brace
id|PollFlag
op_assign
(paren
id|skb-&gt;data
(braket
l_int|1
)braket
op_amp
l_int|0x1
)paren
op_eq
l_int|0x1
suffix:semicolon
id|seq
op_assign
id|skb-&gt;data
(braket
l_int|1
)braket
op_rshift
l_int|1
suffix:semicolon
)brace
r_else
(brace
id|PollFlag
op_assign
(paren
id|skb-&gt;data
(braket
l_int|0
)braket
op_amp
l_int|0x10
)paren
suffix:semicolon
id|seq
op_assign
(paren
id|skb-&gt;data
(braket
l_int|0
)braket
op_rshift
l_int|5
)paren
op_amp
l_int|0x7
suffix:semicolon
)brace
id|SET_SKB_FREE
c_func
(paren
id|skb
)paren
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
(paren
id|chanp-&gt;impair
op_eq
l_int|4
)paren
op_logical_and
(paren
id|st-&gt;l2.laptype
op_eq
id|LAPB
)paren
)paren
)paren
r_if
c_cond
(paren
(paren
op_logical_neg
id|rsp
)paren
op_logical_and
id|PollFlag
)paren
id|enquiry_response
c_func
(paren
id|st
comma
id|RR
comma
id|PollFlag
)paren
suffix:semicolon
r_if
c_cond
(paren
id|legalnr
c_func
(paren
id|st
comma
id|seq
)paren
)paren
(brace
r_if
c_cond
(paren
id|seq
op_eq
id|l2-&gt;vs
)paren
(brace
id|setva
c_func
(paren
id|st
comma
id|seq
)paren
suffix:semicolon
id|FsmDelTimer
c_func
(paren
op_amp
id|l2-&gt;t200_timer
comma
l_int|7
)paren
suffix:semicolon
id|l2-&gt;t200_running
op_assign
l_int|0
suffix:semicolon
id|FsmDelTimer
c_func
(paren
op_amp
id|l2-&gt;t203_timer
comma
l_int|8
)paren
suffix:semicolon
r_if
c_cond
(paren
id|FsmAddTimer
c_func
(paren
op_amp
id|l2-&gt;t203_timer
comma
id|l2-&gt;t203
comma
id|EV_L2_T203
comma
l_int|NULL
comma
l_int|5
)paren
)paren
r_if
c_cond
(paren
id|l2-&gt;l2m.debug
)paren
id|l2m_debug
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
l_string|&quot;FAT 5&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb_queue_len
c_func
(paren
op_amp
id|st-&gt;l2.i_queue
)paren
)paren
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_REQUEST_PULL
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|l2-&gt;va
op_ne
id|seq
)paren
(brace
id|setva
c_func
(paren
id|st
comma
id|seq
)paren
suffix:semicolon
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200_timer
comma
l_int|9
)paren
suffix:semicolon
r_if
c_cond
(paren
id|FsmAddTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200_timer
comma
id|st-&gt;l2.t200
comma
id|EV_L2_T200
comma
l_int|NULL
comma
l_int|6
)paren
)paren
r_if
c_cond
(paren
id|st-&gt;l2.l2m.debug
)paren
id|l2m_debug
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
l_string|&quot;FAT 6&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb_queue_len
c_func
(paren
op_amp
id|st-&gt;l2.i_queue
)paren
)paren
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_REQUEST_PULL
comma
l_int|NULL
)paren
suffix:semicolon
)brace
)brace
r_else
id|nrerrorrecovery
c_func
(paren
id|fi
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|fi-&gt;userint
op_amp
id|LC_FLUSH_WAIT
)paren
op_logical_and
id|rsp
op_logical_and
op_logical_neg
(paren
id|skb_queue_len
c_func
(paren
op_amp
id|st-&gt;l2.i_queue
)paren
)paren
)paren
(brace
id|fi-&gt;userint
op_and_assign
op_complement
id|LC_FLUSH_WAIT
suffix:semicolon
id|st-&gt;l2
dot
id|l2man
c_func
(paren
id|st
comma
id|DL_FLUSH
comma
l_int|NULL
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|l2_feed_iqueue
id|l2_feed_iqueue
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|skb_queue_tail
c_func
(paren
op_amp
id|st-&gt;l2.i_queue
comma
id|skb
)paren
suffix:semicolon
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_REQUEST_PULL
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|icommandreceived
id|icommandreceived
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
comma
r_int
op_star
id|nr
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_struct
id|Channel
op_star
id|chanp
op_assign
id|st-&gt;l4.userdata
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_struct
id|IsdnCardState
op_star
id|sp
op_assign
id|st-&gt;l1.hardware
suffix:semicolon
r_struct
id|Layer2
op_star
id|l2
op_assign
op_amp
(paren
id|st-&gt;l2
)paren
suffix:semicolon
r_int
id|i
comma
id|p
comma
id|seq
comma
id|wasok
suffix:semicolon
r_char
id|str
(braket
l_int|64
)braket
suffix:semicolon
id|i
op_assign
id|l2addrsize
c_func
(paren
id|l2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|l2-&gt;extended
)paren
(brace
id|p
op_assign
(paren
id|skb-&gt;data
(braket
id|i
op_plus
l_int|1
)braket
op_amp
l_int|0x1
)paren
op_eq
l_int|0x1
suffix:semicolon
id|seq
op_assign
id|skb-&gt;data
(braket
id|i
)braket
op_rshift
l_int|1
suffix:semicolon
op_star
id|nr
op_assign
(paren
id|skb-&gt;data
(braket
id|i
op_plus
l_int|1
)braket
op_rshift
l_int|1
)paren
op_amp
l_int|0x7f
suffix:semicolon
)brace
r_else
(brace
id|p
op_assign
(paren
id|skb-&gt;data
(braket
id|i
)braket
op_amp
l_int|0x10
)paren
suffix:semicolon
id|seq
op_assign
(paren
id|skb-&gt;data
(braket
id|i
)braket
op_rshift
l_int|1
)paren
op_amp
l_int|0x7
suffix:semicolon
op_star
id|nr
op_assign
(paren
id|skb-&gt;data
(braket
id|i
)braket
op_rshift
l_int|5
)paren
op_amp
l_int|0x7
suffix:semicolon
)brace
r_if
c_cond
(paren
id|l2-&gt;vr
op_eq
id|seq
)paren
(brace
id|wasok
op_assign
op_logical_neg
l_int|0
suffix:semicolon
id|l2-&gt;vr
op_assign
(paren
id|l2-&gt;vr
op_plus
l_int|1
)paren
op_mod
(paren
id|l2-&gt;extended
ques
c_cond
l_int|128
suffix:colon
l_int|8
)paren
suffix:semicolon
id|l2-&gt;rejexp
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|st-&gt;l2.laptype
op_eq
id|LAPD
)paren
r_if
c_cond
(paren
id|sp-&gt;dlogflag
)paren
(brace
id|LogFrame
c_func
(paren
id|st-&gt;l1.hardware
comma
id|skb-&gt;data
comma
id|skb-&gt;len
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|str
comma
l_string|&quot;Q.931 frame network-&gt;user tei %d&quot;
comma
id|st-&gt;l2.tei
)paren
suffix:semicolon
id|dlogframe
c_func
(paren
id|st-&gt;l1.hardware
comma
id|skb-&gt;data
op_plus
id|l2-&gt;ihsize
comma
id|skb-&gt;len
op_minus
id|l2-&gt;ihsize
comma
id|str
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
(paren
id|chanp-&gt;impair
op_eq
l_int|3
)paren
op_logical_and
(paren
id|st-&gt;l2.laptype
op_eq
id|LAPB
)paren
)paren
)paren
r_if
c_cond
(paren
id|p
op_logical_or
(paren
op_logical_neg
id|skb_queue_len
c_func
(paren
op_amp
id|st-&gt;l2.i_queue
)paren
)paren
)paren
id|enquiry_response
c_func
(paren
id|st
comma
id|RR
comma
id|p
)paren
suffix:semicolon
id|skb_pull
c_func
(paren
id|skb
comma
id|l2headersize
c_func
(paren
id|l2
comma
l_int|0
)paren
)paren
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* n(s)!=v(r) */
id|wasok
op_assign
l_int|0
suffix:semicolon
id|SET_SKB_FREE
c_func
(paren
id|skb
)paren
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
id|st-&gt;l2.rejexp
)paren
(brace
r_if
c_cond
(paren
id|p
)paren
r_if
c_cond
(paren
op_logical_neg
(paren
(paren
id|chanp-&gt;impair
op_eq
l_int|3
)paren
op_logical_and
(paren
id|st-&gt;l2.laptype
op_eq
id|LAPB
)paren
)paren
)paren
id|enquiry_response
c_func
(paren
id|st
comma
id|RR
comma
id|p
)paren
suffix:semicolon
)brace
r_else
(brace
id|st-&gt;l2.rejexp
op_assign
op_logical_neg
l_int|0
suffix:semicolon
id|enquiry_command
c_func
(paren
id|st
comma
id|REJ
comma
l_int|1
)paren
suffix:semicolon
)brace
)brace
r_return
id|wasok
suffix:semicolon
)brace
r_static
r_void
DECL|function|l2_got_st7_data
id|l2_got_st7_data
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_int
id|nr
comma
id|wasok
suffix:semicolon
id|wasok
op_assign
id|icommandreceived
c_func
(paren
id|fi
comma
id|event
comma
id|arg
comma
op_amp
id|nr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|legalnr
c_func
(paren
id|st
comma
id|nr
)paren
)paren
(brace
r_if
c_cond
(paren
id|nr
op_eq
id|st-&gt;l2.vs
)paren
(brace
id|setva
c_func
(paren
id|st
comma
id|nr
)paren
suffix:semicolon
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200_timer
comma
l_int|10
)paren
suffix:semicolon
id|st-&gt;l2.t200_running
op_assign
l_int|0
suffix:semicolon
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t203_timer
comma
l_int|11
)paren
suffix:semicolon
r_if
c_cond
(paren
id|FsmAddTimer
c_func
(paren
op_amp
id|st-&gt;l2.t203_timer
comma
id|st-&gt;l2.t203
comma
id|EV_L2_T203
comma
l_int|NULL
comma
l_int|7
)paren
)paren
r_if
c_cond
(paren
id|st-&gt;l2.l2m.debug
)paren
id|l2m_debug
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
l_string|&quot;FAT 5&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb_queue_len
c_func
(paren
op_amp
id|st-&gt;l2.i_queue
)paren
)paren
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_REQUEST_PULL
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|nr
op_ne
id|st-&gt;l2.va
)paren
(brace
id|setva
c_func
(paren
id|st
comma
id|nr
)paren
suffix:semicolon
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200_timer
comma
l_int|12
)paren
suffix:semicolon
r_if
c_cond
(paren
id|FsmAddTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200_timer
comma
id|st-&gt;l2.t200
comma
id|EV_L2_T200
comma
l_int|NULL
comma
l_int|8
)paren
)paren
r_if
c_cond
(paren
id|st-&gt;l2.l2m.debug
)paren
id|l2m_debug
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
l_string|&quot;FAT 6&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb_queue_len
c_func
(paren
op_amp
id|st-&gt;l2.i_queue
)paren
)paren
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_REQUEST_PULL
comma
l_int|NULL
)paren
suffix:semicolon
)brace
)brace
r_else
id|nrerrorrecovery
c_func
(paren
id|fi
)paren
suffix:semicolon
r_if
c_cond
(paren
id|wasok
)paren
id|st-&gt;l2
dot
id|l2l3
c_func
(paren
id|st
comma
id|DL_DATA
comma
id|skb
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l2_got_st8_data
id|l2_got_st8_data
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_int
id|nr
comma
id|wasok
suffix:semicolon
id|wasok
op_assign
id|icommandreceived
c_func
(paren
id|fi
comma
id|event
comma
id|arg
comma
op_amp
id|nr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|legalnr
c_func
(paren
id|st
comma
id|nr
)paren
)paren
(brace
id|setva
c_func
(paren
id|st
comma
id|nr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb_queue_len
c_func
(paren
op_amp
id|st-&gt;l2.i_queue
)paren
)paren
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_REQUEST_PULL
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_else
id|nrerrorrecovery
c_func
(paren
id|fi
)paren
suffix:semicolon
r_if
c_cond
(paren
id|wasok
)paren
id|st-&gt;l2
dot
id|l2l3
c_func
(paren
id|st
comma
id|DL_DATA
comma
id|skb
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l2_got_tei
id|l2_got_tei
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|st-&gt;l2.tei
op_assign
(paren
r_int
)paren
id|arg
suffix:semicolon
id|establishlink
c_func
(paren
id|fi
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|invoke_retransmission
id|invoke_retransmission
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|nr
)paren
(brace
r_struct
id|Layer2
op_star
id|l2
op_assign
op_amp
id|st-&gt;l2
suffix:semicolon
r_int
id|p1
suffix:semicolon
r_if
c_cond
(paren
id|l2-&gt;vs
op_ne
id|nr
)paren
(brace
r_while
c_loop
(paren
id|l2-&gt;vs
op_ne
id|nr
)paren
(brace
id|l2-&gt;vs
op_assign
id|l2-&gt;vs
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|l2-&gt;vs
OL
l_int|0
)paren
id|l2-&gt;vs
op_add_assign
id|l2-&gt;extended
ques
c_cond
l_int|128
suffix:colon
l_int|8
suffix:semicolon
id|p1
op_assign
id|l2-&gt;vs
op_minus
id|l2-&gt;va
suffix:semicolon
r_if
c_cond
(paren
id|p1
OL
l_int|0
)paren
id|p1
op_add_assign
id|l2-&gt;extended
ques
c_cond
l_int|128
suffix:colon
l_int|8
suffix:semicolon
id|p1
op_assign
(paren
id|p1
op_plus
id|l2-&gt;sow
)paren
op_mod
id|l2-&gt;window
suffix:semicolon
id|skb_queue_head
c_func
(paren
op_amp
id|l2-&gt;i_queue
comma
id|l2-&gt;windowar
(braket
id|p1
)braket
)paren
suffix:semicolon
id|l2-&gt;windowar
(braket
id|p1
)braket
op_assign
l_int|NULL
suffix:semicolon
)brace
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_REQUEST_PULL
comma
l_int|NULL
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|l2_got_st7_rej
id|l2_got_st7_rej
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_int
id|PollFlag
comma
id|seq
comma
id|rsp
suffix:semicolon
r_struct
id|Layer2
op_star
id|l2
suffix:semicolon
id|l2
op_assign
op_amp
id|st-&gt;l2
suffix:semicolon
r_if
c_cond
(paren
id|l2-&gt;laptype
op_eq
id|LAPD
)paren
id|rsp
op_assign
op_star
id|skb-&gt;data
op_amp
l_int|0x2
suffix:semicolon
r_else
id|rsp
op_assign
op_star
id|skb-&gt;data
op_eq
l_int|0x3
suffix:semicolon
r_if
c_cond
(paren
id|l2-&gt;orig
)paren
id|rsp
op_assign
op_logical_neg
id|rsp
suffix:semicolon
id|skb_pull
c_func
(paren
id|skb
comma
id|l2addrsize
c_func
(paren
id|l2
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|l2-&gt;extended
)paren
(brace
id|PollFlag
op_assign
(paren
id|skb-&gt;data
(braket
l_int|1
)braket
op_amp
l_int|0x1
)paren
op_eq
l_int|0x1
suffix:semicolon
id|seq
op_assign
id|skb-&gt;data
(braket
l_int|1
)braket
op_rshift
l_int|1
suffix:semicolon
)brace
r_else
(brace
id|PollFlag
op_assign
(paren
id|skb-&gt;data
(braket
l_int|0
)braket
op_amp
l_int|0x10
)paren
suffix:semicolon
id|seq
op_assign
(paren
id|skb-&gt;data
(braket
l_int|0
)braket
op_rshift
l_int|5
)paren
op_amp
l_int|0x7
suffix:semicolon
)brace
id|SET_SKB_FREE
c_func
(paren
id|skb
)paren
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
op_logical_neg
id|rsp
)paren
op_logical_and
id|PollFlag
)paren
id|enquiry_response
c_func
(paren
id|st
comma
id|RR
comma
id|PollFlag
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|legalnr
c_func
(paren
id|st
comma
id|seq
)paren
)paren
r_return
suffix:semicolon
id|setva
c_func
(paren
id|st
comma
id|seq
)paren
suffix:semicolon
id|invoke_retransmission
c_func
(paren
id|st
comma
id|seq
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l2_no_tei
id|l2_no_tei
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_4
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l2_st5_tout_200
id|l2_st5_tout_200
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|u_char
id|cmd
suffix:semicolon
r_if
c_cond
(paren
id|st-&gt;l2.rc
op_eq
id|st-&gt;l2.n200
)paren
(brace
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_4
)paren
suffix:semicolon
id|st-&gt;l2
dot
id|l2tei
c_func
(paren
id|st
comma
id|MDL_VERIFY
comma
(paren
r_void
op_star
)paren
id|st-&gt;l2.tei
)paren
suffix:semicolon
id|st-&gt;l2
dot
id|l2man
c_func
(paren
id|st
comma
id|DL_RELEASE
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_else
(brace
id|st-&gt;l2.rc
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|FsmAddTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200_timer
comma
id|st-&gt;l2.t200
comma
id|EV_L2_T200
comma
l_int|NULL
comma
l_int|9
)paren
)paren
r_if
c_cond
(paren
id|st-&gt;l2.l2m.debug
)paren
id|l2m_debug
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
l_string|&quot;FAT 7&quot;
)paren
suffix:semicolon
id|cmd
op_assign
(paren
id|st-&gt;l2.extended
ques
c_cond
id|SABME
suffix:colon
id|SABM
)paren
op_or
l_int|0x10
suffix:semicolon
id|send_uframe
c_func
(paren
id|st
comma
id|cmd
comma
id|CMD
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|l2_st6_tout_200
id|l2_st6_tout_200
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_struct
id|Channel
op_star
id|chanp
op_assign
id|st-&gt;l4.userdata
suffix:semicolon
r_if
c_cond
(paren
id|st-&gt;l2.rc
op_eq
id|st-&gt;l2.n200
)paren
(brace
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_4
)paren
suffix:semicolon
id|st-&gt;l2
dot
id|l2man
c_func
(paren
id|st
comma
id|DL_RELEASE
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_else
(brace
id|st-&gt;l2.rc
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|FsmAddTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200_timer
comma
id|st-&gt;l2.t200
comma
id|EV_L2_T200
comma
l_int|NULL
comma
l_int|10
)paren
)paren
r_if
c_cond
(paren
id|st-&gt;l2.l2m.debug
)paren
id|l2m_debug
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
l_string|&quot;FAT 8&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
(paren
id|chanp-&gt;impair
op_eq
l_int|2
)paren
op_logical_and
(paren
id|st-&gt;l2.laptype
op_eq
id|LAPB
)paren
)paren
)paren
id|send_uframe
c_func
(paren
id|st
comma
id|DISC
op_or
l_int|0x10
comma
id|CMD
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|l2_pull_iqueue
id|l2_pull_iqueue
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_struct
id|Layer2
op_star
id|l2
op_assign
op_amp
id|st-&gt;l2
suffix:semicolon
id|u_char
id|header
(braket
id|MAX_HEADER_LEN
)braket
suffix:semicolon
r_int
id|p1
comma
id|i
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|cansend
c_func
(paren
id|st
)paren
)paren
r_return
suffix:semicolon
id|skb
op_assign
id|skb_dequeue
c_func
(paren
op_amp
id|l2-&gt;i_queue
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
r_return
suffix:semicolon
id|p1
op_assign
id|l2-&gt;vs
op_minus
id|l2-&gt;va
suffix:semicolon
r_if
c_cond
(paren
id|p1
OL
l_int|0
)paren
id|p1
op_add_assign
id|l2-&gt;extended
ques
c_cond
l_int|128
suffix:colon
l_int|8
suffix:semicolon
id|p1
op_assign
(paren
id|p1
op_plus
id|l2-&gt;sow
)paren
op_mod
id|l2-&gt;window
suffix:semicolon
r_if
c_cond
(paren
id|l2-&gt;windowar
(braket
id|p1
)braket
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;isdnl2 try overwrite ack queue entry %d&bslash;n&quot;
comma
id|p1
)paren
suffix:semicolon
id|SET_SKB_FREE
c_func
(paren
id|l2-&gt;windowar
(braket
id|p1
)braket
)paren
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|l2-&gt;windowar
(braket
id|p1
)braket
)paren
suffix:semicolon
)brace
id|l2-&gt;windowar
(braket
id|p1
)braket
op_assign
id|skb_clone
c_func
(paren
id|skb
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
id|i
op_assign
id|sethdraddr
c_func
(paren
op_amp
id|st-&gt;l2
comma
id|header
comma
id|CMD
)paren
suffix:semicolon
r_if
c_cond
(paren
id|l2-&gt;extended
)paren
(brace
id|header
(braket
id|i
op_increment
)braket
op_assign
id|l2-&gt;vs
op_lshift
l_int|1
suffix:semicolon
id|header
(braket
id|i
op_increment
)braket
op_assign
id|l2-&gt;vr
op_lshift
l_int|1
suffix:semicolon
id|l2-&gt;vs
op_assign
(paren
id|l2-&gt;vs
op_plus
l_int|1
)paren
op_mod
l_int|128
suffix:semicolon
)brace
r_else
(brace
id|header
(braket
id|i
op_increment
)braket
op_assign
(paren
id|l2-&gt;vr
op_lshift
l_int|5
)paren
op_or
(paren
id|l2-&gt;vs
op_lshift
l_int|1
)paren
suffix:semicolon
id|l2-&gt;vs
op_assign
(paren
id|l2-&gt;vs
op_plus
l_int|1
)paren
op_mod
l_int|8
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|skb_push
c_func
(paren
id|skb
comma
id|i
)paren
comma
id|header
comma
id|i
)paren
suffix:semicolon
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_DATA_PULLED
comma
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|st-&gt;l2.t200_running
)paren
(brace
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t203_timer
comma
l_int|13
)paren
suffix:semicolon
r_if
c_cond
(paren
id|FsmAddTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200_timer
comma
id|st-&gt;l2.t200
comma
id|EV_L2_T200
comma
l_int|NULL
comma
l_int|11
)paren
)paren
r_if
c_cond
(paren
id|st-&gt;l2.l2m.debug
)paren
id|l2m_debug
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
l_string|&quot;FAT 9&quot;
)paren
suffix:semicolon
id|st-&gt;l2.t200_running
op_assign
op_logical_neg
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|skb_queue_len
c_func
(paren
op_amp
id|l2-&gt;i_queue
)paren
op_logical_and
id|cansend
c_func
(paren
id|st
)paren
)paren
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_REQUEST_PULL
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|transmit_enquiry
id|transmit_enquiry
c_func
(paren
r_struct
id|PStack
op_star
id|st
)paren
(brace
id|enquiry_command
c_func
(paren
id|st
comma
id|RR
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|FsmAddTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200_timer
comma
id|st-&gt;l2.t200
comma
id|EV_L2_T200
comma
l_int|NULL
comma
l_int|12
)paren
)paren
r_if
c_cond
(paren
id|st-&gt;l2.l2m.debug
)paren
id|l2m_debug
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
l_string|&quot;FAT 10&quot;
)paren
suffix:semicolon
id|st-&gt;l2.t200_running
op_assign
op_logical_neg
l_int|0
suffix:semicolon
)brace
r_static
r_void
DECL|function|l2_st7_tout_200
id|l2_st7_tout_200
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|st-&gt;l2.t200_running
op_assign
l_int|0
suffix:semicolon
id|st-&gt;l2.rc
op_assign
l_int|1
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_8
)paren
suffix:semicolon
id|transmit_enquiry
c_func
(paren
id|st
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l2_got_st8_rr_rej
id|l2_got_st8_rr_rej
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_int
id|PollFlag
comma
id|seq
comma
id|rsp
suffix:semicolon
r_struct
id|Layer2
op_star
id|l2
suffix:semicolon
id|l2
op_assign
op_amp
id|st-&gt;l2
suffix:semicolon
r_if
c_cond
(paren
id|l2-&gt;laptype
op_eq
id|LAPD
)paren
id|rsp
op_assign
op_star
id|skb-&gt;data
op_amp
l_int|0x2
suffix:semicolon
r_else
id|rsp
op_assign
op_star
id|skb-&gt;data
op_eq
l_int|0x3
suffix:semicolon
r_if
c_cond
(paren
id|l2-&gt;orig
)paren
id|rsp
op_assign
op_logical_neg
id|rsp
suffix:semicolon
id|skb_pull
c_func
(paren
id|skb
comma
id|l2addrsize
c_func
(paren
id|l2
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|l2-&gt;extended
)paren
(brace
id|PollFlag
op_assign
(paren
id|skb-&gt;data
(braket
l_int|1
)braket
op_amp
l_int|0x1
)paren
op_eq
l_int|0x1
suffix:semicolon
id|seq
op_assign
id|skb-&gt;data
(braket
l_int|1
)braket
op_rshift
l_int|1
suffix:semicolon
)brace
r_else
(brace
id|PollFlag
op_assign
(paren
id|skb-&gt;data
(braket
l_int|0
)braket
op_amp
l_int|0x10
)paren
suffix:semicolon
id|seq
op_assign
(paren
id|skb-&gt;data
(braket
l_int|0
)braket
op_rshift
l_int|5
)paren
op_amp
l_int|0x7
suffix:semicolon
)brace
id|SET_SKB_FREE
c_func
(paren
id|skb
)paren
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rsp
op_logical_and
id|PollFlag
)paren
(brace
r_if
c_cond
(paren
id|legalnr
c_func
(paren
id|st
comma
id|seq
)paren
)paren
(brace
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_7
)paren
suffix:semicolon
id|setva
c_func
(paren
id|st
comma
id|seq
)paren
suffix:semicolon
r_if
c_cond
(paren
id|st-&gt;l2.t200_running
)paren
(brace
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200_timer
comma
l_int|14
)paren
suffix:semicolon
id|st-&gt;l2.t200_running
op_assign
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|FsmAddTimer
c_func
(paren
op_amp
id|st-&gt;l2.t203_timer
comma
id|st-&gt;l2.t203
comma
id|EV_L2_T203
comma
l_int|NULL
comma
l_int|13
)paren
)paren
r_if
c_cond
(paren
id|st-&gt;l2.l2m.debug
)paren
id|l2m_debug
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
l_string|&quot;FAT 11&quot;
)paren
suffix:semicolon
id|invoke_retransmission
c_func
(paren
id|st
comma
id|seq
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb_queue_len
c_func
(paren
op_amp
id|l2-&gt;i_queue
)paren
op_logical_and
id|cansend
c_func
(paren
id|st
)paren
)paren
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_REQUEST_PULL
comma
l_int|NULL
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|fi-&gt;userint
op_amp
id|LC_FLUSH_WAIT
)paren
(brace
id|fi-&gt;userint
op_and_assign
op_complement
id|LC_FLUSH_WAIT
suffix:semicolon
id|st-&gt;l2
dot
id|l2man
c_func
(paren
id|st
comma
id|DL_FLUSH
comma
l_int|NULL
)paren
suffix:semicolon
)brace
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
op_logical_neg
id|rsp
op_logical_and
id|PollFlag
)paren
id|enquiry_response
c_func
(paren
id|st
comma
id|RR
comma
id|PollFlag
)paren
suffix:semicolon
r_if
c_cond
(paren
id|legalnr
c_func
(paren
id|st
comma
id|seq
)paren
)paren
(brace
id|setva
c_func
(paren
id|st
comma
id|seq
)paren
suffix:semicolon
)brace
)brace
)brace
r_static
r_void
DECL|function|l2_st7_tout_203
id|l2_st7_tout_203
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|st-&gt;l2.rc
op_assign
l_int|0
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_8
)paren
suffix:semicolon
id|transmit_enquiry
c_func
(paren
id|st
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l2_st8_tout_200
id|l2_st8_tout_200
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_if
c_cond
(paren
id|st-&gt;l2.rc
op_eq
id|st-&gt;l2.n200
)paren
(brace
id|establishlink
c_func
(paren
id|fi
)paren
suffix:semicolon
)brace
r_else
(brace
id|st-&gt;l2.rc
op_increment
suffix:semicolon
id|transmit_enquiry
c_func
(paren
id|st
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|l2_got_FRMR
id|l2_got_FRMR
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_char
id|tmp
(braket
l_int|64
)braket
suffix:semicolon
id|skb_pull
c_func
(paren
id|skb
comma
id|l2addrsize
c_func
(paren
op_amp
id|st-&gt;l2
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|st-&gt;l2.l2m.debug
)paren
(brace
r_if
c_cond
(paren
id|st-&gt;l2.extended
)paren
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;FRMR information %2x %2x %2x %2x %2x&quot;
comma
id|skb-&gt;data
(braket
l_int|0
)braket
comma
id|skb-&gt;data
(braket
l_int|1
)braket
comma
id|skb-&gt;data
(braket
l_int|2
)braket
comma
id|skb-&gt;data
(braket
l_int|3
)braket
comma
id|skb-&gt;data
(braket
l_int|4
)braket
)paren
suffix:semicolon
r_else
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;FRMR information %2x %2x %2x&quot;
comma
id|skb-&gt;data
(braket
l_int|0
)braket
comma
id|skb-&gt;data
(braket
l_int|1
)braket
comma
id|skb-&gt;data
(braket
l_int|2
)braket
)paren
suffix:semicolon
id|l2m_debug
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|tmp
)paren
suffix:semicolon
)brace
id|SET_SKB_FREE
c_func
(paren
id|skb
)paren
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l2_tei_remove
id|l2_tei_remove
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
multiline_comment|/*TODO&n;   if( DL_RELEASE.req outstanding ) {&n;   ... issue DL_RELEASE.confirm&n;   } else {&n;   if( fi-&gt;state != ST_L2_4 ) {&n;   ... issue DL_RELEASE.indication&n;   }&n;   }&n;   TODO */
id|discard_i_queue
c_func
(paren
id|st
)paren
suffix:semicolon
multiline_comment|/* There is no UI queue in layer 2 */
id|st-&gt;l2.tei
op_assign
l_int|255
suffix:semicolon
r_if
c_cond
(paren
id|st-&gt;l2.t200_running
)paren
(brace
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200_timer
comma
l_int|18
)paren
suffix:semicolon
id|st-&gt;l2.t200_running
op_assign
l_int|0
suffix:semicolon
)brace
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t203_timer
comma
l_int|19
)paren
suffix:semicolon
id|st-&gt;l2
dot
id|l2man
c_func
(paren
id|st
comma
id|DL_RELEASE
comma
l_int|NULL
)paren
suffix:semicolon
multiline_comment|/* TEMP */
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_1
)paren
suffix:semicolon
)brace
r_inline
r_int
DECL|function|IsUI
id|IsUI
c_func
(paren
id|u_char
op_star
id|data
comma
r_int
id|ext
)paren
(brace
r_return
(paren
(paren
id|data
(braket
l_int|0
)braket
op_amp
l_int|0xef
)paren
op_eq
id|UI
)paren
suffix:semicolon
)brace
r_inline
r_int
DECL|function|IsUA
id|IsUA
c_func
(paren
id|u_char
op_star
id|data
comma
r_int
id|ext
)paren
(brace
r_return
(paren
(paren
id|data
(braket
l_int|0
)braket
op_amp
l_int|0xef
)paren
op_eq
id|UA
)paren
suffix:semicolon
)brace
r_inline
r_int
DECL|function|IsDISC
id|IsDISC
c_func
(paren
id|u_char
op_star
id|data
comma
r_int
id|ext
)paren
(brace
r_return
(paren
(paren
id|data
(braket
l_int|0
)braket
op_amp
l_int|0xef
)paren
op_eq
id|DISC
)paren
suffix:semicolon
)brace
r_inline
r_int
DECL|function|IsRR
id|IsRR
c_func
(paren
id|u_char
op_star
id|data
comma
r_int
id|ext
)paren
(brace
r_if
c_cond
(paren
id|ext
)paren
r_return
(paren
id|data
(braket
l_int|0
)braket
op_eq
id|RR
)paren
suffix:semicolon
r_else
r_return
(paren
(paren
id|data
(braket
l_int|0
)braket
op_amp
l_int|0xf
)paren
op_eq
l_int|1
)paren
suffix:semicolon
)brace
r_inline
r_int
DECL|function|IsI
id|IsI
c_func
(paren
id|u_char
op_star
id|data
comma
r_int
id|ext
)paren
(brace
r_return
(paren
(paren
id|data
(braket
l_int|0
)braket
op_amp
l_int|0x1
)paren
op_eq
l_int|0x0
)paren
suffix:semicolon
)brace
r_inline
r_int
DECL|function|IsSABMX
id|IsSABMX
c_func
(paren
id|u_char
op_star
id|data
comma
r_int
id|ext
)paren
(brace
id|u_char
id|d
op_assign
id|data
(braket
l_int|0
)braket
op_amp
op_complement
l_int|0x10
suffix:semicolon
r_return
(paren
id|ext
ques
c_cond
id|d
op_eq
id|SABME
suffix:colon
id|d
op_eq
id|SABM
)paren
suffix:semicolon
)brace
r_inline
r_int
DECL|function|IsREJ
id|IsREJ
c_func
(paren
id|u_char
op_star
id|data
comma
r_int
id|ext
)paren
(brace
r_return
(paren
id|ext
ques
c_cond
id|data
(braket
l_int|0
)braket
op_eq
id|REJ
suffix:colon
(paren
id|data
(braket
l_int|0
)braket
op_amp
l_int|0xf
)paren
op_eq
l_int|0x9
)paren
suffix:semicolon
)brace
r_inline
r_int
DECL|function|IsFRMR
id|IsFRMR
c_func
(paren
id|u_char
op_star
id|data
comma
r_int
id|ext
)paren
(brace
r_return
(paren
(paren
id|data
(braket
l_int|0
)braket
op_amp
l_int|0xef
)paren
op_eq
id|FRMR
)paren
suffix:semicolon
)brace
r_inline
r_int
DECL|function|IsRNR
id|IsRNR
c_func
(paren
id|u_char
op_star
id|data
comma
r_int
id|ext
)paren
(brace
r_if
c_cond
(paren
id|ext
)paren
r_return
(paren
id|data
(braket
l_int|0
)braket
op_eq
id|RNR
)paren
suffix:semicolon
r_else
r_return
(paren
(paren
id|data
(braket
l_int|0
)braket
op_amp
l_int|0xf
)paren
op_eq
l_int|5
)paren
suffix:semicolon
)brace
DECL|variable|L2FnList
r_static
r_struct
id|FsmNode
id|L2FnList
(braket
)braket
op_assign
(brace
(brace
id|ST_L2_1
comma
id|EV_L2_DL_ESTABLISH
comma
id|l2s1
)brace
comma
(brace
id|ST_L2_1
comma
id|EV_L2_MDL_NOTEIPROC
comma
id|l2_no_tei
)brace
comma
(brace
id|ST_L2_3
comma
id|EV_L2_MDL_ASSIGN
comma
id|l2_got_tei
)brace
comma
(brace
id|ST_L2_4
comma
id|EV_L2_DL_UNIT_DATA
comma
id|l2_send_ui
)brace
comma
(brace
id|ST_L2_4
comma
id|EV_L2_DL_ESTABLISH
comma
id|l2_establish
)brace
comma
(brace
id|ST_L2_7
comma
id|EV_L2_DL_UNIT_DATA
comma
id|l2_send_ui
)brace
comma
(brace
id|ST_L2_7
comma
id|EV_L2_DL_DATA
comma
id|l2_feed_iqueue
)brace
comma
(brace
id|ST_L2_7
comma
id|EV_L2_DL_RELEASE
comma
id|l2_send_disconn
)brace
comma
(brace
id|ST_L2_7
comma
id|EV_L2_ACK_PULL
comma
id|l2_pull_iqueue
)brace
comma
(brace
id|ST_L2_8
comma
id|EV_L2_DL_DATA
comma
id|l2_feed_iqueue
)brace
comma
(brace
id|ST_L2_8
comma
id|EV_L2_DL_RELEASE
comma
id|l2_send_disconn
)brace
comma
(brace
id|ST_L2_1
comma
id|EV_L2_UI
comma
id|l2_receive_ui
)brace
comma
(brace
id|ST_L2_4
comma
id|EV_L2_UI
comma
id|l2_receive_ui
)brace
comma
(brace
id|ST_L2_4
comma
id|EV_L2_SABMX
comma
id|l2_got_SABMX
)brace
comma
(brace
id|ST_L2_4
comma
id|EV_L2_DISC
comma
id|l2_got_st4_disc
)brace
comma
(brace
id|ST_L2_5
comma
id|EV_L2_UA
comma
id|l2_got_ua_establish
)brace
comma
(brace
id|ST_L2_6
comma
id|EV_L2_UA
comma
id|l2_got_ua_disconn
)brace
comma
(brace
id|ST_L2_7
comma
id|EV_L2_UI
comma
id|l2_receive_ui
)brace
comma
(brace
id|ST_L2_7
comma
id|EV_L2_DISC
comma
id|l2_got_disconn
)brace
comma
(brace
id|ST_L2_7
comma
id|EV_L2_I
comma
id|l2_got_st7_data
)brace
comma
(brace
id|ST_L2_7
comma
id|EV_L2_RR
comma
id|l2_got_st7_RR
)brace
comma
(brace
id|ST_L2_7
comma
id|EV_L2_REJ
comma
id|l2_got_st7_rej
)brace
comma
(brace
id|ST_L2_7
comma
id|EV_L2_SABMX
comma
id|l2_got_SABMX
)brace
comma
(brace
id|ST_L2_7
comma
id|EV_L2_FRMR
comma
id|l2_got_FRMR
)brace
comma
(brace
id|ST_L2_8
comma
id|EV_L2_RR
comma
id|l2_got_st8_rr_rej
)brace
comma
(brace
id|ST_L2_8
comma
id|EV_L2_REJ
comma
id|l2_got_st8_rr_rej
)brace
comma
(brace
id|ST_L2_8
comma
id|EV_L2_SABMX
comma
id|l2_got_SABMX
)brace
comma
(brace
id|ST_L2_8
comma
id|EV_L2_DISC
comma
id|l2_got_disconn
)brace
comma
(brace
id|ST_L2_8
comma
id|EV_L2_FRMR
comma
id|l2_got_FRMR
)brace
comma
(brace
id|ST_L2_8
comma
id|EV_L2_I
comma
id|l2_got_st8_data
)brace
comma
(brace
id|ST_L2_5
comma
id|EV_L2_T200
comma
id|l2_st5_tout_200
)brace
comma
(brace
id|ST_L2_6
comma
id|EV_L2_T200
comma
id|l2_st6_tout_200
)brace
comma
(brace
id|ST_L2_7
comma
id|EV_L2_T200
comma
id|l2_st7_tout_200
)brace
comma
(brace
id|ST_L2_7
comma
id|EV_L2_T203
comma
id|l2_st7_tout_203
)brace
comma
(brace
id|ST_L2_8
comma
id|EV_L2_T200
comma
id|l2_st8_tout_200
)brace
comma
(brace
id|ST_L2_1
comma
id|EV_L2_MDL_REMOVE
comma
id|l2_tei_remove
)brace
comma
(brace
id|ST_L2_3
comma
id|EV_L2_MDL_REMOVE
comma
id|l2_tei_remove
)brace
comma
(brace
id|ST_L2_4
comma
id|EV_L2_MDL_REMOVE
comma
id|l2_tei_remove
)brace
comma
(brace
id|ST_L2_5
comma
id|EV_L2_MDL_REMOVE
comma
id|l2_tei_remove
)brace
comma
(brace
id|ST_L2_6
comma
id|EV_L2_MDL_REMOVE
comma
id|l2_tei_remove
)brace
comma
(brace
id|ST_L2_7
comma
id|EV_L2_MDL_REMOVE
comma
id|l2_tei_remove
)brace
comma
(brace
id|ST_L2_8
comma
id|EV_L2_MDL_REMOVE
comma
id|l2_tei_remove
)brace
comma
)brace
suffix:semicolon
DECL|macro|L2_FN_COUNT
mdefine_line|#define L2_FN_COUNT (sizeof(L2FnList)/sizeof(struct FsmNode))
r_static
r_void
DECL|function|isdnl2_l1l2
id|isdnl2_l1l2
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|u_char
op_star
id|datap
suffix:semicolon
r_int
id|ret
op_assign
op_logical_neg
l_int|0
suffix:semicolon
r_switch
c_cond
(paren
id|pr
)paren
(brace
r_case
(paren
id|PH_DATA
)paren
suffix:colon
id|datap
op_assign
id|skb-&gt;data
suffix:semicolon
id|datap
op_add_assign
id|l2addrsize
c_func
(paren
op_amp
id|st-&gt;l2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|IsI
c_func
(paren
id|datap
comma
id|st-&gt;l2.extended
)paren
)paren
id|ret
op_assign
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_I
comma
id|skb
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|IsRR
c_func
(paren
id|datap
comma
id|st-&gt;l2.extended
)paren
)paren
id|ret
op_assign
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_RR
comma
id|skb
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|IsUI
c_func
(paren
id|datap
comma
id|st-&gt;l2.extended
)paren
)paren
id|ret
op_assign
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_UI
comma
id|skb
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|IsSABMX
c_func
(paren
id|datap
comma
id|st-&gt;l2.extended
)paren
)paren
id|ret
op_assign
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_SABMX
comma
id|skb
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|IsUA
c_func
(paren
id|datap
comma
id|st-&gt;l2.extended
)paren
)paren
id|ret
op_assign
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_UA
comma
id|skb
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|IsDISC
c_func
(paren
id|datap
comma
id|st-&gt;l2.extended
)paren
)paren
id|ret
op_assign
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_DISC
comma
id|skb
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|IsREJ
c_func
(paren
id|datap
comma
id|st-&gt;l2.extended
)paren
)paren
id|ret
op_assign
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_REJ
comma
id|skb
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|IsFRMR
c_func
(paren
id|datap
comma
id|st-&gt;l2.extended
)paren
)paren
id|ret
op_assign
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_FRMR
comma
id|skb
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|IsRNR
c_func
(paren
id|datap
comma
id|st-&gt;l2.extended
)paren
)paren
id|ret
op_assign
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_RNR
comma
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
(brace
id|SET_SKB_FREE
c_func
(paren
id|skb
)paren
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
(paren
id|PH_PULL_ACK
)paren
suffix:colon
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_ACK_PULL
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|isdnl2_l3l2
id|isdnl2_l3l2
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_switch
c_cond
(paren
id|pr
)paren
(brace
r_case
(paren
id|DL_DATA
)paren
suffix:colon
r_if
c_cond
(paren
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_DL_DATA
comma
id|arg
)paren
)paren
(brace
id|SET_SKB_FREE
c_func
(paren
(paren
(paren
r_struct
id|sk_buff
op_star
)paren
id|arg
)paren
)paren
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
(paren
r_struct
id|sk_buff
op_star
)paren
id|arg
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
(paren
id|DL_UNIT_DATA
)paren
suffix:colon
r_if
c_cond
(paren
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_DL_UNIT_DATA
comma
id|arg
)paren
)paren
(brace
id|SET_SKB_FREE
c_func
(paren
(paren
(paren
r_struct
id|sk_buff
op_star
)paren
id|arg
)paren
)paren
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
(paren
r_struct
id|sk_buff
op_star
)paren
id|arg
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|isdnl2_manl2
id|isdnl2_manl2
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_switch
c_cond
(paren
id|pr
)paren
(brace
r_case
(paren
id|DL_ESTABLISH
)paren
suffix:colon
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_DL_ESTABLISH
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|DL_RELEASE
)paren
suffix:colon
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_DL_RELEASE
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|MDL_NOTEIPROC
)paren
suffix:colon
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_MDL_NOTEIPROC
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|DL_FLUSH
)paren
suffix:colon
(paren
op_amp
id|st-&gt;l2.l2m
)paren
op_member_access_from_pointer
id|userint
op_or_assign
id|LC_FLUSH_WAIT
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|isdnl2_teil2
id|isdnl2_teil2
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_switch
c_cond
(paren
id|pr
)paren
(brace
r_case
(paren
id|MDL_ASSIGN
)paren
suffix:colon
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_MDL_ASSIGN
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|MDL_REMOVE
)paren
suffix:colon
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_MDL_REMOVE
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_void
DECL|function|releasestack_isdnl2
id|releasestack_isdnl2
c_func
(paren
r_struct
id|PStack
op_star
id|st
)paren
(brace
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200_timer
comma
l_int|15
)paren
suffix:semicolon
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t203_timer
comma
l_int|16
)paren
suffix:semicolon
id|discard_i_queue
c_func
(paren
id|st
)paren
suffix:semicolon
id|ReleaseWin
c_func
(paren
op_amp
id|st-&gt;l2
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l2m_debug
id|l2m_debug
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_char
op_star
id|s
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_char
id|tm
(braket
l_int|32
)braket
comma
id|str
(braket
l_int|256
)braket
suffix:semicolon
id|jiftime
c_func
(paren
id|tm
comma
id|jiffies
)paren
suffix:semicolon
id|sprintf
c_func
(paren
id|str
comma
l_string|&quot;%s %s %s&bslash;n&quot;
comma
id|tm
comma
id|st-&gt;l2.debug_id
comma
id|s
)paren
suffix:semicolon
id|HiSax_putstatus
c_func
(paren
id|st-&gt;l1.hardware
comma
id|str
)paren
suffix:semicolon
)brace
r_void
DECL|function|setstack_isdnl2
id|setstack_isdnl2
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_char
op_star
id|debug_id
)paren
(brace
id|st-&gt;l1.l1l2
op_assign
id|isdnl2_l1l2
suffix:semicolon
id|st-&gt;l3.l3l2
op_assign
id|isdnl2_l3l2
suffix:semicolon
id|st-&gt;ma.manl2
op_assign
id|isdnl2_manl2
suffix:semicolon
id|st-&gt;ma.teil2
op_assign
id|isdnl2_teil2
suffix:semicolon
id|st-&gt;l2.uihsize
op_assign
id|l2headersize
c_func
(paren
op_amp
id|st-&gt;l2
comma
op_logical_neg
l_int|0
)paren
suffix:semicolon
id|st-&gt;l2.ihsize
op_assign
id|l2headersize
c_func
(paren
op_amp
id|st-&gt;l2
comma
l_int|0
)paren
suffix:semicolon
id|skb_queue_head_init
c_func
(paren
op_amp
id|st-&gt;l2.i_queue
)paren
suffix:semicolon
id|InitWin
c_func
(paren
op_amp
id|st-&gt;l2
)paren
suffix:semicolon
id|st-&gt;l2.rejexp
op_assign
l_int|0
suffix:semicolon
id|st-&gt;l2.debug
op_assign
l_int|0
suffix:semicolon
id|st-&gt;l2.l2m.fsm
op_assign
op_amp
id|l2fsm
suffix:semicolon
id|st-&gt;l2.l2m.state
op_assign
id|ST_L2_1
suffix:semicolon
id|st-&gt;l2.l2m.debug
op_assign
l_int|0
suffix:semicolon
id|st-&gt;l2.l2m.userdata
op_assign
id|st
suffix:semicolon
id|st-&gt;l2.l2m.userint
op_assign
l_int|0
suffix:semicolon
id|st-&gt;l2.l2m.printdebug
op_assign
id|l2m_debug
suffix:semicolon
id|strcpy
c_func
(paren
id|st-&gt;l2.debug_id
comma
id|debug_id
)paren
suffix:semicolon
id|FsmInitTimer
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
op_amp
id|st-&gt;l2.t200_timer
)paren
suffix:semicolon
id|FsmInitTimer
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
op_amp
id|st-&gt;l2.t203_timer
)paren
suffix:semicolon
id|st-&gt;l2.t200_running
op_assign
l_int|0
suffix:semicolon
)brace
r_void
DECL|function|setstack_transl2
id|setstack_transl2
c_func
(paren
r_struct
id|PStack
op_star
id|st
)paren
(brace
)brace
r_void
DECL|function|releasestack_transl2
id|releasestack_transl2
c_func
(paren
r_struct
id|PStack
op_star
id|st
)paren
(brace
)brace
r_void
DECL|function|Isdnl2New
id|Isdnl2New
c_func
(paren
r_void
)paren
(brace
id|l2fsm.state_count
op_assign
id|L2_STATE_COUNT
suffix:semicolon
id|l2fsm.event_count
op_assign
id|L2_EVENT_COUNT
suffix:semicolon
id|l2fsm.strEvent
op_assign
id|strL2Event
suffix:semicolon
id|l2fsm.strState
op_assign
id|strL2State
suffix:semicolon
id|FsmNew
c_func
(paren
op_amp
id|l2fsm
comma
id|L2FnList
comma
id|L2_FN_COUNT
)paren
suffix:semicolon
)brace
r_void
DECL|function|Isdnl2Free
id|Isdnl2Free
c_func
(paren
r_void
)paren
(brace
id|FsmFree
c_func
(paren
op_amp
id|l2fsm
)paren
suffix:semicolon
)brace
eof
