multiline_comment|/* $Id: isdnl2.c,v 2.16 1998/11/15 23:55:01 keil Exp $&n;&n; * Author       Karsten Keil (keil@isdn4linux.de)&n; *              based on the teles driver from Jan den Ouden&n; *&n; *&t;&t;This file is (c) under GNU PUBLIC LICENSE&n; *&t;&t;For changes and modifications please read&n; *&t;&t;../../../Documentation/isdn/HiSax.cert&n; *&n; * Thanks to    Jan den Ouden&n; *              Fritz Elfert&n; *&n; * $Log: isdnl2.c,v $&n; * Revision 2.16  1998/11/15 23:55:01  keil&n; * changes from 2.0&n; *&n; * Revision 2.15  1998/08/13 23:36:42  keil&n; * HiSax 3.1 - don&squot;t work stable with current LinkLevel&n; *&n; * Revision 2.14  1998/06/19 15:19:18  keil&n; * fix LAPB tx_cnt for none I-frames&n; *&n; * Revision 2.13  1998/06/18 23:17:20  keil&n; * LAPB bugfix&n; *&n; * Revision 2.12  1998/05/25 14:10:12  keil&n; * HiSax 3.0&n; * X.75 and leased are working again.&n; *&n; * Revision 2.11  1998/05/25 12:58:08  keil&n; * HiSax golden code from certification, Don&squot;t use !!!&n; * No leased lines, no X75, but many changes.&n; *&n; * Revision 2.9  1998/04/10 10:35:30  paul&n; * fixed (silly?) warnings from egcs on Alpha.&n; *&n; * Revision 2.8  1998/03/07 22:57:04  tsbogend&n; * made HiSax working on Linux/Alpha&n; *&n; * Revision 2.7  1998/02/12 23:07:47  keil&n; * change for 2.1.86 (removing FREE_READ/FREE_WRITE from [dev]_kfree_skb()&n; *&n; * Revision 2.6  1998/02/02 13:36:15  keil&n; * bugfix X.75 win calculation&n; *&n; * Revision 2.5  1997/11/06 17:09:22  keil&n; * New 2.1 init code&n; *&n; * Revision 2.4  1997/10/29 19:02:01  keil&n; * new LL interface&n; *&n; * Revision 2.3  1997/10/01 09:21:39  fritz&n; * Removed old compatibility stuff for 2.0.X kernels.&n; * From now on, this code is for 2.1.X ONLY!&n; * Old stuff is still in the separate branch.&n; *&n; * Revision 2.2  1997/07/31 11:49:05  keil&n; * Error handling for no TEI assign&n; *&n; * Revision 2.1  1997/07/27 21:34:38  keil&n; * cosmetics&n; *&n; * Revision 2.0  1997/06/26 11:07:29  keil&n; * New q.921 and X.75 Layer2&n; *&n; *&n; *  Old log removed KKe&n; *&n; */
DECL|macro|__NO_VERSION__
mdefine_line|#define __NO_VERSION__
macro_line|#include &quot;hisax.h&quot;
macro_line|#include &quot;isdnl2.h&quot;
DECL|variable|l2_revision
r_const
r_char
op_star
id|l2_revision
op_assign
l_string|&quot;$Revision: 2.16 $&quot;
suffix:semicolon
r_static
r_void
id|l2m_debug
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_char
op_star
id|fmt
comma
dot
dot
dot
)paren
suffix:semicolon
r_static
DECL|variable|l2fsm
r_struct
id|Fsm
id|l2fsm
op_assign
(brace
l_int|NULL
comma
l_int|0
comma
l_int|0
comma
l_int|NULL
comma
l_int|NULL
)brace
suffix:semicolon
r_enum
(brace
DECL|enumerator|ST_L2_1
id|ST_L2_1
comma
DECL|enumerator|ST_L2_2
id|ST_L2_2
comma
DECL|enumerator|ST_L2_3
id|ST_L2_3
comma
DECL|enumerator|ST_L2_4
id|ST_L2_4
comma
DECL|enumerator|ST_L2_5
id|ST_L2_5
comma
DECL|enumerator|ST_L2_6
id|ST_L2_6
comma
DECL|enumerator|ST_L2_7
id|ST_L2_7
comma
DECL|enumerator|ST_L2_8
id|ST_L2_8
comma
)brace
suffix:semicolon
DECL|macro|L2_STATE_COUNT
mdefine_line|#define L2_STATE_COUNT (ST_L2_8+1)
DECL|variable|strL2State
r_static
r_char
op_star
id|strL2State
(braket
)braket
op_assign
(brace
l_string|&quot;ST_L2_1&quot;
comma
l_string|&quot;ST_L2_2&quot;
comma
l_string|&quot;ST_L2_3&quot;
comma
l_string|&quot;ST_L2_4&quot;
comma
l_string|&quot;ST_L2_5&quot;
comma
l_string|&quot;ST_L2_6&quot;
comma
l_string|&quot;ST_L2_7&quot;
comma
l_string|&quot;ST_L2_8&quot;
comma
)brace
suffix:semicolon
r_enum
(brace
DECL|enumerator|EV_L2_UI
id|EV_L2_UI
comma
DECL|enumerator|EV_L2_SABMX
id|EV_L2_SABMX
comma
DECL|enumerator|EV_L2_DISC
id|EV_L2_DISC
comma
DECL|enumerator|EV_L2_DM
id|EV_L2_DM
comma
DECL|enumerator|EV_L2_UA
id|EV_L2_UA
comma
DECL|enumerator|EV_L2_FRMR
id|EV_L2_FRMR
comma
DECL|enumerator|EV_L2_SUPER
id|EV_L2_SUPER
comma
DECL|enumerator|EV_L2_I
id|EV_L2_I
comma
DECL|enumerator|EV_L2_DL_DATA
id|EV_L2_DL_DATA
comma
DECL|enumerator|EV_L2_ACK_PULL
id|EV_L2_ACK_PULL
comma
DECL|enumerator|EV_L2_DL_UNIT_DATA
id|EV_L2_DL_UNIT_DATA
comma
DECL|enumerator|EV_L2_DL_ESTABLISH
id|EV_L2_DL_ESTABLISH
comma
DECL|enumerator|EV_L2_DL_RELEASE
id|EV_L2_DL_RELEASE
comma
DECL|enumerator|EV_L2_MDL_ASSIGN
id|EV_L2_MDL_ASSIGN
comma
DECL|enumerator|EV_L2_MDL_REMOVE
id|EV_L2_MDL_REMOVE
comma
DECL|enumerator|EV_L2_MDL_ERROR
id|EV_L2_MDL_ERROR
comma
DECL|enumerator|EV_L1_DEACTIVATE
id|EV_L1_DEACTIVATE
comma
DECL|enumerator|EV_L2_T200
id|EV_L2_T200
comma
DECL|enumerator|EV_L2_T203
id|EV_L2_T203
comma
)brace
suffix:semicolon
DECL|macro|L2_EVENT_COUNT
mdefine_line|#define L2_EVENT_COUNT (EV_L2_T203+1)
DECL|variable|strL2Event
r_static
r_char
op_star
id|strL2Event
(braket
)braket
op_assign
(brace
l_string|&quot;EV_L2_UI&quot;
comma
l_string|&quot;EV_L2_SABMX&quot;
comma
l_string|&quot;EV_L2_DISC&quot;
comma
l_string|&quot;EV_L2_DM&quot;
comma
l_string|&quot;EV_L2_UA&quot;
comma
l_string|&quot;EV_L2_FRMR&quot;
comma
l_string|&quot;EV_L2_SUPER&quot;
comma
l_string|&quot;EV_L2_I&quot;
comma
l_string|&quot;EV_L2_DL_DATA&quot;
comma
l_string|&quot;EV_L2_ACK_PULL&quot;
comma
l_string|&quot;EV_L2_DL_UNIT_DATA&quot;
comma
l_string|&quot;EV_L2_DL_ESTABLISH&quot;
comma
l_string|&quot;EV_L2_DL_RELEASE&quot;
comma
l_string|&quot;EV_L2_MDL_ASSIGN&quot;
comma
l_string|&quot;EV_L2_MDL_REMOVE&quot;
comma
l_string|&quot;EV_L2_MDL_ERROR&quot;
comma
l_string|&quot;EV_L1_DEACTIVATE&quot;
comma
l_string|&quot;EV_L2_T200&quot;
comma
l_string|&quot;EV_L2_T203&quot;
comma
)brace
suffix:semicolon
r_static
r_int
id|l2addrsize
c_func
(paren
r_struct
id|Layer2
op_star
id|l2
)paren
suffix:semicolon
r_static
r_void
DECL|function|InitWin
id|InitWin
c_func
(paren
r_struct
id|Layer2
op_star
id|l2
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|MAX_WINDOW
suffix:semicolon
id|i
op_increment
)paren
id|l2-&gt;windowar
(braket
id|i
)braket
op_assign
l_int|NULL
suffix:semicolon
)brace
r_static
r_void
DECL|function|ReleaseWin
id|ReleaseWin
c_func
(paren
r_struct
id|Layer2
op_star
id|l2
)paren
(brace
r_int
id|i
comma
id|cnt
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|MAX_WINDOW
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|l2-&gt;windowar
(braket
id|i
)braket
)paren
(brace
id|cnt
op_increment
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|l2-&gt;windowar
(braket
id|i
)braket
)paren
suffix:semicolon
id|l2-&gt;windowar
(braket
id|i
)braket
op_assign
l_int|NULL
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|cnt
)paren
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;isdl2 freed %d skbuffs in release&bslash;n&quot;
comma
id|cnt
)paren
suffix:semicolon
)brace
r_inline
r_int
DECL|function|cansend
id|cansend
c_func
(paren
r_struct
id|PStack
op_star
id|st
)paren
(brace
r_int
id|p1
suffix:semicolon
id|p1
op_assign
id|st-&gt;l2.vs
op_minus
id|st-&gt;l2.va
suffix:semicolon
r_if
c_cond
(paren
id|p1
OL
l_int|0
)paren
id|p1
op_add_assign
(paren
id|test_bit
c_func
(paren
id|FLG_MOD128
comma
op_amp
id|st-&gt;l2.flag
)paren
ques
c_cond
l_int|128
suffix:colon
l_int|8
)paren
suffix:semicolon
r_return
(paren
(paren
id|p1
OL
id|st-&gt;l2.window
)paren
op_logical_and
op_logical_neg
id|test_bit
c_func
(paren
id|FLG_PEER_BUSY
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
suffix:semicolon
)brace
r_inline
r_void
DECL|function|clear_exception
id|clear_exception
c_func
(paren
r_struct
id|Layer2
op_star
id|l2
)paren
(brace
id|test_and_clear_bit
c_func
(paren
id|FLG_ACK_PEND
comma
op_amp
id|l2-&gt;flag
)paren
suffix:semicolon
id|test_and_clear_bit
c_func
(paren
id|FLG_REJEXC
comma
op_amp
id|l2-&gt;flag
)paren
suffix:semicolon
id|test_and_clear_bit
c_func
(paren
id|FLG_OWN_BUSY
comma
op_amp
id|l2-&gt;flag
)paren
suffix:semicolon
id|test_and_clear_bit
c_func
(paren
id|FLG_PEER_BUSY
comma
op_amp
id|l2-&gt;flag
)paren
suffix:semicolon
)brace
r_inline
r_int
DECL|function|l2headersize
id|l2headersize
c_func
(paren
r_struct
id|Layer2
op_star
id|l2
comma
r_int
id|ui
)paren
(brace
r_return
(paren
(paren
(paren
id|test_bit
c_func
(paren
id|FLG_MOD128
comma
op_amp
id|l2-&gt;flag
)paren
op_logical_and
(paren
op_logical_neg
id|ui
)paren
)paren
ques
c_cond
l_int|2
suffix:colon
l_int|1
)paren
op_plus
(paren
id|test_bit
c_func
(paren
id|FLG_LAPD
comma
op_amp
id|l2-&gt;flag
)paren
ques
c_cond
l_int|2
suffix:colon
l_int|1
)paren
)paren
suffix:semicolon
)brace
r_inline
r_int
DECL|function|l2addrsize
id|l2addrsize
c_func
(paren
r_struct
id|Layer2
op_star
id|l2
)paren
(brace
r_return
(paren
id|test_bit
c_func
(paren
id|FLG_LAPD
comma
op_amp
id|l2-&gt;flag
)paren
ques
c_cond
l_int|2
suffix:colon
l_int|1
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|sethdraddr
id|sethdraddr
c_func
(paren
r_struct
id|Layer2
op_star
id|l2
comma
id|u_char
op_star
id|header
comma
r_int
id|rsp
)paren
(brace
id|u_char
op_star
id|ptr
op_assign
id|header
suffix:semicolon
r_int
id|crbit
op_assign
id|rsp
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_LAPD
comma
op_amp
id|l2-&gt;flag
)paren
)paren
(brace
op_star
id|ptr
op_increment
op_assign
(paren
id|l2-&gt;sap
op_lshift
l_int|2
)paren
op_or
(paren
id|rsp
ques
c_cond
l_int|2
suffix:colon
l_int|0
)paren
suffix:semicolon
op_star
id|ptr
op_increment
op_assign
(paren
id|l2-&gt;tei
op_lshift
l_int|1
)paren
op_or
l_int|1
suffix:semicolon
r_return
(paren
l_int|2
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_ORIG
comma
op_amp
id|l2-&gt;flag
)paren
)paren
id|crbit
op_assign
op_logical_neg
id|crbit
suffix:semicolon
r_if
c_cond
(paren
id|crbit
)paren
op_star
id|ptr
op_increment
op_assign
l_int|1
suffix:semicolon
r_else
op_star
id|ptr
op_increment
op_assign
l_int|3
suffix:semicolon
r_return
(paren
l_int|1
)paren
suffix:semicolon
)brace
)brace
r_inline
r_static
r_void
DECL|function|enqueue_super
id|enqueue_super
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_LAPB
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
id|st-&gt;l1.bcs-&gt;tx_cnt
op_add_assign
id|skb-&gt;len
suffix:semicolon
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_DATA
op_or
id|REQUEST
comma
id|skb
)paren
suffix:semicolon
)brace
DECL|macro|enqueue_ui
mdefine_line|#define enqueue_ui(a, b) enqueue_super(a, b)
r_inline
r_int
DECL|function|IsUI
id|IsUI
c_func
(paren
id|u_char
op_star
id|data
comma
r_int
id|ext
)paren
(brace
r_return
(paren
(paren
id|data
(braket
l_int|0
)braket
op_amp
l_int|0xef
)paren
op_eq
id|UI
)paren
suffix:semicolon
)brace
r_inline
r_int
DECL|function|IsUA
id|IsUA
c_func
(paren
id|u_char
op_star
id|data
comma
r_int
id|ext
)paren
(brace
r_return
(paren
(paren
id|data
(braket
l_int|0
)braket
op_amp
l_int|0xef
)paren
op_eq
id|UA
)paren
suffix:semicolon
)brace
r_inline
r_int
DECL|function|IsDM
id|IsDM
c_func
(paren
id|u_char
op_star
id|data
comma
r_int
id|ext
)paren
(brace
r_return
(paren
(paren
id|data
(braket
l_int|0
)braket
op_amp
l_int|0xef
)paren
op_eq
id|DM
)paren
suffix:semicolon
)brace
r_inline
r_int
DECL|function|IsDISC
id|IsDISC
c_func
(paren
id|u_char
op_star
id|data
comma
r_int
id|ext
)paren
(brace
r_return
(paren
(paren
id|data
(braket
l_int|0
)braket
op_amp
l_int|0xef
)paren
op_eq
id|DISC
)paren
suffix:semicolon
)brace
r_inline
r_int
DECL|function|IsRR
id|IsRR
c_func
(paren
id|u_char
op_star
id|data
comma
r_int
id|ext
)paren
(brace
r_if
c_cond
(paren
id|ext
)paren
r_return
(paren
id|data
(braket
l_int|0
)braket
op_eq
id|RR
)paren
suffix:semicolon
r_else
r_return
(paren
(paren
id|data
(braket
l_int|0
)braket
op_amp
l_int|0xf
)paren
op_eq
l_int|1
)paren
suffix:semicolon
)brace
r_inline
r_int
DECL|function|IsSFrame
id|IsSFrame
c_func
(paren
id|u_char
op_star
id|data
comma
r_int
id|ext
)paren
(brace
r_register
id|u_char
id|d
op_assign
op_star
id|data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ext
)paren
id|d
op_and_assign
l_int|0xf
suffix:semicolon
r_return
(paren
(paren
id|d
op_amp
l_int|0xf3
)paren
op_eq
l_int|1
)paren
op_logical_and
(paren
(paren
id|d
op_amp
l_int|0x0c
)paren
op_ne
l_int|0x0c
)paren
suffix:semicolon
)brace
r_inline
r_int
DECL|function|IsSABMX
id|IsSABMX
c_func
(paren
id|u_char
op_star
id|data
comma
r_int
id|ext
)paren
(brace
id|u_char
id|d
op_assign
id|data
(braket
l_int|0
)braket
op_amp
op_complement
l_int|0x10
suffix:semicolon
r_return
(paren
id|ext
ques
c_cond
id|d
op_eq
id|SABME
suffix:colon
id|d
op_eq
id|SABM
)paren
suffix:semicolon
)brace
r_inline
r_int
DECL|function|IsREJ
id|IsREJ
c_func
(paren
id|u_char
op_star
id|data
comma
r_int
id|ext
)paren
(brace
r_return
(paren
id|ext
ques
c_cond
id|data
(braket
l_int|0
)braket
op_eq
id|REJ
suffix:colon
(paren
id|data
(braket
l_int|0
)braket
op_amp
l_int|0xf
)paren
op_eq
id|REJ
)paren
suffix:semicolon
)brace
r_inline
r_int
DECL|function|IsFRMR
id|IsFRMR
c_func
(paren
id|u_char
op_star
id|data
comma
r_int
id|ext
)paren
(brace
r_return
(paren
(paren
id|data
(braket
l_int|0
)braket
op_amp
l_int|0xef
)paren
op_eq
id|FRMR
)paren
suffix:semicolon
)brace
r_inline
r_int
DECL|function|IsRNR
id|IsRNR
c_func
(paren
id|u_char
op_star
id|data
comma
r_int
id|ext
)paren
(brace
r_return
(paren
id|ext
ques
c_cond
id|data
(braket
l_int|0
)braket
op_eq
id|RNR
suffix:colon
(paren
id|data
(braket
l_int|0
)braket
op_amp
l_int|0xf
)paren
op_eq
id|RNR
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|legalnr
id|legalnr
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|nr
)paren
(brace
r_struct
id|Layer2
op_star
id|l2
op_assign
op_amp
id|st-&gt;l2
suffix:semicolon
r_int
id|lnr
comma
id|lvs
suffix:semicolon
id|lvs
op_assign
(paren
id|l2-&gt;vs
op_ge
id|l2-&gt;va
)paren
ques
c_cond
id|l2-&gt;vs
suffix:colon
(paren
id|l2-&gt;vs
op_plus
(paren
id|test_bit
c_func
(paren
id|FLG_MOD128
comma
op_amp
id|l2-&gt;flag
)paren
ques
c_cond
l_int|128
suffix:colon
l_int|8
)paren
)paren
suffix:semicolon
id|lnr
op_assign
(paren
id|nr
op_ge
id|l2-&gt;va
)paren
ques
c_cond
id|nr
suffix:colon
(paren
id|test_bit
c_func
(paren
id|FLG_MOD128
comma
op_amp
id|l2-&gt;flag
)paren
ques
c_cond
l_int|128
suffix:colon
l_int|8
)paren
suffix:semicolon
r_return
(paren
id|lnr
op_le
id|lvs
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|setva
id|setva
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|nr
)paren
(brace
r_struct
id|Layer2
op_star
id|l2
op_assign
op_amp
id|st-&gt;l2
suffix:semicolon
r_int
id|len
suffix:semicolon
r_while
c_loop
(paren
id|l2-&gt;va
op_ne
id|nr
)paren
(brace
id|l2-&gt;va
op_assign
(paren
id|l2-&gt;va
op_plus
l_int|1
)paren
op_mod
(paren
id|test_bit
c_func
(paren
id|FLG_MOD128
comma
op_amp
id|l2-&gt;flag
)paren
ques
c_cond
l_int|128
suffix:colon
l_int|8
)paren
suffix:semicolon
id|len
op_assign
id|l2-&gt;windowar
(braket
id|l2-&gt;sow
)braket
op_member_access_from_pointer
id|len
suffix:semicolon
r_if
c_cond
(paren
id|PACKET_NOACK
op_eq
id|l2-&gt;windowar
(braket
id|l2-&gt;sow
)braket
op_member_access_from_pointer
id|pkt_type
)paren
id|len
op_assign
op_minus
l_int|1
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|l2-&gt;windowar
(braket
id|l2-&gt;sow
)braket
)paren
suffix:semicolon
id|l2-&gt;windowar
(braket
id|l2-&gt;sow
)braket
op_assign
l_int|NULL
suffix:semicolon
id|l2-&gt;sow
op_assign
(paren
id|l2-&gt;sow
op_plus
l_int|1
)paren
op_mod
id|l2-&gt;window
suffix:semicolon
r_if
c_cond
(paren
id|st-&gt;lli.l2writewakeup
op_logical_and
(paren
id|len
op_ge
l_int|0
)paren
)paren
id|st-&gt;lli
dot
id|l2writewakeup
c_func
(paren
id|st
comma
id|len
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|send_uframe
id|send_uframe
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
id|u_char
id|cmd
comma
id|u_char
id|cr
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|u_char
id|tmp
(braket
id|MAX_HEADER_LEN
)braket
suffix:semicolon
r_int
id|i
suffix:semicolon
id|i
op_assign
id|sethdraddr
c_func
(paren
op_amp
id|st-&gt;l2
comma
id|tmp
comma
id|cr
)paren
suffix:semicolon
id|tmp
(braket
id|i
op_increment
)braket
op_assign
id|cmd
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|alloc_skb
c_func
(paren
id|i
comma
id|GFP_ATOMIC
)paren
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;isdl2 can&squot;t alloc sbbuff for send_uframe&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|i
)paren
comma
id|tmp
comma
id|i
)paren
suffix:semicolon
id|enqueue_super
c_func
(paren
id|st
comma
id|skb
)paren
suffix:semicolon
)brace
r_inline
id|u_char
DECL|function|get_PollFlag
id|get_PollFlag
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
r_return
(paren
id|skb-&gt;data
(braket
id|l2addrsize
c_func
(paren
op_amp
(paren
id|st-&gt;l2
)paren
)paren
)braket
op_amp
l_int|0x10
)paren
suffix:semicolon
)brace
r_inline
r_void
DECL|function|FreeSkb
id|FreeSkb
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
)brace
r_inline
id|u_char
DECL|function|get_PollFlagFree
id|get_PollFlagFree
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
id|u_char
id|PF
suffix:semicolon
id|PF
op_assign
id|get_PollFlag
c_func
(paren
id|st
comma
id|skb
)paren
suffix:semicolon
id|FreeSkb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
(paren
id|PF
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|establishlink
id|establishlink
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|u_char
id|cmd
suffix:semicolon
id|clear_exception
c_func
(paren
op_amp
id|st-&gt;l2
)paren
suffix:semicolon
id|st-&gt;l2.rc
op_assign
l_int|0
suffix:semicolon
id|cmd
op_assign
(paren
id|test_bit
c_func
(paren
id|FLG_MOD128
comma
op_amp
id|st-&gt;l2.flag
)paren
ques
c_cond
id|SABME
suffix:colon
id|SABM
)paren
op_or
l_int|0x10
suffix:semicolon
id|send_uframe
c_func
(paren
id|st
comma
id|cmd
comma
id|CMD
)paren
suffix:semicolon
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t203
comma
l_int|1
)paren
suffix:semicolon
id|FsmRestartTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200
comma
id|st-&gt;l2.T200
comma
id|EV_L2_T200
comma
l_int|NULL
comma
l_int|1
)paren
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_T200_RUN
comma
op_amp
id|st-&gt;l2.flag
)paren
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_5
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l2_mdl_error
id|l2_mdl_error
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_switch
c_cond
(paren
id|event
)paren
(brace
r_case
id|EV_L2_UA
suffix:colon
r_if
c_cond
(paren
id|get_PollFlagFree
c_func
(paren
id|st
comma
id|skb
)paren
)paren
id|st-&gt;ma
dot
id|layer
c_func
(paren
id|st
comma
id|MDL_ERROR
op_or
id|INDICATION
comma
(paren
r_void
op_star
)paren
l_char|&squot;C&squot;
)paren
suffix:semicolon
r_else
id|st-&gt;ma
dot
id|layer
c_func
(paren
id|st
comma
id|MDL_ERROR
op_or
id|INDICATION
comma
(paren
r_void
op_star
)paren
l_char|&squot;D&squot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|EV_L2_DM
suffix:colon
r_if
c_cond
(paren
id|get_PollFlagFree
c_func
(paren
id|st
comma
id|skb
)paren
)paren
id|st-&gt;ma
dot
id|layer
c_func
(paren
id|st
comma
id|MDL_ERROR
op_or
id|INDICATION
comma
(paren
r_void
op_star
)paren
l_char|&squot;B&squot;
)paren
suffix:semicolon
r_else
(brace
id|st-&gt;ma
dot
id|layer
c_func
(paren
id|st
comma
id|MDL_ERROR
op_or
id|INDICATION
comma
(paren
r_void
op_star
)paren
l_char|&squot;E&squot;
)paren
suffix:semicolon
id|establishlink
c_func
(paren
id|fi
)paren
suffix:semicolon
id|test_and_clear_bit
c_func
(paren
id|FLG_L3_INIT
comma
op_amp
id|st-&gt;l2.flag
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|l2_dl_establish
id|l2_dl_establish
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_int
id|state
op_assign
id|fi-&gt;state
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_FIXED_TEI
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
(brace
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_4
)paren
suffix:semicolon
id|establishlink
c_func
(paren
id|fi
)paren
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_L3_INIT
comma
op_amp
id|st-&gt;l2.flag
)paren
suffix:semicolon
)brace
r_else
(brace
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_3
)paren
suffix:semicolon
r_if
c_cond
(paren
id|state
op_eq
id|ST_L2_1
)paren
id|st-&gt;l2
dot
id|l2tei
c_func
(paren
id|st
comma
id|MDL_ASSIGN
op_or
id|INDICATION
comma
l_int|NULL
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|l2_send_ui
id|l2_send_ui
c_func
(paren
r_struct
id|PStack
op_star
id|st
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|u_char
id|header
(braket
id|MAX_HEADER_LEN
)braket
suffix:semicolon
r_int
id|i
suffix:semicolon
id|i
op_assign
id|sethdraddr
c_func
(paren
op_amp
(paren
id|st-&gt;l2
)paren
comma
id|header
comma
id|CMD
)paren
suffix:semicolon
id|header
(braket
id|i
op_increment
)braket
op_assign
id|UI
suffix:semicolon
r_while
c_loop
(paren
(paren
id|skb
op_assign
id|skb_dequeue
c_func
(paren
op_amp
id|st-&gt;l2.ui_queue
)paren
)paren
)paren
(brace
id|memcpy
c_func
(paren
id|skb_push
c_func
(paren
id|skb
comma
id|i
)paren
comma
id|header
comma
id|i
)paren
suffix:semicolon
id|enqueue_ui
c_func
(paren
id|st
comma
id|skb
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|l2_put_ui
id|l2_put_ui
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|skb_queue_tail
c_func
(paren
op_amp
id|st-&gt;l2.ui_queue
comma
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fi-&gt;state
op_eq
id|ST_L2_1
)paren
(brace
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_2
)paren
suffix:semicolon
id|st-&gt;l2
dot
id|l2tei
c_func
(paren
id|st
comma
id|MDL_ASSIGN
op_or
id|INDICATION
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|fi-&gt;state
OG
id|ST_L2_3
)paren
id|l2_send_ui
c_func
(paren
id|st
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l2_got_ui
id|l2_got_ui
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|skb_pull
c_func
(paren
id|skb
comma
id|l2headersize
c_func
(paren
op_amp
id|st-&gt;l2
comma
l_int|1
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb-&gt;len
OG
id|st-&gt;l2.maxlen
)paren
(brace
id|st-&gt;ma
dot
id|layer
c_func
(paren
id|st
comma
id|MDL_ERROR
op_or
id|INDICATION
comma
(paren
r_void
op_star
)paren
l_char|&squot;O&squot;
)paren
suffix:semicolon
id|FreeSkb
c_func
(paren
id|skb
)paren
suffix:semicolon
)brace
r_else
id|st-&gt;l2
dot
id|l2l3
c_func
(paren
id|st
comma
id|DL_UNIT_DATA
op_or
id|INDICATION
comma
id|skb
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l2_establish
id|l2_establish
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_if
c_cond
(paren
id|fi-&gt;state
op_ne
id|ST_L2_4
)paren
id|discard_queue
c_func
(paren
op_amp
id|st-&gt;l2.i_queue
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fi-&gt;state
op_ne
id|ST_L2_5
)paren
id|establishlink
c_func
(paren
id|fi
)paren
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_L3_INIT
comma
op_amp
id|st-&gt;l2.flag
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l2_dl_release
id|l2_dl_release
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_if
c_cond
(paren
id|fi-&gt;state
op_eq
id|ST_L2_4
)paren
(brace
id|st-&gt;l2
dot
id|l2l3
c_func
(paren
id|st
comma
id|DL_RELEASE
op_or
id|CONFIRM
comma
l_int|NULL
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|fi-&gt;state
op_eq
id|ST_L2_5
)paren
(brace
id|test_and_set_bit
c_func
(paren
id|FLG_PEND_REL
comma
op_amp
id|st-&gt;l2.flag
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|discard_queue
c_func
(paren
op_amp
id|st-&gt;l2.i_queue
)paren
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_6
)paren
suffix:semicolon
id|st-&gt;l2.rc
op_assign
l_int|0
suffix:semicolon
id|send_uframe
c_func
(paren
id|st
comma
id|DISC
op_or
l_int|0x10
comma
id|CMD
)paren
suffix:semicolon
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t203
comma
l_int|1
)paren
suffix:semicolon
id|FsmRestartTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200
comma
id|st-&gt;l2.T200
comma
id|EV_L2_T200
comma
l_int|NULL
comma
l_int|2
)paren
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_T200_RUN
comma
op_amp
id|st-&gt;l2.flag
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l2_got_SABMX
id|l2_got_SABMX
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_int
id|est
op_assign
l_int|1
comma
id|state
comma
id|rsp
suffix:semicolon
id|u_char
id|PollFlag
suffix:semicolon
id|state
op_assign
id|fi-&gt;state
suffix:semicolon
id|rsp
op_assign
op_star
id|skb-&gt;data
op_amp
l_int|0x2
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_ORIG
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
id|rsp
op_assign
op_logical_neg
id|rsp
suffix:semicolon
r_if
c_cond
(paren
id|rsp
)paren
(brace
id|st-&gt;ma
dot
id|layer
c_func
(paren
id|st
comma
id|MDL_ERROR
op_or
id|INDICATION
comma
(paren
r_void
op_star
)paren
l_char|&squot;L&squot;
)paren
suffix:semicolon
id|FreeSkb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|state
op_eq
id|ST_L2_7
)paren
op_logical_or
(paren
id|state
op_eq
id|ST_L2_8
)paren
)paren
id|establishlink
c_func
(paren
id|fi
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|skb-&gt;len
op_ne
(paren
id|l2addrsize
c_func
(paren
op_amp
id|st-&gt;l2
)paren
op_plus
l_int|1
)paren
)paren
(brace
id|st-&gt;ma
dot
id|layer
c_func
(paren
id|st
comma
id|MDL_ERROR
op_or
id|INDICATION
comma
(paren
r_void
op_star
)paren
l_char|&squot;N&squot;
)paren
suffix:semicolon
id|FreeSkb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|state
op_eq
id|ST_L2_7
)paren
op_logical_or
(paren
id|state
op_eq
id|ST_L2_8
)paren
)paren
id|establishlink
c_func
(paren
id|fi
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|PollFlag
op_assign
id|get_PollFlagFree
c_func
(paren
id|st
comma
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ST_L2_6
op_eq
id|state
)paren
(brace
id|send_uframe
c_func
(paren
id|st
comma
id|DM
op_or
id|PollFlag
comma
id|RSP
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_else
id|send_uframe
c_func
(paren
id|st
comma
id|UA
op_or
id|PollFlag
comma
id|RSP
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ST_L2_5
op_eq
id|state
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|ST_L2_4
op_ne
id|state
)paren
(brace
id|st-&gt;ma
dot
id|layer
c_func
(paren
id|st
comma
id|MDL_ERROR
op_or
id|INDICATION
comma
(paren
r_void
op_star
)paren
l_char|&squot;F&squot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|st-&gt;l2.vs
op_ne
id|st-&gt;l2.va
)paren
(brace
id|discard_queue
c_func
(paren
op_amp
id|st-&gt;l2.i_queue
)paren
suffix:semicolon
id|est
op_assign
l_int|1
suffix:semicolon
)brace
r_else
id|est
op_assign
l_int|0
suffix:semicolon
)brace
id|clear_exception
c_func
(paren
op_amp
id|st-&gt;l2
)paren
suffix:semicolon
id|st-&gt;l2.vs
op_assign
l_int|0
suffix:semicolon
id|st-&gt;l2.va
op_assign
l_int|0
suffix:semicolon
id|st-&gt;l2.vr
op_assign
l_int|0
suffix:semicolon
id|st-&gt;l2.sow
op_assign
l_int|0
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_7
)paren
suffix:semicolon
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_T200_RUN
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200
comma
l_int|2
)paren
suffix:semicolon
id|FsmRestartTimer
c_func
(paren
op_amp
id|st-&gt;l2.t203
comma
id|st-&gt;l2.T203
comma
id|EV_L2_T203
comma
l_int|NULL
comma
l_int|3
)paren
suffix:semicolon
r_if
c_cond
(paren
id|est
)paren
id|st-&gt;l2
dot
id|l2l3
c_func
(paren
id|st
comma
id|DL_ESTABLISH
op_or
id|INDICATION
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ST_L2_8
op_eq
id|state
)paren
r_if
c_cond
(paren
id|skb_queue_len
c_func
(paren
op_amp
id|st-&gt;l2.i_queue
)paren
op_logical_and
id|cansend
c_func
(paren
id|st
)paren
)paren
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_PULL
op_or
id|REQUEST
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l2_got_disconn
id|l2_got_disconn
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|u_char
id|PollFlag
comma
id|cmd
op_assign
id|UA
suffix:semicolon
r_int
id|state
comma
id|rel
op_assign
l_int|1
comma
id|cst
op_assign
l_int|1
comma
id|rsp
suffix:semicolon
id|state
op_assign
id|fi-&gt;state
suffix:semicolon
id|rsp
op_assign
op_star
id|skb-&gt;data
op_amp
l_int|0x2
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_ORIG
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
id|rsp
op_assign
op_logical_neg
id|rsp
suffix:semicolon
r_if
c_cond
(paren
id|rsp
)paren
(brace
id|st-&gt;ma
dot
id|layer
c_func
(paren
id|st
comma
id|MDL_ERROR
op_or
id|INDICATION
comma
(paren
r_void
op_star
)paren
l_char|&squot;L&squot;
)paren
suffix:semicolon
id|FreeSkb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|state
op_eq
id|ST_L2_7
)paren
op_logical_or
(paren
id|state
op_eq
id|ST_L2_8
)paren
)paren
id|establishlink
c_func
(paren
id|fi
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|skb-&gt;len
op_ne
(paren
id|l2addrsize
c_func
(paren
op_amp
id|st-&gt;l2
)paren
op_plus
l_int|1
)paren
)paren
(brace
id|st-&gt;ma
dot
id|layer
c_func
(paren
id|st
comma
id|MDL_ERROR
op_or
id|INDICATION
comma
(paren
r_void
op_star
)paren
l_char|&squot;N&squot;
)paren
suffix:semicolon
id|FreeSkb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|state
op_eq
id|ST_L2_7
)paren
op_logical_or
(paren
id|state
op_eq
id|ST_L2_8
)paren
)paren
id|establishlink
c_func
(paren
id|fi
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|PollFlag
op_assign
id|get_PollFlagFree
c_func
(paren
id|st
comma
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|state
op_eq
id|ST_L2_4
)paren
op_logical_or
(paren
id|state
op_eq
id|ST_L2_5
)paren
)paren
(brace
id|rel
op_assign
l_int|0
suffix:semicolon
id|cst
op_assign
l_int|0
suffix:semicolon
id|cmd
op_assign
id|DM
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|state
op_eq
id|ST_L2_6
)paren
(brace
id|rel
op_assign
l_int|0
suffix:semicolon
id|cst
op_assign
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|cst
)paren
(brace
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_4
)paren
suffix:semicolon
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t203
comma
l_int|3
)paren
suffix:semicolon
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_T200_RUN
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200
comma
l_int|2
)paren
suffix:semicolon
)brace
id|send_uframe
c_func
(paren
id|st
comma
id|cmd
op_or
id|PollFlag
comma
id|RSP
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rel
)paren
(brace
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_LAPB
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_DEACTIVATE
op_or
id|REQUEST
comma
l_int|NULL
)paren
suffix:semicolon
id|st-&gt;l2
dot
id|l2l3
c_func
(paren
id|st
comma
id|DL_RELEASE
op_or
id|INDICATION
comma
l_int|NULL
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|l2_got_ua
id|l2_got_ua
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_int
id|pr
op_assign
op_minus
l_int|1
suffix:semicolon
id|u_char
id|PollFlag
suffix:semicolon
r_int
id|state
comma
id|rsp
suffix:semicolon
id|state
op_assign
id|fi-&gt;state
suffix:semicolon
id|rsp
op_assign
op_star
id|skb-&gt;data
op_amp
l_int|0x2
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_ORIG
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
id|rsp
op_assign
op_logical_neg
id|rsp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|rsp
)paren
(brace
id|st-&gt;ma
dot
id|layer
c_func
(paren
id|st
comma
id|MDL_ERROR
op_or
id|INDICATION
comma
(paren
r_void
op_star
)paren
l_char|&squot;L&squot;
)paren
suffix:semicolon
id|FreeSkb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|state
op_eq
id|ST_L2_7
)paren
op_logical_or
(paren
id|state
op_eq
id|ST_L2_8
)paren
)paren
id|establishlink
c_func
(paren
id|fi
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|skb-&gt;len
op_ne
(paren
id|l2addrsize
c_func
(paren
op_amp
id|st-&gt;l2
)paren
op_plus
l_int|1
)paren
)paren
(brace
id|st-&gt;ma
dot
id|layer
c_func
(paren
id|st
comma
id|MDL_ERROR
op_or
id|INDICATION
comma
(paren
r_void
op_star
)paren
l_char|&squot;N&squot;
)paren
suffix:semicolon
id|FreeSkb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|fi-&gt;state
op_eq
id|ST_L2_7
)paren
op_logical_or
(paren
id|fi-&gt;state
op_eq
id|ST_L2_8
)paren
)paren
id|establishlink
c_func
(paren
id|fi
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|PollFlag
op_assign
id|get_PollFlag
c_func
(paren
id|st
comma
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|PollFlag
)paren
(brace
id|l2_mdl_error
c_func
(paren
id|fi
comma
id|event
comma
id|arg
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|FreeSkb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_T200_RUN
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200
comma
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fi-&gt;state
op_eq
id|ST_L2_5
)paren
(brace
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_PEND_REL
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
(brace
id|discard_queue
c_func
(paren
op_amp
id|st-&gt;l2.i_queue
)paren
suffix:semicolon
id|st-&gt;l2.rc
op_assign
l_int|0
suffix:semicolon
id|send_uframe
c_func
(paren
id|st
comma
id|DISC
op_or
l_int|0x10
comma
id|CMD
)paren
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_6
)paren
suffix:semicolon
id|FsmAddTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200
comma
id|st-&gt;l2.T200
comma
id|EV_L2_T200
comma
l_int|NULL
comma
l_int|4
)paren
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_T200_RUN
comma
op_amp
id|st-&gt;l2.flag
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_L3_INIT
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
(brace
id|pr
op_assign
id|DL_ESTABLISH
op_or
id|CONFIRM
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|st-&gt;l2.vs
op_ne
id|st-&gt;l2.va
)paren
(brace
id|discard_queue
c_func
(paren
op_amp
id|st-&gt;l2.i_queue
)paren
suffix:semicolon
id|pr
op_assign
id|DL_ESTABLISH
op_or
id|INDICATION
suffix:semicolon
)brace
id|st-&gt;l2.vs
op_assign
l_int|0
suffix:semicolon
id|st-&gt;l2.va
op_assign
l_int|0
suffix:semicolon
id|st-&gt;l2.vr
op_assign
l_int|0
suffix:semicolon
id|st-&gt;l2.sow
op_assign
l_int|0
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_7
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pr
OG
op_minus
l_int|1
)paren
id|st-&gt;l2
dot
id|l2l3
c_func
(paren
id|st
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
multiline_comment|/* ST_L2_6 */
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_LAPB
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_DEACTIVATE
op_or
id|REQUEST
comma
l_int|NULL
)paren
suffix:semicolon
id|st-&gt;l2
dot
id|l2l3
c_func
(paren
id|st
comma
id|DL_RELEASE
op_or
id|CONFIRM
comma
l_int|NULL
)paren
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_4
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|l2_got_dm
id|l2_got_dm
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|u_char
id|PollFlag
suffix:semicolon
r_int
id|state
comma
id|rsp
suffix:semicolon
id|state
op_assign
id|fi-&gt;state
suffix:semicolon
id|rsp
op_assign
op_star
id|skb-&gt;data
op_amp
l_int|0x2
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_ORIG
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
id|rsp
op_assign
op_logical_neg
id|rsp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|rsp
)paren
(brace
id|st-&gt;ma
dot
id|layer
c_func
(paren
id|st
comma
id|MDL_ERROR
op_or
id|INDICATION
comma
(paren
r_void
op_star
)paren
l_char|&squot;L&squot;
)paren
suffix:semicolon
id|FreeSkb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|state
op_eq
id|ST_L2_7
)paren
op_logical_or
(paren
id|state
op_eq
id|ST_L2_8
)paren
)paren
id|establishlink
c_func
(paren
id|fi
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|skb-&gt;len
op_ne
(paren
id|l2addrsize
c_func
(paren
op_amp
id|st-&gt;l2
)paren
op_plus
l_int|1
)paren
)paren
(brace
id|st-&gt;ma
dot
id|layer
c_func
(paren
id|st
comma
id|MDL_ERROR
op_or
id|INDICATION
comma
(paren
r_void
op_star
)paren
l_char|&squot;N&squot;
)paren
suffix:semicolon
id|FreeSkb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|fi-&gt;state
op_eq
id|ST_L2_7
)paren
op_logical_or
(paren
id|fi-&gt;state
op_eq
id|ST_L2_8
)paren
)paren
id|establishlink
c_func
(paren
id|fi
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|PollFlag
op_assign
id|get_PollFlagFree
c_func
(paren
id|st
comma
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|PollFlag
)paren
(brace
r_if
c_cond
(paren
id|fi-&gt;state
op_eq
id|ST_L2_4
)paren
(brace
id|establishlink
c_func
(paren
id|fi
)paren
suffix:semicolon
id|test_and_clear_bit
c_func
(paren
id|FLG_L3_INIT
comma
op_amp
id|st-&gt;l2.flag
)paren
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_5
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
id|fi-&gt;state
op_eq
id|ST_L2_7
)paren
op_logical_or
(paren
id|fi-&gt;state
op_eq
id|ST_L2_8
)paren
)paren
(brace
id|st-&gt;ma
dot
id|layer
c_func
(paren
id|st
comma
id|MDL_ERROR
op_or
id|INDICATION
comma
(paren
r_void
op_star
)paren
l_char|&squot;E&squot;
)paren
suffix:semicolon
id|establishlink
c_func
(paren
id|fi
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
r_switch
c_cond
(paren
id|fi-&gt;state
)paren
(brace
r_case
id|ST_L2_8
suffix:colon
id|establishlink
c_func
(paren
id|fi
)paren
suffix:semicolon
r_case
id|ST_L2_7
suffix:colon
id|st-&gt;ma
dot
id|layer
c_func
(paren
id|st
comma
id|MDL_ERROR
op_or
id|INDICATION
comma
(paren
r_void
op_star
)paren
l_char|&squot;B&squot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ST_L2_4
suffix:colon
r_break
suffix:semicolon
r_case
id|ST_L2_5
suffix:colon
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_T200_RUN
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200
comma
l_int|2
)paren
suffix:semicolon
id|discard_queue
c_func
(paren
op_amp
id|st-&gt;l2.i_queue
)paren
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_LAPB
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_DEACTIVATE
op_or
id|REQUEST
comma
l_int|NULL
)paren
suffix:semicolon
id|st-&gt;l2
dot
id|l2l3
c_func
(paren
id|st
comma
id|DL_RELEASE
op_or
id|INDICATION
comma
l_int|NULL
)paren
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_4
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ST_L2_6
suffix:colon
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_T200_RUN
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200
comma
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_LAPB
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_DEACTIVATE
op_or
id|REQUEST
comma
l_int|NULL
)paren
suffix:semicolon
id|st-&gt;l2
dot
id|l2l3
c_func
(paren
id|st
comma
id|DL_RELEASE
op_or
id|CONFIRM
comma
l_int|NULL
)paren
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_4
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
)brace
r_inline
r_void
DECL|function|enquiry_cr
id|enquiry_cr
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
id|u_char
id|typ
comma
id|u_char
id|cr
comma
id|u_char
id|pf
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_struct
id|Layer2
op_star
id|l2
suffix:semicolon
id|u_char
id|tmp
(braket
id|MAX_HEADER_LEN
)braket
suffix:semicolon
r_int
id|i
suffix:semicolon
id|l2
op_assign
op_amp
id|st-&gt;l2
suffix:semicolon
id|i
op_assign
id|sethdraddr
c_func
(paren
id|l2
comma
id|tmp
comma
id|cr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_MOD128
comma
op_amp
id|l2-&gt;flag
)paren
)paren
(brace
id|tmp
(braket
id|i
op_increment
)braket
op_assign
id|typ
suffix:semicolon
id|tmp
(braket
id|i
op_increment
)braket
op_assign
(paren
id|l2-&gt;vr
op_lshift
l_int|1
)paren
op_or
(paren
id|pf
ques
c_cond
l_int|1
suffix:colon
l_int|0
)paren
suffix:semicolon
)brace
r_else
id|tmp
(braket
id|i
op_increment
)braket
op_assign
(paren
id|l2-&gt;vr
op_lshift
l_int|5
)paren
op_or
id|typ
op_or
(paren
id|pf
ques
c_cond
l_int|0x10
suffix:colon
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|alloc_skb
c_func
(paren
id|i
comma
id|GFP_ATOMIC
)paren
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;isdl2 can&squot;t alloc sbbuff for enquiry_cr&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|i
)paren
comma
id|tmp
comma
id|i
)paren
suffix:semicolon
id|enqueue_super
c_func
(paren
id|st
comma
id|skb
)paren
suffix:semicolon
)brace
r_inline
r_void
DECL|function|enquiry_response
id|enquiry_response
c_func
(paren
r_struct
id|PStack
op_star
id|st
)paren
(brace
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_OWN_BUSY
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
id|enquiry_cr
c_func
(paren
id|st
comma
id|RNR
comma
id|RSP
comma
l_int|1
)paren
suffix:semicolon
r_else
id|enquiry_cr
c_func
(paren
id|st
comma
id|RR
comma
id|RSP
comma
l_int|1
)paren
suffix:semicolon
id|test_and_clear_bit
c_func
(paren
id|FLG_ACK_PEND
comma
op_amp
id|st-&gt;l2.flag
)paren
suffix:semicolon
)brace
r_inline
r_void
DECL|function|transmit_enquiry
id|transmit_enquiry
c_func
(paren
r_struct
id|PStack
op_star
id|st
)paren
(brace
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_OWN_BUSY
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
id|enquiry_cr
c_func
(paren
id|st
comma
id|RNR
comma
id|CMD
comma
l_int|1
)paren
suffix:semicolon
r_else
id|enquiry_cr
c_func
(paren
id|st
comma
id|RR
comma
id|CMD
comma
l_int|1
)paren
suffix:semicolon
id|test_and_clear_bit
c_func
(paren
id|FLG_ACK_PEND
comma
op_amp
id|st-&gt;l2.flag
)paren
suffix:semicolon
id|FsmAddTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200
comma
id|st-&gt;l2.T200
comma
id|EV_L2_T200
comma
l_int|NULL
comma
l_int|12
)paren
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_T200_RUN
comma
op_amp
id|st-&gt;l2.flag
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|nrerrorrecovery
id|nrerrorrecovery
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|st-&gt;ma
dot
id|layer
c_func
(paren
id|st
comma
id|MDL_ERROR
op_or
id|INDICATION
comma
(paren
r_void
op_star
)paren
l_char|&squot;J&squot;
)paren
suffix:semicolon
id|establishlink
c_func
(paren
id|fi
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|invoke_retransmission
id|invoke_retransmission
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|nr
)paren
(brace
r_struct
id|Layer2
op_star
id|l2
op_assign
op_amp
id|st-&gt;l2
suffix:semicolon
r_int
id|p1
suffix:semicolon
r_int
id|flags
suffix:semicolon
r_if
c_cond
(paren
id|l2-&gt;vs
op_ne
id|nr
)paren
(brace
id|save_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
id|cli
c_func
(paren
)paren
suffix:semicolon
r_while
c_loop
(paren
id|l2-&gt;vs
op_ne
id|nr
)paren
(brace
id|l2-&gt;vs
op_assign
id|l2-&gt;vs
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|l2-&gt;vs
OL
l_int|0
)paren
id|l2-&gt;vs
op_add_assign
(paren
id|test_bit
c_func
(paren
id|FLG_MOD128
comma
op_amp
id|l2-&gt;flag
)paren
ques
c_cond
l_int|128
suffix:colon
l_int|8
)paren
suffix:semicolon
id|p1
op_assign
id|l2-&gt;vs
op_minus
id|l2-&gt;va
suffix:semicolon
r_if
c_cond
(paren
id|p1
OL
l_int|0
)paren
id|p1
op_add_assign
(paren
id|test_bit
c_func
(paren
id|FLG_MOD128
comma
op_amp
id|l2-&gt;flag
)paren
ques
c_cond
l_int|128
suffix:colon
l_int|8
)paren
suffix:semicolon
id|p1
op_assign
(paren
id|p1
op_plus
id|l2-&gt;sow
)paren
op_mod
id|l2-&gt;window
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_LAPB
comma
op_amp
id|l2-&gt;flag
)paren
)paren
id|st-&gt;l1.bcs-&gt;tx_cnt
op_add_assign
id|l2-&gt;windowar
(braket
id|p1
)braket
op_member_access_from_pointer
id|len
op_plus
id|l2headersize
c_func
(paren
id|l2
comma
l_int|0
)paren
suffix:semicolon
id|skb_queue_head
c_func
(paren
op_amp
id|l2-&gt;i_queue
comma
id|l2-&gt;windowar
(braket
id|p1
)braket
)paren
suffix:semicolon
id|l2-&gt;windowar
(braket
id|p1
)braket
op_assign
l_int|NULL
suffix:semicolon
)brace
id|restore_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_PULL
op_or
id|REQUEST
comma
l_int|NULL
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|l2_got_st7_super
id|l2_got_st7_super
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_int
id|PollFlag
comma
id|nr
comma
id|rsp
comma
id|typ
op_assign
id|RR
suffix:semicolon
r_struct
id|Layer2
op_star
id|l2
op_assign
op_amp
id|st-&gt;l2
suffix:semicolon
id|rsp
op_assign
op_star
id|skb-&gt;data
op_amp
l_int|0x2
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_ORIG
comma
op_amp
id|l2-&gt;flag
)paren
)paren
id|rsp
op_assign
op_logical_neg
id|rsp
suffix:semicolon
id|skb_pull
c_func
(paren
id|skb
comma
id|l2addrsize
c_func
(paren
id|l2
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|IsRNR
c_func
(paren
id|skb-&gt;data
comma
id|test_bit
c_func
(paren
id|FLG_MOD128
comma
op_amp
id|l2-&gt;flag
)paren
)paren
)paren
(brace
id|test_and_set_bit
c_func
(paren
id|FLG_PEER_BUSY
comma
op_amp
id|l2-&gt;flag
)paren
suffix:semicolon
id|typ
op_assign
id|RNR
suffix:semicolon
)brace
r_else
id|test_and_clear_bit
c_func
(paren
id|FLG_PEER_BUSY
comma
op_amp
id|l2-&gt;flag
)paren
suffix:semicolon
r_if
c_cond
(paren
id|IsREJ
c_func
(paren
id|skb-&gt;data
comma
id|test_bit
c_func
(paren
id|FLG_MOD128
comma
op_amp
id|l2-&gt;flag
)paren
)paren
)paren
id|typ
op_assign
id|REJ
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_MOD128
comma
op_amp
id|l2-&gt;flag
)paren
)paren
(brace
r_if
c_cond
(paren
id|skb-&gt;len
op_eq
l_int|2
)paren
(brace
id|PollFlag
op_assign
(paren
id|skb-&gt;data
(braket
l_int|1
)braket
op_amp
l_int|0x1
)paren
op_eq
l_int|0x1
suffix:semicolon
id|nr
op_assign
id|skb-&gt;data
(braket
l_int|1
)braket
op_rshift
l_int|1
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|skb-&gt;len
OG
l_int|2
)paren
(brace
id|st-&gt;ma
dot
id|layer
c_func
(paren
id|st
comma
id|MDL_ERROR
op_or
id|INDICATION
comma
(paren
r_void
op_star
)paren
l_char|&squot;N&squot;
)paren
suffix:semicolon
id|establishlink
c_func
(paren
id|fi
)paren
suffix:semicolon
)brace
id|FreeSkb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|skb-&gt;len
op_eq
l_int|1
)paren
(brace
id|PollFlag
op_assign
(paren
id|skb-&gt;data
(braket
l_int|0
)braket
op_amp
l_int|0x10
)paren
suffix:semicolon
id|nr
op_assign
(paren
id|skb-&gt;data
(braket
l_int|0
)braket
op_rshift
l_int|5
)paren
op_amp
l_int|0x7
suffix:semicolon
)brace
r_else
(brace
id|st-&gt;ma
dot
id|layer
c_func
(paren
id|st
comma
id|MDL_ERROR
op_or
id|INDICATION
comma
(paren
r_void
op_star
)paren
l_char|&squot;N&squot;
)paren
suffix:semicolon
id|FreeSkb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|establishlink
c_func
(paren
id|fi
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
)brace
id|FreeSkb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
op_logical_neg
id|rsp
)paren
op_logical_and
id|PollFlag
)paren
id|enquiry_response
c_func
(paren
id|st
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rsp
op_logical_and
id|PollFlag
)paren
id|st-&gt;ma
dot
id|layer
c_func
(paren
id|st
comma
id|MDL_ERROR
op_or
id|INDICATION
comma
(paren
r_void
op_star
)paren
l_char|&squot;A&squot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|legalnr
c_func
(paren
id|st
comma
id|nr
)paren
)paren
(brace
r_if
c_cond
(paren
id|typ
op_eq
id|REJ
)paren
(brace
id|setva
c_func
(paren
id|st
comma
id|nr
)paren
suffix:semicolon
id|invoke_retransmission
c_func
(paren
id|st
comma
id|nr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_T200_RUN
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200
comma
l_int|9
)paren
suffix:semicolon
r_if
c_cond
(paren
id|FsmAddTimer
c_func
(paren
op_amp
id|st-&gt;l2.t203
comma
id|st-&gt;l2.T203
comma
id|EV_L2_T203
comma
l_int|NULL
comma
l_int|6
)paren
)paren
id|l2m_debug
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
l_string|&quot;Restart T203 ST7 REJ&quot;
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
id|nr
op_eq
id|l2-&gt;vs
)paren
op_logical_and
(paren
id|typ
op_eq
id|RR
)paren
)paren
(brace
id|setva
c_func
(paren
id|st
comma
id|nr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_T200_RUN
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200
comma
l_int|9
)paren
suffix:semicolon
id|FsmRestartTimer
c_func
(paren
op_amp
id|st-&gt;l2.t203
comma
id|st-&gt;l2.T203
comma
id|EV_L2_T203
comma
l_int|NULL
comma
l_int|7
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
id|l2-&gt;va
op_ne
id|nr
)paren
op_logical_or
(paren
id|typ
op_eq
id|RNR
)paren
)paren
(brace
id|setva
c_func
(paren
id|st
comma
id|nr
)paren
suffix:semicolon
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t203
comma
l_int|9
)paren
suffix:semicolon
id|FsmRestartTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200
comma
id|st-&gt;l2.T200
comma
id|EV_L2_T200
comma
l_int|NULL
comma
l_int|6
)paren
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_T200_RUN
comma
op_amp
id|st-&gt;l2.flag
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|skb_queue_len
c_func
(paren
op_amp
id|st-&gt;l2.i_queue
)paren
op_logical_and
(paren
id|typ
op_eq
id|RR
)paren
)paren
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_PULL
op_or
id|REQUEST
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_else
id|nrerrorrecovery
c_func
(paren
id|fi
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|fi-&gt;userint
op_amp
id|LC_FLUSH_WAIT
)paren
op_logical_and
id|rsp
op_logical_and
op_logical_neg
(paren
id|skb_queue_len
c_func
(paren
op_amp
id|st-&gt;l2.i_queue
)paren
)paren
)paren
(brace
id|fi-&gt;userint
op_and_assign
op_complement
id|LC_FLUSH_WAIT
suffix:semicolon
id|st-&gt;l2
dot
id|l2l3
c_func
(paren
id|st
comma
id|DL_FLUSH
op_or
id|INDICATION
comma
l_int|NULL
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|l2_feed_iqueue
id|l2_feed_iqueue
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_LAPB
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
id|st-&gt;l1.bcs-&gt;tx_cnt
op_add_assign
id|skb-&gt;len
op_plus
id|l2headersize
c_func
(paren
op_amp
id|st-&gt;l2
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
(paren
id|fi-&gt;state
op_eq
id|ST_L2_5
)paren
op_logical_and
id|test_bit
c_func
(paren
id|FLG_L3_INIT
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
)paren
id|skb_queue_tail
c_func
(paren
op_amp
id|st-&gt;l2.i_queue
comma
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fi-&gt;state
op_eq
id|ST_L2_7
)paren
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_PULL
op_or
id|REQUEST
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l2_got_iframe
id|l2_got_iframe
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_struct
id|Layer2
op_star
id|l2
op_assign
op_amp
(paren
id|st-&gt;l2
)paren
suffix:semicolon
r_int
id|PollFlag
comma
id|ns
comma
id|nr
comma
id|i
comma
id|rsp
suffix:semicolon
id|rsp
op_assign
op_star
id|skb-&gt;data
op_amp
l_int|0x2
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_ORIG
comma
op_amp
id|l2-&gt;flag
)paren
)paren
id|rsp
op_assign
op_logical_neg
id|rsp
suffix:semicolon
r_if
c_cond
(paren
id|rsp
)paren
(brace
id|st-&gt;ma
dot
id|layer
c_func
(paren
id|st
comma
id|MDL_ERROR
op_or
id|INDICATION
comma
(paren
r_void
op_star
)paren
l_char|&squot;L&squot;
)paren
suffix:semicolon
id|FreeSkb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|establishlink
c_func
(paren
id|fi
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|i
op_assign
id|l2addrsize
c_func
(paren
id|l2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_MOD128
comma
op_amp
id|l2-&gt;flag
)paren
)paren
(brace
r_if
c_cond
(paren
id|skb-&gt;len
op_le
(paren
id|i
op_plus
l_int|1
)paren
)paren
(brace
id|FreeSkb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
id|skb-&gt;len
op_minus
id|i
op_minus
l_int|1
)paren
OG
id|l2-&gt;maxlen
)paren
(brace
id|st-&gt;ma
dot
id|layer
c_func
(paren
id|st
comma
id|MDL_ERROR
op_or
id|INDICATION
comma
(paren
r_void
op_star
)paren
l_char|&squot;O&squot;
)paren
suffix:semicolon
id|FreeSkb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|establishlink
c_func
(paren
id|fi
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|PollFlag
op_assign
(paren
(paren
id|skb-&gt;data
(braket
id|i
op_plus
l_int|1
)braket
op_amp
l_int|0x1
)paren
op_eq
l_int|0x1
)paren
suffix:semicolon
id|ns
op_assign
id|skb-&gt;data
(braket
id|i
)braket
op_rshift
l_int|1
suffix:semicolon
id|nr
op_assign
(paren
id|skb-&gt;data
(braket
id|i
op_plus
l_int|1
)braket
op_rshift
l_int|1
)paren
op_amp
l_int|0x7f
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|skb-&gt;len
op_le
id|i
)paren
(brace
id|st-&gt;ma
dot
id|layer
c_func
(paren
id|st
comma
id|MDL_ERROR
op_or
id|INDICATION
comma
(paren
r_void
op_star
)paren
l_char|&squot;N&squot;
)paren
suffix:semicolon
id|FreeSkb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|establishlink
c_func
(paren
id|fi
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
id|skb-&gt;len
op_minus
id|i
)paren
OG
id|l2-&gt;maxlen
)paren
(brace
id|st-&gt;ma
dot
id|layer
c_func
(paren
id|st
comma
id|MDL_ERROR
op_or
id|INDICATION
comma
(paren
r_void
op_star
)paren
l_char|&squot;O&squot;
)paren
suffix:semicolon
id|FreeSkb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|establishlink
c_func
(paren
id|fi
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|PollFlag
op_assign
(paren
id|skb-&gt;data
(braket
id|i
)braket
op_amp
l_int|0x10
)paren
suffix:semicolon
id|ns
op_assign
(paren
id|skb-&gt;data
(braket
id|i
)braket
op_rshift
l_int|1
)paren
op_amp
l_int|0x7
suffix:semicolon
id|nr
op_assign
(paren
id|skb-&gt;data
(braket
id|i
)braket
op_rshift
l_int|5
)paren
op_amp
l_int|0x7
suffix:semicolon
)brace
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_OWN_BUSY
comma
op_amp
id|l2-&gt;flag
)paren
)paren
(brace
id|FreeSkb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|enquiry_response
c_func
(paren
id|st
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|l2-&gt;vr
op_eq
id|ns
)paren
(brace
id|l2-&gt;vr
op_assign
(paren
id|l2-&gt;vr
op_plus
l_int|1
)paren
op_mod
(paren
id|test_bit
c_func
(paren
id|FLG_MOD128
comma
op_amp
id|l2-&gt;flag
)paren
ques
c_cond
l_int|128
suffix:colon
l_int|8
)paren
suffix:semicolon
id|test_and_clear_bit
c_func
(paren
id|FLG_REJEXC
comma
op_amp
id|l2-&gt;flag
)paren
suffix:semicolon
r_if
c_cond
(paren
id|PollFlag
)paren
id|enquiry_response
c_func
(paren
id|st
)paren
suffix:semicolon
r_else
id|test_and_set_bit
c_func
(paren
id|FLG_ACK_PEND
comma
op_amp
id|l2-&gt;flag
)paren
suffix:semicolon
id|skb_pull
c_func
(paren
id|skb
comma
id|l2headersize
c_func
(paren
id|l2
comma
l_int|0
)paren
)paren
suffix:semicolon
id|st-&gt;l2
dot
id|l2l3
c_func
(paren
id|st
comma
id|DL_DATA
op_or
id|INDICATION
comma
id|skb
)paren
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* n(s)!=v(r) */
id|FreeSkb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
id|test_and_set_bit
c_func
(paren
id|FLG_REJEXC
comma
op_amp
id|l2-&gt;flag
)paren
)paren
(brace
r_if
c_cond
(paren
id|PollFlag
)paren
id|enquiry_response
c_func
(paren
id|st
)paren
suffix:semicolon
)brace
r_else
(brace
id|enquiry_cr
c_func
(paren
id|st
comma
id|REJ
comma
id|RSP
comma
id|PollFlag
)paren
suffix:semicolon
id|test_and_clear_bit
c_func
(paren
id|FLG_ACK_PEND
comma
op_amp
id|l2-&gt;flag
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|legalnr
c_func
(paren
id|st
comma
id|nr
)paren
)paren
(brace
id|setva
c_func
(paren
id|st
comma
id|nr
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|test_bit
c_func
(paren
id|FLG_PEER_BUSY
comma
op_amp
id|st-&gt;l2.flag
)paren
op_logical_and
(paren
id|fi-&gt;state
op_eq
id|ST_L2_7
)paren
)paren
(brace
r_if
c_cond
(paren
id|nr
op_eq
id|st-&gt;l2.vs
)paren
(brace
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_T200_RUN
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200
comma
l_int|10
)paren
suffix:semicolon
id|FsmRestartTimer
c_func
(paren
op_amp
id|st-&gt;l2.t203
comma
id|st-&gt;l2.T203
comma
id|EV_L2_T203
comma
l_int|NULL
comma
l_int|7
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|nr
op_ne
id|st-&gt;l2.va
)paren
(brace
id|FsmRestartTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200
comma
id|st-&gt;l2.T200
comma
id|EV_L2_T200
comma
l_int|NULL
comma
l_int|8
)paren
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_T200_RUN
comma
op_amp
id|st-&gt;l2.flag
)paren
suffix:semicolon
)brace
)brace
)brace
r_else
(brace
id|nrerrorrecovery
c_func
(paren
id|fi
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|skb_queue_len
c_func
(paren
op_amp
id|st-&gt;l2.i_queue
)paren
op_logical_and
(paren
id|fi-&gt;state
op_eq
id|ST_L2_7
)paren
)paren
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_PULL
op_or
id|REQUEST
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_ACK_PEND
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
id|enquiry_cr
c_func
(paren
id|st
comma
id|RR
comma
id|RSP
comma
l_int|0
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l2_got_tei
id|l2_got_tei
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|st-&gt;l2.tei
op_assign
(paren
r_int
)paren
id|arg
suffix:semicolon
r_if
c_cond
(paren
id|fi-&gt;state
op_eq
id|ST_L2_3
)paren
(brace
id|establishlink
c_func
(paren
id|fi
)paren
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_L3_INIT
comma
op_amp
id|st-&gt;l2.flag
)paren
suffix:semicolon
)brace
r_else
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_4
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb_queue_len
c_func
(paren
op_amp
id|st-&gt;l2.ui_queue
)paren
)paren
id|l2_send_ui
c_func
(paren
id|st
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l2_st5_tout_200
id|l2_st5_tout_200
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_LAPD
comma
op_amp
id|st-&gt;l2.flag
)paren
op_logical_and
id|test_bit
c_func
(paren
id|FLG_DCHAN_BUSY
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
(brace
id|FsmAddTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200
comma
id|st-&gt;l2.T200
comma
id|EV_L2_T200
comma
l_int|NULL
comma
l_int|9
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|st-&gt;l2.rc
op_eq
id|st-&gt;l2.N200
)paren
(brace
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_4
)paren
suffix:semicolon
id|test_and_clear_bit
c_func
(paren
id|FLG_T200_RUN
comma
op_amp
id|st-&gt;l2.flag
)paren
suffix:semicolon
id|discard_queue
c_func
(paren
op_amp
id|st-&gt;l2.i_queue
)paren
suffix:semicolon
id|st-&gt;ma
dot
id|layer
c_func
(paren
id|st
comma
id|MDL_ERROR
op_or
id|INDICATION
comma
(paren
r_void
op_star
)paren
l_char|&squot;G&squot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_LAPB
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_DEACTIVATE
op_or
id|REQUEST
comma
l_int|NULL
)paren
suffix:semicolon
id|st-&gt;l2
dot
id|l2l3
c_func
(paren
id|st
comma
id|DL_RELEASE
op_or
id|INDICATION
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_else
(brace
id|st-&gt;l2.rc
op_increment
suffix:semicolon
id|FsmAddTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200
comma
id|st-&gt;l2.T200
comma
id|EV_L2_T200
comma
l_int|NULL
comma
l_int|9
)paren
suffix:semicolon
id|send_uframe
c_func
(paren
id|st
comma
(paren
id|test_bit
c_func
(paren
id|FLG_MOD128
comma
op_amp
id|st-&gt;l2.flag
)paren
ques
c_cond
id|SABME
suffix:colon
id|SABM
)paren
op_or
l_int|0x10
comma
id|CMD
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|l2_st6_tout_200
id|l2_st6_tout_200
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_LAPD
comma
op_amp
id|st-&gt;l2.flag
)paren
op_logical_and
id|test_bit
c_func
(paren
id|FLG_DCHAN_BUSY
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
(brace
id|FsmAddTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200
comma
id|st-&gt;l2.T200
comma
id|EV_L2_T200
comma
l_int|NULL
comma
l_int|9
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|st-&gt;l2.rc
op_eq
id|st-&gt;l2.N200
)paren
(brace
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_4
)paren
suffix:semicolon
id|st-&gt;ma
dot
id|layer
c_func
(paren
id|st
comma
id|MDL_ERROR
op_or
id|INDICATION
comma
(paren
r_void
op_star
)paren
l_char|&squot;H&squot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_LAPB
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_DEACTIVATE
op_or
id|REQUEST
comma
l_int|NULL
)paren
suffix:semicolon
id|st-&gt;l2
dot
id|l2l3
c_func
(paren
id|st
comma
id|DL_RELEASE
op_or
id|INDICATION
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_else
(brace
id|st-&gt;l2.rc
op_increment
suffix:semicolon
id|FsmAddTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200
comma
id|st-&gt;l2.T200
comma
id|EV_L2_T200
comma
l_int|NULL
comma
l_int|9
)paren
suffix:semicolon
id|send_uframe
c_func
(paren
id|st
comma
id|DISC
op_or
l_int|0x10
comma
id|CMD
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|l2_st78_tout_200
id|l2_st78_tout_200
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_LAPD
comma
op_amp
id|st-&gt;l2.flag
)paren
op_logical_and
id|test_bit
c_func
(paren
id|FLG_DCHAN_BUSY
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
(brace
id|FsmAddTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200
comma
id|st-&gt;l2.T200
comma
id|EV_L2_T200
comma
l_int|NULL
comma
l_int|9
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|test_and_clear_bit
c_func
(paren
id|FLG_T200_RUN
comma
op_amp
id|st-&gt;l2.flag
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fi-&gt;state
op_eq
id|ST_L2_7
)paren
(brace
id|st-&gt;l2.rc
op_assign
l_int|0
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_8
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|st-&gt;l2.rc
op_eq
id|st-&gt;l2.N200
)paren
(brace
id|establishlink
c_func
(paren
id|fi
)paren
suffix:semicolon
)brace
r_else
(brace
id|transmit_enquiry
c_func
(paren
id|st
)paren
suffix:semicolon
id|st-&gt;l2.rc
op_increment
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|l2_st7_tout_203
id|l2_st7_tout_203
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_LAPD
comma
op_amp
id|st-&gt;l2.flag
)paren
op_logical_and
id|test_bit
c_func
(paren
id|FLG_DCHAN_BUSY
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
(brace
id|FsmAddTimer
c_func
(paren
op_amp
id|st-&gt;l2.t203
comma
id|st-&gt;l2.T203
comma
id|EV_L2_T203
comma
l_int|NULL
comma
l_int|9
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_8
)paren
suffix:semicolon
id|transmit_enquiry
c_func
(paren
id|st
)paren
suffix:semicolon
id|st-&gt;l2.rc
op_assign
l_int|0
suffix:semicolon
)brace
r_static
r_void
DECL|function|l2_pull_iqueue
id|l2_pull_iqueue
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
comma
op_star
id|oskb
suffix:semicolon
r_struct
id|Layer2
op_star
id|l2
op_assign
op_amp
id|st-&gt;l2
suffix:semicolon
id|u_char
id|header
(braket
id|MAX_HEADER_LEN
)braket
suffix:semicolon
r_int
id|p1
comma
id|i
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|cansend
c_func
(paren
id|st
)paren
)paren
r_return
suffix:semicolon
id|skb
op_assign
id|skb_dequeue
c_func
(paren
op_amp
id|l2-&gt;i_queue
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
r_return
suffix:semicolon
id|p1
op_assign
id|l2-&gt;vs
op_minus
id|l2-&gt;va
suffix:semicolon
r_if
c_cond
(paren
id|p1
OL
l_int|0
)paren
id|p1
op_add_assign
id|test_bit
c_func
(paren
id|FLG_MOD128
comma
op_amp
id|l2-&gt;flag
)paren
ques
c_cond
l_int|128
suffix:colon
l_int|8
suffix:semicolon
id|p1
op_assign
(paren
id|p1
op_plus
id|l2-&gt;sow
)paren
op_mod
id|l2-&gt;window
suffix:semicolon
r_if
c_cond
(paren
id|l2-&gt;windowar
(braket
id|p1
)braket
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;isdnl2 try overwrite ack queue entry %d&bslash;n&quot;
comma
id|p1
)paren
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|l2-&gt;windowar
(braket
id|p1
)braket
)paren
suffix:semicolon
)brace
id|l2-&gt;windowar
(braket
id|p1
)braket
op_assign
id|skb_clone
c_func
(paren
id|skb
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
id|i
op_assign
id|sethdraddr
c_func
(paren
op_amp
id|st-&gt;l2
comma
id|header
comma
id|CMD
)paren
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_MOD128
comma
op_amp
id|l2-&gt;flag
)paren
)paren
(brace
id|header
(braket
id|i
op_increment
)braket
op_assign
id|l2-&gt;vs
op_lshift
l_int|1
suffix:semicolon
id|header
(braket
id|i
op_increment
)braket
op_assign
id|l2-&gt;vr
op_lshift
l_int|1
suffix:semicolon
id|l2-&gt;vs
op_assign
(paren
id|l2-&gt;vs
op_plus
l_int|1
)paren
op_mod
l_int|128
suffix:semicolon
)brace
r_else
(brace
id|header
(braket
id|i
op_increment
)braket
op_assign
(paren
id|l2-&gt;vr
op_lshift
l_int|5
)paren
op_or
(paren
id|l2-&gt;vs
op_lshift
l_int|1
)paren
suffix:semicolon
id|l2-&gt;vs
op_assign
(paren
id|l2-&gt;vs
op_plus
l_int|1
)paren
op_mod
l_int|8
suffix:semicolon
)brace
id|p1
op_assign
id|skb-&gt;data
op_minus
id|skb-&gt;head
suffix:semicolon
r_if
c_cond
(paren
id|p1
op_ge
id|i
)paren
id|memcpy
c_func
(paren
id|skb_push
c_func
(paren
id|skb
comma
id|i
)paren
comma
id|header
comma
id|i
)paren
suffix:semicolon
r_else
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;isdl2 pull_iqueue skb header(%d/%d) too short&bslash;n&quot;
comma
id|i
comma
id|p1
)paren
suffix:semicolon
id|oskb
op_assign
id|skb
suffix:semicolon
id|skb
op_assign
id|alloc_skb
c_func
(paren
id|oskb-&gt;len
op_plus
id|i
comma
id|GFP_ATOMIC
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|i
)paren
comma
id|header
comma
id|i
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|oskb-&gt;len
)paren
comma
id|oskb-&gt;data
comma
id|oskb-&gt;len
)paren
suffix:semicolon
id|FreeSkb
c_func
(paren
id|oskb
)paren
suffix:semicolon
)brace
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_PULL
op_or
id|INDICATION
comma
id|skb
)paren
suffix:semicolon
id|test_and_clear_bit
c_func
(paren
id|FLG_ACK_PEND
comma
op_amp
id|st-&gt;l2.flag
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|test_and_set_bit
c_func
(paren
id|FLG_T200_RUN
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
(brace
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t203
comma
l_int|13
)paren
suffix:semicolon
id|FsmAddTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200
comma
id|st-&gt;l2.T200
comma
id|EV_L2_T200
comma
l_int|NULL
comma
l_int|11
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|skb_queue_len
c_func
(paren
op_amp
id|l2-&gt;i_queue
)paren
op_logical_and
id|cansend
c_func
(paren
id|st
)paren
)paren
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_PULL
op_or
id|REQUEST
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l2_got_st8_super
id|l2_got_st8_super
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_int
id|PollFlag
comma
id|nr
comma
id|rsp
comma
id|rnr
op_assign
l_int|0
suffix:semicolon
r_struct
id|Layer2
op_star
id|l2
op_assign
op_amp
id|st-&gt;l2
suffix:semicolon
id|rsp
op_assign
op_star
id|skb-&gt;data
op_amp
l_int|0x2
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_ORIG
comma
op_amp
id|l2-&gt;flag
)paren
)paren
id|rsp
op_assign
op_logical_neg
id|rsp
suffix:semicolon
id|skb_pull
c_func
(paren
id|skb
comma
id|l2addrsize
c_func
(paren
id|l2
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|IsRNR
c_func
(paren
id|skb-&gt;data
comma
id|test_bit
c_func
(paren
id|FLG_MOD128
comma
op_amp
id|l2-&gt;flag
)paren
)paren
)paren
(brace
id|test_and_set_bit
c_func
(paren
id|FLG_PEER_BUSY
comma
op_amp
id|l2-&gt;flag
)paren
suffix:semicolon
id|rnr
op_assign
l_int|1
suffix:semicolon
)brace
r_else
id|test_and_clear_bit
c_func
(paren
id|FLG_PEER_BUSY
comma
op_amp
id|l2-&gt;flag
)paren
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_MOD128
comma
op_amp
id|l2-&gt;flag
)paren
)paren
(brace
r_if
c_cond
(paren
id|skb-&gt;len
op_eq
l_int|2
)paren
(brace
id|PollFlag
op_assign
(paren
id|skb-&gt;data
(braket
l_int|1
)braket
op_amp
l_int|0x1
)paren
op_eq
l_int|0x1
suffix:semicolon
id|nr
op_assign
id|skb-&gt;data
(braket
l_int|1
)braket
op_rshift
l_int|1
suffix:semicolon
)brace
r_else
(brace
id|st-&gt;ma
dot
id|layer
c_func
(paren
id|st
comma
id|MDL_ERROR
op_or
id|INDICATION
comma
(paren
r_void
op_star
)paren
l_char|&squot;N&squot;
)paren
suffix:semicolon
id|FreeSkb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|establishlink
c_func
(paren
id|fi
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|skb-&gt;len
op_eq
l_int|1
)paren
(brace
id|PollFlag
op_assign
(paren
id|skb-&gt;data
(braket
l_int|0
)braket
op_amp
l_int|0x10
)paren
suffix:semicolon
id|nr
op_assign
(paren
id|skb-&gt;data
(braket
l_int|0
)braket
op_rshift
l_int|5
)paren
op_amp
l_int|0x7
suffix:semicolon
)brace
r_else
(brace
id|st-&gt;ma
dot
id|layer
c_func
(paren
id|st
comma
id|MDL_ERROR
op_or
id|INDICATION
comma
(paren
r_void
op_star
)paren
l_char|&squot;N&squot;
)paren
suffix:semicolon
id|FreeSkb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|establishlink
c_func
(paren
id|fi
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
)brace
id|FreeSkb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rsp
op_logical_and
id|PollFlag
)paren
(brace
r_if
c_cond
(paren
id|legalnr
c_func
(paren
id|st
comma
id|nr
)paren
)paren
(brace
id|setva
c_func
(paren
id|st
comma
id|nr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_T200_RUN
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200
comma
l_int|7
)paren
suffix:semicolon
id|FsmDelTimer
c_func
(paren
op_amp
id|l2-&gt;t203
comma
l_int|8
)paren
suffix:semicolon
r_if
c_cond
(paren
id|rnr
)paren
(brace
id|FsmRestartTimer
c_func
(paren
op_amp
id|l2-&gt;t200
comma
id|l2-&gt;T200
comma
id|EV_L2_T200
comma
l_int|NULL
comma
l_int|14
)paren
suffix:semicolon
id|test_and_set_bit
c_func
(paren
id|FLG_T200_RUN
comma
op_amp
id|st-&gt;l2.flag
)paren
suffix:semicolon
)brace
r_else
id|FsmAddTimer
c_func
(paren
op_amp
id|l2-&gt;t203
comma
id|l2-&gt;T203
comma
id|EV_L2_T203
comma
l_int|NULL
comma
l_int|5
)paren
suffix:semicolon
id|invoke_retransmission
c_func
(paren
id|st
comma
id|nr
)paren
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_7
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb_queue_len
c_func
(paren
op_amp
id|l2-&gt;i_queue
)paren
op_logical_and
id|cansend
c_func
(paren
id|st
)paren
)paren
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_PULL
op_or
id|REQUEST
comma
l_int|NULL
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|fi-&gt;userint
op_amp
id|LC_FLUSH_WAIT
)paren
(brace
id|fi-&gt;userint
op_and_assign
op_complement
id|LC_FLUSH_WAIT
suffix:semicolon
id|st-&gt;l2
dot
id|l2l3
c_func
(paren
id|st
comma
id|DL_FLUSH
op_or
id|INDICATION
comma
l_int|NULL
)paren
suffix:semicolon
)brace
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
op_logical_neg
id|rsp
op_logical_and
id|PollFlag
)paren
id|enquiry_response
c_func
(paren
id|st
)paren
suffix:semicolon
r_if
c_cond
(paren
id|legalnr
c_func
(paren
id|st
comma
id|nr
)paren
)paren
(brace
id|setva
c_func
(paren
id|st
comma
id|nr
)paren
suffix:semicolon
)brace
)brace
)brace
r_static
r_void
DECL|function|l2_got_FRMR
id|l2_got_FRMR
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|skb_pull
c_func
(paren
id|skb
comma
id|l2addrsize
c_func
(paren
op_amp
id|st-&gt;l2
)paren
op_plus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_MOD128
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
(brace
r_if
c_cond
(paren
id|skb-&gt;len
OL
l_int|5
)paren
id|st-&gt;ma
dot
id|layer
c_func
(paren
id|st
comma
id|MDL_ERROR
op_or
id|INDICATION
comma
(paren
r_void
op_star
)paren
l_char|&squot;N&squot;
)paren
suffix:semicolon
r_else
id|l2m_debug
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
l_string|&quot;FRMR information %2x %2x %2x %2x %2x&quot;
comma
id|skb-&gt;data
(braket
l_int|0
)braket
comma
id|skb-&gt;data
(braket
l_int|1
)braket
comma
id|skb-&gt;data
(braket
l_int|2
)braket
comma
id|skb-&gt;data
(braket
l_int|3
)braket
comma
id|skb-&gt;data
(braket
l_int|4
)braket
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|skb-&gt;len
OL
l_int|3
)paren
id|st-&gt;ma
dot
id|layer
c_func
(paren
id|st
comma
id|MDL_ERROR
op_or
id|INDICATION
comma
(paren
r_void
op_star
)paren
l_char|&squot;N&squot;
)paren
suffix:semicolon
r_else
id|l2m_debug
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
l_string|&quot;FRMR information %2x %2x %2x&quot;
comma
id|skb-&gt;data
(braket
l_int|0
)braket
comma
id|skb-&gt;data
(braket
l_int|1
)braket
comma
id|skb-&gt;data
(braket
l_int|2
)braket
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb-&gt;data
(braket
l_int|0
)braket
op_amp
l_int|1
)paren
op_logical_or
(paren
(paren
id|skb-&gt;data
(braket
l_int|0
)braket
op_amp
l_int|3
)paren
op_eq
l_int|1
)paren
op_logical_or
multiline_comment|/* I or S */
(paren
id|IsUA
c_func
(paren
id|skb-&gt;data
comma
l_int|0
)paren
op_logical_and
(paren
id|fi-&gt;state
op_eq
id|ST_L2_7
)paren
)paren
)paren
(brace
id|st-&gt;ma
dot
id|layer
c_func
(paren
id|st
comma
id|MDL_ERROR
op_or
id|INDICATION
comma
(paren
r_void
op_star
)paren
l_char|&squot;K&squot;
)paren
suffix:semicolon
id|establishlink
c_func
(paren
id|fi
)paren
suffix:semicolon
id|test_and_clear_bit
c_func
(paren
id|FLG_L3_INIT
comma
op_amp
id|st-&gt;l2.flag
)paren
suffix:semicolon
)brace
id|FreeSkb
c_func
(paren
id|skb
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l2_tei_remove
id|l2_tei_remove
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|discard_queue
c_func
(paren
op_amp
id|st-&gt;l2.i_queue
)paren
suffix:semicolon
id|discard_queue
c_func
(paren
op_amp
id|st-&gt;l2.ui_queue
)paren
suffix:semicolon
id|st-&gt;l2.tei
op_assign
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_T200_RUN
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200
comma
l_int|18
)paren
suffix:semicolon
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t203
comma
l_int|19
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fi-&gt;state
op_ne
id|ST_L2_4
)paren
id|st-&gt;l2
dot
id|l2l3
c_func
(paren
id|st
comma
id|DL_RELEASE
op_or
id|INDICATION
comma
l_int|NULL
)paren
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_1
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l2_persistant_da
id|l2_persistant_da
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_int
id|event
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
r_int
id|rel
op_assign
id|DL_RELEASE
op_or
id|INDICATION
suffix:semicolon
id|discard_queue
c_func
(paren
op_amp
id|st-&gt;l2.i_queue
)paren
suffix:semicolon
id|discard_queue
c_func
(paren
op_amp
id|st-&gt;l2.ui_queue
)paren
suffix:semicolon
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_T200_RUN
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200
comma
l_int|18
)paren
suffix:semicolon
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t203
comma
l_int|19
)paren
suffix:semicolon
id|clear_exception
c_func
(paren
op_amp
id|st-&gt;l2
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|fi-&gt;state
)paren
(brace
r_case
id|ST_L2_1
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|test_and_clear_bit
c_func
(paren
id|FLG_ESTAB_PEND
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
r_break
suffix:semicolon
r_case
id|ST_L2_3
suffix:colon
id|st-&gt;l2
dot
id|l2l3
c_func
(paren
id|st
comma
id|DL_RELEASE
op_or
id|INDICATION
comma
l_int|NULL
)paren
suffix:semicolon
r_case
id|ST_L2_2
suffix:colon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_1
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ST_L2_6
suffix:colon
id|rel
op_assign
id|DL_RELEASE
op_or
id|CONFIRM
suffix:semicolon
r_case
id|ST_L2_5
suffix:colon
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_PEND_REL
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
id|rel
op_assign
id|DL_RELEASE
op_or
id|CONFIRM
suffix:semicolon
r_case
id|ST_L2_7
suffix:colon
r_case
id|ST_L2_8
suffix:colon
id|st-&gt;l2
dot
id|l2l3
c_func
(paren
id|st
comma
id|rel
comma
l_int|NULL
)paren
suffix:semicolon
id|FsmChangeState
c_func
(paren
id|fi
comma
id|ST_L2_4
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ST_L2_4
suffix:colon
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_ESTAB_PEND
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
id|st-&gt;l2
dot
id|l2l3
c_func
(paren
id|st
comma
id|DL_RELEASE
op_or
id|INDICATION
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|test_and_clear_bit
c_func
(paren
id|FLG_PEND_REL
comma
op_amp
id|st-&gt;l2.flag
)paren
suffix:semicolon
id|test_and_clear_bit
c_func
(paren
id|FLG_L1_ACTIV
comma
op_amp
id|st-&gt;l2.flag
)paren
suffix:semicolon
)brace
DECL|variable|HISAX_INITDATA
r_static
r_struct
id|FsmNode
id|L2FnList
(braket
)braket
id|HISAX_INITDATA
op_assign
(brace
(brace
id|ST_L2_1
comma
id|EV_L2_DL_ESTABLISH
comma
id|l2_dl_establish
)brace
comma
(brace
id|ST_L2_2
comma
id|EV_L2_DL_ESTABLISH
comma
id|l2_dl_establish
)brace
comma
(brace
id|ST_L2_4
comma
id|EV_L2_DL_ESTABLISH
comma
id|l2_establish
)brace
comma
(brace
id|ST_L2_5
comma
id|EV_L2_DL_ESTABLISH
comma
id|l2_establish
)brace
comma
(brace
id|ST_L2_7
comma
id|EV_L2_DL_ESTABLISH
comma
id|l2_establish
)brace
comma
(brace
id|ST_L2_8
comma
id|EV_L2_DL_ESTABLISH
comma
id|l2_establish
)brace
comma
(brace
id|ST_L2_4
comma
id|EV_L2_DL_RELEASE
comma
id|l2_dl_release
)brace
comma
(brace
id|ST_L2_5
comma
id|EV_L2_DL_RELEASE
comma
id|l2_dl_release
)brace
comma
(brace
id|ST_L2_7
comma
id|EV_L2_DL_RELEASE
comma
id|l2_dl_release
)brace
comma
(brace
id|ST_L2_8
comma
id|EV_L2_DL_RELEASE
comma
id|l2_dl_release
)brace
comma
(brace
id|ST_L2_5
comma
id|EV_L2_DL_DATA
comma
id|l2_feed_iqueue
)brace
comma
(brace
id|ST_L2_7
comma
id|EV_L2_DL_DATA
comma
id|l2_feed_iqueue
)brace
comma
(brace
id|ST_L2_8
comma
id|EV_L2_DL_DATA
comma
id|l2_feed_iqueue
)brace
comma
(brace
id|ST_L2_1
comma
id|EV_L2_DL_UNIT_DATA
comma
id|l2_put_ui
)brace
comma
(brace
id|ST_L2_2
comma
id|EV_L2_DL_UNIT_DATA
comma
id|l2_put_ui
)brace
comma
(brace
id|ST_L2_3
comma
id|EV_L2_DL_UNIT_DATA
comma
id|l2_put_ui
)brace
comma
(brace
id|ST_L2_4
comma
id|EV_L2_DL_UNIT_DATA
comma
id|l2_put_ui
)brace
comma
(brace
id|ST_L2_5
comma
id|EV_L2_DL_UNIT_DATA
comma
id|l2_put_ui
)brace
comma
(brace
id|ST_L2_6
comma
id|EV_L2_DL_UNIT_DATA
comma
id|l2_put_ui
)brace
comma
(brace
id|ST_L2_7
comma
id|EV_L2_DL_UNIT_DATA
comma
id|l2_put_ui
)brace
comma
(brace
id|ST_L2_8
comma
id|EV_L2_DL_UNIT_DATA
comma
id|l2_put_ui
)brace
comma
(brace
id|ST_L2_1
comma
id|EV_L2_MDL_ASSIGN
comma
id|l2_got_tei
)brace
comma
(brace
id|ST_L2_2
comma
id|EV_L2_MDL_ASSIGN
comma
id|l2_got_tei
)brace
comma
(brace
id|ST_L2_3
comma
id|EV_L2_MDL_ASSIGN
comma
id|l2_got_tei
)brace
comma
(brace
id|ST_L2_2
comma
id|EV_L2_MDL_ERROR
comma
id|l2_tei_remove
)brace
comma
(brace
id|ST_L2_3
comma
id|EV_L2_MDL_ERROR
comma
id|l2_tei_remove
)brace
comma
(brace
id|ST_L2_4
comma
id|EV_L2_MDL_REMOVE
comma
id|l2_tei_remove
)brace
comma
(brace
id|ST_L2_5
comma
id|EV_L2_MDL_REMOVE
comma
id|l2_tei_remove
)brace
comma
(brace
id|ST_L2_6
comma
id|EV_L2_MDL_REMOVE
comma
id|l2_tei_remove
)brace
comma
(brace
id|ST_L2_7
comma
id|EV_L2_MDL_REMOVE
comma
id|l2_tei_remove
)brace
comma
(brace
id|ST_L2_8
comma
id|EV_L2_MDL_REMOVE
comma
id|l2_tei_remove
)brace
comma
(brace
id|ST_L2_4
comma
id|EV_L2_SABMX
comma
id|l2_got_SABMX
)brace
comma
(brace
id|ST_L2_5
comma
id|EV_L2_SABMX
comma
id|l2_got_SABMX
)brace
comma
(brace
id|ST_L2_6
comma
id|EV_L2_SABMX
comma
id|l2_got_SABMX
)brace
comma
(brace
id|ST_L2_7
comma
id|EV_L2_SABMX
comma
id|l2_got_SABMX
)brace
comma
(brace
id|ST_L2_8
comma
id|EV_L2_SABMX
comma
id|l2_got_SABMX
)brace
comma
(brace
id|ST_L2_4
comma
id|EV_L2_DISC
comma
id|l2_got_disconn
)brace
comma
(brace
id|ST_L2_5
comma
id|EV_L2_DISC
comma
id|l2_got_disconn
)brace
comma
(brace
id|ST_L2_6
comma
id|EV_L2_DISC
comma
id|l2_got_disconn
)brace
comma
(brace
id|ST_L2_7
comma
id|EV_L2_DISC
comma
id|l2_got_disconn
)brace
comma
(brace
id|ST_L2_8
comma
id|EV_L2_DISC
comma
id|l2_got_disconn
)brace
comma
(brace
id|ST_L2_4
comma
id|EV_L2_UA
comma
id|l2_mdl_error
)brace
comma
(brace
id|ST_L2_5
comma
id|EV_L2_UA
comma
id|l2_got_ua
)brace
comma
(brace
id|ST_L2_6
comma
id|EV_L2_UA
comma
id|l2_got_ua
)brace
comma
(brace
id|ST_L2_7
comma
id|EV_L2_UA
comma
id|l2_mdl_error
)brace
comma
(brace
id|ST_L2_8
comma
id|EV_L2_UA
comma
id|l2_mdl_error
)brace
comma
(brace
id|ST_L2_4
comma
id|EV_L2_DM
comma
id|l2_got_dm
)brace
comma
(brace
id|ST_L2_5
comma
id|EV_L2_DM
comma
id|l2_got_dm
)brace
comma
(brace
id|ST_L2_6
comma
id|EV_L2_DM
comma
id|l2_got_dm
)brace
comma
(brace
id|ST_L2_7
comma
id|EV_L2_DM
comma
id|l2_got_dm
)brace
comma
(brace
id|ST_L2_8
comma
id|EV_L2_DM
comma
id|l2_got_dm
)brace
comma
(brace
id|ST_L2_1
comma
id|EV_L2_UI
comma
id|l2_got_ui
)brace
comma
(brace
id|ST_L2_2
comma
id|EV_L2_UI
comma
id|l2_got_ui
)brace
comma
(brace
id|ST_L2_3
comma
id|EV_L2_UI
comma
id|l2_got_ui
)brace
comma
(brace
id|ST_L2_4
comma
id|EV_L2_UI
comma
id|l2_got_ui
)brace
comma
(brace
id|ST_L2_5
comma
id|EV_L2_UI
comma
id|l2_got_ui
)brace
comma
(brace
id|ST_L2_6
comma
id|EV_L2_UI
comma
id|l2_got_ui
)brace
comma
(brace
id|ST_L2_7
comma
id|EV_L2_UI
comma
id|l2_got_ui
)brace
comma
(brace
id|ST_L2_8
comma
id|EV_L2_UI
comma
id|l2_got_ui
)brace
comma
(brace
id|ST_L2_7
comma
id|EV_L2_FRMR
comma
id|l2_got_FRMR
)brace
comma
(brace
id|ST_L2_8
comma
id|EV_L2_FRMR
comma
id|l2_got_FRMR
)brace
comma
(brace
id|ST_L2_7
comma
id|EV_L2_SUPER
comma
id|l2_got_st7_super
)brace
comma
(brace
id|ST_L2_8
comma
id|EV_L2_SUPER
comma
id|l2_got_st8_super
)brace
comma
(brace
id|ST_L2_7
comma
id|EV_L2_I
comma
id|l2_got_iframe
)brace
comma
(brace
id|ST_L2_8
comma
id|EV_L2_I
comma
id|l2_got_iframe
)brace
comma
(brace
id|ST_L2_5
comma
id|EV_L2_T200
comma
id|l2_st5_tout_200
)brace
comma
(brace
id|ST_L2_6
comma
id|EV_L2_T200
comma
id|l2_st6_tout_200
)brace
comma
(brace
id|ST_L2_7
comma
id|EV_L2_T200
comma
id|l2_st78_tout_200
)brace
comma
(brace
id|ST_L2_8
comma
id|EV_L2_T200
comma
id|l2_st78_tout_200
)brace
comma
(brace
id|ST_L2_7
comma
id|EV_L2_T203
comma
id|l2_st7_tout_203
)brace
comma
(brace
id|ST_L2_7
comma
id|EV_L2_ACK_PULL
comma
id|l2_pull_iqueue
)brace
comma
(brace
id|ST_L2_1
comma
id|EV_L1_DEACTIVATE
comma
id|l2_persistant_da
)brace
comma
(brace
id|ST_L2_2
comma
id|EV_L1_DEACTIVATE
comma
id|l2_persistant_da
)brace
comma
(brace
id|ST_L2_3
comma
id|EV_L1_DEACTIVATE
comma
id|l2_persistant_da
)brace
comma
(brace
id|ST_L2_4
comma
id|EV_L1_DEACTIVATE
comma
id|l2_persistant_da
)brace
comma
(brace
id|ST_L2_5
comma
id|EV_L1_DEACTIVATE
comma
id|l2_persistant_da
)brace
comma
(brace
id|ST_L2_6
comma
id|EV_L1_DEACTIVATE
comma
id|l2_persistant_da
)brace
comma
(brace
id|ST_L2_7
comma
id|EV_L1_DEACTIVATE
comma
id|l2_persistant_da
)brace
comma
(brace
id|ST_L2_8
comma
id|EV_L1_DEACTIVATE
comma
id|l2_persistant_da
)brace
comma
)brace
suffix:semicolon
DECL|macro|L2_FN_COUNT
mdefine_line|#define L2_FN_COUNT (sizeof(L2FnList)/sizeof(struct FsmNode))
r_static
r_void
DECL|function|isdnl2_l1l2
id|isdnl2_l1l2
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|u_char
op_star
id|datap
suffix:semicolon
r_int
id|ret
op_assign
l_int|1
comma
id|len
suffix:semicolon
r_switch
c_cond
(paren
id|pr
)paren
(brace
r_case
(paren
id|PH_DATA
op_or
id|INDICATION
)paren
suffix:colon
id|datap
op_assign
id|skb-&gt;data
suffix:semicolon
id|len
op_assign
id|l2addrsize
c_func
(paren
op_amp
id|st-&gt;l2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb-&gt;len
OG
id|len
)paren
id|datap
op_add_assign
id|len
suffix:semicolon
r_else
(brace
id|st-&gt;ma
dot
id|layer
c_func
(paren
id|st
comma
id|MDL_ERROR
op_or
id|INDICATION
comma
(paren
r_void
op_star
)paren
l_char|&squot;N&squot;
)paren
suffix:semicolon
id|FreeSkb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
op_star
id|datap
op_amp
l_int|1
)paren
)paren
multiline_comment|/* I-Frame */
id|ret
op_assign
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_I
comma
id|skb
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|IsSFrame
c_func
(paren
id|datap
comma
id|test_bit
c_func
(paren
id|FLG_MOD128
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
)paren
id|ret
op_assign
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_SUPER
comma
id|skb
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|IsUI
c_func
(paren
id|datap
comma
id|test_bit
c_func
(paren
id|FLG_MOD128
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
)paren
id|ret
op_assign
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_UI
comma
id|skb
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|IsSABMX
c_func
(paren
id|datap
comma
id|test_bit
c_func
(paren
id|FLG_MOD128
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
)paren
id|ret
op_assign
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_SABMX
comma
id|skb
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|IsUA
c_func
(paren
id|datap
comma
id|test_bit
c_func
(paren
id|FLG_MOD128
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
)paren
id|ret
op_assign
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_UA
comma
id|skb
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|IsDISC
c_func
(paren
id|datap
comma
id|test_bit
c_func
(paren
id|FLG_MOD128
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
)paren
id|ret
op_assign
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_DISC
comma
id|skb
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|IsDM
c_func
(paren
id|datap
comma
id|test_bit
c_func
(paren
id|FLG_MOD128
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
)paren
id|ret
op_assign
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_DM
comma
id|skb
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|IsFRMR
c_func
(paren
id|datap
comma
id|test_bit
c_func
(paren
id|FLG_MOD128
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
)paren
id|ret
op_assign
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_FRMR
comma
id|skb
)paren
suffix:semicolon
r_else
(brace
id|ret
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
(paren
id|st-&gt;l2.l2m.state
op_eq
id|ST_L2_7
)paren
op_logical_or
(paren
id|st-&gt;l2.l2m.state
op_eq
id|ST_L2_8
)paren
)paren
id|establishlink
c_func
(paren
op_amp
id|st-&gt;l2.l2m
)paren
suffix:semicolon
id|st-&gt;ma
dot
id|layer
c_func
(paren
id|st
comma
id|MDL_ERROR
op_or
id|INDICATION
comma
(paren
r_void
op_star
)paren
l_char|&squot;L&squot;
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ret
)paren
(brace
id|FreeSkb
c_func
(paren
id|skb
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
(paren
id|PH_PULL
op_or
id|CONFIRM
)paren
suffix:colon
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_ACK_PULL
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|PH_PAUSE
op_or
id|INDICATION
)paren
suffix:colon
id|test_and_set_bit
c_func
(paren
id|FLG_DCHAN_BUSY
comma
op_amp
id|st-&gt;l2.flag
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|PH_PAUSE
op_or
id|CONFIRM
)paren
suffix:colon
id|test_and_clear_bit
c_func
(paren
id|FLG_DCHAN_BUSY
comma
op_amp
id|st-&gt;l2.flag
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|PH_ACTIVATE
op_or
id|CONFIRM
)paren
suffix:colon
r_case
(paren
id|PH_ACTIVATE
op_or
id|INDICATION
)paren
suffix:colon
id|test_and_set_bit
c_func
(paren
id|FLG_L1_ACTIV
comma
op_amp
id|st-&gt;l2.flag
)paren
suffix:semicolon
r_if
c_cond
(paren
id|test_and_clear_bit
c_func
(paren
id|FLG_ESTAB_PEND
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_DL_ESTABLISH
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|PH_DEACTIVATE
op_or
id|INDICATION
)paren
suffix:colon
r_case
(paren
id|PH_DEACTIVATE
op_or
id|CONFIRM
)paren
suffix:colon
id|test_and_clear_bit
c_func
(paren
id|FLG_L1_ACTIV
comma
op_amp
id|st-&gt;l2.flag
)paren
suffix:semicolon
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L1_DEACTIVATE
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|l2m_debug
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
l_string|&quot;l2 unknown pr %04x&quot;
comma
id|pr
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|isdnl2_l3l2
id|isdnl2_l3l2
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_switch
c_cond
(paren
id|pr
)paren
(brace
r_case
(paren
id|DL_DATA
op_or
id|REQUEST
)paren
suffix:colon
r_if
c_cond
(paren
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_DL_DATA
comma
id|arg
)paren
)paren
(brace
id|dev_kfree_skb
c_func
(paren
(paren
r_struct
id|sk_buff
op_star
)paren
id|arg
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
(paren
id|DL_UNIT_DATA
op_or
id|REQUEST
)paren
suffix:colon
r_if
c_cond
(paren
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_DL_UNIT_DATA
comma
id|arg
)paren
)paren
(brace
id|dev_kfree_skb
c_func
(paren
(paren
r_struct
id|sk_buff
op_star
)paren
id|arg
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
(paren
id|DL_ESTABLISH
op_or
id|REQUEST
)paren
suffix:colon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_L1_ACTIV
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
(brace
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_LAPD
comma
op_amp
id|st-&gt;l2.flag
)paren
op_logical_or
id|test_bit
c_func
(paren
id|FLG_ORIG
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
(brace
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_DL_ESTABLISH
comma
id|arg
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_LAPD
comma
op_amp
id|st-&gt;l2.flag
)paren
op_logical_or
id|test_bit
c_func
(paren
id|FLG_ORIG
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
(brace
id|test_and_set_bit
c_func
(paren
id|FLG_ESTAB_PEND
comma
op_amp
id|st-&gt;l2.flag
)paren
suffix:semicolon
)brace
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_ACTIVATE
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
(paren
id|DL_RELEASE
op_or
id|REQUEST
)paren
suffix:colon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_LAPB
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
(brace
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_DEACTIVATE
comma
l_int|NULL
)paren
suffix:semicolon
)brace
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_DL_RELEASE
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|DL_FLUSH
op_or
id|REQUEST
)paren
suffix:colon
(paren
op_amp
id|st-&gt;l2.l2m
)paren
op_member_access_from_pointer
id|userint
op_or_assign
id|LC_FLUSH_WAIT
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|MDL_ASSIGN
op_or
id|REQUEST
)paren
suffix:colon
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_MDL_ASSIGN
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|MDL_REMOVE
op_or
id|REQUEST
)paren
suffix:colon
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_MDL_REMOVE
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|MDL_ERROR
op_or
id|RESPONSE
)paren
suffix:colon
id|FsmEvent
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
id|EV_L2_MDL_ERROR
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_void
DECL|function|releasestack_isdnl2
id|releasestack_isdnl2
c_func
(paren
r_struct
id|PStack
op_star
id|st
)paren
(brace
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t200
comma
l_int|15
)paren
suffix:semicolon
id|FsmDelTimer
c_func
(paren
op_amp
id|st-&gt;l2.t203
comma
l_int|16
)paren
suffix:semicolon
id|discard_queue
c_func
(paren
op_amp
id|st-&gt;l2.i_queue
)paren
suffix:semicolon
id|discard_queue
c_func
(paren
op_amp
id|st-&gt;l2.ui_queue
)paren
suffix:semicolon
id|ReleaseWin
c_func
(paren
op_amp
id|st-&gt;l2
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l2m_debug
id|l2m_debug
c_func
(paren
r_struct
id|FsmInst
op_star
id|fi
comma
r_char
op_star
id|fmt
comma
dot
dot
dot
)paren
(brace
id|va_list
id|args
suffix:semicolon
r_struct
id|PStack
op_star
id|st
op_assign
id|fi-&gt;userdata
suffix:semicolon
id|va_start
c_func
(paren
id|args
comma
id|fmt
)paren
suffix:semicolon
id|VHiSax_putstatus
c_func
(paren
id|st-&gt;l1.hardware
comma
id|st-&gt;l2.debug_id
comma
id|fmt
comma
id|args
)paren
suffix:semicolon
id|va_end
c_func
(paren
id|args
)paren
suffix:semicolon
)brace
r_void
DECL|function|setstack_isdnl2
id|setstack_isdnl2
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_char
op_star
id|debug_id
)paren
(brace
id|st-&gt;l1.l1l2
op_assign
id|isdnl2_l1l2
suffix:semicolon
id|st-&gt;l3.l3l2
op_assign
id|isdnl2_l3l2
suffix:semicolon
id|skb_queue_head_init
c_func
(paren
op_amp
id|st-&gt;l2.i_queue
)paren
suffix:semicolon
id|skb_queue_head_init
c_func
(paren
op_amp
id|st-&gt;l2.ui_queue
)paren
suffix:semicolon
id|InitWin
c_func
(paren
op_amp
id|st-&gt;l2
)paren
suffix:semicolon
id|st-&gt;l2.debug
op_assign
l_int|0
suffix:semicolon
id|st-&gt;l2.l2m.fsm
op_assign
op_amp
id|l2fsm
suffix:semicolon
r_if
c_cond
(paren
id|test_bit
c_func
(paren
id|FLG_LAPB
comma
op_amp
id|st-&gt;l2.flag
)paren
)paren
id|st-&gt;l2.l2m.state
op_assign
id|ST_L2_4
suffix:semicolon
r_else
id|st-&gt;l2.l2m.state
op_assign
id|ST_L2_1
suffix:semicolon
id|st-&gt;l2.l2m.debug
op_assign
l_int|0
suffix:semicolon
id|st-&gt;l2.l2m.userdata
op_assign
id|st
suffix:semicolon
id|st-&gt;l2.l2m.userint
op_assign
l_int|0
suffix:semicolon
id|st-&gt;l2.l2m.printdebug
op_assign
id|l2m_debug
suffix:semicolon
id|strcpy
c_func
(paren
id|st-&gt;l2.debug_id
comma
id|debug_id
)paren
suffix:semicolon
id|FsmInitTimer
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
op_amp
id|st-&gt;l2.t200
)paren
suffix:semicolon
id|FsmInitTimer
c_func
(paren
op_amp
id|st-&gt;l2.l2m
comma
op_amp
id|st-&gt;l2.t203
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|transl2_l3l2
id|transl2_l3l2
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_switch
c_cond
(paren
id|pr
)paren
(brace
r_case
(paren
id|DL_DATA
op_or
id|REQUEST
)paren
suffix:colon
r_case
(paren
id|DL_UNIT_DATA
op_or
id|REQUEST
)paren
suffix:colon
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_DATA
op_or
id|REQUEST
comma
id|arg
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|DL_ESTABLISH
op_or
id|REQUEST
)paren
suffix:colon
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_ACTIVATE
op_or
id|REQUEST
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|DL_RELEASE
op_or
id|REQUEST
)paren
suffix:colon
id|st-&gt;l2
dot
id|l2l1
c_func
(paren
id|st
comma
id|PH_DEACTIVATE
op_or
id|REQUEST
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_void
DECL|function|setstack_transl2
id|setstack_transl2
c_func
(paren
r_struct
id|PStack
op_star
id|st
)paren
(brace
id|st-&gt;l3.l3l2
op_assign
id|transl2_l3l2
suffix:semicolon
)brace
r_void
DECL|function|releasestack_transl2
id|releasestack_transl2
c_func
(paren
r_struct
id|PStack
op_star
id|st
)paren
(brace
)brace
DECL|function|HISAX_INITFUNC
id|HISAX_INITFUNC
c_func
(paren
r_void
id|Isdnl2New
c_func
(paren
r_void
)paren
)paren
(brace
id|l2fsm.state_count
op_assign
id|L2_STATE_COUNT
suffix:semicolon
id|l2fsm.event_count
op_assign
id|L2_EVENT_COUNT
suffix:semicolon
id|l2fsm.strEvent
op_assign
id|strL2Event
suffix:semicolon
id|l2fsm.strState
op_assign
id|strL2State
suffix:semicolon
id|FsmNew
c_func
(paren
op_amp
id|l2fsm
comma
id|L2FnList
comma
id|L2_FN_COUNT
)paren
suffix:semicolon
)brace
r_void
DECL|function|Isdnl2Free
id|Isdnl2Free
c_func
(paren
r_void
)paren
(brace
id|FsmFree
c_func
(paren
op_amp
id|l2fsm
)paren
suffix:semicolon
)brace
eof
