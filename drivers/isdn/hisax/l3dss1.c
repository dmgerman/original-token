multiline_comment|/* $Id: l3dss1.c,v 2.7 1998/02/12 23:08:01 keil Exp $&n;&n; * EURO/DSS1 D-channel protocol&n; *&n; * Author       Karsten Keil (keil@temic-ech.spacenet.de)&n; *              based on the teles driver from Jan den Ouden&n; *&n; * Thanks to    Jan den Ouden&n; *              Fritz Elfert&n; *&n; * $Log: l3dss1.c,v $&n; * Revision 2.7  1998/02/12 23:08:01  keil&n; * change for 2.1.86 (removing FREE_READ/FREE_WRITE from [dev]_kfree_skb()&n; *&n; * Revision 2.6  1998/02/03 23:26:35  keil&n; * V110 extensions from Thomas Pfeiffer&n; *&n; * Revision 2.5  1998/02/02 13:34:28  keil&n; * Support australian Microlink net and german AOCD&n; *&n; * Revision 2.4  1997/11/06 17:12:25  keil&n; * KERN_NOTICE --&gt; KERN_INFO&n; *&n; * Revision 2.3  1997/10/29 19:03:01  keil&n; * changes for 2.1&n; *&n; * Revision 2.2  1997/08/07 17:44:36  keil&n; * Fix RESTART&n; *&n; * Revision 2.1  1997/08/03 14:36:33  keil&n; * Implement RESTART procedure&n; *&n; * Revision 2.0  1997/07/27 21:15:43  keil&n; * New Callref based layer3&n; *&n; * Revision 1.17  1997/06/26 11:11:46  keil&n; * SET_SKBFREE now on creation of a SKB&n; *&n; * Revision 1.15  1997/04/17 11:50:48  keil&n; * pa-&gt;loc was undefined, if it was not send by the exchange&n; *&n; * Old log removed /KKe&n; *&n; */
DECL|macro|__NO_VERSION__
mdefine_line|#define __NO_VERSION__
macro_line|#include &quot;hisax.h&quot;
macro_line|#include &quot;isdnl3.h&quot;
macro_line|#include &quot;l3dss1.h&quot;
macro_line|#include &lt;linux/ctype.h&gt;
r_extern
r_char
op_star
id|HiSax_getrev
c_func
(paren
r_const
r_char
op_star
id|revision
)paren
suffix:semicolon
DECL|variable|dss1_revision
r_const
r_char
op_star
id|dss1_revision
op_assign
l_string|&quot;$Revision: 2.7 $&quot;
suffix:semicolon
DECL|macro|EXT_BEARER_CAPS
mdefine_line|#define EXT_BEARER_CAPS 1
DECL|macro|MsgHead
mdefine_line|#define&t;MsgHead(ptr, cref, mty) &bslash;&n;&t;*ptr++ = 0x8; &bslash;&n;&t;*ptr++ = 0x1; &bslash;&n;&t;*ptr++ = cref^0x80; &bslash;&n;&t;*ptr++ = mty
macro_line|#ifdef HISAX_DE_AOC
r_static
r_void
DECL|function|l3dss1_parse_facility
id|l3dss1_parse_facility
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
op_star
id|p
)paren
(brace
r_int
id|qd_len
op_assign
l_int|0
suffix:semicolon
r_char
id|tmp
(braket
l_int|32
)braket
suffix:semicolon
id|p
op_increment
suffix:semicolon
id|qd_len
op_assign
op_star
id|p
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|qd_len
op_eq
l_int|0
)paren
(brace
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;qd_len == 0&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
op_star
id|p
op_amp
l_int|0x1F
)paren
op_ne
l_int|0x11
)paren
(brace
multiline_comment|/* Service discriminator, supplementary service */
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;supplementary service != 0x11&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_while
c_loop
(paren
id|qd_len
OG
l_int|0
op_logical_and
op_logical_neg
(paren
op_star
id|p
op_amp
l_int|0x80
)paren
)paren
(brace
multiline_comment|/* extension ? */
id|p
op_increment
suffix:semicolon
id|qd_len
op_decrement
suffix:semicolon
)brace
r_if
c_cond
(paren
id|qd_len
OL
l_int|2
)paren
(brace
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;qd_len &lt; 2&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|p
op_increment
suffix:semicolon
id|qd_len
op_decrement
suffix:semicolon
r_if
c_cond
(paren
(paren
op_star
id|p
op_amp
l_int|0xE0
)paren
op_ne
l_int|0xA0
)paren
(brace
multiline_comment|/* class and form */
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;class and form != 0xA0&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_switch
c_cond
(paren
op_star
id|p
op_amp
l_int|0x1F
)paren
(brace
multiline_comment|/* component tag */
r_case
l_int|1
suffix:colon
multiline_comment|/* invoke */
(brace
r_int
r_char
id|nlen
comma
id|ilen
suffix:semicolon
r_int
id|ident
suffix:semicolon
id|p
op_increment
suffix:semicolon
id|qd_len
op_decrement
suffix:semicolon
r_if
c_cond
(paren
id|qd_len
OL
l_int|1
)paren
(brace
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;qd_len &lt; 1&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
op_star
id|p
op_amp
l_int|0x80
)paren
(brace
multiline_comment|/* length format */
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;*p &amp; 0x80 length format&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|nlen
op_assign
op_star
id|p
op_increment
suffix:semicolon
id|qd_len
op_decrement
suffix:semicolon
r_if
c_cond
(paren
id|qd_len
OL
id|nlen
)paren
(brace
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;qd_len &lt; nlen&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|qd_len
op_sub_assign
id|nlen
suffix:semicolon
r_if
c_cond
(paren
id|nlen
OL
l_int|2
)paren
(brace
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;nlen &lt; 2&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
op_star
id|p
op_ne
l_int|0x02
)paren
(brace
multiline_comment|/* invoke identifier tag */
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;invoke identifier tag !=0x02&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|p
op_increment
suffix:semicolon
id|nlen
op_decrement
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
op_amp
l_int|0x80
)paren
(brace
multiline_comment|/* length format */
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;*p &amp; 0x80 length format 2&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|ilen
op_assign
op_star
id|p
op_increment
suffix:semicolon
id|nlen
op_decrement
suffix:semicolon
r_if
c_cond
(paren
id|ilen
OG
id|nlen
op_logical_or
id|ilen
op_eq
l_int|0
)paren
(brace
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;ilen &gt; nlen || ilen == 0&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|nlen
op_sub_assign
id|ilen
suffix:semicolon
id|ident
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|ilen
OG
l_int|0
)paren
(brace
id|ident
op_assign
(paren
id|ident
op_lshift
l_int|8
)paren
op_or
(paren
op_star
id|p
op_increment
op_amp
l_int|0xFF
)paren
suffix:semicolon
multiline_comment|/* invoke identifier */
id|ilen
op_decrement
suffix:semicolon
)brace
r_if
c_cond
(paren
id|nlen
OL
l_int|2
)paren
(brace
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;nlen &lt; 2 22&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
op_star
id|p
op_ne
l_int|0x02
)paren
(brace
multiline_comment|/* operation value */
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;operation value !=0x02&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|p
op_increment
suffix:semicolon
id|nlen
op_decrement
suffix:semicolon
id|ilen
op_assign
op_star
id|p
op_increment
suffix:semicolon
id|nlen
op_decrement
suffix:semicolon
r_if
c_cond
(paren
id|ilen
OG
id|nlen
op_logical_or
id|ilen
op_eq
l_int|0
)paren
(brace
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;ilen &gt; nlen || ilen == 0 22&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|nlen
op_sub_assign
id|ilen
suffix:semicolon
id|ident
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|ilen
OG
l_int|0
)paren
(brace
id|ident
op_assign
(paren
id|ident
op_lshift
l_int|8
)paren
op_or
(paren
op_star
id|p
op_increment
op_amp
l_int|0xFF
)paren
suffix:semicolon
id|ilen
op_decrement
suffix:semicolon
)brace
DECL|macro|FOO1
mdefine_line|#define FOO1(s,a,b) &bslash;&n;&t;    while(nlen &gt; 1) {&t;&t;&bslash;&n;&t;&t;    int ilen = p[1];&t;&bslash;&n;&t;&t;    if(nlen &lt; ilen+2) {&t;&bslash;&n;&t;&t;&t;    l3_debug(pc-&gt;st, &quot;FOO1  nlen &lt; ilen+2&quot;); &bslash;&n;&t;&t;&t;    return;&t;&t;&bslash;&n;&t;&t;    }&t;&t;&t;&bslash;&n;&t;&t;    nlen -= ilen+2;&t;&t;&bslash;&n;&t;&t;    if((*p &amp; 0xFF) == (a)) {&t;&bslash;&n;&t;&t;&t;    int nlen = ilen;&t;&bslash;&n;&t;&t;&t;    p += 2;&t;&t;&bslash;&n;&t;&t;&t;    b;&t;&t;&bslash;&n;&t;&t;    } else {&t;&t;&bslash;&n;&t;&t;&t;    p += ilen+2;&t;&bslash;&n;&t;&t;    }&t;&t;&t;&bslash;&n;&t;    }
r_switch
c_cond
(paren
id|ident
)paren
(brace
r_default
suffix:colon
r_break
suffix:semicolon
r_case
l_int|0x22
suffix:colon
multiline_comment|/* during */
id|FOO1
c_func
(paren
l_string|&quot;1A&quot;
comma
l_int|0x30
comma
id|FOO1
c_func
(paren
l_string|&quot;1C&quot;
comma
l_int|0xA1
comma
id|FOO1
c_func
(paren
l_string|&quot;1D&quot;
comma
l_int|0x30
comma
id|FOO1
c_func
(paren
l_string|&quot;1E&quot;
comma
l_int|0x02
comma
(paren
(brace
id|ident
op_assign
l_int|0
suffix:semicolon
r_while
(paren
id|ilen
OG
l_int|0
)paren
(brace
id|ident
op_assign
(paren
id|ident
op_lshift
l_int|8
)paren
op_or
op_star
id|p
op_increment
suffix:semicolon
id|ilen
op_decrement
suffix:semicolon
)brace
r_if
(paren
id|ident
OG
id|pc-&gt;para.chargeinfo
)paren
(brace
id|pc-&gt;para.chargeinfo
op_assign
id|ident
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_INFO_CHARGE
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_if
(paren
id|pc-&gt;st-&gt;l3.debug
op_amp
id|L3_DEB_CHARGE
)paren
(brace
r_if
(paren
op_star
(paren
id|p
op_plus
l_int|2
)paren
op_eq
l_int|0
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;charging info during %d&quot;
comma
id|pc-&gt;para.chargeinfo
)paren
suffix:semicolon
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
id|tmp
)paren
suffix:semicolon
)brace
r_else
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;charging info final %d&quot;
comma
id|pc-&gt;para.chargeinfo
)paren
suffix:semicolon
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
id|tmp
)paren
suffix:semicolon
)brace
)brace
)brace
)paren
)paren
)paren
)paren
)paren
r_break
suffix:semicolon
r_case
l_int|0x24
suffix:colon
multiline_comment|/* final */
id|FOO1
c_func
(paren
l_string|&quot;2A&quot;
comma
l_int|0x30
comma
id|FOO1
c_func
(paren
l_string|&quot;2B&quot;
comma
l_int|0x30
comma
id|FOO1
c_func
(paren
l_string|&quot;2C&quot;
comma
l_int|0xA1
comma
id|FOO1
c_func
(paren
l_string|&quot;2D&quot;
comma
l_int|0x30
comma
id|FOO1
c_func
(paren
l_string|&quot;2E&quot;
comma
l_int|0x02
comma
(paren
(brace
id|ident
op_assign
l_int|0
suffix:semicolon
r_while
(paren
id|ilen
OG
l_int|0
)paren
(brace
id|ident
op_assign
(paren
id|ident
op_lshift
l_int|8
)paren
op_or
op_star
id|p
op_increment
suffix:semicolon
id|ilen
op_decrement
suffix:semicolon
)brace
r_if
(paren
id|ident
OG
id|pc-&gt;para.chargeinfo
)paren
(brace
id|pc-&gt;para.chargeinfo
op_assign
id|ident
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_INFO_CHARGE
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_if
(paren
id|pc-&gt;st-&gt;l3.debug
op_amp
id|L3_DEB_CHARGE
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;charging info final %d&quot;
comma
id|pc-&gt;para.chargeinfo
)paren
suffix:semicolon
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
id|tmp
)paren
suffix:semicolon
)brace
)brace
)paren
)paren
)paren
)paren
)paren
)paren
r_break
suffix:semicolon
)brace
DECL|macro|FOO1
macro_line|#undef FOO1
)brace
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
multiline_comment|/* return result */
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;return result break&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
multiline_comment|/* return error */
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;return error break&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;default break&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
macro_line|#endif&t;
r_static
r_int
DECL|function|l3dss1_check_messagetype_validity
id|l3dss1_check_messagetype_validity
c_func
(paren
r_int
id|mt
)paren
(brace
multiline_comment|/* verify if a message type exists */
r_switch
c_cond
(paren
id|mt
)paren
(brace
r_case
id|MT_ALERTING
suffix:colon
r_case
id|MT_CALL_PROCEEDING
suffix:colon
r_case
id|MT_CONNECT
suffix:colon
r_case
id|MT_CONNECT_ACKNOWLEDGE
suffix:colon
r_case
id|MT_PROGRESS
suffix:colon
r_case
id|MT_SETUP
suffix:colon
r_case
id|MT_SETUP_ACKNOWLEDGE
suffix:colon
r_case
id|MT_RESUME
suffix:colon
r_case
id|MT_RESUME_ACKNOWLEDGE
suffix:colon
r_case
id|MT_RESUME_REJECT
suffix:colon
r_case
id|MT_SUSPEND
suffix:colon
r_case
id|MT_SUSPEND_ACKNOWLEDGE
suffix:colon
r_case
id|MT_SUSPEND_REJECT
suffix:colon
r_case
id|MT_USER_INFORMATION
suffix:colon
r_case
id|MT_DISCONNECT
suffix:colon
r_case
id|MT_RELEASE
suffix:colon
r_case
id|MT_RELEASE_COMPLETE
suffix:colon
r_case
id|MT_RESTART
suffix:colon
r_case
id|MT_RESTART_ACKNOWLEDGE
suffix:colon
r_case
id|MT_SEGMENT
suffix:colon
r_case
id|MT_CONGESTION_CONTROL
suffix:colon
r_case
id|MT_INFORMATION
suffix:colon
r_case
id|MT_FACILITY
suffix:colon
r_case
id|MT_NOTIFY
suffix:colon
r_case
id|MT_STATUS
suffix:colon
r_case
id|MT_STATUS_ENQUIRY
suffix:colon
r_return
l_int|1
suffix:semicolon
r_default
suffix:colon
r_return
l_int|0
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_message
id|l3dss1_message
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|mt
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|u_char
op_star
id|p
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|l3_alloc_skb
c_func
(paren
l_int|4
)paren
)paren
)paren
r_return
suffix:semicolon
id|p
op_assign
id|skb_put
c_func
(paren
id|skb
comma
l_int|4
)paren
suffix:semicolon
id|MsgHead
c_func
(paren
id|p
comma
id|pc-&gt;callref
comma
id|mt
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l2
c_func
(paren
id|pc-&gt;st
comma
id|DL_DATA
comma
id|skb
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_release_req
id|l3dss1_release_req
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|StopAllL3Timer
c_func
(paren
id|pc
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|19
)paren
suffix:semicolon
id|l3dss1_message
c_func
(paren
id|pc
comma
id|MT_RELEASE
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|pc-&gt;timer
comma
id|T308
comma
id|CC_T308_1
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_release_cmpl
id|l3dss1_release_cmpl
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|u_char
op_star
id|p
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_int
id|cause
op_assign
op_minus
l_int|1
suffix:semicolon
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
id|pc-&gt;para.loc
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
id|IE_CAUSE
comma
l_int|0
)paren
)paren
)paren
(brace
id|p
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
op_increment
op_eq
l_int|2
)paren
id|pc-&gt;para.loc
op_assign
op_star
id|p
op_increment
suffix:semicolon
id|cause
op_assign
op_star
id|p
op_amp
l_int|0x7f
suffix:semicolon
)brace
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|StopAllL3Timer
c_func
(paren
id|pc
)paren
suffix:semicolon
id|pc-&gt;para.cause
op_assign
id|cause
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|0
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_RELEASE_CNF
comma
l_int|NULL
)paren
suffix:semicolon
id|release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
)brace
macro_line|#ifdef EXT_BEARER_CAPS
DECL|function|EncodeASyncParams
id|u_char
op_star
id|EncodeASyncParams
c_func
(paren
id|u_char
op_star
id|p
comma
id|u_char
id|si2
)paren
(brace
singleline_comment|// 7c 06 88  90 21 42 00 bb
id|p
(braket
l_int|0
)braket
op_assign
id|p
(braket
l_int|1
)braket
op_assign
l_int|0
suffix:semicolon
id|p
(braket
l_int|2
)braket
op_assign
l_int|0x80
suffix:semicolon
r_if
c_cond
(paren
id|si2
op_amp
l_int|32
)paren
singleline_comment|// 7 data bits
id|p
(braket
l_int|2
)braket
op_add_assign
l_int|16
suffix:semicolon
r_else
singleline_comment|// 8 data bits
id|p
(braket
l_int|2
)braket
op_add_assign
l_int|24
suffix:semicolon
r_if
c_cond
(paren
id|si2
op_amp
l_int|16
)paren
singleline_comment|// 2 stop bits
id|p
(braket
l_int|2
)braket
op_add_assign
l_int|96
suffix:semicolon
r_else
singleline_comment|// 1 stop bit
id|p
(braket
l_int|2
)braket
op_assign
l_int|32
suffix:semicolon
r_if
c_cond
(paren
id|si2
op_amp
l_int|8
)paren
singleline_comment|// even parity
id|p
(braket
l_int|2
)braket
op_add_assign
l_int|2
suffix:semicolon
r_else
singleline_comment|// no parity
id|p
(braket
l_int|2
)braket
op_add_assign
l_int|3
suffix:semicolon
r_switch
c_cond
(paren
id|si2
op_amp
l_int|0x07
)paren
(brace
r_case
l_int|0
suffix:colon
id|p
(braket
l_int|0
)braket
op_assign
l_int|66
suffix:semicolon
singleline_comment|// 1200 bit/s
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|p
(braket
l_int|0
)braket
op_assign
l_int|88
suffix:semicolon
singleline_comment|// 1200/75 bit/s
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|p
(braket
l_int|0
)braket
op_assign
l_int|87
suffix:semicolon
singleline_comment|// 75/1200 bit/s
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|p
(braket
l_int|0
)braket
op_assign
l_int|67
suffix:semicolon
singleline_comment|// 2400 bit/s
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
id|p
(braket
l_int|0
)braket
op_assign
l_int|69
suffix:semicolon
singleline_comment|// 4800 bit/s
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
id|p
(braket
l_int|0
)braket
op_assign
l_int|72
suffix:semicolon
singleline_comment|// 9600 bit/s
r_break
suffix:semicolon
r_case
l_int|6
suffix:colon
id|p
(braket
l_int|0
)braket
op_assign
l_int|73
suffix:semicolon
singleline_comment|// 14400 bit/s
r_break
suffix:semicolon
r_case
l_int|7
suffix:colon
id|p
(braket
l_int|0
)braket
op_assign
l_int|75
suffix:semicolon
singleline_comment|// 19200 bit/s
r_break
suffix:semicolon
)brace
r_return
id|p
op_plus
l_int|3
suffix:semicolon
)brace
DECL|function|EncodeSyncParams
id|u_char
id|EncodeSyncParams
c_func
(paren
id|u_char
id|si2
comma
id|u_char
id|ai
)paren
(brace
r_switch
c_cond
(paren
id|si2
)paren
(brace
r_case
l_int|0
suffix:colon
r_return
id|ai
op_plus
l_int|2
suffix:semicolon
singleline_comment|// 1200 bit/s
r_case
l_int|1
suffix:colon
r_return
id|ai
op_plus
l_int|24
suffix:semicolon
singleline_comment|// 1200/75 bit/s
r_case
l_int|2
suffix:colon
r_return
id|ai
op_plus
l_int|23
suffix:semicolon
singleline_comment|// 75/1200 bit/s
r_case
l_int|3
suffix:colon
r_return
id|ai
op_plus
l_int|3
suffix:semicolon
singleline_comment|// 2400 bit/s
r_case
l_int|4
suffix:colon
r_return
id|ai
op_plus
l_int|5
suffix:semicolon
singleline_comment|// 4800 bit/s
r_case
l_int|5
suffix:colon
r_return
id|ai
op_plus
l_int|8
suffix:semicolon
singleline_comment|// 9600 bit/s
r_case
l_int|6
suffix:colon
r_return
id|ai
op_plus
l_int|9
suffix:semicolon
singleline_comment|// 14400 bit/s
r_case
l_int|7
suffix:colon
r_return
id|ai
op_plus
l_int|11
suffix:semicolon
singleline_comment|// 19200 bit/s
r_case
l_int|8
suffix:colon
r_return
id|ai
op_plus
l_int|14
suffix:semicolon
singleline_comment|// 48000 bit/s
r_case
l_int|9
suffix:colon
r_return
id|ai
op_plus
l_int|15
suffix:semicolon
singleline_comment|// 56000 bit/s
r_case
l_int|15
suffix:colon
r_return
id|ai
op_plus
l_int|40
suffix:semicolon
singleline_comment|// negotiate bit/s
r_default
suffix:colon
r_break
suffix:semicolon
)brace
r_return
id|ai
suffix:semicolon
)brace
DECL|function|DecodeASyncParams
r_static
id|u_char
id|DecodeASyncParams
c_func
(paren
id|u_char
id|si2
comma
id|u_char
op_star
id|p
)paren
(brace
id|u_char
id|info
suffix:semicolon
r_switch
c_cond
(paren
id|p
(braket
l_int|5
)braket
)paren
(brace
r_case
l_int|66
suffix:colon
singleline_comment|// 1200 bit/s
r_break
suffix:semicolon
singleline_comment|// si2 bleibt gleich
r_case
l_int|88
suffix:colon
singleline_comment|// 1200/75 bit/s
id|si2
op_add_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|87
suffix:colon
singleline_comment|// 75/1200 bit/s
id|si2
op_add_assign
l_int|2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|67
suffix:colon
singleline_comment|// 2400 bit/s
id|si2
op_add_assign
l_int|3
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|69
suffix:colon
singleline_comment|// 4800 bit/s
id|si2
op_add_assign
l_int|4
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|72
suffix:colon
singleline_comment|// 9600 bit/s
id|si2
op_add_assign
l_int|5
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|73
suffix:colon
singleline_comment|// 14400 bit/s
id|si2
op_add_assign
l_int|6
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|75
suffix:colon
singleline_comment|// 19200 bit/s
id|si2
op_add_assign
l_int|7
suffix:semicolon
r_break
suffix:semicolon
)brace
id|info
op_assign
id|p
(braket
l_int|7
)braket
op_amp
l_int|0x7f
suffix:semicolon
r_if
c_cond
(paren
(paren
id|info
op_amp
l_int|16
)paren
op_logical_and
(paren
op_logical_neg
(paren
id|info
op_amp
l_int|8
)paren
)paren
)paren
singleline_comment|// 7 data bits
id|si2
op_add_assign
l_int|32
suffix:semicolon
singleline_comment|// else 8 data bits
r_if
c_cond
(paren
(paren
id|info
op_amp
l_int|96
)paren
op_eq
l_int|96
)paren
singleline_comment|// 2 stop bits
id|si2
op_add_assign
l_int|16
suffix:semicolon
singleline_comment|// else 1 stop bit
r_if
c_cond
(paren
(paren
id|info
op_amp
l_int|2
)paren
op_logical_and
(paren
op_logical_neg
(paren
id|info
op_amp
l_int|1
)paren
)paren
)paren
singleline_comment|// even parity
id|si2
op_add_assign
l_int|8
suffix:semicolon
singleline_comment|// else no parity
r_return
id|si2
suffix:semicolon
)brace
DECL|function|DecodeSyncParams
r_static
id|u_char
id|DecodeSyncParams
c_func
(paren
id|u_char
id|si2
comma
id|u_char
id|info
)paren
(brace
id|info
op_and_assign
l_int|0x7f
suffix:semicolon
r_switch
c_cond
(paren
id|info
)paren
(brace
r_case
l_int|40
suffix:colon
singleline_comment|// bit/s aushandeln  --- hat nicht geklappt, ai wird 165 statt 175!
r_return
id|si2
op_plus
l_int|15
suffix:semicolon
r_case
l_int|15
suffix:colon
singleline_comment|// 56000 bit/s --- hat nicht geklappt, ai wird 0 statt 169 !
r_return
id|si2
op_plus
l_int|9
suffix:semicolon
r_case
l_int|14
suffix:colon
singleline_comment|// 48000 bit/s
r_return
id|si2
op_plus
l_int|8
suffix:semicolon
r_case
l_int|11
suffix:colon
singleline_comment|// 19200 bit/s
r_return
id|si2
op_plus
l_int|7
suffix:semicolon
r_case
l_int|9
suffix:colon
singleline_comment|// 14400 bit/s
r_return
id|si2
op_plus
l_int|6
suffix:semicolon
r_case
l_int|8
suffix:colon
singleline_comment|// 9600  bit/s
r_return
id|si2
op_plus
l_int|5
suffix:semicolon
r_case
l_int|5
suffix:colon
singleline_comment|// 4800  bit/s
r_return
id|si2
op_plus
l_int|4
suffix:semicolon
r_case
l_int|3
suffix:colon
singleline_comment|// 2400  bit/s
r_return
id|si2
op_plus
l_int|3
suffix:semicolon
r_case
l_int|23
suffix:colon
singleline_comment|// 75/1200 bit/s
r_return
id|si2
op_plus
l_int|2
suffix:semicolon
r_case
l_int|24
suffix:colon
singleline_comment|// 1200/75 bit/s
r_return
id|si2
op_plus
l_int|1
suffix:semicolon
r_default
suffix:colon
singleline_comment|// 1200 bit/s
r_return
id|si2
suffix:semicolon
)brace
)brace
DECL|function|DecodeSI2
r_static
id|u_char
id|DecodeSI2
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
id|u_char
op_star
id|p
suffix:semicolon
singleline_comment|//, *pend=skb-&gt;data + skb-&gt;len;
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|skb-&gt;data
comma
id|skb-&gt;len
comma
l_int|0x7c
comma
l_int|0
)paren
)paren
)paren
(brace
r_switch
c_cond
(paren
id|p
(braket
l_int|4
)braket
op_amp
l_int|0x0f
)paren
(brace
r_case
l_int|0x01
suffix:colon
r_if
c_cond
(paren
id|p
(braket
l_int|1
)braket
op_eq
l_int|0x04
)paren
singleline_comment|// sync. Bitratenadaption
r_return
id|DecodeSyncParams
c_func
(paren
l_int|160
comma
id|p
(braket
l_int|5
)braket
)paren
suffix:semicolon
singleline_comment|// V.110/X.30
r_else
r_if
c_cond
(paren
id|p
(braket
l_int|1
)braket
op_eq
l_int|0x06
)paren
singleline_comment|// async. Bitratenadaption
r_return
id|DecodeASyncParams
c_func
(paren
l_int|192
comma
id|p
)paren
suffix:semicolon
singleline_comment|// V.110/X.30
r_break
suffix:semicolon
r_case
l_int|0x08
suffix:colon
singleline_comment|// if (p[5] == 0x02) // sync. Bitratenadaption
r_return
id|DecodeSyncParams
c_func
(paren
l_int|176
comma
id|p
(braket
l_int|5
)braket
)paren
suffix:semicolon
singleline_comment|// V.120
r_break
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif
r_static
r_void
DECL|function|l3dss1_setup_req
id|l3dss1_setup_req
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|u_char
id|tmp
(braket
l_int|128
)braket
suffix:semicolon
id|u_char
op_star
id|p
op_assign
id|tmp
suffix:semicolon
id|u_char
id|channel
op_assign
l_int|0
suffix:semicolon
id|u_char
id|screen
op_assign
l_int|0x80
suffix:semicolon
id|u_char
op_star
id|teln
suffix:semicolon
id|u_char
op_star
id|msn
suffix:semicolon
id|u_char
op_star
id|sub
suffix:semicolon
id|u_char
op_star
id|sp
suffix:semicolon
r_int
id|l
suffix:semicolon
id|MsgHead
c_func
(paren
id|p
comma
id|pc-&gt;callref
comma
id|MT_SETUP
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Set Bearer Capability, Map info from 1TR6-convention to EDSS1&n;&t; */
macro_line|#ifdef HISAX_EURO_SENDCOMPLETE
op_star
id|p
op_increment
op_assign
l_int|0xa1
suffix:semicolon
multiline_comment|/* complete indicator */
macro_line|#endif
r_switch
c_cond
(paren
id|pc-&gt;para.setup.si1
)paren
(brace
r_case
l_int|1
suffix:colon
multiline_comment|/* Telephony                               */
op_star
id|p
op_increment
op_assign
l_int|0x4
suffix:semicolon
multiline_comment|/* BC-IE-code                              */
op_star
id|p
op_increment
op_assign
l_int|0x3
suffix:semicolon
multiline_comment|/* Length                                  */
op_star
id|p
op_increment
op_assign
l_int|0x90
suffix:semicolon
multiline_comment|/* Coding Std. CCITT, 3.1 kHz audio     */
op_star
id|p
op_increment
op_assign
l_int|0x90
suffix:semicolon
multiline_comment|/* Circuit-Mode 64kbps                     */
op_star
id|p
op_increment
op_assign
l_int|0xa3
suffix:semicolon
multiline_comment|/* A-Law Audio                             */
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
multiline_comment|/* Datatransmission 64k, BTX               */
r_case
l_int|7
suffix:colon
multiline_comment|/* Datatransmission 64k                    */
r_default
suffix:colon
op_star
id|p
op_increment
op_assign
l_int|0x4
suffix:semicolon
multiline_comment|/* BC-IE-code                              */
op_star
id|p
op_increment
op_assign
l_int|0x2
suffix:semicolon
multiline_comment|/* Length                                  */
op_star
id|p
op_increment
op_assign
l_int|0x88
suffix:semicolon
multiline_comment|/* Coding Std. CCITT, unrestr. dig. Inform. */
op_star
id|p
op_increment
op_assign
l_int|0x90
suffix:semicolon
multiline_comment|/* Circuit-Mode 64kbps                      */
r_break
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * What about info2? Mapping to High-Layer-Compatibility?&n;&t; */
id|teln
op_assign
id|pc-&gt;para.setup.phone
suffix:semicolon
r_if
c_cond
(paren
op_star
id|teln
)paren
(brace
multiline_comment|/* parse number for special things */
r_if
c_cond
(paren
op_logical_neg
id|isdigit
c_func
(paren
op_star
id|teln
)paren
)paren
(brace
r_switch
c_cond
(paren
l_int|0x5f
op_amp
op_star
id|teln
)paren
(brace
r_case
l_char|&squot;C&squot;
suffix:colon
id|channel
op_assign
l_int|0x08
suffix:semicolon
r_case
l_char|&squot;P&squot;
suffix:colon
id|channel
op_or_assign
l_int|0x80
suffix:semicolon
id|teln
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|teln
op_eq
l_char|&squot;1&squot;
)paren
id|channel
op_or_assign
l_int|0x01
suffix:semicolon
r_else
id|channel
op_or_assign
l_int|0x02
suffix:semicolon
r_break
suffix:semicolon
r_case
l_char|&squot;R&squot;
suffix:colon
id|screen
op_assign
l_int|0xA0
suffix:semicolon
r_break
suffix:semicolon
r_case
l_char|&squot;D&squot;
suffix:colon
id|screen
op_assign
l_int|0x80
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
(brace
)brace
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;Wrong MSN Code&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|teln
op_increment
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|channel
)paren
(brace
op_star
id|p
op_increment
op_assign
id|IE_CHANNEL_ID
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|1
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|channel
suffix:semicolon
)brace
id|msn
op_assign
id|pc-&gt;para.setup.eazmsn
suffix:semicolon
id|sub
op_assign
l_int|NULL
suffix:semicolon
id|sp
op_assign
id|msn
suffix:semicolon
r_while
c_loop
(paren
op_star
id|sp
)paren
(brace
r_if
c_cond
(paren
l_char|&squot;.&squot;
op_eq
op_star
id|sp
)paren
(brace
id|sub
op_assign
id|sp
suffix:semicolon
op_star
id|sp
op_assign
l_int|0
suffix:semicolon
)brace
r_else
id|sp
op_increment
suffix:semicolon
)brace
r_if
c_cond
(paren
op_star
id|msn
)paren
(brace
op_star
id|p
op_increment
op_assign
l_int|0x6c
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|strlen
c_func
(paren
id|msn
)paren
op_plus
(paren
id|screen
ques
c_cond
l_int|2
suffix:colon
l_int|1
)paren
suffix:semicolon
multiline_comment|/* Classify as AnyPref. */
r_if
c_cond
(paren
id|screen
)paren
(brace
op_star
id|p
op_increment
op_assign
l_int|0x01
suffix:semicolon
multiline_comment|/* Ext = &squot;0&squot;B, Type = &squot;000&squot;B, Plan = &squot;0001&squot;B. */
op_star
id|p
op_increment
op_assign
id|screen
suffix:semicolon
)brace
r_else
op_star
id|p
op_increment
op_assign
l_int|0x81
suffix:semicolon
multiline_comment|/* Ext = &squot;1&squot;B, Type = &squot;000&squot;B, Plan = &squot;0001&squot;B. */
r_while
c_loop
(paren
op_star
id|msn
)paren
op_star
id|p
op_increment
op_assign
op_star
id|msn
op_increment
op_amp
l_int|0x7f
suffix:semicolon
)brace
r_if
c_cond
(paren
id|sub
)paren
(brace
op_star
id|sub
op_increment
op_assign
l_char|&squot;.&squot;
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x6d
suffix:semicolon
multiline_comment|/* Calling party subaddress */
op_star
id|p
op_increment
op_assign
id|strlen
c_func
(paren
id|sub
)paren
op_plus
l_int|2
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x80
suffix:semicolon
multiline_comment|/* NSAP coded */
op_star
id|p
op_increment
op_assign
l_int|0x50
suffix:semicolon
multiline_comment|/* local IDI format */
r_while
c_loop
(paren
op_star
id|sub
)paren
op_star
id|p
op_increment
op_assign
op_star
id|sub
op_increment
op_amp
l_int|0x7f
suffix:semicolon
)brace
id|sub
op_assign
l_int|NULL
suffix:semicolon
id|sp
op_assign
id|teln
suffix:semicolon
r_while
c_loop
(paren
op_star
id|sp
)paren
(brace
r_if
c_cond
(paren
l_char|&squot;.&squot;
op_eq
op_star
id|sp
)paren
(brace
id|sub
op_assign
id|sp
suffix:semicolon
op_star
id|sp
op_assign
l_int|0
suffix:semicolon
)brace
r_else
id|sp
op_increment
suffix:semicolon
)brace
op_star
id|p
op_increment
op_assign
l_int|0x70
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|strlen
c_func
(paren
id|teln
)paren
op_plus
l_int|1
suffix:semicolon
multiline_comment|/* Classify as AnyPref. */
op_star
id|p
op_increment
op_assign
l_int|0x81
suffix:semicolon
multiline_comment|/* Ext = &squot;1&squot;B, Type = &squot;000&squot;B, Plan = &squot;0001&squot;B. */
r_while
c_loop
(paren
op_star
id|teln
)paren
op_star
id|p
op_increment
op_assign
op_star
id|teln
op_increment
op_amp
l_int|0x7f
suffix:semicolon
r_if
c_cond
(paren
id|sub
)paren
(brace
op_star
id|sub
op_increment
op_assign
l_char|&squot;.&squot;
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x71
suffix:semicolon
multiline_comment|/* Called party subaddress */
op_star
id|p
op_increment
op_assign
id|strlen
c_func
(paren
id|sub
)paren
op_plus
l_int|2
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x80
suffix:semicolon
multiline_comment|/* NSAP coded */
op_star
id|p
op_increment
op_assign
l_int|0x50
suffix:semicolon
multiline_comment|/* local IDI format */
r_while
c_loop
(paren
op_star
id|sub
)paren
op_star
id|p
op_increment
op_assign
op_star
id|sub
op_increment
op_amp
l_int|0x7f
suffix:semicolon
)brace
macro_line|#ifdef EXT_BEARER_CAPS
r_if
c_cond
(paren
(paren
id|pc-&gt;para.setup.si2
op_ge
l_int|160
)paren
op_logical_and
(paren
id|pc-&gt;para.setup.si2
op_le
l_int|175
)paren
)paren
(brace
singleline_comment|// sync. Bitratenadaption, V.110/X.30
op_star
id|p
op_increment
op_assign
l_int|0x7c
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x04
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x88
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x90
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x21
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|EncodeSyncParams
c_func
(paren
id|pc-&gt;para.setup.si2
op_minus
l_int|160
comma
l_int|0x80
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
id|pc-&gt;para.setup.si2
op_ge
l_int|176
)paren
op_logical_and
(paren
id|pc-&gt;para.setup.si2
op_le
l_int|191
)paren
)paren
(brace
singleline_comment|// sync. Bitratenadaption, V.120
op_star
id|p
op_increment
op_assign
l_int|0x7c
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x05
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x88
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x90
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x28
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|EncodeSyncParams
c_func
(paren
id|pc-&gt;para.setup.si2
op_minus
l_int|176
comma
l_int|0
)paren
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x82
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|pc-&gt;para.setup.si2
op_ge
l_int|192
)paren
(brace
singleline_comment|// async. Bitratenadaption, V.110/X.30
op_star
id|p
op_increment
op_assign
l_int|0x7c
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x06
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x88
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x90
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x21
suffix:semicolon
id|p
op_assign
id|EncodeASyncParams
c_func
(paren
id|p
comma
id|pc-&gt;para.setup.si2
op_minus
l_int|192
)paren
suffix:semicolon
)brace
macro_line|#endif
id|l
op_assign
id|p
op_minus
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|l3_alloc_skb
c_func
(paren
id|l
)paren
)paren
)paren
r_return
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|l
)paren
comma
id|tmp
comma
id|l
)paren
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|pc-&gt;timer
comma
id|T303
comma
id|CC_T303
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|1
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l2
c_func
(paren
id|pc-&gt;st
comma
id|DL_DATA
comma
id|skb
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_call_proc
id|l3dss1_call_proc
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|u_char
op_star
id|p
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
id|IE_CHANNEL_ID
comma
l_int|0
)paren
)paren
)paren
(brace
id|pc-&gt;para.bchannel
op_assign
id|p
(braket
l_int|2
)braket
op_amp
l_int|0x3
suffix:semicolon
r_if
c_cond
(paren
(paren
op_logical_neg
id|pc-&gt;para.bchannel
)paren
op_logical_and
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;setup answer without bchannel&quot;
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;setup answer without bchannel&quot;
)paren
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|3
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|pc-&gt;timer
comma
id|T310
comma
id|CC_T310
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_PROCEEDING_IND
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_setup_ack
id|l3dss1_setup_ack
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|u_char
op_star
id|p
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
id|IE_CHANNEL_ID
comma
l_int|0
)paren
)paren
)paren
(brace
id|pc-&gt;para.bchannel
op_assign
id|p
(braket
l_int|2
)braket
op_amp
l_int|0x3
suffix:semicolon
r_if
c_cond
(paren
(paren
op_logical_neg
id|pc-&gt;para.bchannel
)paren
op_logical_and
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;setup answer without bchannel&quot;
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;setup answer without bchannel&quot;
)paren
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|2
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|pc-&gt;timer
comma
id|T304
comma
id|CC_T304
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_MORE_INFO
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_disconnect
id|l3dss1_disconnect
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|u_char
op_star
id|p
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_int
id|cause
op_assign
op_minus
l_int|1
suffix:semicolon
id|StopAllL3Timer
c_func
(paren
id|pc
)paren
suffix:semicolon
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
id|pc-&gt;para.loc
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
id|IE_CAUSE
comma
l_int|0
)paren
)paren
)paren
(brace
id|p
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
op_increment
op_eq
l_int|2
)paren
id|pc-&gt;para.loc
op_assign
op_star
id|p
op_increment
suffix:semicolon
id|cause
op_assign
op_star
id|p
op_amp
l_int|0x7f
suffix:semicolon
)brace
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|12
)paren
suffix:semicolon
id|pc-&gt;para.cause
op_assign
id|cause
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_DISCONNECT_IND
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_connect
id|l3dss1_connect
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
multiline_comment|/* T310 */
id|newl3state
c_func
(paren
id|pc
comma
l_int|10
)paren
suffix:semicolon
id|pc-&gt;para.chargeinfo
op_assign
l_int|0
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_SETUP_CNF
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_alerting
id|l3dss1_alerting
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
multiline_comment|/* T304 */
id|newl3state
c_func
(paren
id|pc
comma
l_int|4
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_ALERTING_IND
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_msg_without_setup
id|l3dss1_msg_without_setup
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
multiline_comment|/* This routine is called if here was no SETUP made (checks in dss1up and in&n;   * l3dss1_setup) and a RELEASE_COMPLETE have to be sent with an error code&n;   * It is called after it is veryfied that Layer2 is up.&n;   * The cause value is allready in pc-&gt;para.cause&n;   * MT_STATUS_ENQUIRE in the NULL state is handled too&n;   */
id|u_char
id|tmp
(braket
l_int|16
)braket
suffix:semicolon
id|u_char
op_star
id|p
op_assign
id|tmp
suffix:semicolon
r_int
id|l
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_switch
c_cond
(paren
id|pc-&gt;para.cause
)paren
(brace
r_case
l_int|81
suffix:colon
multiline_comment|/* 0x51 invalid callreference */
r_case
l_int|96
suffix:colon
multiline_comment|/* 0x60 mandory IE missing */
r_case
l_int|101
suffix:colon
multiline_comment|/* 0x65 incompatible Callstate */
id|MsgHead
c_func
(paren
id|p
comma
id|pc-&gt;callref
comma
id|MT_RELEASE_COMPLETE
)paren
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|IE_CAUSE
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x2
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x80
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|pc-&gt;para.cause
op_or
l_int|0x80
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;HiSax internal error l3dss1_msg_without_setup&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|l
op_assign
id|p
op_minus
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|l3_alloc_skb
c_func
(paren
id|l
)paren
)paren
)paren
r_return
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|l
)paren
comma
id|tmp
comma
id|l
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l2
c_func
(paren
id|pc-&gt;st
comma
id|DL_DATA
comma
id|skb
)paren
suffix:semicolon
id|release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_setup
id|l3dss1_setup
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|u_char
op_star
id|p
comma
op_star
id|ptmp
(braket
l_int|8
)braket
suffix:semicolon
r_int
id|i
suffix:semicolon
r_int
id|bcfound
op_assign
l_int|0
suffix:semicolon
r_char
id|tmp
(braket
l_int|80
)braket
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
multiline_comment|/* ETS 300-104 1.3.4 and 1.3.5&n;&t; * we need to detect unknown inform. element from 0 to 7&n;&t; */
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|8
suffix:semicolon
id|i
op_increment
)paren
(brace
id|ptmp
(braket
id|i
)braket
op_assign
id|skb-&gt;data
suffix:semicolon
)brace
r_if
c_cond
(paren
id|findie
c_func
(paren
id|ptmp
(braket
l_int|1
)braket
comma
id|skb-&gt;len
comma
l_int|0x01
comma
l_int|0
)paren
op_logical_or
id|findie
c_func
(paren
id|ptmp
(braket
l_int|2
)braket
comma
id|skb-&gt;len
comma
l_int|0x02
comma
l_int|0
)paren
op_logical_or
id|findie
c_func
(paren
id|ptmp
(braket
l_int|3
)braket
comma
id|skb-&gt;len
comma
l_int|0x03
comma
l_int|0
)paren
op_logical_or
id|findie
c_func
(paren
id|ptmp
(braket
l_int|5
)braket
comma
id|skb-&gt;len
comma
l_int|0x05
comma
l_int|0
)paren
op_logical_or
id|findie
c_func
(paren
id|ptmp
(braket
l_int|6
)braket
comma
id|skb-&gt;len
comma
l_int|0x06
comma
l_int|0
)paren
op_logical_or
id|findie
c_func
(paren
id|ptmp
(braket
l_int|7
)braket
comma
id|skb-&gt;len
comma
l_int|0x07
comma
l_int|0
)paren
)paren
(brace
multiline_comment|/* if ie is &lt; 8 and not 0 nor 4, send RELEASE_COMPLETE &n;&t;  &t; * cause 0x60&n;&t;  &t; */
id|pc-&gt;para.cause
op_assign
l_int|0x60
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pc-&gt;state
op_eq
l_int|0
)paren
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_ESTABLISH
comma
l_int|NULL
)paren
suffix:semicolon
r_else
id|l3dss1_msg_without_setup
c_func
(paren
id|pc
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * Channel Identification&n;&t; */
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
id|IE_CHANNEL_ID
comma
l_int|0
)paren
)paren
)paren
(brace
id|pc-&gt;para.bchannel
op_assign
id|p
(braket
l_int|2
)braket
op_amp
l_int|0x3
suffix:semicolon
r_if
c_cond
(paren
id|pc-&gt;para.bchannel
)paren
id|bcfound
op_increment
suffix:semicolon
r_else
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;setup without bchannel&quot;
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;setup without bchannel&quot;
)paren
suffix:semicolon
multiline_comment|/*&n;&t;   * Bearer Capabilities&n;&t; */
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
l_int|0x04
comma
l_int|0
)paren
)paren
)paren
(brace
id|pc-&gt;para.setup.si2
op_assign
l_int|0
suffix:semicolon
r_switch
c_cond
(paren
id|p
(braket
l_int|2
)braket
op_amp
l_int|0x1f
)paren
(brace
r_case
l_int|0x00
suffix:colon
multiline_comment|/* Speech */
r_case
l_int|0x10
suffix:colon
multiline_comment|/* 3.1 Khz audio */
id|pc-&gt;para.setup.si1
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x08
suffix:colon
multiline_comment|/* Unrestricted digital information */
id|pc-&gt;para.setup.si1
op_assign
l_int|7
suffix:semicolon
multiline_comment|/* JIM, 05.11.97 I wanna set service indicator 2 */
macro_line|#ifdef EXT_BEARER_CAPS
id|pc-&gt;para.setup.si2
op_assign
id|DecodeSI2
c_func
(paren
id|skb
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;HiSax: SI=%d, AI=%d&bslash;n&quot;
comma
id|pc-&gt;para.setup.si1
comma
id|pc-&gt;para.setup.si2
)paren
suffix:semicolon
macro_line|#endif
r_break
suffix:semicolon
r_case
l_int|0x09
suffix:colon
multiline_comment|/* Restricted digital information */
id|pc-&gt;para.setup.si1
op_assign
l_int|2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x11
suffix:colon
multiline_comment|/* Unrestr. digital information  with tones/announcements */
id|pc-&gt;para.setup.si1
op_assign
l_int|3
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x18
suffix:colon
multiline_comment|/* Video */
id|pc-&gt;para.setup.si1
op_assign
l_int|4
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|pc-&gt;para.setup.si1
op_assign
l_int|0
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;setup without bearer capabilities&quot;
)paren
suffix:semicolon
multiline_comment|/* ETS 300-104 1.3.3 */
id|pc-&gt;para.cause
op_assign
l_int|0x60
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pc-&gt;state
op_eq
l_int|0
)paren
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_ESTABLISH
comma
l_int|NULL
)paren
suffix:semicolon
r_else
id|l3dss1_msg_without_setup
c_func
(paren
id|pc
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
l_int|0x70
comma
l_int|0
)paren
)paren
)paren
id|iecpy
c_func
(paren
id|pc-&gt;para.setup.eazmsn
comma
id|p
comma
l_int|1
)paren
suffix:semicolon
r_else
id|pc-&gt;para.setup.eazmsn
(braket
l_int|0
)braket
op_assign
l_int|0
suffix:semicolon
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
l_int|0x71
comma
l_int|0
)paren
)paren
)paren
(brace
multiline_comment|/* Called party subaddress */
r_if
c_cond
(paren
(paren
id|p
(braket
l_int|1
)braket
op_ge
l_int|2
)paren
op_logical_and
(paren
id|p
(braket
l_int|2
)braket
op_eq
l_int|0x80
)paren
op_logical_and
(paren
id|p
(braket
l_int|3
)braket
op_eq
l_int|0x50
)paren
)paren
(brace
id|tmp
(braket
l_int|0
)braket
op_assign
l_char|&squot;.&squot;
suffix:semicolon
id|iecpy
c_func
(paren
op_amp
id|tmp
(braket
l_int|1
)braket
comma
id|p
comma
l_int|2
)paren
suffix:semicolon
id|strcat
c_func
(paren
id|pc-&gt;para.setup.eazmsn
comma
id|tmp
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;wrong called subaddress&quot;
)paren
suffix:semicolon
)brace
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
l_int|0x6c
comma
l_int|0
)paren
)paren
)paren
(brace
id|pc-&gt;para.setup.plan
op_assign
id|p
(braket
l_int|2
)braket
suffix:semicolon
r_if
c_cond
(paren
id|p
(braket
l_int|2
)braket
op_amp
l_int|0x80
)paren
(brace
id|iecpy
c_func
(paren
id|pc-&gt;para.setup.phone
comma
id|p
comma
l_int|1
)paren
suffix:semicolon
id|pc-&gt;para.setup.screen
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|iecpy
c_func
(paren
id|pc-&gt;para.setup.phone
comma
id|p
comma
l_int|2
)paren
suffix:semicolon
id|pc-&gt;para.setup.screen
op_assign
id|p
(braket
l_int|3
)braket
suffix:semicolon
)brace
)brace
r_else
(brace
id|pc-&gt;para.setup.phone
(braket
l_int|0
)braket
op_assign
l_int|0
suffix:semicolon
id|pc-&gt;para.setup.plan
op_assign
l_int|0
suffix:semicolon
id|pc-&gt;para.setup.screen
op_assign
l_int|0
suffix:semicolon
)brace
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
l_int|0x6d
comma
l_int|0
)paren
)paren
)paren
(brace
multiline_comment|/* Calling party subaddress */
r_if
c_cond
(paren
(paren
id|p
(braket
l_int|1
)braket
op_ge
l_int|2
)paren
op_logical_and
(paren
id|p
(braket
l_int|2
)braket
op_eq
l_int|0x80
)paren
op_logical_and
(paren
id|p
(braket
l_int|3
)braket
op_eq
l_int|0x50
)paren
)paren
(brace
id|tmp
(braket
l_int|0
)braket
op_assign
l_char|&squot;.&squot;
suffix:semicolon
id|iecpy
c_func
(paren
op_amp
id|tmp
(braket
l_int|1
)braket
comma
id|p
comma
l_int|2
)paren
suffix:semicolon
id|strcat
c_func
(paren
id|pc-&gt;para.setup.phone
comma
id|tmp
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;wrong calling subaddress&quot;
)paren
suffix:semicolon
)brace
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
id|bcfound
)paren
(brace
r_if
c_cond
(paren
(paren
id|pc-&gt;para.setup.si1
op_ne
l_int|7
)paren
op_logical_and
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;non-digital call: %s -&gt; %s&quot;
comma
id|pc-&gt;para.setup.phone
comma
id|pc-&gt;para.setup.eazmsn
)paren
suffix:semicolon
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
id|tmp
)paren
suffix:semicolon
)brace
id|newl3state
c_func
(paren
id|pc
comma
l_int|6
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_SETUP_IND
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_else
id|release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_reset
id|l3dss1_reset
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_setup_rsp
id|l3dss1_setup_rsp
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|newl3state
c_func
(paren
id|pc
comma
l_int|8
)paren
suffix:semicolon
id|l3dss1_message
c_func
(paren
id|pc
comma
id|MT_CONNECT
)paren
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|pc-&gt;timer
comma
id|T313
comma
id|CC_T313
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_connect_ack
id|l3dss1_connect_ack
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|10
)paren
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_SETUP_COMPLETE_IND
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_disconnect_req
id|l3dss1_disconnect_req
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|u_char
id|tmp
(braket
l_int|16
)braket
suffix:semicolon
id|u_char
op_star
id|p
op_assign
id|tmp
suffix:semicolon
r_int
id|l
suffix:semicolon
id|u_char
id|cause
op_assign
l_int|0x10
suffix:semicolon
r_if
c_cond
(paren
id|pc-&gt;para.cause
OG
l_int|0
)paren
id|cause
op_assign
id|pc-&gt;para.cause
suffix:semicolon
id|StopAllL3Timer
c_func
(paren
id|pc
)paren
suffix:semicolon
id|MsgHead
c_func
(paren
id|p
comma
id|pc-&gt;callref
comma
id|MT_DISCONNECT
)paren
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|IE_CAUSE
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x2
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x80
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|cause
op_or
l_int|0x80
suffix:semicolon
id|l
op_assign
id|p
op_minus
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|l3_alloc_skb
c_func
(paren
id|l
)paren
)paren
)paren
r_return
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|l
)paren
comma
id|tmp
comma
id|l
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|11
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l2
c_func
(paren
id|pc-&gt;st
comma
id|DL_DATA
comma
id|skb
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|pc-&gt;timer
comma
id|T305
comma
id|CC_T305
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_reject_req
id|l3dss1_reject_req
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|u_char
id|tmp
(braket
l_int|16
)braket
suffix:semicolon
id|u_char
op_star
id|p
op_assign
id|tmp
suffix:semicolon
r_int
id|l
suffix:semicolon
id|u_char
id|cause
op_assign
l_int|0x95
suffix:semicolon
r_if
c_cond
(paren
id|pc-&gt;para.cause
OG
l_int|0
)paren
id|cause
op_assign
id|pc-&gt;para.cause
suffix:semicolon
id|MsgHead
c_func
(paren
id|p
comma
id|pc-&gt;callref
comma
id|MT_RELEASE_COMPLETE
)paren
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|IE_CAUSE
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x2
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x80
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|cause
suffix:semicolon
id|l
op_assign
id|p
op_minus
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|l3_alloc_skb
c_func
(paren
id|l
)paren
)paren
)paren
r_return
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|l
)paren
comma
id|tmp
comma
id|l
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l2
c_func
(paren
id|pc-&gt;st
comma
id|DL_DATA
comma
id|skb
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_RELEASE_IND
comma
l_int|NULL
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|0
)paren
suffix:semicolon
id|release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_release
id|l3dss1_release
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|u_char
op_star
id|p
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_int
id|cause
op_assign
op_minus
l_int|1
suffix:semicolon
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
id|IE_CAUSE
comma
l_int|0
)paren
)paren
)paren
(brace
id|p
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
op_increment
op_eq
l_int|2
)paren
id|pc-&gt;para.loc
op_assign
op_star
id|p
op_increment
suffix:semicolon
id|cause
op_assign
op_star
id|p
op_amp
l_int|0x7f
suffix:semicolon
)brace
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
id|IE_FACILITY
comma
l_int|0
)paren
)paren
)paren
(brace
macro_line|#ifdef HISAX_DE_AOC
id|l3dss1_parse_facility
c_func
(paren
id|pc
comma
id|p
)paren
suffix:semicolon
macro_line|#else
id|p
op_assign
l_int|NULL
suffix:semicolon
macro_line|#endif
)brace
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|StopAllL3Timer
c_func
(paren
id|pc
)paren
suffix:semicolon
id|pc-&gt;para.cause
op_assign
id|cause
suffix:semicolon
id|l3dss1_message
c_func
(paren
id|pc
comma
id|MT_RELEASE_COMPLETE
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_RELEASE_IND
comma
l_int|NULL
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|0
)paren
suffix:semicolon
id|release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_alert_req
id|l3dss1_alert_req
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|newl3state
c_func
(paren
id|pc
comma
l_int|7
)paren
suffix:semicolon
id|l3dss1_message
c_func
(paren
id|pc
comma
id|MT_ALERTING
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_status_enq
id|l3dss1_status_enq
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|u_char
id|tmp
(braket
l_int|16
)braket
suffix:semicolon
id|u_char
op_star
id|p
op_assign
id|tmp
suffix:semicolon
r_int
id|l
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|MsgHead
c_func
(paren
id|p
comma
id|pc-&gt;callref
comma
id|MT_STATUS
)paren
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|IE_CAUSE
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x2
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x80
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x9E
suffix:semicolon
multiline_comment|/* answer status enquire */
op_star
id|p
op_increment
op_assign
l_int|0x14
suffix:semicolon
multiline_comment|/* CallState */
op_star
id|p
op_increment
op_assign
l_int|0x1
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|pc-&gt;state
op_amp
l_int|0x3f
suffix:semicolon
id|l
op_assign
id|p
op_minus
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|l3_alloc_skb
c_func
(paren
id|l
)paren
)paren
)paren
r_return
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|l
)paren
comma
id|tmp
comma
id|l
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l2
c_func
(paren
id|pc-&gt;st
comma
id|DL_DATA
comma
id|skb
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_status_req
id|l3dss1_status_req
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
multiline_comment|/* ETS 300-104 7.4.1, 8.4.1, 10.3.1, 11.4.1, 12.4.1, 13.4.1, 14.4.1...&n;     if setup has been made and a non expected message type is received, we must send MT_STATUS cause 0x62  */
id|u_char
id|tmp
(braket
l_int|16
)braket
suffix:semicolon
id|u_char
op_star
id|p
op_assign
id|tmp
suffix:semicolon
r_int
id|l
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|MsgHead
c_func
(paren
id|p
comma
id|pc-&gt;callref
comma
id|MT_STATUS
)paren
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|IE_CAUSE
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x2
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x80
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x62
op_or
l_int|0x80
suffix:semicolon
multiline_comment|/* status sending */
op_star
id|p
op_increment
op_assign
l_int|0x14
suffix:semicolon
multiline_comment|/* CallState */
op_star
id|p
op_increment
op_assign
l_int|0x1
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|pc-&gt;state
op_amp
l_int|0x3f
suffix:semicolon
id|l
op_assign
id|p
op_minus
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|l3_alloc_skb
c_func
(paren
id|l
)paren
)paren
)paren
r_return
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|l
)paren
comma
id|tmp
comma
id|l
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l2
c_func
(paren
id|pc-&gt;st
comma
id|DL_DATA
comma
id|skb
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_release_ind
id|l3dss1_release_ind
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|u_char
op_star
id|p
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_int
id|callState
op_assign
l_int|0
suffix:semicolon
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
id|IE_CALL_STATE
comma
l_int|0
)paren
)paren
)paren
(brace
id|p
op_increment
suffix:semicolon
r_if
c_cond
(paren
l_int|1
op_eq
op_star
id|p
op_increment
)paren
id|callState
op_assign
op_star
id|p
suffix:semicolon
)brace
r_if
c_cond
(paren
id|callState
op_eq
l_int|0
)paren
(brace
multiline_comment|/* ETS 300-104 7.6.1, 8.6.1, 10.6.1... and 16.1&n;&t;&t; * set down layer 3 without sending any message&n;&t;&t; */
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_RELEASE_IND
comma
l_int|NULL
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|0
)paren
suffix:semicolon
id|release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
)brace
r_else
(brace
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_IGNORE
comma
l_int|NULL
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|l3dss1_t303
id|l3dss1_t303
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_if
c_cond
(paren
id|pc-&gt;N303
OG
l_int|0
)paren
(brace
id|pc-&gt;N303
op_decrement
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|l3dss1_setup_req
c_func
(paren
id|pc
comma
id|pr
comma
id|arg
)paren
suffix:semicolon
)brace
r_else
(brace
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_NOSETUP_RSP_ERR
comma
l_int|NULL
)paren
suffix:semicolon
id|release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|l3dss1_t304
id|l3dss1_t304
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|pc-&gt;para.cause
op_assign
l_int|0xE6
suffix:semicolon
id|l3dss1_disconnect_req
c_func
(paren
id|pc
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_SETUP_ERR
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_t305
id|l3dss1_t305
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|u_char
id|tmp
(braket
l_int|16
)braket
suffix:semicolon
id|u_char
op_star
id|p
op_assign
id|tmp
suffix:semicolon
r_int
id|l
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|u_char
id|cause
op_assign
l_int|0x90
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pc-&gt;para.cause
OG
l_int|0
)paren
id|cause
op_assign
id|pc-&gt;para.cause
op_or
l_int|0x80
suffix:semicolon
id|MsgHead
c_func
(paren
id|p
comma
id|pc-&gt;callref
comma
id|MT_RELEASE
)paren
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|IE_CAUSE
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x2
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x80
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|cause
suffix:semicolon
id|l
op_assign
id|p
op_minus
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|l3_alloc_skb
c_func
(paren
id|l
)paren
)paren
)paren
r_return
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|l
)paren
comma
id|tmp
comma
id|l
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|19
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l2
c_func
(paren
id|pc-&gt;st
comma
id|DL_DATA
comma
id|skb
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|pc-&gt;timer
comma
id|T308
comma
id|CC_T308_1
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_t310
id|l3dss1_t310
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|pc-&gt;para.cause
op_assign
l_int|0xE6
suffix:semicolon
id|l3dss1_disconnect_req
c_func
(paren
id|pc
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_SETUP_ERR
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_t313
id|l3dss1_t313
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|pc-&gt;para.cause
op_assign
l_int|0xE6
suffix:semicolon
id|l3dss1_disconnect_req
c_func
(paren
id|pc
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_CONNECT_ERR
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_t308_1
id|l3dss1_t308_1
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|newl3state
c_func
(paren
id|pc
comma
l_int|19
)paren
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|l3dss1_message
c_func
(paren
id|pc
comma
id|MT_RELEASE
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|pc-&gt;timer
comma
id|T308
comma
id|CC_T308_2
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_t308_2
id|l3dss1_t308_2
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_RELEASE_ERR
comma
l_int|NULL
)paren
suffix:semicolon
id|release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_restart
id|l3dss1_restart
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc
comma
id|CC_DLRL
comma
l_int|NULL
)paren
suffix:semicolon
id|release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_status
id|l3dss1_status
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|u_char
op_star
id|p
suffix:semicolon
r_char
id|tmp
(braket
l_int|64
)braket
comma
op_star
id|t
suffix:semicolon
r_int
id|l
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_int
id|cause
comma
id|callState
suffix:semicolon
id|cause
op_assign
id|callState
op_assign
op_minus
l_int|1
suffix:semicolon
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
id|t
op_assign
id|tmp
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
id|IE_CAUSE
comma
l_int|0
)paren
)paren
)paren
(brace
id|p
op_increment
suffix:semicolon
id|l
op_assign
op_star
id|p
op_increment
suffix:semicolon
id|t
op_add_assign
id|sprintf
c_func
(paren
id|t
comma
l_string|&quot;Status CR %x Cause:&quot;
comma
id|pc-&gt;callref
)paren
suffix:semicolon
r_while
c_loop
(paren
id|l
op_decrement
)paren
(brace
id|cause
op_assign
op_star
id|p
suffix:semicolon
id|t
op_add_assign
id|sprintf
c_func
(paren
id|t
comma
l_string|&quot; %2x&quot;
comma
op_star
id|p
op_increment
)paren
suffix:semicolon
)brace
)brace
r_else
id|sprintf
c_func
(paren
id|t
comma
l_string|&quot;Status CR %x no Cause&quot;
comma
id|pc-&gt;callref
)paren
suffix:semicolon
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
id|tmp
)paren
suffix:semicolon
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
id|t
op_assign
id|tmp
suffix:semicolon
id|t
op_add_assign
id|sprintf
c_func
(paren
id|t
comma
l_string|&quot;Status state %x &quot;
comma
id|pc-&gt;state
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
id|IE_CALL_STATE
comma
l_int|0
)paren
)paren
)paren
(brace
id|p
op_increment
suffix:semicolon
r_if
c_cond
(paren
l_int|1
op_eq
op_star
id|p
op_increment
)paren
(brace
id|callState
op_assign
op_star
id|p
suffix:semicolon
id|t
op_add_assign
id|sprintf
c_func
(paren
id|t
comma
l_string|&quot;peer state %x&quot;
comma
op_star
id|p
)paren
suffix:semicolon
)brace
r_else
id|t
op_add_assign
id|sprintf
c_func
(paren
id|t
comma
l_string|&quot;peer state len error&quot;
)paren
suffix:semicolon
)brace
r_else
id|sprintf
c_func
(paren
id|t
comma
l_string|&quot;no peer state&quot;
)paren
suffix:semicolon
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
id|tmp
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
id|cause
op_amp
l_int|0x7f
)paren
op_eq
l_int|0x6f
)paren
op_logical_and
(paren
id|callState
op_eq
l_int|0
)paren
)paren
(brace
multiline_comment|/* ETS 300-104 7.6.1, 8.6.1, 10.6.1... &n;&t;&t; * if received MT_STATUS with cause == 0x6f and call &n;&t;&t; * state == 0, then we must set down layer 3&n;&t;&t; */
id|l3dss1_release_ind
c_func
(paren
id|pc
comma
id|pr
comma
id|arg
)paren
suffix:semicolon
)brace
r_else
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_facility
id|l3dss1_facility
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|u_char
op_star
id|p
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
id|IE_FACILITY
comma
l_int|0
)paren
)paren
)paren
(brace
macro_line|#ifdef HISAX_DE_AOC
id|l3dss1_parse_facility
c_func
(paren
id|pc
comma
id|p
)paren
suffix:semicolon
macro_line|#else
id|p
op_assign
l_int|NULL
suffix:semicolon
macro_line|#endif
)brace
)brace
r_static
r_void
DECL|function|l3dss1_global_restart
id|l3dss1_global_restart
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|u_char
id|tmp
(braket
l_int|32
)braket
suffix:semicolon
id|u_char
op_star
id|p
suffix:semicolon
id|u_char
id|ri
comma
id|chan
op_assign
l_int|0
suffix:semicolon
r_int
id|l
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_struct
id|l3_process
op_star
id|up
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|2
)paren
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
id|IE_RESTART_IND
comma
l_int|0
)paren
)paren
)paren
(brace
id|ri
op_assign
id|p
(braket
l_int|2
)braket
suffix:semicolon
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;Restart %x&quot;
comma
id|ri
)paren
suffix:semicolon
)brace
r_else
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;Restart without restart IE&quot;
)paren
suffix:semicolon
id|ri
op_assign
l_int|0x86
suffix:semicolon
)brace
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
id|tmp
)paren
suffix:semicolon
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
id|IE_CHANNEL_ID
comma
l_int|0
)paren
)paren
)paren
(brace
id|chan
op_assign
id|p
(braket
l_int|2
)braket
op_amp
l_int|3
suffix:semicolon
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;Restart for channel %d&quot;
comma
id|chan
)paren
suffix:semicolon
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
id|tmp
)paren
suffix:semicolon
)brace
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|2
)paren
suffix:semicolon
id|up
op_assign
id|pc-&gt;st-&gt;l3.proc
suffix:semicolon
r_while
c_loop
(paren
id|up
)paren
(brace
r_if
c_cond
(paren
(paren
id|ri
op_amp
l_int|7
)paren
op_eq
l_int|7
)paren
id|up-&gt;st-&gt;lli
dot
id|l4l3
c_func
(paren
id|up-&gt;st
comma
id|CC_RESTART
comma
id|up
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|up-&gt;para.bchannel
op_eq
id|chan
)paren
id|up-&gt;st-&gt;lli
dot
id|l4l3
c_func
(paren
id|up-&gt;st
comma
id|CC_RESTART
comma
id|up
)paren
suffix:semicolon
id|up
op_assign
id|up-&gt;next
suffix:semicolon
)brace
id|p
op_assign
id|tmp
suffix:semicolon
id|MsgHead
c_func
(paren
id|p
comma
id|pc-&gt;callref
comma
id|MT_RESTART_ACKNOWLEDGE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chan
)paren
(brace
op_star
id|p
op_increment
op_assign
id|IE_CHANNEL_ID
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|1
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|chan
op_or
l_int|0x80
suffix:semicolon
)brace
op_star
id|p
op_increment
op_assign
l_int|0x79
suffix:semicolon
multiline_comment|/* RESTART Ind */
op_star
id|p
op_increment
op_assign
l_int|1
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|ri
suffix:semicolon
id|l
op_assign
id|p
op_minus
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|l3_alloc_skb
c_func
(paren
id|l
)paren
)paren
)paren
r_return
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|l
)paren
comma
id|tmp
comma
id|l
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|0
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l2
c_func
(paren
id|pc-&gt;st
comma
id|DL_DATA
comma
id|skb
)paren
suffix:semicolon
)brace
multiline_comment|/* *INDENT-OFF* */
DECL|variable|downstatelist
r_static
r_struct
id|stateentry
id|downstatelist
(braket
)braket
op_assign
(brace
(brace
id|SBIT
c_func
(paren
l_int|0
)paren
comma
id|CC_ESTABLISH
comma
id|l3dss1_msg_without_setup
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|0
)paren
comma
id|CC_SETUP_REQ
comma
id|l3dss1_setup_req
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|1
)paren
op_or
id|SBIT
c_func
(paren
l_int|2
)paren
op_or
id|SBIT
c_func
(paren
l_int|3
)paren
op_or
id|SBIT
c_func
(paren
l_int|4
)paren
op_or
id|SBIT
c_func
(paren
l_int|6
)paren
op_or
id|SBIT
c_func
(paren
l_int|7
)paren
op_or
id|SBIT
c_func
(paren
l_int|8
)paren
op_or
id|SBIT
c_func
(paren
l_int|10
)paren
comma
id|CC_DISCONNECT_REQ
comma
id|l3dss1_disconnect_req
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|12
)paren
comma
id|CC_RELEASE_REQ
comma
id|l3dss1_release_req
)brace
comma
(brace
id|ALL_STATES
comma
id|CC_DLRL
comma
id|l3dss1_reset
)brace
comma
(brace
id|ALL_STATES
comma
id|CC_RESTART
comma
id|l3dss1_restart
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|6
)paren
comma
id|CC_IGNORE
comma
id|l3dss1_reset
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|6
)paren
comma
id|CC_REJECT_REQ
comma
id|l3dss1_reject_req
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|6
)paren
comma
id|CC_ALERTING_REQ
comma
id|l3dss1_alert_req
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|6
)paren
op_or
id|SBIT
c_func
(paren
l_int|7
)paren
comma
id|CC_SETUP_RSP
comma
id|l3dss1_setup_rsp
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|1
)paren
comma
id|CC_T303
comma
id|l3dss1_t303
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|2
)paren
comma
id|CC_T304
comma
id|l3dss1_t304
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|3
)paren
comma
id|CC_T310
comma
id|l3dss1_t310
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|8
)paren
comma
id|CC_T313
comma
id|l3dss1_t313
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|11
)paren
comma
id|CC_T305
comma
id|l3dss1_t305
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|19
)paren
comma
id|CC_T308_1
comma
id|l3dss1_t308_1
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|19
)paren
comma
id|CC_T308_2
comma
id|l3dss1_t308_2
)brace
comma
)brace
suffix:semicolon
DECL|variable|downsllen
r_static
r_int
id|downsllen
op_assign
r_sizeof
(paren
id|downstatelist
)paren
op_div
r_sizeof
(paren
r_struct
id|stateentry
)paren
suffix:semicolon
DECL|variable|datastatelist
r_static
r_struct
id|stateentry
id|datastatelist
(braket
)braket
op_assign
(brace
(brace
id|ALL_STATES
comma
id|MT_STATUS_ENQUIRY
comma
id|l3dss1_status_enq
)brace
comma
(brace
id|ALL_STATES
comma
id|MT_FACILITY
comma
id|l3dss1_facility
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|19
)paren
comma
id|MT_STATUS
comma
id|l3dss1_release_ind
)brace
comma
(brace
id|ALL_STATES
comma
id|MT_STATUS
comma
id|l3dss1_status
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|0
)paren
op_or
id|SBIT
c_func
(paren
l_int|6
)paren
comma
id|MT_SETUP
comma
id|l3dss1_setup
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|1
)paren
op_or
id|SBIT
c_func
(paren
l_int|2
)paren
comma
id|MT_CALL_PROCEEDING
comma
id|l3dss1_call_proc
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|3
)paren
op_or
id|SBIT
c_func
(paren
l_int|4
)paren
op_or
id|SBIT
c_func
(paren
l_int|8
)paren
op_or
id|SBIT
c_func
(paren
l_int|10
)paren
op_or
id|SBIT
c_func
(paren
l_int|11
)paren
op_or
id|SBIT
c_func
(paren
l_int|19
)paren
comma
id|MT_CALL_PROCEEDING
comma
id|l3dss1_status_req
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|1
)paren
comma
id|MT_SETUP_ACKNOWLEDGE
comma
id|l3dss1_setup_ack
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|2
)paren
op_or
id|SBIT
c_func
(paren
l_int|3
)paren
op_or
id|SBIT
c_func
(paren
l_int|4
)paren
op_or
id|SBIT
c_func
(paren
l_int|8
)paren
op_or
id|SBIT
c_func
(paren
l_int|10
)paren
op_or
id|SBIT
c_func
(paren
l_int|11
)paren
op_or
id|SBIT
c_func
(paren
l_int|19
)paren
comma
id|MT_SETUP_ACKNOWLEDGE
comma
id|l3dss1_status_req
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|1
)paren
op_or
id|SBIT
c_func
(paren
l_int|2
)paren
op_or
id|SBIT
c_func
(paren
l_int|3
)paren
comma
id|MT_ALERTING
comma
id|l3dss1_alerting
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|4
)paren
op_or
id|SBIT
c_func
(paren
l_int|8
)paren
op_or
id|SBIT
c_func
(paren
l_int|10
)paren
op_or
id|SBIT
c_func
(paren
l_int|11
)paren
op_or
id|SBIT
c_func
(paren
l_int|19
)paren
comma
id|MT_ALERTING
comma
id|l3dss1_status_req
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|0
)paren
op_or
id|SBIT
c_func
(paren
l_int|1
)paren
op_or
id|SBIT
c_func
(paren
l_int|2
)paren
op_or
id|SBIT
c_func
(paren
l_int|3
)paren
op_or
id|SBIT
c_func
(paren
l_int|4
)paren
op_or
id|SBIT
c_func
(paren
l_int|7
)paren
op_or
id|SBIT
c_func
(paren
l_int|8
)paren
op_or
id|SBIT
c_func
(paren
l_int|10
)paren
op_or
id|SBIT
c_func
(paren
l_int|11
)paren
op_or
id|SBIT
c_func
(paren
l_int|12
)paren
op_or
id|SBIT
c_func
(paren
l_int|15
)paren
op_or
id|SBIT
c_func
(paren
l_int|17
)paren
op_or
id|SBIT
c_func
(paren
l_int|19
)paren
comma
id|MT_RELEASE_COMPLETE
comma
id|l3dss1_release_cmpl
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|1
)paren
op_or
id|SBIT
c_func
(paren
l_int|2
)paren
op_or
id|SBIT
c_func
(paren
l_int|3
)paren
op_or
id|SBIT
c_func
(paren
l_int|4
)paren
op_or
id|SBIT
c_func
(paren
l_int|7
)paren
op_or
id|SBIT
c_func
(paren
l_int|8
)paren
op_or
id|SBIT
c_func
(paren
l_int|10
)paren
op_or
id|SBIT
c_func
(paren
l_int|11
)paren
op_or
id|SBIT
c_func
(paren
l_int|12
)paren
op_or
id|SBIT
c_func
(paren
l_int|15
)paren
op_or
id|SBIT
c_func
(paren
l_int|17
)paren
multiline_comment|/*| SBIT(19)*/
comma
id|MT_RELEASE
comma
id|l3dss1_release
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|19
)paren
comma
id|MT_RELEASE
comma
id|l3dss1_release_ind
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|1
)paren
op_or
id|SBIT
c_func
(paren
l_int|2
)paren
op_or
id|SBIT
c_func
(paren
l_int|3
)paren
op_or
id|SBIT
c_func
(paren
l_int|4
)paren
op_or
id|SBIT
c_func
(paren
l_int|7
)paren
op_or
id|SBIT
c_func
(paren
l_int|8
)paren
op_or
id|SBIT
c_func
(paren
l_int|10
)paren
comma
id|MT_DISCONNECT
comma
id|l3dss1_disconnect
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|11
)paren
comma
id|MT_DISCONNECT
comma
id|l3dss1_release_req
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|1
)paren
op_or
id|SBIT
c_func
(paren
l_int|2
)paren
op_or
id|SBIT
c_func
(paren
l_int|3
)paren
op_or
id|SBIT
c_func
(paren
l_int|4
)paren
comma
id|MT_CONNECT
comma
id|l3dss1_connect
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|8
)paren
op_or
id|SBIT
c_func
(paren
l_int|10
)paren
op_or
id|SBIT
c_func
(paren
l_int|11
)paren
op_or
id|SBIT
c_func
(paren
l_int|19
)paren
comma
id|MT_CONNECT
comma
id|l3dss1_status_req
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|1
)paren
op_or
id|SBIT
c_func
(paren
l_int|2
)paren
op_or
id|SBIT
c_func
(paren
l_int|3
)paren
op_or
id|SBIT
c_func
(paren
l_int|4
)paren
op_or
id|SBIT
c_func
(paren
l_int|11
)paren
op_or
id|SBIT
c_func
(paren
l_int|19
)paren
comma
id|MT_CONNECT_ACKNOWLEDGE
comma
id|l3dss1_status_req
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|8
)paren
comma
id|MT_CONNECT_ACKNOWLEDGE
comma
id|l3dss1_connect_ack
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|1
)paren
op_or
id|SBIT
c_func
(paren
l_int|2
)paren
op_or
id|SBIT
c_func
(paren
l_int|3
)paren
op_or
id|SBIT
c_func
(paren
l_int|4
)paren
op_or
id|SBIT
c_func
(paren
l_int|8
)paren
op_or
id|SBIT
c_func
(paren
l_int|10
)paren
op_or
id|SBIT
c_func
(paren
l_int|11
)paren
op_or
id|SBIT
c_func
(paren
l_int|19
)paren
comma
id|MT_INVALID
comma
id|l3dss1_status_req
)brace
comma
)brace
suffix:semicolon
DECL|variable|datasllen
r_static
r_int
id|datasllen
op_assign
r_sizeof
(paren
id|datastatelist
)paren
op_div
r_sizeof
(paren
r_struct
id|stateentry
)paren
suffix:semicolon
DECL|variable|globalmes_list
r_static
r_struct
id|stateentry
id|globalmes_list
(braket
)braket
op_assign
(brace
(brace
id|ALL_STATES
comma
id|MT_STATUS
comma
id|l3dss1_status
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|0
)paren
comma
id|MT_RESTART
comma
id|l3dss1_global_restart
)brace
comma
multiline_comment|/*&t;{SBIT(1),&n;&t; MT_RESTART_ACKNOWLEDGE, l3dss1_restart_ack},                                  &n;*/
)brace
suffix:semicolon
DECL|variable|globalm_len
r_static
r_int
id|globalm_len
op_assign
r_sizeof
(paren
id|globalmes_list
)paren
op_div
r_sizeof
(paren
r_struct
id|stateentry
)paren
suffix:semicolon
macro_line|#if 0
r_static
r_struct
id|stateentry
id|globalcmd_list
(braket
)braket
op_assign
(brace
(brace
id|ALL_STATES
comma
id|CC_STATUS
comma
id|l3dss1_status_req
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|0
)paren
comma
id|CC_RESTART
comma
id|l3dss1_restart_req
)brace
comma
)brace
suffix:semicolon
r_static
r_int
id|globalc_len
op_assign
r_sizeof
(paren
id|globalcmd_list
)paren
op_div
r_sizeof
(paren
r_struct
id|stateentry
)paren
suffix:semicolon
macro_line|#endif
multiline_comment|/* *INDENT-ON* */
r_static
r_void
DECL|function|global_handler
id|global_handler
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|mt
comma
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
r_int
id|i
suffix:semicolon
r_char
id|tmp
(braket
l_int|64
)braket
suffix:semicolon
r_struct
id|l3_process
op_star
id|proc
op_assign
id|st-&gt;l3.global
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|globalm_len
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
(paren
id|mt
op_eq
id|globalmes_list
(braket
id|i
)braket
dot
id|primitive
)paren
op_logical_and
(paren
(paren
l_int|1
op_lshift
id|proc-&gt;state
)paren
op_amp
id|globalmes_list
(braket
id|i
)braket
dot
id|state
)paren
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|i
op_eq
id|globalm_len
)paren
(brace
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_STATE
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;dss1 global state %d mt %x unhandled&quot;
comma
id|proc-&gt;state
comma
id|mt
)paren
suffix:semicolon
id|l3_debug
c_func
(paren
id|st
comma
id|tmp
)paren
suffix:semicolon
)brace
r_return
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_STATE
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;dss1 global %d mt %x&quot;
comma
id|proc-&gt;state
comma
id|mt
)paren
suffix:semicolon
id|l3_debug
c_func
(paren
id|st
comma
id|tmp
)paren
suffix:semicolon
)brace
id|globalmes_list
(braket
id|i
)braket
dot
id|rout
c_func
(paren
id|proc
comma
id|mt
comma
id|skb
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|dss1up
id|dss1up
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_int
id|i
comma
id|mt
comma
id|cr
comma
id|cause
comma
id|callState
suffix:semicolon
r_char
op_star
id|ptr
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_struct
id|l3_process
op_star
id|proc
suffix:semicolon
r_char
id|tmp
(braket
l_int|80
)braket
suffix:semicolon
r_if
c_cond
(paren
id|skb-&gt;data
(braket
l_int|0
)braket
op_ne
id|PROTO_DIS_EURO
)paren
(brace
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_PROTERR
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;dss1up%sunexpected discriminator %x message len %d&quot;
comma
(paren
id|pr
op_eq
id|DL_DATA
)paren
ques
c_cond
l_string|&quot; &quot;
suffix:colon
l_string|&quot;(broadcast) &quot;
comma
id|skb-&gt;data
(braket
l_int|0
)braket
comma
id|skb-&gt;len
)paren
suffix:semicolon
id|l3_debug
c_func
(paren
id|st
comma
id|tmp
)paren
suffix:semicolon
)brace
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|cr
op_assign
id|getcallref
c_func
(paren
id|skb-&gt;data
)paren
suffix:semicolon
id|mt
op_assign
id|skb-&gt;data
(braket
id|skb-&gt;data
(braket
l_int|1
)braket
op_plus
l_int|2
)braket
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|cr
)paren
(brace
multiline_comment|/* Global CallRef */
id|global_handler
c_func
(paren
id|st
comma
id|mt
comma
id|skb
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|cr
op_eq
op_minus
l_int|1
)paren
(brace
multiline_comment|/* Dummy Callref */
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
(paren
id|proc
op_assign
id|getl3proc
c_func
(paren
id|st
comma
id|cr
)paren
)paren
)paren
(brace
multiline_comment|/* No transaction process exist, that means no call with&n;&t;&t; * this callreference is active&n;&t;&t; */
r_if
c_cond
(paren
id|mt
op_eq
id|MT_SETUP
)paren
(brace
multiline_comment|/* Setup creates a new transaction process */
r_if
c_cond
(paren
op_logical_neg
(paren
id|proc
op_assign
id|new_l3_process
c_func
(paren
id|st
comma
id|cr
)paren
)paren
)paren
(brace
multiline_comment|/* May be to answer with RELEASE_COMPLETE and&n;&t;&t;&t;&t; * CAUSE 0x2f &quot;Resource unavailable&quot;, but this&n;&t;&t;&t;&t; * need a new_l3_process too ... arghh&n;&t;&t;&t;&t; */
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|mt
op_eq
id|MT_STATUS
)paren
(brace
id|cause
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ptr
op_assign
id|findie
c_func
(paren
id|skb-&gt;data
comma
id|skb-&gt;len
comma
id|IE_CAUSE
comma
l_int|0
)paren
)paren
op_ne
l_int|NULL
)paren
(brace
id|ptr
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|ptr
op_increment
op_eq
l_int|2
)paren
id|ptr
op_increment
suffix:semicolon
id|cause
op_assign
op_star
id|ptr
op_amp
l_int|0x7f
suffix:semicolon
)brace
id|callState
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ptr
op_assign
id|findie
c_func
(paren
id|skb-&gt;data
comma
id|skb-&gt;len
comma
id|IE_CALL_STATE
comma
l_int|0
)paren
)paren
op_ne
l_int|NULL
)paren
(brace
id|ptr
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|ptr
op_increment
op_eq
l_int|2
)paren
id|ptr
op_increment
suffix:semicolon
id|callState
op_assign
op_star
id|ptr
suffix:semicolon
)brace
r_if
c_cond
(paren
id|callState
op_eq
l_int|0
)paren
(brace
multiline_comment|/* ETS 300-104 part 2.4.1&n;&t;&t;&t;&t; * if setup has not been made and a message type&n;&t;&t;&t;&t; * MT_STATUS is received with call state == 0,&n;&t;&t;&t;&t; * we must send nothing&n;&t;&t;&t;&t; */
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* ETS 300-104 part 2.4.2&n;&t;&t;&t;&t; * if setup has not been made and a message type &n;&t;&t;&t;&t; * MT_STATUS is received with call state != 0,&n;&t;&t;&t;&t; * we must send MT_RELEASE_COMPLETE cause 101&n;&t;&t;&t;&t; */
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|proc
op_assign
id|new_l3_process
c_func
(paren
id|st
comma
id|cr
)paren
)paren
)paren
(brace
id|proc-&gt;para.cause
op_assign
l_int|0x65
suffix:semicolon
multiline_comment|/* 101 */
id|proc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|proc
comma
id|CC_ESTABLISH
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_return
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|mt
op_eq
id|MT_RELEASE_COMPLETE
)paren
(brace
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* ETS 300-104 part 2&n;&t;&t;&t; * if setup has not been made and a message type &n;&t;&t;&t; * (except MT_SETUP and RELEASE_COMPLETE) is received,&n;&t;&t;&t; * we must send MT_RELEASE_COMPLETE cause 81 */
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|proc
op_assign
id|new_l3_process
c_func
(paren
id|st
comma
id|cr
)paren
)paren
)paren
(brace
id|proc-&gt;para.cause
op_assign
l_int|0x51
suffix:semicolon
multiline_comment|/* 81 */
id|proc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|proc
comma
id|CC_ESTABLISH
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_return
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|l3dss1_check_messagetype_validity
c_func
(paren
id|mt
)paren
)paren
(brace
multiline_comment|/* ETS 300-104 7.4.2, 8.4.2, 10.3.2, 11.4.2, 12.4.2, 13.4.2,&n;&t;&t; * 14.4.2...&n;&t;&t; * if setup has been made and invalid message type is received,&n;&t;&t; * we must send MT_STATUS cause 0x62&n;&t;&t; */
id|mt
op_assign
id|MT_INVALID
suffix:semicolon
multiline_comment|/* sorry, not clean, but do the right thing ;-) */
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|datasllen
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
(paren
id|mt
op_eq
id|datastatelist
(braket
id|i
)braket
dot
id|primitive
)paren
op_logical_and
(paren
(paren
l_int|1
op_lshift
id|proc-&gt;state
)paren
op_amp
id|datastatelist
(braket
id|i
)braket
dot
id|state
)paren
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|i
op_eq
id|datasllen
)paren
(brace
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_STATE
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;dss1up%sstate %d mt %x unhandled&quot;
comma
(paren
id|pr
op_eq
id|DL_DATA
)paren
ques
c_cond
l_string|&quot; &quot;
suffix:colon
l_string|&quot;(broadcast) &quot;
comma
id|proc-&gt;state
comma
id|mt
)paren
suffix:semicolon
id|l3_debug
c_func
(paren
id|st
comma
id|tmp
)paren
suffix:semicolon
)brace
r_return
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_STATE
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;dss1up%sstate %d mt %x&quot;
comma
(paren
id|pr
op_eq
id|DL_DATA
)paren
ques
c_cond
l_string|&quot; &quot;
suffix:colon
l_string|&quot;(broadcast) &quot;
comma
id|proc-&gt;state
comma
id|mt
)paren
suffix:semicolon
id|l3_debug
c_func
(paren
id|st
comma
id|tmp
)paren
suffix:semicolon
)brace
id|datastatelist
(braket
id|i
)braket
dot
id|rout
c_func
(paren
id|proc
comma
id|pr
comma
id|skb
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|dss1down
id|dss1down
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_int
id|i
comma
id|cr
suffix:semicolon
r_struct
id|l3_process
op_star
id|proc
suffix:semicolon
r_struct
id|Channel
op_star
id|chan
suffix:semicolon
r_char
id|tmp
(braket
l_int|80
)braket
suffix:semicolon
r_if
c_cond
(paren
id|CC_SETUP_REQ
op_eq
id|pr
)paren
(brace
id|chan
op_assign
id|arg
suffix:semicolon
id|cr
op_assign
id|newcallref
c_func
(paren
)paren
suffix:semicolon
id|cr
op_or_assign
l_int|0x80
suffix:semicolon
r_if
c_cond
(paren
(paren
id|proc
op_assign
id|new_l3_process
c_func
(paren
id|st
comma
id|cr
)paren
)paren
)paren
(brace
id|proc-&gt;chan
op_assign
id|chan
suffix:semicolon
id|chan-&gt;proc
op_assign
id|proc
suffix:semicolon
id|proc-&gt;para.setup
op_assign
id|chan-&gt;setup
suffix:semicolon
id|proc-&gt;callref
op_assign
id|cr
suffix:semicolon
)brace
)brace
r_else
(brace
id|proc
op_assign
id|arg
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|proc
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;HiSax internal error dss1down without proc&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|downsllen
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
(paren
id|pr
op_eq
id|downstatelist
(braket
id|i
)braket
dot
id|primitive
)paren
op_logical_and
(paren
(paren
l_int|1
op_lshift
id|proc-&gt;state
)paren
op_amp
id|downstatelist
(braket
id|i
)braket
dot
id|state
)paren
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|i
op_eq
id|downsllen
)paren
(brace
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_STATE
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;dss1down state %d prim %d unhandled&quot;
comma
id|proc-&gt;state
comma
id|pr
)paren
suffix:semicolon
id|l3_debug
c_func
(paren
id|st
comma
id|tmp
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_STATE
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;dss1down state %d prim %d&quot;
comma
id|proc-&gt;state
comma
id|pr
)paren
suffix:semicolon
id|l3_debug
c_func
(paren
id|st
comma
id|tmp
)paren
suffix:semicolon
)brace
id|downstatelist
(braket
id|i
)braket
dot
id|rout
c_func
(paren
id|proc
comma
id|pr
comma
id|arg
)paren
suffix:semicolon
)brace
)brace
r_void
DECL|function|setstack_dss1
id|setstack_dss1
c_func
(paren
r_struct
id|PStack
op_star
id|st
)paren
(brace
r_char
id|tmp
(braket
l_int|64
)braket
suffix:semicolon
id|st-&gt;lli.l4l3
op_assign
id|dss1down
suffix:semicolon
id|st-&gt;l2.l2l3
op_assign
id|dss1up
suffix:semicolon
id|st-&gt;l3.N303
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|st-&gt;l3.global
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|l3_process
)paren
comma
id|GFP_ATOMIC
)paren
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;HiSax can&squot;t get memory for dss1 global CR&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|st-&gt;l3.global-&gt;state
op_assign
l_int|0
suffix:semicolon
id|st-&gt;l3.global-&gt;callref
op_assign
l_int|0
suffix:semicolon
id|st-&gt;l3.global-&gt;next
op_assign
l_int|NULL
suffix:semicolon
id|st-&gt;l3.global-&gt;debug
op_assign
id|L3_DEB_WARN
suffix:semicolon
id|st-&gt;l3.global-&gt;st
op_assign
id|st
suffix:semicolon
id|st-&gt;l3.global-&gt;N303
op_assign
l_int|1
suffix:semicolon
id|L3InitTimer
c_func
(paren
id|st-&gt;l3.global
comma
op_amp
id|st-&gt;l3.global-&gt;timer
)paren
suffix:semicolon
)brace
id|strcpy
c_func
(paren
id|tmp
comma
id|dss1_revision
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;HiSax: DSS1 Rev. %s&bslash;n&quot;
comma
id|HiSax_getrev
c_func
(paren
id|tmp
)paren
)paren
suffix:semicolon
)brace
eof
