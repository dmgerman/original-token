multiline_comment|/* $Id: l3dss1.c,v 1.12 1997/02/17 00:34:26 keil Exp $&n;&n; * EURO/DSS1 D-channel protocol&n; *&n; * Author       Karsten Keil (keil@temic-ech.spacenet.de)&n; *              based on the teles driver from Jan den Ouden&n; *&n; * Thanks to    Jan den Ouden&n; *              Fritz Elfert&n; *&n; * $Log: l3dss1.c,v $&n; * Revision 1.12  1997/02/17 00:34:26  keil&n; * Bugfix: Wrong cause delivered&n; *&n; * Revision 1.11  1997/02/16 12:12:47  fritz&n; * Bugfix: SI2 was nont initialized on incoming calls.&n; *&n; * Revision 1.10  1997/02/11 01:37:24  keil&n; * Changed setup-interface (incoming and outgoing)&n; *&n; * Revision 1.9  1997/01/27 23:20:52  keil&n; * report revision only ones&n; *&n; * Revision 1.8  1997/01/21 22:29:41  keil&n; * new statemachine; L3 timers&n; *&n; * Revision 1.7  1996/12/14 21:06:59  keil&n; * additional states for CC_REJECT&n; *&n; * Revision 1.6  1996/12/08 22:59:16  keil&n; * fixed calling party number without octet 3a&n; *&n; * Revision 1.5  1996/12/08 19:53:31  keil&n; * fixes from Pekka Sarnila&n; *&n; * Revision 1.4  1996/11/05 19:44:36  keil&n; * some fixes from Henner Eisen&n; *&n; * Revision 1.3  1996/10/30 10:18:01  keil&n; * bugfixes in debugging output&n; *&n; * Revision 1.2  1996/10/27 22:15:16  keil&n; * bugfix reject handling&n; *&n; * Revision 1.1  1996/10/13 20:04:55  keil&n; * Initial revision&n; *&n; *&n; *&n; */
DECL|macro|__NO_VERSION__
mdefine_line|#define __NO_VERSION__
macro_line|#include &quot;hisax.h&quot;
macro_line|#include &quot;isdnl3.h&quot;
r_extern
r_char
op_star
id|HiSax_getrev
c_func
(paren
r_const
r_char
op_star
id|revision
)paren
suffix:semicolon
DECL|variable|dss1_revision
r_const
r_char
op_star
id|dss1_revision
op_assign
l_string|&quot;$Revision: 1.12 $&quot;
suffix:semicolon
DECL|macro|MsgHead
mdefine_line|#define&t;MsgHead(ptr, cref, mty) &bslash;&n;&t;*ptr++ = 0x8; &bslash;&n;&t;*ptr++ = 0x1; &bslash;&n;&t;*ptr++ = cref; &bslash;&n;&t;*ptr++ = mty
r_static
r_void
DECL|function|l3dss1_message
id|l3dss1_message
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
id|byte
id|mt
)paren
(brace
r_struct
id|BufHeader
op_star
id|dibh
suffix:semicolon
id|byte
op_star
id|p
suffix:semicolon
id|BufPoolGet
c_func
(paren
op_amp
id|dibh
comma
id|st-&gt;l1.sbufpool
comma
id|GFP_ATOMIC
comma
(paren
r_void
op_star
)paren
id|st
comma
l_int|18
)paren
suffix:semicolon
id|p
op_assign
id|DATAPTR
c_func
(paren
id|dibh
)paren
suffix:semicolon
id|p
op_add_assign
id|st-&gt;l2.ihsize
suffix:semicolon
id|MsgHead
c_func
(paren
id|p
comma
id|st-&gt;l3.callref
comma
id|mt
)paren
suffix:semicolon
id|dibh-&gt;datasize
op_assign
id|p
op_minus
id|DATAPTR
c_func
(paren
id|dibh
)paren
suffix:semicolon
id|st-&gt;l3
dot
id|l3l2
c_func
(paren
id|st
comma
id|DL_DATA
comma
id|dibh
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_release_req
id|l3dss1_release_req
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
id|byte
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|StopAllL3Timer
c_func
(paren
id|st
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|st
comma
l_int|19
)paren
suffix:semicolon
id|l3dss1_message
c_func
(paren
id|st
comma
id|MT_RELEASE
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|st-&gt;l3.timer
comma
id|st-&gt;l3.t308
comma
id|CC_T308_1
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_release_cmpl
id|l3dss1_release_cmpl
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
id|byte
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|byte
op_star
id|p
suffix:semicolon
r_struct
id|BufHeader
op_star
id|ibh
op_assign
id|arg
suffix:semicolon
r_int
id|cause
op_assign
op_minus
l_int|1
suffix:semicolon
id|p
op_assign
id|DATAPTR
c_func
(paren
id|ibh
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
op_plus
id|st-&gt;l2.ihsize
comma
id|ibh-&gt;datasize
op_minus
id|st-&gt;l2.ihsize
comma
id|IE_CAUSE
comma
l_int|0
)paren
)paren
)paren
(brace
id|p
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
op_increment
op_eq
l_int|2
)paren
id|st-&gt;pa-&gt;loc
op_assign
op_star
id|p
op_increment
suffix:semicolon
id|cause
op_assign
op_star
id|p
op_amp
l_int|0x7f
suffix:semicolon
)brace
id|BufPoolRelease
c_func
(paren
id|ibh
)paren
suffix:semicolon
id|StopAllL3Timer
c_func
(paren
id|st
)paren
suffix:semicolon
id|st-&gt;pa-&gt;cause
op_assign
id|cause
suffix:semicolon
id|newl3state
c_func
(paren
id|st
comma
l_int|0
)paren
suffix:semicolon
id|st-&gt;l3
dot
id|l3l4
c_func
(paren
id|st
comma
id|CC_RELEASE_CNF
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_setup_req
id|l3dss1_setup_req
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
id|byte
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|BufHeader
op_star
id|dibh
suffix:semicolon
id|byte
op_star
id|p
suffix:semicolon
r_char
op_star
id|teln
suffix:semicolon
id|st-&gt;l3.callref
op_assign
id|st-&gt;pa-&gt;callref
suffix:semicolon
id|BufPoolGet
c_func
(paren
op_amp
id|dibh
comma
id|st-&gt;l1.sbufpool
comma
id|GFP_ATOMIC
comma
(paren
r_void
op_star
)paren
id|st
comma
l_int|19
)paren
suffix:semicolon
id|p
op_assign
id|DATAPTR
c_func
(paren
id|dibh
)paren
suffix:semicolon
id|p
op_add_assign
id|st-&gt;l2.ihsize
suffix:semicolon
id|MsgHead
c_func
(paren
id|p
comma
id|st-&gt;l3.callref
comma
id|MT_SETUP
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Set Bearer Capability, Map info from 1TR6-convention to EDSS1&n;&t; */
op_star
id|p
op_increment
op_assign
l_int|0xa1
suffix:semicolon
r_switch
c_cond
(paren
id|st-&gt;pa-&gt;setup.si1
)paren
(brace
r_case
l_int|1
suffix:colon
multiline_comment|/* Telephony                               */
op_star
id|p
op_increment
op_assign
l_int|0x4
suffix:semicolon
multiline_comment|/* BC-IE-code                              */
op_star
id|p
op_increment
op_assign
l_int|0x3
suffix:semicolon
multiline_comment|/* Length                                  */
op_star
id|p
op_increment
op_assign
l_int|0x90
suffix:semicolon
multiline_comment|/* Coding Std. CCITT, 3.1 kHz audio     */
op_star
id|p
op_increment
op_assign
l_int|0x90
suffix:semicolon
multiline_comment|/* Circuit-Mode 64kbps                     */
op_star
id|p
op_increment
op_assign
l_int|0xa3
suffix:semicolon
multiline_comment|/* A-Law Audio                             */
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
multiline_comment|/* Datatransmission 64k, BTX               */
r_case
l_int|7
suffix:colon
multiline_comment|/* Datatransmission 64k                    */
r_default
suffix:colon
op_star
id|p
op_increment
op_assign
l_int|0x4
suffix:semicolon
multiline_comment|/* BC-IE-code                              */
op_star
id|p
op_increment
op_assign
l_int|0x2
suffix:semicolon
multiline_comment|/* Length                                  */
op_star
id|p
op_increment
op_assign
l_int|0x88
suffix:semicolon
multiline_comment|/* Coding Std. CCITT, unrestr. dig. Inform. */
op_star
id|p
op_increment
op_assign
l_int|0x90
suffix:semicolon
multiline_comment|/* Circuit-Mode 64kbps                      */
r_break
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * What about info2? Mapping to High-Layer-Compatibility?&n;&t; */
r_if
c_cond
(paren
id|st-&gt;pa-&gt;setup.eazmsn
(braket
l_int|0
)braket
)paren
(brace
op_star
id|p
op_increment
op_assign
l_int|0x6c
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|strlen
c_func
(paren
id|st-&gt;pa-&gt;setup.eazmsn
)paren
op_plus
l_int|1
suffix:semicolon
multiline_comment|/* Classify as AnyPref. */
op_star
id|p
op_increment
op_assign
l_int|0x81
suffix:semicolon
multiline_comment|/* Ext = &squot;1&squot;B, Type = &squot;000&squot;B, Plan = &squot;0001&squot;B. */
id|teln
op_assign
id|st-&gt;pa-&gt;setup.eazmsn
suffix:semicolon
r_while
c_loop
(paren
op_star
id|teln
)paren
op_star
id|p
op_increment
op_assign
op_star
id|teln
op_increment
op_amp
l_int|0x7f
suffix:semicolon
)brace
op_star
id|p
op_increment
op_assign
l_int|0x70
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|strlen
c_func
(paren
id|st-&gt;pa-&gt;setup.phone
)paren
op_plus
l_int|1
suffix:semicolon
multiline_comment|/* Classify as AnyPref. */
op_star
id|p
op_increment
op_assign
l_int|0x81
suffix:semicolon
multiline_comment|/* Ext = &squot;1&squot;B, Type = &squot;000&squot;B, Plan = &squot;0001&squot;B. */
id|teln
op_assign
id|st-&gt;pa-&gt;setup.phone
suffix:semicolon
r_while
c_loop
(paren
op_star
id|teln
)paren
op_star
id|p
op_increment
op_assign
op_star
id|teln
op_increment
op_amp
l_int|0x7f
suffix:semicolon
id|dibh-&gt;datasize
op_assign
id|p
op_minus
id|DATAPTR
c_func
(paren
id|dibh
)paren
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|st-&gt;l3.timer
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|st-&gt;l3.timer
comma
id|st-&gt;l3.t303
comma
id|CC_T303
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|st
comma
l_int|1
)paren
suffix:semicolon
id|st-&gt;l3
dot
id|l3l2
c_func
(paren
id|st
comma
id|DL_DATA
comma
id|dibh
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_call_proc
id|l3dss1_call_proc
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
id|byte
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|byte
op_star
id|p
suffix:semicolon
r_struct
id|BufHeader
op_star
id|ibh
op_assign
id|arg
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|st-&gt;l3.timer
)paren
suffix:semicolon
id|p
op_assign
id|DATAPTR
c_func
(paren
id|ibh
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
op_plus
id|st-&gt;l2.ihsize
comma
id|ibh-&gt;datasize
op_minus
id|st-&gt;l2.ihsize
comma
l_int|0x18
comma
l_int|0
)paren
)paren
)paren
(brace
id|st-&gt;pa-&gt;bchannel
op_assign
id|p
(braket
l_int|2
)braket
op_amp
l_int|0x3
suffix:semicolon
r_if
c_cond
(paren
(paren
op_logical_neg
id|st-&gt;pa-&gt;bchannel
)paren
op_logical_and
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_WARN
)paren
)paren
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;setup answer without bchannel&quot;
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;setup answer without bchannel&quot;
)paren
suffix:semicolon
id|BufPoolRelease
c_func
(paren
id|ibh
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|st
comma
l_int|3
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|st-&gt;l3.timer
comma
id|st-&gt;l3.t310
comma
id|CC_T310
)paren
suffix:semicolon
id|st-&gt;l3
dot
id|l3l4
c_func
(paren
id|st
comma
id|CC_PROCEEDING_IND
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_setup_ack
id|l3dss1_setup_ack
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
id|byte
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|byte
op_star
id|p
suffix:semicolon
r_struct
id|BufHeader
op_star
id|ibh
op_assign
id|arg
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|st-&gt;l3.timer
)paren
suffix:semicolon
id|p
op_assign
id|DATAPTR
c_func
(paren
id|ibh
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
op_plus
id|st-&gt;l2.ihsize
comma
id|ibh-&gt;datasize
op_minus
id|st-&gt;l2.ihsize
comma
l_int|0x18
comma
l_int|0
)paren
)paren
)paren
(brace
id|st-&gt;pa-&gt;bchannel
op_assign
id|p
(braket
l_int|2
)braket
op_amp
l_int|0x3
suffix:semicolon
r_if
c_cond
(paren
(paren
op_logical_neg
id|st-&gt;pa-&gt;bchannel
)paren
op_logical_and
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_WARN
)paren
)paren
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;setup answer without bchannel&quot;
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;setup answer without bchannel&quot;
)paren
suffix:semicolon
id|BufPoolRelease
c_func
(paren
id|ibh
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|st
comma
l_int|2
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|st-&gt;l3.timer
comma
id|st-&gt;l3.t304
comma
id|CC_T304
)paren
suffix:semicolon
id|st-&gt;l3
dot
id|l3l4
c_func
(paren
id|st
comma
id|CC_MORE_INFO
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_disconnect
id|l3dss1_disconnect
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
id|byte
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|byte
op_star
id|p
suffix:semicolon
r_struct
id|BufHeader
op_star
id|ibh
op_assign
id|arg
suffix:semicolon
r_int
id|cause
op_assign
op_minus
l_int|1
suffix:semicolon
id|StopAllL3Timer
c_func
(paren
id|st
)paren
suffix:semicolon
id|p
op_assign
id|DATAPTR
c_func
(paren
id|ibh
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
op_plus
id|st-&gt;l2.ihsize
comma
id|ibh-&gt;datasize
op_minus
id|st-&gt;l2.ihsize
comma
id|IE_CAUSE
comma
l_int|0
)paren
)paren
)paren
(brace
id|p
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
op_increment
op_eq
l_int|2
)paren
id|st-&gt;pa-&gt;loc
op_assign
op_star
id|p
op_increment
suffix:semicolon
id|cause
op_assign
op_star
id|p
op_amp
l_int|0x7f
suffix:semicolon
)brace
id|BufPoolRelease
c_func
(paren
id|ibh
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|st
comma
l_int|12
)paren
suffix:semicolon
id|st-&gt;pa-&gt;cause
op_assign
id|cause
suffix:semicolon
id|st-&gt;l3
dot
id|l3l4
c_func
(paren
id|st
comma
id|CC_DISCONNECT_IND
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_connect
id|l3dss1_connect
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
id|byte
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|BufHeader
op_star
id|ibh
op_assign
id|arg
suffix:semicolon
id|BufPoolRelease
c_func
(paren
id|ibh
)paren
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|st-&gt;l3.timer
)paren
suffix:semicolon
multiline_comment|/* T310 */
id|newl3state
c_func
(paren
id|st
comma
l_int|10
)paren
suffix:semicolon
id|st-&gt;l3
dot
id|l3l4
c_func
(paren
id|st
comma
id|CC_SETUP_CNF
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_alerting
id|l3dss1_alerting
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
id|byte
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|BufHeader
op_star
id|ibh
op_assign
id|arg
suffix:semicolon
id|BufPoolRelease
c_func
(paren
id|ibh
)paren
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|st-&gt;l3.timer
)paren
suffix:semicolon
multiline_comment|/* T304 */
id|newl3state
c_func
(paren
id|st
comma
l_int|4
)paren
suffix:semicolon
id|st-&gt;l3
dot
id|l3l4
c_func
(paren
id|st
comma
id|CC_ALERTING_IND
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_setup
id|l3dss1_setup
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
id|byte
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|byte
op_star
id|p
suffix:semicolon
r_int
id|bcfound
op_assign
l_int|0
suffix:semicolon
r_char
id|tmp
(braket
l_int|80
)braket
suffix:semicolon
r_struct
id|BufHeader
op_star
id|ibh
op_assign
id|arg
suffix:semicolon
id|p
op_assign
id|DATAPTR
c_func
(paren
id|ibh
)paren
suffix:semicolon
id|p
op_add_assign
id|st-&gt;l2.uihsize
suffix:semicolon
id|st-&gt;pa-&gt;callref
op_assign
id|getcallref
c_func
(paren
id|p
)paren
suffix:semicolon
id|st-&gt;l3.callref
op_assign
l_int|0x80
op_plus
id|st-&gt;pa-&gt;callref
suffix:semicolon
multiline_comment|/*&n;&t; * Channel Identification&n;&t; */
id|p
op_assign
id|DATAPTR
c_func
(paren
id|ibh
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
op_plus
id|st-&gt;l2.uihsize
comma
id|ibh-&gt;datasize
op_minus
id|st-&gt;l2.uihsize
comma
l_int|0x18
comma
l_int|0
)paren
)paren
)paren
(brace
id|st-&gt;pa-&gt;bchannel
op_assign
id|p
(braket
l_int|2
)braket
op_amp
l_int|0x3
suffix:semicolon
r_if
c_cond
(paren
id|st-&gt;pa-&gt;bchannel
)paren
id|bcfound
op_increment
suffix:semicolon
r_else
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;setup without bchannel&quot;
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;setup without bchannel&quot;
)paren
suffix:semicolon
id|p
op_assign
id|DATAPTR
c_func
(paren
id|ibh
)paren
suffix:semicolon
multiline_comment|/*&n;&t;   * Bearer Capabilities&n;&t; */
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
op_plus
id|st-&gt;l2.uihsize
comma
id|ibh-&gt;datasize
op_minus
id|st-&gt;l2.uihsize
comma
l_int|0x04
comma
l_int|0
)paren
)paren
)paren
(brace
id|st-&gt;pa-&gt;setup.si2
op_assign
l_int|0
suffix:semicolon
r_switch
c_cond
(paren
id|p
(braket
l_int|2
)braket
op_amp
l_int|0x1f
)paren
(brace
r_case
l_int|0x00
suffix:colon
multiline_comment|/* Speech */
r_case
l_int|0x10
suffix:colon
multiline_comment|/* 3.1 Khz audio */
id|st-&gt;pa-&gt;setup.si1
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x08
suffix:colon
multiline_comment|/* Unrestricted digital information */
id|st-&gt;pa-&gt;setup.si1
op_assign
l_int|7
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x09
suffix:colon
multiline_comment|/* Restricted digital information */
id|st-&gt;pa-&gt;setup.si1
op_assign
l_int|2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x11
suffix:colon
multiline_comment|/* Unrestr. digital information  with tones/announcements */
id|st-&gt;pa-&gt;setup.si1
op_assign
l_int|3
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x18
suffix:colon
multiline_comment|/* Video */
id|st-&gt;pa-&gt;setup.si1
op_assign
l_int|4
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|st-&gt;pa-&gt;setup.si1
op_assign
l_int|0
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;setup without bearer capabilities&quot;
)paren
suffix:semicolon
id|p
op_assign
id|DATAPTR
c_func
(paren
id|ibh
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
op_plus
id|st-&gt;l2.uihsize
comma
id|ibh-&gt;datasize
op_minus
id|st-&gt;l2.uihsize
comma
l_int|0x70
comma
l_int|0
)paren
)paren
)paren
id|iecpy
c_func
(paren
id|st-&gt;pa-&gt;setup.eazmsn
comma
id|p
comma
l_int|1
)paren
suffix:semicolon
r_else
id|st-&gt;pa-&gt;setup.eazmsn
(braket
l_int|0
)braket
op_assign
l_int|0
suffix:semicolon
id|p
op_assign
id|DATAPTR
c_func
(paren
id|ibh
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
op_plus
id|st-&gt;l2.uihsize
comma
id|ibh-&gt;datasize
op_minus
id|st-&gt;l2.uihsize
comma
l_int|0x6c
comma
l_int|0
)paren
)paren
)paren
(brace
id|st-&gt;pa-&gt;setup.plan
op_assign
id|p
(braket
l_int|2
)braket
suffix:semicolon
r_if
c_cond
(paren
id|p
(braket
l_int|2
)braket
op_amp
l_int|0x80
)paren
(brace
id|iecpy
c_func
(paren
id|st-&gt;pa-&gt;setup.phone
comma
id|p
comma
l_int|1
)paren
suffix:semicolon
id|st-&gt;pa-&gt;setup.screen
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|iecpy
c_func
(paren
id|st-&gt;pa-&gt;setup.phone
comma
id|p
comma
l_int|2
)paren
suffix:semicolon
id|st-&gt;pa-&gt;setup.screen
op_assign
id|p
(braket
l_int|3
)braket
suffix:semicolon
)brace
)brace
r_else
(brace
id|st-&gt;pa-&gt;setup.phone
(braket
l_int|0
)braket
op_assign
l_int|0
suffix:semicolon
id|st-&gt;pa-&gt;setup.plan
op_assign
l_int|0
suffix:semicolon
id|st-&gt;pa-&gt;setup.screen
op_assign
l_int|0
suffix:semicolon
)brace
id|BufPoolRelease
c_func
(paren
id|ibh
)paren
suffix:semicolon
r_if
c_cond
(paren
id|bcfound
)paren
(brace
r_if
c_cond
(paren
(paren
id|st-&gt;pa-&gt;setup.si1
op_ne
l_int|7
)paren
op_logical_and
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_WARN
)paren
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;non-digital call: %s -&gt; %s&quot;
comma
id|st-&gt;pa-&gt;setup.phone
comma
id|st-&gt;pa-&gt;setup.eazmsn
)paren
suffix:semicolon
id|l3_debug
c_func
(paren
id|st
comma
id|tmp
)paren
suffix:semicolon
)brace
id|newl3state
c_func
(paren
id|st
comma
l_int|6
)paren
suffix:semicolon
id|st-&gt;l3
dot
id|l3l4
c_func
(paren
id|st
comma
id|CC_SETUP_IND
comma
l_int|NULL
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|l3dss1_reset
id|l3dss1_reset
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
id|byte
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|StopAllL3Timer
c_func
(paren
id|st
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|st
comma
l_int|0
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_setup_rsp
id|l3dss1_setup_rsp
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
id|byte
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|newl3state
c_func
(paren
id|st
comma
l_int|8
)paren
suffix:semicolon
id|l3dss1_message
c_func
(paren
id|st
comma
id|MT_CONNECT
)paren
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|st-&gt;l3.timer
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|st-&gt;l3.timer
comma
id|st-&gt;l3.t313
comma
id|CC_T313
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_connect_ack
id|l3dss1_connect_ack
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
id|byte
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|BufHeader
op_star
id|ibh
op_assign
id|arg
suffix:semicolon
id|BufPoolRelease
c_func
(paren
id|ibh
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|st
comma
l_int|10
)paren
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|st-&gt;l3.timer
)paren
suffix:semicolon
id|st-&gt;l3
dot
id|l3l4
c_func
(paren
id|st
comma
id|CC_SETUP_COMPLETE_IND
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_disconnect_req
id|l3dss1_disconnect_req
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
id|byte
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|BufHeader
op_star
id|dibh
suffix:semicolon
id|byte
op_star
id|p
suffix:semicolon
id|byte
id|cause
op_assign
l_int|0x10
suffix:semicolon
r_if
c_cond
(paren
id|st-&gt;pa-&gt;cause
OG
l_int|0
)paren
id|cause
op_assign
id|st-&gt;pa-&gt;cause
suffix:semicolon
id|StopAllL3Timer
c_func
(paren
id|st
)paren
suffix:semicolon
id|BufPoolGet
c_func
(paren
op_amp
id|dibh
comma
id|st-&gt;l1.sbufpool
comma
id|GFP_ATOMIC
comma
(paren
r_void
op_star
)paren
id|st
comma
l_int|20
)paren
suffix:semicolon
id|p
op_assign
id|DATAPTR
c_func
(paren
id|dibh
)paren
suffix:semicolon
id|p
op_add_assign
id|st-&gt;l2.ihsize
suffix:semicolon
id|MsgHead
c_func
(paren
id|p
comma
id|st-&gt;l3.callref
comma
id|MT_DISCONNECT
)paren
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|IE_CAUSE
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x2
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x80
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|cause
op_or
l_int|0x80
suffix:semicolon
id|dibh-&gt;datasize
op_assign
id|p
op_minus
id|DATAPTR
c_func
(paren
id|dibh
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|st
comma
l_int|11
)paren
suffix:semicolon
id|st-&gt;l3
dot
id|l3l2
c_func
(paren
id|st
comma
id|DL_DATA
comma
id|dibh
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|st-&gt;l3.timer
comma
id|st-&gt;l3.t305
comma
id|CC_T305
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_reject_req
id|l3dss1_reject_req
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
id|byte
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|BufHeader
op_star
id|dibh
suffix:semicolon
id|byte
op_star
id|p
suffix:semicolon
id|byte
id|cause
op_assign
l_int|0x95
suffix:semicolon
r_if
c_cond
(paren
id|st-&gt;pa-&gt;cause
OG
l_int|0
)paren
id|cause
op_assign
id|st-&gt;pa-&gt;cause
suffix:semicolon
id|BufPoolGet
c_func
(paren
op_amp
id|dibh
comma
id|st-&gt;l1.sbufpool
comma
id|GFP_ATOMIC
comma
(paren
r_void
op_star
)paren
id|st
comma
l_int|20
)paren
suffix:semicolon
id|p
op_assign
id|DATAPTR
c_func
(paren
id|dibh
)paren
suffix:semicolon
id|p
op_add_assign
id|st-&gt;l2.ihsize
suffix:semicolon
id|MsgHead
c_func
(paren
id|p
comma
id|st-&gt;l3.callref
comma
id|MT_RELEASE_COMPLETE
)paren
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|IE_CAUSE
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x2
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x80
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|cause
suffix:semicolon
id|dibh-&gt;datasize
op_assign
id|p
op_minus
id|DATAPTR
c_func
(paren
id|dibh
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|st
comma
l_int|0
)paren
suffix:semicolon
id|st-&gt;l3
dot
id|l3l2
c_func
(paren
id|st
comma
id|DL_DATA
comma
id|dibh
)paren
suffix:semicolon
id|st-&gt;l3
dot
id|l3l4
c_func
(paren
id|st
comma
id|CC_RELEASE_IND
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_release
id|l3dss1_release
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
id|byte
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|byte
op_star
id|p
suffix:semicolon
r_struct
id|BufHeader
op_star
id|ibh
op_assign
id|arg
suffix:semicolon
r_int
id|cause
op_assign
op_minus
l_int|1
suffix:semicolon
id|p
op_assign
id|DATAPTR
c_func
(paren
id|ibh
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
op_plus
id|st-&gt;l2.ihsize
comma
id|ibh-&gt;datasize
op_minus
id|st-&gt;l2.ihsize
comma
id|IE_CAUSE
comma
l_int|0
)paren
)paren
)paren
(brace
id|p
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
op_increment
op_eq
l_int|2
)paren
id|st-&gt;pa-&gt;loc
op_assign
op_star
id|p
op_increment
suffix:semicolon
id|cause
op_assign
op_star
id|p
op_amp
l_int|0x7f
suffix:semicolon
)brace
id|BufPoolRelease
c_func
(paren
id|ibh
)paren
suffix:semicolon
id|StopAllL3Timer
c_func
(paren
id|st
)paren
suffix:semicolon
id|st-&gt;pa-&gt;cause
op_assign
id|cause
suffix:semicolon
id|newl3state
c_func
(paren
id|st
comma
l_int|0
)paren
suffix:semicolon
id|l3dss1_message
c_func
(paren
id|st
comma
id|MT_RELEASE_COMPLETE
)paren
suffix:semicolon
id|st-&gt;l3
dot
id|l3l4
c_func
(paren
id|st
comma
id|CC_RELEASE_IND
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_alert_req
id|l3dss1_alert_req
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
id|byte
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|newl3state
c_func
(paren
id|st
comma
l_int|7
)paren
suffix:semicolon
id|l3dss1_message
c_func
(paren
id|st
comma
id|MT_ALERTING
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_status_enq
id|l3dss1_status_enq
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
id|byte
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|BufHeader
op_star
id|dibh
op_assign
id|arg
suffix:semicolon
id|byte
op_star
id|p
suffix:semicolon
id|BufPoolRelease
c_func
(paren
id|dibh
)paren
suffix:semicolon
id|BufPoolGet
c_func
(paren
op_amp
id|dibh
comma
id|st-&gt;l1.sbufpool
comma
id|GFP_ATOMIC
comma
(paren
r_void
op_star
)paren
id|st
comma
l_int|22
)paren
suffix:semicolon
id|p
op_assign
id|DATAPTR
c_func
(paren
id|dibh
)paren
suffix:semicolon
id|p
op_add_assign
id|st-&gt;l2.ihsize
suffix:semicolon
id|MsgHead
c_func
(paren
id|p
comma
id|st-&gt;l3.callref
comma
id|MT_STATUS
)paren
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|IE_CAUSE
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x2
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x80
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x9E
suffix:semicolon
multiline_comment|/* answer status enquire */
op_star
id|p
op_increment
op_assign
l_int|0x14
suffix:semicolon
multiline_comment|/* CallState */
op_star
id|p
op_increment
op_assign
l_int|0x1
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|st-&gt;l3.state
op_amp
l_int|0x3f
suffix:semicolon
id|dibh-&gt;datasize
op_assign
id|p
op_minus
id|DATAPTR
c_func
(paren
id|dibh
)paren
suffix:semicolon
id|st-&gt;l3
dot
id|l3l2
c_func
(paren
id|st
comma
id|DL_DATA
comma
id|dibh
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_t303
id|l3dss1_t303
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
id|byte
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_if
c_cond
(paren
id|st-&gt;l3.n_t303
OG
l_int|0
)paren
(brace
id|st-&gt;l3.n_t303
op_decrement
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|st-&gt;l3.timer
)paren
suffix:semicolon
id|l3dss1_setup_req
c_func
(paren
id|st
comma
id|pr
comma
id|arg
)paren
suffix:semicolon
)brace
r_else
(brace
id|newl3state
c_func
(paren
id|st
comma
l_int|0
)paren
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|st-&gt;l3.timer
)paren
suffix:semicolon
id|st-&gt;l3
dot
id|l3l4
c_func
(paren
id|st
comma
id|CC_NOSETUP_RSP_ERR
comma
l_int|NULL
)paren
suffix:semicolon
id|st-&gt;l3.n_t303
op_assign
l_int|1
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|l3dss1_t304
id|l3dss1_t304
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
id|byte
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|L3DelTimer
c_func
(paren
op_amp
id|st-&gt;l3.timer
)paren
suffix:semicolon
id|st-&gt;pa-&gt;cause
op_assign
l_int|0xE6
suffix:semicolon
id|l3dss1_disconnect_req
c_func
(paren
id|st
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
id|st-&gt;l3
dot
id|l3l4
c_func
(paren
id|st
comma
id|CC_SETUP_ERR
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_t305
id|l3dss1_t305
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
id|byte
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|BufHeader
op_star
id|dibh
suffix:semicolon
id|byte
op_star
id|p
suffix:semicolon
id|byte
id|cause
op_assign
l_int|0x90
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|st-&gt;l3.timer
)paren
suffix:semicolon
r_if
c_cond
(paren
id|st-&gt;pa-&gt;cause
OG
l_int|0
)paren
id|cause
op_assign
id|st-&gt;pa-&gt;cause
suffix:semicolon
id|BufPoolGet
c_func
(paren
op_amp
id|dibh
comma
id|st-&gt;l1.sbufpool
comma
id|GFP_ATOMIC
comma
(paren
r_void
op_star
)paren
id|st
comma
l_int|20
)paren
suffix:semicolon
id|p
op_assign
id|DATAPTR
c_func
(paren
id|dibh
)paren
suffix:semicolon
id|p
op_add_assign
id|st-&gt;l2.ihsize
suffix:semicolon
id|MsgHead
c_func
(paren
id|p
comma
id|st-&gt;l3.callref
comma
id|MT_RELEASE
)paren
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|IE_CAUSE
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x2
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x80
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|cause
suffix:semicolon
id|dibh-&gt;datasize
op_assign
id|p
op_minus
id|DATAPTR
c_func
(paren
id|dibh
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|st
comma
l_int|19
)paren
suffix:semicolon
id|st-&gt;l3
dot
id|l3l2
c_func
(paren
id|st
comma
id|DL_DATA
comma
id|dibh
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|st-&gt;l3.timer
comma
id|st-&gt;l3.t308
comma
id|CC_T308_1
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_t310
id|l3dss1_t310
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
id|byte
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|L3DelTimer
c_func
(paren
op_amp
id|st-&gt;l3.timer
)paren
suffix:semicolon
id|st-&gt;pa-&gt;cause
op_assign
l_int|0xE6
suffix:semicolon
id|l3dss1_disconnect_req
c_func
(paren
id|st
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
id|st-&gt;l3
dot
id|l3l4
c_func
(paren
id|st
comma
id|CC_SETUP_ERR
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_t313
id|l3dss1_t313
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
id|byte
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|L3DelTimer
c_func
(paren
op_amp
id|st-&gt;l3.timer
)paren
suffix:semicolon
id|st-&gt;pa-&gt;cause
op_assign
l_int|0xE6
suffix:semicolon
id|l3dss1_disconnect_req
c_func
(paren
id|st
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
id|st-&gt;l3
dot
id|l3l4
c_func
(paren
id|st
comma
id|CC_CONNECT_ERR
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_t308_1
id|l3dss1_t308_1
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
id|byte
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|newl3state
c_func
(paren
id|st
comma
l_int|19
)paren
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|st-&gt;l3.timer
)paren
suffix:semicolon
id|l3dss1_message
c_func
(paren
id|st
comma
id|MT_RELEASE
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|st-&gt;l3.timer
comma
id|st-&gt;l3.t308
comma
id|CC_T308_2
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_t308_2
id|l3dss1_t308_2
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
id|byte
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|newl3state
c_func
(paren
id|st
comma
l_int|0
)paren
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|st-&gt;l3.timer
)paren
suffix:semicolon
id|st-&gt;l3
dot
id|l3l4
c_func
(paren
id|st
comma
id|CC_RELEASE_ERR
comma
l_int|NULL
)paren
suffix:semicolon
)brace
DECL|variable|downstatelist
r_static
r_struct
id|stateentry
id|downstatelist
(braket
)braket
op_assign
(brace
(brace
id|SBIT
c_func
(paren
l_int|0
)paren
comma
id|CC_SETUP_REQ
comma
id|l3dss1_setup_req
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|1
)paren
op_or
id|SBIT
c_func
(paren
l_int|2
)paren
op_or
id|SBIT
c_func
(paren
l_int|3
)paren
op_or
id|SBIT
c_func
(paren
l_int|4
)paren
op_or
id|SBIT
c_func
(paren
l_int|6
)paren
op_or
id|SBIT
c_func
(paren
l_int|7
)paren
op_or
id|SBIT
c_func
(paren
l_int|8
)paren
op_or
id|SBIT
c_func
(paren
l_int|10
)paren
comma
id|CC_DISCONNECT_REQ
comma
id|l3dss1_disconnect_req
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|12
)paren
comma
id|CC_RELEASE_REQ
comma
id|l3dss1_release_req
)brace
comma
(brace
id|ALL_STATES
comma
id|CC_DLRL
comma
id|l3dss1_reset
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|6
)paren
comma
id|CC_IGNORE
comma
id|l3dss1_reset
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|6
)paren
comma
id|CC_REJECT_REQ
comma
id|l3dss1_reject_req
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|6
)paren
comma
id|CC_ALERTING_REQ
comma
id|l3dss1_alert_req
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|6
)paren
op_or
id|SBIT
c_func
(paren
l_int|7
)paren
comma
id|CC_SETUP_RSP
comma
id|l3dss1_setup_rsp
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|1
)paren
comma
id|CC_T303
comma
id|l3dss1_t303
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|2
)paren
comma
id|CC_T304
comma
id|l3dss1_t304
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|3
)paren
comma
id|CC_T310
comma
id|l3dss1_t310
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|8
)paren
comma
id|CC_T313
comma
id|l3dss1_t313
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|11
)paren
comma
id|CC_T305
comma
id|l3dss1_t305
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|19
)paren
comma
id|CC_T308_1
comma
id|l3dss1_t308_1
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|19
)paren
comma
id|CC_T308_2
comma
id|l3dss1_t308_2
)brace
comma
)brace
suffix:semicolon
DECL|variable|downsllen
r_static
r_int
id|downsllen
op_assign
r_sizeof
(paren
id|downstatelist
)paren
op_div
r_sizeof
(paren
r_struct
id|stateentry
)paren
suffix:semicolon
DECL|variable|datastatelist
r_static
r_struct
id|stateentry
id|datastatelist
(braket
)braket
op_assign
(brace
(brace
id|ALL_STATES
comma
id|MT_STATUS_ENQUIRY
comma
id|l3dss1_status_enq
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|0
)paren
op_or
id|SBIT
c_func
(paren
l_int|6
)paren
comma
id|MT_SETUP
comma
id|l3dss1_setup
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|1
)paren
op_or
id|SBIT
c_func
(paren
l_int|2
)paren
comma
id|MT_CALL_PROCEEDING
comma
id|l3dss1_call_proc
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|1
)paren
comma
id|MT_SETUP_ACKNOWLEDGE
comma
id|l3dss1_setup_ack
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|1
)paren
op_or
id|SBIT
c_func
(paren
l_int|2
)paren
op_or
id|SBIT
c_func
(paren
l_int|3
)paren
comma
id|MT_ALERTING
comma
id|l3dss1_alerting
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|0
)paren
op_or
id|SBIT
c_func
(paren
l_int|1
)paren
op_or
id|SBIT
c_func
(paren
l_int|2
)paren
op_or
id|SBIT
c_func
(paren
l_int|3
)paren
op_or
id|SBIT
c_func
(paren
l_int|4
)paren
op_or
id|SBIT
c_func
(paren
l_int|7
)paren
op_or
id|SBIT
c_func
(paren
l_int|8
)paren
op_or
id|SBIT
c_func
(paren
l_int|10
)paren
op_or
id|SBIT
c_func
(paren
l_int|11
)paren
op_or
id|SBIT
c_func
(paren
l_int|12
)paren
op_or
id|SBIT
c_func
(paren
l_int|15
)paren
op_or
id|SBIT
c_func
(paren
l_int|17
)paren
op_or
id|SBIT
c_func
(paren
l_int|19
)paren
comma
id|MT_RELEASE_COMPLETE
comma
id|l3dss1_release_cmpl
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|0
)paren
op_or
id|SBIT
c_func
(paren
l_int|1
)paren
op_or
id|SBIT
c_func
(paren
l_int|2
)paren
op_or
id|SBIT
c_func
(paren
l_int|3
)paren
op_or
id|SBIT
c_func
(paren
l_int|4
)paren
op_or
id|SBIT
c_func
(paren
l_int|7
)paren
op_or
id|SBIT
c_func
(paren
l_int|8
)paren
op_or
id|SBIT
c_func
(paren
l_int|10
)paren
op_or
id|SBIT
c_func
(paren
l_int|11
)paren
op_or
id|SBIT
c_func
(paren
l_int|12
)paren
op_or
id|SBIT
c_func
(paren
l_int|15
)paren
op_or
id|SBIT
c_func
(paren
l_int|17
)paren
op_or
id|SBIT
c_func
(paren
l_int|19
)paren
comma
id|MT_RELEASE
comma
id|l3dss1_release
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|1
)paren
op_or
id|SBIT
c_func
(paren
l_int|2
)paren
op_or
id|SBIT
c_func
(paren
l_int|3
)paren
op_or
id|SBIT
c_func
(paren
l_int|4
)paren
op_or
id|SBIT
c_func
(paren
l_int|7
)paren
op_or
id|SBIT
c_func
(paren
l_int|8
)paren
op_or
id|SBIT
c_func
(paren
l_int|10
)paren
comma
id|MT_DISCONNECT
comma
id|l3dss1_disconnect
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|1
)paren
op_or
id|SBIT
c_func
(paren
l_int|2
)paren
op_or
id|SBIT
c_func
(paren
l_int|3
)paren
op_or
id|SBIT
c_func
(paren
l_int|4
)paren
comma
id|MT_CONNECT
comma
id|l3dss1_connect
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|8
)paren
comma
id|MT_CONNECT_ACKNOWLEDGE
comma
id|l3dss1_connect_ack
)brace
comma
)brace
suffix:semicolon
DECL|variable|datasllen
r_static
r_int
id|datasllen
op_assign
r_sizeof
(paren
id|datastatelist
)paren
op_div
r_sizeof
(paren
r_struct
id|stateentry
)paren
suffix:semicolon
r_static
r_void
DECL|function|dss1up
id|dss1up
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_int
id|i
comma
id|mt
comma
id|size
suffix:semicolon
id|byte
op_star
id|ptr
suffix:semicolon
r_struct
id|BufHeader
op_star
id|ibh
op_assign
id|arg
suffix:semicolon
r_char
id|tmp
(braket
l_int|80
)braket
suffix:semicolon
r_if
c_cond
(paren
id|pr
op_eq
id|DL_DATA
)paren
(brace
id|ptr
op_assign
id|DATAPTR
c_func
(paren
id|ibh
)paren
suffix:semicolon
id|ptr
op_add_assign
id|st-&gt;l2.ihsize
suffix:semicolon
id|size
op_assign
id|ibh-&gt;datasize
op_minus
id|st-&gt;l2.ihsize
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|pr
op_eq
id|DL_UNIT_DATA
)paren
(brace
id|ptr
op_assign
id|DATAPTR
c_func
(paren
id|ibh
)paren
suffix:semicolon
id|ptr
op_add_assign
id|st-&gt;l2.uihsize
suffix:semicolon
id|size
op_assign
id|ibh-&gt;datasize
op_minus
id|st-&gt;l2.uihsize
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_WARN
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;dss1up unknown data typ %d state %d&quot;
comma
id|pr
comma
id|st-&gt;l3.state
)paren
suffix:semicolon
id|l3_debug
c_func
(paren
id|st
comma
id|tmp
)paren
suffix:semicolon
)brace
id|BufPoolRelease
c_func
(paren
id|ibh
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ptr
(braket
l_int|0
)braket
op_ne
id|PROTO_DIS_EURO
)paren
(brace
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_PROTERR
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;dss1up%sunexpected discriminator %x message len %d state %d&quot;
comma
(paren
id|pr
op_eq
id|DL_DATA
)paren
ques
c_cond
l_string|&quot; &quot;
suffix:colon
l_string|&quot;(broadcast) &quot;
comma
id|ptr
(braket
l_int|0
)braket
comma
id|size
comma
id|st-&gt;l3.state
)paren
suffix:semicolon
id|l3_debug
c_func
(paren
id|st
comma
id|tmp
)paren
suffix:semicolon
)brace
id|BufPoolRelease
c_func
(paren
id|ibh
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|mt
op_assign
id|ptr
(braket
l_int|3
)braket
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|datasllen
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
(paren
id|mt
op_eq
id|datastatelist
(braket
id|i
)braket
dot
id|primitive
)paren
op_logical_and
(paren
(paren
l_int|1
op_lshift
id|st-&gt;l3.state
)paren
op_amp
id|datastatelist
(braket
id|i
)braket
dot
id|state
)paren
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|i
op_eq
id|datasllen
)paren
(brace
id|BufPoolRelease
c_func
(paren
id|ibh
)paren
suffix:semicolon
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_STATE
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;dss1up%sstate %d mt %x unhandled&quot;
comma
(paren
id|pr
op_eq
id|DL_DATA
)paren
ques
c_cond
l_string|&quot; &quot;
suffix:colon
l_string|&quot;(broadcast) &quot;
comma
id|st-&gt;l3.state
comma
id|mt
)paren
suffix:semicolon
id|l3_debug
c_func
(paren
id|st
comma
id|tmp
)paren
suffix:semicolon
)brace
r_return
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_STATE
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;dss1up%sstate %d mt %x&quot;
comma
(paren
id|pr
op_eq
id|DL_DATA
)paren
ques
c_cond
l_string|&quot; &quot;
suffix:colon
l_string|&quot;(broadcast) &quot;
comma
id|st-&gt;l3.state
comma
id|mt
)paren
suffix:semicolon
id|l3_debug
c_func
(paren
id|st
comma
id|tmp
)paren
suffix:semicolon
)brace
id|datastatelist
(braket
id|i
)braket
dot
id|rout
c_func
(paren
id|st
comma
id|pr
comma
id|ibh
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|dss1down
id|dss1down
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_int
id|i
suffix:semicolon
r_struct
id|BufHeader
op_star
id|ibh
op_assign
id|arg
suffix:semicolon
r_char
id|tmp
(braket
l_int|80
)braket
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|downsllen
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
(paren
id|pr
op_eq
id|downstatelist
(braket
id|i
)braket
dot
id|primitive
)paren
op_logical_and
(paren
(paren
l_int|1
op_lshift
id|st-&gt;l3.state
)paren
op_amp
id|downstatelist
(braket
id|i
)braket
dot
id|state
)paren
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|i
op_eq
id|downsllen
)paren
(brace
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_STATE
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;dss1down state %d prim %d unhandled&quot;
comma
id|st-&gt;l3.state
comma
id|pr
)paren
suffix:semicolon
id|l3_debug
c_func
(paren
id|st
comma
id|tmp
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_STATE
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;dss1down state %d prim %d&quot;
comma
id|st-&gt;l3.state
comma
id|pr
)paren
suffix:semicolon
id|l3_debug
c_func
(paren
id|st
comma
id|tmp
)paren
suffix:semicolon
)brace
id|downstatelist
(braket
id|i
)braket
dot
id|rout
c_func
(paren
id|st
comma
id|pr
comma
id|ibh
)paren
suffix:semicolon
)brace
)brace
r_void
DECL|function|setstack_dss1
id|setstack_dss1
c_func
(paren
r_struct
id|PStack
op_star
id|st
)paren
(brace
r_char
id|tmp
(braket
l_int|64
)braket
suffix:semicolon
id|st-&gt;l4.l4l3
op_assign
id|dss1down
suffix:semicolon
id|st-&gt;l2.l2l3
op_assign
id|dss1up
suffix:semicolon
id|st-&gt;l3.t303
op_assign
l_int|4000
suffix:semicolon
id|st-&gt;l3.t304
op_assign
l_int|30000
suffix:semicolon
id|st-&gt;l3.t305
op_assign
l_int|30000
suffix:semicolon
id|st-&gt;l3.t308
op_assign
l_int|4000
suffix:semicolon
id|st-&gt;l3.t310
op_assign
l_int|30000
suffix:semicolon
id|st-&gt;l3.t313
op_assign
l_int|4000
suffix:semicolon
id|st-&gt;l3.t318
op_assign
l_int|4000
suffix:semicolon
id|st-&gt;l3.t319
op_assign
l_int|4000
suffix:semicolon
id|st-&gt;l3.n_t303
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|st-&gt;l3.channr
op_amp
l_int|1
)paren
(brace
id|strcpy
c_func
(paren
id|tmp
comma
id|dss1_revision
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_NOTICE
l_string|&quot;HiSax: DSS1 Rev. %s&bslash;n&quot;
comma
id|HiSax_getrev
c_func
(paren
id|tmp
)paren
)paren
suffix:semicolon
)brace
)brace
eof
