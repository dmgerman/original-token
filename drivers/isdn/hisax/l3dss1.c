multiline_comment|/* $Id: l3dss1.c,v 2.30 2000/11/19 17:02:48 kai Exp $&n; *&n; * EURO/DSS1 D-channel protocol&n; *&n; * Author       Karsten Keil (keil@isdn4linux.de)&n; *              based on the teles driver from Jan den Ouden&n; *&n; *&t;&t;This file is (c) under GNU PUBLIC LICENSE&n; *&t;&t;For changes and modifications please read&n; *&t;&t;../../../Documentation/isdn/HiSax.cert&n; *&n; * Thanks to    Jan den Ouden&n; *              Fritz Elfert&n; *&n; */
DECL|macro|__NO_VERSION__
mdefine_line|#define __NO_VERSION__
macro_line|#include &quot;hisax.h&quot;
macro_line|#include &quot;isdnl3.h&quot;
macro_line|#include &quot;l3dss1.h&quot;
macro_line|#include &lt;linux/ctype.h&gt;
macro_line|#include &lt;linux/config.h&gt;
r_extern
r_char
op_star
id|HiSax_getrev
c_func
(paren
r_const
r_char
op_star
id|revision
)paren
suffix:semicolon
DECL|variable|dss1_revision
r_const
r_char
op_star
id|dss1_revision
op_assign
l_string|&quot;$Revision: 2.30 $&quot;
suffix:semicolon
DECL|macro|EXT_BEARER_CAPS
mdefine_line|#define EXT_BEARER_CAPS 1
DECL|macro|MsgHead
mdefine_line|#define&t;MsgHead(ptr, cref, mty) &bslash;&n;&t;*ptr++ = 0x8; &bslash;&n;&t;if (cref == -1) { &bslash;&n;&t;&t;*ptr++ = 0x0; &bslash;&n;&t;} else { &bslash;&n;&t;&t;*ptr++ = 0x1; &bslash;&n;&t;&t;*ptr++ = cref^0x80; &bslash;&n;&t;} &bslash;&n;&t;*ptr++ = mty
multiline_comment|/**********************************************/
multiline_comment|/* get a new invoke id for remote operations. */
multiline_comment|/* Only a return value != 0 is valid          */
multiline_comment|/**********************************************/
DECL|function|new_invoke_id
r_static
r_int
r_char
id|new_invoke_id
c_func
(paren
r_struct
id|PStack
op_star
id|p
)paren
(brace
r_int
r_char
id|retval
suffix:semicolon
r_int
id|flags
comma
id|i
suffix:semicolon
id|i
op_assign
l_int|32
suffix:semicolon
multiline_comment|/* maximum search depth */
id|save_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
id|cli
c_func
(paren
)paren
suffix:semicolon
id|retval
op_assign
id|p-&gt;prot.dss1.last_invoke_id
op_plus
l_int|1
suffix:semicolon
multiline_comment|/* try new id */
r_while
c_loop
(paren
(paren
id|i
)paren
op_logical_and
(paren
id|p-&gt;prot.dss1.invoke_used
(braket
id|retval
op_rshift
l_int|3
)braket
op_eq
l_int|0xFF
)paren
)paren
(brace
id|p-&gt;prot.dss1.last_invoke_id
op_assign
(paren
id|retval
op_amp
l_int|0xF8
)paren
op_plus
l_int|8
suffix:semicolon
id|i
op_decrement
suffix:semicolon
)brace
r_if
c_cond
(paren
id|i
)paren
(brace
r_while
c_loop
(paren
id|p-&gt;prot.dss1.invoke_used
(braket
id|retval
op_rshift
l_int|3
)braket
op_amp
(paren
l_int|1
op_lshift
(paren
id|retval
op_amp
l_int|7
)paren
)paren
)paren
id|retval
op_increment
suffix:semicolon
)brace
r_else
id|retval
op_assign
l_int|0
suffix:semicolon
id|p-&gt;prot.dss1.last_invoke_id
op_assign
id|retval
suffix:semicolon
id|p-&gt;prot.dss1.invoke_used
(braket
id|retval
op_rshift
l_int|3
)braket
op_or_assign
(paren
l_int|1
op_lshift
(paren
id|retval
op_amp
l_int|7
)paren
)paren
suffix:semicolon
id|restore_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
r_return
id|retval
suffix:semicolon
)brace
multiline_comment|/* new_invoke_id */
multiline_comment|/*************************/
multiline_comment|/* free a used invoke id */
multiline_comment|/*************************/
DECL|function|free_invoke_id
r_static
r_void
id|free_invoke_id
c_func
(paren
r_struct
id|PStack
op_star
id|p
comma
r_int
r_char
id|id
)paren
(brace
r_int
id|flags
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|id
)paren
r_return
suffix:semicolon
multiline_comment|/* 0 = invalid value */
id|save_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
id|cli
c_func
(paren
)paren
suffix:semicolon
id|p-&gt;prot.dss1.invoke_used
(braket
id|id
op_rshift
l_int|3
)braket
op_and_assign
op_complement
(paren
l_int|1
op_lshift
(paren
id|id
op_amp
l_int|7
)paren
)paren
suffix:semicolon
id|restore_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
)brace
multiline_comment|/* free_invoke_id */
multiline_comment|/**********************************************************/
multiline_comment|/* create a new l3 process and fill in dss1 specific data */
multiline_comment|/**********************************************************/
r_static
r_struct
id|l3_process
DECL|function|dss1_new_l3_process
op_star
id|dss1_new_l3_process
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|cr
)paren
(brace
r_struct
id|l3_process
op_star
id|proc
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|proc
op_assign
id|new_l3_process
c_func
(paren
id|st
comma
id|cr
)paren
)paren
)paren
r_return
l_int|NULL
suffix:semicolon
id|proc-&gt;prot.dss1.invoke_id
op_assign
l_int|0
suffix:semicolon
id|proc-&gt;prot.dss1.remote_operation
op_assign
l_int|0
suffix:semicolon
id|proc-&gt;prot.dss1.uus1_data
(braket
l_int|0
)braket
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
r_return
id|proc
suffix:semicolon
)brace
multiline_comment|/* dss1_new_l3_process */
multiline_comment|/************************************************/
multiline_comment|/* free a l3 process and all dss1 specific data */
multiline_comment|/************************************************/
r_static
r_void
DECL|function|dss1_release_l3_process
id|dss1_release_l3_process
c_func
(paren
r_struct
id|l3_process
op_star
id|p
)paren
(brace
id|free_invoke_id
c_func
(paren
id|p-&gt;st
comma
id|p-&gt;prot.dss1.invoke_id
)paren
suffix:semicolon
id|release_l3_process
c_func
(paren
id|p
)paren
suffix:semicolon
)brace
multiline_comment|/* dss1_release_l3_process */
multiline_comment|/********************************************************/
multiline_comment|/* search a process with invoke id id and dummy callref */
multiline_comment|/********************************************************/
r_static
r_struct
id|l3_process
op_star
DECL|function|l3dss1_search_dummy_proc
id|l3dss1_search_dummy_proc
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|id
)paren
(brace
r_struct
id|l3_process
op_star
id|pc
op_assign
id|st-&gt;l3.proc
suffix:semicolon
multiline_comment|/* start of processes */
r_if
c_cond
(paren
op_logical_neg
id|id
)paren
r_return
l_int|NULL
suffix:semicolon
r_while
c_loop
(paren
id|pc
)paren
(brace
r_if
c_cond
(paren
(paren
id|pc-&gt;callref
op_eq
op_minus
l_int|1
)paren
op_logical_and
(paren
id|pc-&gt;prot.dss1.invoke_id
op_eq
id|id
)paren
)paren
r_return
id|pc
suffix:semicolon
id|pc
op_assign
id|pc-&gt;next
suffix:semicolon
)brace
r_return
l_int|NULL
suffix:semicolon
)brace
multiline_comment|/* l3dss1_search_dummy_proc */
multiline_comment|/*******************************************************************/
multiline_comment|/* called when a facility message with a dummy callref is received */
multiline_comment|/* and a return result is delivered. id specifies the invoke id.   */
multiline_comment|/*******************************************************************/
r_static
r_void
DECL|function|l3dss1_dummy_return_result
id|l3dss1_dummy_return_result
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|id
comma
id|u_char
op_star
id|p
comma
id|u_char
id|nlen
)paren
(brace
id|isdn_ctrl
id|ic
suffix:semicolon
r_struct
id|IsdnCardState
op_star
id|cs
suffix:semicolon
r_struct
id|l3_process
op_star
id|pc
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
(paren
id|pc
op_assign
id|l3dss1_search_dummy_proc
c_func
(paren
id|st
comma
id|id
)paren
)paren
)paren
(brace
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
multiline_comment|/* remove timer */
id|cs
op_assign
id|pc-&gt;st-&gt;l1.hardware
suffix:semicolon
id|ic.driver
op_assign
id|cs-&gt;myid
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_PROT
suffix:semicolon
id|ic.arg
op_assign
id|DSS1_STAT_INVOKE_RES
suffix:semicolon
id|ic.parm.dss1_io.hl_id
op_assign
id|pc-&gt;prot.dss1.invoke_id
suffix:semicolon
id|ic.parm.dss1_io.ll_id
op_assign
id|pc-&gt;prot.dss1.ll_id
suffix:semicolon
id|ic.parm.dss1_io.proc
op_assign
id|pc-&gt;prot.dss1.proc
suffix:semicolon
id|ic.parm.dss1_io.timeout
op_assign
l_int|0
suffix:semicolon
id|ic.parm.dss1_io.datalen
op_assign
id|nlen
suffix:semicolon
id|ic.parm.dss1_io.data
op_assign
id|p
suffix:semicolon
id|free_invoke_id
c_func
(paren
id|pc-&gt;st
comma
id|pc-&gt;prot.dss1.invoke_id
)paren
suffix:semicolon
id|pc-&gt;prot.dss1.invoke_id
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* reset id */
id|cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
id|dss1_release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
)brace
r_else
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;dummy return result id=0x%x result len=%d&quot;
comma
id|id
comma
id|nlen
)paren
suffix:semicolon
)brace
multiline_comment|/* l3dss1_dummy_return_result */
multiline_comment|/*******************************************************************/
multiline_comment|/* called when a facility message with a dummy callref is received */
multiline_comment|/* and a return error is delivered. id specifies the invoke id.    */
multiline_comment|/*******************************************************************/
r_static
r_void
DECL|function|l3dss1_dummy_error_return
id|l3dss1_dummy_error_return
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|id
comma
id|ulong
id|error
)paren
(brace
id|isdn_ctrl
id|ic
suffix:semicolon
r_struct
id|IsdnCardState
op_star
id|cs
suffix:semicolon
r_struct
id|l3_process
op_star
id|pc
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
(paren
id|pc
op_assign
id|l3dss1_search_dummy_proc
c_func
(paren
id|st
comma
id|id
)paren
)paren
)paren
(brace
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
multiline_comment|/* remove timer */
id|cs
op_assign
id|pc-&gt;st-&gt;l1.hardware
suffix:semicolon
id|ic.driver
op_assign
id|cs-&gt;myid
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_PROT
suffix:semicolon
id|ic.arg
op_assign
id|DSS1_STAT_INVOKE_ERR
suffix:semicolon
id|ic.parm.dss1_io.hl_id
op_assign
id|pc-&gt;prot.dss1.invoke_id
suffix:semicolon
id|ic.parm.dss1_io.ll_id
op_assign
id|pc-&gt;prot.dss1.ll_id
suffix:semicolon
id|ic.parm.dss1_io.proc
op_assign
id|pc-&gt;prot.dss1.proc
suffix:semicolon
id|ic.parm.dss1_io.timeout
op_assign
id|error
suffix:semicolon
id|ic.parm.dss1_io.datalen
op_assign
l_int|0
suffix:semicolon
id|ic.parm.dss1_io.data
op_assign
l_int|NULL
suffix:semicolon
id|free_invoke_id
c_func
(paren
id|pc-&gt;st
comma
id|pc-&gt;prot.dss1.invoke_id
)paren
suffix:semicolon
id|pc-&gt;prot.dss1.invoke_id
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* reset id */
id|cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
id|dss1_release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
)brace
r_else
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;dummy return error id=0x%x error=0x%lx&quot;
comma
id|id
comma
id|error
)paren
suffix:semicolon
)brace
multiline_comment|/* l3dss1_error_return */
multiline_comment|/*******************************************************************/
multiline_comment|/* called when a facility message with a dummy callref is received */
multiline_comment|/* and a invoke is delivered. id specifies the invoke id.          */
multiline_comment|/*******************************************************************/
r_static
r_void
DECL|function|l3dss1_dummy_invoke
id|l3dss1_dummy_invoke
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|cr
comma
r_int
id|id
comma
r_int
id|ident
comma
id|u_char
op_star
id|p
comma
id|u_char
id|nlen
)paren
(brace
id|isdn_ctrl
id|ic
suffix:semicolon
r_struct
id|IsdnCardState
op_star
id|cs
suffix:semicolon
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;dummy invoke %s id=0x%x ident=0x%x datalen=%d&quot;
comma
(paren
id|cr
op_eq
op_minus
l_int|1
)paren
ques
c_cond
l_string|&quot;local&quot;
suffix:colon
l_string|&quot;broadcast&quot;
comma
id|id
comma
id|ident
comma
id|nlen
)paren
suffix:semicolon
r_if
c_cond
(paren
id|cr
op_ge
op_minus
l_int|1
)paren
r_return
suffix:semicolon
multiline_comment|/* ignore local data */
id|cs
op_assign
id|st-&gt;l1.hardware
suffix:semicolon
id|ic.driver
op_assign
id|cs-&gt;myid
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_PROT
suffix:semicolon
id|ic.arg
op_assign
id|DSS1_STAT_INVOKE_BRD
suffix:semicolon
id|ic.parm.dss1_io.hl_id
op_assign
id|id
suffix:semicolon
id|ic.parm.dss1_io.ll_id
op_assign
l_int|0
suffix:semicolon
id|ic.parm.dss1_io.proc
op_assign
id|ident
suffix:semicolon
id|ic.parm.dss1_io.timeout
op_assign
l_int|0
suffix:semicolon
id|ic.parm.dss1_io.datalen
op_assign
id|nlen
suffix:semicolon
id|ic.parm.dss1_io.data
op_assign
id|p
suffix:semicolon
id|cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
)brace
multiline_comment|/* l3dss1_dummy_invoke */
r_static
r_void
DECL|function|l3dss1_parse_facility
id|l3dss1_parse_facility
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_struct
id|l3_process
op_star
id|pc
comma
r_int
id|cr
comma
id|u_char
op_star
id|p
)paren
(brace
r_int
id|qd_len
op_assign
l_int|0
suffix:semicolon
r_int
r_char
id|nlen
op_assign
l_int|0
comma
id|ilen
comma
id|cp_tag
suffix:semicolon
r_int
id|ident
comma
id|id
suffix:semicolon
id|ulong
id|err_ret
suffix:semicolon
r_if
c_cond
(paren
id|pc
)paren
id|st
op_assign
id|pc-&gt;st
suffix:semicolon
multiline_comment|/* valid Stack */
r_else
r_if
c_cond
(paren
(paren
op_logical_neg
id|st
)paren
op_logical_or
(paren
id|cr
op_ge
l_int|0
)paren
)paren
r_return
suffix:semicolon
multiline_comment|/* neither pc nor st specified */
id|p
op_increment
suffix:semicolon
id|qd_len
op_assign
op_star
id|p
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|qd_len
op_eq
l_int|0
)paren
(brace
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;qd_len == 0&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
op_star
id|p
op_amp
l_int|0x1F
)paren
op_ne
l_int|0x11
)paren
(brace
multiline_comment|/* Service discriminator, supplementary service */
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;supplementary service != 0x11&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_while
c_loop
(paren
id|qd_len
OG
l_int|0
op_logical_and
op_logical_neg
(paren
op_star
id|p
op_amp
l_int|0x80
)paren
)paren
(brace
multiline_comment|/* extension ? */
id|p
op_increment
suffix:semicolon
id|qd_len
op_decrement
suffix:semicolon
)brace
r_if
c_cond
(paren
id|qd_len
OL
l_int|2
)paren
(brace
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;qd_len &lt; 2&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|p
op_increment
suffix:semicolon
id|qd_len
op_decrement
suffix:semicolon
r_if
c_cond
(paren
(paren
op_star
id|p
op_amp
l_int|0xE0
)paren
op_ne
l_int|0xA0
)paren
(brace
multiline_comment|/* class and form */
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;class and form != 0xA0&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|cp_tag
op_assign
op_star
id|p
op_amp
l_int|0x1F
suffix:semicolon
multiline_comment|/* remember tag value */
id|p
op_increment
suffix:semicolon
id|qd_len
op_decrement
suffix:semicolon
r_if
c_cond
(paren
id|qd_len
OL
l_int|1
)paren
(brace
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;qd_len &lt; 1&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
op_star
id|p
op_amp
l_int|0x80
)paren
(brace
multiline_comment|/* length format indefinite or limited */
id|nlen
op_assign
op_star
id|p
op_increment
op_amp
l_int|0x7F
suffix:semicolon
multiline_comment|/* number of len bytes or indefinite */
r_if
c_cond
(paren
(paren
id|qd_len
op_decrement
OL
(paren
(paren
op_logical_neg
id|nlen
)paren
ques
c_cond
l_int|3
suffix:colon
(paren
l_int|1
op_plus
id|nlen
)paren
)paren
)paren
op_logical_or
(paren
id|nlen
OG
l_int|1
)paren
)paren
(brace
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;length format error or not implemented&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|nlen
op_eq
l_int|1
)paren
(brace
id|nlen
op_assign
op_star
id|p
op_increment
suffix:semicolon
multiline_comment|/* complete length */
id|qd_len
op_decrement
suffix:semicolon
)brace
r_else
(brace
id|qd_len
op_sub_assign
l_int|2
suffix:semicolon
multiline_comment|/* trailing null bytes */
r_if
c_cond
(paren
(paren
op_star
(paren
id|p
op_plus
id|qd_len
)paren
)paren
op_logical_or
(paren
op_star
(paren
id|p
op_plus
id|qd_len
op_plus
l_int|1
)paren
)paren
)paren
(brace
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;length format indefinite error&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|nlen
op_assign
id|qd_len
suffix:semicolon
)brace
)brace
r_else
(brace
id|nlen
op_assign
op_star
id|p
op_increment
suffix:semicolon
id|qd_len
op_decrement
suffix:semicolon
)brace
r_if
c_cond
(paren
id|qd_len
OL
id|nlen
)paren
(brace
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;qd_len &lt; nlen&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|qd_len
op_sub_assign
id|nlen
suffix:semicolon
r_if
c_cond
(paren
id|nlen
OL
l_int|2
)paren
(brace
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;nlen &lt; 2&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
op_star
id|p
op_ne
l_int|0x02
)paren
(brace
multiline_comment|/* invoke identifier tag */
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;invoke identifier tag !=0x02&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|p
op_increment
suffix:semicolon
id|nlen
op_decrement
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
op_amp
l_int|0x80
)paren
(brace
multiline_comment|/* length format */
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;invoke id length format 2&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|ilen
op_assign
op_star
id|p
op_increment
suffix:semicolon
id|nlen
op_decrement
suffix:semicolon
r_if
c_cond
(paren
id|ilen
OG
id|nlen
op_logical_or
id|ilen
op_eq
l_int|0
)paren
(brace
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;ilen &gt; nlen || ilen == 0&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|nlen
op_sub_assign
id|ilen
suffix:semicolon
id|id
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|ilen
OG
l_int|0
)paren
(brace
id|id
op_assign
(paren
id|id
op_lshift
l_int|8
)paren
op_or
(paren
op_star
id|p
op_increment
op_amp
l_int|0xFF
)paren
suffix:semicolon
multiline_comment|/* invoke identifier */
id|ilen
op_decrement
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|cp_tag
)paren
(brace
multiline_comment|/* component tag */
r_case
l_int|1
suffix:colon
multiline_comment|/* invoke */
r_if
c_cond
(paren
id|nlen
OL
l_int|2
)paren
(brace
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;nlen &lt; 2 22&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
op_star
id|p
op_ne
l_int|0x02
)paren
(brace
multiline_comment|/* operation value */
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;operation value !=0x02&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|p
op_increment
suffix:semicolon
id|nlen
op_decrement
suffix:semicolon
id|ilen
op_assign
op_star
id|p
op_increment
suffix:semicolon
id|nlen
op_decrement
suffix:semicolon
r_if
c_cond
(paren
id|ilen
OG
id|nlen
op_logical_or
id|ilen
op_eq
l_int|0
)paren
(brace
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;ilen &gt; nlen || ilen == 0 22&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|nlen
op_sub_assign
id|ilen
suffix:semicolon
id|ident
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|ilen
OG
l_int|0
)paren
(brace
id|ident
op_assign
(paren
id|ident
op_lshift
l_int|8
)paren
op_or
(paren
op_star
id|p
op_increment
op_amp
l_int|0xFF
)paren
suffix:semicolon
id|ilen
op_decrement
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|pc
)paren
(brace
id|l3dss1_dummy_invoke
c_func
(paren
id|st
comma
id|cr
comma
id|id
comma
id|ident
comma
id|p
comma
id|nlen
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
macro_line|#if HISAX_DE_AOC
(brace
DECL|macro|FOO1
mdefine_line|#define FOO1(s,a,b) &bslash;&n;&t;    while(nlen &gt; 1) {&t;&t;&bslash;&n;&t;&t;    int ilen = p[1];&t;&bslash;&n;&t;&t;    if(nlen &lt; ilen+2) {&t;&bslash;&n;&t;&t;&t;    l3_debug(st, &quot;FOO1  nlen &lt; ilen+2&quot;); &bslash;&n;&t;&t;&t;    return;&t;&t;&bslash;&n;&t;&t;    }&t;&t;&t;&bslash;&n;&t;&t;    nlen -= ilen+2;&t;&t;&bslash;&n;&t;&t;    if((*p &amp; 0xFF) == (a)) {&t;&bslash;&n;&t;&t;&t;    int nlen = ilen;&t;&bslash;&n;&t;&t;&t;    p += 2;&t;&t;&bslash;&n;&t;&t;&t;    b;&t;&t;&bslash;&n;&t;&t;    } else {&t;&t;&bslash;&n;&t;&t;&t;    p += ilen+2;&t;&bslash;&n;&t;&t;    }&t;&t;&t;&bslash;&n;&t;    }
r_switch
c_cond
(paren
id|ident
)paren
(brace
r_case
l_int|0x22
suffix:colon
multiline_comment|/* during */
id|FOO1
c_func
(paren
l_string|&quot;1A&quot;
comma
l_int|0x30
comma
id|FOO1
c_func
(paren
l_string|&quot;1C&quot;
comma
l_int|0xA1
comma
id|FOO1
c_func
(paren
l_string|&quot;1D&quot;
comma
l_int|0x30
comma
id|FOO1
c_func
(paren
l_string|&quot;1E&quot;
comma
l_int|0x02
comma
(paren
(brace
id|ident
op_assign
l_int|0
suffix:semicolon
id|nlen
op_assign
(paren
id|nlen
)paren
ques
c_cond
id|nlen
suffix:colon
l_int|0
suffix:semicolon
multiline_comment|/* Make gcc happy */
r_while
(paren
id|ilen
OG
l_int|0
)paren
(brace
id|ident
op_assign
(paren
id|ident
op_lshift
l_int|8
)paren
op_or
op_star
id|p
op_increment
suffix:semicolon
id|ilen
op_decrement
suffix:semicolon
)brace
r_if
(paren
id|ident
OG
id|pc-&gt;para.chargeinfo
)paren
(brace
id|pc-&gt;para.chargeinfo
op_assign
id|ident
suffix:semicolon
id|st-&gt;l3
dot
id|l3l4
c_func
(paren
id|st
comma
id|CC_CHARGE
op_or
id|INDICATION
comma
id|pc
)paren
suffix:semicolon
)brace
r_if
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_CHARGE
)paren
(brace
r_if
(paren
op_star
(paren
id|p
op_plus
l_int|2
)paren
op_eq
l_int|0
)paren
(brace
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;charging info during %d&quot;
comma
id|pc-&gt;para.chargeinfo
)paren
suffix:semicolon
)brace
r_else
(brace
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;charging info final %d&quot;
comma
id|pc-&gt;para.chargeinfo
)paren
suffix:semicolon
)brace
)brace
)brace
)paren
)paren
)paren
)paren
)paren
r_break
suffix:semicolon
r_case
l_int|0x24
suffix:colon
multiline_comment|/* final */
id|FOO1
c_func
(paren
l_string|&quot;2A&quot;
comma
l_int|0x30
comma
id|FOO1
c_func
(paren
l_string|&quot;2B&quot;
comma
l_int|0x30
comma
id|FOO1
c_func
(paren
l_string|&quot;2C&quot;
comma
l_int|0xA1
comma
id|FOO1
c_func
(paren
l_string|&quot;2D&quot;
comma
l_int|0x30
comma
id|FOO1
c_func
(paren
l_string|&quot;2E&quot;
comma
l_int|0x02
comma
(paren
(brace
id|ident
op_assign
l_int|0
suffix:semicolon
id|nlen
op_assign
(paren
id|nlen
)paren
ques
c_cond
id|nlen
suffix:colon
l_int|0
suffix:semicolon
multiline_comment|/* Make gcc happy */
r_while
(paren
id|ilen
OG
l_int|0
)paren
(brace
id|ident
op_assign
(paren
id|ident
op_lshift
l_int|8
)paren
op_or
op_star
id|p
op_increment
suffix:semicolon
id|ilen
op_decrement
suffix:semicolon
)brace
r_if
(paren
id|ident
OG
id|pc-&gt;para.chargeinfo
)paren
(brace
id|pc-&gt;para.chargeinfo
op_assign
id|ident
suffix:semicolon
id|st-&gt;l3
dot
id|l3l4
c_func
(paren
id|st
comma
id|CC_CHARGE
op_or
id|INDICATION
comma
id|pc
)paren
suffix:semicolon
)brace
r_if
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_CHARGE
)paren
(brace
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;charging info final %d&quot;
comma
id|pc-&gt;para.chargeinfo
)paren
suffix:semicolon
)brace
)brace
)paren
)paren
)paren
)paren
)paren
)paren
r_break
suffix:semicolon
r_default
suffix:colon
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;invoke break invalid ident %02x&quot;
comma
id|ident
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
DECL|macro|FOO1
macro_line|#undef FOO1
)brace
macro_line|#else  not HISAX_DE_AOC
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;invoke break&quot;
)paren
suffix:semicolon
macro_line|#endif not HISAX_DE_AOC 
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
multiline_comment|/* return result */
multiline_comment|/* if no process available handle separately */
r_if
c_cond
(paren
op_logical_neg
id|pc
)paren
(brace
r_if
c_cond
(paren
id|cr
op_eq
op_minus
l_int|1
)paren
id|l3dss1_dummy_return_result
c_func
(paren
id|st
comma
id|id
comma
id|p
comma
id|nlen
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|pc-&gt;prot.dss1.invoke_id
)paren
op_logical_and
(paren
id|pc-&gt;prot.dss1.invoke_id
op_eq
id|id
)paren
)paren
(brace
multiline_comment|/* Diversion successfull */
id|free_invoke_id
c_func
(paren
id|st
comma
id|pc-&gt;prot.dss1.invoke_id
)paren
suffix:semicolon
id|pc-&gt;prot.dss1.remote_result
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* success */
id|pc-&gt;prot.dss1.invoke_id
op_assign
l_int|0
suffix:semicolon
id|pc-&gt;redir_result
op_assign
id|pc-&gt;prot.dss1.remote_result
suffix:semicolon
id|st-&gt;l3
dot
id|l3l4
c_func
(paren
id|st
comma
id|CC_REDIR
op_or
id|INDICATION
comma
id|pc
)paren
suffix:semicolon
)brace
multiline_comment|/* Diversion successfull */
r_else
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;return error unknown identifier&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
multiline_comment|/* return error */
id|err_ret
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|nlen
OL
l_int|2
)paren
(brace
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;return error nlen &lt; 2&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
op_star
id|p
op_ne
l_int|0x02
)paren
(brace
multiline_comment|/* result tag */
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;invoke error tag !=0x02&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|p
op_increment
suffix:semicolon
id|nlen
op_decrement
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
OG
l_int|4
)paren
(brace
multiline_comment|/* length format */
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;invoke return errlen &gt; 4 &quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|ilen
op_assign
op_star
id|p
op_increment
suffix:semicolon
id|nlen
op_decrement
suffix:semicolon
r_if
c_cond
(paren
id|ilen
OG
id|nlen
op_logical_or
id|ilen
op_eq
l_int|0
)paren
(brace
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;error return ilen &gt; nlen || ilen == 0&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|nlen
op_sub_assign
id|ilen
suffix:semicolon
r_while
c_loop
(paren
id|ilen
OG
l_int|0
)paren
(brace
id|err_ret
op_assign
(paren
id|err_ret
op_lshift
l_int|8
)paren
op_or
(paren
op_star
id|p
op_increment
op_amp
l_int|0xFF
)paren
suffix:semicolon
multiline_comment|/* error value */
id|ilen
op_decrement
suffix:semicolon
)brace
multiline_comment|/* if no process available handle separately */
r_if
c_cond
(paren
op_logical_neg
id|pc
)paren
(brace
r_if
c_cond
(paren
id|cr
op_eq
op_minus
l_int|1
)paren
id|l3dss1_dummy_error_return
c_func
(paren
id|st
comma
id|id
comma
id|err_ret
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|pc-&gt;prot.dss1.invoke_id
)paren
op_logical_and
(paren
id|pc-&gt;prot.dss1.invoke_id
op_eq
id|id
)paren
)paren
(brace
multiline_comment|/* Deflection error */
id|free_invoke_id
c_func
(paren
id|st
comma
id|pc-&gt;prot.dss1.invoke_id
)paren
suffix:semicolon
id|pc-&gt;prot.dss1.remote_result
op_assign
id|err_ret
suffix:semicolon
multiline_comment|/* result */
id|pc-&gt;prot.dss1.invoke_id
op_assign
l_int|0
suffix:semicolon
id|pc-&gt;redir_result
op_assign
id|pc-&gt;prot.dss1.remote_result
suffix:semicolon
id|st-&gt;l3
dot
id|l3l4
c_func
(paren
id|st
comma
id|CC_REDIR
op_or
id|INDICATION
comma
id|pc
)paren
suffix:semicolon
)brace
multiline_comment|/* Deflection error */
r_else
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;return result unknown identifier&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;facility default break tag=0x%02x&quot;
comma
id|cp_tag
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|l3dss1_message
id|l3dss1_message
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|mt
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|u_char
op_star
id|p
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|l3_alloc_skb
c_func
(paren
l_int|4
)paren
)paren
)paren
r_return
suffix:semicolon
id|p
op_assign
id|skb_put
c_func
(paren
id|skb
comma
l_int|4
)paren
suffix:semicolon
id|MsgHead
c_func
(paren
id|p
comma
id|pc-&gt;callref
comma
id|mt
)paren
suffix:semicolon
id|l3_msg
c_func
(paren
id|pc-&gt;st
comma
id|DL_DATA
op_or
id|REQUEST
comma
id|skb
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_message_cause
id|l3dss1_message_cause
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|mt
comma
id|u_char
id|cause
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|u_char
id|tmp
(braket
l_int|16
)braket
suffix:semicolon
id|u_char
op_star
id|p
op_assign
id|tmp
suffix:semicolon
r_int
id|l
suffix:semicolon
id|MsgHead
c_func
(paren
id|p
comma
id|pc-&gt;callref
comma
id|mt
)paren
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|IE_CAUSE
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x2
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x80
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|cause
op_or
l_int|0x80
suffix:semicolon
id|l
op_assign
id|p
op_minus
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|l3_alloc_skb
c_func
(paren
id|l
)paren
)paren
)paren
r_return
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|l
)paren
comma
id|tmp
comma
id|l
)paren
suffix:semicolon
id|l3_msg
c_func
(paren
id|pc-&gt;st
comma
id|DL_DATA
op_or
id|REQUEST
comma
id|skb
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_status_send
id|l3dss1_status_send
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|u_char
id|tmp
(braket
l_int|16
)braket
suffix:semicolon
id|u_char
op_star
id|p
op_assign
id|tmp
suffix:semicolon
r_int
id|l
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|MsgHead
c_func
(paren
id|p
comma
id|pc-&gt;callref
comma
id|MT_STATUS
)paren
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|IE_CAUSE
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x2
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x80
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|pc-&gt;para.cause
op_or
l_int|0x80
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|IE_CALL_STATE
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x1
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|pc-&gt;state
op_amp
l_int|0x3f
suffix:semicolon
id|l
op_assign
id|p
op_minus
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|l3_alloc_skb
c_func
(paren
id|l
)paren
)paren
)paren
r_return
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|l
)paren
comma
id|tmp
comma
id|l
)paren
suffix:semicolon
id|l3_msg
c_func
(paren
id|pc-&gt;st
comma
id|DL_DATA
op_or
id|REQUEST
comma
id|skb
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_msg_without_setup
id|l3dss1_msg_without_setup
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
multiline_comment|/* This routine is called if here was no SETUP made (checks in dss1up and in&n;&t; * l3dss1_setup) and a RELEASE_COMPLETE have to be sent with an error code&n;&t; * MT_STATUS_ENQUIRE in the NULL state is handled too&n;&t; */
id|u_char
id|tmp
(braket
l_int|16
)braket
suffix:semicolon
id|u_char
op_star
id|p
op_assign
id|tmp
suffix:semicolon
r_int
id|l
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_switch
c_cond
(paren
id|pc-&gt;para.cause
)paren
(brace
r_case
l_int|81
suffix:colon
multiline_comment|/* invalid callreference */
r_case
l_int|88
suffix:colon
multiline_comment|/* incomp destination */
r_case
l_int|96
suffix:colon
multiline_comment|/* mandory IE missing */
r_case
l_int|100
suffix:colon
multiline_comment|/* invalid IE contents */
r_case
l_int|101
suffix:colon
multiline_comment|/* incompatible Callstate */
id|MsgHead
c_func
(paren
id|p
comma
id|pc-&gt;callref
comma
id|MT_RELEASE_COMPLETE
)paren
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|IE_CAUSE
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x2
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x80
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|pc-&gt;para.cause
op_or
l_int|0x80
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;HiSax l3dss1_msg_without_setup wrong cause %d&bslash;n&quot;
comma
id|pc-&gt;para.cause
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|l
op_assign
id|p
op_minus
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|l3_alloc_skb
c_func
(paren
id|l
)paren
)paren
)paren
r_return
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|l
)paren
comma
id|tmp
comma
id|l
)paren
suffix:semicolon
id|l3_msg
c_func
(paren
id|pc-&gt;st
comma
id|DL_DATA
op_or
id|REQUEST
comma
id|skb
)paren
suffix:semicolon
id|dss1_release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
)brace
DECL|variable|ie_ALERTING
r_static
r_int
id|ie_ALERTING
(braket
)braket
op_assign
(brace
id|IE_BEARER
comma
id|IE_CHANNEL_ID
op_or
id|IE_MANDATORY_1
comma
id|IE_FACILITY
comma
id|IE_PROGRESS
comma
id|IE_DISPLAY
comma
id|IE_SIGNAL
comma
id|IE_HLC
comma
id|IE_USER_USER
comma
op_minus
l_int|1
)brace
suffix:semicolon
DECL|variable|ie_CALL_PROCEEDING
r_static
r_int
id|ie_CALL_PROCEEDING
(braket
)braket
op_assign
(brace
id|IE_BEARER
comma
id|IE_CHANNEL_ID
op_or
id|IE_MANDATORY_1
comma
id|IE_FACILITY
comma
id|IE_PROGRESS
comma
id|IE_DISPLAY
comma
id|IE_HLC
comma
op_minus
l_int|1
)brace
suffix:semicolon
DECL|variable|ie_CONNECT
r_static
r_int
id|ie_CONNECT
(braket
)braket
op_assign
(brace
id|IE_BEARER
comma
id|IE_CHANNEL_ID
op_or
id|IE_MANDATORY_1
comma
id|IE_FACILITY
comma
id|IE_PROGRESS
comma
id|IE_DISPLAY
comma
id|IE_DATE
comma
id|IE_SIGNAL
comma
id|IE_CONNECT_PN
comma
id|IE_CONNECT_SUB
comma
id|IE_LLC
comma
id|IE_HLC
comma
id|IE_USER_USER
comma
op_minus
l_int|1
)brace
suffix:semicolon
DECL|variable|ie_CONNECT_ACKNOWLEDGE
r_static
r_int
id|ie_CONNECT_ACKNOWLEDGE
(braket
)braket
op_assign
(brace
id|IE_CHANNEL_ID
comma
id|IE_DISPLAY
comma
id|IE_SIGNAL
comma
op_minus
l_int|1
)brace
suffix:semicolon
DECL|variable|ie_DISCONNECT
r_static
r_int
id|ie_DISCONNECT
(braket
)braket
op_assign
(brace
id|IE_CAUSE
op_or
id|IE_MANDATORY
comma
id|IE_FACILITY
comma
id|IE_PROGRESS
comma
id|IE_DISPLAY
comma
id|IE_SIGNAL
comma
id|IE_USER_USER
comma
op_minus
l_int|1
)brace
suffix:semicolon
DECL|variable|ie_INFORMATION
r_static
r_int
id|ie_INFORMATION
(braket
)braket
op_assign
(brace
id|IE_COMPLETE
comma
id|IE_DISPLAY
comma
id|IE_KEYPAD
comma
id|IE_SIGNAL
comma
id|IE_CALLED_PN
comma
op_minus
l_int|1
)brace
suffix:semicolon
DECL|variable|ie_NOTIFY
r_static
r_int
id|ie_NOTIFY
(braket
)braket
op_assign
(brace
id|IE_BEARER
comma
id|IE_NOTIFY
op_or
id|IE_MANDATORY
comma
id|IE_DISPLAY
comma
op_minus
l_int|1
)brace
suffix:semicolon
DECL|variable|ie_PROGRESS
r_static
r_int
id|ie_PROGRESS
(braket
)braket
op_assign
(brace
id|IE_BEARER
comma
id|IE_CAUSE
comma
id|IE_FACILITY
comma
id|IE_PROGRESS
op_or
id|IE_MANDATORY
comma
id|IE_DISPLAY
comma
id|IE_HLC
comma
id|IE_USER_USER
comma
op_minus
l_int|1
)brace
suffix:semicolon
DECL|variable|ie_RELEASE
r_static
r_int
id|ie_RELEASE
(braket
)braket
op_assign
(brace
id|IE_CAUSE
op_or
id|IE_MANDATORY_1
comma
id|IE_FACILITY
comma
id|IE_DISPLAY
comma
id|IE_SIGNAL
comma
id|IE_USER_USER
comma
op_minus
l_int|1
)brace
suffix:semicolon
multiline_comment|/* a RELEASE_COMPLETE with errors don&squot;t require special actions &n;static int ie_RELEASE_COMPLETE[] = {IE_CAUSE | IE_MANDATORY_1, IE_DISPLAY, IE_SIGNAL, IE_USER_USER, -1};&n;*/
DECL|variable|ie_RESUME_ACKNOWLEDGE
r_static
r_int
id|ie_RESUME_ACKNOWLEDGE
(braket
)braket
op_assign
(brace
id|IE_CHANNEL_ID
op_or
id|IE_MANDATORY
comma
id|IE_FACILITY
comma
id|IE_DISPLAY
comma
op_minus
l_int|1
)brace
suffix:semicolon
DECL|variable|ie_RESUME_REJECT
r_static
r_int
id|ie_RESUME_REJECT
(braket
)braket
op_assign
(brace
id|IE_CAUSE
op_or
id|IE_MANDATORY
comma
id|IE_DISPLAY
comma
op_minus
l_int|1
)brace
suffix:semicolon
DECL|variable|ie_SETUP
r_static
r_int
id|ie_SETUP
(braket
)braket
op_assign
(brace
id|IE_COMPLETE
comma
id|IE_BEARER
op_or
id|IE_MANDATORY
comma
id|IE_CHANNEL_ID
op_or
id|IE_MANDATORY
comma
id|IE_FACILITY
comma
id|IE_PROGRESS
comma
id|IE_NET_FAC
comma
id|IE_DISPLAY
comma
id|IE_KEYPAD
comma
id|IE_SIGNAL
comma
id|IE_CALLING_PN
comma
id|IE_CALLING_SUB
comma
id|IE_CALLED_PN
comma
id|IE_CALLED_SUB
comma
id|IE_REDIR_NR
comma
id|IE_LLC
comma
id|IE_HLC
comma
id|IE_USER_USER
comma
op_minus
l_int|1
)brace
suffix:semicolon
DECL|variable|ie_SETUP_ACKNOWLEDGE
r_static
r_int
id|ie_SETUP_ACKNOWLEDGE
(braket
)braket
op_assign
(brace
id|IE_CHANNEL_ID
op_or
id|IE_MANDATORY
comma
id|IE_FACILITY
comma
id|IE_PROGRESS
comma
id|IE_DISPLAY
comma
id|IE_SIGNAL
comma
op_minus
l_int|1
)brace
suffix:semicolon
DECL|variable|ie_STATUS
r_static
r_int
id|ie_STATUS
(braket
)braket
op_assign
(brace
id|IE_CAUSE
op_or
id|IE_MANDATORY
comma
id|IE_CALL_STATE
op_or
id|IE_MANDATORY
comma
id|IE_DISPLAY
comma
op_minus
l_int|1
)brace
suffix:semicolon
DECL|variable|ie_STATUS_ENQUIRY
r_static
r_int
id|ie_STATUS_ENQUIRY
(braket
)braket
op_assign
(brace
id|IE_DISPLAY
comma
op_minus
l_int|1
)brace
suffix:semicolon
DECL|variable|ie_SUSPEND_ACKNOWLEDGE
r_static
r_int
id|ie_SUSPEND_ACKNOWLEDGE
(braket
)braket
op_assign
(brace
id|IE_DISPLAY
comma
id|IE_FACILITY
comma
op_minus
l_int|1
)brace
suffix:semicolon
DECL|variable|ie_SUSPEND_REJECT
r_static
r_int
id|ie_SUSPEND_REJECT
(braket
)braket
op_assign
(brace
id|IE_CAUSE
op_or
id|IE_MANDATORY
comma
id|IE_DISPLAY
comma
op_minus
l_int|1
)brace
suffix:semicolon
multiline_comment|/* not used &n; * static int ie_CONGESTION_CONTROL[] = {IE_CONGESTION | IE_MANDATORY,&n; *&t;&t;IE_CAUSE | IE_MANDATORY, IE_DISPLAY, -1};&n; * static int ie_USER_INFORMATION[] = {IE_MORE_DATA, IE_USER_USER | IE_MANDATORY, -1};&n; * static int ie_RESTART[] = {IE_CHANNEL_ID, IE_DISPLAY, IE_RESTART_IND |&n; *&t;&t;IE_MANDATORY, -1};&n; */
DECL|variable|ie_FACILITY
r_static
r_int
id|ie_FACILITY
(braket
)braket
op_assign
(brace
id|IE_FACILITY
op_or
id|IE_MANDATORY
comma
id|IE_DISPLAY
comma
op_minus
l_int|1
)brace
suffix:semicolon
DECL|variable|comp_required
r_static
r_int
id|comp_required
(braket
)braket
op_assign
(brace
l_int|1
comma
l_int|2
comma
l_int|3
comma
l_int|5
comma
l_int|6
comma
l_int|7
comma
l_int|9
comma
l_int|10
comma
l_int|11
comma
l_int|14
comma
l_int|15
comma
op_minus
l_int|1
)brace
suffix:semicolon
DECL|variable|l3_valid_states
r_static
r_int
id|l3_valid_states
(braket
)braket
op_assign
(brace
l_int|0
comma
l_int|1
comma
l_int|2
comma
l_int|3
comma
l_int|4
comma
l_int|6
comma
l_int|7
comma
l_int|8
comma
l_int|9
comma
l_int|10
comma
l_int|11
comma
l_int|12
comma
l_int|15
comma
l_int|17
comma
l_int|19
comma
l_int|25
comma
op_minus
l_int|1
)brace
suffix:semicolon
DECL|struct|ie_len
r_struct
id|ie_len
(brace
DECL|member|ie
r_int
id|ie
suffix:semicolon
DECL|member|len
r_int
id|len
suffix:semicolon
)brace
suffix:semicolon
r_static
DECL|variable|max_ie_len
r_struct
id|ie_len
id|max_ie_len
(braket
)braket
op_assign
(brace
(brace
id|IE_SEGMENT
comma
l_int|4
)brace
comma
(brace
id|IE_BEARER
comma
l_int|12
)brace
comma
(brace
id|IE_CAUSE
comma
l_int|32
)brace
comma
(brace
id|IE_CALL_ID
comma
l_int|10
)brace
comma
(brace
id|IE_CALL_STATE
comma
l_int|3
)brace
comma
(brace
id|IE_CHANNEL_ID
comma
l_int|34
)brace
comma
(brace
id|IE_FACILITY
comma
l_int|255
)brace
comma
(brace
id|IE_PROGRESS
comma
l_int|4
)brace
comma
(brace
id|IE_NET_FAC
comma
l_int|255
)brace
comma
(brace
id|IE_NOTIFY
comma
l_int|3
)brace
comma
(brace
id|IE_DISPLAY
comma
l_int|82
)brace
comma
(brace
id|IE_DATE
comma
l_int|8
)brace
comma
(brace
id|IE_KEYPAD
comma
l_int|34
)brace
comma
(brace
id|IE_SIGNAL
comma
l_int|3
)brace
comma
(brace
id|IE_INFORATE
comma
l_int|6
)brace
comma
(brace
id|IE_E2E_TDELAY
comma
l_int|11
)brace
comma
(brace
id|IE_TDELAY_SEL
comma
l_int|5
)brace
comma
(brace
id|IE_PACK_BINPARA
comma
l_int|3
)brace
comma
(brace
id|IE_PACK_WINSIZE
comma
l_int|4
)brace
comma
(brace
id|IE_PACK_SIZE
comma
l_int|4
)brace
comma
(brace
id|IE_CUG
comma
l_int|7
)brace
comma
(brace
id|IE_REV_CHARGE
comma
l_int|3
)brace
comma
(brace
id|IE_CALLING_PN
comma
l_int|24
)brace
comma
(brace
id|IE_CALLING_SUB
comma
l_int|23
)brace
comma
(brace
id|IE_CALLED_PN
comma
l_int|24
)brace
comma
(brace
id|IE_CALLED_SUB
comma
l_int|23
)brace
comma
(brace
id|IE_REDIR_NR
comma
l_int|255
)brace
comma
(brace
id|IE_TRANS_SEL
comma
l_int|255
)brace
comma
(brace
id|IE_RESTART_IND
comma
l_int|3
)brace
comma
(brace
id|IE_LLC
comma
l_int|18
)brace
comma
(brace
id|IE_HLC
comma
l_int|5
)brace
comma
(brace
id|IE_USER_USER
comma
l_int|131
)brace
comma
(brace
op_minus
l_int|1
comma
l_int|0
)brace
comma
)brace
suffix:semicolon
r_static
r_int
DECL|function|getmax_ie_len
id|getmax_ie_len
c_func
(paren
id|u_char
id|ie
)paren
(brace
r_int
id|i
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|max_ie_len
(braket
id|i
)braket
dot
id|ie
op_ne
op_minus
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|max_ie_len
(braket
id|i
)braket
dot
id|ie
op_eq
id|ie
)paren
r_return
id|max_ie_len
(braket
id|i
)braket
dot
id|len
suffix:semicolon
id|i
op_increment
suffix:semicolon
)brace
r_return
l_int|255
suffix:semicolon
)brace
r_static
r_int
DECL|function|ie_in_set
id|ie_in_set
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|ie
comma
r_int
op_star
id|checklist
)paren
(brace
r_int
id|ret
op_assign
l_int|1
suffix:semicolon
r_while
c_loop
(paren
op_star
id|checklist
op_ne
op_minus
l_int|1
)paren
(brace
r_if
c_cond
(paren
(paren
op_star
id|checklist
op_amp
l_int|0xff
)paren
op_eq
id|ie
)paren
(brace
r_if
c_cond
(paren
id|ie
op_amp
l_int|0x80
)paren
r_return
op_minus
id|ret
suffix:semicolon
r_else
r_return
id|ret
suffix:semicolon
)brace
id|ret
op_increment
suffix:semicolon
id|checklist
op_increment
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_int
DECL|function|check_infoelements
id|check_infoelements
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
r_struct
id|sk_buff
op_star
id|skb
comma
r_int
op_star
id|checklist
)paren
(brace
r_int
op_star
id|cl
op_assign
id|checklist
suffix:semicolon
id|u_char
id|mt
suffix:semicolon
id|u_char
op_star
id|p
comma
id|ie
suffix:semicolon
r_int
id|l
comma
id|newpos
comma
id|oldpos
suffix:semicolon
r_int
id|err_seq
op_assign
l_int|0
comma
id|err_len
op_assign
l_int|0
comma
id|err_compr
op_assign
l_int|0
comma
id|err_ureg
op_assign
l_int|0
suffix:semicolon
id|u_char
id|codeset
op_assign
l_int|0
suffix:semicolon
id|u_char
id|old_codeset
op_assign
l_int|0
suffix:semicolon
id|u_char
id|codelock
op_assign
l_int|1
suffix:semicolon
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
multiline_comment|/* skip cr */
id|p
op_increment
suffix:semicolon
id|l
op_assign
(paren
op_star
id|p
op_increment
)paren
op_amp
l_int|0xf
suffix:semicolon
id|p
op_add_assign
id|l
suffix:semicolon
id|mt
op_assign
op_star
id|p
op_increment
suffix:semicolon
id|oldpos
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
(paren
id|p
op_minus
id|skb-&gt;data
)paren
OL
id|skb-&gt;len
)paren
(brace
r_if
c_cond
(paren
(paren
op_star
id|p
op_amp
l_int|0xf0
)paren
op_eq
l_int|0x90
)paren
(brace
multiline_comment|/* shift codeset */
id|old_codeset
op_assign
id|codeset
suffix:semicolon
id|codeset
op_assign
op_star
id|p
op_amp
l_int|7
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
op_amp
l_int|0x08
)paren
id|codelock
op_assign
l_int|0
suffix:semicolon
r_else
id|codelock
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_CHECK
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;check IE shift%scodeset %d-&gt;%d&quot;
comma
id|codelock
ques
c_cond
l_string|&quot; locking &quot;
suffix:colon
l_string|&quot; &quot;
comma
id|old_codeset
comma
id|codeset
)paren
suffix:semicolon
id|p
op_increment
suffix:semicolon
r_continue
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|codeset
)paren
(brace
multiline_comment|/* only codeset 0 */
r_if
c_cond
(paren
(paren
id|newpos
op_assign
id|ie_in_set
c_func
(paren
id|pc
comma
op_star
id|p
comma
id|cl
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
id|newpos
OG
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|newpos
OL
id|oldpos
)paren
id|err_seq
op_increment
suffix:semicolon
r_else
id|oldpos
op_assign
id|newpos
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|ie_in_set
c_func
(paren
id|pc
comma
op_star
id|p
comma
id|comp_required
)paren
)paren
id|err_compr
op_increment
suffix:semicolon
r_else
id|err_ureg
op_increment
suffix:semicolon
)brace
)brace
id|ie
op_assign
op_star
id|p
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|ie
op_amp
l_int|0x80
)paren
(brace
id|l
op_assign
l_int|1
suffix:semicolon
)brace
r_else
(brace
id|l
op_assign
op_star
id|p
op_increment
suffix:semicolon
id|p
op_add_assign
id|l
suffix:semicolon
id|l
op_add_assign
l_int|2
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|codeset
op_logical_and
(paren
id|l
OG
id|getmax_ie_len
c_func
(paren
id|ie
)paren
)paren
)paren
id|err_len
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|codelock
)paren
(brace
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_CHECK
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;check IE shift back codeset %d-&gt;%d&quot;
comma
id|codeset
comma
id|old_codeset
)paren
suffix:semicolon
id|codeset
op_assign
id|old_codeset
suffix:semicolon
id|codelock
op_assign
l_int|1
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|err_compr
op_or
id|err_ureg
op_or
id|err_len
op_or
id|err_seq
)paren
(brace
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_CHECK
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;check IE MT(%x) %d/%d/%d/%d&quot;
comma
id|mt
comma
id|err_compr
comma
id|err_ureg
comma
id|err_len
comma
id|err_seq
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err_compr
)paren
r_return
id|ERR_IE_COMPREHENSION
suffix:semicolon
r_if
c_cond
(paren
id|err_ureg
)paren
r_return
id|ERR_IE_UNRECOGNIZED
suffix:semicolon
r_if
c_cond
(paren
id|err_len
)paren
r_return
id|ERR_IE_LENGTH
suffix:semicolon
r_if
c_cond
(paren
id|err_seq
)paren
r_return
id|ERR_IE_SEQUENCE
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/* verify if a message type exists and contain no IE error */
r_static
r_int
DECL|function|l3dss1_check_messagetype_validity
id|l3dss1_check_messagetype_validity
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
r_int
id|mt
comma
r_void
op_star
id|arg
)paren
(brace
r_switch
c_cond
(paren
id|mt
)paren
(brace
r_case
id|MT_ALERTING
suffix:colon
r_case
id|MT_CALL_PROCEEDING
suffix:colon
r_case
id|MT_CONNECT
suffix:colon
r_case
id|MT_CONNECT_ACKNOWLEDGE
suffix:colon
r_case
id|MT_DISCONNECT
suffix:colon
r_case
id|MT_INFORMATION
suffix:colon
r_case
id|MT_FACILITY
suffix:colon
r_case
id|MT_NOTIFY
suffix:colon
r_case
id|MT_PROGRESS
suffix:colon
r_case
id|MT_RELEASE
suffix:colon
r_case
id|MT_RELEASE_COMPLETE
suffix:colon
r_case
id|MT_SETUP
suffix:colon
r_case
id|MT_SETUP_ACKNOWLEDGE
suffix:colon
r_case
id|MT_RESUME_ACKNOWLEDGE
suffix:colon
r_case
id|MT_RESUME_REJECT
suffix:colon
r_case
id|MT_SUSPEND_ACKNOWLEDGE
suffix:colon
r_case
id|MT_SUSPEND_REJECT
suffix:colon
r_case
id|MT_USER_INFORMATION
suffix:colon
r_case
id|MT_RESTART
suffix:colon
r_case
id|MT_RESTART_ACKNOWLEDGE
suffix:colon
r_case
id|MT_CONGESTION_CONTROL
suffix:colon
r_case
id|MT_STATUS
suffix:colon
r_case
id|MT_STATUS_ENQUIRY
suffix:colon
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_CHECK
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;l3dss1_check_messagetype_validity mt(%x) OK&quot;
comma
id|mt
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|MT_RESUME
suffix:colon
multiline_comment|/* RESUME only in user-&gt;net */
r_case
id|MT_SUSPEND
suffix:colon
multiline_comment|/* SUSPEND only in user-&gt;net */
r_default
suffix:colon
(brace
)brace
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
(paren
id|L3_DEB_CHECK
op_or
id|L3_DEB_WARN
)paren
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;l3dss1_check_messagetype_validity mt(%x) fail&quot;
comma
id|mt
)paren
suffix:semicolon
id|pc-&gt;para.cause
op_assign
l_int|97
suffix:semicolon
id|l3dss1_status_send
c_func
(paren
id|pc
comma
l_int|0
comma
l_int|NULL
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_std_ie_err
id|l3dss1_std_ie_err
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
r_int
id|ret
)paren
(brace
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_CHECK
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;check_infoelements ret %d&quot;
comma
id|ret
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|ret
)paren
(brace
r_case
l_int|0
suffix:colon
r_break
suffix:semicolon
r_case
id|ERR_IE_COMPREHENSION
suffix:colon
id|pc-&gt;para.cause
op_assign
l_int|96
suffix:semicolon
id|l3dss1_status_send
c_func
(paren
id|pc
comma
l_int|0
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ERR_IE_UNRECOGNIZED
suffix:colon
id|pc-&gt;para.cause
op_assign
l_int|99
suffix:semicolon
id|l3dss1_status_send
c_func
(paren
id|pc
comma
l_int|0
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ERR_IE_LENGTH
suffix:colon
id|pc-&gt;para.cause
op_assign
l_int|100
suffix:semicolon
id|l3dss1_status_send
c_func
(paren
id|pc
comma
l_int|0
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ERR_IE_SEQUENCE
suffix:colon
r_default
suffix:colon
r_break
suffix:semicolon
)brace
)brace
r_static
r_int
DECL|function|l3dss1_get_channel_id
id|l3dss1_get_channel_id
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
id|u_char
op_star
id|p
suffix:semicolon
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
id|IE_CHANNEL_ID
comma
l_int|0
)paren
)paren
)paren
(brace
id|p
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
op_ne
l_int|1
)paren
(brace
multiline_comment|/* len for BRI = 1 */
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;wrong chid len %d&quot;
comma
op_star
id|p
)paren
suffix:semicolon
r_return
(paren
op_minus
l_int|2
)paren
suffix:semicolon
)brace
id|p
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
op_amp
l_int|0x60
)paren
(brace
multiline_comment|/* only base rate interface */
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;wrong chid %x&quot;
comma
op_star
id|p
)paren
suffix:semicolon
r_return
(paren
op_minus
l_int|3
)paren
suffix:semicolon
)brace
r_return
op_star
id|p
op_amp
l_int|0x3
suffix:semicolon
)brace
r_else
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_static
r_int
DECL|function|l3dss1_get_cause
id|l3dss1_get_cause
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
id|u_char
id|l
comma
id|i
op_assign
l_int|0
suffix:semicolon
id|u_char
op_star
id|p
suffix:semicolon
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
id|pc-&gt;para.cause
op_assign
l_int|31
suffix:semicolon
id|pc-&gt;para.loc
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
id|IE_CAUSE
comma
l_int|0
)paren
)paren
)paren
(brace
id|p
op_increment
suffix:semicolon
id|l
op_assign
op_star
id|p
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|l
OG
l_int|30
)paren
r_return
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|l
)paren
(brace
id|pc-&gt;para.loc
op_assign
op_star
id|p
op_increment
suffix:semicolon
id|l
op_decrement
suffix:semicolon
)brace
r_else
(brace
r_return
l_int|2
suffix:semicolon
)brace
r_if
c_cond
(paren
id|l
op_logical_and
op_logical_neg
(paren
id|pc-&gt;para.loc
op_amp
l_int|0x80
)paren
)paren
(brace
id|l
op_decrement
suffix:semicolon
id|p
op_increment
suffix:semicolon
multiline_comment|/* skip recommendation */
)brace
r_if
c_cond
(paren
id|l
)paren
(brace
id|pc-&gt;para.cause
op_assign
op_star
id|p
op_increment
suffix:semicolon
id|l
op_decrement
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|pc-&gt;para.cause
op_amp
l_int|0x80
)paren
)paren
r_return
l_int|3
suffix:semicolon
)brace
r_else
r_return
l_int|4
suffix:semicolon
r_while
c_loop
(paren
id|l
op_logical_and
(paren
id|i
OL
l_int|6
)paren
)paren
(brace
id|pc-&gt;para.diag
(braket
id|i
op_increment
)braket
op_assign
op_star
id|p
op_increment
suffix:semicolon
id|l
op_decrement
suffix:semicolon
)brace
)brace
r_else
r_return
op_minus
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_msg_with_uus
id|l3dss1_msg_with_uus
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|cmd
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|u_char
id|tmp
(braket
l_int|16
op_plus
l_int|40
)braket
suffix:semicolon
id|u_char
op_star
id|p
op_assign
id|tmp
suffix:semicolon
r_int
id|l
suffix:semicolon
id|MsgHead
c_func
(paren
id|p
comma
id|pc-&gt;callref
comma
id|cmd
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pc-&gt;prot.dss1.uus1_data
(braket
l_int|0
)braket
)paren
(brace
op_star
id|p
op_increment
op_assign
id|IE_USER_USER
suffix:semicolon
multiline_comment|/* UUS info element */
op_star
id|p
op_increment
op_assign
id|strlen
c_func
(paren
id|pc-&gt;prot.dss1.uus1_data
)paren
op_plus
l_int|1
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x04
suffix:semicolon
multiline_comment|/* IA5 chars */
id|strcpy
c_func
(paren
id|p
comma
id|pc-&gt;prot.dss1.uus1_data
)paren
suffix:semicolon
id|p
op_add_assign
id|strlen
c_func
(paren
id|pc-&gt;prot.dss1.uus1_data
)paren
suffix:semicolon
id|pc-&gt;prot.dss1.uus1_data
(braket
l_int|0
)braket
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
)brace
id|l
op_assign
id|p
op_minus
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|l3_alloc_skb
c_func
(paren
id|l
)paren
)paren
)paren
r_return
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|l
)paren
comma
id|tmp
comma
id|l
)paren
suffix:semicolon
id|l3_msg
c_func
(paren
id|pc-&gt;st
comma
id|DL_DATA
op_or
id|REQUEST
comma
id|skb
)paren
suffix:semicolon
)brace
multiline_comment|/* l3dss1_msg_with_uus */
r_static
r_void
DECL|function|l3dss1_release_req
id|l3dss1_release_req
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|StopAllL3Timer
c_func
(paren
id|pc
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|19
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|pc-&gt;prot.dss1.uus1_data
(braket
l_int|0
)braket
)paren
id|l3dss1_message
c_func
(paren
id|pc
comma
id|MT_RELEASE
)paren
suffix:semicolon
r_else
id|l3dss1_msg_with_uus
c_func
(paren
id|pc
comma
id|MT_RELEASE
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|pc-&gt;timer
comma
id|T308
comma
id|CC_T308_1
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_release_cmpl
id|l3dss1_release_cmpl
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_int
id|ret
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ret
op_assign
id|l3dss1_get_cause
c_func
(paren
id|pc
comma
id|skb
)paren
)paren
OG
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;RELCMPL get_cause ret(%d)&quot;
comma
id|ret
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|ret
OL
l_int|0
)paren
id|pc-&gt;para.cause
op_assign
id|NO_CAUSE
suffix:semicolon
id|StopAllL3Timer
c_func
(paren
id|pc
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|0
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc-&gt;st
comma
id|CC_RELEASE
op_or
id|CONFIRM
comma
id|pc
)paren
suffix:semicolon
id|dss1_release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
)brace
macro_line|#if EXT_BEARER_CAPS
r_static
id|u_char
op_star
DECL|function|EncodeASyncParams
id|EncodeASyncParams
c_func
(paren
id|u_char
op_star
id|p
comma
id|u_char
id|si2
)paren
(brace
singleline_comment|// 7c 06 88  90 21 42 00 bb
id|p
(braket
l_int|0
)braket
op_assign
l_int|0
suffix:semicolon
id|p
(braket
l_int|1
)braket
op_assign
l_int|0x40
suffix:semicolon
singleline_comment|// Intermediate rate: 16 kbit/s jj 2000.02.19
id|p
(braket
l_int|2
)braket
op_assign
l_int|0x80
suffix:semicolon
r_if
c_cond
(paren
id|si2
op_amp
l_int|32
)paren
singleline_comment|// 7 data bits
id|p
(braket
l_int|2
)braket
op_add_assign
l_int|16
suffix:semicolon
r_else
singleline_comment|// 8 data bits
id|p
(braket
l_int|2
)braket
op_add_assign
l_int|24
suffix:semicolon
r_if
c_cond
(paren
id|si2
op_amp
l_int|16
)paren
singleline_comment|// 2 stop bits
id|p
(braket
l_int|2
)braket
op_add_assign
l_int|96
suffix:semicolon
r_else
singleline_comment|// 1 stop bit
id|p
(braket
l_int|2
)braket
op_add_assign
l_int|32
suffix:semicolon
r_if
c_cond
(paren
id|si2
op_amp
l_int|8
)paren
singleline_comment|// even parity
id|p
(braket
l_int|2
)braket
op_add_assign
l_int|2
suffix:semicolon
r_else
singleline_comment|// no parity
id|p
(braket
l_int|2
)braket
op_add_assign
l_int|3
suffix:semicolon
r_switch
c_cond
(paren
id|si2
op_amp
l_int|0x07
)paren
(brace
r_case
l_int|0
suffix:colon
id|p
(braket
l_int|0
)braket
op_assign
l_int|66
suffix:semicolon
singleline_comment|// 1200 bit/s
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|p
(braket
l_int|0
)braket
op_assign
l_int|88
suffix:semicolon
singleline_comment|// 1200/75 bit/s
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|p
(braket
l_int|0
)braket
op_assign
l_int|87
suffix:semicolon
singleline_comment|// 75/1200 bit/s
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|p
(braket
l_int|0
)braket
op_assign
l_int|67
suffix:semicolon
singleline_comment|// 2400 bit/s
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
id|p
(braket
l_int|0
)braket
op_assign
l_int|69
suffix:semicolon
singleline_comment|// 4800 bit/s
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
id|p
(braket
l_int|0
)braket
op_assign
l_int|72
suffix:semicolon
singleline_comment|// 9600 bit/s
r_break
suffix:semicolon
r_case
l_int|6
suffix:colon
id|p
(braket
l_int|0
)braket
op_assign
l_int|73
suffix:semicolon
singleline_comment|// 14400 bit/s
r_break
suffix:semicolon
r_case
l_int|7
suffix:colon
id|p
(braket
l_int|0
)braket
op_assign
l_int|75
suffix:semicolon
singleline_comment|// 19200 bit/s
r_break
suffix:semicolon
)brace
r_return
id|p
op_plus
l_int|3
suffix:semicolon
)brace
r_static
id|u_char
DECL|function|EncodeSyncParams
id|EncodeSyncParams
c_func
(paren
id|u_char
id|si2
comma
id|u_char
id|ai
)paren
(brace
r_switch
c_cond
(paren
id|si2
)paren
(brace
r_case
l_int|0
suffix:colon
r_return
id|ai
op_plus
l_int|2
suffix:semicolon
singleline_comment|// 1200 bit/s
r_case
l_int|1
suffix:colon
r_return
id|ai
op_plus
l_int|24
suffix:semicolon
singleline_comment|// 1200/75 bit/s
r_case
l_int|2
suffix:colon
r_return
id|ai
op_plus
l_int|23
suffix:semicolon
singleline_comment|// 75/1200 bit/s
r_case
l_int|3
suffix:colon
r_return
id|ai
op_plus
l_int|3
suffix:semicolon
singleline_comment|// 2400 bit/s
r_case
l_int|4
suffix:colon
r_return
id|ai
op_plus
l_int|5
suffix:semicolon
singleline_comment|// 4800 bit/s
r_case
l_int|5
suffix:colon
r_return
id|ai
op_plus
l_int|8
suffix:semicolon
singleline_comment|// 9600 bit/s
r_case
l_int|6
suffix:colon
r_return
id|ai
op_plus
l_int|9
suffix:semicolon
singleline_comment|// 14400 bit/s
r_case
l_int|7
suffix:colon
r_return
id|ai
op_plus
l_int|11
suffix:semicolon
singleline_comment|// 19200 bit/s
r_case
l_int|8
suffix:colon
r_return
id|ai
op_plus
l_int|14
suffix:semicolon
singleline_comment|// 48000 bit/s
r_case
l_int|9
suffix:colon
r_return
id|ai
op_plus
l_int|15
suffix:semicolon
singleline_comment|// 56000 bit/s
r_case
l_int|15
suffix:colon
r_return
id|ai
op_plus
l_int|40
suffix:semicolon
singleline_comment|// negotiate bit/s
r_default
suffix:colon
r_break
suffix:semicolon
)brace
r_return
id|ai
suffix:semicolon
)brace
r_static
id|u_char
DECL|function|DecodeASyncParams
id|DecodeASyncParams
c_func
(paren
id|u_char
id|si2
comma
id|u_char
op_star
id|p
)paren
(brace
id|u_char
id|info
suffix:semicolon
r_switch
c_cond
(paren
id|p
(braket
l_int|5
)braket
)paren
(brace
r_case
l_int|66
suffix:colon
singleline_comment|// 1200 bit/s
r_break
suffix:semicolon
singleline_comment|// si2 don&squot;t change
r_case
l_int|88
suffix:colon
singleline_comment|// 1200/75 bit/s
id|si2
op_add_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|87
suffix:colon
singleline_comment|// 75/1200 bit/s
id|si2
op_add_assign
l_int|2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|67
suffix:colon
singleline_comment|// 2400 bit/s
id|si2
op_add_assign
l_int|3
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|69
suffix:colon
singleline_comment|// 4800 bit/s
id|si2
op_add_assign
l_int|4
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|72
suffix:colon
singleline_comment|// 9600 bit/s
id|si2
op_add_assign
l_int|5
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|73
suffix:colon
singleline_comment|// 14400 bit/s
id|si2
op_add_assign
l_int|6
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|75
suffix:colon
singleline_comment|// 19200 bit/s
id|si2
op_add_assign
l_int|7
suffix:semicolon
r_break
suffix:semicolon
)brace
id|info
op_assign
id|p
(braket
l_int|7
)braket
op_amp
l_int|0x7f
suffix:semicolon
r_if
c_cond
(paren
(paren
id|info
op_amp
l_int|16
)paren
op_logical_and
(paren
op_logical_neg
(paren
id|info
op_amp
l_int|8
)paren
)paren
)paren
singleline_comment|// 7 data bits
id|si2
op_add_assign
l_int|32
suffix:semicolon
singleline_comment|// else 8 data bits
r_if
c_cond
(paren
(paren
id|info
op_amp
l_int|96
)paren
op_eq
l_int|96
)paren
singleline_comment|// 2 stop bits
id|si2
op_add_assign
l_int|16
suffix:semicolon
singleline_comment|// else 1 stop bit
r_if
c_cond
(paren
(paren
id|info
op_amp
l_int|2
)paren
op_logical_and
(paren
op_logical_neg
(paren
id|info
op_amp
l_int|1
)paren
)paren
)paren
singleline_comment|// even parity
id|si2
op_add_assign
l_int|8
suffix:semicolon
singleline_comment|// else no parity
r_return
id|si2
suffix:semicolon
)brace
r_static
id|u_char
DECL|function|DecodeSyncParams
id|DecodeSyncParams
c_func
(paren
id|u_char
id|si2
comma
id|u_char
id|info
)paren
(brace
id|info
op_and_assign
l_int|0x7f
suffix:semicolon
r_switch
c_cond
(paren
id|info
)paren
(brace
r_case
l_int|40
suffix:colon
singleline_comment|// bit/s negotiation failed  ai := 165 not 175!
r_return
id|si2
op_plus
l_int|15
suffix:semicolon
r_case
l_int|15
suffix:colon
singleline_comment|// 56000 bit/s failed, ai := 0 not 169 !
r_return
id|si2
op_plus
l_int|9
suffix:semicolon
r_case
l_int|14
suffix:colon
singleline_comment|// 48000 bit/s
r_return
id|si2
op_plus
l_int|8
suffix:semicolon
r_case
l_int|11
suffix:colon
singleline_comment|// 19200 bit/s
r_return
id|si2
op_plus
l_int|7
suffix:semicolon
r_case
l_int|9
suffix:colon
singleline_comment|// 14400 bit/s
r_return
id|si2
op_plus
l_int|6
suffix:semicolon
r_case
l_int|8
suffix:colon
singleline_comment|// 9600  bit/s
r_return
id|si2
op_plus
l_int|5
suffix:semicolon
r_case
l_int|5
suffix:colon
singleline_comment|// 4800  bit/s
r_return
id|si2
op_plus
l_int|4
suffix:semicolon
r_case
l_int|3
suffix:colon
singleline_comment|// 2400  bit/s
r_return
id|si2
op_plus
l_int|3
suffix:semicolon
r_case
l_int|23
suffix:colon
singleline_comment|// 75/1200 bit/s
r_return
id|si2
op_plus
l_int|2
suffix:semicolon
r_case
l_int|24
suffix:colon
singleline_comment|// 1200/75 bit/s
r_return
id|si2
op_plus
l_int|1
suffix:semicolon
r_default
suffix:colon
singleline_comment|// 1200 bit/s
r_return
id|si2
suffix:semicolon
)brace
)brace
r_static
id|u_char
DECL|function|DecodeSI2
id|DecodeSI2
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
id|u_char
op_star
id|p
suffix:semicolon
singleline_comment|//, *pend=skb-&gt;data + skb-&gt;len;
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|skb-&gt;data
comma
id|skb-&gt;len
comma
l_int|0x7c
comma
l_int|0
)paren
)paren
)paren
(brace
r_switch
c_cond
(paren
id|p
(braket
l_int|4
)braket
op_amp
l_int|0x0f
)paren
(brace
r_case
l_int|0x01
suffix:colon
r_if
c_cond
(paren
id|p
(braket
l_int|1
)braket
op_eq
l_int|0x04
)paren
singleline_comment|// sync. Bitratenadaption
r_return
id|DecodeSyncParams
c_func
(paren
l_int|160
comma
id|p
(braket
l_int|5
)braket
)paren
suffix:semicolon
singleline_comment|// V.110/X.30
r_else
r_if
c_cond
(paren
id|p
(braket
l_int|1
)braket
op_eq
l_int|0x06
)paren
singleline_comment|// async. Bitratenadaption
r_return
id|DecodeASyncParams
c_func
(paren
l_int|192
comma
id|p
)paren
suffix:semicolon
singleline_comment|// V.110/X.30
r_break
suffix:semicolon
r_case
l_int|0x08
suffix:colon
singleline_comment|// if (p[5] == 0x02) // sync. Bitratenadaption
r_if
c_cond
(paren
id|p
(braket
l_int|1
)braket
OG
l_int|3
)paren
r_return
id|DecodeSyncParams
c_func
(paren
l_int|176
comma
id|p
(braket
l_int|5
)braket
)paren
suffix:semicolon
singleline_comment|// V.120
r_break
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif
r_static
r_void
DECL|function|l3dss1_setup_req
id|l3dss1_setup_req
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|u_char
id|tmp
(braket
l_int|128
)braket
suffix:semicolon
id|u_char
op_star
id|p
op_assign
id|tmp
suffix:semicolon
id|u_char
id|channel
op_assign
l_int|0
suffix:semicolon
id|u_char
id|send_keypad
suffix:semicolon
id|u_char
id|screen
op_assign
l_int|0x80
suffix:semicolon
id|u_char
op_star
id|teln
suffix:semicolon
id|u_char
op_star
id|msn
suffix:semicolon
id|u_char
op_star
id|sub
suffix:semicolon
id|u_char
op_star
id|sp
suffix:semicolon
r_int
id|l
suffix:semicolon
id|MsgHead
c_func
(paren
id|p
comma
id|pc-&gt;callref
comma
id|MT_SETUP
)paren
suffix:semicolon
id|teln
op_assign
id|pc-&gt;para.setup.phone
suffix:semicolon
macro_line|#ifndef CONFIG_HISAX_NO_KEYPAD
id|send_keypad
op_assign
(paren
id|strchr
c_func
(paren
id|teln
comma
l_char|&squot;*&squot;
)paren
op_logical_or
id|strchr
c_func
(paren
id|teln
comma
l_char|&squot;#&squot;
)paren
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
macro_line|#else
id|send_keypad
op_assign
l_int|0
suffix:semicolon
macro_line|#endif
macro_line|#ifndef CONFIG_HISAX_NO_SENDCOMPLETE
r_if
c_cond
(paren
op_logical_neg
id|send_keypad
)paren
op_star
id|p
op_increment
op_assign
l_int|0xa1
suffix:semicolon
multiline_comment|/* complete indicator */
macro_line|#endif
multiline_comment|/*&n;&t; * Set Bearer Capability, Map info from 1TR6-convention to EDSS1&n;&t; */
r_switch
c_cond
(paren
id|pc-&gt;para.setup.si1
)paren
(brace
r_case
l_int|1
suffix:colon
multiline_comment|/* Telephony                                */
op_star
id|p
op_increment
op_assign
id|IE_BEARER
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x3
suffix:semicolon
multiline_comment|/* Length                                   */
op_star
id|p
op_increment
op_assign
l_int|0x90
suffix:semicolon
multiline_comment|/* Coding Std. CCITT, 3.1 kHz audio         */
op_star
id|p
op_increment
op_assign
l_int|0x90
suffix:semicolon
multiline_comment|/* Circuit-Mode 64kbps                      */
op_star
id|p
op_increment
op_assign
l_int|0xa3
suffix:semicolon
multiline_comment|/* A-Law Audio                              */
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
multiline_comment|/* Datatransmission 64k, BTX                */
r_case
l_int|7
suffix:colon
multiline_comment|/* Datatransmission 64k                     */
r_default
suffix:colon
op_star
id|p
op_increment
op_assign
id|IE_BEARER
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x2
suffix:semicolon
multiline_comment|/* Length                                   */
op_star
id|p
op_increment
op_assign
l_int|0x88
suffix:semicolon
multiline_comment|/* Coding Std. CCITT, unrestr. dig. Inform. */
op_star
id|p
op_increment
op_assign
l_int|0x90
suffix:semicolon
multiline_comment|/* Circuit-Mode 64kbps                      */
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|send_keypad
)paren
(brace
op_star
id|p
op_increment
op_assign
id|IE_KEYPAD
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|strlen
c_func
(paren
id|teln
)paren
suffix:semicolon
r_while
c_loop
(paren
op_star
id|teln
)paren
op_star
id|p
op_increment
op_assign
(paren
op_star
id|teln
op_increment
)paren
op_amp
l_int|0x7F
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * What about info2? Mapping to High-Layer-Compatibility?&n;&t; */
r_if
c_cond
(paren
(paren
op_star
id|teln
)paren
op_logical_and
(paren
op_logical_neg
id|send_keypad
)paren
)paren
(brace
multiline_comment|/* parse number for special things */
r_if
c_cond
(paren
op_logical_neg
id|isdigit
c_func
(paren
op_star
id|teln
)paren
)paren
(brace
r_switch
c_cond
(paren
l_int|0x5f
op_amp
op_star
id|teln
)paren
(brace
r_case
l_char|&squot;C&squot;
suffix:colon
id|channel
op_assign
l_int|0x08
suffix:semicolon
r_case
l_char|&squot;P&squot;
suffix:colon
id|channel
op_or_assign
l_int|0x80
suffix:semicolon
id|teln
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|teln
op_eq
l_char|&squot;1&squot;
)paren
id|channel
op_or_assign
l_int|0x01
suffix:semicolon
r_else
id|channel
op_or_assign
l_int|0x02
suffix:semicolon
r_break
suffix:semicolon
r_case
l_char|&squot;R&squot;
suffix:colon
id|screen
op_assign
l_int|0xA0
suffix:semicolon
r_break
suffix:semicolon
r_case
l_char|&squot;D&squot;
suffix:colon
id|screen
op_assign
l_int|0x80
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
(brace
)brace
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;Wrong MSN Code&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|teln
op_increment
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|channel
)paren
(brace
op_star
id|p
op_increment
op_assign
id|IE_CHANNEL_ID
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|1
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|channel
suffix:semicolon
)brace
id|msn
op_assign
id|pc-&gt;para.setup.eazmsn
suffix:semicolon
id|sub
op_assign
l_int|NULL
suffix:semicolon
id|sp
op_assign
id|msn
suffix:semicolon
r_while
c_loop
(paren
op_star
id|sp
)paren
(brace
r_if
c_cond
(paren
l_char|&squot;.&squot;
op_eq
op_star
id|sp
)paren
(brace
id|sub
op_assign
id|sp
suffix:semicolon
op_star
id|sp
op_assign
l_int|0
suffix:semicolon
)brace
r_else
id|sp
op_increment
suffix:semicolon
)brace
r_if
c_cond
(paren
op_star
id|msn
)paren
(brace
op_star
id|p
op_increment
op_assign
id|IE_CALLING_PN
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|strlen
c_func
(paren
id|msn
)paren
op_plus
(paren
id|screen
ques
c_cond
l_int|2
suffix:colon
l_int|1
)paren
suffix:semicolon
multiline_comment|/* Classify as AnyPref. */
r_if
c_cond
(paren
id|screen
)paren
(brace
op_star
id|p
op_increment
op_assign
l_int|0x01
suffix:semicolon
multiline_comment|/* Ext = &squot;0&squot;B, Type = &squot;000&squot;B, Plan = &squot;0001&squot;B. */
op_star
id|p
op_increment
op_assign
id|screen
suffix:semicolon
)brace
r_else
op_star
id|p
op_increment
op_assign
l_int|0x81
suffix:semicolon
multiline_comment|/* Ext = &squot;1&squot;B, Type = &squot;000&squot;B, Plan = &squot;0001&squot;B. */
r_while
c_loop
(paren
op_star
id|msn
)paren
op_star
id|p
op_increment
op_assign
op_star
id|msn
op_increment
op_amp
l_int|0x7f
suffix:semicolon
)brace
r_if
c_cond
(paren
id|sub
)paren
(brace
op_star
id|sub
op_increment
op_assign
l_char|&squot;.&squot;
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|IE_CALLING_SUB
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|strlen
c_func
(paren
id|sub
)paren
op_plus
l_int|2
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x80
suffix:semicolon
multiline_comment|/* NSAP coded */
op_star
id|p
op_increment
op_assign
l_int|0x50
suffix:semicolon
multiline_comment|/* local IDI format */
r_while
c_loop
(paren
op_star
id|sub
)paren
op_star
id|p
op_increment
op_assign
op_star
id|sub
op_increment
op_amp
l_int|0x7f
suffix:semicolon
)brace
id|sub
op_assign
l_int|NULL
suffix:semicolon
id|sp
op_assign
id|teln
suffix:semicolon
r_while
c_loop
(paren
op_star
id|sp
)paren
(brace
r_if
c_cond
(paren
l_char|&squot;.&squot;
op_eq
op_star
id|sp
)paren
(brace
id|sub
op_assign
id|sp
suffix:semicolon
op_star
id|sp
op_assign
l_int|0
suffix:semicolon
)brace
r_else
id|sp
op_increment
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|send_keypad
)paren
(brace
op_star
id|p
op_increment
op_assign
id|IE_CALLED_PN
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|strlen
c_func
(paren
id|teln
)paren
op_plus
l_int|1
suffix:semicolon
multiline_comment|/* Classify as AnyPref. */
op_star
id|p
op_increment
op_assign
l_int|0x81
suffix:semicolon
multiline_comment|/* Ext = &squot;1&squot;B, Type = &squot;000&squot;B, Plan = &squot;0001&squot;B. */
r_while
c_loop
(paren
op_star
id|teln
)paren
op_star
id|p
op_increment
op_assign
op_star
id|teln
op_increment
op_amp
l_int|0x7f
suffix:semicolon
r_if
c_cond
(paren
id|sub
)paren
(brace
op_star
id|sub
op_increment
op_assign
l_char|&squot;.&squot;
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|IE_CALLED_SUB
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|strlen
c_func
(paren
id|sub
)paren
op_plus
l_int|2
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x80
suffix:semicolon
multiline_comment|/* NSAP coded */
op_star
id|p
op_increment
op_assign
l_int|0x50
suffix:semicolon
multiline_comment|/* local IDI format */
r_while
c_loop
(paren
op_star
id|sub
)paren
op_star
id|p
op_increment
op_assign
op_star
id|sub
op_increment
op_amp
l_int|0x7f
suffix:semicolon
)brace
)brace
macro_line|#if EXT_BEARER_CAPS
r_if
c_cond
(paren
(paren
id|pc-&gt;para.setup.si2
op_ge
l_int|160
)paren
op_logical_and
(paren
id|pc-&gt;para.setup.si2
op_le
l_int|175
)paren
)paren
(brace
singleline_comment|// sync. Bitratenadaption, V.110/X.30
op_star
id|p
op_increment
op_assign
id|IE_LLC
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x04
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x88
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x90
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x21
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|EncodeSyncParams
c_func
(paren
id|pc-&gt;para.setup.si2
op_minus
l_int|160
comma
l_int|0x80
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
id|pc-&gt;para.setup.si2
op_ge
l_int|176
)paren
op_logical_and
(paren
id|pc-&gt;para.setup.si2
op_le
l_int|191
)paren
)paren
(brace
singleline_comment|// sync. Bitratenadaption, V.120
op_star
id|p
op_increment
op_assign
id|IE_LLC
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x05
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x88
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x90
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x28
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|EncodeSyncParams
c_func
(paren
id|pc-&gt;para.setup.si2
op_minus
l_int|176
comma
l_int|0
)paren
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x82
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|pc-&gt;para.setup.si2
op_ge
l_int|192
)paren
(brace
singleline_comment|// async. Bitratenadaption, V.110/X.30
op_star
id|p
op_increment
op_assign
id|IE_LLC
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x06
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x88
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x90
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x21
suffix:semicolon
id|p
op_assign
id|EncodeASyncParams
c_func
(paren
id|p
comma
id|pc-&gt;para.setup.si2
op_minus
l_int|192
)paren
suffix:semicolon
macro_line|#ifndef CONFIG_HISAX_NO_LLC
)brace
r_else
(brace
r_switch
c_cond
(paren
id|pc-&gt;para.setup.si1
)paren
(brace
r_case
l_int|1
suffix:colon
multiline_comment|/* Telephony                                */
op_star
id|p
op_increment
op_assign
id|IE_LLC
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x3
suffix:semicolon
multiline_comment|/* Length                                   */
op_star
id|p
op_increment
op_assign
l_int|0x90
suffix:semicolon
multiline_comment|/* Coding Std. CCITT, 3.1 kHz audio         */
op_star
id|p
op_increment
op_assign
l_int|0x90
suffix:semicolon
multiline_comment|/* Circuit-Mode 64kbps                      */
op_star
id|p
op_increment
op_assign
l_int|0xa3
suffix:semicolon
multiline_comment|/* A-Law Audio                              */
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
multiline_comment|/* Datatransmission 64k, BTX                */
r_case
l_int|7
suffix:colon
multiline_comment|/* Datatransmission 64k                     */
r_default
suffix:colon
op_star
id|p
op_increment
op_assign
id|IE_LLC
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x2
suffix:semicolon
multiline_comment|/* Length                                   */
op_star
id|p
op_increment
op_assign
l_int|0x88
suffix:semicolon
multiline_comment|/* Coding Std. CCITT, unrestr. dig. Inform. */
op_star
id|p
op_increment
op_assign
l_int|0x90
suffix:semicolon
multiline_comment|/* Circuit-Mode 64kbps                      */
r_break
suffix:semicolon
)brace
macro_line|#endif
)brace
macro_line|#endif
id|l
op_assign
id|p
op_minus
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|l3_alloc_skb
c_func
(paren
id|l
)paren
)paren
)paren
r_return
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|l
)paren
comma
id|tmp
comma
id|l
)paren
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|pc-&gt;timer
comma
id|T303
comma
id|CC_T303
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|1
)paren
suffix:semicolon
id|l3_msg
c_func
(paren
id|pc-&gt;st
comma
id|DL_DATA
op_or
id|REQUEST
comma
id|skb
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_call_proc
id|l3dss1_call_proc
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_int
id|id
comma
id|ret
suffix:semicolon
r_if
c_cond
(paren
(paren
id|id
op_assign
id|l3dss1_get_channel_id
c_func
(paren
id|pc
comma
id|skb
)paren
)paren
op_ge
l_int|0
)paren
(brace
r_if
c_cond
(paren
(paren
l_int|0
op_eq
id|id
)paren
op_logical_or
(paren
(paren
l_int|3
op_eq
id|id
)paren
op_logical_and
(paren
l_int|0x10
op_eq
id|pc-&gt;para.moderate
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;setup answer with wrong chid %x&quot;
comma
id|id
)paren
suffix:semicolon
id|pc-&gt;para.cause
op_assign
l_int|100
suffix:semicolon
id|l3dss1_status_send
c_func
(paren
id|pc
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|pc-&gt;para.bchannel
op_assign
id|id
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
l_int|1
op_eq
id|pc-&gt;state
)paren
(brace
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;setup answer wrong chid (ret %d)&quot;
comma
id|id
)paren
suffix:semicolon
r_if
c_cond
(paren
id|id
op_eq
op_minus
l_int|1
)paren
id|pc-&gt;para.cause
op_assign
l_int|96
suffix:semicolon
r_else
id|pc-&gt;para.cause
op_assign
l_int|100
suffix:semicolon
id|l3dss1_status_send
c_func
(paren
id|pc
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
multiline_comment|/* Now we are on none mandatory IEs */
id|ret
op_assign
id|check_infoelements
c_func
(paren
id|pc
comma
id|skb
comma
id|ie_CALL_PROCEEDING
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ERR_IE_COMPREHENSION
op_eq
id|ret
)paren
(brace
id|l3dss1_std_ie_err
c_func
(paren
id|pc
comma
id|ret
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|3
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|pc-&gt;timer
comma
id|T310
comma
id|CC_T310
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
multiline_comment|/* STATUS for none mandatory IE errors after actions are taken */
id|l3dss1_std_ie_err
c_func
(paren
id|pc
comma
id|ret
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc-&gt;st
comma
id|CC_PROCEEDING
op_or
id|INDICATION
comma
id|pc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_setup_ack
id|l3dss1_setup_ack
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_int
id|id
comma
id|ret
suffix:semicolon
r_if
c_cond
(paren
(paren
id|id
op_assign
id|l3dss1_get_channel_id
c_func
(paren
id|pc
comma
id|skb
)paren
)paren
op_ge
l_int|0
)paren
(brace
r_if
c_cond
(paren
(paren
l_int|0
op_eq
id|id
)paren
op_logical_or
(paren
(paren
l_int|3
op_eq
id|id
)paren
op_logical_and
(paren
l_int|0x10
op_eq
id|pc-&gt;para.moderate
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;setup answer with wrong chid %x&quot;
comma
id|id
)paren
suffix:semicolon
id|pc-&gt;para.cause
op_assign
l_int|100
suffix:semicolon
id|l3dss1_status_send
c_func
(paren
id|pc
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|pc-&gt;para.bchannel
op_assign
id|id
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;setup answer wrong chid (ret %d)&quot;
comma
id|id
)paren
suffix:semicolon
r_if
c_cond
(paren
id|id
op_eq
op_minus
l_int|1
)paren
id|pc-&gt;para.cause
op_assign
l_int|96
suffix:semicolon
r_else
id|pc-&gt;para.cause
op_assign
l_int|100
suffix:semicolon
id|l3dss1_status_send
c_func
(paren
id|pc
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
multiline_comment|/* Now we are on none mandatory IEs */
id|ret
op_assign
id|check_infoelements
c_func
(paren
id|pc
comma
id|skb
comma
id|ie_SETUP_ACKNOWLEDGE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ERR_IE_COMPREHENSION
op_eq
id|ret
)paren
(brace
id|l3dss1_std_ie_err
c_func
(paren
id|pc
comma
id|ret
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|2
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|pc-&gt;timer
comma
id|T304
comma
id|CC_T304
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
multiline_comment|/* STATUS for none mandatory IE errors after actions are taken */
id|l3dss1_std_ie_err
c_func
(paren
id|pc
comma
id|ret
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc-&gt;st
comma
id|CC_MORE_INFO
op_or
id|INDICATION
comma
id|pc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_disconnect
id|l3dss1_disconnect
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|u_char
op_star
id|p
suffix:semicolon
r_int
id|ret
suffix:semicolon
id|u_char
id|cause
op_assign
l_int|0
suffix:semicolon
id|StopAllL3Timer
c_func
(paren
id|pc
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ret
op_assign
id|l3dss1_get_cause
c_func
(paren
id|pc
comma
id|skb
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;DISC get_cause ret(%d)&quot;
comma
id|ret
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
OL
l_int|0
)paren
id|cause
op_assign
l_int|96
suffix:semicolon
r_else
r_if
c_cond
(paren
id|ret
OG
l_int|0
)paren
id|cause
op_assign
l_int|100
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|skb-&gt;data
comma
id|skb-&gt;len
comma
id|IE_FACILITY
comma
l_int|0
)paren
)paren
)paren
id|l3dss1_parse_facility
c_func
(paren
id|pc-&gt;st
comma
id|pc
comma
id|pc-&gt;callref
comma
id|p
)paren
suffix:semicolon
id|ret
op_assign
id|check_infoelements
c_func
(paren
id|pc
comma
id|skb
comma
id|ie_DISCONNECT
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ERR_IE_COMPREHENSION
op_eq
id|ret
)paren
id|cause
op_assign
l_int|96
suffix:semicolon
r_else
r_if
c_cond
(paren
(paren
op_logical_neg
id|cause
)paren
op_logical_and
(paren
id|ERR_IE_UNRECOGNIZED
op_eq
id|ret
)paren
)paren
id|cause
op_assign
l_int|99
suffix:semicolon
id|ret
op_assign
id|pc-&gt;state
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|12
)paren
suffix:semicolon
r_if
c_cond
(paren
id|cause
)paren
id|newl3state
c_func
(paren
id|pc
comma
l_int|19
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|11
op_ne
id|ret
)paren
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc-&gt;st
comma
id|CC_DISCONNECT
op_or
id|INDICATION
comma
id|pc
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|cause
)paren
id|l3dss1_release_req
c_func
(paren
id|pc
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|cause
)paren
(brace
id|l3dss1_message_cause
c_func
(paren
id|pc
comma
id|MT_RELEASE
comma
id|cause
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|pc-&gt;timer
comma
id|T308
comma
id|CC_T308_1
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|l3dss1_connect
id|l3dss1_connect
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_int
id|ret
suffix:semicolon
id|ret
op_assign
id|check_infoelements
c_func
(paren
id|pc
comma
id|skb
comma
id|ie_CONNECT
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ERR_IE_COMPREHENSION
op_eq
id|ret
)paren
(brace
id|l3dss1_std_ie_err
c_func
(paren
id|pc
comma
id|ret
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
multiline_comment|/* T310 */
id|newl3state
c_func
(paren
id|pc
comma
l_int|10
)paren
suffix:semicolon
id|pc-&gt;para.chargeinfo
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* here should inserted COLP handling KKe */
r_if
c_cond
(paren
id|ret
)paren
id|l3dss1_std_ie_err
c_func
(paren
id|pc
comma
id|ret
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc-&gt;st
comma
id|CC_SETUP
op_or
id|CONFIRM
comma
id|pc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_alerting
id|l3dss1_alerting
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_int
id|ret
suffix:semicolon
id|ret
op_assign
id|check_infoelements
c_func
(paren
id|pc
comma
id|skb
comma
id|ie_ALERTING
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ERR_IE_COMPREHENSION
op_eq
id|ret
)paren
(brace
id|l3dss1_std_ie_err
c_func
(paren
id|pc
comma
id|ret
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
multiline_comment|/* T304 */
id|newl3state
c_func
(paren
id|pc
comma
l_int|4
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
id|l3dss1_std_ie_err
c_func
(paren
id|pc
comma
id|ret
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc-&gt;st
comma
id|CC_ALERTING
op_or
id|INDICATION
comma
id|pc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_setup
id|l3dss1_setup
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|u_char
op_star
id|p
suffix:semicolon
r_int
id|bcfound
op_assign
l_int|0
suffix:semicolon
r_char
id|tmp
(braket
l_int|80
)braket
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_int
id|id
suffix:semicolon
r_int
id|err
op_assign
l_int|0
suffix:semicolon
multiline_comment|/*&n;&t; * Bearer Capabilities&n;&t; */
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
multiline_comment|/* only the first occurence &squot;ll be detected ! */
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
l_int|0x04
comma
l_int|0
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
id|p
(braket
l_int|1
)braket
OL
l_int|2
)paren
op_logical_or
(paren
id|p
(braket
l_int|1
)braket
OG
l_int|11
)paren
)paren
id|err
op_assign
l_int|1
suffix:semicolon
r_else
(brace
id|pc-&gt;para.setup.si2
op_assign
l_int|0
suffix:semicolon
r_switch
c_cond
(paren
id|p
(braket
l_int|2
)braket
op_amp
l_int|0x7f
)paren
(brace
r_case
l_int|0x00
suffix:colon
multiline_comment|/* Speech */
r_case
l_int|0x10
suffix:colon
multiline_comment|/* 3.1 Khz audio */
id|pc-&gt;para.setup.si1
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x08
suffix:colon
multiline_comment|/* Unrestricted digital information */
id|pc-&gt;para.setup.si1
op_assign
l_int|7
suffix:semicolon
multiline_comment|/* JIM, 05.11.97 I wanna set service indicator 2 */
macro_line|#if EXT_BEARER_CAPS
id|pc-&gt;para.setup.si2
op_assign
id|DecodeSI2
c_func
(paren
id|skb
)paren
suffix:semicolon
macro_line|#endif
r_break
suffix:semicolon
r_case
l_int|0x09
suffix:colon
multiline_comment|/* Restricted digital information */
id|pc-&gt;para.setup.si1
op_assign
l_int|2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x11
suffix:colon
multiline_comment|/* Unrestr. digital information  with &n;&t;&t;&t;&t;&t; * tones/announcements ( or 7 kHz audio&n;&t;&t;&t;&t;&t; */
id|pc-&gt;para.setup.si1
op_assign
l_int|3
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x18
suffix:colon
multiline_comment|/* Video */
id|pc-&gt;para.setup.si1
op_assign
l_int|4
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|err
op_assign
l_int|2
suffix:semicolon
r_break
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|p
(braket
l_int|3
)braket
op_amp
l_int|0x7f
)paren
(brace
r_case
l_int|0x40
suffix:colon
multiline_comment|/* packed mode */
id|pc-&gt;para.setup.si1
op_assign
l_int|8
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x10
suffix:colon
multiline_comment|/* 64 kbit */
r_case
l_int|0x11
suffix:colon
multiline_comment|/* 2*64 kbit */
r_case
l_int|0x13
suffix:colon
multiline_comment|/* 384 kbit */
r_case
l_int|0x15
suffix:colon
multiline_comment|/* 1536 kbit */
r_case
l_int|0x17
suffix:colon
multiline_comment|/* 1920 kbit */
id|pc-&gt;para.moderate
op_assign
id|p
(braket
l_int|3
)braket
op_amp
l_int|0x7f
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|err
op_assign
l_int|3
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_SI
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;SI=%d, AI=%d&quot;
comma
id|pc-&gt;para.setup.si1
comma
id|pc-&gt;para.setup.si2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
(brace
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;setup with wrong bearer(l=%d:%x,%x)&quot;
comma
id|p
(braket
l_int|1
)braket
comma
id|p
(braket
l_int|2
)braket
comma
id|p
(braket
l_int|3
)braket
)paren
suffix:semicolon
id|pc-&gt;para.cause
op_assign
l_int|100
suffix:semicolon
id|l3dss1_msg_without_setup
c_func
(paren
id|pc
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;setup without bearer capabilities&quot;
)paren
suffix:semicolon
multiline_comment|/* ETS 300-104 1.3.3 */
id|pc-&gt;para.cause
op_assign
l_int|96
suffix:semicolon
id|l3dss1_msg_without_setup
c_func
(paren
id|pc
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * Channel Identification&n;&t; */
r_if
c_cond
(paren
(paren
id|id
op_assign
id|l3dss1_get_channel_id
c_func
(paren
id|pc
comma
id|skb
)paren
)paren
op_ge
l_int|0
)paren
(brace
r_if
c_cond
(paren
(paren
id|pc-&gt;para.bchannel
op_assign
id|id
)paren
)paren
(brace
r_if
c_cond
(paren
(paren
l_int|3
op_eq
id|id
)paren
op_logical_and
(paren
l_int|0x10
op_eq
id|pc-&gt;para.moderate
)paren
)paren
(brace
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;setup with wrong chid %x&quot;
comma
id|id
)paren
suffix:semicolon
id|pc-&gt;para.cause
op_assign
l_int|100
suffix:semicolon
id|l3dss1_msg_without_setup
c_func
(paren
id|pc
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|bcfound
op_increment
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;setup without bchannel, call waiting&quot;
)paren
suffix:semicolon
id|bcfound
op_increment
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;setup with wrong chid ret %d&quot;
comma
id|id
)paren
suffix:semicolon
r_if
c_cond
(paren
id|id
op_eq
op_minus
l_int|1
)paren
id|pc-&gt;para.cause
op_assign
l_int|96
suffix:semicolon
r_else
id|pc-&gt;para.cause
op_assign
l_int|100
suffix:semicolon
id|l3dss1_msg_without_setup
c_func
(paren
id|pc
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
multiline_comment|/* Now we are on none mandatory IEs */
id|err
op_assign
id|check_infoelements
c_func
(paren
id|pc
comma
id|skb
comma
id|ie_SETUP
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ERR_IE_COMPREHENSION
op_eq
id|err
)paren
(brace
id|pc-&gt;para.cause
op_assign
l_int|96
suffix:semicolon
id|l3dss1_msg_without_setup
c_func
(paren
id|pc
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
l_int|0x70
comma
l_int|0
)paren
)paren
)paren
id|iecpy
c_func
(paren
id|pc-&gt;para.setup.eazmsn
comma
id|p
comma
l_int|1
)paren
suffix:semicolon
r_else
id|pc-&gt;para.setup.eazmsn
(braket
l_int|0
)braket
op_assign
l_int|0
suffix:semicolon
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
l_int|0x71
comma
l_int|0
)paren
)paren
)paren
(brace
multiline_comment|/* Called party subaddress */
r_if
c_cond
(paren
(paren
id|p
(braket
l_int|1
)braket
op_ge
l_int|2
)paren
op_logical_and
(paren
id|p
(braket
l_int|2
)braket
op_eq
l_int|0x80
)paren
op_logical_and
(paren
id|p
(braket
l_int|3
)braket
op_eq
l_int|0x50
)paren
)paren
(brace
id|tmp
(braket
l_int|0
)braket
op_assign
l_char|&squot;.&squot;
suffix:semicolon
id|iecpy
c_func
(paren
op_amp
id|tmp
(braket
l_int|1
)braket
comma
id|p
comma
l_int|2
)paren
suffix:semicolon
id|strcat
c_func
(paren
id|pc-&gt;para.setup.eazmsn
comma
id|tmp
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;wrong called subaddress&quot;
)paren
suffix:semicolon
)brace
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
l_int|0x6c
comma
l_int|0
)paren
)paren
)paren
(brace
id|pc-&gt;para.setup.plan
op_assign
id|p
(braket
l_int|2
)braket
suffix:semicolon
r_if
c_cond
(paren
id|p
(braket
l_int|2
)braket
op_amp
l_int|0x80
)paren
(brace
id|iecpy
c_func
(paren
id|pc-&gt;para.setup.phone
comma
id|p
comma
l_int|1
)paren
suffix:semicolon
id|pc-&gt;para.setup.screen
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|iecpy
c_func
(paren
id|pc-&gt;para.setup.phone
comma
id|p
comma
l_int|2
)paren
suffix:semicolon
id|pc-&gt;para.setup.screen
op_assign
id|p
(braket
l_int|3
)braket
suffix:semicolon
)brace
)brace
r_else
(brace
id|pc-&gt;para.setup.phone
(braket
l_int|0
)braket
op_assign
l_int|0
suffix:semicolon
id|pc-&gt;para.setup.plan
op_assign
l_int|0
suffix:semicolon
id|pc-&gt;para.setup.screen
op_assign
l_int|0
suffix:semicolon
)brace
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
l_int|0x6d
comma
l_int|0
)paren
)paren
)paren
(brace
multiline_comment|/* Calling party subaddress */
r_if
c_cond
(paren
(paren
id|p
(braket
l_int|1
)braket
op_ge
l_int|2
)paren
op_logical_and
(paren
id|p
(braket
l_int|2
)braket
op_eq
l_int|0x80
)paren
op_logical_and
(paren
id|p
(braket
l_int|3
)braket
op_eq
l_int|0x50
)paren
)paren
(brace
id|tmp
(braket
l_int|0
)braket
op_assign
l_char|&squot;.&squot;
suffix:semicolon
id|iecpy
c_func
(paren
op_amp
id|tmp
(braket
l_int|1
)braket
comma
id|p
comma
l_int|2
)paren
suffix:semicolon
id|strcat
c_func
(paren
id|pc-&gt;para.setup.phone
comma
id|tmp
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;wrong calling subaddress&quot;
)paren
suffix:semicolon
)brace
id|newl3state
c_func
(paren
id|pc
comma
l_int|6
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
multiline_comment|/* STATUS for none mandatory IE errors after actions are taken */
id|l3dss1_std_ie_err
c_func
(paren
id|pc
comma
id|err
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc-&gt;st
comma
id|CC_SETUP
op_or
id|INDICATION
comma
id|pc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_reset
id|l3dss1_reset
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|dss1_release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_disconnect_req
id|l3dss1_disconnect_req
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|u_char
id|tmp
(braket
l_int|16
op_plus
l_int|40
)braket
suffix:semicolon
id|u_char
op_star
id|p
op_assign
id|tmp
suffix:semicolon
r_int
id|l
suffix:semicolon
id|u_char
id|cause
op_assign
l_int|16
suffix:semicolon
r_if
c_cond
(paren
id|pc-&gt;para.cause
op_ne
id|NO_CAUSE
)paren
id|cause
op_assign
id|pc-&gt;para.cause
suffix:semicolon
id|StopAllL3Timer
c_func
(paren
id|pc
)paren
suffix:semicolon
id|MsgHead
c_func
(paren
id|p
comma
id|pc-&gt;callref
comma
id|MT_DISCONNECT
)paren
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|IE_CAUSE
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x2
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x80
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|cause
op_or
l_int|0x80
suffix:semicolon
r_if
c_cond
(paren
id|pc-&gt;prot.dss1.uus1_data
(braket
l_int|0
)braket
)paren
(brace
op_star
id|p
op_increment
op_assign
id|IE_USER_USER
suffix:semicolon
multiline_comment|/* UUS info element */
op_star
id|p
op_increment
op_assign
id|strlen
c_func
(paren
id|pc-&gt;prot.dss1.uus1_data
)paren
op_plus
l_int|1
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x04
suffix:semicolon
multiline_comment|/* IA5 chars */
id|strcpy
c_func
(paren
id|p
comma
id|pc-&gt;prot.dss1.uus1_data
)paren
suffix:semicolon
id|p
op_add_assign
id|strlen
c_func
(paren
id|pc-&gt;prot.dss1.uus1_data
)paren
suffix:semicolon
id|pc-&gt;prot.dss1.uus1_data
(braket
l_int|0
)braket
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
)brace
id|l
op_assign
id|p
op_minus
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|l3_alloc_skb
c_func
(paren
id|l
)paren
)paren
)paren
r_return
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|l
)paren
comma
id|tmp
comma
id|l
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|11
)paren
suffix:semicolon
id|l3_msg
c_func
(paren
id|pc-&gt;st
comma
id|DL_DATA
op_or
id|REQUEST
comma
id|skb
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|pc-&gt;timer
comma
id|T305
comma
id|CC_T305
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_setup_rsp
id|l3dss1_setup_rsp
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|pc-&gt;para.bchannel
)paren
(brace
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;D-chan connect for waiting call&quot;
)paren
suffix:semicolon
id|l3dss1_disconnect_req
c_func
(paren
id|pc
comma
id|pr
comma
id|arg
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|newl3state
c_func
(paren
id|pc
comma
l_int|8
)paren
suffix:semicolon
id|l3dss1_message
c_func
(paren
id|pc
comma
id|MT_CONNECT
)paren
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|pc-&gt;timer
comma
id|T313
comma
id|CC_T313
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_connect_ack
id|l3dss1_connect_ack
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_int
id|ret
suffix:semicolon
id|ret
op_assign
id|check_infoelements
c_func
(paren
id|pc
comma
id|skb
comma
id|ie_CONNECT_ACKNOWLEDGE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ERR_IE_COMPREHENSION
op_eq
id|ret
)paren
(brace
id|l3dss1_std_ie_err
c_func
(paren
id|pc
comma
id|ret
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|newl3state
c_func
(paren
id|pc
comma
l_int|10
)paren
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
id|l3dss1_std_ie_err
c_func
(paren
id|pc
comma
id|ret
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc-&gt;st
comma
id|CC_SETUP_COMPL
op_or
id|INDICATION
comma
id|pc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_reject_req
id|l3dss1_reject_req
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|u_char
id|tmp
(braket
l_int|16
)braket
suffix:semicolon
id|u_char
op_star
id|p
op_assign
id|tmp
suffix:semicolon
r_int
id|l
suffix:semicolon
id|u_char
id|cause
op_assign
l_int|21
suffix:semicolon
r_if
c_cond
(paren
id|pc-&gt;para.cause
op_ne
id|NO_CAUSE
)paren
id|cause
op_assign
id|pc-&gt;para.cause
suffix:semicolon
id|MsgHead
c_func
(paren
id|p
comma
id|pc-&gt;callref
comma
id|MT_RELEASE_COMPLETE
)paren
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|IE_CAUSE
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x2
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x80
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|cause
op_or
l_int|0x80
suffix:semicolon
id|l
op_assign
id|p
op_minus
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|l3_alloc_skb
c_func
(paren
id|l
)paren
)paren
)paren
r_return
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|l
)paren
comma
id|tmp
comma
id|l
)paren
suffix:semicolon
id|l3_msg
c_func
(paren
id|pc-&gt;st
comma
id|DL_DATA
op_or
id|REQUEST
comma
id|skb
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc-&gt;st
comma
id|CC_RELEASE
op_or
id|INDICATION
comma
id|pc
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|0
)paren
suffix:semicolon
id|dss1_release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_release
id|l3dss1_release
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|u_char
op_star
id|p
suffix:semicolon
r_int
id|ret
comma
id|cause
op_assign
l_int|0
suffix:semicolon
id|StopAllL3Timer
c_func
(paren
id|pc
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ret
op_assign
id|l3dss1_get_cause
c_func
(paren
id|pc
comma
id|skb
)paren
)paren
OG
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;REL get_cause ret(%d)&quot;
comma
id|ret
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|ret
OL
l_int|0
)paren
id|pc-&gt;para.cause
op_assign
id|NO_CAUSE
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|skb-&gt;data
comma
id|skb-&gt;len
comma
id|IE_FACILITY
comma
l_int|0
)paren
)paren
)paren
(brace
id|l3dss1_parse_facility
c_func
(paren
id|pc-&gt;st
comma
id|pc
comma
id|pc-&gt;callref
comma
id|p
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|ret
OL
l_int|0
)paren
op_logical_and
(paren
id|pc-&gt;state
op_ne
l_int|11
)paren
)paren
id|cause
op_assign
l_int|96
suffix:semicolon
r_else
r_if
c_cond
(paren
id|ret
OG
l_int|0
)paren
id|cause
op_assign
l_int|100
suffix:semicolon
id|ret
op_assign
id|check_infoelements
c_func
(paren
id|pc
comma
id|skb
comma
id|ie_RELEASE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ERR_IE_COMPREHENSION
op_eq
id|ret
)paren
id|cause
op_assign
l_int|96
suffix:semicolon
r_else
r_if
c_cond
(paren
(paren
id|ERR_IE_UNRECOGNIZED
op_eq
id|ret
)paren
op_logical_and
(paren
op_logical_neg
id|cause
)paren
)paren
id|cause
op_assign
l_int|99
suffix:semicolon
r_if
c_cond
(paren
id|cause
)paren
id|l3dss1_message_cause
c_func
(paren
id|pc
comma
id|MT_RELEASE_COMPLETE
comma
id|cause
)paren
suffix:semicolon
r_else
id|l3dss1_message
c_func
(paren
id|pc
comma
id|MT_RELEASE_COMPLETE
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc-&gt;st
comma
id|CC_RELEASE
op_or
id|INDICATION
comma
id|pc
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|0
)paren
suffix:semicolon
id|dss1_release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_alert_req
id|l3dss1_alert_req
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|newl3state
c_func
(paren
id|pc
comma
l_int|7
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|pc-&gt;prot.dss1.uus1_data
(braket
l_int|0
)braket
)paren
id|l3dss1_message
c_func
(paren
id|pc
comma
id|MT_ALERTING
)paren
suffix:semicolon
r_else
id|l3dss1_msg_with_uus
c_func
(paren
id|pc
comma
id|MT_ALERTING
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_proceed_req
id|l3dss1_proceed_req
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|newl3state
c_func
(paren
id|pc
comma
l_int|9
)paren
suffix:semicolon
id|l3dss1_message
c_func
(paren
id|pc
comma
id|MT_CALL_PROCEEDING
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc-&gt;st
comma
id|CC_PROCEED_SEND
op_or
id|INDICATION
comma
id|pc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_setup_ack_req
id|l3dss1_setup_ack_req
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|newl3state
c_func
(paren
id|pc
comma
l_int|25
)paren
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|pc-&gt;timer
comma
id|T302
comma
id|CC_T302
)paren
suffix:semicolon
id|l3dss1_message
c_func
(paren
id|pc
comma
id|MT_SETUP_ACKNOWLEDGE
)paren
suffix:semicolon
)brace
multiline_comment|/********************************************/
multiline_comment|/* deliver a incoming display message to HL */
multiline_comment|/********************************************/
r_static
r_void
DECL|function|l3dss1_deliver_display
id|l3dss1_deliver_display
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
r_int
id|pr
comma
id|u_char
op_star
id|infp
)paren
(brace
id|u_char
id|len
suffix:semicolon
id|isdn_ctrl
id|ic
suffix:semicolon
r_struct
id|IsdnCardState
op_star
id|cs
suffix:semicolon
r_char
op_star
id|p
suffix:semicolon
r_if
c_cond
(paren
op_star
id|infp
op_increment
op_ne
id|IE_DISPLAY
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
(paren
id|len
op_assign
op_star
id|infp
op_increment
)paren
OG
l_int|80
)paren
r_return
suffix:semicolon
multiline_comment|/* total length &lt;= 82 */
r_if
c_cond
(paren
op_logical_neg
id|pc-&gt;chan
)paren
r_return
suffix:semicolon
id|p
op_assign
id|ic.parm.display
suffix:semicolon
r_while
c_loop
(paren
id|len
op_decrement
)paren
op_star
id|p
op_increment
op_assign
op_star
id|infp
op_increment
suffix:semicolon
op_star
id|p
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_DISPLAY
suffix:semicolon
id|cs
op_assign
id|pc-&gt;st-&gt;l1.hardware
suffix:semicolon
id|ic.driver
op_assign
id|cs-&gt;myid
suffix:semicolon
id|ic.arg
op_assign
id|pc-&gt;chan-&gt;chan
suffix:semicolon
id|cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
)brace
multiline_comment|/* l3dss1_deliver_display */
r_static
r_void
DECL|function|l3dss1_progress
id|l3dss1_progress
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_int
id|err
op_assign
l_int|0
suffix:semicolon
id|u_char
op_star
id|p
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|skb-&gt;data
comma
id|skb-&gt;len
comma
id|IE_PROGRESS
comma
l_int|0
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
id|p
(braket
l_int|1
)braket
op_ne
l_int|2
)paren
(brace
id|err
op_assign
l_int|1
suffix:semicolon
id|pc-&gt;para.cause
op_assign
l_int|100
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
(paren
id|p
(braket
l_int|2
)braket
op_amp
l_int|0x70
)paren
)paren
(brace
r_switch
c_cond
(paren
id|p
(braket
l_int|2
)braket
)paren
(brace
r_case
l_int|0x80
suffix:colon
r_case
l_int|0x81
suffix:colon
r_case
l_int|0x82
suffix:colon
r_case
l_int|0x84
suffix:colon
r_case
l_int|0x85
suffix:colon
r_case
l_int|0x87
suffix:colon
r_case
l_int|0x8a
suffix:colon
r_switch
c_cond
(paren
id|p
(braket
l_int|3
)braket
)paren
(brace
r_case
l_int|0x81
suffix:colon
r_case
l_int|0x82
suffix:colon
r_case
l_int|0x83
suffix:colon
r_case
l_int|0x84
suffix:colon
r_case
l_int|0x88
suffix:colon
r_break
suffix:semicolon
r_default
suffix:colon
id|err
op_assign
l_int|2
suffix:semicolon
id|pc-&gt;para.cause
op_assign
l_int|100
suffix:semicolon
r_break
suffix:semicolon
)brace
r_break
suffix:semicolon
r_default
suffix:colon
id|err
op_assign
l_int|3
suffix:semicolon
id|pc-&gt;para.cause
op_assign
l_int|100
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
)brace
r_else
(brace
id|pc-&gt;para.cause
op_assign
l_int|96
suffix:semicolon
id|err
op_assign
l_int|4
suffix:semicolon
)brace
r_if
c_cond
(paren
id|err
)paren
(brace
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;progress error %d&quot;
comma
id|err
)paren
suffix:semicolon
id|l3dss1_status_send
c_func
(paren
id|pc
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
multiline_comment|/* Now we are on none mandatory IEs */
id|err
op_assign
id|check_infoelements
c_func
(paren
id|pc
comma
id|skb
comma
id|ie_PROGRESS
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
id|l3dss1_std_ie_err
c_func
(paren
id|pc
comma
id|err
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ERR_IE_COMPREHENSION
op_ne
id|err
)paren
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc-&gt;st
comma
id|CC_PROGRESS
op_or
id|INDICATION
comma
id|pc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_notify
id|l3dss1_notify
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_int
id|err
op_assign
l_int|0
suffix:semicolon
id|u_char
op_star
id|p
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|skb-&gt;data
comma
id|skb-&gt;len
comma
id|IE_NOTIFY
comma
l_int|0
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
id|p
(braket
l_int|1
)braket
op_ne
l_int|1
)paren
(brace
id|err
op_assign
l_int|1
suffix:semicolon
id|pc-&gt;para.cause
op_assign
l_int|100
suffix:semicolon
)brace
r_else
(brace
r_switch
c_cond
(paren
id|p
(braket
l_int|2
)braket
)paren
(brace
r_case
l_int|0x80
suffix:colon
r_case
l_int|0x81
suffix:colon
r_case
l_int|0x82
suffix:colon
r_break
suffix:semicolon
r_default
suffix:colon
id|pc-&gt;para.cause
op_assign
l_int|100
suffix:semicolon
id|err
op_assign
l_int|2
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
)brace
r_else
(brace
id|pc-&gt;para.cause
op_assign
l_int|96
suffix:semicolon
id|err
op_assign
l_int|3
suffix:semicolon
)brace
r_if
c_cond
(paren
id|err
)paren
(brace
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;notify error %d&quot;
comma
id|err
)paren
suffix:semicolon
id|l3dss1_status_send
c_func
(paren
id|pc
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
multiline_comment|/* Now we are on none mandatory IEs */
id|err
op_assign
id|check_infoelements
c_func
(paren
id|pc
comma
id|skb
comma
id|ie_NOTIFY
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
id|l3dss1_std_ie_err
c_func
(paren
id|pc
comma
id|err
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ERR_IE_COMPREHENSION
op_ne
id|err
)paren
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc-&gt;st
comma
id|CC_NOTIFY
op_or
id|INDICATION
comma
id|pc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_status_enq
id|l3dss1_status_enq
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_int
id|ret
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|ret
op_assign
id|check_infoelements
c_func
(paren
id|pc
comma
id|skb
comma
id|ie_STATUS_ENQUIRY
)paren
suffix:semicolon
id|l3dss1_std_ie_err
c_func
(paren
id|pc
comma
id|ret
)paren
suffix:semicolon
id|pc-&gt;para.cause
op_assign
l_int|30
suffix:semicolon
multiline_comment|/* response to STATUS_ENQUIRY */
id|l3dss1_status_send
c_func
(paren
id|pc
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_information
id|l3dss1_information
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_int
id|ret
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
id|u_char
op_star
id|p
suffix:semicolon
r_char
id|tmp
(braket
l_int|32
)braket
suffix:semicolon
id|ret
op_assign
id|check_infoelements
c_func
(paren
id|pc
comma
id|skb
comma
id|ie_INFORMATION
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
id|l3dss1_std_ie_err
c_func
(paren
id|pc
comma
id|ret
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pc-&gt;state
op_eq
l_int|25
)paren
(brace
multiline_comment|/* overlap receiving */
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
l_int|0x70
comma
l_int|0
)paren
)paren
)paren
(brace
id|iecpy
c_func
(paren
id|tmp
comma
id|p
comma
l_int|1
)paren
suffix:semicolon
id|strcat
c_func
(paren
id|pc-&gt;para.setup.eazmsn
comma
id|tmp
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc-&gt;st
comma
id|CC_MORE_INFO
op_or
id|INDICATION
comma
id|pc
)paren
suffix:semicolon
)brace
id|L3AddTimer
c_func
(paren
op_amp
id|pc-&gt;timer
comma
id|T302
comma
id|CC_T302
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/******************************/
multiline_comment|/* handle deflection requests */
multiline_comment|/******************************/
DECL|function|l3dss1_redir_req
r_static
r_void
id|l3dss1_redir_req
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|u_char
id|tmp
(braket
l_int|128
)braket
suffix:semicolon
id|u_char
op_star
id|p
op_assign
id|tmp
suffix:semicolon
id|u_char
op_star
id|subp
suffix:semicolon
id|u_char
id|len_phone
op_assign
l_int|0
suffix:semicolon
id|u_char
id|len_sub
op_assign
l_int|0
suffix:semicolon
r_int
id|l
suffix:semicolon
id|strcpy
c_func
(paren
id|pc-&gt;prot.dss1.uus1_data
comma
id|pc-&gt;chan-&gt;setup.eazmsn
)paren
suffix:semicolon
multiline_comment|/* copy uus element if available */
r_if
c_cond
(paren
op_logical_neg
id|pc-&gt;chan-&gt;setup.phone
(braket
l_int|0
)braket
)paren
(brace
id|pc-&gt;para.cause
op_assign
op_minus
l_int|1
suffix:semicolon
id|l3dss1_disconnect_req
c_func
(paren
id|pc
comma
id|pr
comma
id|arg
)paren
suffix:semicolon
multiline_comment|/* disconnect immediately */
r_return
suffix:semicolon
)brace
multiline_comment|/* only uus */
r_if
c_cond
(paren
id|pc-&gt;prot.dss1.invoke_id
)paren
id|free_invoke_id
c_func
(paren
id|pc-&gt;st
comma
id|pc-&gt;prot.dss1.invoke_id
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|pc-&gt;prot.dss1.invoke_id
op_assign
id|new_invoke_id
c_func
(paren
id|pc-&gt;st
)paren
)paren
)paren
r_return
suffix:semicolon
id|MsgHead
c_func
(paren
id|p
comma
id|pc-&gt;callref
comma
id|MT_FACILITY
)paren
suffix:semicolon
r_for
c_loop
(paren
id|subp
op_assign
id|pc-&gt;chan-&gt;setup.phone
suffix:semicolon
(paren
op_star
id|subp
)paren
op_logical_and
(paren
op_star
id|subp
op_ne
l_char|&squot;.&squot;
)paren
suffix:semicolon
id|subp
op_increment
)paren
id|len_phone
op_increment
suffix:semicolon
multiline_comment|/* len of phone number */
r_if
c_cond
(paren
op_star
id|subp
op_increment
op_eq
l_char|&squot;.&squot;
)paren
id|len_sub
op_assign
id|strlen
c_func
(paren
id|subp
)paren
op_plus
l_int|2
suffix:semicolon
multiline_comment|/* length including info subadress element */
op_star
id|p
op_increment
op_assign
l_int|0x1c
suffix:semicolon
multiline_comment|/* Facility info element */
op_star
id|p
op_increment
op_assign
id|len_phone
op_plus
id|len_sub
op_plus
l_int|2
op_plus
l_int|2
op_plus
l_int|8
op_plus
l_int|3
op_plus
l_int|3
suffix:semicolon
multiline_comment|/* length of element */
op_star
id|p
op_increment
op_assign
l_int|0x91
suffix:semicolon
multiline_comment|/* remote operations protocol */
op_star
id|p
op_increment
op_assign
l_int|0xa1
suffix:semicolon
multiline_comment|/* invoke component */
op_star
id|p
op_increment
op_assign
id|len_phone
op_plus
id|len_sub
op_plus
l_int|2
op_plus
l_int|2
op_plus
l_int|8
op_plus
l_int|3
suffix:semicolon
multiline_comment|/* length of data */
op_star
id|p
op_increment
op_assign
l_int|0x02
suffix:semicolon
multiline_comment|/* invoke id tag, integer */
op_star
id|p
op_increment
op_assign
l_int|0x01
suffix:semicolon
multiline_comment|/* length */
op_star
id|p
op_increment
op_assign
id|pc-&gt;prot.dss1.invoke_id
suffix:semicolon
multiline_comment|/* invoke id */
op_star
id|p
op_increment
op_assign
l_int|0x02
suffix:semicolon
multiline_comment|/* operation value tag, integer */
op_star
id|p
op_increment
op_assign
l_int|0x01
suffix:semicolon
multiline_comment|/* length */
op_star
id|p
op_increment
op_assign
l_int|0x0D
suffix:semicolon
multiline_comment|/* Call Deflect */
op_star
id|p
op_increment
op_assign
l_int|0x30
suffix:semicolon
multiline_comment|/* sequence phone number */
op_star
id|p
op_increment
op_assign
id|len_phone
op_plus
l_int|2
op_plus
l_int|2
op_plus
l_int|3
op_plus
id|len_sub
suffix:semicolon
multiline_comment|/* length */
op_star
id|p
op_increment
op_assign
l_int|0x30
suffix:semicolon
multiline_comment|/* Deflected to UserNumber */
op_star
id|p
op_increment
op_assign
id|len_phone
op_plus
l_int|2
op_plus
id|len_sub
suffix:semicolon
multiline_comment|/* length */
op_star
id|p
op_increment
op_assign
l_int|0x80
suffix:semicolon
multiline_comment|/* NumberDigits */
op_star
id|p
op_increment
op_assign
id|len_phone
suffix:semicolon
multiline_comment|/* length */
r_for
c_loop
(paren
id|l
op_assign
l_int|0
suffix:semicolon
id|l
OL
id|len_phone
suffix:semicolon
id|l
op_increment
)paren
op_star
id|p
op_increment
op_assign
id|pc-&gt;chan-&gt;setup.phone
(braket
id|l
)braket
suffix:semicolon
r_if
c_cond
(paren
id|len_sub
)paren
(brace
op_star
id|p
op_increment
op_assign
l_int|0x04
suffix:semicolon
multiline_comment|/* called party subadress */
op_star
id|p
op_increment
op_assign
id|len_sub
op_minus
l_int|2
suffix:semicolon
r_while
c_loop
(paren
op_star
id|subp
)paren
op_star
id|p
op_increment
op_assign
op_star
id|subp
op_increment
suffix:semicolon
)brace
op_star
id|p
op_increment
op_assign
l_int|0x01
suffix:semicolon
multiline_comment|/* screening identifier */
op_star
id|p
op_increment
op_assign
l_int|0x01
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|pc-&gt;chan-&gt;setup.screen
suffix:semicolon
id|l
op_assign
id|p
op_minus
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|l3_alloc_skb
c_func
(paren
id|l
)paren
)paren
)paren
r_return
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|l
)paren
comma
id|tmp
comma
id|l
)paren
suffix:semicolon
id|l3_msg
c_func
(paren
id|pc-&gt;st
comma
id|DL_DATA
op_or
id|REQUEST
comma
id|skb
)paren
suffix:semicolon
)brace
multiline_comment|/* l3dss1_redir_req */
multiline_comment|/********************************************/
multiline_comment|/* handle deflection request in early state */
multiline_comment|/********************************************/
DECL|function|l3dss1_redir_req_early
r_static
r_void
id|l3dss1_redir_req_early
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|l3dss1_proceed_req
c_func
(paren
id|pc
comma
id|pr
comma
id|arg
)paren
suffix:semicolon
id|l3dss1_redir_req
c_func
(paren
id|pc
comma
id|pr
comma
id|arg
)paren
suffix:semicolon
)brace
multiline_comment|/* l3dss1_redir_req_early */
multiline_comment|/***********************************************/
multiline_comment|/* handle special commands for this protocol.  */
multiline_comment|/* Examples are call independant services like */
multiline_comment|/* remote operations with dummy  callref.      */
multiline_comment|/***********************************************/
DECL|function|l3dss1_cmd_global
r_static
r_int
id|l3dss1_cmd_global
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
id|isdn_ctrl
op_star
id|ic
)paren
(brace
id|u_char
id|id
suffix:semicolon
id|u_char
id|temp
(braket
l_int|265
)braket
suffix:semicolon
id|u_char
op_star
id|p
op_assign
id|temp
suffix:semicolon
r_int
id|i
comma
id|l
comma
id|proc_len
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_struct
id|l3_process
op_star
id|pc
op_assign
l_int|NULL
suffix:semicolon
r_switch
c_cond
(paren
id|ic-&gt;arg
)paren
(brace
r_case
id|DSS1_CMD_INVOKE
suffix:colon
r_if
c_cond
(paren
id|ic-&gt;parm.dss1_io.datalen
OL
l_int|0
)paren
r_return
op_minus
l_int|2
suffix:semicolon
multiline_comment|/* invalid parameter */
r_for
c_loop
(paren
id|proc_len
op_assign
l_int|1
comma
id|i
op_assign
id|ic-&gt;parm.dss1_io.proc
op_rshift
l_int|8
suffix:semicolon
id|i
suffix:semicolon
id|i
op_increment
)paren
id|i
op_assign
id|i
op_rshift
l_int|8
suffix:semicolon
multiline_comment|/* add one byte */
id|l
op_assign
id|ic-&gt;parm.dss1_io.datalen
op_plus
id|proc_len
op_plus
l_int|8
suffix:semicolon
multiline_comment|/* length excluding ie header */
r_if
c_cond
(paren
id|l
OG
l_int|255
)paren
r_return
op_minus
l_int|2
suffix:semicolon
multiline_comment|/* too long */
r_if
c_cond
(paren
op_logical_neg
(paren
id|id
op_assign
id|new_invoke_id
c_func
(paren
id|st
)paren
)paren
)paren
r_return
l_int|0
suffix:semicolon
multiline_comment|/* first get a invoke id -&gt; return if no available */
id|i
op_assign
op_minus
l_int|1
suffix:semicolon
id|MsgHead
c_func
(paren
id|p
comma
id|i
comma
id|MT_FACILITY
)paren
suffix:semicolon
multiline_comment|/* build message head */
op_star
id|p
op_increment
op_assign
l_int|0x1C
suffix:semicolon
multiline_comment|/* Facility IE */
op_star
id|p
op_increment
op_assign
id|l
suffix:semicolon
multiline_comment|/* length of ie */
op_star
id|p
op_increment
op_assign
l_int|0x91
suffix:semicolon
multiline_comment|/* remote operations */
op_star
id|p
op_increment
op_assign
l_int|0xA1
suffix:semicolon
multiline_comment|/* invoke */
op_star
id|p
op_increment
op_assign
id|l
op_minus
l_int|3
suffix:semicolon
multiline_comment|/* length of invoke */
op_star
id|p
op_increment
op_assign
l_int|0x02
suffix:semicolon
multiline_comment|/* invoke id tag */
op_star
id|p
op_increment
op_assign
l_int|0x01
suffix:semicolon
multiline_comment|/* length is 1 */
op_star
id|p
op_increment
op_assign
id|id
suffix:semicolon
multiline_comment|/* invoke id */
op_star
id|p
op_increment
op_assign
l_int|0x02
suffix:semicolon
multiline_comment|/* operation */
op_star
id|p
op_increment
op_assign
id|proc_len
suffix:semicolon
multiline_comment|/* length of operation */
r_for
c_loop
(paren
id|i
op_assign
id|proc_len
suffix:semicolon
id|i
suffix:semicolon
id|i
op_decrement
)paren
op_star
id|p
op_increment
op_assign
(paren
id|ic-&gt;parm.dss1_io.proc
op_rshift
(paren
id|i
op_minus
l_int|1
)paren
)paren
op_amp
l_int|0xFF
suffix:semicolon
id|memcpy
c_func
(paren
id|p
comma
id|ic-&gt;parm.dss1_io.data
comma
id|ic-&gt;parm.dss1_io.datalen
)paren
suffix:semicolon
multiline_comment|/* copy data */
id|l
op_assign
(paren
id|p
op_minus
id|temp
)paren
op_plus
id|ic-&gt;parm.dss1_io.datalen
suffix:semicolon
multiline_comment|/* total length */
r_if
c_cond
(paren
id|ic-&gt;parm.dss1_io.timeout
OG
l_int|0
)paren
r_if
c_cond
(paren
op_logical_neg
(paren
id|pc
op_assign
id|dss1_new_l3_process
c_func
(paren
id|st
comma
op_minus
l_int|1
)paren
)paren
)paren
(brace
id|free_invoke_id
c_func
(paren
id|st
comma
id|id
)paren
suffix:semicolon
r_return
op_minus
l_int|2
suffix:semicolon
)brace
id|pc-&gt;prot.dss1.ll_id
op_assign
id|ic-&gt;parm.dss1_io.ll_id
suffix:semicolon
multiline_comment|/* remember id */
id|pc-&gt;prot.dss1.proc
op_assign
id|ic-&gt;parm.dss1_io.proc
suffix:semicolon
multiline_comment|/* and procedure */
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|l3_alloc_skb
c_func
(paren
id|l
)paren
)paren
)paren
(brace
id|free_invoke_id
c_func
(paren
id|st
comma
id|id
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pc
)paren
id|dss1_release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
r_return
op_minus
l_int|2
suffix:semicolon
)brace
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|l
)paren
comma
id|temp
comma
id|l
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pc
)paren
(brace
id|pc-&gt;prot.dss1.invoke_id
op_assign
id|id
suffix:semicolon
multiline_comment|/* remember id */
id|L3AddTimer
c_func
(paren
op_amp
id|pc-&gt;timer
comma
id|ic-&gt;parm.dss1_io.timeout
comma
id|CC_TDSS1_IO
op_or
id|REQUEST
)paren
suffix:semicolon
)brace
id|l3_msg
c_func
(paren
id|st
comma
id|DL_DATA
op_or
id|REQUEST
comma
id|skb
)paren
suffix:semicolon
id|ic-&gt;parm.dss1_io.hl_id
op_assign
id|id
suffix:semicolon
multiline_comment|/* return id */
r_return
l_int|0
suffix:semicolon
r_case
id|DSS1_CMD_INVOKE_ABORT
suffix:colon
r_if
c_cond
(paren
(paren
id|pc
op_assign
id|l3dss1_search_dummy_proc
c_func
(paren
id|st
comma
id|ic-&gt;parm.dss1_io.hl_id
)paren
)paren
)paren
(brace
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
multiline_comment|/* remove timer */
id|dss1_release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;l3dss1_cmd_global abort unknown id&quot;
)paren
suffix:semicolon
r_return
op_minus
l_int|2
suffix:semicolon
)brace
r_break
suffix:semicolon
r_default
suffix:colon
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;l3dss1_cmd_global unknown cmd 0x%lx&quot;
comma
id|ic-&gt;arg
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
multiline_comment|/* switch ic-&gt; arg */
r_return
op_minus
l_int|1
suffix:semicolon
)brace
multiline_comment|/* l3dss1_cmd_global */
r_static
r_void
DECL|function|l3dss1_io_timer
id|l3dss1_io_timer
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
)paren
(brace
id|isdn_ctrl
id|ic
suffix:semicolon
r_struct
id|IsdnCardState
op_star
id|cs
op_assign
id|pc-&gt;st-&gt;l1.hardware
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
multiline_comment|/* remove timer */
id|ic.driver
op_assign
id|cs-&gt;myid
suffix:semicolon
id|ic.command
op_assign
id|ISDN_STAT_PROT
suffix:semicolon
id|ic.arg
op_assign
id|DSS1_STAT_INVOKE_ERR
suffix:semicolon
id|ic.parm.dss1_io.hl_id
op_assign
id|pc-&gt;prot.dss1.invoke_id
suffix:semicolon
id|ic.parm.dss1_io.ll_id
op_assign
id|pc-&gt;prot.dss1.ll_id
suffix:semicolon
id|ic.parm.dss1_io.proc
op_assign
id|pc-&gt;prot.dss1.proc
suffix:semicolon
id|ic.parm.dss1_io.timeout
op_assign
op_minus
l_int|1
suffix:semicolon
id|ic.parm.dss1_io.datalen
op_assign
l_int|0
suffix:semicolon
id|ic.parm.dss1_io.data
op_assign
l_int|NULL
suffix:semicolon
id|free_invoke_id
c_func
(paren
id|pc-&gt;st
comma
id|pc-&gt;prot.dss1.invoke_id
)paren
suffix:semicolon
id|pc-&gt;prot.dss1.invoke_id
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* reset id */
id|cs-&gt;iif
dot
id|statcallb
c_func
(paren
op_amp
id|ic
)paren
suffix:semicolon
id|dss1_release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
)brace
multiline_comment|/* l3dss1_io_timer */
r_static
r_void
DECL|function|l3dss1_release_ind
id|l3dss1_release_ind
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|u_char
op_star
id|p
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_int
id|callState
op_assign
l_int|0
suffix:semicolon
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
id|IE_CALL_STATE
comma
l_int|0
)paren
)paren
)paren
(brace
id|p
op_increment
suffix:semicolon
r_if
c_cond
(paren
l_int|1
op_eq
op_star
id|p
op_increment
)paren
id|callState
op_assign
op_star
id|p
suffix:semicolon
)brace
r_if
c_cond
(paren
id|callState
op_eq
l_int|0
)paren
(brace
multiline_comment|/* ETS 300-104 7.6.1, 8.6.1, 10.6.1... and 16.1&n;&t;&t; * set down layer 3 without sending any message&n;&t;&t; */
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc-&gt;st
comma
id|CC_RELEASE
op_or
id|INDICATION
comma
id|pc
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|0
)paren
suffix:semicolon
id|dss1_release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
)brace
r_else
(brace
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc-&gt;st
comma
id|CC_IGNORE
op_or
id|INDICATION
comma
id|pc
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|l3dss1_dummy
id|l3dss1_dummy
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
)brace
r_static
r_void
DECL|function|l3dss1_t302
id|l3dss1_t302
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|pc-&gt;para.loc
op_assign
l_int|0
suffix:semicolon
id|pc-&gt;para.cause
op_assign
l_int|28
suffix:semicolon
multiline_comment|/* invalid number */
id|l3dss1_disconnect_req
c_func
(paren
id|pc
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc-&gt;st
comma
id|CC_SETUP_ERR
comma
id|pc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_t303
id|l3dss1_t303
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_if
c_cond
(paren
id|pc-&gt;N303
OG
l_int|0
)paren
(brace
id|pc-&gt;N303
op_decrement
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|l3dss1_setup_req
c_func
(paren
id|pc
comma
id|pr
comma
id|arg
)paren
suffix:semicolon
)brace
r_else
(brace
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|l3dss1_message_cause
c_func
(paren
id|pc
comma
id|MT_RELEASE_COMPLETE
comma
l_int|102
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc-&gt;st
comma
id|CC_NOSETUP_RSP
comma
id|pc
)paren
suffix:semicolon
id|dss1_release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|l3dss1_t304
id|l3dss1_t304
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|pc-&gt;para.loc
op_assign
l_int|0
suffix:semicolon
id|pc-&gt;para.cause
op_assign
l_int|102
suffix:semicolon
id|l3dss1_disconnect_req
c_func
(paren
id|pc
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc-&gt;st
comma
id|CC_SETUP_ERR
comma
id|pc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_t305
id|l3dss1_t305
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|u_char
id|tmp
(braket
l_int|16
)braket
suffix:semicolon
id|u_char
op_star
id|p
op_assign
id|tmp
suffix:semicolon
r_int
id|l
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|u_char
id|cause
op_assign
l_int|16
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pc-&gt;para.cause
op_ne
id|NO_CAUSE
)paren
id|cause
op_assign
id|pc-&gt;para.cause
suffix:semicolon
id|MsgHead
c_func
(paren
id|p
comma
id|pc-&gt;callref
comma
id|MT_RELEASE
)paren
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|IE_CAUSE
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x2
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x80
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|cause
op_or
l_int|0x80
suffix:semicolon
id|l
op_assign
id|p
op_minus
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|l3_alloc_skb
c_func
(paren
id|l
)paren
)paren
)paren
r_return
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|l
)paren
comma
id|tmp
comma
id|l
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|19
)paren
suffix:semicolon
id|l3_msg
c_func
(paren
id|pc-&gt;st
comma
id|DL_DATA
op_or
id|REQUEST
comma
id|skb
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|pc-&gt;timer
comma
id|T308
comma
id|CC_T308_1
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_t310
id|l3dss1_t310
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|pc-&gt;para.loc
op_assign
l_int|0
suffix:semicolon
id|pc-&gt;para.cause
op_assign
l_int|102
suffix:semicolon
id|l3dss1_disconnect_req
c_func
(paren
id|pc
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc-&gt;st
comma
id|CC_SETUP_ERR
comma
id|pc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_t313
id|l3dss1_t313
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|pc-&gt;para.loc
op_assign
l_int|0
suffix:semicolon
id|pc-&gt;para.cause
op_assign
l_int|102
suffix:semicolon
id|l3dss1_disconnect_req
c_func
(paren
id|pc
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc-&gt;st
comma
id|CC_CONNECT_ERR
comma
id|pc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_t308_1
id|l3dss1_t308_1
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|newl3state
c_func
(paren
id|pc
comma
l_int|19
)paren
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|l3dss1_message
c_func
(paren
id|pc
comma
id|MT_RELEASE
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|pc-&gt;timer
comma
id|T308
comma
id|CC_T308_2
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_t308_2
id|l3dss1_t308_2
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc-&gt;st
comma
id|CC_RELEASE_ERR
comma
id|pc
)paren
suffix:semicolon
id|dss1_release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_t318
id|l3dss1_t318
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|pc-&gt;para.cause
op_assign
l_int|102
suffix:semicolon
multiline_comment|/* Timer expiry */
id|pc-&gt;para.loc
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* local */
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc-&gt;st
comma
id|CC_RESUME_ERR
comma
id|pc
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|19
)paren
suffix:semicolon
id|l3dss1_message
c_func
(paren
id|pc
comma
id|MT_RELEASE
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|pc-&gt;timer
comma
id|T308
comma
id|CC_T308_1
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_t319
id|l3dss1_t319
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|pc-&gt;para.cause
op_assign
l_int|102
suffix:semicolon
multiline_comment|/* Timer expiry */
id|pc-&gt;para.loc
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* local */
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc-&gt;st
comma
id|CC_SUSPEND_ERR
comma
id|pc
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|10
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_restart
id|l3dss1_restart
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc-&gt;st
comma
id|CC_RELEASE
op_or
id|INDICATION
comma
id|pc
)paren
suffix:semicolon
id|dss1_release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_status
id|l3dss1_status
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|u_char
op_star
id|p
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_int
id|ret
suffix:semicolon
id|u_char
id|cause
op_assign
l_int|0
comma
id|callState
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ret
op_assign
id|l3dss1_get_cause
c_func
(paren
id|pc
comma
id|skb
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;STATUS get_cause ret(%d)&quot;
comma
id|ret
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
OL
l_int|0
)paren
id|cause
op_assign
l_int|96
suffix:semicolon
r_else
r_if
c_cond
(paren
id|ret
OG
l_int|0
)paren
id|cause
op_assign
l_int|100
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|skb-&gt;data
comma
id|skb-&gt;len
comma
id|IE_CALL_STATE
comma
l_int|0
)paren
)paren
)paren
(brace
id|p
op_increment
suffix:semicolon
r_if
c_cond
(paren
l_int|1
op_eq
op_star
id|p
op_increment
)paren
(brace
id|callState
op_assign
op_star
id|p
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ie_in_set
c_func
(paren
id|pc
comma
op_star
id|p
comma
id|l3_valid_states
)paren
)paren
id|cause
op_assign
l_int|100
suffix:semicolon
)brace
r_else
id|cause
op_assign
l_int|100
suffix:semicolon
)brace
r_else
id|cause
op_assign
l_int|96
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|cause
)paren
(brace
multiline_comment|/*  no error before */
id|ret
op_assign
id|check_infoelements
c_func
(paren
id|pc
comma
id|skb
comma
id|ie_STATUS
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ERR_IE_COMPREHENSION
op_eq
id|ret
)paren
id|cause
op_assign
l_int|96
suffix:semicolon
r_else
r_if
c_cond
(paren
id|ERR_IE_UNRECOGNIZED
op_eq
id|ret
)paren
id|cause
op_assign
l_int|99
suffix:semicolon
)brace
r_if
c_cond
(paren
id|cause
)paren
(brace
id|u_char
id|tmp
suffix:semicolon
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;STATUS error(%d/%d)&quot;
comma
id|ret
comma
id|cause
)paren
suffix:semicolon
id|tmp
op_assign
id|pc-&gt;para.cause
suffix:semicolon
id|pc-&gt;para.cause
op_assign
id|cause
suffix:semicolon
id|l3dss1_status_send
c_func
(paren
id|pc
comma
l_int|0
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|cause
op_eq
l_int|99
)paren
id|pc-&gt;para.cause
op_assign
id|tmp
suffix:semicolon
r_else
r_return
suffix:semicolon
)brace
id|cause
op_assign
id|pc-&gt;para.cause
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
id|cause
op_amp
l_int|0x7f
)paren
op_eq
l_int|111
)paren
op_logical_and
(paren
id|callState
op_eq
l_int|0
)paren
)paren
(brace
multiline_comment|/* ETS 300-104 7.6.1, 8.6.1, 10.6.1...&n;&t;&t; * if received MT_STATUS with cause == 111 and call&n;&t;&t; * state == 0, then we must set down layer 3&n;&t;&t; */
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc-&gt;st
comma
id|CC_RELEASE
op_or
id|INDICATION
comma
id|pc
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|0
)paren
suffix:semicolon
id|dss1_release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|l3dss1_facility
id|l3dss1_facility
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_int
id|ret
suffix:semicolon
id|ret
op_assign
id|check_infoelements
c_func
(paren
id|pc
comma
id|skb
comma
id|ie_FACILITY
)paren
suffix:semicolon
id|l3dss1_std_ie_err
c_func
(paren
id|pc
comma
id|ret
)paren
suffix:semicolon
(brace
id|u_char
op_star
id|p
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|skb-&gt;data
comma
id|skb-&gt;len
comma
id|IE_FACILITY
comma
l_int|0
)paren
)paren
)paren
id|l3dss1_parse_facility
c_func
(paren
id|pc-&gt;st
comma
id|pc
comma
id|pc-&gt;callref
comma
id|p
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|l3dss1_suspend_req
id|l3dss1_suspend_req
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|u_char
id|tmp
(braket
l_int|32
)braket
suffix:semicolon
id|u_char
op_star
id|p
op_assign
id|tmp
suffix:semicolon
id|u_char
id|i
comma
id|l
suffix:semicolon
id|u_char
op_star
id|msg
op_assign
id|pc-&gt;chan-&gt;setup.phone
suffix:semicolon
id|MsgHead
c_func
(paren
id|p
comma
id|pc-&gt;callref
comma
id|MT_SUSPEND
)paren
suffix:semicolon
id|l
op_assign
op_star
id|msg
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|l
op_logical_and
(paren
id|l
op_le
l_int|10
)paren
)paren
(brace
multiline_comment|/* Max length 10 octets */
op_star
id|p
op_increment
op_assign
id|IE_CALL_ID
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|l
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|l
suffix:semicolon
id|i
op_increment
)paren
op_star
id|p
op_increment
op_assign
op_star
id|msg
op_increment
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|l
)paren
(brace
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;SUS wrong CALL_ID len %d&quot;
comma
id|l
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|l
op_assign
id|p
op_minus
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|l3_alloc_skb
c_func
(paren
id|l
)paren
)paren
)paren
r_return
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|l
)paren
comma
id|tmp
comma
id|l
)paren
suffix:semicolon
id|l3_msg
c_func
(paren
id|pc-&gt;st
comma
id|DL_DATA
op_or
id|REQUEST
comma
id|skb
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|15
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|pc-&gt;timer
comma
id|T319
comma
id|CC_T319
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_suspend_ack
id|l3dss1_suspend_ack
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_int
id|ret
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|0
)paren
suffix:semicolon
id|pc-&gt;para.cause
op_assign
id|NO_CAUSE
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc-&gt;st
comma
id|CC_SUSPEND
op_or
id|CONFIRM
comma
id|pc
)paren
suffix:semicolon
multiline_comment|/* We don&squot;t handle suspend_ack for IE errors now */
r_if
c_cond
(paren
(paren
id|ret
op_assign
id|check_infoelements
c_func
(paren
id|pc
comma
id|skb
comma
id|ie_SUSPEND_ACKNOWLEDGE
)paren
)paren
)paren
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;SUSPACK check ie(%d)&quot;
comma
id|ret
)paren
suffix:semicolon
id|dss1_release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_suspend_rej
id|l3dss1_suspend_rej
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_int
id|ret
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ret
op_assign
id|l3dss1_get_cause
c_func
(paren
id|pc
comma
id|skb
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;SUSP_REJ get_cause ret(%d)&quot;
comma
id|ret
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
OL
l_int|0
)paren
id|pc-&gt;para.cause
op_assign
l_int|96
suffix:semicolon
r_else
id|pc-&gt;para.cause
op_assign
l_int|100
suffix:semicolon
id|l3dss1_status_send
c_func
(paren
id|pc
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|ret
op_assign
id|check_infoelements
c_func
(paren
id|pc
comma
id|skb
comma
id|ie_SUSPEND_REJECT
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ERR_IE_COMPREHENSION
op_eq
id|ret
)paren
(brace
id|l3dss1_std_ie_err
c_func
(paren
id|pc
comma
id|ret
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc-&gt;st
comma
id|CC_SUSPEND_ERR
comma
id|pc
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|10
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
multiline_comment|/* STATUS for none mandatory IE errors after actions are taken */
id|l3dss1_std_ie_err
c_func
(paren
id|pc
comma
id|ret
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_resume_req
id|l3dss1_resume_req
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|u_char
id|tmp
(braket
l_int|32
)braket
suffix:semicolon
id|u_char
op_star
id|p
op_assign
id|tmp
suffix:semicolon
id|u_char
id|i
comma
id|l
suffix:semicolon
id|u_char
op_star
id|msg
op_assign
id|pc-&gt;para.setup.phone
suffix:semicolon
id|MsgHead
c_func
(paren
id|p
comma
id|pc-&gt;callref
comma
id|MT_RESUME
)paren
suffix:semicolon
id|l
op_assign
op_star
id|msg
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|l
op_logical_and
(paren
id|l
op_le
l_int|10
)paren
)paren
(brace
multiline_comment|/* Max length 10 octets */
op_star
id|p
op_increment
op_assign
id|IE_CALL_ID
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|l
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|l
suffix:semicolon
id|i
op_increment
)paren
op_star
id|p
op_increment
op_assign
op_star
id|msg
op_increment
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|l
)paren
(brace
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;RES wrong CALL_ID len %d&quot;
comma
id|l
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|l
op_assign
id|p
op_minus
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|l3_alloc_skb
c_func
(paren
id|l
)paren
)paren
)paren
r_return
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|l
)paren
comma
id|tmp
comma
id|l
)paren
suffix:semicolon
id|l3_msg
c_func
(paren
id|pc-&gt;st
comma
id|DL_DATA
op_or
id|REQUEST
comma
id|skb
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|17
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|pc-&gt;timer
comma
id|T318
comma
id|CC_T318
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_resume_ack
id|l3dss1_resume_ack
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_int
id|id
comma
id|ret
suffix:semicolon
r_if
c_cond
(paren
(paren
id|id
op_assign
id|l3dss1_get_channel_id
c_func
(paren
id|pc
comma
id|skb
)paren
)paren
OG
l_int|0
)paren
(brace
r_if
c_cond
(paren
(paren
l_int|0
op_eq
id|id
)paren
op_logical_or
(paren
(paren
l_int|3
op_eq
id|id
)paren
op_logical_and
(paren
l_int|0x10
op_eq
id|pc-&gt;para.moderate
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;resume ack with wrong chid %x&quot;
comma
id|id
)paren
suffix:semicolon
id|pc-&gt;para.cause
op_assign
l_int|100
suffix:semicolon
id|l3dss1_status_send
c_func
(paren
id|pc
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|pc-&gt;para.bchannel
op_assign
id|id
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
l_int|1
op_eq
id|pc-&gt;state
)paren
(brace
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;resume ack without chid (ret %d)&quot;
comma
id|id
)paren
suffix:semicolon
id|pc-&gt;para.cause
op_assign
l_int|96
suffix:semicolon
id|l3dss1_status_send
c_func
(paren
id|pc
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|ret
op_assign
id|check_infoelements
c_func
(paren
id|pc
comma
id|skb
comma
id|ie_RESUME_ACKNOWLEDGE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ERR_IE_COMPREHENSION
op_eq
id|ret
)paren
(brace
id|l3dss1_std_ie_err
c_func
(paren
id|pc
comma
id|ret
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc-&gt;st
comma
id|CC_RESUME
op_or
id|CONFIRM
comma
id|pc
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|10
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
multiline_comment|/* STATUS for none mandatory IE errors after actions are taken */
id|l3dss1_std_ie_err
c_func
(paren
id|pc
comma
id|ret
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_resume_rej
id|l3dss1_resume_rej
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_int
id|ret
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ret
op_assign
id|l3dss1_get_cause
c_func
(paren
id|pc
comma
id|skb
)paren
)paren
)paren
(brace
r_if
c_cond
(paren
id|pc-&gt;debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;RES_REJ get_cause ret(%d)&quot;
comma
id|ret
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
OL
l_int|0
)paren
id|pc-&gt;para.cause
op_assign
l_int|96
suffix:semicolon
r_else
id|pc-&gt;para.cause
op_assign
l_int|100
suffix:semicolon
id|l3dss1_status_send
c_func
(paren
id|pc
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|ret
op_assign
id|check_infoelements
c_func
(paren
id|pc
comma
id|skb
comma
id|ie_RESUME_REJECT
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ERR_IE_COMPREHENSION
op_eq
id|ret
)paren
(brace
id|l3dss1_std_ie_err
c_func
(paren
id|pc
comma
id|ret
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc-&gt;st
comma
id|CC_RESUME_ERR
comma
id|pc
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
multiline_comment|/* STATUS for none mandatory IE errors after actions are taken */
id|l3dss1_std_ie_err
c_func
(paren
id|pc
comma
id|ret
)paren
suffix:semicolon
id|dss1_release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_global_restart
id|l3dss1_global_restart
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|u_char
id|tmp
(braket
l_int|32
)braket
suffix:semicolon
id|u_char
op_star
id|p
suffix:semicolon
id|u_char
id|ri
comma
id|ch
op_assign
l_int|0
comma
id|chan
op_assign
l_int|0
suffix:semicolon
r_int
id|l
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_struct
id|l3_process
op_star
id|up
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|2
)paren
suffix:semicolon
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
id|IE_RESTART_IND
comma
l_int|0
)paren
)paren
)paren
(brace
id|ri
op_assign
id|p
(braket
l_int|2
)braket
suffix:semicolon
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;Restart %x&quot;
comma
id|ri
)paren
suffix:semicolon
)brace
r_else
(brace
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;Restart without restart IE&quot;
)paren
suffix:semicolon
id|ri
op_assign
l_int|0x86
suffix:semicolon
)brace
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|p
comma
id|skb-&gt;len
comma
id|IE_CHANNEL_ID
comma
l_int|0
)paren
)paren
)paren
(brace
id|chan
op_assign
id|p
(braket
l_int|2
)braket
op_amp
l_int|3
suffix:semicolon
id|ch
op_assign
id|p
(braket
l_int|2
)braket
suffix:semicolon
r_if
c_cond
(paren
id|pc-&gt;st-&gt;l3.debug
)paren
id|l3_debug
c_func
(paren
id|pc-&gt;st
comma
l_string|&quot;Restart for channel %d&quot;
comma
id|chan
)paren
suffix:semicolon
)brace
id|newl3state
c_func
(paren
id|pc
comma
l_int|2
)paren
suffix:semicolon
id|up
op_assign
id|pc-&gt;st-&gt;l3.proc
suffix:semicolon
r_while
c_loop
(paren
id|up
)paren
(brace
r_if
c_cond
(paren
(paren
id|ri
op_amp
l_int|7
)paren
op_eq
l_int|7
)paren
id|up-&gt;st-&gt;lli
dot
id|l4l3
c_func
(paren
id|up-&gt;st
comma
id|CC_RESTART
op_or
id|REQUEST
comma
id|up
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|up-&gt;para.bchannel
op_eq
id|chan
)paren
id|up-&gt;st-&gt;lli
dot
id|l4l3
c_func
(paren
id|up-&gt;st
comma
id|CC_RESTART
op_or
id|REQUEST
comma
id|up
)paren
suffix:semicolon
id|up
op_assign
id|up-&gt;next
suffix:semicolon
)brace
id|p
op_assign
id|tmp
suffix:semicolon
id|MsgHead
c_func
(paren
id|p
comma
id|pc-&gt;callref
comma
id|MT_RESTART_ACKNOWLEDGE
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chan
)paren
(brace
op_star
id|p
op_increment
op_assign
id|IE_CHANNEL_ID
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|1
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|ch
op_or
l_int|0x80
suffix:semicolon
)brace
op_star
id|p
op_increment
op_assign
l_int|0x79
suffix:semicolon
multiline_comment|/* RESTART Ind */
op_star
id|p
op_increment
op_assign
l_int|1
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|ri
suffix:semicolon
id|l
op_assign
id|p
op_minus
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|l3_alloc_skb
c_func
(paren
id|l
)paren
)paren
)paren
r_return
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|l
)paren
comma
id|tmp
comma
id|l
)paren
suffix:semicolon
id|newl3state
c_func
(paren
id|pc
comma
l_int|0
)paren
suffix:semicolon
id|l3_msg
c_func
(paren
id|pc-&gt;st
comma
id|DL_DATA
op_or
id|REQUEST
comma
id|skb
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_dl_reset
id|l3dss1_dl_reset
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|pc-&gt;para.cause
op_assign
l_int|0x29
suffix:semicolon
multiline_comment|/* Temporary failure */
id|pc-&gt;para.loc
op_assign
l_int|0
suffix:semicolon
id|l3dss1_disconnect_req
c_func
(paren
id|pc
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc-&gt;st
comma
id|CC_SETUP_ERR
comma
id|pc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_dl_release
id|l3dss1_dl_release
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|newl3state
c_func
(paren
id|pc
comma
l_int|0
)paren
suffix:semicolon
id|pc-&gt;para.cause
op_assign
l_int|0x1b
suffix:semicolon
multiline_comment|/* Destination out of order */
id|pc-&gt;para.loc
op_assign
l_int|0
suffix:semicolon
id|pc-&gt;st-&gt;l3
dot
id|l3l4
c_func
(paren
id|pc-&gt;st
comma
id|CC_RELEASE
op_or
id|INDICATION
comma
id|pc
)paren
suffix:semicolon
id|release_l3_process
c_func
(paren
id|pc
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_dl_reestablish
id|l3dss1_dl_reestablish
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|L3AddTimer
c_func
(paren
op_amp
id|pc-&gt;timer
comma
id|T309
comma
id|CC_T309
)paren
suffix:semicolon
id|l3_msg
c_func
(paren
id|pc-&gt;st
comma
id|DL_ESTABLISH
op_or
id|REQUEST
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|l3dss1_dl_reest_status
id|l3dss1_dl_reest_status
c_func
(paren
r_struct
id|l3_process
op_star
id|pc
comma
id|u_char
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
id|L3DelTimer
c_func
(paren
op_amp
id|pc-&gt;timer
)paren
suffix:semicolon
id|pc-&gt;para.cause
op_assign
l_int|0x1F
suffix:semicolon
multiline_comment|/* normal, unspecified */
id|l3dss1_status_send
c_func
(paren
id|pc
comma
l_int|0
comma
l_int|NULL
)paren
suffix:semicolon
)brace
multiline_comment|/* *INDENT-OFF* */
DECL|variable|downstatelist
r_static
r_struct
id|stateentry
id|downstatelist
(braket
)braket
op_assign
(brace
(brace
id|SBIT
c_func
(paren
l_int|0
)paren
comma
id|CC_SETUP
op_or
id|REQUEST
comma
id|l3dss1_setup_req
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|0
)paren
comma
id|CC_RESUME
op_or
id|REQUEST
comma
id|l3dss1_resume_req
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|1
)paren
op_or
id|SBIT
c_func
(paren
l_int|2
)paren
op_or
id|SBIT
c_func
(paren
l_int|3
)paren
op_or
id|SBIT
c_func
(paren
l_int|4
)paren
op_or
id|SBIT
c_func
(paren
l_int|6
)paren
op_or
id|SBIT
c_func
(paren
l_int|7
)paren
op_or
id|SBIT
c_func
(paren
l_int|8
)paren
op_or
id|SBIT
c_func
(paren
l_int|9
)paren
op_or
id|SBIT
c_func
(paren
l_int|10
)paren
op_or
id|SBIT
c_func
(paren
l_int|25
)paren
comma
id|CC_DISCONNECT
op_or
id|REQUEST
comma
id|l3dss1_disconnect_req
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|12
)paren
comma
id|CC_RELEASE
op_or
id|REQUEST
comma
id|l3dss1_release_req
)brace
comma
(brace
id|ALL_STATES
comma
id|CC_RESTART
op_or
id|REQUEST
comma
id|l3dss1_restart
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|6
)paren
op_or
id|SBIT
c_func
(paren
l_int|25
)paren
comma
id|CC_IGNORE
op_or
id|REQUEST
comma
id|l3dss1_reset
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|6
)paren
op_or
id|SBIT
c_func
(paren
l_int|25
)paren
comma
id|CC_REJECT
op_or
id|REQUEST
comma
id|l3dss1_reject_req
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|6
)paren
op_or
id|SBIT
c_func
(paren
l_int|25
)paren
comma
id|CC_PROCEED_SEND
op_or
id|REQUEST
comma
id|l3dss1_proceed_req
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|6
)paren
comma
id|CC_MORE_INFO
op_or
id|REQUEST
comma
id|l3dss1_setup_ack_req
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|25
)paren
comma
id|CC_MORE_INFO
op_or
id|REQUEST
comma
id|l3dss1_dummy
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|6
)paren
op_or
id|SBIT
c_func
(paren
l_int|9
)paren
op_or
id|SBIT
c_func
(paren
l_int|25
)paren
comma
id|CC_ALERTING
op_or
id|REQUEST
comma
id|l3dss1_alert_req
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|6
)paren
op_or
id|SBIT
c_func
(paren
l_int|7
)paren
op_or
id|SBIT
c_func
(paren
l_int|9
)paren
op_or
id|SBIT
c_func
(paren
l_int|25
)paren
comma
id|CC_SETUP
op_or
id|RESPONSE
comma
id|l3dss1_setup_rsp
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|10
)paren
comma
id|CC_SUSPEND
op_or
id|REQUEST
comma
id|l3dss1_suspend_req
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|7
)paren
op_or
id|SBIT
c_func
(paren
l_int|9
)paren
op_or
id|SBIT
c_func
(paren
l_int|25
)paren
comma
id|CC_REDIR
op_or
id|REQUEST
comma
id|l3dss1_redir_req
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|6
)paren
comma
id|CC_REDIR
op_or
id|REQUEST
comma
id|l3dss1_redir_req_early
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|9
)paren
op_or
id|SBIT
c_func
(paren
l_int|25
)paren
comma
id|CC_DISCONNECT
op_or
id|REQUEST
comma
id|l3dss1_disconnect_req
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|25
)paren
comma
id|CC_T302
comma
id|l3dss1_t302
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|1
)paren
comma
id|CC_T303
comma
id|l3dss1_t303
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|2
)paren
comma
id|CC_T304
comma
id|l3dss1_t304
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|3
)paren
comma
id|CC_T310
comma
id|l3dss1_t310
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|8
)paren
comma
id|CC_T313
comma
id|l3dss1_t313
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|11
)paren
comma
id|CC_T305
comma
id|l3dss1_t305
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|15
)paren
comma
id|CC_T319
comma
id|l3dss1_t319
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|17
)paren
comma
id|CC_T318
comma
id|l3dss1_t318
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|19
)paren
comma
id|CC_T308_1
comma
id|l3dss1_t308_1
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|19
)paren
comma
id|CC_T308_2
comma
id|l3dss1_t308_2
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|10
)paren
comma
id|CC_T309
comma
id|l3dss1_dl_release
)brace
comma
)brace
suffix:semicolon
DECL|macro|DOWNSLLEN
mdefine_line|#define DOWNSLLEN &bslash;&n;&t;(sizeof(downstatelist) / sizeof(struct stateentry))
DECL|variable|datastatelist
r_static
r_struct
id|stateentry
id|datastatelist
(braket
)braket
op_assign
(brace
(brace
id|ALL_STATES
comma
id|MT_STATUS_ENQUIRY
comma
id|l3dss1_status_enq
)brace
comma
(brace
id|ALL_STATES
comma
id|MT_FACILITY
comma
id|l3dss1_facility
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|19
)paren
comma
id|MT_STATUS
comma
id|l3dss1_release_ind
)brace
comma
(brace
id|ALL_STATES
comma
id|MT_STATUS
comma
id|l3dss1_status
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|0
)paren
comma
id|MT_SETUP
comma
id|l3dss1_setup
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|6
)paren
op_or
id|SBIT
c_func
(paren
l_int|7
)paren
op_or
id|SBIT
c_func
(paren
l_int|8
)paren
op_or
id|SBIT
c_func
(paren
l_int|9
)paren
op_or
id|SBIT
c_func
(paren
l_int|10
)paren
op_or
id|SBIT
c_func
(paren
l_int|11
)paren
op_or
id|SBIT
c_func
(paren
l_int|12
)paren
op_or
id|SBIT
c_func
(paren
l_int|15
)paren
op_or
id|SBIT
c_func
(paren
l_int|17
)paren
op_or
id|SBIT
c_func
(paren
l_int|19
)paren
op_or
id|SBIT
c_func
(paren
l_int|25
)paren
comma
id|MT_SETUP
comma
id|l3dss1_dummy
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|1
)paren
op_or
id|SBIT
c_func
(paren
l_int|2
)paren
comma
id|MT_CALL_PROCEEDING
comma
id|l3dss1_call_proc
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|1
)paren
comma
id|MT_SETUP_ACKNOWLEDGE
comma
id|l3dss1_setup_ack
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|2
)paren
op_or
id|SBIT
c_func
(paren
l_int|3
)paren
comma
id|MT_ALERTING
comma
id|l3dss1_alerting
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|2
)paren
op_or
id|SBIT
c_func
(paren
l_int|3
)paren
comma
id|MT_PROGRESS
comma
id|l3dss1_progress
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|2
)paren
op_or
id|SBIT
c_func
(paren
l_int|3
)paren
op_or
id|SBIT
c_func
(paren
l_int|4
)paren
op_or
id|SBIT
c_func
(paren
l_int|7
)paren
op_or
id|SBIT
c_func
(paren
l_int|8
)paren
op_or
id|SBIT
c_func
(paren
l_int|9
)paren
op_or
id|SBIT
c_func
(paren
l_int|10
)paren
op_or
id|SBIT
c_func
(paren
l_int|11
)paren
op_or
id|SBIT
c_func
(paren
l_int|12
)paren
op_or
id|SBIT
c_func
(paren
l_int|15
)paren
op_or
id|SBIT
c_func
(paren
l_int|17
)paren
op_or
id|SBIT
c_func
(paren
l_int|19
)paren
op_or
id|SBIT
c_func
(paren
l_int|25
)paren
comma
id|MT_INFORMATION
comma
id|l3dss1_information
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|10
)paren
op_or
id|SBIT
c_func
(paren
l_int|11
)paren
op_or
id|SBIT
c_func
(paren
l_int|15
)paren
comma
id|MT_NOTIFY
comma
id|l3dss1_notify
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|0
)paren
op_or
id|SBIT
c_func
(paren
l_int|1
)paren
op_or
id|SBIT
c_func
(paren
l_int|2
)paren
op_or
id|SBIT
c_func
(paren
l_int|3
)paren
op_or
id|SBIT
c_func
(paren
l_int|4
)paren
op_or
id|SBIT
c_func
(paren
l_int|7
)paren
op_or
id|SBIT
c_func
(paren
l_int|8
)paren
op_or
id|SBIT
c_func
(paren
l_int|10
)paren
op_or
id|SBIT
c_func
(paren
l_int|11
)paren
op_or
id|SBIT
c_func
(paren
l_int|12
)paren
op_or
id|SBIT
c_func
(paren
l_int|15
)paren
op_or
id|SBIT
c_func
(paren
l_int|17
)paren
op_or
id|SBIT
c_func
(paren
l_int|19
)paren
op_or
id|SBIT
c_func
(paren
l_int|25
)paren
comma
id|MT_RELEASE_COMPLETE
comma
id|l3dss1_release_cmpl
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|1
)paren
op_or
id|SBIT
c_func
(paren
l_int|2
)paren
op_or
id|SBIT
c_func
(paren
l_int|3
)paren
op_or
id|SBIT
c_func
(paren
l_int|4
)paren
op_or
id|SBIT
c_func
(paren
l_int|7
)paren
op_or
id|SBIT
c_func
(paren
l_int|8
)paren
op_or
id|SBIT
c_func
(paren
l_int|9
)paren
op_or
id|SBIT
c_func
(paren
l_int|10
)paren
op_or
id|SBIT
c_func
(paren
l_int|11
)paren
op_or
id|SBIT
c_func
(paren
l_int|12
)paren
op_or
id|SBIT
c_func
(paren
l_int|15
)paren
op_or
id|SBIT
c_func
(paren
l_int|17
)paren
op_or
id|SBIT
c_func
(paren
l_int|25
)paren
comma
id|MT_RELEASE
comma
id|l3dss1_release
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|19
)paren
comma
id|MT_RELEASE
comma
id|l3dss1_release_ind
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|1
)paren
op_or
id|SBIT
c_func
(paren
l_int|2
)paren
op_or
id|SBIT
c_func
(paren
l_int|3
)paren
op_or
id|SBIT
c_func
(paren
l_int|4
)paren
op_or
id|SBIT
c_func
(paren
l_int|7
)paren
op_or
id|SBIT
c_func
(paren
l_int|8
)paren
op_or
id|SBIT
c_func
(paren
l_int|9
)paren
op_or
id|SBIT
c_func
(paren
l_int|10
)paren
op_or
id|SBIT
c_func
(paren
l_int|11
)paren
op_or
id|SBIT
c_func
(paren
l_int|15
)paren
op_or
id|SBIT
c_func
(paren
l_int|17
)paren
op_or
id|SBIT
c_func
(paren
l_int|25
)paren
comma
id|MT_DISCONNECT
comma
id|l3dss1_disconnect
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|19
)paren
comma
id|MT_DISCONNECT
comma
id|l3dss1_dummy
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|1
)paren
op_or
id|SBIT
c_func
(paren
l_int|2
)paren
op_or
id|SBIT
c_func
(paren
l_int|3
)paren
op_or
id|SBIT
c_func
(paren
l_int|4
)paren
comma
id|MT_CONNECT
comma
id|l3dss1_connect
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|8
)paren
comma
id|MT_CONNECT_ACKNOWLEDGE
comma
id|l3dss1_connect_ack
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|15
)paren
comma
id|MT_SUSPEND_ACKNOWLEDGE
comma
id|l3dss1_suspend_ack
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|15
)paren
comma
id|MT_SUSPEND_REJECT
comma
id|l3dss1_suspend_rej
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|17
)paren
comma
id|MT_RESUME_ACKNOWLEDGE
comma
id|l3dss1_resume_ack
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|17
)paren
comma
id|MT_RESUME_REJECT
comma
id|l3dss1_resume_rej
)brace
comma
)brace
suffix:semicolon
DECL|macro|DATASLLEN
mdefine_line|#define DATASLLEN &bslash;&n;&t;(sizeof(datastatelist) / sizeof(struct stateentry))
DECL|variable|globalmes_list
r_static
r_struct
id|stateentry
id|globalmes_list
(braket
)braket
op_assign
(brace
(brace
id|ALL_STATES
comma
id|MT_STATUS
comma
id|l3dss1_status
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|0
)paren
comma
id|MT_RESTART
comma
id|l3dss1_global_restart
)brace
comma
multiline_comment|/*&t;{SBIT(1),&n;&t; MT_RESTART_ACKNOWLEDGE, l3dss1_restart_ack},&n;*/
)brace
suffix:semicolon
DECL|macro|GLOBALM_LEN
mdefine_line|#define GLOBALM_LEN &bslash;&n;&t;(sizeof(globalmes_list) / sizeof(struct stateentry))
DECL|variable|manstatelist
r_static
r_struct
id|stateentry
id|manstatelist
(braket
)braket
op_assign
(brace
(brace
id|SBIT
c_func
(paren
l_int|2
)paren
comma
id|DL_ESTABLISH
op_or
id|INDICATION
comma
id|l3dss1_dl_reset
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|10
)paren
comma
id|DL_ESTABLISH
op_or
id|CONFIRM
comma
id|l3dss1_dl_reest_status
)brace
comma
(brace
id|SBIT
c_func
(paren
l_int|10
)paren
comma
id|DL_RELEASE
op_or
id|INDICATION
comma
id|l3dss1_dl_reestablish
)brace
comma
(brace
id|ALL_STATES
comma
id|DL_RELEASE
op_or
id|INDICATION
comma
id|l3dss1_dl_release
)brace
comma
)brace
suffix:semicolon
DECL|macro|MANSLLEN
mdefine_line|#define MANSLLEN &bslash;&n;        (sizeof(manstatelist) / sizeof(struct stateentry))
multiline_comment|/* *INDENT-ON* */
r_static
r_void
DECL|function|global_handler
id|global_handler
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|mt
comma
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
id|u_char
id|tmp
(braket
l_int|16
)braket
suffix:semicolon
id|u_char
op_star
id|p
op_assign
id|tmp
suffix:semicolon
r_int
id|l
suffix:semicolon
r_int
id|i
suffix:semicolon
r_struct
id|l3_process
op_star
id|proc
op_assign
id|st-&gt;l3.global
suffix:semicolon
id|proc-&gt;callref
op_assign
id|skb-&gt;data
(braket
l_int|2
)braket
suffix:semicolon
multiline_comment|/* cr flag */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|GLOBALM_LEN
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
(paren
id|mt
op_eq
id|globalmes_list
(braket
id|i
)braket
dot
id|primitive
)paren
op_logical_and
(paren
(paren
l_int|1
op_lshift
id|proc-&gt;state
)paren
op_amp
id|globalmes_list
(braket
id|i
)braket
dot
id|state
)paren
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|i
op_eq
id|GLOBALM_LEN
)paren
(brace
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_STATE
)paren
(brace
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;dss1 global state %d mt %x unhandled&quot;
comma
id|proc-&gt;state
comma
id|mt
)paren
suffix:semicolon
)brace
id|MsgHead
c_func
(paren
id|p
comma
id|proc-&gt;callref
comma
id|MT_STATUS
)paren
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|IE_CAUSE
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x2
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|0x80
suffix:semicolon
op_star
id|p
op_increment
op_assign
l_int|81
op_or
l_int|0x80
suffix:semicolon
multiline_comment|/* invalid cr */
op_star
id|p
op_increment
op_assign
l_int|0x14
suffix:semicolon
multiline_comment|/* CallState */
op_star
id|p
op_increment
op_assign
l_int|0x1
suffix:semicolon
op_star
id|p
op_increment
op_assign
id|proc-&gt;state
op_amp
l_int|0x3f
suffix:semicolon
id|l
op_assign
id|p
op_minus
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|l3_alloc_skb
c_func
(paren
id|l
)paren
)paren
)paren
r_return
suffix:semicolon
id|memcpy
c_func
(paren
id|skb_put
c_func
(paren
id|skb
comma
id|l
)paren
comma
id|tmp
comma
id|l
)paren
suffix:semicolon
id|l3_msg
c_func
(paren
id|proc-&gt;st
comma
id|DL_DATA
op_or
id|REQUEST
comma
id|skb
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_STATE
)paren
(brace
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;dss1 global %d mt %x&quot;
comma
id|proc-&gt;state
comma
id|mt
)paren
suffix:semicolon
)brace
id|globalmes_list
(braket
id|i
)braket
dot
id|rout
c_func
(paren
id|proc
comma
id|mt
comma
id|skb
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|dss1up
id|dss1up
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_int
id|i
comma
id|mt
comma
id|cr
comma
id|cause
comma
id|callState
suffix:semicolon
r_char
op_star
id|ptr
suffix:semicolon
id|u_char
op_star
id|p
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
op_assign
id|arg
suffix:semicolon
r_struct
id|l3_process
op_star
id|proc
suffix:semicolon
r_switch
c_cond
(paren
id|pr
)paren
(brace
r_case
(paren
id|DL_DATA
op_or
id|INDICATION
)paren
suffix:colon
r_case
(paren
id|DL_UNIT_DATA
op_or
id|INDICATION
)paren
suffix:colon
r_break
suffix:semicolon
r_case
(paren
id|DL_ESTABLISH
op_or
id|CONFIRM
)paren
suffix:colon
r_case
(paren
id|DL_ESTABLISH
op_or
id|INDICATION
)paren
suffix:colon
r_case
(paren
id|DL_RELEASE
op_or
id|INDICATION
)paren
suffix:colon
r_case
(paren
id|DL_RELEASE
op_or
id|CONFIRM
)paren
suffix:colon
id|l3_msg
c_func
(paren
id|st
comma
id|pr
comma
id|arg
)paren
suffix:semicolon
r_return
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;HiSax dss1up unknown pr=%04x&bslash;n&quot;
comma
id|pr
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|skb-&gt;len
OL
l_int|3
)paren
(brace
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;dss1up frame too short(%d)&quot;
comma
id|skb-&gt;len
)paren
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|skb-&gt;data
(braket
l_int|0
)braket
op_ne
id|PROTO_DIS_EURO
)paren
(brace
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_PROTERR
)paren
(brace
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;dss1up%sunexpected discriminator %x message len %d&quot;
comma
(paren
id|pr
op_eq
(paren
id|DL_DATA
op_or
id|INDICATION
)paren
)paren
ques
c_cond
l_string|&quot; &quot;
suffix:colon
l_string|&quot;(broadcast) &quot;
comma
id|skb-&gt;data
(braket
l_int|0
)braket
comma
id|skb-&gt;len
)paren
suffix:semicolon
)brace
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|cr
op_assign
id|getcallref
c_func
(paren
id|skb-&gt;data
)paren
suffix:semicolon
r_if
c_cond
(paren
id|skb-&gt;len
OL
(paren
(paren
id|skb-&gt;data
(braket
l_int|1
)braket
op_amp
l_int|0x0f
)paren
op_plus
l_int|3
)paren
)paren
(brace
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;dss1up frame too short(%d)&quot;
comma
id|skb-&gt;len
)paren
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|mt
op_assign
id|skb-&gt;data
(braket
id|skb-&gt;data
(braket
l_int|1
)braket
op_plus
l_int|2
)braket
suffix:semicolon
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_STATE
)paren
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;dss1up cr %d&quot;
comma
id|cr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|cr
op_eq
op_minus
l_int|2
)paren
(brace
multiline_comment|/* wrong Callref */
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;dss1up wrong Callref&quot;
)paren
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|cr
op_eq
op_minus
l_int|1
)paren
(brace
multiline_comment|/* Dummy Callref */
r_if
c_cond
(paren
id|mt
op_eq
id|MT_FACILITY
)paren
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|skb-&gt;data
comma
id|skb-&gt;len
comma
id|IE_FACILITY
comma
l_int|0
)paren
)paren
)paren
(brace
id|l3dss1_parse_facility
c_func
(paren
id|st
comma
l_int|NULL
comma
(paren
id|pr
op_eq
(paren
id|DL_DATA
op_or
id|INDICATION
)paren
)paren
ques
c_cond
op_minus
l_int|1
suffix:colon
op_minus
l_int|2
comma
id|p
)paren
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_WARN
)paren
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;dss1up dummy Callref (no facility msg or ie)&quot;
)paren
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
(paren
(paren
id|skb-&gt;data
(braket
l_int|1
)braket
op_amp
l_int|0x0f
)paren
op_eq
l_int|1
)paren
op_logical_and
(paren
l_int|0
op_eq
(paren
id|cr
op_amp
l_int|0x7f
)paren
)paren
)paren
op_logical_or
(paren
(paren
(paren
id|skb-&gt;data
(braket
l_int|1
)braket
op_amp
l_int|0x0f
)paren
op_eq
l_int|2
)paren
op_logical_and
(paren
l_int|0
op_eq
(paren
id|cr
op_amp
l_int|0x7fff
)paren
)paren
)paren
)paren
(brace
multiline_comment|/* Global CallRef */
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_STATE
)paren
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;dss1up Global CallRef&quot;
)paren
suffix:semicolon
id|global_handler
c_func
(paren
id|st
comma
id|mt
comma
id|skb
)paren
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
(paren
id|proc
op_assign
id|getl3proc
c_func
(paren
id|st
comma
id|cr
)paren
)paren
)paren
(brace
multiline_comment|/* No transaction process exist, that means no call with&n;&t;&t; * this callreference is active&n;&t;&t; */
r_if
c_cond
(paren
id|mt
op_eq
id|MT_SETUP
)paren
(brace
multiline_comment|/* Setup creates a new transaction process */
r_if
c_cond
(paren
id|skb-&gt;data
(braket
l_int|2
)braket
op_amp
l_int|0x80
)paren
(brace
multiline_comment|/* Setup with wrong CREF flag */
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_STATE
)paren
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;dss1up wrong CRef flag&quot;
)paren
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|proc
op_assign
id|dss1_new_l3_process
c_func
(paren
id|st
comma
id|cr
)paren
)paren
)paren
(brace
multiline_comment|/* May be to answer with RELEASE_COMPLETE and&n;&t;&t;&t;&t; * CAUSE 0x2f &quot;Resource unavailable&quot;, but this&n;&t;&t;&t;&t; * need a new_l3_process too ... arghh&n;&t;&t;&t;&t; */
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|mt
op_eq
id|MT_STATUS
)paren
(brace
id|cause
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ptr
op_assign
id|findie
c_func
(paren
id|skb-&gt;data
comma
id|skb-&gt;len
comma
id|IE_CAUSE
comma
l_int|0
)paren
)paren
op_ne
l_int|NULL
)paren
(brace
id|ptr
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|ptr
op_increment
op_eq
l_int|2
)paren
id|ptr
op_increment
suffix:semicolon
id|cause
op_assign
op_star
id|ptr
op_amp
l_int|0x7f
suffix:semicolon
)brace
id|callState
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
(paren
id|ptr
op_assign
id|findie
c_func
(paren
id|skb-&gt;data
comma
id|skb-&gt;len
comma
id|IE_CALL_STATE
comma
l_int|0
)paren
)paren
op_ne
l_int|NULL
)paren
(brace
id|ptr
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|ptr
op_increment
op_eq
l_int|2
)paren
id|ptr
op_increment
suffix:semicolon
id|callState
op_assign
op_star
id|ptr
suffix:semicolon
)brace
multiline_comment|/* ETS 300-104 part 2.4.1&n;&t;&t;&t; * if setup has not been made and a message type&n;&t;&t;&t; * MT_STATUS is received with call state == 0,&n;&t;&t;&t; * we must send nothing&n;&t;&t;&t; */
r_if
c_cond
(paren
id|callState
op_ne
l_int|0
)paren
(brace
multiline_comment|/* ETS 300-104 part 2.4.2&n;&t;&t;&t;&t; * if setup has not been made and a message type&n;&t;&t;&t;&t; * MT_STATUS is received with call state != 0,&n;&t;&t;&t;&t; * we must send MT_RELEASE_COMPLETE cause 101&n;&t;&t;&t;&t; */
r_if
c_cond
(paren
(paren
id|proc
op_assign
id|dss1_new_l3_process
c_func
(paren
id|st
comma
id|cr
)paren
)paren
)paren
(brace
id|proc-&gt;para.cause
op_assign
l_int|101
suffix:semicolon
id|l3dss1_msg_without_setup
c_func
(paren
id|proc
comma
l_int|0
comma
l_int|NULL
)paren
suffix:semicolon
)brace
)brace
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|mt
op_eq
id|MT_RELEASE_COMPLETE
)paren
(brace
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* ETS 300-104 part 2&n;&t;&t;&t; * if setup has not been made and a message type&n;&t;&t;&t; * (except MT_SETUP and RELEASE_COMPLETE) is received,&n;&t;&t;&t; * we must send MT_RELEASE_COMPLETE cause 81 */
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|proc
op_assign
id|dss1_new_l3_process
c_func
(paren
id|st
comma
id|cr
)paren
)paren
)paren
(brace
id|proc-&gt;para.cause
op_assign
l_int|81
suffix:semicolon
id|l3dss1_msg_without_setup
c_func
(paren
id|proc
comma
l_int|0
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_return
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|l3dss1_check_messagetype_validity
c_func
(paren
id|proc
comma
id|mt
comma
id|skb
)paren
)paren
(brace
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|p
op_assign
id|findie
c_func
(paren
id|skb-&gt;data
comma
id|skb-&gt;len
comma
id|IE_DISPLAY
comma
l_int|0
)paren
)paren
op_ne
l_int|NULL
)paren
id|l3dss1_deliver_display
c_func
(paren
id|proc
comma
id|pr
comma
id|p
)paren
suffix:semicolon
multiline_comment|/* Display IE included */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|DATASLLEN
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
(paren
id|mt
op_eq
id|datastatelist
(braket
id|i
)braket
dot
id|primitive
)paren
op_logical_and
(paren
(paren
l_int|1
op_lshift
id|proc-&gt;state
)paren
op_amp
id|datastatelist
(braket
id|i
)braket
dot
id|state
)paren
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|i
op_eq
id|DATASLLEN
)paren
(brace
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_STATE
)paren
(brace
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;dss1up%sstate %d mt %#x unhandled&quot;
comma
(paren
id|pr
op_eq
(paren
id|DL_DATA
op_or
id|INDICATION
)paren
)paren
ques
c_cond
l_string|&quot; &quot;
suffix:colon
l_string|&quot;(broadcast) &quot;
comma
id|proc-&gt;state
comma
id|mt
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|MT_RELEASE_COMPLETE
op_ne
id|mt
)paren
op_logical_and
(paren
id|MT_RELEASE
op_ne
id|mt
)paren
)paren
(brace
id|proc-&gt;para.cause
op_assign
l_int|101
suffix:semicolon
id|l3dss1_status_send
c_func
(paren
id|proc
comma
id|pr
comma
id|skb
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_STATE
)paren
(brace
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;dss1up%sstate %d mt %x&quot;
comma
(paren
id|pr
op_eq
(paren
id|DL_DATA
op_or
id|INDICATION
)paren
)paren
ques
c_cond
l_string|&quot; &quot;
suffix:colon
l_string|&quot;(broadcast) &quot;
comma
id|proc-&gt;state
comma
id|mt
)paren
suffix:semicolon
)brace
id|datastatelist
(braket
id|i
)braket
dot
id|rout
c_func
(paren
id|proc
comma
id|pr
comma
id|skb
)paren
suffix:semicolon
)brace
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_static
r_void
DECL|function|dss1down
id|dss1down
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_int
id|i
comma
id|cr
suffix:semicolon
r_struct
id|l3_process
op_star
id|proc
suffix:semicolon
r_struct
id|Channel
op_star
id|chan
suffix:semicolon
r_if
c_cond
(paren
(paren
id|DL_ESTABLISH
op_or
id|REQUEST
)paren
op_eq
id|pr
)paren
(brace
id|l3_msg
c_func
(paren
id|st
comma
id|pr
comma
l_int|NULL
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
(paren
id|CC_SETUP
op_or
id|REQUEST
)paren
op_eq
id|pr
)paren
op_logical_or
(paren
(paren
id|CC_RESUME
op_or
id|REQUEST
)paren
op_eq
id|pr
)paren
)paren
(brace
id|chan
op_assign
id|arg
suffix:semicolon
id|cr
op_assign
id|newcallref
c_func
(paren
)paren
suffix:semicolon
id|cr
op_or_assign
l_int|0x80
suffix:semicolon
r_if
c_cond
(paren
(paren
id|proc
op_assign
id|dss1_new_l3_process
c_func
(paren
id|st
comma
id|cr
)paren
)paren
)paren
(brace
id|proc-&gt;chan
op_assign
id|chan
suffix:semicolon
id|chan-&gt;proc
op_assign
id|proc
suffix:semicolon
id|memcpy
c_func
(paren
op_amp
id|proc-&gt;para.setup
comma
op_amp
id|chan-&gt;setup
comma
r_sizeof
(paren
id|setup_parm
)paren
)paren
suffix:semicolon
id|proc-&gt;callref
op_assign
id|cr
suffix:semicolon
)brace
)brace
r_else
(brace
id|proc
op_assign
id|arg
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|proc
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;HiSax dss1down without proc pr=%04x&bslash;n&quot;
comma
id|pr
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|pr
op_eq
(paren
id|CC_TDSS1_IO
op_or
id|REQUEST
)paren
)paren
(brace
id|l3dss1_io_timer
c_func
(paren
id|proc
)paren
suffix:semicolon
multiline_comment|/* timer expires */
r_return
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|DOWNSLLEN
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
(paren
id|pr
op_eq
id|downstatelist
(braket
id|i
)braket
dot
id|primitive
)paren
op_logical_and
(paren
(paren
l_int|1
op_lshift
id|proc-&gt;state
)paren
op_amp
id|downstatelist
(braket
id|i
)braket
dot
id|state
)paren
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|i
op_eq
id|DOWNSLLEN
)paren
(brace
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_STATE
)paren
(brace
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;dss1down state %d prim %#x unhandled&quot;
comma
id|proc-&gt;state
comma
id|pr
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_STATE
)paren
(brace
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;dss1down state %d prim %#x&quot;
comma
id|proc-&gt;state
comma
id|pr
)paren
suffix:semicolon
)brace
id|downstatelist
(braket
id|i
)braket
dot
id|rout
c_func
(paren
id|proc
comma
id|pr
comma
id|arg
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|dss1man
id|dss1man
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_int
id|i
suffix:semicolon
r_struct
id|l3_process
op_star
id|proc
op_assign
id|arg
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|proc
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;HiSax dss1man without proc pr=%04x&bslash;n&quot;
comma
id|pr
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|MANSLLEN
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
(paren
id|pr
op_eq
id|manstatelist
(braket
id|i
)braket
dot
id|primitive
)paren
op_logical_and
(paren
(paren
l_int|1
op_lshift
id|proc-&gt;state
)paren
op_amp
id|manstatelist
(braket
id|i
)braket
dot
id|state
)paren
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|i
op_eq
id|MANSLLEN
)paren
(brace
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_STATE
)paren
(brace
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;cr %d dss1man state %d prim %#x unhandled&quot;
comma
id|proc-&gt;callref
op_amp
l_int|0x7f
comma
id|proc-&gt;state
comma
id|pr
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
r_if
c_cond
(paren
id|st-&gt;l3.debug
op_amp
id|L3_DEB_STATE
)paren
(brace
id|l3_debug
c_func
(paren
id|st
comma
l_string|&quot;cr %d dss1man state %d prim %#x&quot;
comma
id|proc-&gt;callref
op_amp
l_int|0x7f
comma
id|proc-&gt;state
comma
id|pr
)paren
suffix:semicolon
)brace
id|manstatelist
(braket
id|i
)braket
dot
id|rout
c_func
(paren
id|proc
comma
id|pr
comma
id|arg
)paren
suffix:semicolon
)brace
)brace
r_void
DECL|function|setstack_dss1
id|setstack_dss1
c_func
(paren
r_struct
id|PStack
op_star
id|st
)paren
(brace
r_char
id|tmp
(braket
l_int|64
)braket
suffix:semicolon
r_int
id|i
suffix:semicolon
id|st-&gt;lli.l4l3
op_assign
id|dss1down
suffix:semicolon
id|st-&gt;lli.l4l3_proto
op_assign
id|l3dss1_cmd_global
suffix:semicolon
id|st-&gt;l2.l2l3
op_assign
id|dss1up
suffix:semicolon
id|st-&gt;l3.l3ml3
op_assign
id|dss1man
suffix:semicolon
id|st-&gt;l3.N303
op_assign
l_int|1
suffix:semicolon
id|st-&gt;prot.dss1.last_invoke_id
op_assign
l_int|0
suffix:semicolon
id|st-&gt;prot.dss1.invoke_used
(braket
l_int|0
)braket
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* Bit 0 must always be set to 1 */
id|i
op_assign
l_int|1
suffix:semicolon
r_while
c_loop
(paren
id|i
OL
l_int|32
)paren
id|st-&gt;prot.dss1.invoke_used
(braket
id|i
op_increment
)braket
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|st-&gt;l3.global
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|l3_process
)paren
comma
id|GFP_ATOMIC
)paren
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;HiSax can&squot;t get memory for dss1 global CR&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|st-&gt;l3.global-&gt;state
op_assign
l_int|0
suffix:semicolon
id|st-&gt;l3.global-&gt;callref
op_assign
l_int|0
suffix:semicolon
id|st-&gt;l3.global-&gt;next
op_assign
l_int|NULL
suffix:semicolon
id|st-&gt;l3.global-&gt;debug
op_assign
id|L3_DEB_WARN
suffix:semicolon
id|st-&gt;l3.global-&gt;st
op_assign
id|st
suffix:semicolon
id|st-&gt;l3.global-&gt;N303
op_assign
l_int|1
suffix:semicolon
id|st-&gt;l3.global-&gt;prot.dss1.invoke_id
op_assign
l_int|0
suffix:semicolon
id|L3InitTimer
c_func
(paren
id|st-&gt;l3.global
comma
op_amp
id|st-&gt;l3.global-&gt;timer
)paren
suffix:semicolon
)brace
id|strcpy
c_func
(paren
id|tmp
comma
id|dss1_revision
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;HiSax: DSS1 Rev. %s&bslash;n&quot;
comma
id|HiSax_getrev
c_func
(paren
id|tmp
)paren
)paren
suffix:semicolon
)brace
eof
