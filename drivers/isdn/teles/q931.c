multiline_comment|/* $Id: q931.c,v 1.6 1996/09/23 01:53:53 fritz Exp $&n; *&n; * q931.c               code to decode ITU Q.931 call control messages&n; * &n; * Author               Jan den Ouden&n; * &n; * Changelog&n; * &n; * Pauline Middelink    general improvements&n; * &n; * Beat Doebeli         cause texts, display information element&n; * &n; * Karsten Keil         cause texts, display information element for 1TR6 &n; *&n; * &n; * $Log: q931.c,v $&n; * Revision 1.6  1996/09/23 01:53:53  fritz&n; * Bugfix: discard unknown frames (non-EDSS1 and non-1TR6).&n; *&n; * Revision 1.5  1996/06/03 20:03:40  fritz&n; * Fixed typos.&n; *&n; * Revision 1.4  1996/05/17 03:46:17  fritz&n; * General cleanup.&n; *&n; * Revision 1.3  1996/04/30 22:06:50  isdn4dev&n; *   logging 1TR6 messages correctly   Karsten Keil&n; *&n; * Revision 1.2  1996/04/20 16:48:19  fritz&n; * Misc. typos&n; *&n; * Revision 1.1  1996/04/13 10:27:49  fritz&n; * Initial revision&n; *&n; *&n; */
DECL|macro|__NO_VERSION__
mdefine_line|#define __NO_VERSION__
macro_line|#include &quot;teles.h&quot;
macro_line|#include &quot;proto.h&quot;
macro_line|#include &quot;l3_1TR6.h&quot;
id|byte
op_star
DECL|function|findie
id|findie
c_func
(paren
id|byte
op_star
id|p
comma
r_int
id|size
comma
id|byte
id|ie
comma
r_int
id|wanted_set
)paren
(brace
r_int
id|l
comma
id|codeset
comma
id|maincodeset
suffix:semicolon
id|byte
op_star
id|pend
op_assign
id|p
op_plus
id|size
suffix:semicolon
multiline_comment|/* skip protocol discriminator, callref and message type */
id|p
op_increment
suffix:semicolon
id|l
op_assign
(paren
op_star
id|p
op_increment
)paren
op_amp
l_int|0xf
suffix:semicolon
id|p
op_add_assign
id|l
suffix:semicolon
id|p
op_increment
suffix:semicolon
id|codeset
op_assign
l_int|0
suffix:semicolon
id|maincodeset
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* while there are bytes left... */
r_while
c_loop
(paren
id|p
OL
id|pend
)paren
(brace
r_if
c_cond
(paren
(paren
op_star
id|p
op_amp
l_int|0xf0
)paren
op_eq
l_int|0x90
)paren
(brace
id|codeset
op_assign
op_star
id|p
op_amp
l_int|0x07
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
op_star
id|p
op_amp
l_int|0x08
)paren
)paren
id|maincodeset
op_assign
id|codeset
suffix:semicolon
)brace
r_if
c_cond
(paren
op_star
id|p
op_amp
l_int|0x80
)paren
id|p
op_increment
suffix:semicolon
r_else
(brace
r_if
c_cond
(paren
id|codeset
op_eq
id|wanted_set
)paren
(brace
r_if
c_cond
(paren
op_star
id|p
op_eq
id|ie
)paren
r_return
(paren
id|p
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
OG
id|ie
)paren
r_return
(paren
l_int|NULL
)paren
suffix:semicolon
)brace
id|p
op_increment
suffix:semicolon
id|l
op_assign
op_star
id|p
op_increment
suffix:semicolon
id|p
op_add_assign
id|l
suffix:semicolon
id|codeset
op_assign
id|maincodeset
suffix:semicolon
)brace
)brace
r_return
(paren
l_int|NULL
)paren
suffix:semicolon
)brace
r_void
DECL|function|iecpy
id|iecpy
c_func
(paren
id|byte
op_star
id|dest
comma
id|byte
op_star
id|iestart
comma
r_int
id|ieoffset
)paren
(brace
id|byte
op_star
id|p
suffix:semicolon
r_int
id|l
suffix:semicolon
id|p
op_assign
id|iestart
op_plus
id|ieoffset
op_plus
l_int|2
suffix:semicolon
id|l
op_assign
id|iestart
(braket
l_int|1
)braket
op_minus
id|ieoffset
suffix:semicolon
r_while
c_loop
(paren
id|l
op_decrement
)paren
op_star
id|dest
op_increment
op_assign
op_star
id|p
op_increment
suffix:semicolon
op_star
id|dest
op_increment
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
)brace
r_int
DECL|function|getcallref
id|getcallref
c_func
(paren
id|byte
op_star
id|p
)paren
(brace
id|p
op_increment
suffix:semicolon
multiline_comment|/* prot discr */
id|p
op_increment
suffix:semicolon
multiline_comment|/* callref length */
r_return
(paren
op_star
id|p
)paren
suffix:semicolon
multiline_comment|/* assuming one-byte callref */
)brace
multiline_comment|/*&n; * According to Table 4-2/Q.931&n; */
r_static
DECL|struct|MessageType
r_struct
id|MessageType
(brace
DECL|member|nr
id|byte
id|nr
suffix:semicolon
DECL|member|descr
r_char
op_star
id|descr
suffix:semicolon
DECL|variable|mtlist
)brace
id|mtlist
(braket
)braket
op_assign
(brace
(brace
l_int|0x1
comma
l_string|&quot;ALERTING&quot;
)brace
comma
(brace
l_int|0x2
comma
l_string|&quot;CALL PROCEEDING&quot;
)brace
comma
(brace
l_int|0x7
comma
l_string|&quot;CONNECT&quot;
)brace
comma
(brace
l_int|0xf
comma
l_string|&quot;CONNECT ACKNOWLEDGE&quot;
)brace
comma
(brace
l_int|0x3
comma
l_string|&quot;PROGRESS&quot;
)brace
comma
(brace
l_int|0x5
comma
l_string|&quot;SETUP&quot;
)brace
comma
(brace
l_int|0xd
comma
l_string|&quot;SETUP ACKNOWLEDGE&quot;
)brace
comma
(brace
l_int|0x26
comma
l_string|&quot;RESUME&quot;
)brace
comma
(brace
l_int|0x2e
comma
l_string|&quot;RESUME ACKNOWLEDGE&quot;
)brace
comma
(brace
l_int|0x22
comma
l_string|&quot;RESUME REJECT&quot;
)brace
comma
(brace
l_int|0x25
comma
l_string|&quot;SUSPEND&quot;
)brace
comma
(brace
l_int|0x2d
comma
l_string|&quot;SUSPEND ACKNOWLEDGE&quot;
)brace
comma
(brace
l_int|0x21
comma
l_string|&quot;SUSPEND REJECT&quot;
)brace
comma
(brace
l_int|0x20
comma
l_string|&quot;USER INFORMATION&quot;
)brace
comma
(brace
l_int|0x45
comma
l_string|&quot;DISCONNECT&quot;
)brace
comma
(brace
l_int|0x4d
comma
l_string|&quot;RELEASE&quot;
)brace
comma
(brace
l_int|0x5a
comma
l_string|&quot;RELEASE COMPLETE&quot;
)brace
comma
(brace
l_int|0x46
comma
l_string|&quot;RESTART&quot;
)brace
comma
(brace
l_int|0x4e
comma
l_string|&quot;RESTART ACKNOWLEDGE&quot;
)brace
comma
(brace
l_int|0x60
comma
l_string|&quot;SEGMENT&quot;
)brace
comma
(brace
l_int|0x79
comma
l_string|&quot;CONGESTION CONTROL&quot;
)brace
comma
(brace
l_int|0x7b
comma
l_string|&quot;INFORMATION&quot;
)brace
comma
(brace
l_int|0x62
comma
l_string|&quot;FACILITY&quot;
)brace
comma
(brace
l_int|0x6e
comma
l_string|&quot;NOTIFY&quot;
)brace
comma
(brace
l_int|0x7d
comma
l_string|&quot;STATUS&quot;
)brace
comma
(brace
l_int|0x75
comma
l_string|&quot;STATUS ENQUIRY&quot;
)brace
)brace
suffix:semicolon
DECL|macro|MTSIZE
mdefine_line|#define MTSIZE sizeof(mtlist)/sizeof(struct MessageType)
r_static
DECL|variable|mt_n0
r_struct
id|MessageType
id|mt_n0
(braket
)braket
op_assign
(brace
(brace
id|MT_N0_REG_IND
comma
l_string|&quot;REGister INDication&quot;
)brace
comma
(brace
id|MT_N0_CANC_IND
comma
l_string|&quot;CANCel INDication&quot;
)brace
comma
(brace
id|MT_N0_FAC_STA
comma
l_string|&quot;FACility STAtus&quot;
)brace
comma
(brace
id|MT_N0_STA_ACK
comma
l_string|&quot;STAtus ACKnowledge&quot;
)brace
comma
(brace
id|MT_N0_STA_REJ
comma
l_string|&quot;STAtus REJect&quot;
)brace
comma
(brace
id|MT_N0_FAC_INF
comma
l_string|&quot;FACility INFormation&quot;
)brace
comma
(brace
id|MT_N0_INF_ACK
comma
l_string|&quot;INFormation ACKnowledge&quot;
)brace
comma
(brace
id|MT_N0_INF_REJ
comma
l_string|&quot;INFormation REJect&quot;
)brace
comma
(brace
id|MT_N0_CLOSE
comma
l_string|&quot;CLOSE&quot;
)brace
comma
(brace
id|MT_N0_CLO_ACK
comma
l_string|&quot;CLOse ACKnowledge&quot;
)brace
)brace
suffix:semicolon
DECL|variable|mt_n0_len
r_int
id|mt_n0_len
op_assign
(paren
r_sizeof
(paren
id|mt_n0
)paren
op_div
r_sizeof
(paren
r_struct
id|MessageType
)paren
)paren
suffix:semicolon
r_static
DECL|variable|mt_n1
r_struct
id|MessageType
id|mt_n1
(braket
)braket
op_assign
(brace
(brace
id|MT_N1_ESC
comma
l_string|&quot;ESCape&quot;
)brace
comma
(brace
id|MT_N1_ALERT
comma
l_string|&quot;ALERT&quot;
)brace
comma
(brace
id|MT_N1_CALL_SENT
comma
l_string|&quot;CALL SENT&quot;
)brace
comma
(brace
id|MT_N1_CONN
comma
l_string|&quot;CONNect&quot;
)brace
comma
(brace
id|MT_N1_CONN_ACK
comma
l_string|&quot;CONNect ACKnowledge&quot;
)brace
comma
(brace
id|MT_N1_SETUP
comma
l_string|&quot;SETUP&quot;
)brace
comma
(brace
id|MT_N1_SETUP_ACK
comma
l_string|&quot;SETUP ACKnowledge&quot;
)brace
comma
(brace
id|MT_N1_RES
comma
l_string|&quot;RESume&quot;
)brace
comma
(brace
id|MT_N1_RES_ACK
comma
l_string|&quot;RESume ACKnowledge&quot;
)brace
comma
(brace
id|MT_N1_RES_REJ
comma
l_string|&quot;RESume REJect&quot;
)brace
comma
(brace
id|MT_N1_SUSP
comma
l_string|&quot;SUSPend&quot;
)brace
comma
(brace
id|MT_N1_SUSP_ACK
comma
l_string|&quot;SUSPend ACKnowledge&quot;
)brace
comma
(brace
id|MT_N1_SUSP_REJ
comma
l_string|&quot;SUSPend REJect&quot;
)brace
comma
(brace
id|MT_N1_USER_INFO
comma
l_string|&quot;USER INFO&quot;
)brace
comma
(brace
id|MT_N1_DET
comma
l_string|&quot;DETach&quot;
)brace
comma
(brace
id|MT_N1_DISC
comma
l_string|&quot;DISConnect&quot;
)brace
comma
(brace
id|MT_N1_REL
comma
l_string|&quot;RELease&quot;
)brace
comma
(brace
id|MT_N1_REL_ACK
comma
l_string|&quot;RELease ACKnowledge&quot;
)brace
comma
(brace
id|MT_N1_CANC_ACK
comma
l_string|&quot;CANCel ACKnowledge&quot;
)brace
comma
(brace
id|MT_N1_CANC_REJ
comma
l_string|&quot;CANCel REJect&quot;
)brace
comma
(brace
id|MT_N1_CON_CON
comma
l_string|&quot;CONgestion CONtrol&quot;
)brace
comma
(brace
id|MT_N1_FAC
comma
l_string|&quot;FACility&quot;
)brace
comma
(brace
id|MT_N1_FAC_ACK
comma
l_string|&quot;FACility ACKnowledge&quot;
)brace
comma
(brace
id|MT_N1_FAC_CAN
comma
l_string|&quot;FACility CANcel&quot;
)brace
comma
(brace
id|MT_N1_FAC_REG
comma
l_string|&quot;FACility REGister&quot;
)brace
comma
(brace
id|MT_N1_FAC_REJ
comma
l_string|&quot;FACility REJect&quot;
)brace
comma
(brace
id|MT_N1_INFO
comma
l_string|&quot;INFOrmation&quot;
)brace
comma
(brace
id|MT_N1_REG_ACK
comma
l_string|&quot;REGister ACKnowledge&quot;
)brace
comma
(brace
id|MT_N1_REG_REJ
comma
l_string|&quot;REGister REJect&quot;
)brace
comma
(brace
id|MT_N1_STAT
comma
l_string|&quot;STATus&quot;
)brace
)brace
suffix:semicolon
DECL|variable|mt_n1_len
r_int
id|mt_n1_len
op_assign
(paren
r_sizeof
(paren
id|mt_n1
)paren
op_div
r_sizeof
(paren
r_struct
id|MessageType
)paren
)paren
suffix:semicolon
DECL|variable|fac_1tr6
r_static
r_struct
id|MessageType
id|fac_1tr6
(braket
)braket
op_assign
(brace
(brace
id|FAC_Sperre
comma
l_string|&quot;Sperre&quot;
)brace
comma
(brace
id|FAC_Forward1
comma
l_string|&quot;Forward 1&quot;
)brace
comma
(brace
id|FAC_Forward2
comma
l_string|&quot;Forward 2&quot;
)brace
comma
(brace
id|FAC_Konferenz
comma
l_string|&quot;Konferenz&quot;
)brace
comma
(brace
id|FAC_GrabBchan
comma
l_string|&quot;Grab Bchannel&quot;
)brace
comma
(brace
id|FAC_Reactivate
comma
l_string|&quot;Reactivate&quot;
)brace
comma
(brace
id|FAC_Konferenz3
comma
l_string|&quot;Dreier Konferenz&quot;
)brace
comma
(brace
id|FAC_Dienstwechsel1
comma
l_string|&quot;Einseitiger Dienstwechsel&quot;
)brace
comma
(brace
id|FAC_Dienstwechsel2
comma
l_string|&quot;Zweiseitiger Dienstwechsel&quot;
)brace
comma
(brace
id|FAC_NummernIdent
comma
l_string|&quot;Rufnummer-Identifizierung&quot;
)brace
comma
(brace
id|FAC_GBG
comma
l_string|&quot;GBG&quot;
)brace
comma
(brace
id|FAC_DisplayUebergeben
comma
l_string|&quot;Display Uebergeben&quot;
)brace
comma
(brace
id|FAC_DisplayUmgeleitet
comma
l_string|&quot;Display Umgeleitet&quot;
)brace
comma
(brace
id|FAC_Unterdruecke
comma
l_string|&quot;Unterdruecke Rufnummer&quot;
)brace
comma
(brace
id|FAC_Deactivate
comma
l_string|&quot;Deactivate&quot;
)brace
comma
(brace
id|FAC_Activate
comma
l_string|&quot;Activate&quot;
)brace
comma
(brace
id|FAC_SPV
comma
l_string|&quot;SPV&quot;
)brace
comma
(brace
id|FAC_Rueckwechsel
comma
l_string|&quot;Rueckwechsel&quot;
)brace
comma
(brace
id|FAC_Umleitung
comma
l_string|&quot;Umleitung&quot;
)brace
)brace
suffix:semicolon
DECL|variable|fac_1tr6_len
r_int
id|fac_1tr6_len
op_assign
(paren
r_sizeof
(paren
id|fac_1tr6
)paren
op_div
r_sizeof
(paren
r_struct
id|MessageType
)paren
)paren
suffix:semicolon
r_static
r_int
DECL|function|prbits
id|prbits
c_func
(paren
r_char
op_star
id|dest
comma
id|byte
id|b
comma
r_int
id|start
comma
r_int
id|len
)paren
(brace
r_char
op_star
id|dp
op_assign
id|dest
suffix:semicolon
id|b
op_assign
id|b
op_lshift
(paren
l_int|8
op_minus
id|start
)paren
suffix:semicolon
r_while
c_loop
(paren
id|len
op_decrement
)paren
(brace
r_if
c_cond
(paren
id|b
op_amp
l_int|0x80
)paren
op_star
id|dp
op_increment
op_assign
l_char|&squot;1&squot;
suffix:semicolon
r_else
op_star
id|dp
op_increment
op_assign
l_char|&squot;0&squot;
suffix:semicolon
id|b
op_assign
id|b
op_lshift
l_int|1
suffix:semicolon
)brace
r_return
(paren
id|dp
op_minus
id|dest
)paren
suffix:semicolon
)brace
r_static
id|byte
op_star
DECL|function|skipext
id|skipext
c_func
(paren
id|byte
op_star
id|p
)paren
(brace
r_while
c_loop
(paren
op_logical_neg
(paren
op_star
id|p
op_increment
op_amp
l_int|0x80
)paren
)paren
suffix:semicolon
r_return
(paren
id|p
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Cause Values According to Q.850&n; * edescr: English description&n; * ddescr: German description used by Swissnet II (Swiss Telecom&n; *         not yet written...&n; */
r_static
DECL|struct|CauseValue
r_struct
id|CauseValue
(brace
DECL|member|nr
id|byte
id|nr
suffix:semicolon
DECL|member|edescr
r_char
op_star
id|edescr
suffix:semicolon
DECL|member|ddescr
r_char
op_star
id|ddescr
suffix:semicolon
DECL|variable|cvlist
)brace
id|cvlist
(braket
)braket
op_assign
(brace
(brace
l_int|0x01
comma
l_string|&quot;Unallocated (unassigned) number&quot;
comma
l_string|&quot;Nummer nicht zugeteilt&quot;
)brace
comma
(brace
l_int|0x02
comma
l_string|&quot;No route to specified transit network&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x03
comma
l_string|&quot;No route to destination&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x04
comma
l_string|&quot;Send special information tone&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x05
comma
l_string|&quot;Misdialled trunk prefix&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x06
comma
l_string|&quot;Channel unacceptable&quot;
comma
l_string|&quot;Kanal nicht akzeptierbar&quot;
)brace
comma
(brace
l_int|0x07
comma
l_string|&quot;Channel awarded and being delivered in an established channel&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x08
comma
l_string|&quot;Preemption&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x09
comma
l_string|&quot;Preemption - circuit reserved for reuse&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x10
comma
l_string|&quot;Normal call clearing&quot;
comma
l_string|&quot;Normale Ausloesung&quot;
)brace
comma
(brace
l_int|0x11
comma
l_string|&quot;User busy&quot;
comma
l_string|&quot;TNB besetzt&quot;
)brace
comma
(brace
l_int|0x12
comma
l_string|&quot;No user responding&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x13
comma
l_string|&quot;No answer from user (user alerted)&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x14
comma
l_string|&quot;Subscriber absent&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x15
comma
l_string|&quot;Call rejected&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x16
comma
l_string|&quot;Number changed&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x1a
comma
l_string|&quot;non-selected user clearing&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x1b
comma
l_string|&quot;Destination out of order&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x1c
comma
l_string|&quot;Invalid number format (address incomplete)&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x1d
comma
l_string|&quot;Facility rejected&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x1e
comma
l_string|&quot;Response to Status enquiry&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x1f
comma
l_string|&quot;Normal, unspecified&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x22
comma
l_string|&quot;No circuit/channel available&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x26
comma
l_string|&quot;Network out of order&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x27
comma
l_string|&quot;Permanent frame mode connection out-of-service&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x28
comma
l_string|&quot;Permanent frame mode connection operational&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x29
comma
l_string|&quot;Temporary failure&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x2a
comma
l_string|&quot;Switching equipment congestion&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x2b
comma
l_string|&quot;Access information discarded&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x2c
comma
l_string|&quot;Requested circuit/channel not available&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x2e
comma
l_string|&quot;Precedence call blocked&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x2f
comma
l_string|&quot;Resource unavailable, unspecified&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x31
comma
l_string|&quot;Quality of service unavailable&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x32
comma
l_string|&quot;Requested facility not subscribed&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x35
comma
l_string|&quot;Outgoing calls barred within CUG&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x37
comma
l_string|&quot;Incoming calls barred within CUG&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x39
comma
l_string|&quot;Bearer capability not authorized&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x3a
comma
l_string|&quot;Bearer capability not presently available&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x3e
comma
l_string|&quot;Inconsistency in designated outgoing access information and subscriber class &quot;
comma
l_string|&quot; &quot;
)brace
comma
(brace
l_int|0x3f
comma
l_string|&quot;Service or option not available, unspecified&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x41
comma
l_string|&quot;Bearer capability not implemented&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x42
comma
l_string|&quot;Channel type not implemented&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x43
comma
l_string|&quot;Requested facility not implemented&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x44
comma
l_string|&quot;Only restricted digital information bearer capability is available&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x4f
comma
l_string|&quot;Service or option not implemented&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x51
comma
l_string|&quot;Invalid call reference value&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x52
comma
l_string|&quot;Identified channel does not exist&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x53
comma
l_string|&quot;A suspended call exists, but this call identity does not&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x54
comma
l_string|&quot;Call identity in use&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x55
comma
l_string|&quot;No call suspended&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x56
comma
l_string|&quot;Call having the requested call identity has been cleared&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x57
comma
l_string|&quot;User not member of CUG&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x58
comma
l_string|&quot;Incompatible destination&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x5a
comma
l_string|&quot;Non-existent CUG&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x5b
comma
l_string|&quot;Invalid transit network selection&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x5f
comma
l_string|&quot;Invalid message, unspecified&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x60
comma
l_string|&quot;Mandatory information element is missing&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x61
comma
l_string|&quot;Message type non-existent or not implemented&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x62
comma
l_string|&quot;Message not compatible with call state or message type non-existent or not implemented &quot;
comma
l_string|&quot; &quot;
)brace
comma
(brace
l_int|0x63
comma
l_string|&quot;Information element/parameter non-existent or not implemented&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x64
comma
l_string|&quot;Invalid information element contents&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x65
comma
l_string|&quot;Message not compatible with call state&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x66
comma
l_string|&quot;Recovery on timer expiry&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x67
comma
l_string|&quot;Parameter non-existent or not implemented - passed on&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x6e
comma
l_string|&quot;Message with unrecognized parameter discarded&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x6f
comma
l_string|&quot;Protocol error, unspecified&quot;
comma
l_string|&quot;&quot;
)brace
comma
(brace
l_int|0x7f
comma
l_string|&quot;Interworking, unspecified&quot;
comma
l_string|&quot;&quot;
)brace
comma
)brace
suffix:semicolon
DECL|macro|CVSIZE
mdefine_line|#define CVSIZE sizeof(cvlist)/sizeof(struct CauseValue)
r_static
r_int
DECL|function|prcause
id|prcause
c_func
(paren
r_char
op_star
id|dest
comma
id|byte
op_star
id|p
)paren
(brace
id|byte
op_star
id|end
suffix:semicolon
r_char
op_star
id|dp
op_assign
id|dest
suffix:semicolon
r_int
id|i
comma
id|cause
suffix:semicolon
id|end
op_assign
id|p
op_plus
id|p
(braket
l_int|1
)braket
op_plus
l_int|1
suffix:semicolon
id|p
op_add_assign
l_int|2
suffix:semicolon
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;    coding &quot;
)paren
suffix:semicolon
id|dp
op_add_assign
id|prbits
c_func
(paren
id|dp
comma
op_star
id|p
comma
l_int|7
comma
l_int|2
)paren
suffix:semicolon
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot; location &quot;
)paren
suffix:semicolon
id|dp
op_add_assign
id|prbits
c_func
(paren
id|dp
comma
op_star
id|p
comma
l_int|4
comma
l_int|4
)paren
suffix:semicolon
op_star
id|dp
op_increment
op_assign
l_char|&squot;&bslash;n&squot;
suffix:semicolon
id|p
op_assign
id|skipext
c_func
(paren
id|p
)paren
suffix:semicolon
id|cause
op_assign
l_int|0x7f
op_amp
op_star
id|p
op_increment
suffix:semicolon
multiline_comment|/* locate cause value */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|CVSIZE
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|cvlist
(braket
id|i
)braket
dot
id|nr
op_eq
id|cause
)paren
r_break
suffix:semicolon
multiline_comment|/* display cause value if it exists */
r_if
c_cond
(paren
id|i
op_eq
id|CVSIZE
)paren
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;Unknown cause type %x!&bslash;n&quot;
comma
id|cause
)paren
suffix:semicolon
r_else
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;  cause value %x : %s &bslash;n&quot;
comma
id|cause
comma
id|cvlist
(braket
id|i
)braket
dot
id|edescr
)paren
suffix:semicolon
r_while
c_loop
(paren
op_logical_neg
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|p
OG
id|end
)paren
r_break
suffix:semicolon
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;    diag attribute %d &quot;
comma
op_star
id|p
op_increment
op_amp
l_int|0x7f
)paren
suffix:semicolon
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot; rej %d &quot;
comma
op_star
id|p
op_amp
l_int|0x7f
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|p
op_amp
l_int|0x80
)paren
(brace
op_star
id|dp
op_increment
op_assign
l_char|&squot;&bslash;n&squot;
suffix:semicolon
r_break
suffix:semicolon
)brace
r_else
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot; av %d&bslash;n&quot;
comma
(paren
op_star
op_increment
id|p
)paren
op_amp
l_int|0x7f
)paren
suffix:semicolon
)brace
r_return
(paren
id|dp
op_minus
id|dest
)paren
suffix:semicolon
)brace
r_static
DECL|variable|cause_1tr6
r_struct
id|MessageType
id|cause_1tr6
(braket
)braket
op_assign
(brace
(brace
id|CAUSE_InvCRef
comma
l_string|&quot;Invalid Call Reference&quot;
)brace
comma
(brace
id|CAUSE_BearerNotImpl
comma
l_string|&quot;Bearer Service Not Implemented&quot;
)brace
comma
(brace
id|CAUSE_CIDunknown
comma
l_string|&quot;Caller Identity unknown&quot;
)brace
comma
(brace
id|CAUSE_CIDinUse
comma
l_string|&quot;Caller Identity in Use&quot;
)brace
comma
(brace
id|CAUSE_NoChans
comma
l_string|&quot;No Channels available&quot;
)brace
comma
(brace
id|CAUSE_FacNotImpl
comma
l_string|&quot;Facility Not Implemented&quot;
)brace
comma
(brace
id|CAUSE_FacNotSubscr
comma
l_string|&quot;Facility Not Subscribed&quot;
)brace
comma
(brace
id|CAUSE_OutgoingBarred
comma
l_string|&quot;Outgoing calls barred&quot;
)brace
comma
(brace
id|CAUSE_UserAccessBusy
comma
l_string|&quot;User Access Busy&quot;
)brace
comma
(brace
id|CAUSE_NegativeGBG
comma
l_string|&quot;Negative GBG&quot;
)brace
comma
(brace
id|CAUSE_UnknownGBG
comma
l_string|&quot;Unknown  GBG&quot;
)brace
comma
(brace
id|CAUSE_NoSPVknown
comma
l_string|&quot;No SPV known&quot;
)brace
comma
(brace
id|CAUSE_DestNotObtain
comma
l_string|&quot;Destination not obtainable&quot;
)brace
comma
(brace
id|CAUSE_NumberChanged
comma
l_string|&quot;Number changed&quot;
)brace
comma
(brace
id|CAUSE_OutOfOrder
comma
l_string|&quot;Out Of Order&quot;
)brace
comma
(brace
id|CAUSE_NoUserResponse
comma
l_string|&quot;No User Response&quot;
)brace
comma
(brace
id|CAUSE_UserBusy
comma
l_string|&quot;User Busy&quot;
)brace
comma
(brace
id|CAUSE_IncomingBarred
comma
l_string|&quot;Incoming Barred&quot;
)brace
comma
(brace
id|CAUSE_CallRejected
comma
l_string|&quot;Call Rejected&quot;
)brace
comma
(brace
id|CAUSE_NetworkCongestion
comma
l_string|&quot;Network Congestion&quot;
)brace
comma
(brace
id|CAUSE_RemoteUser
comma
l_string|&quot;Remote User initiated&quot;
)brace
comma
(brace
id|CAUSE_LocalProcErr
comma
l_string|&quot;Local Procedure Error&quot;
)brace
comma
(brace
id|CAUSE_RemoteProcErr
comma
l_string|&quot;Remote Procedure Error&quot;
)brace
comma
(brace
id|CAUSE_RemoteUserSuspend
comma
l_string|&quot;Remote User Suspend&quot;
)brace
comma
(brace
id|CAUSE_RemoteUserResumed
comma
l_string|&quot;Remote User Resumed&quot;
)brace
comma
(brace
id|CAUSE_UserInfoDiscarded
comma
l_string|&quot;User Info Discarded&quot;
)brace
)brace
suffix:semicolon
DECL|variable|cause_1tr6_len
r_int
id|cause_1tr6_len
op_assign
(paren
r_sizeof
(paren
id|cause_1tr6
)paren
op_div
r_sizeof
(paren
r_struct
id|MessageType
)paren
)paren
suffix:semicolon
r_static
r_int
DECL|function|prcause_1tr6
id|prcause_1tr6
c_func
(paren
r_char
op_star
id|dest
comma
id|byte
op_star
id|p
)paren
(brace
r_char
op_star
id|dp
op_assign
id|dest
suffix:semicolon
r_int
id|i
comma
id|cause
suffix:semicolon
id|p
op_increment
suffix:semicolon
r_if
c_cond
(paren
l_int|0
op_eq
op_star
id|p
)paren
(brace
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;   OK (cause length=0)&bslash;n&quot;
)paren
suffix:semicolon
r_return
(paren
id|dp
op_minus
id|dest
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_star
id|p
OG
l_int|1
)paren
(brace
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;    coding &quot;
)paren
suffix:semicolon
id|dp
op_add_assign
id|prbits
c_func
(paren
id|dp
comma
id|p
(braket
l_int|2
)braket
comma
l_int|7
comma
l_int|2
)paren
suffix:semicolon
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot; location &quot;
)paren
suffix:semicolon
id|dp
op_add_assign
id|prbits
c_func
(paren
id|dp
comma
id|p
(braket
l_int|2
)braket
comma
l_int|4
comma
l_int|4
)paren
suffix:semicolon
op_star
id|dp
op_increment
op_assign
l_char|&squot;&bslash;n&squot;
suffix:semicolon
)brace
id|p
op_increment
suffix:semicolon
id|cause
op_assign
l_int|0x7f
op_amp
op_star
id|p
suffix:semicolon
multiline_comment|/* locate cause value */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|cause_1tr6_len
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|cause_1tr6
(braket
id|i
)braket
dot
id|nr
op_eq
id|cause
)paren
r_break
suffix:semicolon
multiline_comment|/* display cause value if it exists */
r_if
c_cond
(paren
id|i
op_eq
id|cause_1tr6_len
)paren
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;Unknown cause type %x!&bslash;n&quot;
comma
id|cause
)paren
suffix:semicolon
r_else
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;  cause value %x : %s &bslash;n&quot;
comma
id|cause
comma
id|cause_1tr6
(braket
id|i
)braket
dot
id|descr
)paren
suffix:semicolon
r_return
(paren
id|dp
op_minus
id|dest
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|prchident
id|prchident
c_func
(paren
r_char
op_star
id|dest
comma
id|byte
op_star
id|p
)paren
(brace
r_char
op_star
id|dp
op_assign
id|dest
suffix:semicolon
id|p
op_add_assign
l_int|2
suffix:semicolon
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;    octet 3 &quot;
)paren
suffix:semicolon
id|dp
op_add_assign
id|prbits
c_func
(paren
id|dp
comma
op_star
id|p
comma
l_int|8
comma
l_int|8
)paren
suffix:semicolon
op_star
id|dp
op_increment
op_assign
l_char|&squot;&bslash;n&squot;
suffix:semicolon
r_return
(paren
id|dp
op_minus
id|dest
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|prcalled
id|prcalled
c_func
(paren
r_char
op_star
id|dest
comma
id|byte
op_star
id|p
)paren
(brace
r_int
id|l
suffix:semicolon
r_char
op_star
id|dp
op_assign
id|dest
suffix:semicolon
id|p
op_increment
suffix:semicolon
id|l
op_assign
op_star
id|p
op_increment
op_minus
l_int|1
suffix:semicolon
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;    octet 3 &quot;
)paren
suffix:semicolon
id|dp
op_add_assign
id|prbits
c_func
(paren
id|dp
comma
op_star
id|p
op_increment
comma
l_int|8
comma
l_int|8
)paren
suffix:semicolon
op_star
id|dp
op_increment
op_assign
l_char|&squot;&bslash;n&squot;
suffix:semicolon
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;    number digits &quot;
)paren
suffix:semicolon
r_while
c_loop
(paren
id|l
op_decrement
)paren
op_star
id|dp
op_increment
op_assign
op_star
id|p
op_increment
suffix:semicolon
op_star
id|dp
op_increment
op_assign
l_char|&squot;&bslash;n&squot;
suffix:semicolon
r_return
(paren
id|dp
op_minus
id|dest
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|prcalling
id|prcalling
c_func
(paren
r_char
op_star
id|dest
comma
id|byte
op_star
id|p
)paren
(brace
r_int
id|l
suffix:semicolon
r_char
op_star
id|dp
op_assign
id|dest
suffix:semicolon
id|p
op_increment
suffix:semicolon
id|l
op_assign
op_star
id|p
op_increment
op_minus
l_int|1
suffix:semicolon
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;    octet 3 &quot;
)paren
suffix:semicolon
id|dp
op_add_assign
id|prbits
c_func
(paren
id|dp
comma
op_star
id|p
comma
l_int|8
comma
l_int|8
)paren
suffix:semicolon
op_star
id|dp
op_increment
op_assign
l_char|&squot;&bslash;n&squot;
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
op_star
id|p
op_amp
l_int|0x80
)paren
)paren
(brace
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;    octet 3a &quot;
)paren
suffix:semicolon
id|dp
op_add_assign
id|prbits
c_func
(paren
id|dp
comma
op_star
op_increment
id|p
comma
l_int|8
comma
l_int|8
)paren
suffix:semicolon
op_star
id|dp
op_increment
op_assign
l_char|&squot;&bslash;n&squot;
suffix:semicolon
id|l
op_decrement
suffix:semicolon
)brace
suffix:semicolon
id|p
op_increment
suffix:semicolon
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;    number digits &quot;
)paren
suffix:semicolon
r_while
c_loop
(paren
id|l
op_decrement
)paren
op_star
id|dp
op_increment
op_assign
op_star
id|p
op_increment
suffix:semicolon
op_star
id|dp
op_increment
op_assign
l_char|&squot;&bslash;n&squot;
suffix:semicolon
r_return
(paren
id|dp
op_minus
id|dest
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|prbearer
id|prbearer
c_func
(paren
r_char
op_star
id|dest
comma
id|byte
op_star
id|p
)paren
(brace
r_char
op_star
id|dp
op_assign
id|dest
comma
id|ch
suffix:semicolon
id|p
op_add_assign
l_int|2
suffix:semicolon
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;    octet 3  &quot;
)paren
suffix:semicolon
id|dp
op_add_assign
id|prbits
c_func
(paren
id|dp
comma
op_star
id|p
op_increment
comma
l_int|8
comma
l_int|8
)paren
suffix:semicolon
op_star
id|dp
op_increment
op_assign
l_char|&squot;&bslash;n&squot;
suffix:semicolon
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;    octet 4  &quot;
)paren
suffix:semicolon
id|dp
op_add_assign
id|prbits
c_func
(paren
id|dp
comma
op_star
id|p
comma
l_int|8
comma
l_int|8
)paren
suffix:semicolon
op_star
id|dp
op_increment
op_assign
l_char|&squot;&bslash;n&squot;
suffix:semicolon
r_if
c_cond
(paren
(paren
op_star
id|p
op_increment
op_amp
l_int|0x1f
)paren
op_eq
l_int|0x18
)paren
(brace
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;    octet 4.1 &quot;
)paren
suffix:semicolon
id|dp
op_add_assign
id|prbits
c_func
(paren
id|dp
comma
op_star
id|p
op_increment
comma
l_int|8
comma
l_int|8
)paren
suffix:semicolon
op_star
id|dp
op_increment
op_assign
l_char|&squot;&bslash;n&squot;
suffix:semicolon
)brace
multiline_comment|/* check for user information layer 1 */
r_if
c_cond
(paren
(paren
op_star
id|p
op_amp
l_int|0x60
)paren
op_eq
l_int|0x20
)paren
(brace
id|ch
op_assign
l_char|&squot; &squot;
suffix:semicolon
r_do
(brace
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;    octet 5%c &quot;
comma
id|ch
)paren
suffix:semicolon
id|dp
op_add_assign
id|prbits
c_func
(paren
id|dp
comma
op_star
id|p
comma
l_int|8
comma
l_int|8
)paren
suffix:semicolon
op_star
id|dp
op_increment
op_assign
l_char|&squot;&bslash;n&squot;
suffix:semicolon
r_if
c_cond
(paren
id|ch
op_eq
l_char|&squot; &squot;
)paren
id|ch
op_assign
l_char|&squot;a&squot;
suffix:semicolon
r_else
id|ch
op_increment
suffix:semicolon
)brace
r_while
c_loop
(paren
op_logical_neg
(paren
op_star
id|p
op_increment
op_amp
l_int|0x80
)paren
)paren
suffix:semicolon
)brace
multiline_comment|/* check for user information layer 2 */
r_if
c_cond
(paren
(paren
op_star
id|p
op_amp
l_int|0x60
)paren
op_eq
l_int|0x40
)paren
(brace
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;    octet 6  &quot;
)paren
suffix:semicolon
id|dp
op_add_assign
id|prbits
c_func
(paren
id|dp
comma
op_star
id|p
op_increment
comma
l_int|8
comma
l_int|8
)paren
suffix:semicolon
op_star
id|dp
op_increment
op_assign
l_char|&squot;&bslash;n&squot;
suffix:semicolon
)brace
multiline_comment|/* check for user information layer 3 */
r_if
c_cond
(paren
(paren
op_star
id|p
op_amp
l_int|0x60
)paren
op_eq
l_int|0x60
)paren
(brace
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;    octet 7  &quot;
)paren
suffix:semicolon
id|dp
op_add_assign
id|prbits
c_func
(paren
id|dp
comma
op_star
id|p
op_increment
comma
l_int|8
comma
l_int|8
)paren
suffix:semicolon
op_star
id|dp
op_increment
op_assign
l_char|&squot;&bslash;n&squot;
suffix:semicolon
)brace
r_return
(paren
id|dp
op_minus
id|dest
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|general
id|general
c_func
(paren
r_char
op_star
id|dest
comma
id|byte
op_star
id|p
)paren
(brace
r_char
op_star
id|dp
op_assign
id|dest
suffix:semicolon
r_char
id|ch
op_assign
l_char|&squot; &squot;
suffix:semicolon
r_int
id|l
comma
id|octet
op_assign
l_int|3
suffix:semicolon
id|p
op_increment
suffix:semicolon
id|l
op_assign
op_star
id|p
op_increment
suffix:semicolon
multiline_comment|/* Iterate over all octets in the information element */
r_while
c_loop
(paren
id|l
op_decrement
)paren
(brace
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;    octet %d%c &quot;
comma
id|octet
comma
id|ch
)paren
suffix:semicolon
id|dp
op_add_assign
id|prbits
c_func
(paren
id|dp
comma
op_star
id|p
op_increment
comma
l_int|8
comma
l_int|8
)paren
suffix:semicolon
op_star
id|dp
op_increment
op_assign
l_char|&squot;&bslash;n&squot;
suffix:semicolon
multiline_comment|/* last octet in group? */
r_if
c_cond
(paren
op_star
id|p
op_amp
l_int|0x80
)paren
(brace
id|octet
op_increment
suffix:semicolon
id|ch
op_assign
l_char|&squot; &squot;
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|ch
op_eq
l_char|&squot; &squot;
)paren
id|ch
op_assign
l_char|&squot;a&squot;
suffix:semicolon
r_else
id|ch
op_increment
suffix:semicolon
)brace
r_return
(paren
id|dp
op_minus
id|dest
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|prcharge
id|prcharge
c_func
(paren
r_char
op_star
id|dest
comma
id|byte
op_star
id|p
)paren
(brace
r_char
op_star
id|dp
op_assign
id|dest
suffix:semicolon
r_int
id|l
suffix:semicolon
id|p
op_increment
suffix:semicolon
id|l
op_assign
op_star
id|p
op_increment
op_minus
l_int|1
suffix:semicolon
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;    GEA &quot;
)paren
suffix:semicolon
id|dp
op_add_assign
id|prbits
c_func
(paren
id|dp
comma
op_star
id|p
op_increment
comma
l_int|8
comma
l_int|8
)paren
suffix:semicolon
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;  Anzahl: &quot;
)paren
suffix:semicolon
multiline_comment|/* Iterate over all octets in the * information element */
r_while
c_loop
(paren
id|l
op_decrement
)paren
op_star
id|dp
op_increment
op_assign
op_star
id|p
op_increment
suffix:semicolon
op_star
id|dp
op_increment
op_assign
l_char|&squot;&bslash;n&squot;
suffix:semicolon
r_return
(paren
id|dp
op_minus
id|dest
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|prtext
id|prtext
c_func
(paren
r_char
op_star
id|dest
comma
id|byte
op_star
id|p
)paren
(brace
r_char
op_star
id|dp
op_assign
id|dest
suffix:semicolon
r_int
id|l
suffix:semicolon
id|p
op_increment
suffix:semicolon
id|l
op_assign
op_star
id|p
op_increment
suffix:semicolon
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;    &quot;
)paren
suffix:semicolon
multiline_comment|/* Iterate over all octets in the * information element */
r_while
c_loop
(paren
id|l
op_decrement
)paren
op_star
id|dp
op_increment
op_assign
op_star
id|p
op_increment
suffix:semicolon
op_star
id|dp
op_increment
op_assign
l_char|&squot;&bslash;n&squot;
suffix:semicolon
r_return
(paren
id|dp
op_minus
id|dest
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|display
id|display
c_func
(paren
r_char
op_star
id|dest
comma
id|byte
op_star
id|p
)paren
(brace
r_char
op_star
id|dp
op_assign
id|dest
suffix:semicolon
r_char
id|ch
op_assign
l_char|&squot; &squot;
suffix:semicolon
r_int
id|l
comma
id|octet
op_assign
l_int|3
suffix:semicolon
id|p
op_increment
suffix:semicolon
id|l
op_assign
op_star
id|p
op_increment
suffix:semicolon
multiline_comment|/* Iterate over all octets in the * display-information element */
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;   &bslash;&quot;&quot;
)paren
suffix:semicolon
r_while
c_loop
(paren
id|l
op_decrement
)paren
(brace
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;%c&quot;
comma
op_star
id|p
op_increment
)paren
suffix:semicolon
multiline_comment|/* last octet in group? */
r_if
c_cond
(paren
op_star
id|p
op_amp
l_int|0x80
)paren
(brace
id|octet
op_increment
suffix:semicolon
id|ch
op_assign
l_char|&squot; &squot;
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|ch
op_eq
l_char|&squot; &squot;
)paren
id|ch
op_assign
l_char|&squot;a&squot;
suffix:semicolon
r_else
id|ch
op_increment
suffix:semicolon
)brace
op_star
id|dp
op_increment
op_assign
l_char|&squot;&bslash;&quot;&squot;
suffix:semicolon
op_star
id|dp
op_increment
op_assign
l_char|&squot;&bslash;n&squot;
suffix:semicolon
r_return
(paren
id|dp
op_minus
id|dest
)paren
suffix:semicolon
)brace
r_int
DECL|function|prfacility
id|prfacility
c_func
(paren
r_char
op_star
id|dest
comma
id|byte
op_star
id|p
)paren
(brace
r_char
op_star
id|dp
op_assign
id|dest
suffix:semicolon
r_int
id|l
comma
id|l2
suffix:semicolon
id|p
op_increment
suffix:semicolon
id|l
op_assign
op_star
id|p
op_increment
suffix:semicolon
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;    octet 3 &quot;
)paren
suffix:semicolon
id|dp
op_add_assign
id|prbits
c_func
(paren
id|dp
comma
op_star
id|p
op_increment
comma
l_int|8
comma
l_int|8
)paren
suffix:semicolon
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|l
op_sub_assign
l_int|1
suffix:semicolon
r_while
c_loop
(paren
id|l
OG
l_int|0
)paren
(brace
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;   octet 4 &quot;
)paren
suffix:semicolon
id|dp
op_add_assign
id|prbits
c_func
(paren
id|dp
comma
op_star
id|p
op_increment
comma
l_int|8
comma
l_int|8
)paren
suffix:semicolon
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;   octet 5 %d&bslash;n&quot;
comma
id|l2
op_assign
op_star
id|p
op_increment
op_amp
l_int|0x7f
)paren
suffix:semicolon
id|l
op_sub_assign
l_int|2
suffix:semicolon
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;   contents &quot;
)paren
suffix:semicolon
r_while
c_loop
(paren
id|l2
op_decrement
)paren
(brace
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;%2x &quot;
comma
op_star
id|p
op_increment
)paren
suffix:semicolon
id|l
op_decrement
suffix:semicolon
)brace
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_return
(paren
id|dp
op_minus
id|dest
)paren
suffix:semicolon
)brace
r_static
DECL|struct|InformationElement
r_struct
id|InformationElement
(brace
DECL|member|nr
id|byte
id|nr
suffix:semicolon
DECL|member|descr
r_char
op_star
id|descr
suffix:semicolon
DECL|member|f
r_int
(paren
op_star
id|f
)paren
(paren
r_char
op_star
comma
id|byte
op_star
)paren
suffix:semicolon
DECL|variable|ielist
)brace
id|ielist
(braket
)braket
op_assign
(brace
(brace
l_int|0x00
comma
l_string|&quot;Segmented message&quot;
comma
id|general
)brace
comma
(brace
l_int|0x04
comma
l_string|&quot;Bearer capability&quot;
comma
id|prbearer
)brace
comma
(brace
l_int|0x08
comma
l_string|&quot;Cause&quot;
comma
id|prcause
)brace
comma
(brace
l_int|0x10
comma
l_string|&quot;Call identity&quot;
comma
id|general
)brace
comma
(brace
l_int|0x14
comma
l_string|&quot;Call state&quot;
comma
id|general
)brace
comma
(brace
l_int|0x18
comma
l_string|&quot;Channel identification&quot;
comma
id|prchident
)brace
comma
(brace
l_int|0x1c
comma
l_string|&quot;Facility&quot;
comma
id|prfacility
)brace
comma
(brace
l_int|0x1e
comma
l_string|&quot;Progress indicator&quot;
comma
id|general
)brace
comma
(brace
l_int|0x20
comma
l_string|&quot;Network-specific facilities&quot;
comma
id|general
)brace
comma
(brace
l_int|0x27
comma
l_string|&quot;Notification indicator&quot;
comma
id|general
)brace
comma
(brace
l_int|0x28
comma
l_string|&quot;Display&quot;
comma
id|display
)brace
comma
(brace
l_int|0x29
comma
l_string|&quot;Date/Time&quot;
comma
id|general
)brace
comma
(brace
l_int|0x2c
comma
l_string|&quot;Keypad facility&quot;
comma
id|general
)brace
comma
(brace
l_int|0x34
comma
l_string|&quot;Signal&quot;
comma
id|general
)brace
comma
(brace
l_int|0x40
comma
l_string|&quot;Information rate&quot;
comma
id|general
)brace
comma
(brace
l_int|0x42
comma
l_string|&quot;End-to-end delay&quot;
comma
id|general
)brace
comma
(brace
l_int|0x43
comma
l_string|&quot;Transit delay selection and indication&quot;
comma
id|general
)brace
comma
(brace
l_int|0x44
comma
l_string|&quot;Packet layer binary parameters&quot;
comma
id|general
)brace
comma
(brace
l_int|0x45
comma
l_string|&quot;Packet layer window size&quot;
comma
id|general
)brace
comma
(brace
l_int|0x46
comma
l_string|&quot;Packet size&quot;
comma
id|general
)brace
comma
(brace
l_int|0x47
comma
l_string|&quot;Closed user group&quot;
comma
id|general
)brace
comma
(brace
l_int|0x4a
comma
l_string|&quot;Reverse charge indication&quot;
comma
id|general
)brace
comma
(brace
l_int|0x6c
comma
l_string|&quot;Calling party number&quot;
comma
id|prcalling
)brace
comma
(brace
l_int|0x6d
comma
l_string|&quot;Calling party subaddress&quot;
comma
id|general
)brace
comma
(brace
l_int|0x70
comma
l_string|&quot;Called party number&quot;
comma
id|prcalled
)brace
comma
(brace
l_int|0x71
comma
l_string|&quot;Called party subaddress&quot;
comma
id|general
)brace
comma
(brace
l_int|0x74
comma
l_string|&quot;Redirecting number&quot;
comma
id|general
)brace
comma
(brace
l_int|0x78
comma
l_string|&quot;Transit network selection&quot;
comma
id|general
)brace
comma
(brace
l_int|0x79
comma
l_string|&quot;Restart indicator&quot;
comma
id|general
)brace
comma
(brace
l_int|0x7c
comma
l_string|&quot;Low layer compatibility&quot;
comma
id|general
)brace
comma
(brace
l_int|0x7d
comma
l_string|&quot;High layer compatibility&quot;
comma
id|general
)brace
comma
(brace
l_int|0x7e
comma
l_string|&quot;User-user&quot;
comma
id|general
)brace
comma
(brace
l_int|0x7f
comma
l_string|&quot;Escape for extension&quot;
comma
id|general
)brace
comma
)brace
suffix:semicolon
DECL|macro|IESIZE
mdefine_line|#define IESIZE sizeof(ielist)/sizeof(struct InformationElement)
DECL|variable|we_0
r_static
r_struct
id|InformationElement
id|we_0
(braket
)braket
op_assign
(brace
(brace
id|WE0_cause
comma
l_string|&quot;Cause&quot;
comma
id|prcause_1tr6
)brace
comma
(brace
id|WE0_connAddr
comma
l_string|&quot;Connecting Address&quot;
comma
id|prcalled
)brace
comma
(brace
id|WE0_callID
comma
l_string|&quot;Call IDentity&quot;
comma
id|general
)brace
comma
(brace
id|WE0_chanID
comma
l_string|&quot;Channel IDentity&quot;
comma
id|general
)brace
comma
(brace
id|WE0_netSpecFac
comma
l_string|&quot;Network Specific Facility&quot;
comma
id|general
)brace
comma
(brace
id|WE0_display
comma
l_string|&quot;Display&quot;
comma
id|general
)brace
comma
(brace
id|WE0_keypad
comma
l_string|&quot;Keypad&quot;
comma
id|general
)brace
comma
(brace
id|WE0_origAddr
comma
l_string|&quot;Origination Address&quot;
comma
id|prcalled
)brace
comma
(brace
id|WE0_destAddr
comma
l_string|&quot;Destination Address&quot;
comma
id|prcalled
)brace
comma
(brace
id|WE0_userInfo
comma
l_string|&quot;User Info&quot;
comma
id|general
)brace
)brace
suffix:semicolon
DECL|variable|we_0_len
r_static
r_int
id|we_0_len
op_assign
(paren
r_sizeof
(paren
id|we_0
)paren
op_div
r_sizeof
(paren
r_struct
id|InformationElement
)paren
)paren
suffix:semicolon
DECL|variable|we_6
r_static
r_struct
id|InformationElement
id|we_6
(braket
)braket
op_assign
(brace
(brace
id|WE6_serviceInd
comma
l_string|&quot;Service Indicator&quot;
comma
id|general
)brace
comma
(brace
id|WE6_chargingInfo
comma
l_string|&quot;Charging Information&quot;
comma
id|prcharge
)brace
comma
(brace
id|WE6_date
comma
l_string|&quot;Date&quot;
comma
id|prtext
)brace
comma
(brace
id|WE6_facSelect
comma
l_string|&quot;Facility Select&quot;
comma
id|general
)brace
comma
(brace
id|WE6_facStatus
comma
l_string|&quot;Facility Status&quot;
comma
id|general
)brace
comma
(brace
id|WE6_statusCalled
comma
l_string|&quot;Status Called&quot;
comma
id|general
)brace
comma
(brace
id|WE6_addTransAttr
comma
l_string|&quot;Additional Transmission Attributes&quot;
comma
id|general
)brace
)brace
suffix:semicolon
DECL|variable|we_6_len
r_static
r_int
id|we_6_len
op_assign
(paren
r_sizeof
(paren
id|we_6
)paren
op_div
r_sizeof
(paren
r_struct
id|InformationElement
)paren
)paren
suffix:semicolon
r_void
DECL|function|dlogframe
id|dlogframe
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|sp
comma
id|byte
op_star
id|buf
comma
r_int
id|size
comma
r_char
op_star
id|comment
)paren
(brace
id|byte
op_star
id|bend
op_assign
id|buf
op_plus
id|size
suffix:semicolon
r_char
op_star
id|dp
suffix:semicolon
r_int
id|i
comma
id|cs
op_assign
l_int|0
comma
id|cs_old
op_assign
l_int|0
comma
id|cs_fest
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* display header */
id|dp
op_assign
id|sp-&gt;dlogspace
suffix:semicolon
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;%s&bslash;n&quot;
comma
id|comment
)paren
suffix:semicolon
(brace
id|byte
op_star
id|p
op_assign
id|buf
suffix:semicolon
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;hex: &quot;
)paren
suffix:semicolon
r_while
c_loop
(paren
id|p
OL
id|bend
)paren
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;%02x &quot;
comma
op_star
id|p
op_increment
)paren
suffix:semicolon
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|teles_putstatus
c_func
(paren
id|sp-&gt;dlogspace
)paren
suffix:semicolon
id|dp
op_assign
id|sp-&gt;dlogspace
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
l_int|0xfe
op_amp
id|buf
(braket
l_int|0
)braket
)paren
op_eq
id|PROTO_DIS_N0
)paren
(brace
multiline_comment|/* 1TR6 */
multiline_comment|/* locate message type */
r_if
c_cond
(paren
id|buf
(braket
l_int|0
)braket
op_eq
id|PROTO_DIS_N0
)paren
(brace
multiline_comment|/* N0 */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|mt_n0_len
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|mt_n0
(braket
id|i
)braket
dot
id|nr
op_eq
id|buf
(braket
l_int|3
)braket
)paren
r_break
suffix:semicolon
multiline_comment|/* display message type iff it exists */
r_if
c_cond
(paren
id|i
op_eq
id|mt_n0_len
)paren
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;Unknown message type N0 %x!&bslash;n&quot;
comma
id|buf
(braket
l_int|3
)braket
)paren
suffix:semicolon
r_else
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;call reference %d size %d message type %s&bslash;n&quot;
comma
id|buf
(braket
l_int|2
)braket
comma
id|size
comma
id|mt_n0
(braket
id|i
)braket
dot
id|descr
)paren
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/* N1 */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|mt_n1_len
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|mt_n1
(braket
id|i
)braket
dot
id|nr
op_eq
id|buf
(braket
l_int|3
)braket
)paren
r_break
suffix:semicolon
multiline_comment|/* display message type iff it exists */
r_if
c_cond
(paren
id|i
op_eq
id|mt_n1_len
)paren
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;Unknown message type N1 %x!&bslash;n&quot;
comma
id|buf
(braket
l_int|3
)braket
)paren
suffix:semicolon
r_else
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;call reference %d size %d message type %s&bslash;n&quot;
comma
id|buf
(braket
l_int|2
)braket
comma
id|size
comma
id|mt_n1
(braket
id|i
)braket
dot
id|descr
)paren
suffix:semicolon
)brace
multiline_comment|/* display each information element */
id|buf
op_add_assign
l_int|4
suffix:semicolon
r_while
c_loop
(paren
id|buf
OL
id|bend
)paren
(brace
multiline_comment|/* Is it a single octet information element? */
r_if
c_cond
(paren
op_star
id|buf
op_amp
l_int|0x80
)paren
(brace
r_switch
c_cond
(paren
(paren
op_star
id|buf
op_rshift
l_int|4
)paren
op_amp
l_int|7
)paren
(brace
r_case
l_int|1
suffix:colon
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;  Shift %x&bslash;n&quot;
comma
op_star
id|buf
op_amp
l_int|0xf
)paren
suffix:semicolon
id|cs_old
op_assign
id|cs
suffix:semicolon
id|cs
op_assign
op_star
id|buf
op_amp
l_int|7
suffix:semicolon
id|cs_fest
op_assign
op_star
id|buf
op_amp
l_int|8
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;  Congestion level %x&bslash;n&quot;
comma
op_star
id|buf
op_amp
l_int|0xf
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
r_if
c_cond
(paren
op_star
id|buf
op_eq
l_int|0xa0
)paren
(brace
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;  More data&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
op_star
id|buf
op_eq
l_int|0xa1
)paren
(brace
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;  Sending complete&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
multiline_comment|/* fall through */
r_default
suffix:colon
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;  Reserved %x&bslash;n&quot;
comma
op_star
id|buf
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|buf
op_increment
suffix:semicolon
r_continue
suffix:semicolon
)brace
multiline_comment|/* No, locate it in the table */
r_if
c_cond
(paren
id|cs
op_eq
l_int|0
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|we_0_len
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
op_star
id|buf
op_eq
id|we_0
(braket
id|i
)braket
dot
id|nr
)paren
r_break
suffix:semicolon
multiline_comment|/* When found, give appropriate msg */
r_if
c_cond
(paren
id|i
op_ne
id|we_0_len
)paren
(brace
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;  %s&bslash;n&quot;
comma
id|we_0
(braket
id|i
)braket
dot
id|descr
)paren
suffix:semicolon
id|dp
op_add_assign
id|we_0
(braket
id|i
)braket
dot
id|f
c_func
(paren
id|dp
comma
id|buf
)paren
suffix:semicolon
)brace
r_else
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;  Codeset %d attribute %x attribute size %d&bslash;n&quot;
comma
id|cs
comma
op_star
id|buf
comma
id|buf
(braket
l_int|1
)braket
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|cs
op_eq
l_int|6
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|we_6_len
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
op_star
id|buf
op_eq
id|we_6
(braket
id|i
)braket
dot
id|nr
)paren
r_break
suffix:semicolon
multiline_comment|/* When found, give appropriate msg */
r_if
c_cond
(paren
id|i
op_ne
id|we_6_len
)paren
(brace
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;  %s&bslash;n&quot;
comma
id|we_6
(braket
id|i
)braket
dot
id|descr
)paren
suffix:semicolon
id|dp
op_add_assign
id|we_6
(braket
id|i
)braket
dot
id|f
c_func
(paren
id|dp
comma
id|buf
)paren
suffix:semicolon
)brace
r_else
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;  Codeset %d attribute %x attribute size %d&bslash;n&quot;
comma
id|cs
comma
op_star
id|buf
comma
id|buf
(braket
l_int|1
)braket
)paren
suffix:semicolon
)brace
r_else
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;  Unknown Codeset %d attribute %x attribute size %d&bslash;n&quot;
comma
id|cs
comma
op_star
id|buf
comma
id|buf
(braket
l_int|1
)braket
)paren
suffix:semicolon
multiline_comment|/* Skip to next element */
r_if
c_cond
(paren
id|cs_fest
op_eq
l_int|8
)paren
(brace
id|cs
op_assign
id|cs_old
suffix:semicolon
id|cs_old
op_assign
l_int|0
suffix:semicolon
id|cs_fest
op_assign
l_int|0
suffix:semicolon
)brace
id|buf
op_add_assign
id|buf
(braket
l_int|1
)braket
op_plus
l_int|2
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|buf
(braket
l_int|0
)braket
op_eq
id|PROTO_EURO
)paren
(brace
multiline_comment|/* EURO */
multiline_comment|/* locate message type */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|MTSIZE
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|mtlist
(braket
id|i
)braket
dot
id|nr
op_eq
id|buf
(braket
l_int|3
)braket
)paren
r_break
suffix:semicolon
multiline_comment|/* display message type iff it exists */
r_if
c_cond
(paren
id|i
op_eq
id|MTSIZE
)paren
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;Unknown message type %x!&bslash;n&quot;
comma
id|buf
(braket
l_int|3
)braket
)paren
suffix:semicolon
r_else
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;call reference %d size %d message type %s&bslash;n&quot;
comma
id|buf
(braket
l_int|2
)braket
comma
id|size
comma
id|mtlist
(braket
id|i
)braket
dot
id|descr
)paren
suffix:semicolon
multiline_comment|/* display each information element */
id|buf
op_add_assign
l_int|4
suffix:semicolon
r_while
c_loop
(paren
id|buf
OL
id|bend
)paren
(brace
multiline_comment|/* Is it a single octet information element? */
r_if
c_cond
(paren
op_star
id|buf
op_amp
l_int|0x80
)paren
(brace
r_switch
c_cond
(paren
(paren
op_star
id|buf
op_rshift
l_int|4
)paren
op_amp
l_int|7
)paren
(brace
r_case
l_int|1
suffix:colon
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;  Shift %x&bslash;n&quot;
comma
op_star
id|buf
op_amp
l_int|0xf
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;  Congestion level %x&bslash;n&quot;
comma
op_star
id|buf
op_amp
l_int|0xf
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;  Repeat indicator %x&bslash;n&quot;
comma
op_star
id|buf
op_amp
l_int|0xf
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
r_if
c_cond
(paren
op_star
id|buf
op_eq
l_int|0xa0
)paren
(brace
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;  More data&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
op_star
id|buf
op_eq
l_int|0xa1
)paren
(brace
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;  Sending complete&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
multiline_comment|/* fall through */
r_default
suffix:colon
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;  Reserved %x&bslash;n&quot;
comma
op_star
id|buf
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|buf
op_increment
suffix:semicolon
r_continue
suffix:semicolon
)brace
multiline_comment|/* No, locate it in the table */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|IESIZE
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
op_star
id|buf
op_eq
id|ielist
(braket
id|i
)braket
dot
id|nr
)paren
r_break
suffix:semicolon
multiline_comment|/* When not found, give appropriate msg */
r_if
c_cond
(paren
id|i
op_ne
id|IESIZE
)paren
(brace
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;  %s&bslash;n&quot;
comma
id|ielist
(braket
id|i
)braket
dot
id|descr
)paren
suffix:semicolon
id|dp
op_add_assign
id|ielist
(braket
id|i
)braket
dot
id|f
c_func
(paren
id|dp
comma
id|buf
)paren
suffix:semicolon
)brace
r_else
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;  attribute %x attribute size %d&bslash;n&quot;
comma
op_star
id|buf
comma
id|buf
(braket
l_int|1
)braket
)paren
suffix:semicolon
multiline_comment|/* Skip to next element */
id|buf
op_add_assign
id|buf
(braket
l_int|1
)braket
op_plus
l_int|2
suffix:semicolon
)brace
)brace
r_else
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;Unnown frame type %.2x, ignored&bslash;n&quot;
comma
id|buf
(braket
l_int|0
)braket
)paren
suffix:semicolon
id|dp
op_add_assign
id|sprintf
c_func
(paren
id|dp
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|teles_putstatus
c_func
(paren
id|sp-&gt;dlogspace
)paren
suffix:semicolon
)brace
eof
