multiline_comment|/*&n; * card.c     low level stuff for the Teles S0 isdn card&n; * &n; * Author     Jan den Ouden&n; * &n; * &n; * &n; * Changelog:&n; * &n; * Beat Doebeli         log all D channel traffic&n; * &n; */
DECL|macro|__NO_VERSION__
mdefine_line|#define __NO_VERSION__
macro_line|#include &quot;teles.h&quot;
DECL|macro|INCLUDE_INLINE_FUNCS
mdefine_line|#define INCLUDE_INLINE_FUNCS
macro_line|#include &lt;linux/tqueue.h&gt;
macro_line|#include &lt;linux/interrupt.h&gt;
DECL|macro|DCHAN_VERBOSE
macro_line|#undef DCHAN_VERBOSE
r_extern
r_void
id|tei_handler
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
id|byte
id|pr
comma
r_struct
id|BufHeader
op_star
id|ibh
)paren
suffix:semicolon
r_extern
r_struct
id|IsdnCard
id|cards
(braket
)braket
suffix:semicolon
r_extern
r_int
id|nrcards
suffix:semicolon
DECL|macro|byteout
mdefine_line|#define byteout(addr,val) outb_p(val,addr)
DECL|macro|bytein
mdefine_line|#define bytein(addr) inb_p(addr)
r_static
r_inline
id|byte
DECL|function|readisac_0
id|readisac_0
c_func
(paren
id|byte
op_star
id|cardm
comma
id|byte
id|offset
)paren
(brace
r_return
op_star
(paren
id|byte
op_star
)paren
(paren
id|cardm
op_plus
l_int|0x100
op_plus
(paren
(paren
id|offset
op_amp
l_int|1
)paren
ques
c_cond
l_int|0x1ff
suffix:colon
l_int|0
)paren
op_plus
id|offset
)paren
suffix:semicolon
)brace
r_static
r_inline
id|byte
DECL|function|readisac_3
id|readisac_3
c_func
(paren
r_int
id|iobase
comma
id|byte
id|offset
)paren
(brace
r_return
(paren
id|bytein
c_func
(paren
id|iobase
op_minus
l_int|0x420
op_plus
id|offset
)paren
)paren
suffix:semicolon
)brace
DECL|macro|READISAC
mdefine_line|#define READISAC(mbase,ibase,ofs) &bslash;&n;        ((mbase)?readisac_0(mbase,ofs):readisac_3(ibase,ofs))
r_static
r_inline
r_void
DECL|function|writeisac_0
id|writeisac_0
c_func
(paren
id|byte
op_star
id|cardm
comma
id|byte
id|offset
comma
id|byte
id|value
)paren
(brace
op_star
(paren
id|byte
op_star
)paren
(paren
id|cardm
op_plus
l_int|0x100
op_plus
(paren
(paren
id|offset
op_amp
l_int|1
)paren
ques
c_cond
l_int|0x1ff
suffix:colon
l_int|0
)paren
op_plus
id|offset
)paren
op_assign
id|value
suffix:semicolon
)brace
r_static
r_inline
r_void
DECL|function|writeisac_3
id|writeisac_3
c_func
(paren
r_int
id|iobase
comma
id|byte
id|offset
comma
id|byte
id|value
)paren
(brace
id|byteout
c_func
(paren
id|iobase
op_minus
l_int|0x420
op_plus
id|offset
comma
id|value
)paren
suffix:semicolon
)brace
DECL|macro|WRITEISAC
mdefine_line|#define WRITEISAC(mbase,ibase,ofs,val) &bslash;&n;        ((mbase)?writeisac_0(mbase,ofs,val):writeisac_3(ibase,ofs,val))
r_static
r_inline
r_void
DECL|function|readisac_s
id|readisac_s
c_func
(paren
r_int
id|iobase
comma
id|byte
id|offset
comma
id|byte
op_star
id|dest
comma
r_int
id|count
)paren
(brace
id|insb
c_func
(paren
id|iobase
op_minus
l_int|0x420
op_plus
id|offset
comma
id|dest
comma
id|count
)paren
suffix:semicolon
)brace
r_static
r_inline
r_void
DECL|function|writeisac_s
id|writeisac_s
c_func
(paren
r_int
id|iobase
comma
id|byte
id|offset
comma
id|byte
op_star
id|src
comma
r_int
id|count
)paren
(brace
id|outsb
c_func
(paren
id|iobase
op_minus
l_int|0x420
op_plus
id|offset
comma
id|src
comma
id|count
)paren
suffix:semicolon
)brace
r_static
r_inline
id|byte
DECL|function|readhscx_0
id|readhscx_0
c_func
(paren
id|byte
op_star
id|base
comma
id|byte
id|hscx
comma
id|byte
id|offset
)paren
(brace
r_return
op_star
(paren
id|byte
op_star
)paren
(paren
id|base
op_plus
l_int|0x180
op_plus
(paren
(paren
id|offset
op_amp
l_int|1
)paren
ques
c_cond
l_int|0x1FF
suffix:colon
l_int|0
)paren
op_plus
(paren
(paren
id|hscx
op_amp
l_int|1
)paren
ques
c_cond
l_int|0x40
suffix:colon
l_int|0
)paren
op_plus
id|offset
)paren
suffix:semicolon
)brace
r_static
r_inline
id|byte
DECL|function|readhscx_3
id|readhscx_3
c_func
(paren
r_int
id|iobase
comma
id|byte
id|hscx
comma
id|byte
id|offset
)paren
(brace
r_return
(paren
id|bytein
c_func
(paren
id|iobase
op_minus
(paren
id|hscx
ques
c_cond
l_int|0x820
suffix:colon
l_int|0xc20
)paren
op_plus
id|offset
)paren
)paren
suffix:semicolon
)brace
DECL|macro|READHSCX
mdefine_line|#define READHSCX(mbase,ibase,hscx,ofs) &bslash;&n;        ((mbase)?readhscx_0(mbase,hscx,ofs):readhscx_3(ibase,hscx,ofs))
r_static
r_inline
r_void
DECL|function|writehscx_0
id|writehscx_0
c_func
(paren
id|byte
op_star
id|base
comma
id|byte
id|hscx
comma
id|byte
id|offset
comma
id|byte
id|data
)paren
(brace
op_star
(paren
id|byte
op_star
)paren
(paren
id|base
op_plus
l_int|0x180
op_plus
(paren
(paren
id|offset
op_amp
l_int|1
)paren
ques
c_cond
l_int|0x1FF
suffix:colon
l_int|0
)paren
op_plus
(paren
(paren
id|hscx
op_amp
l_int|1
)paren
ques
c_cond
l_int|0x40
suffix:colon
l_int|0
)paren
op_plus
id|offset
)paren
op_assign
id|data
suffix:semicolon
)brace
r_static
r_inline
r_void
DECL|function|writehscx_3
id|writehscx_3
c_func
(paren
r_int
id|iobase
comma
id|byte
id|hscx
comma
id|byte
id|offset
comma
id|byte
id|data
)paren
(brace
id|byteout
c_func
(paren
id|iobase
op_minus
(paren
id|hscx
ques
c_cond
l_int|0x820
suffix:colon
l_int|0xc20
)paren
op_plus
id|offset
comma
id|data
)paren
suffix:semicolon
)brace
r_static
r_inline
r_void
DECL|function|readhscx_s
id|readhscx_s
c_func
(paren
r_int
id|iobase
comma
id|byte
id|hscx
comma
id|byte
id|offset
comma
id|byte
op_star
id|dest
comma
r_int
id|count
)paren
(brace
id|insb
c_func
(paren
id|iobase
op_minus
(paren
id|hscx
ques
c_cond
l_int|0x820
suffix:colon
l_int|0xc20
)paren
op_plus
id|offset
comma
id|dest
comma
id|count
)paren
suffix:semicolon
)brace
r_static
r_inline
r_void
DECL|function|writehscx_s
id|writehscx_s
c_func
(paren
r_int
id|iobase
comma
id|byte
id|hscx
comma
id|byte
id|offset
comma
id|byte
op_star
id|src
comma
r_int
id|count
)paren
(brace
id|outsb
c_func
(paren
id|iobase
op_minus
(paren
id|hscx
ques
c_cond
l_int|0x820
suffix:colon
l_int|0xc20
)paren
op_plus
id|offset
comma
id|src
comma
id|count
)paren
suffix:semicolon
)brace
DECL|macro|ISAC_MASK
mdefine_line|#define ISAC_MASK 0x20
DECL|macro|ISAC_ISTA
mdefine_line|#define ISAC_ISTA 0x20
DECL|macro|ISAC_STAR
mdefine_line|#define ISAC_STAR 0x21
DECL|macro|ISAC_CMDR
mdefine_line|#define ISAC_CMDR 0x21
DECL|macro|ISAC_EXIR
mdefine_line|#define ISAC_EXIR 0x24
DECL|macro|ISAC_RBCH
mdefine_line|#define ISAC_RBCH 0x2a
DECL|macro|ISAC_ADF2
mdefine_line|#define ISAC_ADF2 0x39
DECL|macro|ISAC_SPCR
mdefine_line|#define ISAC_SPCR 0x30
DECL|macro|ISAC_ADF1
mdefine_line|#define ISAC_ADF1 0x38
DECL|macro|ISAC_CIX0
mdefine_line|#define ISAC_CIX0 0x31
DECL|macro|ISAC_STCR
mdefine_line|#define ISAC_STCR 0x37
DECL|macro|ISAC_MODE
mdefine_line|#define ISAC_MODE 0x22
DECL|macro|ISAC_RSTA
mdefine_line|#define ISAC_RSTA 0x27
DECL|macro|ISAC_RBCL
mdefine_line|#define ISAC_RBCL 0x25
DECL|macro|ISAC_TIMR
mdefine_line|#define ISAC_TIMR 0x23
DECL|macro|ISAC_SQXR
mdefine_line|#define ISAC_SQXR 0x3b
DECL|macro|HSCX_ISTA
mdefine_line|#define HSCX_ISTA 0x20
DECL|macro|HSCX_CCR1
mdefine_line|#define HSCX_CCR1 0x2f
DECL|macro|HSCX_CCR2
mdefine_line|#define HSCX_CCR2 0x2c
DECL|macro|HSCX_TSAR
mdefine_line|#define HSCX_TSAR 0x31
DECL|macro|HSCX_TSAX
mdefine_line|#define HSCX_TSAX 0x30
DECL|macro|HSCX_XCCR
mdefine_line|#define HSCX_XCCR 0x32
DECL|macro|HSCX_RCCR
mdefine_line|#define HSCX_RCCR 0x33
DECL|macro|HSCX_MODE
mdefine_line|#define HSCX_MODE 0x22
DECL|macro|HSCX_CMDR
mdefine_line|#define HSCX_CMDR 0x21
DECL|macro|HSCX_EXIR
mdefine_line|#define HSCX_EXIR 0x24
DECL|macro|HSCX_XAD1
mdefine_line|#define HSCX_XAD1 0x24
DECL|macro|HSCX_XAD2
mdefine_line|#define HSCX_XAD2 0x25
DECL|macro|HSCX_RAH2
mdefine_line|#define HSCX_RAH2 0x27
DECL|macro|HSCX_RSTA
mdefine_line|#define HSCX_RSTA 0x27
DECL|macro|HSCX_TIMR
mdefine_line|#define HSCX_TIMR 0x23
DECL|macro|HSCX_STAR
mdefine_line|#define HSCX_STAR 0x21
DECL|macro|HSCX_RBCL
mdefine_line|#define HSCX_RBCL 0x25
DECL|macro|HSCX_XBCH
mdefine_line|#define HSCX_XBCH 0x2d
DECL|macro|HSCX_VSTR
mdefine_line|#define HSCX_VSTR 0x2e
DECL|macro|HSCX_RLCR
mdefine_line|#define HSCX_RLCR 0x2e
DECL|macro|HSCX_MASK
mdefine_line|#define HSCX_MASK 0x20
r_static
r_inline
r_void
DECL|function|waitforCEC_0
id|waitforCEC_0
c_func
(paren
id|byte
op_star
id|base
comma
id|byte
id|hscx
)paren
(brace
r_int
id|to
op_assign
l_int|10
suffix:semicolon
r_while
c_loop
(paren
(paren
id|readhscx_0
c_func
(paren
id|base
comma
id|hscx
comma
id|HSCX_STAR
)paren
op_amp
l_int|0x04
)paren
op_logical_and
id|to
)paren
(brace
id|udelay
c_func
(paren
l_int|5
)paren
suffix:semicolon
id|to
op_decrement
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|to
)paren
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;waitforCEC timeout&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_static
r_inline
r_void
DECL|function|waitforCEC_3
id|waitforCEC_3
c_func
(paren
r_int
id|iobase
comma
id|byte
id|hscx
)paren
(brace
r_int
id|to
op_assign
l_int|10
suffix:semicolon
r_while
c_loop
(paren
(paren
id|readhscx_3
c_func
(paren
id|iobase
comma
id|hscx
comma
id|HSCX_STAR
)paren
op_amp
l_int|0x04
)paren
op_logical_and
id|to
)paren
(brace
id|udelay
c_func
(paren
l_int|5
)paren
suffix:semicolon
id|to
op_decrement
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|to
)paren
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;waitforCEC timeout&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_static
r_inline
r_void
DECL|function|waitforXFW_0
id|waitforXFW_0
c_func
(paren
id|byte
op_star
id|base
comma
id|byte
id|hscx
)paren
(brace
r_int
id|to
op_assign
l_int|10
suffix:semicolon
id|waitforCEC_0
c_func
(paren
id|base
comma
id|hscx
)paren
suffix:semicolon
r_while
c_loop
(paren
(paren
op_logical_neg
(paren
id|readhscx_0
c_func
(paren
id|base
comma
id|hscx
comma
id|HSCX_STAR
)paren
op_amp
l_int|0x40
)paren
)paren
op_logical_and
id|to
)paren
(brace
id|udelay
c_func
(paren
l_int|5
)paren
suffix:semicolon
id|to
op_decrement
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|to
)paren
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;waitforXFW timeout&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_static
r_inline
r_void
DECL|function|waitforXFW_3
id|waitforXFW_3
c_func
(paren
r_int
id|iobase
comma
id|byte
id|hscx
)paren
(brace
r_int
id|to
op_assign
l_int|10
suffix:semicolon
id|waitforCEC_3
c_func
(paren
id|iobase
comma
id|hscx
)paren
suffix:semicolon
r_while
c_loop
(paren
(paren
op_logical_neg
(paren
id|readhscx_3
c_func
(paren
id|iobase
comma
id|hscx
comma
id|HSCX_STAR
)paren
op_amp
l_int|0x40
)paren
)paren
op_logical_and
id|to
)paren
(brace
id|udelay
c_func
(paren
l_int|5
)paren
suffix:semicolon
id|to
op_decrement
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|to
)paren
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;waitforXFW timeout&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_static
r_inline
r_void
DECL|function|writehscxCMDR_0
id|writehscxCMDR_0
c_func
(paren
id|byte
op_star
id|base
comma
id|byte
id|hscx
comma
id|byte
id|data
)paren
(brace
r_int
id|flags
suffix:semicolon
id|save_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
id|cli
c_func
(paren
)paren
suffix:semicolon
id|waitforCEC_0
c_func
(paren
id|base
comma
id|hscx
)paren
suffix:semicolon
id|writehscx_0
c_func
(paren
id|base
comma
id|hscx
comma
id|HSCX_CMDR
comma
id|data
)paren
suffix:semicolon
id|restore_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
)brace
r_static
r_inline
r_void
DECL|function|writehscxCMDR_3
id|writehscxCMDR_3
c_func
(paren
r_int
id|iobase
comma
id|byte
id|hscx
comma
id|byte
id|data
)paren
(brace
r_int
id|flags
suffix:semicolon
id|save_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
id|cli
c_func
(paren
)paren
suffix:semicolon
id|waitforCEC_3
c_func
(paren
id|iobase
comma
id|hscx
)paren
suffix:semicolon
id|writehscx_3
c_func
(paren
id|iobase
comma
id|hscx
comma
id|HSCX_CMDR
comma
id|data
)paren
suffix:semicolon
id|restore_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
)brace
DECL|macro|WRITEHSCX_CMDR
mdefine_line|#define WRITEHSCX_CMDR(mbase,ibase,hscx,data) &bslash;&n;        ((mbase)?writehscxCMDR_0(mbase,hscx,data):writehscxCMDR_3(ibase,hscx,data))
multiline_comment|/*&n; * fast interrupt here&n; */
DECL|macro|ISAC_RCVBUFREADY
mdefine_line|#define ISAC_RCVBUFREADY 0
DECL|macro|ISAC_XMTBUFREADY
mdefine_line|#define ISAC_XMTBUFREADY 1
DECL|macro|ISAC_PHCHANGE
mdefine_line|#define ISAC_PHCHANGE    2
DECL|macro|HSCX_RCVBUFREADY
mdefine_line|#define HSCX_RCVBUFREADY 0
DECL|macro|HSCX_XMTBUFREADY
mdefine_line|#define HSCX_XMTBUFREADY 1
r_void
DECL|function|teles_hscxreport
id|teles_hscxreport
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|sp
comma
r_int
id|hscx
)paren
(brace
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;HSCX %d&bslash;n&quot;
comma
id|hscx
)paren
suffix:semicolon
r_if
c_cond
(paren
id|sp-&gt;membase
)paren
(brace
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;  ISTA %x&bslash;n&quot;
comma
id|readhscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_ISTA
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;  STAR %x&bslash;n&quot;
comma
id|readhscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_STAR
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;  EXIR %x&bslash;n&quot;
comma
id|readhscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_EXIR
)paren
)paren
suffix:semicolon
)brace
r_else
(brace
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;  ISTA %x&bslash;n&quot;
comma
id|readhscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_ISTA
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;  STAR %x&bslash;n&quot;
comma
id|readhscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_STAR
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;  EXIR %x&bslash;n&quot;
comma
id|readhscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_EXIR
)paren
)paren
suffix:semicolon
)brace
)brace
r_void
DECL|function|teles_report
id|teles_report
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|sp
)paren
(brace
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;ISAC&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|sp-&gt;membase
)paren
(brace
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;  ISTA %x&bslash;n&quot;
comma
id|readisac_0
c_func
(paren
id|sp-&gt;membase
comma
id|ISAC_ISTA
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;  STAR %x&bslash;n&quot;
comma
id|readisac_0
c_func
(paren
id|sp-&gt;membase
comma
id|ISAC_STAR
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;  EXIR %x&bslash;n&quot;
comma
id|readisac_0
c_func
(paren
id|sp-&gt;membase
comma
id|ISAC_EXIR
)paren
)paren
suffix:semicolon
)brace
r_else
(brace
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;  ISTA %x&bslash;n&quot;
comma
id|readisac_3
c_func
(paren
id|sp-&gt;iobase
comma
id|ISAC_ISTA
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;  STAR %x&bslash;n&quot;
comma
id|readisac_3
c_func
(paren
id|sp-&gt;iobase
comma
id|ISAC_STAR
)paren
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;  EXIR %x&bslash;n&quot;
comma
id|readisac_3
c_func
(paren
id|sp-&gt;iobase
comma
id|ISAC_EXIR
)paren
)paren
suffix:semicolon
)brace
id|teles_hscxreport
c_func
(paren
id|sp
comma
l_int|0
)paren
suffix:semicolon
id|teles_hscxreport
c_func
(paren
id|sp
comma
l_int|1
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * HSCX stuff goes here&n; */
r_static
r_void
DECL|function|hscx_sched_event
id|hscx_sched_event
c_func
(paren
r_struct
id|HscxState
op_star
id|hsp
comma
r_int
id|event
)paren
(brace
id|hsp-&gt;event
op_or_assign
l_int|1
op_lshift
id|event
suffix:semicolon
id|queue_task_irq_off
c_func
(paren
op_amp
id|hsp-&gt;tqueue
comma
op_amp
id|tq_immediate
)paren
suffix:semicolon
id|mark_bh
c_func
(paren
id|IMMEDIATE_BH
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|hscx_empty_fifo
id|hscx_empty_fifo
c_func
(paren
r_struct
id|HscxState
op_star
id|hsp
comma
r_int
id|count
)paren
(brace
id|byte
op_star
id|ptr
suffix:semicolon
r_struct
id|BufHeader
op_star
id|ibh
op_assign
id|hsp-&gt;rcvibh
suffix:semicolon
r_if
c_cond
(paren
id|hsp-&gt;sp-&gt;debug
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;hscx_empty_fifo&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hsp-&gt;rcvptr
op_plus
id|count
OG
id|BUFFER_SIZE
c_func
(paren
id|HSCX_RBUF_ORDER
comma
id|HSCX_RBUF_BPPS
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;hscx_empty_fifo: incoming packet too large&bslash;n&quot;
)paren
suffix:semicolon
id|WRITEHSCX_CMDR
c_func
(paren
id|hsp-&gt;membase
comma
id|hsp-&gt;iobase
comma
id|hsp-&gt;hscx
comma
l_int|0x80
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|ptr
op_assign
id|DATAPTR
c_func
(paren
id|ibh
)paren
suffix:semicolon
id|ptr
op_add_assign
id|hsp-&gt;rcvptr
suffix:semicolon
id|hsp-&gt;rcvptr
op_add_assign
id|count
suffix:semicolon
r_if
c_cond
(paren
id|hsp-&gt;membase
)paren
(brace
r_while
c_loop
(paren
id|count
op_decrement
)paren
op_star
id|ptr
op_increment
op_assign
id|readhscx_0
c_func
(paren
id|hsp-&gt;membase
comma
id|hsp-&gt;hscx
comma
l_int|0x0
)paren
suffix:semicolon
id|writehscxCMDR_0
c_func
(paren
id|hsp-&gt;membase
comma
id|hsp-&gt;hscx
comma
l_int|0x80
)paren
suffix:semicolon
)brace
r_else
(brace
id|readhscx_s
c_func
(paren
id|hsp-&gt;iobase
comma
id|hsp-&gt;hscx
comma
l_int|0x3e
comma
id|ptr
comma
id|count
)paren
suffix:semicolon
id|writehscxCMDR_3
c_func
(paren
id|hsp-&gt;iobase
comma
id|hsp-&gt;hscx
comma
l_int|0x80
)paren
suffix:semicolon
)brace
macro_line|#ifdef BCHAN_VERBOSE
(brace
r_int
id|i
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;hscx_empty_fifo&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|count
suffix:semicolon
id|i
op_increment
)paren
id|printk
c_func
(paren
l_string|&quot; %2x&quot;
comma
id|ptr
(braket
id|i
)braket
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
macro_line|#endif&t;&t;&t;&t;/* BCHAN_VERBOSE */
)brace
r_static
r_void
DECL|function|hscx_fill_fifo
id|hscx_fill_fifo
c_func
(paren
r_struct
id|HscxState
op_star
id|hsp
)paren
(brace
r_struct
id|BufHeader
op_star
id|ibh
suffix:semicolon
r_int
id|more
comma
id|count
suffix:semicolon
id|byte
op_star
id|ptr
suffix:semicolon
r_if
c_cond
(paren
id|hsp-&gt;sp-&gt;debug
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;hscx_fill_fifo&bslash;n&quot;
)paren
suffix:semicolon
id|ibh
op_assign
id|hsp-&gt;xmtibh
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ibh
)paren
r_return
suffix:semicolon
id|count
op_assign
id|ibh-&gt;datasize
op_minus
id|hsp-&gt;sendptr
suffix:semicolon
r_if
c_cond
(paren
id|count
op_le
l_int|0
)paren
r_return
suffix:semicolon
macro_line|#if 0
r_if
c_cond
(paren
op_logical_neg
id|hsp-&gt;sendptr
)paren
(brace
id|ptr
op_assign
id|DATAPTR
c_func
(paren
id|ibh
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;snd bytes %2x %2x %2x %2x %2x&bslash;n&quot;
comma
id|ptr
(braket
l_int|0
)braket
comma
id|ptr
(braket
l_int|1
)braket
comma
id|ptr
(braket
l_int|2
)braket
comma
id|ptr
(braket
l_int|3
)braket
comma
id|ptr
(braket
l_int|4
)braket
)paren
suffix:semicolon
)brace
macro_line|#endif
id|more
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|count
OG
l_int|32
)paren
(brace
id|more
op_assign
op_logical_neg
l_int|0
suffix:semicolon
id|count
op_assign
l_int|32
suffix:semicolon
)brace
id|ptr
op_assign
id|DATAPTR
c_func
(paren
id|ibh
)paren
suffix:semicolon
id|ptr
op_add_assign
id|hsp-&gt;sendptr
suffix:semicolon
id|hsp-&gt;sendptr
op_add_assign
id|count
suffix:semicolon
macro_line|#ifdef BCHAN_VERBOSE
(brace
r_int
id|i
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;hscx_fill_fifo &quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|count
suffix:semicolon
id|i
op_increment
)paren
id|printk
c_func
(paren
l_string|&quot; %2x&quot;
comma
id|ptr
(braket
id|i
)braket
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
macro_line|#endif
r_if
c_cond
(paren
id|hsp-&gt;membase
)paren
(brace
id|waitforXFW_0
c_func
(paren
id|hsp-&gt;membase
comma
id|hsp-&gt;hscx
)paren
suffix:semicolon
r_while
c_loop
(paren
id|count
op_decrement
)paren
id|writehscx_0
c_func
(paren
id|hsp-&gt;membase
comma
id|hsp-&gt;hscx
comma
l_int|0x0
comma
op_star
id|ptr
op_increment
)paren
suffix:semicolon
id|writehscxCMDR_0
c_func
(paren
id|hsp-&gt;membase
comma
id|hsp-&gt;hscx
comma
id|more
ques
c_cond
l_int|0x8
suffix:colon
l_int|0xa
)paren
suffix:semicolon
)brace
r_else
(brace
id|waitforXFW_3
c_func
(paren
id|hsp-&gt;iobase
comma
id|hsp-&gt;hscx
)paren
suffix:semicolon
id|writehscx_s
c_func
(paren
id|hsp-&gt;iobase
comma
id|hsp-&gt;hscx
comma
l_int|0x3e
comma
id|ptr
comma
id|count
)paren
suffix:semicolon
id|writehscxCMDR_3
c_func
(paren
id|hsp-&gt;iobase
comma
id|hsp-&gt;hscx
comma
id|more
ques
c_cond
l_int|0x8
suffix:colon
l_int|0xa
)paren
suffix:semicolon
)brace
)brace
r_static
r_inline
r_void
DECL|function|hscx_interrupt
id|hscx_interrupt
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|sp
comma
id|byte
id|val
comma
id|byte
id|hscx
)paren
(brace
id|byte
id|r
suffix:semicolon
r_struct
id|HscxState
op_star
id|hsp
op_assign
id|sp-&gt;hs
op_plus
id|hscx
suffix:semicolon
r_int
id|count
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|hsp-&gt;init
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|val
op_amp
l_int|0x80
)paren
(brace
multiline_comment|/* RME */
id|r
op_assign
id|READHSCX
c_func
(paren
id|hsp-&gt;membase
comma
id|sp-&gt;iobase
comma
id|hsp-&gt;hscx
comma
id|HSCX_RSTA
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|r
op_amp
l_int|0xf0
)paren
op_ne
l_int|0xa0
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|r
op_amp
l_int|0x80
)paren
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;Teles: HSCX invalid frame&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|r
op_amp
l_int|0x40
)paren
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;Teles: HSCX RDO&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|r
op_amp
l_int|0x20
)paren
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;Teles: HSCX CRC error&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hsp-&gt;rcvibh
)paren
id|BufPoolRelease
c_func
(paren
id|hsp-&gt;rcvibh
)paren
suffix:semicolon
id|hsp-&gt;rcvibh
op_assign
l_int|NULL
suffix:semicolon
id|WRITEHSCX_CMDR
c_func
(paren
id|hsp-&gt;membase
comma
id|hsp-&gt;iobase
comma
id|hsp-&gt;hscx
comma
l_int|0x80
)paren
suffix:semicolon
r_goto
id|afterRME
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|hsp-&gt;rcvibh
)paren
r_if
c_cond
(paren
id|BufPoolGet
c_func
(paren
op_amp
id|hsp-&gt;rcvibh
comma
op_amp
id|hsp-&gt;rbufpool
comma
id|GFP_ATOMIC
comma
(paren
r_void
op_star
)paren
l_int|1
comma
l_int|1
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;HSCX RME out of buffers at %ld&bslash;n&quot;
comma
id|jiffies
)paren
suffix:semicolon
id|WRITEHSCX_CMDR
c_func
(paren
id|hsp-&gt;membase
comma
id|hsp-&gt;iobase
comma
id|hsp-&gt;hscx
comma
l_int|0x80
)paren
suffix:semicolon
r_goto
id|afterRME
suffix:semicolon
)brace
r_else
id|hsp-&gt;rcvptr
op_assign
l_int|0
suffix:semicolon
id|count
op_assign
id|READHSCX
c_func
(paren
id|hsp-&gt;membase
comma
id|sp-&gt;iobase
comma
id|hsp-&gt;hscx
comma
id|HSCX_RBCL
)paren
op_amp
l_int|0x1f
suffix:semicolon
r_if
c_cond
(paren
id|count
op_eq
l_int|0
)paren
id|count
op_assign
l_int|32
suffix:semicolon
id|hscx_empty_fifo
c_func
(paren
id|hsp
comma
id|count
)paren
suffix:semicolon
id|hsp-&gt;rcvibh-&gt;datasize
op_assign
id|hsp-&gt;rcvptr
op_minus
l_int|1
suffix:semicolon
id|BufQueueLink
c_func
(paren
op_amp
id|hsp-&gt;rq
comma
id|hsp-&gt;rcvibh
)paren
suffix:semicolon
id|hsp-&gt;rcvibh
op_assign
l_int|NULL
suffix:semicolon
id|hscx_sched_event
c_func
(paren
id|hsp
comma
id|HSCX_RCVBUFREADY
)paren
suffix:semicolon
)brace
id|afterRME
suffix:colon
r_if
c_cond
(paren
id|val
op_amp
l_int|0x40
)paren
(brace
multiline_comment|/* RPF */
r_if
c_cond
(paren
op_logical_neg
id|hsp-&gt;rcvibh
)paren
r_if
c_cond
(paren
id|BufPoolGet
c_func
(paren
op_amp
id|hsp-&gt;rcvibh
comma
op_amp
id|hsp-&gt;rbufpool
comma
id|GFP_ATOMIC
comma
(paren
r_void
op_star
)paren
l_int|1
comma
l_int|2
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;HSCX RME out of buffers at %ld&bslash;n&quot;
comma
id|jiffies
)paren
suffix:semicolon
id|WRITEHSCX_CMDR
c_func
(paren
id|hsp-&gt;membase
comma
id|hsp-&gt;iobase
comma
id|hsp-&gt;hscx
comma
l_int|0x80
)paren
suffix:semicolon
r_goto
id|afterRPF
suffix:semicolon
)brace
r_else
id|hsp-&gt;rcvptr
op_assign
l_int|0
suffix:semicolon
id|hscx_empty_fifo
c_func
(paren
id|hsp
comma
l_int|32
)paren
suffix:semicolon
macro_line|#ifdef VOICE
id|hsp-&gt;rcvibh-&gt;datasize
op_assign
id|hsp-&gt;rcvptr
op_minus
l_int|1
suffix:semicolon
id|BufQueueLink
c_func
(paren
op_amp
id|hsp-&gt;rq
comma
id|hsp-&gt;rcvibh
)paren
suffix:semicolon
id|hsp-&gt;rcvibh
op_assign
l_int|NULL
suffix:semicolon
id|hscx_sched_event
c_func
(paren
id|hsp
comma
id|HSCX_RCVBUFREADY
)paren
suffix:semicolon
macro_line|#endif
)brace
id|afterRPF
suffix:colon
r_if
c_cond
(paren
id|val
op_amp
l_int|0x10
)paren
(brace
multiline_comment|/* XPR */
r_if
c_cond
(paren
id|hsp-&gt;xmtibh
)paren
r_if
c_cond
(paren
id|hsp-&gt;xmtibh-&gt;datasize
OG
id|hsp-&gt;sendptr
)paren
(brace
id|hscx_fill_fifo
c_func
(paren
id|hsp
)paren
suffix:semicolon
r_goto
id|afterXPR
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|hsp-&gt;releasebuf
)paren
id|BufPoolRelease
c_func
(paren
id|hsp-&gt;xmtibh
)paren
suffix:semicolon
id|hsp-&gt;xmtibh
op_assign
l_int|NULL
suffix:semicolon
id|hsp-&gt;sendptr
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|hsp-&gt;st-&gt;l4.l1writewakeup
)paren
id|hsp-&gt;st-&gt;l4
dot
id|l1writewakeup
c_func
(paren
id|hsp-&gt;st
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|BufQueueUnlink
c_func
(paren
op_amp
id|hsp-&gt;xmtibh
comma
op_amp
id|hsp-&gt;sq
)paren
)paren
(brace
id|hsp-&gt;releasebuf
op_assign
op_logical_neg
l_int|0
suffix:semicolon
id|hscx_fill_fifo
c_func
(paren
id|hsp
)paren
suffix:semicolon
)brace
r_else
id|hscx_sched_event
c_func
(paren
id|hsp
comma
id|HSCX_XMTBUFREADY
)paren
suffix:semicolon
)brace
id|afterXPR
suffix:colon
)brace
multiline_comment|/*&n; * ISAC stuff goes here&n; */
r_static
r_void
DECL|function|isac_sched_event
id|isac_sched_event
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|sp
comma
r_int
id|event
)paren
(brace
id|sp-&gt;event
op_or_assign
l_int|1
op_lshift
id|event
suffix:semicolon
id|queue_task_irq_off
c_func
(paren
op_amp
id|sp-&gt;tqueue
comma
op_amp
id|tq_immediate
)paren
suffix:semicolon
id|mark_bh
c_func
(paren
id|IMMEDIATE_BH
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|empty_fifo
id|empty_fifo
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|sp
comma
r_int
id|count
)paren
(brace
id|byte
op_star
id|ptr
suffix:semicolon
r_struct
id|BufHeader
op_star
id|ibh
op_assign
id|sp-&gt;rcvibh
suffix:semicolon
r_if
c_cond
(paren
id|sp-&gt;debug
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;empty_fifo&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|sp-&gt;rcvptr
op_ge
l_int|3072
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;empty_fifo rcvptr %d&bslash;n&quot;
comma
id|sp-&gt;rcvptr
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|ptr
op_assign
id|DATAPTR
c_func
(paren
id|ibh
)paren
suffix:semicolon
id|ptr
op_add_assign
id|sp-&gt;rcvptr
suffix:semicolon
id|sp-&gt;rcvptr
op_add_assign
id|count
suffix:semicolon
r_if
c_cond
(paren
id|sp-&gt;membase
)paren
(brace
macro_line|#ifdef DCHAN_VERBOSE
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;empty_fifo &quot;
)paren
suffix:semicolon
r_while
c_loop
(paren
id|count
op_decrement
)paren
(brace
op_star
id|ptr
op_assign
id|readisac_0
c_func
(paren
id|sp-&gt;membase
comma
l_int|0x0
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%2x &quot;
comma
op_star
id|ptr
)paren
suffix:semicolon
id|ptr
op_increment
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#else
r_while
c_loop
(paren
id|count
op_decrement
)paren
op_star
id|ptr
op_increment
op_assign
id|readisac_0
c_func
(paren
id|sp-&gt;membase
comma
l_int|0x0
)paren
suffix:semicolon
macro_line|#endif
id|writeisac_0
c_func
(paren
id|sp-&gt;membase
comma
id|ISAC_CMDR
comma
l_int|0x80
)paren
suffix:semicolon
)brace
r_else
(brace
macro_line|#ifdef DCHAN_VERBOSE
r_int
id|i
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;empty_fifo &quot;
)paren
suffix:semicolon
id|readisac_s
c_func
(paren
id|sp-&gt;iobase
comma
l_int|0x3e
comma
id|ptr
comma
id|count
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|count
suffix:semicolon
id|i
op_increment
)paren
id|printk
c_func
(paren
l_string|&quot;%2x &quot;
comma
id|ptr
(braket
id|i
)braket
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#else
id|readisac_s
c_func
(paren
id|sp-&gt;iobase
comma
l_int|0x3e
comma
id|ptr
comma
id|count
)paren
suffix:semicolon
macro_line|#endif
id|writeisac_3
c_func
(paren
id|sp-&gt;iobase
comma
id|ISAC_CMDR
comma
l_int|0x80
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|fill_fifo
id|fill_fifo
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|sp
)paren
(brace
r_struct
id|BufHeader
op_star
id|ibh
suffix:semicolon
r_int
id|count
comma
id|more
suffix:semicolon
id|byte
op_star
id|ptr
suffix:semicolon
r_if
c_cond
(paren
id|sp-&gt;debug
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;fill_fifo&bslash;n&quot;
)paren
suffix:semicolon
id|ibh
op_assign
id|sp-&gt;xmtibh
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ibh
)paren
r_return
suffix:semicolon
id|count
op_assign
id|ibh-&gt;datasize
op_minus
id|sp-&gt;sendptr
suffix:semicolon
r_if
c_cond
(paren
id|count
op_le
l_int|0
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|count
op_ge
l_int|3072
)paren
r_return
suffix:semicolon
id|more
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|count
OG
l_int|32
)paren
(brace
id|more
op_assign
op_logical_neg
l_int|0
suffix:semicolon
id|count
op_assign
l_int|32
suffix:semicolon
)brace
id|ptr
op_assign
id|DATAPTR
c_func
(paren
id|ibh
)paren
suffix:semicolon
id|ptr
op_add_assign
id|sp-&gt;sendptr
suffix:semicolon
id|sp-&gt;sendptr
op_add_assign
id|count
suffix:semicolon
r_if
c_cond
(paren
id|sp-&gt;membase
)paren
(brace
macro_line|#ifdef DCHAN_VERBOSE
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;fill_fifo &quot;
)paren
suffix:semicolon
r_while
c_loop
(paren
id|count
op_decrement
)paren
(brace
id|writeisac_0
c_func
(paren
id|sp-&gt;membase
comma
l_int|0x0
comma
op_star
id|ptr
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;%2x &quot;
comma
op_star
id|ptr
)paren
suffix:semicolon
id|ptr
op_increment
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#else
r_while
c_loop
(paren
id|count
op_decrement
)paren
id|writeisac_0
c_func
(paren
id|sp-&gt;membase
comma
l_int|0x0
comma
op_star
id|ptr
op_increment
)paren
suffix:semicolon
macro_line|#endif
id|writeisac_0
c_func
(paren
id|sp-&gt;membase
comma
id|ISAC_CMDR
comma
id|more
ques
c_cond
l_int|0x8
suffix:colon
l_int|0xa
)paren
suffix:semicolon
)brace
r_else
(brace
macro_line|#ifdef DCHAN_VERBOSE
r_int
id|i
suffix:semicolon
id|writeisac_s
c_func
(paren
id|sp-&gt;iobase
comma
l_int|0x3e
comma
id|ptr
comma
id|count
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;fill_fifo &quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|count
suffix:semicolon
id|i
op_increment
)paren
id|printk
c_func
(paren
l_string|&quot;%2x &quot;
comma
id|ptr
(braket
id|i
)braket
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#else
id|writeisac_s
c_func
(paren
id|sp-&gt;iobase
comma
l_int|0x3e
comma
id|ptr
comma
id|count
)paren
suffix:semicolon
macro_line|#endif
id|writeisac_3
c_func
(paren
id|sp-&gt;iobase
comma
id|ISAC_CMDR
comma
id|more
ques
c_cond
l_int|0x8
suffix:colon
l_int|0xa
)paren
suffix:semicolon
)brace
)brace
r_static
r_int
DECL|function|act_wanted
id|act_wanted
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|sp
)paren
(brace
r_struct
id|PStack
op_star
id|st
suffix:semicolon
id|st
op_assign
id|sp-&gt;stlist
suffix:semicolon
r_while
c_loop
(paren
id|st
)paren
r_if
c_cond
(paren
id|st-&gt;l1.act_state
)paren
r_return
(paren
op_logical_neg
l_int|0
)paren
suffix:semicolon
r_else
id|st
op_assign
id|st-&gt;next
suffix:semicolon
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|ph_command
id|ph_command
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|sp
comma
r_int
r_int
id|command
)paren
(brace
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;ph_command %d&bslash;n&quot;
comma
id|command
)paren
suffix:semicolon
id|WRITEISAC
c_func
(paren
id|sp-&gt;membase
comma
id|sp-&gt;iobase
comma
id|ISAC_CIX0
comma
(paren
id|command
op_lshift
l_int|2
)paren
op_or
l_int|3
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|isac_new_ph
id|isac_new_ph
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|sp
)paren
(brace
r_int
id|enq
suffix:semicolon
id|enq
op_assign
id|act_wanted
c_func
(paren
id|sp
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|sp-&gt;ph_state
)paren
(brace
r_case
(paren
l_int|0
)paren
suffix:colon
r_case
(paren
l_int|6
)paren
suffix:colon
r_if
c_cond
(paren
id|enq
)paren
id|ph_command
c_func
(paren
id|sp
comma
l_int|0
)paren
suffix:semicolon
r_else
id|ph_command
c_func
(paren
id|sp
comma
l_int|15
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
l_int|7
)paren
suffix:colon
r_if
c_cond
(paren
id|enq
)paren
id|ph_command
c_func
(paren
id|sp
comma
l_int|9
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
l_int|12
)paren
suffix:colon
r_case
(paren
l_int|13
)paren
suffix:colon
id|sp-&gt;ph_active
op_assign
l_int|5
suffix:semicolon
id|isac_sched_event
c_func
(paren
id|sp
comma
id|ISAC_PHCHANGE
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|sp-&gt;xmtibh
)paren
r_if
c_cond
(paren
op_logical_neg
id|BufQueueUnlink
c_func
(paren
op_amp
id|sp-&gt;xmtibh
comma
op_amp
id|sp-&gt;sq
)paren
)paren
id|sp-&gt;sendptr
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|sp-&gt;xmtibh
)paren
id|fill_fifo
c_func
(paren
id|sp
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
l_int|4
)paren
suffix:colon
r_case
(paren
l_int|8
)paren
suffix:colon
r_break
suffix:semicolon
r_default
suffix:colon
id|sp-&gt;ph_active
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|teles_interrupt
id|teles_interrupt
c_func
(paren
r_int
id|intno
comma
r_void
op_star
id|dev_id
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
(brace
id|byte
id|val
comma
id|val2
comma
id|r
suffix:semicolon
r_struct
id|IsdnCardState
op_star
id|sp
suffix:semicolon
r_int
r_int
id|count
suffix:semicolon
r_struct
id|HscxState
op_star
id|hsp
suffix:semicolon
id|sp
op_assign
(paren
r_struct
id|IsdnCardState
op_star
)paren
id|irq2dev_map
(braket
id|intno
)braket
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|sp
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;Teles: Spurious interrupt!&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|val
op_assign
id|READHSCX
c_func
(paren
id|sp-&gt;membase
comma
id|sp-&gt;iobase
comma
l_int|1
comma
id|HSCX_ISTA
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
op_amp
l_int|0x01
)paren
(brace
id|hsp
op_assign
id|sp-&gt;hs
op_plus
l_int|1
suffix:semicolon
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;HSCX B EXIR %x xmitbh %lx rcvibh %lx&bslash;n&quot;
comma
id|READHSCX
c_func
(paren
id|sp-&gt;membase
comma
id|sp-&gt;iobase
comma
l_int|1
comma
id|HSCX_EXIR
)paren
comma
(paren
r_int
)paren
id|hsp-&gt;xmtibh
comma
(paren
r_int
)paren
id|hsp-&gt;rcvibh
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|val
op_amp
l_int|0xf8
)paren
(brace
r_if
c_cond
(paren
id|sp-&gt;debug
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;HSCX B interrupt %x&bslash;n&quot;
comma
id|val
)paren
suffix:semicolon
id|hscx_interrupt
c_func
(paren
id|sp
comma
id|val
comma
l_int|1
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|val
op_amp
l_int|0x02
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;HSCX A EXIR %x&bslash;n&quot;
comma
id|READHSCX
c_func
(paren
id|sp-&gt;membase
comma
id|sp-&gt;iobase
comma
l_int|0
comma
id|HSCX_EXIR
)paren
)paren
suffix:semicolon
)brace
multiline_comment|/* ??? Why do that vvvvvvvvvvvvvvvvvvvvv different on Teles 16-3 ??? */
r_if
c_cond
(paren
id|sp-&gt;membase
)paren
(brace
r_if
c_cond
(paren
id|val
op_amp
l_int|0x04
)paren
(brace
id|val
op_assign
id|readhscx_0
c_func
(paren
id|sp-&gt;membase
comma
l_int|0
comma
id|HSCX_ISTA
)paren
suffix:semicolon
r_if
c_cond
(paren
id|sp-&gt;debug
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;HSCX A interrupt %x&bslash;n&quot;
comma
id|val
)paren
suffix:semicolon
id|hscx_interrupt
c_func
(paren
id|sp
comma
id|val
comma
l_int|0
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
id|val2
op_assign
id|readhscx_3
c_func
(paren
id|sp-&gt;iobase
comma
l_int|0
comma
id|HSCX_ISTA
)paren
suffix:semicolon
r_if
c_cond
(paren
id|sp-&gt;debug
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;HSCX A ISTA %x&bslash;n&quot;
comma
id|val2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
op_amp
l_int|0x04
)paren
(brace
r_if
c_cond
(paren
id|sp-&gt;debug
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;HSCX A interrupt %x&bslash;n&quot;
comma
id|val2
)paren
suffix:semicolon
id|hscx_interrupt
c_func
(paren
id|sp
comma
id|val2
comma
l_int|0
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/* ??? Why do that ^^^^^^^^^^^^^^^^^^^^^ different on Teles 16-3 ??? */
id|val
op_assign
id|READISAC
c_func
(paren
id|sp-&gt;membase
comma
id|sp-&gt;iobase
comma
id|ISAC_ISTA
)paren
suffix:semicolon
r_if
c_cond
(paren
id|sp-&gt;debug
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;ISAC interrupt %x&bslash;n&quot;
comma
id|val
)paren
suffix:semicolon
r_if
c_cond
(paren
id|val
op_amp
l_int|0x80
)paren
(brace
multiline_comment|/* RME */
id|r
op_assign
id|READISAC
c_func
(paren
id|sp-&gt;membase
comma
id|sp-&gt;iobase
comma
id|ISAC_RSTA
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|r
op_amp
l_int|0x70
)paren
op_ne
l_int|0x20
)paren
(brace
r_if
c_cond
(paren
id|r
op_amp
l_int|0x40
)paren
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;Teles: ISAC RDO&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|r
op_amp
l_int|0x20
)paren
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;Teles: ISAC CRC error&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|sp-&gt;rcvibh
)paren
id|BufPoolRelease
c_func
(paren
id|sp-&gt;rcvibh
)paren
suffix:semicolon
id|sp-&gt;rcvibh
op_assign
l_int|NULL
suffix:semicolon
id|WRITEISAC
c_func
(paren
id|sp-&gt;membase
comma
id|sp-&gt;iobase
comma
id|ISAC_CMDR
comma
l_int|0x80
)paren
suffix:semicolon
r_goto
id|afterRME
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|sp-&gt;rcvibh
)paren
r_if
c_cond
(paren
id|BufPoolGet
c_func
(paren
op_amp
(paren
id|sp-&gt;rcvibh
)paren
comma
op_amp
(paren
id|sp-&gt;rbufpool
)paren
comma
id|GFP_ATOMIC
comma
(paren
r_void
op_star
)paren
l_int|1
comma
l_int|3
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;ISAC RME out of buffers!&bslash;n&quot;
)paren
suffix:semicolon
id|WRITEISAC
c_func
(paren
id|sp-&gt;membase
comma
id|sp-&gt;iobase
comma
id|ISAC_CMDR
comma
l_int|0x80
)paren
suffix:semicolon
r_goto
id|afterRME
suffix:semicolon
)brace
r_else
id|sp-&gt;rcvptr
op_assign
l_int|0
suffix:semicolon
id|count
op_assign
id|READISAC
c_func
(paren
id|sp-&gt;membase
comma
id|sp-&gt;iobase
comma
id|ISAC_RBCL
)paren
op_amp
l_int|0x1f
suffix:semicolon
r_if
c_cond
(paren
id|count
op_eq
l_int|0
)paren
id|count
op_assign
l_int|32
suffix:semicolon
id|empty_fifo
c_func
(paren
id|sp
comma
id|count
)paren
suffix:semicolon
id|sp-&gt;rcvibh-&gt;datasize
op_assign
id|sp-&gt;rcvptr
suffix:semicolon
id|BufQueueLink
c_func
(paren
op_amp
(paren
id|sp-&gt;rq
)paren
comma
id|sp-&gt;rcvibh
)paren
suffix:semicolon
id|sp-&gt;rcvibh
op_assign
l_int|NULL
suffix:semicolon
id|isac_sched_event
c_func
(paren
id|sp
comma
id|ISAC_RCVBUFREADY
)paren
suffix:semicolon
)brace
id|afterRME
suffix:colon
r_if
c_cond
(paren
id|val
op_amp
l_int|0x40
)paren
(brace
multiline_comment|/* RPF */
r_if
c_cond
(paren
op_logical_neg
id|sp-&gt;rcvibh
)paren
r_if
c_cond
(paren
id|BufPoolGet
c_func
(paren
op_amp
(paren
id|sp-&gt;rcvibh
)paren
comma
op_amp
(paren
id|sp-&gt;rbufpool
)paren
comma
id|GFP_ATOMIC
comma
(paren
r_void
op_star
)paren
l_int|1
comma
l_int|4
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;ISAC RME out of buffers!&bslash;n&quot;
)paren
suffix:semicolon
id|WRITEISAC
c_func
(paren
id|sp-&gt;membase
comma
id|sp-&gt;iobase
comma
id|ISAC_CMDR
comma
l_int|0x80
)paren
suffix:semicolon
r_goto
id|afterRPF
suffix:semicolon
)brace
r_else
id|sp-&gt;rcvptr
op_assign
l_int|0
suffix:semicolon
id|empty_fifo
c_func
(paren
id|sp
comma
l_int|32
)paren
suffix:semicolon
)brace
id|afterRPF
suffix:colon
r_if
c_cond
(paren
id|val
op_amp
l_int|0x20
)paren
(brace
)brace
r_if
c_cond
(paren
id|val
op_amp
l_int|0x10
)paren
(brace
multiline_comment|/* XPR */
r_if
c_cond
(paren
id|sp-&gt;xmtibh
)paren
r_if
c_cond
(paren
id|sp-&gt;xmtibh-&gt;datasize
OG
id|sp-&gt;sendptr
)paren
(brace
id|fill_fifo
c_func
(paren
id|sp
)paren
suffix:semicolon
r_goto
id|afterXPR
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|sp-&gt;releasebuf
)paren
id|BufPoolRelease
c_func
(paren
id|sp-&gt;xmtibh
)paren
suffix:semicolon
id|sp-&gt;xmtibh
op_assign
l_int|NULL
suffix:semicolon
id|sp-&gt;sendptr
op_assign
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|BufQueueUnlink
c_func
(paren
op_amp
id|sp-&gt;xmtibh
comma
op_amp
id|sp-&gt;sq
)paren
)paren
(brace
id|sp-&gt;releasebuf
op_assign
op_logical_neg
l_int|0
suffix:semicolon
id|fill_fifo
c_func
(paren
id|sp
)paren
suffix:semicolon
)brace
r_else
id|isac_sched_event
c_func
(paren
id|sp
comma
id|ISAC_XMTBUFREADY
)paren
suffix:semicolon
)brace
id|afterXPR
suffix:colon
r_if
c_cond
(paren
id|val
op_amp
l_int|0x04
)paren
(brace
multiline_comment|/* CISQ */
id|sp-&gt;ph_state
op_assign
(paren
id|READISAC
c_func
(paren
id|sp-&gt;membase
comma
id|sp-&gt;iobase
comma
id|ISAC_CIX0
)paren
op_rshift
l_int|2
)paren
op_amp
l_int|0xf
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;l1state %d&bslash;n&quot;
comma
id|sp-&gt;ph_state
)paren
suffix:semicolon
id|isac_new_ph
c_func
(paren
id|sp
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|sp-&gt;membase
)paren
(brace
id|writeisac_0
c_func
(paren
id|sp-&gt;membase
comma
id|ISAC_MASK
comma
l_int|0xFF
)paren
suffix:semicolon
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
l_int|0
comma
id|HSCX_MASK
comma
l_int|0xFF
)paren
suffix:semicolon
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
l_int|1
comma
id|HSCX_MASK
comma
l_int|0xFF
)paren
suffix:semicolon
id|writeisac_0
c_func
(paren
id|sp-&gt;membase
comma
id|ISAC_MASK
comma
l_int|0x0
)paren
suffix:semicolon
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
l_int|0
comma
id|HSCX_MASK
comma
l_int|0x0
)paren
suffix:semicolon
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
l_int|1
comma
id|HSCX_MASK
comma
l_int|0x0
)paren
suffix:semicolon
)brace
r_else
(brace
id|writeisac_3
c_func
(paren
id|sp-&gt;iobase
comma
id|ISAC_MASK
comma
l_int|0xFF
)paren
suffix:semicolon
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
l_int|0
comma
id|HSCX_MASK
comma
l_int|0xFF
)paren
suffix:semicolon
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
l_int|1
comma
id|HSCX_MASK
comma
l_int|0xFF
)paren
suffix:semicolon
id|writeisac_3
c_func
(paren
id|sp-&gt;iobase
comma
id|ISAC_MASK
comma
l_int|0x0
)paren
suffix:semicolon
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
l_int|0
comma
id|HSCX_MASK
comma
l_int|0x0
)paren
suffix:semicolon
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
l_int|1
comma
id|HSCX_MASK
comma
l_int|0x0
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/*&n; * soft interrupt&n; */
r_static
r_void
DECL|function|act_ivated
id|act_ivated
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|sp
)paren
(brace
r_struct
id|PStack
op_star
id|st
suffix:semicolon
id|st
op_assign
id|sp-&gt;stlist
suffix:semicolon
r_while
c_loop
(paren
id|st
)paren
(brace
r_if
c_cond
(paren
id|st-&gt;l1.act_state
op_eq
l_int|1
)paren
(brace
id|st-&gt;l1.act_state
op_assign
l_int|2
suffix:semicolon
id|st-&gt;l1
dot
id|l1man
c_func
(paren
id|st
comma
id|PH_ACTIVATE
comma
l_int|NULL
)paren
suffix:semicolon
)brace
id|st
op_assign
id|st-&gt;next
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|process_new_ph
id|process_new_ph
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|sp
)paren
(brace
r_if
c_cond
(paren
id|sp-&gt;ph_active
op_eq
l_int|5
)paren
id|act_ivated
c_func
(paren
id|sp
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|process_xmt
id|process_xmt
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|sp
)paren
(brace
r_struct
id|PStack
op_star
id|stptr
suffix:semicolon
r_if
c_cond
(paren
id|sp-&gt;xmtibh
)paren
r_return
suffix:semicolon
id|stptr
op_assign
id|sp-&gt;stlist
suffix:semicolon
r_while
c_loop
(paren
id|stptr
op_ne
l_int|NULL
)paren
r_if
c_cond
(paren
id|stptr-&gt;l1.requestpull
)paren
(brace
id|stptr-&gt;l1.requestpull
op_assign
l_int|0
suffix:semicolon
id|stptr-&gt;l1
dot
id|l1l2
c_func
(paren
id|stptr
comma
id|PH_PULL_ACK
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_else
id|stptr
op_assign
id|stptr-&gt;next
suffix:semicolon
)brace
r_static
r_void
DECL|function|process_rcv
id|process_rcv
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|sp
)paren
(brace
r_struct
id|BufHeader
op_star
id|ibh
comma
op_star
id|cibh
suffix:semicolon
r_struct
id|PStack
op_star
id|stptr
suffix:semicolon
id|byte
op_star
id|ptr
suffix:semicolon
r_int
id|found
comma
id|broadc
suffix:semicolon
r_char
id|tmp
(braket
l_int|64
)braket
suffix:semicolon
r_while
c_loop
(paren
op_logical_neg
id|BufQueueUnlink
c_func
(paren
op_amp
id|ibh
comma
op_amp
id|sp-&gt;rq
)paren
)paren
(brace
id|stptr
op_assign
id|sp-&gt;stlist
suffix:semicolon
id|ptr
op_assign
id|DATAPTR
c_func
(paren
id|ibh
)paren
suffix:semicolon
id|broadc
op_assign
(paren
id|ptr
(braket
l_int|1
)braket
op_rshift
l_int|1
)paren
op_eq
l_int|127
suffix:semicolon
r_if
c_cond
(paren
id|broadc
op_logical_and
id|sp-&gt;dlogflag
op_logical_and
(paren
op_logical_neg
(paren
id|ptr
(braket
l_int|0
)braket
op_rshift
l_int|2
)paren
)paren
)paren
id|dlogframe
c_func
(paren
id|sp
comma
id|ptr
op_plus
l_int|3
comma
id|ibh-&gt;datasize
op_minus
l_int|3
comma
l_string|&quot;Q.931 frame network-&gt;user broadcast&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|broadc
)paren
(brace
r_while
c_loop
(paren
id|stptr
op_ne
l_int|NULL
)paren
(brace
r_if
c_cond
(paren
(paren
id|ptr
(braket
l_int|0
)braket
op_rshift
l_int|2
)paren
op_eq
id|stptr-&gt;l2.sap
)paren
r_if
c_cond
(paren
op_logical_neg
id|BufPoolGet
c_func
(paren
op_amp
id|cibh
comma
op_amp
id|sp-&gt;rbufpool
comma
id|GFP_ATOMIC
comma
(paren
r_void
op_star
)paren
l_int|1
comma
l_int|5
)paren
)paren
(brace
id|memcpy
c_func
(paren
id|DATAPTR
c_func
(paren
id|cibh
)paren
comma
id|DATAPTR
c_func
(paren
id|ibh
)paren
comma
id|ibh-&gt;datasize
)paren
suffix:semicolon
id|cibh-&gt;datasize
op_assign
id|ibh-&gt;datasize
suffix:semicolon
id|stptr-&gt;l1
dot
id|l1l2
c_func
(paren
id|stptr
comma
id|PH_DATA
comma
id|cibh
)paren
suffix:semicolon
)brace
r_else
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;isdn broadcast buffer shortage&bslash;n&quot;
)paren
suffix:semicolon
id|stptr
op_assign
id|stptr-&gt;next
suffix:semicolon
)brace
id|BufPoolRelease
c_func
(paren
id|ibh
)paren
suffix:semicolon
)brace
r_else
(brace
id|found
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|stptr
op_ne
l_int|NULL
)paren
r_if
c_cond
(paren
(paren
(paren
id|ptr
(braket
l_int|0
)braket
op_rshift
l_int|2
)paren
op_eq
id|stptr-&gt;l2.sap
)paren
op_logical_and
(paren
(paren
id|ptr
(braket
l_int|1
)braket
op_rshift
l_int|1
)paren
op_eq
id|stptr-&gt;l2.tei
)paren
)paren
(brace
id|stptr-&gt;l1
dot
id|l1l2
c_func
(paren
id|stptr
comma
id|PH_DATA
comma
id|ibh
)paren
suffix:semicolon
id|found
op_assign
op_logical_neg
l_int|0
suffix:semicolon
r_break
suffix:semicolon
)brace
r_else
id|stptr
op_assign
id|stptr-&gt;next
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|found
)paren
(brace
multiline_comment|/* BD 10.10.95&n;&t;&t;&t;&t; * Print out D-Channel msg not processed&n;&t;&t;&t;&t; * by isdn4linux&n;                                 */
r_if
c_cond
(paren
(paren
op_logical_neg
(paren
id|ptr
(braket
l_int|0
)braket
op_rshift
l_int|2
)paren
)paren
op_logical_and
(paren
op_logical_neg
(paren
id|ptr
(braket
l_int|2
)braket
op_amp
l_int|0x01
)paren
)paren
)paren
(brace
id|sprintf
c_func
(paren
id|tmp
comma
l_string|&quot;Q.931 frame network-&gt;user with tei %d (not for us)&quot;
comma
id|ptr
(braket
l_int|1
)braket
op_rshift
l_int|1
)paren
suffix:semicolon
id|dlogframe
c_func
(paren
id|sp
comma
id|ptr
op_plus
l_int|4
comma
id|ibh-&gt;datasize
op_minus
l_int|4
comma
id|tmp
)paren
suffix:semicolon
)brace
id|BufPoolRelease
c_func
(paren
id|ibh
)paren
suffix:semicolon
)brace
)brace
)brace
)brace
r_static
r_void
DECL|function|isac_bh
id|isac_bh
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|sp
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|sp
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|clear_bit
c_func
(paren
id|ISAC_PHCHANGE
comma
op_amp
id|sp-&gt;event
)paren
)paren
id|process_new_ph
c_func
(paren
id|sp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|clear_bit
c_func
(paren
id|ISAC_RCVBUFREADY
comma
op_amp
id|sp-&gt;event
)paren
)paren
id|process_rcv
c_func
(paren
id|sp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|clear_bit
c_func
(paren
id|ISAC_XMTBUFREADY
comma
op_amp
id|sp-&gt;event
)paren
)paren
id|process_xmt
c_func
(paren
id|sp
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|hscx_process_xmt
id|hscx_process_xmt
c_func
(paren
r_struct
id|HscxState
op_star
id|hsp
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|hsp-&gt;st
suffix:semicolon
r_if
c_cond
(paren
id|hsp-&gt;xmtibh
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|st-&gt;l1.requestpull
)paren
(brace
id|st-&gt;l1.requestpull
op_assign
l_int|0
suffix:semicolon
id|st-&gt;l1
dot
id|l1l2
c_func
(paren
id|st
comma
id|PH_PULL_ACK
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|hsp-&gt;active
)paren
r_if
c_cond
(paren
(paren
op_logical_neg
id|hsp-&gt;xmtibh
)paren
op_logical_and
(paren
op_logical_neg
id|hsp-&gt;sq.head
)paren
)paren
id|modehscx
c_func
(paren
id|hsp
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|hscx_process_rcv
id|hscx_process_rcv
c_func
(paren
r_struct
id|HscxState
op_star
id|hsp
)paren
(brace
r_struct
id|BufHeader
op_star
id|ibh
suffix:semicolon
macro_line|#ifdef DEBUG_MAGIC
r_if
c_cond
(paren
id|hsp-&gt;magic
op_ne
l_int|301270
)paren
(brace
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;hscx_process_rcv magic not 301270&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
macro_line|#endif
r_while
c_loop
(paren
op_logical_neg
id|BufQueueUnlink
c_func
(paren
op_amp
id|ibh
comma
op_amp
id|hsp-&gt;rq
)paren
)paren
(brace
id|hsp-&gt;st-&gt;l1
dot
id|l1l2
c_func
(paren
id|hsp-&gt;st
comma
id|PH_DATA
comma
id|ibh
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|hscx_bh
id|hscx_bh
c_func
(paren
r_struct
id|HscxState
op_star
id|hsp
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|hsp
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|clear_bit
c_func
(paren
id|HSCX_RCVBUFREADY
comma
op_amp
id|hsp-&gt;event
)paren
)paren
id|hscx_process_rcv
c_func
(paren
id|hsp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|clear_bit
c_func
(paren
id|HSCX_XMTBUFREADY
comma
op_amp
id|hsp-&gt;event
)paren
)paren
id|hscx_process_xmt
c_func
(paren
id|hsp
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * interrupt stuff ends here&n; */
r_static
r_void
DECL|function|restart_ph
id|restart_ph
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|sp
)paren
(brace
r_switch
c_cond
(paren
id|sp-&gt;ph_active
)paren
(brace
r_case
(paren
l_int|0
)paren
suffix:colon
r_if
c_cond
(paren
id|sp-&gt;ph_state
op_eq
l_int|6
)paren
id|ph_command
c_func
(paren
id|sp
comma
l_int|0
)paren
suffix:semicolon
r_else
id|ph_command
c_func
(paren
id|sp
comma
l_int|1
)paren
suffix:semicolon
id|sp-&gt;ph_active
op_assign
l_int|1
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|initisac
id|initisac
c_func
(paren
id|byte
op_star
id|cardmem
comma
r_int
id|iobase
)paren
(brace
r_if
c_cond
(paren
id|cardmem
)paren
(brace
id|writeisac_0
c_func
(paren
id|cardmem
comma
id|ISAC_MASK
comma
l_int|0xff
)paren
suffix:semicolon
id|writeisac_0
c_func
(paren
id|cardmem
comma
id|ISAC_ADF2
comma
l_int|0x0
)paren
suffix:semicolon
id|writeisac_0
c_func
(paren
id|cardmem
comma
id|ISAC_SPCR
comma
l_int|0xa
)paren
suffix:semicolon
id|writeisac_0
c_func
(paren
id|cardmem
comma
id|ISAC_ADF1
comma
l_int|0x2
)paren
suffix:semicolon
id|writeisac_0
c_func
(paren
id|cardmem
comma
id|ISAC_STCR
comma
l_int|0x70
)paren
suffix:semicolon
id|writeisac_0
c_func
(paren
id|cardmem
comma
id|ISAC_MODE
comma
l_int|0xc9
)paren
suffix:semicolon
id|writeisac_0
c_func
(paren
id|cardmem
comma
id|ISAC_CMDR
comma
l_int|0x41
)paren
suffix:semicolon
id|writeisac_0
c_func
(paren
id|cardmem
comma
id|ISAC_CIX0
comma
(paren
l_int|1
op_lshift
l_int|2
)paren
op_or
l_int|3
)paren
suffix:semicolon
)brace
r_else
(brace
id|writeisac_3
c_func
(paren
id|iobase
comma
id|ISAC_MASK
comma
l_int|0xff
)paren
suffix:semicolon
id|writeisac_3
c_func
(paren
id|iobase
comma
id|ISAC_ADF2
comma
l_int|0x80
)paren
suffix:semicolon
id|writeisac_3
c_func
(paren
id|iobase
comma
id|ISAC_SQXR
comma
l_int|0x2f
)paren
suffix:semicolon
id|writeisac_3
c_func
(paren
id|iobase
comma
id|ISAC_SPCR
comma
l_int|0x00
)paren
suffix:semicolon
id|writeisac_3
c_func
(paren
id|iobase
comma
id|ISAC_ADF1
comma
l_int|0x02
)paren
suffix:semicolon
id|writeisac_3
c_func
(paren
id|iobase
comma
id|ISAC_STCR
comma
l_int|0x70
)paren
suffix:semicolon
id|writeisac_3
c_func
(paren
id|iobase
comma
id|ISAC_MODE
comma
l_int|0xc9
)paren
suffix:semicolon
id|writeisac_3
c_func
(paren
id|iobase
comma
id|ISAC_TIMR
comma
l_int|0x00
)paren
suffix:semicolon
id|writeisac_3
c_func
(paren
id|iobase
comma
id|ISAC_ADF1
comma
l_int|0x00
)paren
suffix:semicolon
id|writeisac_3
c_func
(paren
id|iobase
comma
id|ISAC_CMDR
comma
l_int|0x41
)paren
suffix:semicolon
id|writeisac_3
c_func
(paren
id|iobase
comma
id|ISAC_CIX0
comma
(paren
l_int|1
op_lshift
l_int|2
)paren
op_or
l_int|3
)paren
suffix:semicolon
)brace
)brace
r_static
r_int
DECL|function|checkcard
id|checkcard
c_func
(paren
r_int
id|cardnr
)paren
(brace
r_int
id|timout
suffix:semicolon
id|byte
id|cfval
comma
id|val
suffix:semicolon
r_struct
id|IsdnCard
op_star
id|card
op_assign
id|cards
op_plus
id|cardnr
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|card-&gt;iobase
)paren
(brace
r_if
c_cond
(paren
id|card-&gt;membase
)paren
(brace
id|printk
c_func
(paren
id|KERN_NOTICE
l_string|&quot;Teles 8 assumed, mem: %lx irq: %d proto: %s&bslash;n&quot;
comma
(paren
r_int
)paren
id|card-&gt;membase
comma
id|card-&gt;interrupt
comma
(paren
id|card-&gt;protocol
op_eq
id|ISDN_PTYPE_1TR6
)paren
ques
c_cond
l_string|&quot;1TR6&quot;
suffix:colon
l_string|&quot;EDSS1&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;HSCX version A: %x B:%x&bslash;n&quot;
comma
id|readhscx_0
c_func
(paren
id|card-&gt;membase
comma
l_int|0
comma
id|HSCX_VSTR
)paren
op_amp
l_int|0xf
comma
id|readhscx_0
c_func
(paren
id|card-&gt;membase
comma
l_int|1
comma
id|HSCX_VSTR
)paren
op_amp
l_int|0xf
)paren
suffix:semicolon
)brace
)brace
r_else
(brace
r_switch
c_cond
(paren
id|card-&gt;iobase
)paren
(brace
r_case
l_int|0x180
suffix:colon
r_case
l_int|0x280
suffix:colon
r_case
l_int|0x380
suffix:colon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;teles: port 0x%x specified, assuming 0x%x&bslash;n&quot;
comma
id|card-&gt;iobase
comma
(paren
id|card-&gt;iobase
op_or
l_int|0xc00
)paren
)paren
suffix:semicolon
id|card-&gt;iobase
op_or_assign
l_int|0xc00
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|check_region
c_func
(paren
id|card-&gt;iobase
comma
l_int|8
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;teles: ports %x-%x already in use&bslash;n&quot;
comma
id|card-&gt;iobase
comma
id|card-&gt;iobase
op_plus
l_int|8
)paren
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|card-&gt;interrupt
)paren
(brace
r_case
l_int|2
suffix:colon
id|cfval
op_assign
l_int|0x00
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
id|cfval
op_assign
l_int|0x02
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|4
suffix:colon
id|cfval
op_assign
l_int|0x04
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
id|cfval
op_assign
l_int|0x06
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|10
suffix:colon
id|cfval
op_assign
l_int|0x08
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|11
suffix:colon
id|cfval
op_assign
l_int|0x0A
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|12
suffix:colon
id|cfval
op_assign
l_int|0x0C
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|15
suffix:colon
id|cfval
op_assign
l_int|0x0E
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|cfval
op_assign
l_int|0x00
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|card-&gt;membase
)paren
(brace
id|cfval
op_or_assign
(paren
(paren
(paren
r_int
r_int
)paren
id|card-&gt;membase
op_rshift
l_int|9
)paren
op_amp
l_int|0xF0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|bytein
c_func
(paren
id|card-&gt;iobase
op_plus
l_int|0
)paren
op_ne
l_int|0x51
)paren
(brace
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;XXX Byte at %x is %x&bslash;n&quot;
comma
id|card-&gt;iobase
op_plus
l_int|0
comma
id|bytein
c_func
(paren
id|card-&gt;iobase
op_plus
l_int|0
)paren
)paren
suffix:semicolon
r_return
op_minus
l_int|2
suffix:semicolon
)brace
r_if
c_cond
(paren
id|bytein
c_func
(paren
id|card-&gt;iobase
op_plus
l_int|1
)paren
op_ne
l_int|0x93
)paren
(brace
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;XXX Byte at %x is %x&bslash;n&quot;
comma
id|card-&gt;iobase
op_plus
l_int|1
comma
id|bytein
c_func
(paren
id|card-&gt;iobase
op_plus
l_int|1
)paren
)paren
suffix:semicolon
r_return
op_minus
l_int|2
suffix:semicolon
)brace
id|val
op_assign
id|bytein
c_func
(paren
id|card-&gt;iobase
op_plus
l_int|2
)paren
suffix:semicolon
multiline_comment|/* 0x1e=without AB&n;                                                         * 0x1f=with AB&n;                                                         */
r_if
c_cond
(paren
id|val
op_ne
l_int|0x1e
op_logical_and
id|val
op_ne
l_int|0x1f
)paren
(brace
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;XXX Byte at %x is %x&bslash;n&quot;
comma
id|card-&gt;iobase
op_plus
l_int|2
comma
id|bytein
c_func
(paren
id|card-&gt;iobase
op_plus
l_int|2
)paren
)paren
suffix:semicolon
r_return
op_minus
l_int|2
suffix:semicolon
)brace
)brace
id|request_region
c_func
(paren
id|card-&gt;iobase
comma
l_int|8
comma
l_string|&quot;teles&quot;
)paren
suffix:semicolon
id|cli
c_func
(paren
)paren
suffix:semicolon
id|timout
op_assign
id|jiffies
op_plus
(paren
id|HZ
op_div
l_int|10
)paren
op_plus
l_int|1
suffix:semicolon
id|byteout
c_func
(paren
id|card-&gt;iobase
op_plus
l_int|4
comma
id|cfval
)paren
suffix:semicolon
id|sti
c_func
(paren
)paren
suffix:semicolon
r_while
c_loop
(paren
id|jiffies
op_le
id|timout
)paren
suffix:semicolon
id|cli
c_func
(paren
)paren
suffix:semicolon
id|timout
op_assign
id|jiffies
op_plus
(paren
id|HZ
op_div
l_int|10
)paren
op_plus
l_int|1
suffix:semicolon
id|byteout
c_func
(paren
id|card-&gt;iobase
op_plus
l_int|4
comma
id|cfval
op_or
l_int|1
)paren
suffix:semicolon
id|sti
c_func
(paren
)paren
suffix:semicolon
r_while
c_loop
(paren
id|jiffies
op_le
id|timout
)paren
suffix:semicolon
r_if
c_cond
(paren
id|card-&gt;membase
)paren
id|printk
c_func
(paren
id|KERN_NOTICE
l_string|&quot;Teles 16.0 found, io: %x mem: %lx irq: %d proto: %s&bslash;n&quot;
comma
id|card-&gt;iobase
comma
(paren
r_int
)paren
id|card-&gt;membase
comma
id|card-&gt;interrupt
comma
(paren
id|card-&gt;protocol
op_eq
id|ISDN_PTYPE_1TR6
)paren
ques
c_cond
l_string|&quot;1TR6&quot;
suffix:colon
l_string|&quot;EDSS1&quot;
)paren
suffix:semicolon
r_else
id|printk
c_func
(paren
id|KERN_NOTICE
l_string|&quot;Teles 16.3 found, io: %x irq: %d proto: %s&bslash;n&quot;
comma
id|card-&gt;iobase
comma
id|card-&gt;interrupt
comma
(paren
id|card-&gt;protocol
op_eq
id|ISDN_PTYPE_1TR6
)paren
ques
c_cond
l_string|&quot;1TR6&quot;
suffix:colon
l_string|&quot;EDSS1&quot;
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;HSCX version A:%x B:%x&bslash;n&quot;
comma
id|READHSCX
c_func
(paren
id|card-&gt;membase
comma
id|card-&gt;iobase
comma
l_int|0
comma
id|HSCX_VSTR
)paren
op_amp
l_int|0xf
comma
id|READHSCX
c_func
(paren
id|card-&gt;membase
comma
id|card-&gt;iobase
comma
l_int|1
comma
id|HSCX_VSTR
)paren
op_amp
l_int|0xf
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|card-&gt;membase
)paren
(brace
id|cli
c_func
(paren
)paren
suffix:semicolon
id|timout
op_assign
id|jiffies
op_plus
(paren
id|HZ
op_div
l_int|5
)paren
op_plus
l_int|1
suffix:semicolon
op_star
(paren
id|byte
op_star
)paren
(paren
id|card-&gt;membase
op_plus
l_int|0x80
)paren
op_assign
l_int|0
suffix:semicolon
id|sti
c_func
(paren
)paren
suffix:semicolon
r_while
c_loop
(paren
id|jiffies
op_le
id|timout
)paren
suffix:semicolon
id|cli
c_func
(paren
)paren
suffix:semicolon
op_star
(paren
id|byte
op_star
)paren
(paren
id|card-&gt;membase
op_plus
l_int|0x80
)paren
op_assign
l_int|1
suffix:semicolon
id|timout
op_assign
id|jiffies
op_plus
(paren
id|HZ
op_div
l_int|5
)paren
op_plus
l_int|1
suffix:semicolon
id|sti
c_func
(paren
)paren
suffix:semicolon
r_while
c_loop
(paren
id|jiffies
op_le
id|timout
)paren
suffix:semicolon
)brace
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_void
DECL|function|modehscx
id|modehscx
c_func
(paren
r_struct
id|HscxState
op_star
id|hs
comma
r_int
id|mode
comma
r_int
id|ichan
)paren
(brace
r_struct
id|IsdnCardState
op_star
id|sp
op_assign
id|hs-&gt;sp
suffix:semicolon
r_int
id|hscx
op_assign
id|hs-&gt;hscx
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;modehscx hscx %d mode %d ichan %d&bslash;n&quot;
comma
id|hscx
comma
id|mode
comma
id|ichan
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hscx
op_eq
l_int|0
)paren
id|ichan
op_assign
l_int|1
op_minus
id|ichan
suffix:semicolon
multiline_comment|/* raar maar waar... */
r_if
c_cond
(paren
id|sp-&gt;membase
)paren
(brace
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_CCR1
comma
l_int|0x85
)paren
suffix:semicolon
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_XAD1
comma
l_int|0xFF
)paren
suffix:semicolon
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_XAD2
comma
l_int|0xFF
)paren
suffix:semicolon
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_RAH2
comma
l_int|0xFF
)paren
suffix:semicolon
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_XBCH
comma
l_int|0x0
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|mode
)paren
(brace
r_case
(paren
l_int|0
)paren
suffix:colon
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_CCR2
comma
l_int|0x30
)paren
suffix:semicolon
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_TSAX
comma
l_int|0xff
)paren
suffix:semicolon
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_TSAR
comma
l_int|0xff
)paren
suffix:semicolon
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_XCCR
comma
l_int|7
)paren
suffix:semicolon
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_RCCR
comma
l_int|7
)paren
suffix:semicolon
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_MODE
comma
l_int|0x84
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
l_int|1
)paren
suffix:colon
r_if
c_cond
(paren
id|ichan
op_eq
l_int|0
)paren
(brace
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_CCR2
comma
l_int|0x30
)paren
suffix:semicolon
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_TSAX
comma
l_int|0x7
)paren
suffix:semicolon
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_TSAR
comma
l_int|0x7
)paren
suffix:semicolon
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_XCCR
comma
l_int|7
)paren
suffix:semicolon
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_RCCR
comma
l_int|7
)paren
suffix:semicolon
)brace
r_else
(brace
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_CCR2
comma
l_int|0x30
)paren
suffix:semicolon
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_TSAX
comma
l_int|0x3
)paren
suffix:semicolon
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_TSAR
comma
l_int|0x3
)paren
suffix:semicolon
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_XCCR
comma
l_int|7
)paren
suffix:semicolon
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_RCCR
comma
l_int|7
)paren
suffix:semicolon
)brace
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_MODE
comma
l_int|0xe4
)paren
suffix:semicolon
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_CMDR
comma
l_int|0x41
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
l_int|2
)paren
suffix:colon
r_if
c_cond
(paren
id|ichan
op_eq
l_int|0
)paren
(brace
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_CCR2
comma
l_int|0x30
)paren
suffix:semicolon
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_TSAX
comma
l_int|0x7
)paren
suffix:semicolon
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_TSAR
comma
l_int|0x7
)paren
suffix:semicolon
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_XCCR
comma
l_int|7
)paren
suffix:semicolon
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_RCCR
comma
l_int|7
)paren
suffix:semicolon
)brace
r_else
(brace
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_CCR2
comma
l_int|0x30
)paren
suffix:semicolon
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_TSAX
comma
l_int|0x3
)paren
suffix:semicolon
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_TSAR
comma
l_int|0x3
)paren
suffix:semicolon
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_XCCR
comma
l_int|7
)paren
suffix:semicolon
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_RCCR
comma
l_int|7
)paren
suffix:semicolon
)brace
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_MODE
comma
l_int|0x8c
)paren
suffix:semicolon
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_CMDR
comma
l_int|0x41
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|writehscx_0
c_func
(paren
id|sp-&gt;membase
comma
id|hscx
comma
id|HSCX_ISTA
comma
l_int|0x00
)paren
suffix:semicolon
)brace
r_else
(brace
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_CCR1
comma
l_int|0x85
)paren
suffix:semicolon
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_XAD1
comma
l_int|0xFF
)paren
suffix:semicolon
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_XAD2
comma
l_int|0xFF
)paren
suffix:semicolon
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_RAH2
comma
l_int|0xFF
)paren
suffix:semicolon
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_XBCH
comma
l_int|0x00
)paren
suffix:semicolon
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_RLCR
comma
l_int|0x00
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|mode
)paren
(brace
r_case
(paren
l_int|0
)paren
suffix:colon
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_CCR2
comma
l_int|0x30
)paren
suffix:semicolon
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_TSAX
comma
l_int|0xff
)paren
suffix:semicolon
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_TSAR
comma
l_int|0xff
)paren
suffix:semicolon
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_XCCR
comma
l_int|7
)paren
suffix:semicolon
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_RCCR
comma
l_int|7
)paren
suffix:semicolon
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_MODE
comma
l_int|0x84
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
l_int|1
)paren
suffix:colon
r_if
c_cond
(paren
id|ichan
op_eq
l_int|0
)paren
(brace
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_CCR2
comma
l_int|0x30
)paren
suffix:semicolon
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_TSAX
comma
l_int|0x2f
)paren
suffix:semicolon
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_TSAR
comma
l_int|0x2f
)paren
suffix:semicolon
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_XCCR
comma
l_int|7
)paren
suffix:semicolon
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_RCCR
comma
l_int|7
)paren
suffix:semicolon
)brace
r_else
(brace
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_CCR2
comma
l_int|0x30
)paren
suffix:semicolon
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_TSAX
comma
l_int|0x3
)paren
suffix:semicolon
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_TSAR
comma
l_int|0x3
)paren
suffix:semicolon
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_XCCR
comma
l_int|7
)paren
suffix:semicolon
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_RCCR
comma
l_int|7
)paren
suffix:semicolon
)brace
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_MODE
comma
l_int|0xe4
)paren
suffix:semicolon
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_CMDR
comma
l_int|0x41
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
l_int|2
)paren
suffix:colon
r_if
c_cond
(paren
id|ichan
op_eq
l_int|0
)paren
(brace
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_CCR2
comma
l_int|0x30
)paren
suffix:semicolon
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_TSAX
comma
l_int|0x2f
)paren
suffix:semicolon
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_TSAR
comma
l_int|0x2f
)paren
suffix:semicolon
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_XCCR
comma
l_int|7
)paren
suffix:semicolon
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_RCCR
comma
l_int|7
)paren
suffix:semicolon
)brace
r_else
(brace
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_CCR2
comma
l_int|0x30
)paren
suffix:semicolon
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_TSAX
comma
l_int|0x3
)paren
suffix:semicolon
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_TSAR
comma
l_int|0x3
)paren
suffix:semicolon
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_XCCR
comma
l_int|7
)paren
suffix:semicolon
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_RCCR
comma
l_int|7
)paren
suffix:semicolon
)brace
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_MODE
comma
l_int|0x8c
)paren
suffix:semicolon
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_CMDR
comma
l_int|0x41
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|writehscx_3
c_func
(paren
id|sp-&gt;iobase
comma
id|hscx
comma
id|HSCX_ISTA
comma
l_int|0x00
)paren
suffix:semicolon
)brace
)brace
r_void
DECL|function|teles_addlist
id|teles_addlist
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|sp
comma
r_struct
id|PStack
op_star
id|st
)paren
(brace
id|st-&gt;next
op_assign
id|sp-&gt;stlist
suffix:semicolon
id|sp-&gt;stlist
op_assign
id|st
suffix:semicolon
)brace
r_void
DECL|function|teles_rmlist
id|teles_rmlist
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|sp
comma
r_struct
id|PStack
op_star
id|st
)paren
(brace
r_struct
id|PStack
op_star
id|p
suffix:semicolon
r_if
c_cond
(paren
id|sp-&gt;stlist
op_eq
id|st
)paren
id|sp-&gt;stlist
op_assign
id|st-&gt;next
suffix:semicolon
r_else
(brace
id|p
op_assign
id|sp-&gt;stlist
suffix:semicolon
r_while
c_loop
(paren
id|p
)paren
r_if
c_cond
(paren
id|p-&gt;next
op_eq
id|st
)paren
(brace
id|p-&gt;next
op_assign
id|st-&gt;next
suffix:semicolon
r_return
suffix:semicolon
)brace
r_else
id|p
op_assign
id|p-&gt;next
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|teles_l2l1
id|teles_l2l1
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|pr
comma
r_struct
id|BufHeader
op_star
id|ibh
)paren
(brace
r_struct
id|IsdnCardState
op_star
id|sp
op_assign
(paren
r_struct
id|IsdnCardState
op_star
)paren
id|st-&gt;l1.hardware
suffix:semicolon
r_switch
c_cond
(paren
id|pr
)paren
(brace
r_case
(paren
id|PH_DATA
)paren
suffix:colon
r_if
c_cond
(paren
id|sp-&gt;xmtibh
)paren
id|BufQueueLink
c_func
(paren
op_amp
id|sp-&gt;sq
comma
id|ibh
)paren
suffix:semicolon
r_else
(brace
id|sp-&gt;xmtibh
op_assign
id|ibh
suffix:semicolon
id|sp-&gt;sendptr
op_assign
l_int|0
suffix:semicolon
id|sp-&gt;releasebuf
op_assign
op_logical_neg
l_int|0
suffix:semicolon
id|fill_fifo
c_func
(paren
id|sp
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
(paren
id|PH_DATA_PULLED
)paren
suffix:colon
r_if
c_cond
(paren
id|sp-&gt;xmtibh
)paren
(brace
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;teles_l2l1: this shouldn&squot;t happen&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|sp-&gt;xmtibh
op_assign
id|ibh
suffix:semicolon
id|sp-&gt;sendptr
op_assign
l_int|0
suffix:semicolon
id|sp-&gt;releasebuf
op_assign
l_int|0
suffix:semicolon
id|fill_fifo
c_func
(paren
id|sp
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|PH_REQUEST_PULL
)paren
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|sp-&gt;xmtibh
)paren
(brace
id|st-&gt;l1.requestpull
op_assign
l_int|0
suffix:semicolon
id|st-&gt;l1
dot
id|l1l2
c_func
(paren
id|st
comma
id|PH_PULL_ACK
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_else
id|st-&gt;l1.requestpull
op_assign
op_logical_neg
l_int|0
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|check_ph_act
id|check_ph_act
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|sp
)paren
(brace
r_struct
id|PStack
op_star
id|st
op_assign
id|sp-&gt;stlist
suffix:semicolon
r_while
c_loop
(paren
id|st
)paren
(brace
r_if
c_cond
(paren
id|st-&gt;l1.act_state
)paren
r_return
suffix:semicolon
id|st
op_assign
id|st-&gt;next
suffix:semicolon
)brace
id|sp-&gt;ph_active
op_assign
l_int|0
suffix:semicolon
)brace
r_static
r_void
DECL|function|teles_manl1
id|teles_manl1
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|IsdnCardState
op_star
id|sp
op_assign
(paren
r_struct
id|IsdnCardState
op_star
)paren
id|st-&gt;l1.hardware
suffix:semicolon
r_int
id|flags
suffix:semicolon
r_switch
c_cond
(paren
id|pr
)paren
(brace
r_case
(paren
id|PH_ACTIVATE
)paren
suffix:colon
id|save_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
id|cli
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|sp-&gt;ph_active
op_eq
l_int|5
)paren
(brace
id|st-&gt;l1.act_state
op_assign
l_int|2
suffix:semicolon
id|restore_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
id|st-&gt;l1
dot
id|l1man
c_func
(paren
id|st
comma
id|PH_ACTIVATE
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_else
(brace
id|st-&gt;l1.act_state
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|sp-&gt;ph_active
op_eq
l_int|0
)paren
id|restart_ph
c_func
(paren
id|sp
)paren
suffix:semicolon
id|restore_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
(paren
id|PH_DEACTIVATE
)paren
suffix:colon
id|st-&gt;l1.act_state
op_assign
l_int|0
suffix:semicolon
id|check_ph_act
c_func
(paren
id|sp
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|teles_l2l1discardq
id|teles_l2l1discardq
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|pr
comma
r_void
op_star
id|heldby
comma
r_int
id|releasetoo
)paren
(brace
r_struct
id|IsdnCardState
op_star
id|sp
op_assign
(paren
r_struct
id|IsdnCardState
op_star
)paren
id|st-&gt;l1.hardware
suffix:semicolon
macro_line|#ifdef DEBUG_MAGIC
r_if
c_cond
(paren
id|sp-&gt;magic
op_ne
l_int|301271
)paren
(brace
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;isac_discardq magic not 301271&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
macro_line|#endif
id|BufQueueDiscard
c_func
(paren
op_amp
id|sp-&gt;sq
comma
id|pr
comma
id|heldby
comma
id|releasetoo
)paren
suffix:semicolon
)brace
r_void
DECL|function|setstack_teles
id|setstack_teles
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_struct
id|IsdnCardState
op_star
id|sp
)paren
(brace
id|st-&gt;l1.hardware
op_assign
id|sp
suffix:semicolon
id|st-&gt;l1.sbufpool
op_assign
op_amp
(paren
id|sp-&gt;sbufpool
)paren
suffix:semicolon
id|st-&gt;l1.rbufpool
op_assign
op_amp
(paren
id|sp-&gt;rbufpool
)paren
suffix:semicolon
id|st-&gt;l1.smallpool
op_assign
op_amp
(paren
id|sp-&gt;smallpool
)paren
suffix:semicolon
id|st-&gt;protocol
op_assign
id|sp-&gt;teistack-&gt;protocol
suffix:semicolon
id|setstack_tei
c_func
(paren
id|st
)paren
suffix:semicolon
id|st-&gt;l1.stlistp
op_assign
op_amp
(paren
id|sp-&gt;stlist
)paren
suffix:semicolon
id|st-&gt;l1.act_state
op_assign
l_int|0
suffix:semicolon
id|st-&gt;l2.l2l1
op_assign
id|teles_l2l1
suffix:semicolon
id|st-&gt;l2.l2l1discardq
op_assign
id|teles_l2l1discardq
suffix:semicolon
id|st-&gt;ma.manl1
op_assign
id|teles_manl1
suffix:semicolon
id|st-&gt;l1.requestpull
op_assign
l_int|0
suffix:semicolon
)brace
r_void
DECL|function|init_hscxstate
id|init_hscxstate
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|sp
comma
r_int
id|hscx
)paren
(brace
r_struct
id|HscxState
op_star
id|hsp
op_assign
id|sp-&gt;hs
op_plus
id|hscx
suffix:semicolon
id|hsp-&gt;sp
op_assign
id|sp
suffix:semicolon
id|hsp-&gt;hscx
op_assign
id|hscx
suffix:semicolon
id|hsp-&gt;membase
op_assign
id|sp-&gt;membase
suffix:semicolon
id|hsp-&gt;iobase
op_assign
id|sp-&gt;iobase
suffix:semicolon
id|hsp-&gt;tqueue.next
op_assign
l_int|0
suffix:semicolon
id|hsp-&gt;tqueue.sync
op_assign
l_int|0
suffix:semicolon
id|hsp-&gt;tqueue.routine
op_assign
(paren
r_void
op_star
)paren
(paren
r_void
op_star
)paren
id|hscx_bh
suffix:semicolon
id|hsp-&gt;tqueue.data
op_assign
id|hsp
suffix:semicolon
id|hsp-&gt;inuse
op_assign
l_int|0
suffix:semicolon
id|hsp-&gt;init
op_assign
l_int|0
suffix:semicolon
id|hsp-&gt;active
op_assign
l_int|0
suffix:semicolon
macro_line|#ifdef DEBUG_MAGIC
id|hsp-&gt;magic
op_assign
l_int|301270
suffix:semicolon
macro_line|#endif
)brace
r_void
DECL|function|initcard
id|initcard
c_func
(paren
r_int
id|cardnr
)paren
(brace
r_struct
id|IsdnCardState
op_star
id|sp
suffix:semicolon
r_struct
id|IsdnCard
op_star
id|card
op_assign
id|cards
op_plus
id|cardnr
suffix:semicolon
id|sp
op_assign
(paren
r_struct
id|IsdnCardState
op_star
)paren
id|Smalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|IsdnCardState
)paren
comma
id|GFP_KERNEL
comma
l_string|&quot;struct IsdnCardState&quot;
)paren
suffix:semicolon
id|sp-&gt;membase
op_assign
id|card-&gt;membase
suffix:semicolon
id|sp-&gt;iobase
op_assign
id|card-&gt;iobase
suffix:semicolon
id|sp-&gt;cardnr
op_assign
id|cardnr
suffix:semicolon
id|BufPoolInit
c_func
(paren
op_amp
id|sp-&gt;sbufpool
comma
id|ISAC_SBUF_ORDER
comma
id|ISAC_SBUF_BPPS
comma
id|ISAC_SBUF_MAXPAGES
)paren
suffix:semicolon
id|BufPoolInit
c_func
(paren
op_amp
id|sp-&gt;rbufpool
comma
id|ISAC_RBUF_ORDER
comma
id|ISAC_RBUF_BPPS
comma
id|ISAC_RBUF_MAXPAGES
)paren
suffix:semicolon
id|BufPoolInit
c_func
(paren
op_amp
id|sp-&gt;smallpool
comma
id|ISAC_SMALLBUF_ORDER
comma
id|ISAC_SMALLBUF_BPPS
comma
id|ISAC_SMALLBUF_MAXPAGES
)paren
suffix:semicolon
id|sp-&gt;dlogspace
op_assign
id|Smalloc
c_func
(paren
l_int|4096
comma
id|GFP_KERNEL
comma
l_string|&quot;dlogspace&quot;
)paren
suffix:semicolon
id|initisac
c_func
(paren
id|card-&gt;membase
comma
id|card-&gt;iobase
)paren
suffix:semicolon
id|sp-&gt;rcvibh
op_assign
l_int|NULL
suffix:semicolon
id|sp-&gt;rcvptr
op_assign
l_int|0
suffix:semicolon
id|sp-&gt;xmtibh
op_assign
l_int|NULL
suffix:semicolon
id|sp-&gt;sendptr
op_assign
l_int|0
suffix:semicolon
id|sp-&gt;event
op_assign
l_int|0
suffix:semicolon
id|sp-&gt;tqueue.next
op_assign
l_int|0
suffix:semicolon
id|sp-&gt;tqueue.sync
op_assign
l_int|0
suffix:semicolon
id|sp-&gt;tqueue.routine
op_assign
(paren
r_void
op_star
)paren
(paren
r_void
op_star
)paren
id|isac_bh
suffix:semicolon
id|sp-&gt;tqueue.data
op_assign
id|sp
suffix:semicolon
id|BufQueueInit
c_func
(paren
op_amp
id|sp-&gt;rq
)paren
suffix:semicolon
id|BufQueueInit
c_func
(paren
op_amp
id|sp-&gt;sq
)paren
suffix:semicolon
id|sp-&gt;stlist
op_assign
l_int|NULL
suffix:semicolon
id|sp-&gt;ph_active
op_assign
l_int|0
suffix:semicolon
id|sp-&gt;dlogflag
op_assign
l_int|0
suffix:semicolon
id|sp-&gt;debug
op_assign
l_int|0
suffix:semicolon
id|sp-&gt;releasebuf
op_assign
l_int|0
suffix:semicolon
macro_line|#ifdef DEBUG_MAGIC
id|sp-&gt;magic
op_assign
l_int|301271
suffix:semicolon
macro_line|#endif
id|cards
(braket
id|sp-&gt;cardnr
)braket
dot
id|sp
op_assign
id|sp
suffix:semicolon
id|init_hscxstate
c_func
(paren
id|sp
comma
l_int|0
)paren
suffix:semicolon
id|init_hscxstate
c_func
(paren
id|sp
comma
l_int|1
)paren
suffix:semicolon
id|modehscx
c_func
(paren
id|sp-&gt;hs
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|modehscx
c_func
(paren
id|sp-&gt;hs
op_plus
l_int|1
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|WRITEISAC
c_func
(paren
id|sp-&gt;membase
comma
id|sp-&gt;iobase
comma
id|ISAC_MASK
comma
l_int|0x0
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|get_irq
id|get_irq
c_func
(paren
r_int
id|cardnr
)paren
(brace
r_struct
id|IsdnCard
op_star
id|card
op_assign
id|cards
op_plus
id|cardnr
suffix:semicolon
r_int
id|flags
suffix:semicolon
id|save_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
id|cli
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|request_irq
c_func
(paren
id|card-&gt;interrupt
comma
op_amp
id|teles_interrupt
comma
id|SA_INTERRUPT
comma
l_string|&quot;teles&quot;
comma
l_int|NULL
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;Teles couldn&squot;t get interrupt %d&bslash;n&quot;
comma
id|card-&gt;interrupt
)paren
suffix:semicolon
id|restore_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
r_return
(paren
op_logical_neg
l_int|0
)paren
suffix:semicolon
)brace
id|irq2dev_map
(braket
id|card-&gt;interrupt
)braket
op_assign
(paren
r_void
op_star
)paren
id|card-&gt;sp
suffix:semicolon
id|restore_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|release_irq
id|release_irq
c_func
(paren
r_int
id|cardnr
)paren
(brace
r_struct
id|IsdnCard
op_star
id|card
op_assign
id|cards
op_plus
id|cardnr
suffix:semicolon
id|irq2dev_map
(braket
id|card-&gt;interrupt
)braket
op_assign
l_int|NULL
suffix:semicolon
id|free_irq
c_func
(paren
id|card-&gt;interrupt
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_void
DECL|function|close_hscxstate
id|close_hscxstate
c_func
(paren
r_struct
id|HscxState
op_star
id|hs
)paren
(brace
id|modehscx
c_func
(paren
id|hs
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|hs-&gt;inuse
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|hs-&gt;init
)paren
(brace
id|BufPoolFree
c_func
(paren
op_amp
id|hs-&gt;smallpool
)paren
suffix:semicolon
id|BufPoolFree
c_func
(paren
op_amp
id|hs-&gt;rbufpool
)paren
suffix:semicolon
id|BufPoolFree
c_func
(paren
op_amp
id|hs-&gt;sbufpool
)paren
suffix:semicolon
)brace
id|hs-&gt;init
op_assign
l_int|0
suffix:semicolon
)brace
r_void
DECL|function|closecard
id|closecard
c_func
(paren
r_int
id|cardnr
)paren
(brace
r_struct
id|IsdnCardState
op_star
id|sp
op_assign
id|cards
(braket
id|cardnr
)braket
dot
id|sp
suffix:semicolon
id|cards
(braket
id|cardnr
)braket
dot
id|sp
op_assign
l_int|NULL
suffix:semicolon
id|Sfree
c_func
(paren
id|sp-&gt;dlogspace
)paren
suffix:semicolon
id|BufPoolFree
c_func
(paren
op_amp
id|sp-&gt;smallpool
)paren
suffix:semicolon
id|BufPoolFree
c_func
(paren
op_amp
id|sp-&gt;rbufpool
)paren
suffix:semicolon
id|BufPoolFree
c_func
(paren
op_amp
id|sp-&gt;sbufpool
)paren
suffix:semicolon
id|close_hscxstate
c_func
(paren
id|sp-&gt;hs
op_plus
l_int|1
)paren
suffix:semicolon
id|close_hscxstate
c_func
(paren
id|sp-&gt;hs
)paren
suffix:semicolon
r_if
c_cond
(paren
id|cards
(braket
id|cardnr
)braket
dot
id|iobase
)paren
id|release_region
c_func
(paren
id|cards
(braket
id|cardnr
)braket
dot
id|iobase
comma
l_int|8
)paren
suffix:semicolon
id|Sfree
c_func
(paren
(paren
r_void
op_star
)paren
id|sp
)paren
suffix:semicolon
)brace
r_void
DECL|function|teles_shiftcards
id|teles_shiftcards
c_func
(paren
r_int
id|idx
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
id|idx
suffix:semicolon
id|i
OL
l_int|15
suffix:semicolon
id|i
op_increment
)paren
id|memcpy
c_func
(paren
op_amp
id|cards
(braket
id|i
)braket
comma
op_amp
id|cards
(braket
id|i
op_plus
l_int|1
)braket
comma
r_sizeof
(paren
id|cards
(braket
id|i
)braket
)paren
)paren
suffix:semicolon
)brace
r_int
DECL|function|teles_inithardware
id|teles_inithardware
c_func
(paren
r_void
)paren
(brace
r_int
id|foundcards
op_assign
l_int|0
suffix:semicolon
r_int
id|i
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|i
OL
id|nrcards
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|cards
(braket
id|i
)braket
dot
id|protocol
)paren
r_break
suffix:semicolon
r_switch
c_cond
(paren
id|checkcard
c_func
(paren
id|i
)paren
)paren
(brace
r_case
(paren
l_int|0
)paren
suffix:colon
id|initcard
c_func
(paren
id|i
)paren
suffix:semicolon
r_if
c_cond
(paren
id|get_irq
c_func
(paren
id|i
)paren
)paren
(brace
id|closecard
c_func
(paren
id|i
)paren
suffix:semicolon
id|teles_shiftcards
c_func
(paren
id|i
)paren
suffix:semicolon
)brace
r_else
(brace
id|foundcards
op_increment
suffix:semicolon
id|i
op_increment
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
(paren
op_minus
l_int|1
)paren
suffix:colon
id|teles_shiftcards
c_func
(paren
id|i
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
op_minus
l_int|2
)paren
suffix:colon
id|release_region
c_func
(paren
id|cards
(braket
id|i
)braket
dot
id|iobase
comma
l_int|8
)paren
suffix:semicolon
id|teles_shiftcards
c_func
(paren
id|i
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;NO Teles card found at 0x%x!&bslash;n&quot;
comma
id|cards
(braket
id|i
)braket
dot
id|iobase
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_return
id|foundcards
suffix:semicolon
)brace
r_void
DECL|function|teles_closehardware
id|teles_closehardware
c_func
(paren
r_void
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|nrcards
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|cards
(braket
id|i
)braket
dot
id|sp
)paren
(brace
id|release_irq
c_func
(paren
id|i
)paren
suffix:semicolon
id|closecard
c_func
(paren
id|i
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|hscx_l2l1
id|hscx_l2l1
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|pr
comma
r_struct
id|BufHeader
op_star
id|ibh
)paren
(brace
r_struct
id|IsdnCardState
op_star
id|sp
op_assign
(paren
r_struct
id|IsdnCardState
op_star
)paren
id|st-&gt;l1.hardware
suffix:semicolon
r_struct
id|HscxState
op_star
id|hsp
op_assign
id|sp-&gt;hs
op_plus
id|st-&gt;l1.hscx
suffix:semicolon
r_switch
c_cond
(paren
id|pr
)paren
(brace
r_case
(paren
id|PH_DATA
)paren
suffix:colon
r_if
c_cond
(paren
id|hsp-&gt;xmtibh
)paren
id|BufQueueLink
c_func
(paren
op_amp
id|hsp-&gt;sq
comma
id|ibh
)paren
suffix:semicolon
r_else
(brace
id|hsp-&gt;xmtibh
op_assign
id|ibh
suffix:semicolon
id|hsp-&gt;sendptr
op_assign
l_int|0
suffix:semicolon
id|hsp-&gt;releasebuf
op_assign
op_logical_neg
l_int|0
suffix:semicolon
id|hscx_fill_fifo
c_func
(paren
id|hsp
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
(paren
id|PH_DATA_PULLED
)paren
suffix:colon
r_if
c_cond
(paren
id|hsp-&gt;xmtibh
)paren
(brace
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;hscx_l2l1: this shouldn&squot;t happen&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|hsp-&gt;xmtibh
op_assign
id|ibh
suffix:semicolon
id|hsp-&gt;sendptr
op_assign
l_int|0
suffix:semicolon
id|hsp-&gt;releasebuf
op_assign
l_int|0
suffix:semicolon
id|hscx_fill_fifo
c_func
(paren
id|hsp
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|PH_REQUEST_PULL
)paren
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|hsp-&gt;xmtibh
)paren
(brace
id|st-&gt;l1.requestpull
op_assign
l_int|0
suffix:semicolon
id|st-&gt;l1
dot
id|l1l2
c_func
(paren
id|st
comma
id|PH_PULL_ACK
comma
l_int|NULL
)paren
suffix:semicolon
)brace
r_else
id|st-&gt;l1.requestpull
op_assign
op_logical_neg
l_int|0
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_extern
r_struct
id|IsdnBuffers
op_star
id|tracebuf
suffix:semicolon
r_static
r_void
DECL|function|hscx_l2l1discardq
id|hscx_l2l1discardq
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|pr
comma
r_void
op_star
id|heldby
comma
r_int
id|releasetoo
)paren
(brace
r_struct
id|IsdnCardState
op_star
id|sp
op_assign
(paren
r_struct
id|IsdnCardState
op_star
)paren
id|st-&gt;l1.hardware
suffix:semicolon
r_struct
id|HscxState
op_star
id|hsp
op_assign
id|sp-&gt;hs
op_plus
id|st-&gt;l1.hscx
suffix:semicolon
macro_line|#ifdef DEBUG_MAGIC
r_if
c_cond
(paren
id|hsp-&gt;magic
op_ne
l_int|301270
)paren
(brace
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;hscx_discardq magic not 301270&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
macro_line|#endif
id|BufQueueDiscard
c_func
(paren
op_amp
id|hsp-&gt;sq
comma
id|pr
comma
id|heldby
comma
id|releasetoo
)paren
suffix:semicolon
)brace
r_static
r_int
DECL|function|open_hscxstate
id|open_hscxstate
c_func
(paren
r_struct
id|IsdnCardState
op_star
id|sp
comma
r_int
id|hscx
)paren
(brace
r_struct
id|HscxState
op_star
id|hsp
op_assign
id|sp-&gt;hs
op_plus
id|hscx
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|hsp-&gt;init
)paren
(brace
id|BufPoolInit
c_func
(paren
op_amp
id|hsp-&gt;sbufpool
comma
id|HSCX_SBUF_ORDER
comma
id|HSCX_SBUF_BPPS
comma
id|HSCX_SBUF_MAXPAGES
)paren
suffix:semicolon
id|BufPoolInit
c_func
(paren
op_amp
id|hsp-&gt;rbufpool
comma
id|HSCX_RBUF_ORDER
comma
id|HSCX_RBUF_BPPS
comma
id|HSCX_RBUF_MAXPAGES
)paren
suffix:semicolon
id|BufPoolInit
c_func
(paren
op_amp
id|hsp-&gt;smallpool
comma
id|HSCX_SMALLBUF_ORDER
comma
id|HSCX_SMALLBUF_BPPS
comma
id|HSCX_SMALLBUF_MAXPAGES
)paren
suffix:semicolon
)brace
id|hsp-&gt;init
op_assign
op_logical_neg
l_int|0
suffix:semicolon
id|BufQueueInit
c_func
(paren
op_amp
id|hsp-&gt;rq
)paren
suffix:semicolon
id|BufQueueInit
c_func
(paren
op_amp
id|hsp-&gt;sq
)paren
suffix:semicolon
id|hsp-&gt;releasebuf
op_assign
l_int|0
suffix:semicolon
id|hsp-&gt;rcvibh
op_assign
l_int|NULL
suffix:semicolon
id|hsp-&gt;xmtibh
op_assign
l_int|NULL
suffix:semicolon
id|hsp-&gt;rcvptr
op_assign
l_int|0
suffix:semicolon
id|hsp-&gt;sendptr
op_assign
l_int|0
suffix:semicolon
id|hsp-&gt;event
op_assign
l_int|0
suffix:semicolon
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|hscx_manl1
id|hscx_manl1
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_int
id|pr
comma
r_void
op_star
id|arg
)paren
(brace
r_struct
id|IsdnCardState
op_star
id|sp
op_assign
(paren
r_struct
id|IsdnCardState
op_star
)paren
id|st-&gt;l1.hardware
suffix:semicolon
r_struct
id|HscxState
op_star
id|hsp
op_assign
id|sp-&gt;hs
op_plus
id|st-&gt;l1.hscx
suffix:semicolon
r_switch
c_cond
(paren
id|pr
)paren
(brace
r_case
(paren
id|PH_ACTIVATE
)paren
suffix:colon
id|hsp-&gt;active
op_assign
op_logical_neg
l_int|0
suffix:semicolon
id|modehscx
c_func
(paren
id|hsp
comma
id|st-&gt;l1.hscxmode
comma
id|st-&gt;l1.hscxchannel
)paren
suffix:semicolon
id|st-&gt;l1
dot
id|l1man
c_func
(paren
id|st
comma
id|PH_ACTIVATE
comma
l_int|NULL
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
(paren
id|PH_DEACTIVATE
)paren
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|hsp-&gt;xmtibh
)paren
id|modehscx
c_func
(paren
id|hsp
comma
l_int|0
comma
l_int|0
)paren
suffix:semicolon
id|hsp-&gt;active
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_int
DECL|function|setstack_hscx
id|setstack_hscx
c_func
(paren
r_struct
id|PStack
op_star
id|st
comma
r_struct
id|HscxState
op_star
id|hs
)paren
(brace
r_if
c_cond
(paren
id|open_hscxstate
c_func
(paren
id|st-&gt;l1.hardware
comma
id|hs-&gt;hscx
)paren
)paren
r_return
(paren
op_minus
l_int|1
)paren
suffix:semicolon
id|st-&gt;l1.hscx
op_assign
id|hs-&gt;hscx
suffix:semicolon
id|st-&gt;l2.l2l1
op_assign
id|hscx_l2l1
suffix:semicolon
id|st-&gt;ma.manl1
op_assign
id|hscx_manl1
suffix:semicolon
id|st-&gt;l2.l2l1discardq
op_assign
id|hscx_l2l1discardq
suffix:semicolon
id|st-&gt;l1.sbufpool
op_assign
op_amp
id|hs-&gt;sbufpool
suffix:semicolon
id|st-&gt;l1.rbufpool
op_assign
op_amp
id|hs-&gt;rbufpool
suffix:semicolon
id|st-&gt;l1.smallpool
op_assign
op_amp
id|hs-&gt;smallpool
suffix:semicolon
id|st-&gt;l1.act_state
op_assign
l_int|0
suffix:semicolon
id|st-&gt;l1.requestpull
op_assign
l_int|0
suffix:semicolon
id|hs-&gt;st
op_assign
id|st
suffix:semicolon
r_return
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_void
DECL|function|teles_reportcard
id|teles_reportcard
c_func
(paren
r_int
id|cardnr
)paren
(brace
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;teles_reportcard&bslash;n&quot;
)paren
suffix:semicolon
)brace
eof
