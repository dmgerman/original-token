multiline_comment|/*&n; * $Id: capiutil.c,v 1.13 2000/11/23 20:45:14 kai Exp $&n; *&n; * CAPI 2.0 convert capi message to capi message struct&n; *&n; * From CAPI 2.0 Development Kit AVM 1995 (msg.c)&n; * Rewritten for Linux 1996 by Carsten Paeth (calle@calle.in-berlin.de)&n; *&n; * $Log: capiutil.c,v $&n; * Revision 1.13  2000/11/23 20:45:14  kai&n; * fixed module_init/exit stuff&n; * Note: compiled-in kernel doesn&squot;t work pre 2.2.18 anymore.&n; *&n; * Revision 1.12  2000/11/01 14:05:02  calle&n; * - use module_init/module_exit from linux/init.h.&n; * - all static struct variables are initialized with &quot;membername:&quot; now.&n; * - avm_cs.c, let it work with newer pcmcia-cs.&n; *&n; * Revision 1.11  2000/03/03 15:50:42  calle&n; * - kernel CAPI:&n; *   - Changed parameter &quot;param&quot; in capi_signal from __u32 to void *.&n; *   - rewrote notifier handling in kcapi.c&n; *   - new notifier NCCI_UP and NCCI_DOWN&n; * - User CAPI:&n; *   - /dev/capi20 is now a cloning device.&n; *   - middleware extentions prepared.&n; * - capidrv.c&n; *   - locking of list operations and module count updates.&n; *&n; * Revision 1.10  1999/08/31 11:19:54  paul&n; * various spelling corrections (new checksums may be needed, Karsten!)&n; *&n; * Revision 1.9  1999/07/09 15:05:46  keil&n; * compat.h is now isdn_compat.h&n; *&n; * Revision 1.8  1999/07/01 15:26:37  calle&n; * complete new version (I love it):&n; * + new hardware independed &quot;capi_driver&quot; interface that will make it easy to:&n; *   - support other controllers with CAPI-2.0 (i.e. USB Controller)&n; *   - write a CAPI-2.0 for the passive cards&n; *   - support serial link CAPI-2.0 boxes.&n; * + wrote &quot;capi_driver&quot; for all supported cards.&n; * + &quot;capi_driver&quot; (supported cards) now have to be configured with&n; *   make menuconfig, in the past all supported cards where included&n; *   at once.&n; * + new and better informations in /proc/capi/&n; * + new ioctl to switch trace of capi messages per controller&n; *   using &quot;avmcapictrl trace [contr] on|off|....&quot;&n; * + complete testcircle with all supported cards and also the&n; *   PCMCIA cards (now patch for pcmcia-cs-3.0.13 needed) done.&n; *&n; * Revision 1.7  1999/07/01 08:23:01  keil&n; * compatibility macros now in &lt;linux/isdn_compat.h&gt;&n; *&n; * Revision 1.6  1997/11/04 06:12:12  calle&n; * capi.c: new read/write in file_ops since 2.1.60&n; * capidrv.c: prepared isdnlog interface for d2-trace in newer firmware.&n; * capiutil.c: needs config.h (CONFIG_ISDN_DRV_AVMB1_VERBOSE_REASON)&n; * compat.h: added #define LinuxVersionCode&n; *&n; * Revision 1.5  1997/10/01 09:21:19  fritz&n; * Removed old compatibility stuff for 2.0.X kernels.&n; * From now on, this code is for 2.1.X ONLY!&n; * Old stuff is still in the separate branch.&n; *&n; * Revision 1.4  1997/08/10 07:43:55  calle&n; * forgot to export symbol capi_info2str for 2.1.x&n; *&n; * Revision 1.3  1997/05/18 09:24:18  calle&n; * added verbose disconnect reason reporting to avmb1.&n; * some fixes in capi20 interface.&n; * changed info messages for B1-PCI&n; *&n; * Revision 1.2  1997/03/05 21:22:13  fritz&n; * Fix: Symbols have to be exported unconditionally.&n; *&n; * Revision 1.1  1997/03/04 21:50:34  calle&n; * Frirst version in isdn4linux&n; *&n; * Revision 2.2  1997/02/12 09:31:39  calle&n; * new version&n; *&n; * Revision 1.1  1997/01/31 10:32:20  calle&n; * Initial revision&n; *&n; */
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/string.h&gt;
macro_line|#include &lt;linux/ctype.h&gt;
macro_line|#include &lt;linux/stddef.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;asm/segment.h&gt;
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &quot;capiutil.h&quot;
multiline_comment|/* from CAPI2.0 DDK AVM Berlin GmbH */
macro_line|#ifndef CONFIG_ISDN_DRV_AVMB1_VERBOSE_REASON
DECL|function|capi_info2str
r_char
op_star
id|capi_info2str
c_func
(paren
id|__u16
id|reason
)paren
(brace
r_return
l_string|&quot;..&quot;
suffix:semicolon
)brace
macro_line|#else
DECL|function|capi_info2str
r_char
op_star
id|capi_info2str
c_func
(paren
id|__u16
id|reason
)paren
(brace
r_switch
c_cond
(paren
id|reason
)paren
(brace
multiline_comment|/*-- informative values (corresponding message was processed) -----*/
r_case
l_int|0x0001
suffix:colon
r_return
l_string|&quot;NCPI not supported by current protocol, NCPI ignored&quot;
suffix:semicolon
r_case
l_int|0x0002
suffix:colon
r_return
l_string|&quot;Flags not supported by current protocol, flags ignored&quot;
suffix:semicolon
r_case
l_int|0x0003
suffix:colon
r_return
l_string|&quot;Alert already sent by another application&quot;
suffix:semicolon
multiline_comment|/*-- error information concerning CAPI_REGISTER -----*/
r_case
l_int|0x1001
suffix:colon
r_return
l_string|&quot;Too many applications&quot;
suffix:semicolon
r_case
l_int|0x1002
suffix:colon
r_return
l_string|&quot;Logical block size too small, must be at least 128 Bytes&quot;
suffix:semicolon
r_case
l_int|0x1003
suffix:colon
r_return
l_string|&quot;Buffer exceeds 64 kByte&quot;
suffix:semicolon
r_case
l_int|0x1004
suffix:colon
r_return
l_string|&quot;Message buffer size too small, must be at least 1024 Bytes&quot;
suffix:semicolon
r_case
l_int|0x1005
suffix:colon
r_return
l_string|&quot;Max. number of logical connections not supported&quot;
suffix:semicolon
r_case
l_int|0x1006
suffix:colon
r_return
l_string|&quot;Reserved&quot;
suffix:semicolon
r_case
l_int|0x1007
suffix:colon
r_return
l_string|&quot;The message could not be accepted because of an internal busy condition&quot;
suffix:semicolon
r_case
l_int|0x1008
suffix:colon
r_return
l_string|&quot;OS resource error (no memory ?)&quot;
suffix:semicolon
r_case
l_int|0x1009
suffix:colon
r_return
l_string|&quot;CAPI not installed&quot;
suffix:semicolon
r_case
l_int|0x100A
suffix:colon
r_return
l_string|&quot;Controller does not support external equipment&quot;
suffix:semicolon
r_case
l_int|0x100B
suffix:colon
r_return
l_string|&quot;Controller does only support external equipment&quot;
suffix:semicolon
multiline_comment|/*-- error information concerning message exchange functions -----*/
r_case
l_int|0x1101
suffix:colon
r_return
l_string|&quot;Illegal application number&quot;
suffix:semicolon
r_case
l_int|0x1102
suffix:colon
r_return
l_string|&quot;Illegal command or subcommand or message length less than 12 bytes&quot;
suffix:semicolon
r_case
l_int|0x1103
suffix:colon
r_return
l_string|&quot;The message could not be accepted because of a queue full condition !! The error code does not imply that CAPI cannot receive messages directed to another controller, PLCI or NCCI&quot;
suffix:semicolon
r_case
l_int|0x1104
suffix:colon
r_return
l_string|&quot;Queue is empty&quot;
suffix:semicolon
r_case
l_int|0x1105
suffix:colon
r_return
l_string|&quot;Queue overflow, a message was lost !! This indicates a configuration error. The only recovery from this error is to perform a CAPI_RELEASE&quot;
suffix:semicolon
r_case
l_int|0x1106
suffix:colon
r_return
l_string|&quot;Unknown notification parameter&quot;
suffix:semicolon
r_case
l_int|0x1107
suffix:colon
r_return
l_string|&quot;The Message could not be accepted because of an internal busy condition&quot;
suffix:semicolon
r_case
l_int|0x1108
suffix:colon
r_return
l_string|&quot;OS Resource error (no memory ?)&quot;
suffix:semicolon
r_case
l_int|0x1109
suffix:colon
r_return
l_string|&quot;CAPI not installed&quot;
suffix:semicolon
r_case
l_int|0x110A
suffix:colon
r_return
l_string|&quot;Controller does not support external equipment&quot;
suffix:semicolon
r_case
l_int|0x110B
suffix:colon
r_return
l_string|&quot;Controller does only support external equipment&quot;
suffix:semicolon
multiline_comment|/*-- error information concerning resource / coding problems -----*/
r_case
l_int|0x2001
suffix:colon
r_return
l_string|&quot;Message not supported in current state&quot;
suffix:semicolon
r_case
l_int|0x2002
suffix:colon
r_return
l_string|&quot;Illegal Controller / PLCI / NCCI&quot;
suffix:semicolon
r_case
l_int|0x2003
suffix:colon
r_return
l_string|&quot;Out of PLCI&quot;
suffix:semicolon
r_case
l_int|0x2004
suffix:colon
r_return
l_string|&quot;Out of NCCI&quot;
suffix:semicolon
r_case
l_int|0x2005
suffix:colon
r_return
l_string|&quot;Out of LISTEN&quot;
suffix:semicolon
r_case
l_int|0x2006
suffix:colon
r_return
l_string|&quot;Out of FAX resources (protocol T.30)&quot;
suffix:semicolon
r_case
l_int|0x2007
suffix:colon
r_return
l_string|&quot;Illegal message parameter coding&quot;
suffix:semicolon
multiline_comment|/*-- error information concerning requested services  -----*/
r_case
l_int|0x3001
suffix:colon
r_return
l_string|&quot;B1 protocol not supported&quot;
suffix:semicolon
r_case
l_int|0x3002
suffix:colon
r_return
l_string|&quot;B2 protocol not supported&quot;
suffix:semicolon
r_case
l_int|0x3003
suffix:colon
r_return
l_string|&quot;B3 protocol not supported&quot;
suffix:semicolon
r_case
l_int|0x3004
suffix:colon
r_return
l_string|&quot;B1 protocol parameter not supported&quot;
suffix:semicolon
r_case
l_int|0x3005
suffix:colon
r_return
l_string|&quot;B2 protocol parameter not supported&quot;
suffix:semicolon
r_case
l_int|0x3006
suffix:colon
r_return
l_string|&quot;B3 protocol parameter not supported&quot;
suffix:semicolon
r_case
l_int|0x3007
suffix:colon
r_return
l_string|&quot;B protocol combination not supported&quot;
suffix:semicolon
r_case
l_int|0x3008
suffix:colon
r_return
l_string|&quot;NCPI not supported&quot;
suffix:semicolon
r_case
l_int|0x3009
suffix:colon
r_return
l_string|&quot;CIP Value unknown&quot;
suffix:semicolon
r_case
l_int|0x300A
suffix:colon
r_return
l_string|&quot;Flags not supported (reserved bits)&quot;
suffix:semicolon
r_case
l_int|0x300B
suffix:colon
r_return
l_string|&quot;Facility not supported&quot;
suffix:semicolon
r_case
l_int|0x300C
suffix:colon
r_return
l_string|&quot;Data length not supported by current protocol&quot;
suffix:semicolon
r_case
l_int|0x300D
suffix:colon
r_return
l_string|&quot;Reset procedure not supported by current protocol&quot;
suffix:semicolon
multiline_comment|/*-- informations about the clearing of a physical connection -----*/
r_case
l_int|0x3301
suffix:colon
r_return
l_string|&quot;Protocol error layer 1 (broken line or B-channel removed by signalling protocol)&quot;
suffix:semicolon
r_case
l_int|0x3302
suffix:colon
r_return
l_string|&quot;Protocol error layer 2&quot;
suffix:semicolon
r_case
l_int|0x3303
suffix:colon
r_return
l_string|&quot;Protocol error layer 3&quot;
suffix:semicolon
r_case
l_int|0x3304
suffix:colon
r_return
l_string|&quot;Another application got that call&quot;
suffix:semicolon
multiline_comment|/*-- T.30 specific reasons -----*/
r_case
l_int|0x3311
suffix:colon
r_return
l_string|&quot;Connecting not successful (remote station is no FAX G3 machine)&quot;
suffix:semicolon
r_case
l_int|0x3312
suffix:colon
r_return
l_string|&quot;Connecting not successful (training error)&quot;
suffix:semicolon
r_case
l_int|0x3313
suffix:colon
r_return
l_string|&quot;Disconnected before transfer (remote station does not support transfer mode, e.g. resolution)&quot;
suffix:semicolon
r_case
l_int|0x3314
suffix:colon
r_return
l_string|&quot;Disconnected during transfer (remote abort)&quot;
suffix:semicolon
r_case
l_int|0x3315
suffix:colon
r_return
l_string|&quot;Disconnected during transfer (remote procedure error, e.g. unsuccessful repetition of T.30 commands)&quot;
suffix:semicolon
r_case
l_int|0x3316
suffix:colon
r_return
l_string|&quot;Disconnected during transfer (local tx data underrun)&quot;
suffix:semicolon
r_case
l_int|0x3317
suffix:colon
r_return
l_string|&quot;Disconnected during transfer (local rx data overflow)&quot;
suffix:semicolon
r_case
l_int|0x3318
suffix:colon
r_return
l_string|&quot;Disconnected during transfer (local abort)&quot;
suffix:semicolon
r_case
l_int|0x3319
suffix:colon
r_return
l_string|&quot;Illegal parameter coding (e.g. SFF coding error)&quot;
suffix:semicolon
multiline_comment|/*-- disconnect causes from the network according to ETS 300 102-1/Q.931 -----*/
r_case
l_int|0x3481
suffix:colon
r_return
l_string|&quot;Unallocated (unassigned) number&quot;
suffix:semicolon
r_case
l_int|0x3482
suffix:colon
r_return
l_string|&quot;No route to specified transit network&quot;
suffix:semicolon
r_case
l_int|0x3483
suffix:colon
r_return
l_string|&quot;No route to destination&quot;
suffix:semicolon
r_case
l_int|0x3486
suffix:colon
r_return
l_string|&quot;Channel unacceptable&quot;
suffix:semicolon
r_case
l_int|0x3487
suffix:colon
r_return
l_string|&quot;Call awarded and being delivered in an established channel&quot;
suffix:semicolon
r_case
l_int|0x3490
suffix:colon
r_return
l_string|&quot;Normal call clearing&quot;
suffix:semicolon
r_case
l_int|0x3491
suffix:colon
r_return
l_string|&quot;User busy&quot;
suffix:semicolon
r_case
l_int|0x3492
suffix:colon
r_return
l_string|&quot;No user responding&quot;
suffix:semicolon
r_case
l_int|0x3493
suffix:colon
r_return
l_string|&quot;No answer from user (user alerted)&quot;
suffix:semicolon
r_case
l_int|0x3495
suffix:colon
r_return
l_string|&quot;Call rejected&quot;
suffix:semicolon
r_case
l_int|0x3496
suffix:colon
r_return
l_string|&quot;Number changed&quot;
suffix:semicolon
r_case
l_int|0x349A
suffix:colon
r_return
l_string|&quot;Non-selected user clearing&quot;
suffix:semicolon
r_case
l_int|0x349B
suffix:colon
r_return
l_string|&quot;Destination out of order&quot;
suffix:semicolon
r_case
l_int|0x349C
suffix:colon
r_return
l_string|&quot;Invalid number format&quot;
suffix:semicolon
r_case
l_int|0x349D
suffix:colon
r_return
l_string|&quot;Facility rejected&quot;
suffix:semicolon
r_case
l_int|0x349E
suffix:colon
r_return
l_string|&quot;Response to STATUS ENQUIRY&quot;
suffix:semicolon
r_case
l_int|0x349F
suffix:colon
r_return
l_string|&quot;Normal, unspecified&quot;
suffix:semicolon
r_case
l_int|0x34A2
suffix:colon
r_return
l_string|&quot;No circuit / channel available&quot;
suffix:semicolon
r_case
l_int|0x34A6
suffix:colon
r_return
l_string|&quot;Network out of order&quot;
suffix:semicolon
r_case
l_int|0x34A9
suffix:colon
r_return
l_string|&quot;Temporary failure&quot;
suffix:semicolon
r_case
l_int|0x34AA
suffix:colon
r_return
l_string|&quot;Switching equipment congestion&quot;
suffix:semicolon
r_case
l_int|0x34AB
suffix:colon
r_return
l_string|&quot;Access information discarded&quot;
suffix:semicolon
r_case
l_int|0x34AC
suffix:colon
r_return
l_string|&quot;Requested circuit / channel not available&quot;
suffix:semicolon
r_case
l_int|0x34AF
suffix:colon
r_return
l_string|&quot;Resources unavailable, unspecified&quot;
suffix:semicolon
r_case
l_int|0x34B1
suffix:colon
r_return
l_string|&quot;Quality of service unavailable&quot;
suffix:semicolon
r_case
l_int|0x34B2
suffix:colon
r_return
l_string|&quot;Requested facility not subscribed&quot;
suffix:semicolon
r_case
l_int|0x34B9
suffix:colon
r_return
l_string|&quot;Bearer capability not authorized&quot;
suffix:semicolon
r_case
l_int|0x34BA
suffix:colon
r_return
l_string|&quot;Bearer capability not presently available&quot;
suffix:semicolon
r_case
l_int|0x34BF
suffix:colon
r_return
l_string|&quot;Service or option not available, unspecified&quot;
suffix:semicolon
r_case
l_int|0x34C1
suffix:colon
r_return
l_string|&quot;Bearer capability not implemented&quot;
suffix:semicolon
r_case
l_int|0x34C2
suffix:colon
r_return
l_string|&quot;Channel type not implemented&quot;
suffix:semicolon
r_case
l_int|0x34C5
suffix:colon
r_return
l_string|&quot;Requested facility not implemented&quot;
suffix:semicolon
r_case
l_int|0x34C6
suffix:colon
r_return
l_string|&quot;Only restricted digital information bearer capability is available&quot;
suffix:semicolon
r_case
l_int|0x34CF
suffix:colon
r_return
l_string|&quot;Service or option not implemented, unspecified&quot;
suffix:semicolon
r_case
l_int|0x34D1
suffix:colon
r_return
l_string|&quot;Invalid call reference value&quot;
suffix:semicolon
r_case
l_int|0x34D2
suffix:colon
r_return
l_string|&quot;Identified channel does not exist&quot;
suffix:semicolon
r_case
l_int|0x34D3
suffix:colon
r_return
l_string|&quot;A suspended call exists, but this call identity does not&quot;
suffix:semicolon
r_case
l_int|0x34D4
suffix:colon
r_return
l_string|&quot;Call identity in use&quot;
suffix:semicolon
r_case
l_int|0x34D5
suffix:colon
r_return
l_string|&quot;No call suspended&quot;
suffix:semicolon
r_case
l_int|0x34D6
suffix:colon
r_return
l_string|&quot;Call having the requested call identity has been cleared&quot;
suffix:semicolon
r_case
l_int|0x34D8
suffix:colon
r_return
l_string|&quot;Incompatible destination&quot;
suffix:semicolon
r_case
l_int|0x34DB
suffix:colon
r_return
l_string|&quot;Invalid transit network selection&quot;
suffix:semicolon
r_case
l_int|0x34DF
suffix:colon
r_return
l_string|&quot;Invalid message, unspecified&quot;
suffix:semicolon
r_case
l_int|0x34E0
suffix:colon
r_return
l_string|&quot;Mandatory information element is missing&quot;
suffix:semicolon
r_case
l_int|0x34E1
suffix:colon
r_return
l_string|&quot;Message type non-existent or not implemented&quot;
suffix:semicolon
r_case
l_int|0x34E2
suffix:colon
r_return
l_string|&quot;Message not compatible with call state or message type non-existent or not implemented&quot;
suffix:semicolon
r_case
l_int|0x34E3
suffix:colon
r_return
l_string|&quot;Information element non-existent or not implemented&quot;
suffix:semicolon
r_case
l_int|0x34E4
suffix:colon
r_return
l_string|&quot;Invalid information element contents&quot;
suffix:semicolon
r_case
l_int|0x34E5
suffix:colon
r_return
l_string|&quot;Message not compatible with call state&quot;
suffix:semicolon
r_case
l_int|0x34E6
suffix:colon
r_return
l_string|&quot;Recovery on timer expiry&quot;
suffix:semicolon
r_case
l_int|0x34EF
suffix:colon
r_return
l_string|&quot;Protocol error, unspecified&quot;
suffix:semicolon
r_case
l_int|0x34FF
suffix:colon
r_return
l_string|&quot;Interworking, unspecified&quot;
suffix:semicolon
r_default
suffix:colon
r_return
l_string|&quot;No additional information&quot;
suffix:semicolon
)brace
)brace
macro_line|#endif
r_typedef
r_struct
(brace
DECL|member|typ
r_int
id|typ
suffix:semicolon
DECL|member|off
r_int
id|off
suffix:semicolon
DECL|typedef|_cdef
)brace
id|_cdef
suffix:semicolon
DECL|macro|_CBYTE
mdefine_line|#define _CBYTE&t;       1
DECL|macro|_CWORD
mdefine_line|#define _CWORD&t;       2
DECL|macro|_CDWORD
mdefine_line|#define _CDWORD        3
DECL|macro|_CSTRUCT
mdefine_line|#define _CSTRUCT       4
DECL|macro|_CMSTRUCT
mdefine_line|#define _CMSTRUCT      5
DECL|macro|_CEND
mdefine_line|#define _CEND&t;       6
DECL|variable|cdef
r_static
id|_cdef
id|cdef
(braket
)braket
op_assign
(brace
multiline_comment|/*00 */
(brace
id|_CEND
)brace
comma
multiline_comment|/*01 */
(brace
id|_CEND
)brace
comma
multiline_comment|/*02 */
(brace
id|_CEND
)brace
comma
multiline_comment|/*03 */
(brace
id|_CDWORD
comma
m_offsetof
(paren
id|_cmsg
comma
id|adr.adrController
)paren
)brace
comma
multiline_comment|/*04 */
(brace
id|_CMSTRUCT
comma
m_offsetof
(paren
id|_cmsg
comma
id|AdditionalInfo
)paren
)brace
comma
multiline_comment|/*05 */
(brace
id|_CSTRUCT
comma
m_offsetof
(paren
id|_cmsg
comma
id|B1configuration
)paren
)brace
comma
multiline_comment|/*06 */
(brace
id|_CWORD
comma
m_offsetof
(paren
id|_cmsg
comma
id|B1protocol
)paren
)brace
comma
multiline_comment|/*07 */
(brace
id|_CSTRUCT
comma
m_offsetof
(paren
id|_cmsg
comma
id|B2configuration
)paren
)brace
comma
multiline_comment|/*08 */
(brace
id|_CWORD
comma
m_offsetof
(paren
id|_cmsg
comma
id|B2protocol
)paren
)brace
comma
multiline_comment|/*09 */
(brace
id|_CSTRUCT
comma
m_offsetof
(paren
id|_cmsg
comma
id|B3configuration
)paren
)brace
comma
multiline_comment|/*0a */
(brace
id|_CWORD
comma
m_offsetof
(paren
id|_cmsg
comma
id|B3protocol
)paren
)brace
comma
multiline_comment|/*0b */
(brace
id|_CSTRUCT
comma
m_offsetof
(paren
id|_cmsg
comma
id|BC
)paren
)brace
comma
multiline_comment|/*0c */
(brace
id|_CSTRUCT
comma
m_offsetof
(paren
id|_cmsg
comma
id|BChannelinformation
)paren
)brace
comma
multiline_comment|/*0d */
(brace
id|_CMSTRUCT
comma
m_offsetof
(paren
id|_cmsg
comma
id|BProtocol
)paren
)brace
comma
multiline_comment|/*0e */
(brace
id|_CSTRUCT
comma
m_offsetof
(paren
id|_cmsg
comma
id|CalledPartyNumber
)paren
)brace
comma
multiline_comment|/*0f */
(brace
id|_CSTRUCT
comma
m_offsetof
(paren
id|_cmsg
comma
id|CalledPartySubaddress
)paren
)brace
comma
multiline_comment|/*10 */
(brace
id|_CSTRUCT
comma
m_offsetof
(paren
id|_cmsg
comma
id|CallingPartyNumber
)paren
)brace
comma
multiline_comment|/*11 */
(brace
id|_CSTRUCT
comma
m_offsetof
(paren
id|_cmsg
comma
id|CallingPartySubaddress
)paren
)brace
comma
multiline_comment|/*12 */
(brace
id|_CDWORD
comma
m_offsetof
(paren
id|_cmsg
comma
id|CIPmask
)paren
)brace
comma
multiline_comment|/*13 */
(brace
id|_CDWORD
comma
m_offsetof
(paren
id|_cmsg
comma
id|CIPmask2
)paren
)brace
comma
multiline_comment|/*14 */
(brace
id|_CWORD
comma
m_offsetof
(paren
id|_cmsg
comma
id|CIPValue
)paren
)brace
comma
multiline_comment|/*15 */
(brace
id|_CDWORD
comma
m_offsetof
(paren
id|_cmsg
comma
id|Class
)paren
)brace
comma
multiline_comment|/*16 */
(brace
id|_CSTRUCT
comma
m_offsetof
(paren
id|_cmsg
comma
id|ConnectedNumber
)paren
)brace
comma
multiline_comment|/*17 */
(brace
id|_CSTRUCT
comma
m_offsetof
(paren
id|_cmsg
comma
id|ConnectedSubaddress
)paren
)brace
comma
multiline_comment|/*18 */
(brace
id|_CDWORD
comma
m_offsetof
(paren
id|_cmsg
comma
id|Data
)paren
)brace
comma
multiline_comment|/*19 */
(brace
id|_CWORD
comma
m_offsetof
(paren
id|_cmsg
comma
id|DataHandle
)paren
)brace
comma
multiline_comment|/*1a */
(brace
id|_CWORD
comma
m_offsetof
(paren
id|_cmsg
comma
id|DataLength
)paren
)brace
comma
multiline_comment|/*1b */
(brace
id|_CSTRUCT
comma
m_offsetof
(paren
id|_cmsg
comma
id|FacilityConfirmationParameter
)paren
)brace
comma
multiline_comment|/*1c */
(brace
id|_CSTRUCT
comma
m_offsetof
(paren
id|_cmsg
comma
id|Facilitydataarray
)paren
)brace
comma
multiline_comment|/*1d */
(brace
id|_CSTRUCT
comma
m_offsetof
(paren
id|_cmsg
comma
id|FacilityIndicationParameter
)paren
)brace
comma
multiline_comment|/*1e */
(brace
id|_CSTRUCT
comma
m_offsetof
(paren
id|_cmsg
comma
id|FacilityRequestParameter
)paren
)brace
comma
multiline_comment|/*1f */
(brace
id|_CWORD
comma
m_offsetof
(paren
id|_cmsg
comma
id|FacilitySelector
)paren
)brace
comma
multiline_comment|/*20 */
(brace
id|_CWORD
comma
m_offsetof
(paren
id|_cmsg
comma
id|Flags
)paren
)brace
comma
multiline_comment|/*21 */
(brace
id|_CDWORD
comma
m_offsetof
(paren
id|_cmsg
comma
id|Function
)paren
)brace
comma
multiline_comment|/*22 */
(brace
id|_CSTRUCT
comma
m_offsetof
(paren
id|_cmsg
comma
id|HLC
)paren
)brace
comma
multiline_comment|/*23 */
(brace
id|_CWORD
comma
m_offsetof
(paren
id|_cmsg
comma
id|Info
)paren
)brace
comma
multiline_comment|/*24 */
(brace
id|_CSTRUCT
comma
m_offsetof
(paren
id|_cmsg
comma
id|InfoElement
)paren
)brace
comma
multiline_comment|/*25 */
(brace
id|_CDWORD
comma
m_offsetof
(paren
id|_cmsg
comma
id|InfoMask
)paren
)brace
comma
multiline_comment|/*26 */
(brace
id|_CWORD
comma
m_offsetof
(paren
id|_cmsg
comma
id|InfoNumber
)paren
)brace
comma
multiline_comment|/*27 */
(brace
id|_CSTRUCT
comma
m_offsetof
(paren
id|_cmsg
comma
id|Keypadfacility
)paren
)brace
comma
multiline_comment|/*28 */
(brace
id|_CSTRUCT
comma
m_offsetof
(paren
id|_cmsg
comma
id|LLC
)paren
)brace
comma
multiline_comment|/*29 */
(brace
id|_CSTRUCT
comma
m_offsetof
(paren
id|_cmsg
comma
id|ManuData
)paren
)brace
comma
multiline_comment|/*2a */
(brace
id|_CDWORD
comma
m_offsetof
(paren
id|_cmsg
comma
id|ManuID
)paren
)brace
comma
multiline_comment|/*2b */
(brace
id|_CSTRUCT
comma
m_offsetof
(paren
id|_cmsg
comma
id|NCPI
)paren
)brace
comma
multiline_comment|/*2c */
(brace
id|_CWORD
comma
m_offsetof
(paren
id|_cmsg
comma
id|Reason
)paren
)brace
comma
multiline_comment|/*2d */
(brace
id|_CWORD
comma
m_offsetof
(paren
id|_cmsg
comma
id|Reason_B3
)paren
)brace
comma
multiline_comment|/*2e */
(brace
id|_CWORD
comma
m_offsetof
(paren
id|_cmsg
comma
id|Reject
)paren
)brace
comma
multiline_comment|/*2f */
(brace
id|_CSTRUCT
comma
m_offsetof
(paren
id|_cmsg
comma
id|Useruserdata
)paren
)brace
)brace
suffix:semicolon
DECL|variable|cpars
r_static
r_int
r_char
op_star
id|cpars
(braket
)braket
op_assign
(brace
multiline_comment|/*00 */
l_int|0
comma
multiline_comment|/*01 ALERT_REQ */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x04&bslash;x0c&bslash;x27&bslash;x2f&bslash;x1c&bslash;x01&bslash;x01&quot;
comma
multiline_comment|/*02 CONNECT_REQ */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x14&bslash;x0e&bslash;x10&bslash;x0f&bslash;x11&bslash;x0d&bslash;x06&bslash;x08&bslash;x0a&bslash;x05&bslash;x07&bslash;x09&bslash;x01&bslash;x0b&bslash;x28&bslash;x22&bslash;x04&bslash;x0c&bslash;x27&bslash;x2f&bslash;x1c&bslash;x01&bslash;x01&quot;
comma
multiline_comment|/*03 */
l_int|0
comma
multiline_comment|/*04 DISCONNECT_REQ */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x04&bslash;x0c&bslash;x27&bslash;x2f&bslash;x1c&bslash;x01&bslash;x01&quot;
comma
multiline_comment|/*05 LISTEN_REQ */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x25&bslash;x12&bslash;x13&bslash;x10&bslash;x11&bslash;x01&quot;
comma
multiline_comment|/*06 */
l_int|0
comma
multiline_comment|/*07 */
l_int|0
comma
multiline_comment|/*08 INFO_REQ */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x0e&bslash;x04&bslash;x0c&bslash;x27&bslash;x2f&bslash;x1c&bslash;x01&bslash;x01&quot;
comma
multiline_comment|/*09 FACILITY_REQ */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x1f&bslash;x1e&bslash;x01&quot;
comma
multiline_comment|/*0a SELECT_B_PROTOCOL_REQ */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x0d&bslash;x06&bslash;x08&bslash;x0a&bslash;x05&bslash;x07&bslash;x09&bslash;x01&bslash;x01&quot;
comma
multiline_comment|/*0b CONNECT_B3_REQ */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x2b&bslash;x01&quot;
comma
multiline_comment|/*0c */
l_int|0
comma
multiline_comment|/*0d DISCONNECT_B3_REQ */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x2b&bslash;x01&quot;
comma
multiline_comment|/*0e */
l_int|0
comma
multiline_comment|/*0f DATA_B3_REQ */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x18&bslash;x1a&bslash;x19&bslash;x20&bslash;x01&quot;
comma
multiline_comment|/*10 RESET_B3_REQ */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x2b&bslash;x01&quot;
comma
multiline_comment|/*11 */
l_int|0
comma
multiline_comment|/*12 */
l_int|0
comma
multiline_comment|/*13 ALERT_CONF */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x23&bslash;x01&quot;
comma
multiline_comment|/*14 CONNECT_CONF */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x23&bslash;x01&quot;
comma
multiline_comment|/*15 */
l_int|0
comma
multiline_comment|/*16 DISCONNECT_CONF */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x23&bslash;x01&quot;
comma
multiline_comment|/*17 LISTEN_CONF */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x23&bslash;x01&quot;
comma
multiline_comment|/*18 MANUFACTURER_REQ */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x2a&bslash;x15&bslash;x21&bslash;x29&bslash;x01&quot;
comma
multiline_comment|/*19 */
l_int|0
comma
multiline_comment|/*1a INFO_CONF */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x23&bslash;x01&quot;
comma
multiline_comment|/*1b FACILITY_CONF */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x23&bslash;x1f&bslash;x1b&bslash;x01&quot;
comma
multiline_comment|/*1c SELECT_B_PROTOCOL_CONF */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x23&bslash;x01&quot;
comma
multiline_comment|/*1d CONNECT_B3_CONF */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x23&bslash;x01&quot;
comma
multiline_comment|/*1e */
l_int|0
comma
multiline_comment|/*1f DISCONNECT_B3_CONF */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x23&bslash;x01&quot;
comma
multiline_comment|/*20 */
l_int|0
comma
multiline_comment|/*21 DATA_B3_CONF */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x19&bslash;x23&bslash;x01&quot;
comma
multiline_comment|/*22 RESET_B3_CONF */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x23&bslash;x01&quot;
comma
multiline_comment|/*23 */
l_int|0
comma
multiline_comment|/*24 */
l_int|0
comma
multiline_comment|/*25 */
l_int|0
comma
multiline_comment|/*26 CONNECT_IND */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x14&bslash;x0e&bslash;x10&bslash;x0f&bslash;x11&bslash;x0b&bslash;x28&bslash;x22&bslash;x04&bslash;x0c&bslash;x27&bslash;x2f&bslash;x1c&bslash;x01&bslash;x01&quot;
comma
multiline_comment|/*27 CONNECT_ACTIVE_IND */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x16&bslash;x17&bslash;x28&bslash;x01&quot;
comma
multiline_comment|/*28 DISCONNECT_IND */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x2c&bslash;x01&quot;
comma
multiline_comment|/*29 */
l_int|0
comma
multiline_comment|/*2a MANUFACTURER_CONF */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x2a&bslash;x15&bslash;x21&bslash;x29&bslash;x01&quot;
comma
multiline_comment|/*2b */
l_int|0
comma
multiline_comment|/*2c INFO_IND */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x26&bslash;x24&bslash;x01&quot;
comma
multiline_comment|/*2d FACILITY_IND */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x1f&bslash;x1d&bslash;x01&quot;
comma
multiline_comment|/*2e */
l_int|0
comma
multiline_comment|/*2f CONNECT_B3_IND */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x2b&bslash;x01&quot;
comma
multiline_comment|/*30 CONNECT_B3_ACTIVE_IND */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x2b&bslash;x01&quot;
comma
multiline_comment|/*31 DISCONNECT_B3_IND */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x2d&bslash;x2b&bslash;x01&quot;
comma
multiline_comment|/*32 */
l_int|0
comma
multiline_comment|/*33 DATA_B3_IND */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x18&bslash;x1a&bslash;x19&bslash;x20&bslash;x01&quot;
comma
multiline_comment|/*34 RESET_B3_IND */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x2b&bslash;x01&quot;
comma
multiline_comment|/*35 CONNECT_B3_T90_ACTIVE_IND */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x2b&bslash;x01&quot;
comma
multiline_comment|/*36 */
l_int|0
comma
multiline_comment|/*37 */
l_int|0
comma
multiline_comment|/*38 CONNECT_RESP */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x2e&bslash;x0d&bslash;x06&bslash;x08&bslash;x0a&bslash;x05&bslash;x07&bslash;x09&bslash;x01&bslash;x16&bslash;x17&bslash;x28&bslash;x04&bslash;x0c&bslash;x27&bslash;x2f&bslash;x1c&bslash;x01&bslash;x01&quot;
comma
multiline_comment|/*39 CONNECT_ACTIVE_RESP */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x01&quot;
comma
multiline_comment|/*3a DISCONNECT_RESP */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x01&quot;
comma
multiline_comment|/*3b */
l_int|0
comma
multiline_comment|/*3c MANUFACTURER_IND */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x2a&bslash;x15&bslash;x21&bslash;x29&bslash;x01&quot;
comma
multiline_comment|/*3d */
l_int|0
comma
multiline_comment|/*3e INFO_RESP */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x01&quot;
comma
multiline_comment|/*3f FACILITY_RESP */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x1f&bslash;x01&quot;
comma
multiline_comment|/*40 */
l_int|0
comma
multiline_comment|/*41 CONNECT_B3_RESP */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x2e&bslash;x2b&bslash;x01&quot;
comma
multiline_comment|/*42 CONNECT_B3_ACTIVE_RESP */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x01&quot;
comma
multiline_comment|/*43 DISCONNECT_B3_RESP */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x01&quot;
comma
multiline_comment|/*44 */
l_int|0
comma
multiline_comment|/*45 DATA_B3_RESP */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x19&bslash;x01&quot;
comma
multiline_comment|/*46 RESET_B3_RESP */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x01&quot;
comma
multiline_comment|/*47 CONNECT_B3_T90_ACTIVE_RESP */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x01&quot;
comma
multiline_comment|/*48 */
l_int|0
comma
multiline_comment|/*49 */
l_int|0
comma
multiline_comment|/*4a */
l_int|0
comma
multiline_comment|/*4b */
l_int|0
comma
multiline_comment|/*4c */
l_int|0
comma
multiline_comment|/*4d */
l_int|0
comma
multiline_comment|/*4e MANUFACTURER_RESP */
(paren
r_int
r_char
op_star
)paren
l_string|&quot;&bslash;x03&bslash;x2a&bslash;x15&bslash;x21&bslash;x29&bslash;x01&quot;
comma
)brace
suffix:semicolon
multiline_comment|/*-------------------------------------------------------*/
DECL|macro|byteTLcpy
mdefine_line|#define byteTLcpy(x,y)        *(__u8 *)(x)=*(__u8 *)(y);
DECL|macro|wordTLcpy
mdefine_line|#define wordTLcpy(x,y)        *(__u16 *)(x)=*(__u16 *)(y);
DECL|macro|dwordTLcpy
mdefine_line|#define dwordTLcpy(x,y)       memcpy(x,y,4);
DECL|macro|structTLcpy
mdefine_line|#define structTLcpy(x,y,l)    memcpy (x,y,l)
DECL|macro|structTLcpyovl
mdefine_line|#define structTLcpyovl(x,y,l) memmove (x,y,l)
DECL|macro|byteTRcpy
mdefine_line|#define byteTRcpy(x,y)        *(__u8 *)(y)=*(__u8 *)(x);
DECL|macro|wordTRcpy
mdefine_line|#define wordTRcpy(x,y)        *(__u16 *)(y)=*(__u16 *)(x);
DECL|macro|dwordTRcpy
mdefine_line|#define dwordTRcpy(x,y)       memcpy(y,x,4);
DECL|macro|structTRcpy
mdefine_line|#define structTRcpy(x,y,l)    memcpy (y,x,l)
DECL|macro|structTRcpyovl
mdefine_line|#define structTRcpyovl(x,y,l) memmove (y,x,l)
multiline_comment|/*-------------------------------------------------------*/
DECL|function|command_2_index
r_static
r_int
id|command_2_index
c_func
(paren
r_int
id|c
comma
r_int
id|sc
)paren
(brace
r_if
c_cond
(paren
id|c
op_amp
l_int|0x80
)paren
id|c
op_assign
l_int|0x9
op_plus
(paren
id|c
op_amp
l_int|0x0f
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|c
op_le
l_int|0x0f
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|c
op_eq
l_int|0x41
)paren
id|c
op_assign
l_int|0x9
op_plus
l_int|0x1
suffix:semicolon
r_else
r_if
c_cond
(paren
id|c
op_eq
l_int|0xff
)paren
id|c
op_assign
l_int|0x00
suffix:semicolon
r_return
(paren
id|sc
op_amp
l_int|3
)paren
op_star
(paren
l_int|0x9
op_plus
l_int|0x9
)paren
op_plus
id|c
suffix:semicolon
)brace
multiline_comment|/*-------------------------------------------------------*/
DECL|macro|TYP
mdefine_line|#define TYP (cdef[cmsg-&gt;par[cmsg-&gt;p]].typ)
DECL|macro|OFF
mdefine_line|#define OFF (((__u8 *)cmsg)+cdef[cmsg-&gt;par[cmsg-&gt;p]].off)
DECL|function|jumpcstruct
r_static
r_void
id|jumpcstruct
c_func
(paren
id|_cmsg
op_star
id|cmsg
)paren
(brace
r_int
id|layer
suffix:semicolon
r_for
c_loop
(paren
id|cmsg-&gt;p
op_increment
comma
id|layer
op_assign
l_int|1
suffix:semicolon
id|layer
suffix:semicolon
)paren
(brace
multiline_comment|/* $$$$$ assert (cmsg-&gt;p); */
id|cmsg-&gt;p
op_increment
suffix:semicolon
r_switch
c_cond
(paren
id|TYP
)paren
(brace
r_case
id|_CMSTRUCT
suffix:colon
id|layer
op_increment
suffix:semicolon
r_break
suffix:semicolon
r_case
id|_CEND
suffix:colon
id|layer
op_decrement
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
)brace
multiline_comment|/*-------------------------------------------------------*/
DECL|function|pars_2_message
r_static
r_void
id|pars_2_message
c_func
(paren
id|_cmsg
op_star
id|cmsg
)paren
(brace
r_for
c_loop
(paren
suffix:semicolon
id|TYP
op_ne
id|_CEND
suffix:semicolon
id|cmsg-&gt;p
op_increment
)paren
(brace
r_switch
c_cond
(paren
id|TYP
)paren
(brace
r_case
id|_CBYTE
suffix:colon
id|byteTLcpy
c_func
(paren
id|cmsg-&gt;m
op_plus
id|cmsg-&gt;l
comma
id|OFF
)paren
suffix:semicolon
id|cmsg-&gt;l
op_increment
suffix:semicolon
r_break
suffix:semicolon
r_case
id|_CWORD
suffix:colon
id|wordTLcpy
c_func
(paren
id|cmsg-&gt;m
op_plus
id|cmsg-&gt;l
comma
id|OFF
)paren
suffix:semicolon
id|cmsg-&gt;l
op_add_assign
l_int|2
suffix:semicolon
r_break
suffix:semicolon
r_case
id|_CDWORD
suffix:colon
id|dwordTLcpy
c_func
(paren
id|cmsg-&gt;m
op_plus
id|cmsg-&gt;l
comma
id|OFF
)paren
suffix:semicolon
id|cmsg-&gt;l
op_add_assign
l_int|4
suffix:semicolon
r_break
suffix:semicolon
r_case
id|_CSTRUCT
suffix:colon
r_if
c_cond
(paren
op_star
(paren
id|__u8
op_star
op_star
)paren
id|OFF
op_eq
l_int|0
)paren
(brace
op_star
(paren
id|cmsg-&gt;m
op_plus
id|cmsg-&gt;l
)paren
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
id|cmsg-&gt;l
op_increment
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_star
op_star
(paren
id|_cstruct
op_star
)paren
id|OFF
op_ne
l_int|0xff
)paren
(brace
id|structTLcpy
c_func
(paren
id|cmsg-&gt;m
op_plus
id|cmsg-&gt;l
comma
op_star
(paren
id|_cstruct
op_star
)paren
id|OFF
comma
l_int|1
op_plus
op_star
op_star
(paren
id|_cstruct
op_star
)paren
id|OFF
)paren
suffix:semicolon
id|cmsg-&gt;l
op_add_assign
l_int|1
op_plus
op_star
op_star
(paren
id|_cstruct
op_star
)paren
id|OFF
suffix:semicolon
)brace
r_else
(brace
id|_cstruct
id|s
op_assign
op_star
(paren
id|_cstruct
op_star
)paren
id|OFF
suffix:semicolon
id|structTLcpy
c_func
(paren
id|cmsg-&gt;m
op_plus
id|cmsg-&gt;l
comma
id|s
comma
l_int|3
op_plus
op_star
(paren
id|__u16
op_star
)paren
(paren
id|s
op_plus
l_int|1
)paren
)paren
suffix:semicolon
id|cmsg-&gt;l
op_add_assign
l_int|3
op_plus
op_star
(paren
id|__u16
op_star
)paren
(paren
id|s
op_plus
l_int|1
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|_CMSTRUCT
suffix:colon
multiline_comment|/*----- Metastruktur 0 -----*/
r_if
c_cond
(paren
op_star
(paren
id|_cmstruct
op_star
)paren
id|OFF
op_eq
id|CAPI_DEFAULT
)paren
(brace
op_star
(paren
id|cmsg-&gt;m
op_plus
id|cmsg-&gt;l
)paren
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
id|cmsg-&gt;l
op_increment
suffix:semicolon
id|jumpcstruct
c_func
(paren
id|cmsg
)paren
suffix:semicolon
)brace
multiline_comment|/*----- Metastruktur wird composed -----*/
r_else
(brace
r_int
id|_l
op_assign
id|cmsg-&gt;l
suffix:semicolon
r_int
id|_ls
suffix:semicolon
id|cmsg-&gt;l
op_increment
suffix:semicolon
id|cmsg-&gt;p
op_increment
suffix:semicolon
id|pars_2_message
c_func
(paren
id|cmsg
)paren
suffix:semicolon
id|_ls
op_assign
id|cmsg-&gt;l
op_minus
id|_l
op_minus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|_ls
OL
l_int|255
)paren
(paren
id|cmsg-&gt;m
op_plus
id|_l
)paren
(braket
l_int|0
)braket
op_assign
(paren
id|__u8
)paren
id|_ls
suffix:semicolon
r_else
(brace
id|structTLcpyovl
c_func
(paren
id|cmsg-&gt;m
op_plus
id|_l
op_plus
l_int|3
comma
id|cmsg-&gt;m
op_plus
id|_l
op_plus
l_int|1
comma
id|_ls
)paren
suffix:semicolon
(paren
id|cmsg-&gt;m
op_plus
id|_l
)paren
(braket
l_int|0
)braket
op_assign
l_int|0xff
suffix:semicolon
id|wordTLcpy
c_func
(paren
id|cmsg-&gt;m
op_plus
id|_l
op_plus
l_int|1
comma
op_amp
id|_ls
)paren
suffix:semicolon
)brace
)brace
r_break
suffix:semicolon
)brace
)brace
)brace
multiline_comment|/*-------------------------------------------------------*/
DECL|function|capi_cmsg2message
r_int
id|capi_cmsg2message
c_func
(paren
id|_cmsg
op_star
id|cmsg
comma
id|__u8
op_star
id|msg
)paren
(brace
id|cmsg-&gt;m
op_assign
id|msg
suffix:semicolon
id|cmsg-&gt;l
op_assign
l_int|8
suffix:semicolon
id|cmsg-&gt;p
op_assign
l_int|0
suffix:semicolon
id|cmsg-&gt;par
op_assign
id|cpars
(braket
id|command_2_index
c_func
(paren
id|cmsg-&gt;Command
comma
id|cmsg-&gt;Subcommand
)paren
)braket
suffix:semicolon
id|pars_2_message
c_func
(paren
id|cmsg
)paren
suffix:semicolon
id|wordTLcpy
c_func
(paren
id|msg
op_plus
l_int|0
comma
op_amp
id|cmsg-&gt;l
)paren
suffix:semicolon
id|byteTLcpy
c_func
(paren
id|cmsg-&gt;m
op_plus
l_int|4
comma
op_amp
id|cmsg-&gt;Command
)paren
suffix:semicolon
id|byteTLcpy
c_func
(paren
id|cmsg-&gt;m
op_plus
l_int|5
comma
op_amp
id|cmsg-&gt;Subcommand
)paren
suffix:semicolon
id|wordTLcpy
c_func
(paren
id|cmsg-&gt;m
op_plus
l_int|2
comma
op_amp
id|cmsg-&gt;ApplId
)paren
suffix:semicolon
id|wordTLcpy
c_func
(paren
id|cmsg-&gt;m
op_plus
l_int|6
comma
op_amp
id|cmsg-&gt;Messagenumber
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*-------------------------------------------------------*/
DECL|function|message_2_pars
r_static
r_void
id|message_2_pars
c_func
(paren
id|_cmsg
op_star
id|cmsg
)paren
(brace
r_for
c_loop
(paren
suffix:semicolon
id|TYP
op_ne
id|_CEND
suffix:semicolon
id|cmsg-&gt;p
op_increment
)paren
(brace
r_switch
c_cond
(paren
id|TYP
)paren
(brace
r_case
id|_CBYTE
suffix:colon
id|byteTRcpy
c_func
(paren
id|cmsg-&gt;m
op_plus
id|cmsg-&gt;l
comma
id|OFF
)paren
suffix:semicolon
id|cmsg-&gt;l
op_increment
suffix:semicolon
r_break
suffix:semicolon
r_case
id|_CWORD
suffix:colon
id|wordTRcpy
c_func
(paren
id|cmsg-&gt;m
op_plus
id|cmsg-&gt;l
comma
id|OFF
)paren
suffix:semicolon
id|cmsg-&gt;l
op_add_assign
l_int|2
suffix:semicolon
r_break
suffix:semicolon
r_case
id|_CDWORD
suffix:colon
id|dwordTRcpy
c_func
(paren
id|cmsg-&gt;m
op_plus
id|cmsg-&gt;l
comma
id|OFF
)paren
suffix:semicolon
id|cmsg-&gt;l
op_add_assign
l_int|4
suffix:semicolon
r_break
suffix:semicolon
r_case
id|_CSTRUCT
suffix:colon
op_star
(paren
id|__u8
op_star
op_star
)paren
id|OFF
op_assign
id|cmsg-&gt;m
op_plus
id|cmsg-&gt;l
suffix:semicolon
r_if
c_cond
(paren
id|cmsg-&gt;m
(braket
id|cmsg-&gt;l
)braket
op_ne
l_int|0xff
)paren
id|cmsg-&gt;l
op_add_assign
l_int|1
op_plus
id|cmsg-&gt;m
(braket
id|cmsg-&gt;l
)braket
suffix:semicolon
r_else
id|cmsg-&gt;l
op_add_assign
l_int|3
op_plus
op_star
(paren
id|__u16
op_star
)paren
(paren
id|cmsg-&gt;m
op_plus
id|cmsg-&gt;l
op_plus
l_int|1
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|_CMSTRUCT
suffix:colon
multiline_comment|/*----- Metastruktur 0 -----*/
r_if
c_cond
(paren
id|cmsg-&gt;m
(braket
id|cmsg-&gt;l
)braket
op_eq
l_char|&squot;&bslash;0&squot;
)paren
(brace
op_star
(paren
id|_cmstruct
op_star
)paren
id|OFF
op_assign
id|CAPI_DEFAULT
suffix:semicolon
id|cmsg-&gt;l
op_increment
suffix:semicolon
id|jumpcstruct
c_func
(paren
id|cmsg
)paren
suffix:semicolon
)brace
r_else
(brace
r_int
id|_l
op_assign
id|cmsg-&gt;l
suffix:semicolon
op_star
(paren
id|_cmstruct
op_star
)paren
id|OFF
op_assign
id|CAPI_COMPOSE
suffix:semicolon
id|cmsg-&gt;l
op_assign
(paren
id|cmsg-&gt;m
op_plus
id|_l
)paren
(braket
l_int|0
)braket
op_eq
l_int|255
ques
c_cond
id|cmsg-&gt;l
op_plus
l_int|3
suffix:colon
id|cmsg-&gt;l
op_plus
l_int|1
suffix:semicolon
id|cmsg-&gt;p
op_increment
suffix:semicolon
id|message_2_pars
c_func
(paren
id|cmsg
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
)brace
)brace
)brace
multiline_comment|/*-------------------------------------------------------*/
DECL|function|capi_message2cmsg
r_int
id|capi_message2cmsg
c_func
(paren
id|_cmsg
op_star
id|cmsg
comma
id|__u8
op_star
id|msg
)paren
(brace
id|memset
c_func
(paren
id|cmsg
comma
l_int|0
comma
r_sizeof
(paren
id|_cmsg
)paren
)paren
suffix:semicolon
id|cmsg-&gt;m
op_assign
id|msg
suffix:semicolon
id|cmsg-&gt;l
op_assign
l_int|8
suffix:semicolon
id|cmsg-&gt;p
op_assign
l_int|0
suffix:semicolon
id|byteTRcpy
c_func
(paren
id|cmsg-&gt;m
op_plus
l_int|4
comma
op_amp
id|cmsg-&gt;Command
)paren
suffix:semicolon
id|byteTRcpy
c_func
(paren
id|cmsg-&gt;m
op_plus
l_int|5
comma
op_amp
id|cmsg-&gt;Subcommand
)paren
suffix:semicolon
id|cmsg-&gt;par
op_assign
id|cpars
(braket
id|command_2_index
c_func
(paren
id|cmsg-&gt;Command
comma
id|cmsg-&gt;Subcommand
)paren
)braket
suffix:semicolon
id|message_2_pars
c_func
(paren
id|cmsg
)paren
suffix:semicolon
id|wordTRcpy
c_func
(paren
id|msg
op_plus
l_int|0
comma
op_amp
id|cmsg-&gt;l
)paren
suffix:semicolon
id|wordTRcpy
c_func
(paren
id|cmsg-&gt;m
op_plus
l_int|2
comma
op_amp
id|cmsg-&gt;ApplId
)paren
suffix:semicolon
id|wordTRcpy
c_func
(paren
id|cmsg-&gt;m
op_plus
l_int|6
comma
op_amp
id|cmsg-&gt;Messagenumber
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*-------------------------------------------------------*/
DECL|function|capi_cmsg_header
r_int
id|capi_cmsg_header
c_func
(paren
id|_cmsg
op_star
id|cmsg
comma
id|__u16
id|_ApplId
comma
id|__u8
id|_Command
comma
id|__u8
id|_Subcommand
comma
id|__u16
id|_Messagenumber
comma
id|__u32
id|_Controller
)paren
(brace
id|memset
c_func
(paren
id|cmsg
comma
l_int|0
comma
r_sizeof
(paren
id|_cmsg
)paren
)paren
suffix:semicolon
id|cmsg-&gt;ApplId
op_assign
id|_ApplId
suffix:semicolon
id|cmsg-&gt;Command
op_assign
id|_Command
suffix:semicolon
id|cmsg-&gt;Subcommand
op_assign
id|_Subcommand
suffix:semicolon
id|cmsg-&gt;Messagenumber
op_assign
id|_Messagenumber
suffix:semicolon
id|cmsg-&gt;adr.adrController
op_assign
id|_Controller
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*-------------------------------------------------------*/
DECL|variable|mnames
r_static
r_char
op_star
id|mnames
(braket
)braket
op_assign
(brace
l_int|0
comma
l_string|&quot;ALERT_REQ&quot;
comma
l_string|&quot;CONNECT_REQ&quot;
comma
l_int|0
comma
l_string|&quot;DISCONNECT_REQ&quot;
comma
l_string|&quot;LISTEN_REQ&quot;
comma
l_int|0
comma
l_int|0
comma
l_string|&quot;INFO_REQ&quot;
comma
l_string|&quot;FACILITY_REQ&quot;
comma
l_string|&quot;SELECT_B_PROTOCOL_REQ&quot;
comma
l_string|&quot;CONNECT_B3_REQ&quot;
comma
l_int|0
comma
l_string|&quot;DISCONNECT_B3_REQ&quot;
comma
l_int|0
comma
l_string|&quot;DATA_B3_REQ&quot;
comma
l_string|&quot;RESET_B3_REQ&quot;
comma
l_int|0
comma
l_int|0
comma
l_string|&quot;ALERT_CONF&quot;
comma
l_string|&quot;CONNECT_CONF&quot;
comma
l_int|0
comma
l_string|&quot;DISCONNECT_CONF&quot;
comma
l_string|&quot;LISTEN_CONF&quot;
comma
l_string|&quot;MANUFACTURER_REQ&quot;
comma
l_int|0
comma
l_string|&quot;INFO_CONF&quot;
comma
l_string|&quot;FACILITY_CONF&quot;
comma
l_string|&quot;SELECT_B_PROTOCOL_CONF&quot;
comma
l_string|&quot;CONNECT_B3_CONF&quot;
comma
l_int|0
comma
l_string|&quot;DISCONNECT_B3_CONF&quot;
comma
l_int|0
comma
l_string|&quot;DATA_B3_CONF&quot;
comma
l_string|&quot;RESET_B3_CONF&quot;
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_string|&quot;CONNECT_IND&quot;
comma
l_string|&quot;CONNECT_ACTIVE_IND&quot;
comma
l_string|&quot;DISCONNECT_IND&quot;
comma
l_int|0
comma
l_string|&quot;MANUFACTURER_CONF&quot;
comma
l_int|0
comma
l_string|&quot;INFO_IND&quot;
comma
l_string|&quot;FACILITY_IND&quot;
comma
l_int|0
comma
l_string|&quot;CONNECT_B3_IND&quot;
comma
l_string|&quot;CONNECT_B3_ACTIVE_IND&quot;
comma
l_string|&quot;DISCONNECT_B3_IND&quot;
comma
l_int|0
comma
l_string|&quot;DATA_B3_IND&quot;
comma
l_string|&quot;RESET_B3_IND&quot;
comma
l_string|&quot;CONNECT_B3_T90_ACTIVE_IND&quot;
comma
l_int|0
comma
l_int|0
comma
l_string|&quot;CONNECT_RESP&quot;
comma
l_string|&quot;CONNECT_ACTIVE_RESP&quot;
comma
l_string|&quot;DISCONNECT_RESP&quot;
comma
l_int|0
comma
l_string|&quot;MANUFACTURER_IND&quot;
comma
l_int|0
comma
l_string|&quot;INFO_RESP&quot;
comma
l_string|&quot;FACILITY_RESP&quot;
comma
l_int|0
comma
l_string|&quot;CONNECT_B3_RESP&quot;
comma
l_string|&quot;CONNECT_B3_ACTIVE_RESP&quot;
comma
l_string|&quot;DISCONNECT_B3_RESP&quot;
comma
l_int|0
comma
l_string|&quot;DATA_B3_RESP&quot;
comma
l_string|&quot;RESET_B3_RESP&quot;
comma
l_string|&quot;CONNECT_B3_T90_ACTIVE_RESP&quot;
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_string|&quot;MANUFACTURER_RESP&quot;
)brace
suffix:semicolon
DECL|function|capi_cmd2str
r_char
op_star
id|capi_cmd2str
c_func
(paren
id|__u8
id|cmd
comma
id|__u8
id|subcmd
)paren
(brace
r_return
id|mnames
(braket
id|command_2_index
c_func
(paren
id|cmd
comma
id|subcmd
)paren
)braket
suffix:semicolon
)brace
multiline_comment|/*-------------------------------------------------------*/
multiline_comment|/*-------------------------------------------------------*/
DECL|variable|pnames
r_static
r_char
op_star
id|pnames
(braket
)braket
op_assign
(brace
multiline_comment|/*00 */
l_int|0
comma
multiline_comment|/*01 */
l_int|0
comma
multiline_comment|/*02 */
l_int|0
comma
multiline_comment|/*03 */
l_string|&quot;Controller/PLCI/NCCI&quot;
comma
multiline_comment|/*04 */
l_string|&quot;AdditionalInfo&quot;
comma
multiline_comment|/*05 */
l_string|&quot;B1configuration&quot;
comma
multiline_comment|/*06 */
l_string|&quot;B1protocol&quot;
comma
multiline_comment|/*07 */
l_string|&quot;B2configuration&quot;
comma
multiline_comment|/*08 */
l_string|&quot;B2protocol&quot;
comma
multiline_comment|/*09 */
l_string|&quot;B3configuration&quot;
comma
multiline_comment|/*0a */
l_string|&quot;B3protocol&quot;
comma
multiline_comment|/*0b */
l_string|&quot;BC&quot;
comma
multiline_comment|/*0c */
l_string|&quot;BChannelinformation&quot;
comma
multiline_comment|/*0d */
l_string|&quot;BProtocol&quot;
comma
multiline_comment|/*0e */
l_string|&quot;CalledPartyNumber&quot;
comma
multiline_comment|/*0f */
l_string|&quot;CalledPartySubaddress&quot;
comma
multiline_comment|/*10 */
l_string|&quot;CallingPartyNumber&quot;
comma
multiline_comment|/*11 */
l_string|&quot;CallingPartySubaddress&quot;
comma
multiline_comment|/*12 */
l_string|&quot;CIPmask&quot;
comma
multiline_comment|/*13 */
l_string|&quot;CIPmask2&quot;
comma
multiline_comment|/*14 */
l_string|&quot;CIPValue&quot;
comma
multiline_comment|/*15 */
l_string|&quot;Class&quot;
comma
multiline_comment|/*16 */
l_string|&quot;ConnectedNumber&quot;
comma
multiline_comment|/*17 */
l_string|&quot;ConnectedSubaddress&quot;
comma
multiline_comment|/*18 */
l_string|&quot;Data32&quot;
comma
multiline_comment|/*19 */
l_string|&quot;DataHandle&quot;
comma
multiline_comment|/*1a */
l_string|&quot;DataLength&quot;
comma
multiline_comment|/*1b */
l_string|&quot;FacilityConfirmationParameter&quot;
comma
multiline_comment|/*1c */
l_string|&quot;Facilitydataarray&quot;
comma
multiline_comment|/*1d */
l_string|&quot;FacilityIndicationParameter&quot;
comma
multiline_comment|/*1e */
l_string|&quot;FacilityRequestParameter&quot;
comma
multiline_comment|/*1f */
l_string|&quot;FacilitySelector&quot;
comma
multiline_comment|/*20 */
l_string|&quot;Flags&quot;
comma
multiline_comment|/*21 */
l_string|&quot;Function&quot;
comma
multiline_comment|/*22 */
l_string|&quot;HLC&quot;
comma
multiline_comment|/*23 */
l_string|&quot;Info&quot;
comma
multiline_comment|/*24 */
l_string|&quot;InfoElement&quot;
comma
multiline_comment|/*25 */
l_string|&quot;InfoMask&quot;
comma
multiline_comment|/*26 */
l_string|&quot;InfoNumber&quot;
comma
multiline_comment|/*27 */
l_string|&quot;Keypadfacility&quot;
comma
multiline_comment|/*28 */
l_string|&quot;LLC&quot;
comma
multiline_comment|/*29 */
l_string|&quot;ManuData&quot;
comma
multiline_comment|/*2a */
l_string|&quot;ManuID&quot;
comma
multiline_comment|/*2b */
l_string|&quot;NCPI&quot;
comma
multiline_comment|/*2c */
l_string|&quot;Reason&quot;
comma
multiline_comment|/*2d */
l_string|&quot;Reason_B3&quot;
comma
multiline_comment|/*2e */
l_string|&quot;Reject&quot;
comma
multiline_comment|/*2f */
l_string|&quot;Useruserdata&quot;
)brace
suffix:semicolon
DECL|variable|buf
r_static
r_char
id|buf
(braket
l_int|8192
)braket
suffix:semicolon
DECL|variable|p
r_static
r_char
op_star
id|p
op_assign
l_int|0
suffix:semicolon
macro_line|#include &lt;stdarg.h&gt;
multiline_comment|/*-------------------------------------------------------*/
DECL|function|bufprint
r_static
r_void
id|bufprint
c_func
(paren
r_char
op_star
id|fmt
comma
dot
dot
dot
)paren
(brace
id|va_list
id|f
suffix:semicolon
id|va_start
c_func
(paren
id|f
comma
id|fmt
)paren
suffix:semicolon
id|vsprintf
c_func
(paren
id|p
comma
id|fmt
comma
id|f
)paren
suffix:semicolon
id|va_end
c_func
(paren
id|f
)paren
suffix:semicolon
id|p
op_add_assign
id|strlen
c_func
(paren
id|p
)paren
suffix:semicolon
)brace
DECL|function|printstructlen
r_static
r_void
id|printstructlen
c_func
(paren
id|__u8
op_star
id|m
comma
r_int
id|len
)paren
(brace
r_int
id|hex
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
id|len
suffix:semicolon
id|len
op_decrement
comma
id|m
op_increment
)paren
r_if
c_cond
(paren
id|isalnum
c_func
(paren
op_star
id|m
)paren
op_logical_or
op_star
id|m
op_eq
l_char|&squot; &squot;
)paren
(brace
r_if
c_cond
(paren
id|hex
)paren
id|bufprint
c_func
(paren
l_string|&quot;&gt;&quot;
)paren
suffix:semicolon
id|bufprint
c_func
(paren
l_string|&quot;%c&quot;
comma
op_star
id|m
)paren
suffix:semicolon
id|hex
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
op_logical_neg
id|hex
)paren
id|bufprint
c_func
(paren
l_string|&quot;&lt;%02x&quot;
comma
op_star
id|m
)paren
suffix:semicolon
r_else
id|bufprint
c_func
(paren
l_string|&quot; %02x&quot;
comma
op_star
id|m
)paren
suffix:semicolon
id|hex
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|hex
)paren
id|bufprint
c_func
(paren
l_string|&quot;&gt;&quot;
)paren
suffix:semicolon
)brace
DECL|function|printstruct
r_static
r_void
id|printstruct
c_func
(paren
id|__u8
op_star
id|m
)paren
(brace
r_int
id|len
suffix:semicolon
r_if
c_cond
(paren
id|m
(braket
l_int|0
)braket
op_ne
l_int|0xff
)paren
(brace
id|len
op_assign
id|m
(braket
l_int|0
)braket
suffix:semicolon
id|m
op_add_assign
l_int|1
suffix:semicolon
)brace
r_else
(brace
id|len
op_assign
(paren
(paren
id|__u16
op_star
)paren
(paren
id|m
op_plus
l_int|1
)paren
)paren
(braket
l_int|0
)braket
suffix:semicolon
id|m
op_add_assign
l_int|3
suffix:semicolon
)brace
id|printstructlen
c_func
(paren
id|m
comma
id|len
)paren
suffix:semicolon
)brace
multiline_comment|/*-------------------------------------------------------*/
DECL|macro|NAME
mdefine_line|#define NAME (pnames[cmsg-&gt;par[cmsg-&gt;p]])
DECL|function|protocol_message_2_pars
r_static
r_void
id|protocol_message_2_pars
c_func
(paren
id|_cmsg
op_star
id|cmsg
comma
r_int
id|level
)paren
(brace
r_for
c_loop
(paren
suffix:semicolon
id|TYP
op_ne
id|_CEND
suffix:semicolon
id|cmsg-&gt;p
op_increment
)paren
(brace
r_int
id|slen
op_assign
l_int|29
op_plus
l_int|3
op_minus
id|level
suffix:semicolon
r_int
id|i
suffix:semicolon
id|bufprint
c_func
(paren
l_string|&quot;  &quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|level
op_minus
l_int|1
suffix:semicolon
id|i
op_increment
)paren
id|bufprint
c_func
(paren
l_string|&quot; &quot;
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|TYP
)paren
(brace
r_case
id|_CBYTE
suffix:colon
id|bufprint
c_func
(paren
l_string|&quot;%-*s = 0x%x&bslash;n&quot;
comma
id|slen
comma
id|NAME
comma
op_star
(paren
id|__u8
op_star
)paren
(paren
id|cmsg-&gt;m
op_plus
id|cmsg-&gt;l
)paren
)paren
suffix:semicolon
id|cmsg-&gt;l
op_increment
suffix:semicolon
r_break
suffix:semicolon
r_case
id|_CWORD
suffix:colon
id|bufprint
c_func
(paren
l_string|&quot;%-*s = 0x%x&bslash;n&quot;
comma
id|slen
comma
id|NAME
comma
op_star
(paren
id|__u16
op_star
)paren
(paren
id|cmsg-&gt;m
op_plus
id|cmsg-&gt;l
)paren
)paren
suffix:semicolon
id|cmsg-&gt;l
op_add_assign
l_int|2
suffix:semicolon
r_break
suffix:semicolon
r_case
id|_CDWORD
suffix:colon
id|bufprint
c_func
(paren
l_string|&quot;%-*s = 0x%lx&bslash;n&quot;
comma
id|slen
comma
id|NAME
comma
op_star
(paren
id|__u32
op_star
)paren
(paren
id|cmsg-&gt;m
op_plus
id|cmsg-&gt;l
)paren
)paren
suffix:semicolon
id|cmsg-&gt;l
op_add_assign
l_int|4
suffix:semicolon
r_break
suffix:semicolon
r_case
id|_CSTRUCT
suffix:colon
id|bufprint
c_func
(paren
l_string|&quot;%-*s = &quot;
comma
id|slen
comma
id|NAME
)paren
suffix:semicolon
r_if
c_cond
(paren
id|cmsg-&gt;m
(braket
id|cmsg-&gt;l
)braket
op_eq
l_char|&squot;&bslash;0&squot;
)paren
id|bufprint
c_func
(paren
l_string|&quot;default&quot;
)paren
suffix:semicolon
r_else
id|printstruct
c_func
(paren
id|cmsg-&gt;m
op_plus
id|cmsg-&gt;l
)paren
suffix:semicolon
id|bufprint
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|cmsg-&gt;m
(braket
id|cmsg-&gt;l
)braket
op_ne
l_int|0xff
)paren
id|cmsg-&gt;l
op_add_assign
l_int|1
op_plus
id|cmsg-&gt;m
(braket
id|cmsg-&gt;l
)braket
suffix:semicolon
r_else
id|cmsg-&gt;l
op_add_assign
l_int|3
op_plus
op_star
(paren
id|__u16
op_star
)paren
(paren
id|cmsg-&gt;m
op_plus
id|cmsg-&gt;l
op_plus
l_int|1
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|_CMSTRUCT
suffix:colon
multiline_comment|/*----- Metastruktur 0 -----*/
r_if
c_cond
(paren
id|cmsg-&gt;m
(braket
id|cmsg-&gt;l
)braket
op_eq
l_char|&squot;&bslash;0&squot;
)paren
(brace
id|bufprint
c_func
(paren
l_string|&quot;%-*s = default&bslash;n&quot;
comma
id|slen
comma
id|NAME
)paren
suffix:semicolon
id|cmsg-&gt;l
op_increment
suffix:semicolon
id|jumpcstruct
c_func
(paren
id|cmsg
)paren
suffix:semicolon
)brace
r_else
(brace
r_char
op_star
id|name
op_assign
id|NAME
suffix:semicolon
r_int
id|_l
op_assign
id|cmsg-&gt;l
suffix:semicolon
id|bufprint
c_func
(paren
l_string|&quot;%-*s&bslash;n&quot;
comma
id|slen
comma
id|name
)paren
suffix:semicolon
id|cmsg-&gt;l
op_assign
(paren
id|cmsg-&gt;m
op_plus
id|_l
)paren
(braket
l_int|0
)braket
op_eq
l_int|255
ques
c_cond
id|cmsg-&gt;l
op_plus
l_int|3
suffix:colon
id|cmsg-&gt;l
op_plus
l_int|1
suffix:semicolon
id|cmsg-&gt;p
op_increment
suffix:semicolon
id|protocol_message_2_pars
c_func
(paren
id|cmsg
comma
id|level
op_plus
l_int|1
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
)brace
)brace
)brace
multiline_comment|/*-------------------------------------------------------*/
DECL|function|capi_message2str
r_char
op_star
id|capi_message2str
c_func
(paren
id|__u8
op_star
id|msg
)paren
(brace
id|_cmsg
id|cmsg
suffix:semicolon
id|p
op_assign
id|buf
suffix:semicolon
id|p
(braket
l_int|0
)braket
op_assign
l_int|0
suffix:semicolon
id|cmsg.m
op_assign
id|msg
suffix:semicolon
id|cmsg.l
op_assign
l_int|8
suffix:semicolon
id|cmsg.p
op_assign
l_int|0
suffix:semicolon
id|byteTRcpy
c_func
(paren
id|cmsg.m
op_plus
l_int|4
comma
op_amp
id|cmsg.Command
)paren
suffix:semicolon
id|byteTRcpy
c_func
(paren
id|cmsg.m
op_plus
l_int|5
comma
op_amp
id|cmsg.Subcommand
)paren
suffix:semicolon
id|cmsg.par
op_assign
id|cpars
(braket
id|command_2_index
c_func
(paren
id|cmsg.Command
comma
id|cmsg.Subcommand
)paren
)braket
suffix:semicolon
id|bufprint
c_func
(paren
l_string|&quot;%-26s ID=%03d #0x%04x LEN=%04d&bslash;n&quot;
comma
id|mnames
(braket
id|command_2_index
c_func
(paren
id|cmsg.Command
comma
id|cmsg.Subcommand
)paren
)braket
comma
(paren
(paren
r_int
r_int
op_star
)paren
id|msg
)paren
(braket
l_int|1
)braket
comma
(paren
(paren
r_int
r_int
op_star
)paren
id|msg
)paren
(braket
l_int|3
)braket
comma
(paren
(paren
r_int
r_int
op_star
)paren
id|msg
)paren
(braket
l_int|0
)braket
)paren
suffix:semicolon
id|protocol_message_2_pars
c_func
(paren
op_amp
id|cmsg
comma
l_int|1
)paren
suffix:semicolon
r_return
id|buf
suffix:semicolon
)brace
DECL|function|capi_cmsg2str
r_char
op_star
id|capi_cmsg2str
c_func
(paren
id|_cmsg
op_star
id|cmsg
)paren
(brace
id|p
op_assign
id|buf
suffix:semicolon
id|p
(braket
l_int|0
)braket
op_assign
l_int|0
suffix:semicolon
id|cmsg-&gt;l
op_assign
l_int|8
suffix:semicolon
id|cmsg-&gt;p
op_assign
l_int|0
suffix:semicolon
id|bufprint
c_func
(paren
l_string|&quot;%s ID=%03d #0x%04x LEN=%04d&bslash;n&quot;
comma
id|mnames
(braket
id|command_2_index
c_func
(paren
id|cmsg-&gt;Command
comma
id|cmsg-&gt;Subcommand
)paren
)braket
comma
(paren
(paren
id|__u16
op_star
)paren
id|cmsg-&gt;m
)paren
(braket
l_int|1
)braket
comma
(paren
(paren
id|__u16
op_star
)paren
id|cmsg-&gt;m
)paren
(braket
l_int|3
)braket
comma
(paren
(paren
id|__u16
op_star
)paren
id|cmsg-&gt;m
)paren
(braket
l_int|0
)braket
)paren
suffix:semicolon
id|protocol_message_2_pars
c_func
(paren
id|cmsg
comma
l_int|1
)paren
suffix:semicolon
r_return
id|buf
suffix:semicolon
)brace
DECL|variable|capi_cmsg2message
id|EXPORT_SYMBOL
c_func
(paren
id|capi_cmsg2message
)paren
suffix:semicolon
DECL|variable|capi_message2cmsg
id|EXPORT_SYMBOL
c_func
(paren
id|capi_message2cmsg
)paren
suffix:semicolon
DECL|variable|capi_cmsg_header
id|EXPORT_SYMBOL
c_func
(paren
id|capi_cmsg_header
)paren
suffix:semicolon
DECL|variable|capi_cmd2str
id|EXPORT_SYMBOL
c_func
(paren
id|capi_cmd2str
)paren
suffix:semicolon
DECL|variable|capi_cmsg2str
id|EXPORT_SYMBOL
c_func
(paren
id|capi_cmsg2str
)paren
suffix:semicolon
DECL|variable|capi_message2str
id|EXPORT_SYMBOL
c_func
(paren
id|capi_message2str
)paren
suffix:semicolon
DECL|variable|capi_info2str
id|EXPORT_SYMBOL
c_func
(paren
id|capi_info2str
)paren
suffix:semicolon
DECL|function|capiutil_init
r_static
r_int
id|__init
id|capiutil_init
c_func
(paren
r_void
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|capiutil_exit
r_static
r_void
id|__exit
id|capiutil_exit
c_func
(paren
r_void
)paren
(brace
)brace
DECL|variable|capiutil_init
id|module_init
c_func
(paren
id|capiutil_init
)paren
suffix:semicolon
DECL|variable|capiutil_exit
id|module_exit
c_func
(paren
id|capiutil_exit
)paren
suffix:semicolon
eof
