multiline_comment|/* $Id: capi.c,v 1.9 2000/11/12 16:32:06 kai Exp $&n; *&n; * ISDN lowlevel-module for the IBM ISDN-S0 Active 2000.&n; *        CAPI encoder/decoder&n; *&n; * Copyright 1998 by Fritz Elfert (fritz@isdn4linux.de)&n; * Thanks to Friedemann Baitinger and IBM Germany&n; *&n; * This program is free software; you can redistribute it and/or modify&n; * it under the terms of the GNU General Public License as published by&n; * the Free Software Foundation; either version 2, or (at your option)&n; * any later version.&n; *&n; * This program is distributed in the hope that it will be useful,&n; * but WITHOUT ANY WARRANTY; without even the implied warranty of&n; * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; * GNU General Public License for more details.&n; *&n; * You should have received a copy of the GNU General Public License&n; * along with this program; if not, write to the Free Software&n; * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA. &n; *&n; */
DECL|macro|__NO_VERSION__
mdefine_line|#define __NO_VERSION__
macro_line|#include &quot;act2000.h&quot;
macro_line|#include &quot;capi.h&quot;
DECL|variable|valid_msg
r_static
id|actcapi_msgdsc
id|valid_msg
(braket
)braket
op_assign
(brace
(brace
(brace
l_int|0x86
comma
l_int|0x02
)brace
comma
l_string|&quot;DATA_B3_IND&quot;
)brace
comma
multiline_comment|/* DATA_B3_IND/CONF must be first because of speed!!! */
(brace
(brace
l_int|0x86
comma
l_int|0x01
)brace
comma
l_string|&quot;DATA_B3_CONF&quot;
)brace
comma
(brace
(brace
l_int|0x02
comma
l_int|0x01
)brace
comma
l_string|&quot;CONNECT_CONF&quot;
)brace
comma
(brace
(brace
l_int|0x02
comma
l_int|0x02
)brace
comma
l_string|&quot;CONNECT_IND&quot;
)brace
comma
(brace
(brace
l_int|0x09
comma
l_int|0x01
)brace
comma
l_string|&quot;CONNECT_INFO_CONF&quot;
)brace
comma
(brace
(brace
l_int|0x03
comma
l_int|0x02
)brace
comma
l_string|&quot;CONNECT_ACTIVE_IND&quot;
)brace
comma
(brace
(brace
l_int|0x04
comma
l_int|0x01
)brace
comma
l_string|&quot;DISCONNECT_CONF&quot;
)brace
comma
(brace
(brace
l_int|0x04
comma
l_int|0x02
)brace
comma
l_string|&quot;DISCONNECT_IND&quot;
)brace
comma
(brace
(brace
l_int|0x05
comma
l_int|0x01
)brace
comma
l_string|&quot;LISTEN_CONF&quot;
)brace
comma
(brace
(brace
l_int|0x06
comma
l_int|0x01
)brace
comma
l_string|&quot;GET_PARAMS_CONF&quot;
)brace
comma
(brace
(brace
l_int|0x07
comma
l_int|0x01
)brace
comma
l_string|&quot;INFO_CONF&quot;
)brace
comma
(brace
(brace
l_int|0x07
comma
l_int|0x02
)brace
comma
l_string|&quot;INFO_IND&quot;
)brace
comma
(brace
(brace
l_int|0x08
comma
l_int|0x01
)brace
comma
l_string|&quot;DATA_CONF&quot;
)brace
comma
(brace
(brace
l_int|0x08
comma
l_int|0x02
)brace
comma
l_string|&quot;DATA_IND&quot;
)brace
comma
(brace
(brace
l_int|0x40
comma
l_int|0x01
)brace
comma
l_string|&quot;SELECT_B2_PROTOCOL_CONF&quot;
)brace
comma
(brace
(brace
l_int|0x80
comma
l_int|0x01
)brace
comma
l_string|&quot;SELECT_B3_PROTOCOL_CONF&quot;
)brace
comma
(brace
(brace
l_int|0x81
comma
l_int|0x01
)brace
comma
l_string|&quot;LISTEN_B3_CONF&quot;
)brace
comma
(brace
(brace
l_int|0x82
comma
l_int|0x01
)brace
comma
l_string|&quot;CONNECT_B3_CONF&quot;
)brace
comma
(brace
(brace
l_int|0x82
comma
l_int|0x02
)brace
comma
l_string|&quot;CONNECT_B3_IND&quot;
)brace
comma
(brace
(brace
l_int|0x83
comma
l_int|0x02
)brace
comma
l_string|&quot;CONNECT_B3_ACTIVE_IND&quot;
)brace
comma
(brace
(brace
l_int|0x84
comma
l_int|0x01
)brace
comma
l_string|&quot;DISCONNECT_B3_CONF&quot;
)brace
comma
(brace
(brace
l_int|0x84
comma
l_int|0x02
)brace
comma
l_string|&quot;DISCONNECT_B3_IND&quot;
)brace
comma
(brace
(brace
l_int|0x85
comma
l_int|0x01
)brace
comma
l_string|&quot;GET_B3_PARAMS_CONF&quot;
)brace
comma
(brace
(brace
l_int|0x01
comma
l_int|0x01
)brace
comma
l_string|&quot;RESET_B3_CONF&quot;
)brace
comma
(brace
(brace
l_int|0x01
comma
l_int|0x02
)brace
comma
l_string|&quot;RESET_B3_IND&quot;
)brace
comma
multiline_comment|/* {{ 0x87, 0x02, &quot;HANDSET_IND&quot;}, not implemented */
(brace
(brace
l_int|0xff
comma
l_int|0x01
)brace
comma
l_string|&quot;MANUFACTURER_CONF&quot;
)brace
comma
(brace
(brace
l_int|0xff
comma
l_int|0x02
)brace
comma
l_string|&quot;MANUFACTURER_IND&quot;
)brace
comma
macro_line|#ifdef DEBUG_MSG
multiline_comment|/* Requests */
(brace
(brace
l_int|0x01
comma
l_int|0x00
)brace
comma
l_string|&quot;RESET_B3_REQ&quot;
)brace
comma
(brace
(brace
l_int|0x02
comma
l_int|0x00
)brace
comma
l_string|&quot;CONNECT_REQ&quot;
)brace
comma
(brace
(brace
l_int|0x04
comma
l_int|0x00
)brace
comma
l_string|&quot;DISCONNECT_REQ&quot;
)brace
comma
(brace
(brace
l_int|0x05
comma
l_int|0x00
)brace
comma
l_string|&quot;LISTEN_REQ&quot;
)brace
comma
(brace
(brace
l_int|0x06
comma
l_int|0x00
)brace
comma
l_string|&quot;GET_PARAMS_REQ&quot;
)brace
comma
(brace
(brace
l_int|0x07
comma
l_int|0x00
)brace
comma
l_string|&quot;INFO_REQ&quot;
)brace
comma
(brace
(brace
l_int|0x08
comma
l_int|0x00
)brace
comma
l_string|&quot;DATA_REQ&quot;
)brace
comma
(brace
(brace
l_int|0x09
comma
l_int|0x00
)brace
comma
l_string|&quot;CONNECT_INFO_REQ&quot;
)brace
comma
(brace
(brace
l_int|0x40
comma
l_int|0x00
)brace
comma
l_string|&quot;SELECT_B2_PROTOCOL_REQ&quot;
)brace
comma
(brace
(brace
l_int|0x80
comma
l_int|0x00
)brace
comma
l_string|&quot;SELECT_B3_PROTOCOL_REQ&quot;
)brace
comma
(brace
(brace
l_int|0x81
comma
l_int|0x00
)brace
comma
l_string|&quot;LISTEN_B3_REQ&quot;
)brace
comma
(brace
(brace
l_int|0x82
comma
l_int|0x00
)brace
comma
l_string|&quot;CONNECT_B3_REQ&quot;
)brace
comma
(brace
(brace
l_int|0x84
comma
l_int|0x00
)brace
comma
l_string|&quot;DISCONNECT_B3_REQ&quot;
)brace
comma
(brace
(brace
l_int|0x85
comma
l_int|0x00
)brace
comma
l_string|&quot;GET_B3_PARAMS_REQ&quot;
)brace
comma
(brace
(brace
l_int|0x86
comma
l_int|0x00
)brace
comma
l_string|&quot;DATA_B3_REQ&quot;
)brace
comma
(brace
(brace
l_int|0xff
comma
l_int|0x00
)brace
comma
l_string|&quot;MANUFACTURER_REQ&quot;
)brace
comma
multiline_comment|/* Responses */
(brace
(brace
l_int|0x01
comma
l_int|0x03
)brace
comma
l_string|&quot;RESET_B3_RESP&quot;
)brace
comma
(brace
(brace
l_int|0x02
comma
l_int|0x03
)brace
comma
l_string|&quot;CONNECT_RESP&quot;
)brace
comma
(brace
(brace
l_int|0x03
comma
l_int|0x03
)brace
comma
l_string|&quot;CONNECT_ACTIVE_RESP&quot;
)brace
comma
(brace
(brace
l_int|0x04
comma
l_int|0x03
)brace
comma
l_string|&quot;DISCONNECT_RESP&quot;
)brace
comma
(brace
(brace
l_int|0x07
comma
l_int|0x03
)brace
comma
l_string|&quot;INFO_RESP&quot;
)brace
comma
(brace
(brace
l_int|0x08
comma
l_int|0x03
)brace
comma
l_string|&quot;DATA_RESP&quot;
)brace
comma
(brace
(brace
l_int|0x82
comma
l_int|0x03
)brace
comma
l_string|&quot;CONNECT_B3_RESP&quot;
)brace
comma
(brace
(brace
l_int|0x83
comma
l_int|0x03
)brace
comma
l_string|&quot;CONNECT_B3_ACTIVE_RESP&quot;
)brace
comma
(brace
(brace
l_int|0x84
comma
l_int|0x03
)brace
comma
l_string|&quot;DISCONNECT_B3_RESP&quot;
)brace
comma
(brace
(brace
l_int|0x86
comma
l_int|0x03
)brace
comma
l_string|&quot;DATA_B3_RESP&quot;
)brace
comma
(brace
(brace
l_int|0xff
comma
l_int|0x03
)brace
comma
l_string|&quot;MANUFACTURER_RESP&quot;
)brace
comma
macro_line|#endif
(brace
(brace
l_int|0x00
comma
l_int|0x00
)brace
comma
l_int|NULL
)brace
comma
)brace
suffix:semicolon
DECL|macro|num_valid_msg
mdefine_line|#define num_valid_msg (sizeof(valid_msg)/sizeof(actcapi_msgdsc))
DECL|macro|num_valid_imsg
mdefine_line|#define num_valid_imsg 27 /* MANUFACTURER_IND */
multiline_comment|/*&n; * Check for a valid incoming CAPI message.&n; * Return:&n; *   0 = Invalid message&n; *   1 = Valid message, no B-Channel-data&n; *   2 = Valid message, B-Channel-data&n; */
r_int
DECL|function|actcapi_chkhdr
id|actcapi_chkhdr
c_func
(paren
id|act2000_card
op_star
id|card
comma
id|actcapi_msghdr
op_star
id|hdr
)paren
(brace
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
id|hdr-&gt;applicationID
op_ne
l_int|1
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|hdr-&gt;len
OL
l_int|9
)paren
r_return
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|num_valid_imsg
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
(paren
id|hdr-&gt;cmd.cmd
op_eq
id|valid_msg
(braket
id|i
)braket
dot
id|cmd.cmd
)paren
op_logical_and
(paren
id|hdr-&gt;cmd.subcmd
op_eq
id|valid_msg
(braket
id|i
)braket
dot
id|cmd.subcmd
)paren
)paren
(brace
r_return
(paren
id|i
ques
c_cond
l_int|1
suffix:colon
l_int|2
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|macro|ACTCAPI_MKHDR
mdefine_line|#define ACTCAPI_MKHDR(l, c, s) { &bslash;&n;&t;skb = alloc_skb(l + 8, GFP_ATOMIC); &bslash;&n;&t;if (skb) { &bslash;&n;&t;        m = (actcapi_msg *)skb_put(skb, l + 8); &bslash;&n;&t;&t;m-&gt;hdr.len = l + 8; &bslash;&n;&t;&t;m-&gt;hdr.applicationID = 1; &bslash;&n;&t;        m-&gt;hdr.cmd.cmd = c; &bslash;&n;&t;        m-&gt;hdr.cmd.subcmd = s; &bslash;&n;&t;        m-&gt;hdr.msgnum = actcapi_nextsmsg(card); &bslash;&n;&t;} &bslash;&n;}
DECL|macro|ACTCAPI_CHKSKB
mdefine_line|#define ACTCAPI_CHKSKB if (!skb) { &bslash;&n;&t;printk(KERN_WARNING &quot;actcapi: alloc_skb failed&bslash;n&quot;); &bslash;&n;&t;return; &bslash;&n;}
DECL|macro|ACTCAPI_QUEUE_TX
mdefine_line|#define ACTCAPI_QUEUE_TX { &bslash;&n;&t;actcapi_debug_msg(skb, 1); &bslash;&n;&t;skb_queue_tail(&amp;card-&gt;sndq, skb); &bslash;&n;&t;act2000_schedule_tx(card); &bslash;&n;}
r_int
DECL|function|actcapi_listen_req
id|actcapi_listen_req
c_func
(paren
id|act2000_card
op_star
id|card
)paren
(brace
id|__u16
id|eazmask
op_assign
l_int|0
suffix:semicolon
r_int
id|i
suffix:semicolon
id|actcapi_msg
op_star
id|m
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ACT2000_BCH
suffix:semicolon
id|i
op_increment
)paren
id|eazmask
op_or_assign
id|card-&gt;bch
(braket
id|i
)braket
dot
id|eazmask
suffix:semicolon
id|ACTCAPI_MKHDR
c_func
(paren
l_int|9
comma
l_int|0x05
comma
l_int|0x00
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;actcapi: alloc_skb failed&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|m-&gt;msg.listen_req.controller
op_assign
l_int|0
suffix:semicolon
id|m-&gt;msg.listen_req.infomask
op_assign
l_int|0x3f
suffix:semicolon
multiline_comment|/* All information */
id|m-&gt;msg.listen_req.eazmask
op_assign
id|eazmask
suffix:semicolon
id|m-&gt;msg.listen_req.simask
op_assign
(paren
id|eazmask
)paren
ques
c_cond
l_int|0x86
suffix:colon
l_int|0
suffix:semicolon
multiline_comment|/* All SI&squot;s  */
id|ACTCAPI_QUEUE_TX
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_int
DECL|function|actcapi_connect_req
id|actcapi_connect_req
c_func
(paren
id|act2000_card
op_star
id|card
comma
id|act2000_chan
op_star
id|chan
comma
r_char
op_star
id|phone
comma
r_char
id|eaz
comma
r_int
id|si1
comma
r_int
id|si2
)paren
(brace
id|actcapi_msg
op_star
id|m
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|ACTCAPI_MKHDR
c_func
(paren
(paren
l_int|11
op_plus
id|strlen
c_func
(paren
id|phone
)paren
)paren
comma
l_int|0x02
comma
l_int|0x00
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;actcapi: alloc_skb failed&bslash;n&quot;
)paren
suffix:semicolon
id|chan-&gt;fsm_state
op_assign
id|ACT2000_STATE_NULL
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|m-&gt;msg.connect_req.controller
op_assign
l_int|0
suffix:semicolon
id|m-&gt;msg.connect_req.bchan
op_assign
l_int|0x83
suffix:semicolon
id|m-&gt;msg.connect_req.infomask
op_assign
l_int|0x3f
suffix:semicolon
id|m-&gt;msg.connect_req.si1
op_assign
id|si1
suffix:semicolon
id|m-&gt;msg.connect_req.si2
op_assign
id|si2
suffix:semicolon
id|m-&gt;msg.connect_req.eaz
op_assign
id|eaz
ques
c_cond
id|eaz
suffix:colon
l_char|&squot;0&squot;
suffix:semicolon
id|m-&gt;msg.connect_req.addr.len
op_assign
id|strlen
c_func
(paren
id|phone
)paren
op_plus
l_int|1
suffix:semicolon
id|m-&gt;msg.connect_req.addr.tnp
op_assign
l_int|0x81
suffix:semicolon
id|memcpy
c_func
(paren
id|m-&gt;msg.connect_req.addr.num
comma
id|phone
comma
id|strlen
c_func
(paren
id|phone
)paren
)paren
suffix:semicolon
id|chan-&gt;callref
op_assign
id|m-&gt;hdr.msgnum
suffix:semicolon
id|ACTCAPI_QUEUE_TX
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_static
r_void
DECL|function|actcapi_connect_b3_req
id|actcapi_connect_b3_req
c_func
(paren
id|act2000_card
op_star
id|card
comma
id|act2000_chan
op_star
id|chan
)paren
(brace
id|actcapi_msg
op_star
id|m
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|ACTCAPI_MKHDR
c_func
(paren
l_int|17
comma
l_int|0x82
comma
l_int|0x00
)paren
suffix:semicolon
id|ACTCAPI_CHKSKB
suffix:semicolon
id|m-&gt;msg.connect_b3_req.plci
op_assign
id|chan-&gt;plci
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|m-&gt;msg.connect_b3_req.ncpi
comma
l_int|0
comma
r_sizeof
(paren
id|m-&gt;msg.connect_b3_req.ncpi
)paren
)paren
suffix:semicolon
id|m-&gt;msg.connect_b3_req.ncpi.len
op_assign
l_int|13
suffix:semicolon
id|m-&gt;msg.connect_b3_req.ncpi.modulo
op_assign
l_int|8
suffix:semicolon
id|ACTCAPI_QUEUE_TX
suffix:semicolon
)brace
multiline_comment|/*&n; * Set net type (1TR6) or (EDSS1)&n; */
r_int
DECL|function|actcapi_manufacturer_req_net
id|actcapi_manufacturer_req_net
c_func
(paren
id|act2000_card
op_star
id|card
)paren
(brace
id|actcapi_msg
op_star
id|m
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|ACTCAPI_MKHDR
c_func
(paren
l_int|5
comma
l_int|0xff
comma
l_int|0x00
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;actcapi: alloc_skb failed&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|m-&gt;msg.manufacturer_req_net.manuf_msg
op_assign
l_int|0x11
suffix:semicolon
id|m-&gt;msg.manufacturer_req_net.controller
op_assign
l_int|1
suffix:semicolon
id|m-&gt;msg.manufacturer_req_net.nettype
op_assign
(paren
id|card-&gt;ptype
op_eq
id|ISDN_PTYPE_EURO
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
id|ACTCAPI_QUEUE_TX
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;act2000 %s: D-channel protocol now %s&bslash;n&quot;
comma
id|card-&gt;interface.id
comma
(paren
id|card-&gt;ptype
op_eq
id|ISDN_PTYPE_EURO
)paren
ques
c_cond
l_string|&quot;euro&quot;
suffix:colon
l_string|&quot;1tr6&quot;
)paren
suffix:semicolon
id|card-&gt;interface.features
op_and_assign
op_complement
(paren
id|ISDN_FEATURE_P_UNKNOWN
op_or
id|ISDN_FEATURE_P_EURO
op_or
id|ISDN_FEATURE_P_1TR6
)paren
suffix:semicolon
id|card-&gt;interface.features
op_or_assign
(paren
(paren
id|card-&gt;ptype
op_eq
id|ISDN_PTYPE_EURO
)paren
ques
c_cond
id|ISDN_FEATURE_P_EURO
suffix:colon
id|ISDN_FEATURE_P_1TR6
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * Switch V.42 on or off&n; */
r_int
DECL|function|actcapi_manufacturer_req_v42
id|actcapi_manufacturer_req_v42
c_func
(paren
id|act2000_card
op_star
id|card
comma
id|ulong
id|arg
)paren
(brace
id|actcapi_msg
op_star
id|m
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|ACTCAPI_MKHDR
c_func
(paren
l_int|8
comma
l_int|0xff
comma
l_int|0x00
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;actcapi: alloc_skb failed&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|m-&gt;msg.manufacturer_req_v42.manuf_msg
op_assign
l_int|0x10
suffix:semicolon
id|m-&gt;msg.manufacturer_req_v42.controller
op_assign
l_int|0
suffix:semicolon
id|m-&gt;msg.manufacturer_req_v42.v42control
op_assign
(paren
id|arg
ques
c_cond
l_int|1
suffix:colon
l_int|0
)paren
suffix:semicolon
id|ACTCAPI_QUEUE_TX
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * Set error-handler&n; */
r_int
DECL|function|actcapi_manufacturer_req_errh
id|actcapi_manufacturer_req_errh
c_func
(paren
id|act2000_card
op_star
id|card
)paren
(brace
id|actcapi_msg
op_star
id|m
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|ACTCAPI_MKHDR
c_func
(paren
l_int|4
comma
l_int|0xff
comma
l_int|0x00
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;actcapi: alloc_skb failed&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|m-&gt;msg.manufacturer_req_err.manuf_msg
op_assign
l_int|0x03
suffix:semicolon
id|m-&gt;msg.manufacturer_req_err.controller
op_assign
l_int|0
suffix:semicolon
id|ACTCAPI_QUEUE_TX
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * Set MSN-Mapping.&n; */
r_int
DECL|function|actcapi_manufacturer_req_msn
id|actcapi_manufacturer_req_msn
c_func
(paren
id|act2000_card
op_star
id|card
)paren
(brace
id|msn_entry
op_star
id|p
op_assign
id|card-&gt;msn_list
suffix:semicolon
id|actcapi_msg
op_star
id|m
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_int
id|len
suffix:semicolon
r_while
c_loop
(paren
id|p
)paren
(brace
r_int
id|i
suffix:semicolon
id|len
op_assign
id|strlen
c_func
(paren
id|p-&gt;msn
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|2
suffix:semicolon
id|i
op_increment
)paren
(brace
id|ACTCAPI_MKHDR
c_func
(paren
l_int|6
op_plus
id|len
comma
l_int|0xff
comma
l_int|0x00
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;actcapi: alloc_skb failed&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|m-&gt;msg.manufacturer_req_msn.manuf_msg
op_assign
l_int|0x13
op_plus
id|i
suffix:semicolon
id|m-&gt;msg.manufacturer_req_msn.controller
op_assign
l_int|0
suffix:semicolon
id|m-&gt;msg.manufacturer_req_msn.msnmap.eaz
op_assign
id|p-&gt;eaz
suffix:semicolon
id|m-&gt;msg.manufacturer_req_msn.msnmap.len
op_assign
id|len
suffix:semicolon
id|memcpy
c_func
(paren
id|m-&gt;msg.manufacturer_req_msn.msnmap.msn
comma
id|p-&gt;msn
comma
id|len
)paren
suffix:semicolon
id|ACTCAPI_QUEUE_TX
suffix:semicolon
)brace
id|p
op_assign
id|p-&gt;next
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
r_void
DECL|function|actcapi_select_b2_protocol_req
id|actcapi_select_b2_protocol_req
c_func
(paren
id|act2000_card
op_star
id|card
comma
id|act2000_chan
op_star
id|chan
)paren
(brace
id|actcapi_msg
op_star
id|m
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|ACTCAPI_MKHDR
c_func
(paren
l_int|10
comma
l_int|0x40
comma
l_int|0x00
)paren
suffix:semicolon
id|ACTCAPI_CHKSKB
suffix:semicolon
id|m-&gt;msg.select_b2_protocol_req.plci
op_assign
id|chan-&gt;plci
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|m-&gt;msg.select_b2_protocol_req.dlpd
comma
l_int|0
comma
r_sizeof
(paren
id|m-&gt;msg.select_b2_protocol_req.dlpd
)paren
)paren
suffix:semicolon
id|m-&gt;msg.select_b2_protocol_req.dlpd.len
op_assign
l_int|6
suffix:semicolon
r_switch
c_cond
(paren
id|chan-&gt;l2prot
)paren
(brace
r_case
id|ISDN_PROTO_L2_TRANS
suffix:colon
id|m-&gt;msg.select_b2_protocol_req.protocol
op_assign
l_int|0x03
suffix:semicolon
id|m-&gt;msg.select_b2_protocol_req.dlpd.dlen
op_assign
l_int|4000
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ISDN_PROTO_L2_HDLC
suffix:colon
id|m-&gt;msg.select_b2_protocol_req.protocol
op_assign
l_int|0x02
suffix:semicolon
id|m-&gt;msg.select_b2_protocol_req.dlpd.dlen
op_assign
l_int|4000
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ISDN_PROTO_L2_X75I
suffix:colon
r_case
id|ISDN_PROTO_L2_X75UI
suffix:colon
r_case
id|ISDN_PROTO_L2_X75BUI
suffix:colon
id|m-&gt;msg.select_b2_protocol_req.protocol
op_assign
l_int|0x01
suffix:semicolon
id|m-&gt;msg.select_b2_protocol_req.dlpd.dlen
op_assign
l_int|4000
suffix:semicolon
id|m-&gt;msg.select_b2_protocol_req.dlpd.laa
op_assign
l_int|3
suffix:semicolon
id|m-&gt;msg.select_b2_protocol_req.dlpd.lab
op_assign
l_int|1
suffix:semicolon
id|m-&gt;msg.select_b2_protocol_req.dlpd.win
op_assign
l_int|7
suffix:semicolon
id|m-&gt;msg.select_b2_protocol_req.dlpd.modulo
op_assign
l_int|8
suffix:semicolon
r_break
suffix:semicolon
)brace
id|ACTCAPI_QUEUE_TX
suffix:semicolon
)brace
r_static
r_void
DECL|function|actcapi_select_b3_protocol_req
id|actcapi_select_b3_protocol_req
c_func
(paren
id|act2000_card
op_star
id|card
comma
id|act2000_chan
op_star
id|chan
)paren
(brace
id|actcapi_msg
op_star
id|m
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|ACTCAPI_MKHDR
c_func
(paren
l_int|17
comma
l_int|0x80
comma
l_int|0x00
)paren
suffix:semicolon
id|ACTCAPI_CHKSKB
suffix:semicolon
id|m-&gt;msg.select_b3_protocol_req.plci
op_assign
id|chan-&gt;plci
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|m-&gt;msg.select_b3_protocol_req.ncpd
comma
l_int|0
comma
r_sizeof
(paren
id|m-&gt;msg.select_b3_protocol_req.ncpd
)paren
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|chan-&gt;l3prot
)paren
(brace
r_case
id|ISDN_PROTO_L3_TRANS
suffix:colon
id|m-&gt;msg.select_b3_protocol_req.protocol
op_assign
l_int|0x04
suffix:semicolon
id|m-&gt;msg.select_b3_protocol_req.ncpd.len
op_assign
l_int|13
suffix:semicolon
id|m-&gt;msg.select_b3_protocol_req.ncpd.modulo
op_assign
l_int|8
suffix:semicolon
r_break
suffix:semicolon
)brace
id|ACTCAPI_QUEUE_TX
suffix:semicolon
)brace
r_static
r_void
DECL|function|actcapi_listen_b3_req
id|actcapi_listen_b3_req
c_func
(paren
id|act2000_card
op_star
id|card
comma
id|act2000_chan
op_star
id|chan
)paren
(brace
id|actcapi_msg
op_star
id|m
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|ACTCAPI_MKHDR
c_func
(paren
l_int|2
comma
l_int|0x81
comma
l_int|0x00
)paren
suffix:semicolon
id|ACTCAPI_CHKSKB
suffix:semicolon
id|m-&gt;msg.listen_b3_req.plci
op_assign
id|chan-&gt;plci
suffix:semicolon
id|ACTCAPI_QUEUE_TX
suffix:semicolon
)brace
r_static
r_void
DECL|function|actcapi_disconnect_req
id|actcapi_disconnect_req
c_func
(paren
id|act2000_card
op_star
id|card
comma
id|act2000_chan
op_star
id|chan
)paren
(brace
id|actcapi_msg
op_star
id|m
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|ACTCAPI_MKHDR
c_func
(paren
l_int|3
comma
l_int|0x04
comma
l_int|0x00
)paren
suffix:semicolon
id|ACTCAPI_CHKSKB
suffix:semicolon
id|m-&gt;msg.disconnect_req.plci
op_assign
id|chan-&gt;plci
suffix:semicolon
id|m-&gt;msg.disconnect_req.cause
op_assign
l_int|0
suffix:semicolon
id|ACTCAPI_QUEUE_TX
suffix:semicolon
)brace
r_void
DECL|function|actcapi_disconnect_b3_req
id|actcapi_disconnect_b3_req
c_func
(paren
id|act2000_card
op_star
id|card
comma
id|act2000_chan
op_star
id|chan
)paren
(brace
id|actcapi_msg
op_star
id|m
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|ACTCAPI_MKHDR
c_func
(paren
l_int|17
comma
l_int|0x84
comma
l_int|0x00
)paren
suffix:semicolon
id|ACTCAPI_CHKSKB
suffix:semicolon
id|m-&gt;msg.disconnect_b3_req.ncci
op_assign
id|chan-&gt;ncci
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|m-&gt;msg.disconnect_b3_req.ncpi
comma
l_int|0
comma
r_sizeof
(paren
id|m-&gt;msg.disconnect_b3_req.ncpi
)paren
)paren
suffix:semicolon
id|m-&gt;msg.disconnect_b3_req.ncpi.len
op_assign
l_int|13
suffix:semicolon
id|m-&gt;msg.disconnect_b3_req.ncpi.modulo
op_assign
l_int|8
suffix:semicolon
id|chan-&gt;fsm_state
op_assign
id|ACT2000_STATE_BHWAIT
suffix:semicolon
id|ACTCAPI_QUEUE_TX
suffix:semicolon
)brace
r_void
DECL|function|actcapi_connect_resp
id|actcapi_connect_resp
c_func
(paren
id|act2000_card
op_star
id|card
comma
id|act2000_chan
op_star
id|chan
comma
id|__u8
id|cause
)paren
(brace
id|actcapi_msg
op_star
id|m
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|ACTCAPI_MKHDR
c_func
(paren
l_int|3
comma
l_int|0x02
comma
l_int|0x03
)paren
suffix:semicolon
id|ACTCAPI_CHKSKB
suffix:semicolon
id|m-&gt;msg.connect_resp.plci
op_assign
id|chan-&gt;plci
suffix:semicolon
id|m-&gt;msg.connect_resp.rejectcause
op_assign
id|cause
suffix:semicolon
r_if
c_cond
(paren
id|cause
)paren
(brace
id|chan-&gt;fsm_state
op_assign
id|ACT2000_STATE_NULL
suffix:semicolon
id|chan-&gt;plci
op_assign
l_int|0x8000
suffix:semicolon
)brace
r_else
id|chan-&gt;fsm_state
op_assign
id|ACT2000_STATE_IWAIT
suffix:semicolon
id|ACTCAPI_QUEUE_TX
suffix:semicolon
)brace
r_static
r_void
DECL|function|actcapi_connect_active_resp
id|actcapi_connect_active_resp
c_func
(paren
id|act2000_card
op_star
id|card
comma
id|act2000_chan
op_star
id|chan
)paren
(brace
id|actcapi_msg
op_star
id|m
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|ACTCAPI_MKHDR
c_func
(paren
l_int|2
comma
l_int|0x03
comma
l_int|0x03
)paren
suffix:semicolon
id|ACTCAPI_CHKSKB
suffix:semicolon
id|m-&gt;msg.connect_resp.plci
op_assign
id|chan-&gt;plci
suffix:semicolon
r_if
c_cond
(paren
id|chan-&gt;fsm_state
op_eq
id|ACT2000_STATE_IWAIT
)paren
id|chan-&gt;fsm_state
op_assign
id|ACT2000_STATE_IBWAIT
suffix:semicolon
id|ACTCAPI_QUEUE_TX
suffix:semicolon
)brace
r_static
r_void
DECL|function|actcapi_connect_b3_resp
id|actcapi_connect_b3_resp
c_func
(paren
id|act2000_card
op_star
id|card
comma
id|act2000_chan
op_star
id|chan
comma
id|__u8
id|rejectcause
)paren
(brace
id|actcapi_msg
op_star
id|m
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|ACTCAPI_MKHDR
c_func
(paren
(paren
id|rejectcause
ques
c_cond
l_int|3
suffix:colon
l_int|17
)paren
comma
l_int|0x82
comma
l_int|0x03
)paren
suffix:semicolon
id|ACTCAPI_CHKSKB
suffix:semicolon
id|m-&gt;msg.connect_b3_resp.ncci
op_assign
id|chan-&gt;ncci
suffix:semicolon
id|m-&gt;msg.connect_b3_resp.rejectcause
op_assign
id|rejectcause
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|rejectcause
)paren
(brace
id|memset
c_func
(paren
op_amp
id|m-&gt;msg.connect_b3_resp.ncpi
comma
l_int|0
comma
r_sizeof
(paren
id|m-&gt;msg.connect_b3_resp.ncpi
)paren
)paren
suffix:semicolon
id|m-&gt;msg.connect_b3_resp.ncpi.len
op_assign
l_int|13
suffix:semicolon
id|m-&gt;msg.connect_b3_resp.ncpi.modulo
op_assign
l_int|8
suffix:semicolon
id|chan-&gt;fsm_state
op_assign
id|ACT2000_STATE_BWAIT
suffix:semicolon
)brace
id|ACTCAPI_QUEUE_TX
suffix:semicolon
)brace
r_static
r_void
DECL|function|actcapi_connect_b3_active_resp
id|actcapi_connect_b3_active_resp
c_func
(paren
id|act2000_card
op_star
id|card
comma
id|act2000_chan
op_star
id|chan
)paren
(brace
id|actcapi_msg
op_star
id|m
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|ACTCAPI_MKHDR
c_func
(paren
l_int|2
comma
l_int|0x83
comma
l_int|0x03
)paren
suffix:semicolon
id|ACTCAPI_CHKSKB
suffix:semicolon
id|m-&gt;msg.connect_b3_active_resp.ncci
op_assign
id|chan-&gt;ncci
suffix:semicolon
id|chan-&gt;fsm_state
op_assign
id|ACT2000_STATE_ACTIVE
suffix:semicolon
id|ACTCAPI_QUEUE_TX
suffix:semicolon
)brace
r_static
r_void
DECL|function|actcapi_info_resp
id|actcapi_info_resp
c_func
(paren
id|act2000_card
op_star
id|card
comma
id|act2000_chan
op_star
id|chan
)paren
(brace
id|actcapi_msg
op_star
id|m
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|ACTCAPI_MKHDR
c_func
(paren
l_int|2
comma
l_int|0x07
comma
l_int|0x03
)paren
suffix:semicolon
id|ACTCAPI_CHKSKB
suffix:semicolon
id|m-&gt;msg.info_resp.plci
op_assign
id|chan-&gt;plci
suffix:semicolon
id|ACTCAPI_QUEUE_TX
suffix:semicolon
)brace
r_static
r_void
DECL|function|actcapi_disconnect_b3_resp
id|actcapi_disconnect_b3_resp
c_func
(paren
id|act2000_card
op_star
id|card
comma
id|act2000_chan
op_star
id|chan
)paren
(brace
id|actcapi_msg
op_star
id|m
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|ACTCAPI_MKHDR
c_func
(paren
l_int|2
comma
l_int|0x84
comma
l_int|0x03
)paren
suffix:semicolon
id|ACTCAPI_CHKSKB
suffix:semicolon
id|m-&gt;msg.disconnect_b3_resp.ncci
op_assign
id|chan-&gt;ncci
suffix:semicolon
id|chan-&gt;ncci
op_assign
l_int|0x8000
suffix:semicolon
id|chan-&gt;queued
op_assign
l_int|0
suffix:semicolon
id|ACTCAPI_QUEUE_TX
suffix:semicolon
)brace
r_static
r_void
DECL|function|actcapi_disconnect_resp
id|actcapi_disconnect_resp
c_func
(paren
id|act2000_card
op_star
id|card
comma
id|act2000_chan
op_star
id|chan
)paren
(brace
id|actcapi_msg
op_star
id|m
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|ACTCAPI_MKHDR
c_func
(paren
l_int|2
comma
l_int|0x04
comma
l_int|0x03
)paren
suffix:semicolon
id|ACTCAPI_CHKSKB
suffix:semicolon
id|m-&gt;msg.disconnect_resp.plci
op_assign
id|chan-&gt;plci
suffix:semicolon
id|chan-&gt;plci
op_assign
l_int|0x8000
suffix:semicolon
id|ACTCAPI_QUEUE_TX
suffix:semicolon
)brace
r_static
r_int
DECL|function|new_plci
id|new_plci
c_func
(paren
id|act2000_card
op_star
id|card
comma
id|__u16
id|plci
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ACT2000_BCH
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|card-&gt;bch
(braket
id|i
)braket
dot
id|plci
op_eq
l_int|0x8000
)paren
(brace
id|card-&gt;bch
(braket
id|i
)braket
dot
id|plci
op_assign
id|plci
suffix:semicolon
r_return
id|i
suffix:semicolon
)brace
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_static
r_int
DECL|function|find_plci
id|find_plci
c_func
(paren
id|act2000_card
op_star
id|card
comma
id|__u16
id|plci
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ACT2000_BCH
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|card-&gt;bch
(braket
id|i
)braket
dot
id|plci
op_eq
id|plci
)paren
r_return
id|i
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_static
r_int
DECL|function|find_ncci
id|find_ncci
c_func
(paren
id|act2000_card
op_star
id|card
comma
id|__u16
id|ncci
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ACT2000_BCH
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|card-&gt;bch
(braket
id|i
)braket
dot
id|ncci
op_eq
id|ncci
)paren
r_return
id|i
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_static
r_int
DECL|function|find_dialing
id|find_dialing
c_func
(paren
id|act2000_card
op_star
id|card
comma
id|__u16
id|callref
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|ACT2000_BCH
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
(paren
id|card-&gt;bch
(braket
id|i
)braket
dot
id|callref
op_eq
id|callref
)paren
op_logical_and
(paren
id|card-&gt;bch
(braket
id|i
)braket
dot
id|fsm_state
op_eq
id|ACT2000_STATE_OCALL
)paren
)paren
r_return
id|i
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
r_static
r_int
DECL|function|actcapi_data_b3_ind
id|actcapi_data_b3_ind
c_func
(paren
id|act2000_card
op_star
id|card
comma
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
id|__u16
id|plci
suffix:semicolon
id|__u16
id|ncci
suffix:semicolon
id|__u16
id|controller
suffix:semicolon
id|__u8
id|blocknr
suffix:semicolon
r_int
id|chan
suffix:semicolon
id|actcapi_msg
op_star
id|msg
op_assign
(paren
id|actcapi_msg
op_star
)paren
id|skb-&gt;data
suffix:semicolon
id|EVAL_NCCI
c_func
(paren
id|msg-&gt;msg.data_b3_ind.fakencci
comma
id|plci
comma
id|controller
comma
id|ncci
)paren
suffix:semicolon
id|chan
op_assign
id|find_ncci
c_func
(paren
id|card
comma
id|ncci
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chan
OL
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|card-&gt;bch
(braket
id|chan
)braket
dot
id|fsm_state
op_ne
id|ACT2000_STATE_ACTIVE
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|card-&gt;bch
(braket
id|chan
)braket
dot
id|plci
op_ne
id|plci
)paren
r_return
l_int|0
suffix:semicolon
id|blocknr
op_assign
id|msg-&gt;msg.data_b3_ind.blocknr
suffix:semicolon
id|skb_pull
c_func
(paren
id|skb
comma
l_int|19
)paren
suffix:semicolon
id|card-&gt;interface
dot
id|rcvcallb_skb
c_func
(paren
id|card-&gt;myid
comma
id|chan
comma
id|skb
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|skb
op_assign
id|alloc_skb
c_func
(paren
l_int|11
comma
id|GFP_ATOMIC
)paren
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;actcapi: alloc_skb failed&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
id|msg
op_assign
(paren
id|actcapi_msg
op_star
)paren
id|skb_put
c_func
(paren
id|skb
comma
l_int|11
)paren
suffix:semicolon
id|msg-&gt;hdr.len
op_assign
l_int|11
suffix:semicolon
id|msg-&gt;hdr.applicationID
op_assign
l_int|1
suffix:semicolon
id|msg-&gt;hdr.cmd.cmd
op_assign
l_int|0x86
suffix:semicolon
id|msg-&gt;hdr.cmd.subcmd
op_assign
l_int|0x03
suffix:semicolon
id|msg-&gt;hdr.msgnum
op_assign
id|actcapi_nextsmsg
c_func
(paren
id|card
)paren
suffix:semicolon
id|msg-&gt;msg.data_b3_resp.ncci
op_assign
id|ncci
suffix:semicolon
id|msg-&gt;msg.data_b3_resp.blocknr
op_assign
id|blocknr
suffix:semicolon
id|ACTCAPI_QUEUE_TX
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
multiline_comment|/*&n; * Walk over ackq, unlink DATA_B3_REQ from it, if&n; * ncci and blocknr are matching.&n; * Decrement queued-bytes counter.&n; */
r_static
r_int
DECL|function|handle_ack
id|handle_ack
c_func
(paren
id|act2000_card
op_star
id|card
comma
id|act2000_chan
op_star
id|chan
comma
id|__u8
id|blocknr
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_struct
id|sk_buff
op_star
id|tmp
suffix:semicolon
r_struct
id|actcapi_msg
op_star
id|m
suffix:semicolon
r_int
id|ret
op_assign
l_int|0
suffix:semicolon
id|save_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
id|cli
c_func
(paren
)paren
suffix:semicolon
id|skb
op_assign
id|skb_peek
c_func
(paren
op_amp
id|card-&gt;ackq
)paren
suffix:semicolon
id|restore_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|skb
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;act2000: handle_ack nothing found!&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|tmp
op_assign
id|skb
suffix:semicolon
r_while
c_loop
(paren
l_int|1
)paren
(brace
id|m
op_assign
(paren
id|actcapi_msg
op_star
)paren
id|tmp-&gt;data
suffix:semicolon
r_if
c_cond
(paren
(paren
(paren
(paren
id|m-&gt;msg.data_b3_req.fakencci
op_rshift
l_int|8
)paren
op_amp
l_int|0xff
)paren
op_eq
id|chan-&gt;ncci
)paren
op_logical_and
(paren
id|m-&gt;msg.data_b3_req.blocknr
op_eq
id|blocknr
)paren
)paren
(brace
multiline_comment|/* found corresponding DATA_B3_REQ */
id|skb_unlink
c_func
(paren
id|tmp
)paren
suffix:semicolon
id|chan-&gt;queued
op_sub_assign
id|m-&gt;msg.data_b3_req.datalen
suffix:semicolon
r_if
c_cond
(paren
id|m-&gt;msg.data_b3_req.flags
)paren
id|ret
op_assign
id|m-&gt;msg.data_b3_req.datalen
suffix:semicolon
id|dev_kfree_skb
c_func
(paren
id|tmp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chan-&gt;queued
OL
l_int|0
)paren
id|chan-&gt;queued
op_assign
l_int|0
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
id|save_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
id|cli
c_func
(paren
)paren
suffix:semicolon
id|tmp
op_assign
id|skb_peek
c_func
(paren
(paren
r_struct
id|sk_buff_head
op_star
)paren
id|tmp
)paren
suffix:semicolon
id|restore_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|tmp
op_eq
id|skb
)paren
op_logical_or
(paren
id|tmp
op_eq
l_int|NULL
)paren
)paren
(brace
multiline_comment|/* reached end of queue */
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;act2000: handle_ack nothing found!&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
)brace
)brace
r_void
DECL|function|actcapi_dispatch
id|actcapi_dispatch
c_func
(paren
id|act2000_card
op_star
id|card
)paren
(brace
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
id|actcapi_msg
op_star
id|msg
suffix:semicolon
id|__u16
id|ccmd
suffix:semicolon
r_int
id|chan
suffix:semicolon
r_int
id|len
suffix:semicolon
id|act2000_chan
op_star
id|ctmp
suffix:semicolon
id|isdn_ctrl
id|cmd
suffix:semicolon
r_char
id|tmp
(braket
l_int|170
)braket
suffix:semicolon
r_while
c_loop
(paren
(paren
id|skb
op_assign
id|skb_dequeue
c_func
(paren
op_amp
id|card-&gt;rcvq
)paren
)paren
)paren
(brace
id|actcapi_debug_msg
c_func
(paren
id|skb
comma
l_int|0
)paren
suffix:semicolon
id|msg
op_assign
(paren
id|actcapi_msg
op_star
)paren
id|skb-&gt;data
suffix:semicolon
id|ccmd
op_assign
(paren
(paren
id|msg-&gt;hdr.cmd.cmd
op_lshift
l_int|8
)paren
op_or
id|msg-&gt;hdr.cmd.subcmd
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|ccmd
)paren
(brace
r_case
l_int|0x8602
suffix:colon
multiline_comment|/* DATA_B3_IND */
r_if
c_cond
(paren
id|actcapi_data_b3_ind
c_func
(paren
id|card
comma
id|skb
)paren
)paren
r_return
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x8601
suffix:colon
multiline_comment|/* DATA_B3_CONF */
id|chan
op_assign
id|find_ncci
c_func
(paren
id|card
comma
id|msg-&gt;msg.data_b3_conf.ncci
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|chan
op_ge
l_int|0
)paren
op_logical_and
(paren
id|card-&gt;bch
(braket
id|chan
)braket
dot
id|fsm_state
op_eq
id|ACT2000_STATE_ACTIVE
)paren
)paren
(brace
r_if
c_cond
(paren
id|msg-&gt;msg.data_b3_conf.info
op_ne
l_int|0
)paren
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;act2000: DATA_B3_CONF: %04x&bslash;n&quot;
comma
id|msg-&gt;msg.data_b3_conf.info
)paren
suffix:semicolon
id|len
op_assign
id|handle_ack
c_func
(paren
id|card
comma
op_amp
id|card-&gt;bch
(braket
id|chan
)braket
comma
id|msg-&gt;msg.data_b3_conf.blocknr
)paren
suffix:semicolon
r_if
c_cond
(paren
id|len
)paren
(brace
id|cmd.driver
op_assign
id|card-&gt;myid
suffix:semicolon
id|cmd.command
op_assign
id|ISDN_STAT_BSENT
suffix:semicolon
id|cmd.arg
op_assign
id|chan
suffix:semicolon
id|cmd.parm.length
op_assign
id|len
suffix:semicolon
id|card-&gt;interface
dot
id|statcallb
c_func
(paren
op_amp
id|cmd
)paren
suffix:semicolon
)brace
)brace
r_break
suffix:semicolon
r_case
l_int|0x0201
suffix:colon
multiline_comment|/* CONNECT_CONF */
id|chan
op_assign
id|find_dialing
c_func
(paren
id|card
comma
id|msg-&gt;hdr.msgnum
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chan
op_ge
l_int|0
)paren
(brace
r_if
c_cond
(paren
id|msg-&gt;msg.connect_conf.info
)paren
(brace
id|card-&gt;bch
(braket
id|chan
)braket
dot
id|fsm_state
op_assign
id|ACT2000_STATE_NULL
suffix:semicolon
id|cmd.driver
op_assign
id|card-&gt;myid
suffix:semicolon
id|cmd.command
op_assign
id|ISDN_STAT_DHUP
suffix:semicolon
id|cmd.arg
op_assign
id|chan
suffix:semicolon
id|card-&gt;interface
dot
id|statcallb
c_func
(paren
op_amp
id|cmd
)paren
suffix:semicolon
)brace
r_else
(brace
id|card-&gt;bch
(braket
id|chan
)braket
dot
id|fsm_state
op_assign
id|ACT2000_STATE_OWAIT
suffix:semicolon
id|card-&gt;bch
(braket
id|chan
)braket
dot
id|plci
op_assign
id|msg-&gt;msg.connect_conf.plci
suffix:semicolon
)brace
)brace
r_break
suffix:semicolon
r_case
l_int|0x0202
suffix:colon
multiline_comment|/* CONNECT_IND */
id|chan
op_assign
id|new_plci
c_func
(paren
id|card
comma
id|msg-&gt;msg.connect_ind.plci
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chan
OL
l_int|0
)paren
(brace
id|ctmp
op_assign
(paren
id|act2000_chan
op_star
)paren
id|tmp
suffix:semicolon
id|ctmp-&gt;plci
op_assign
id|msg-&gt;msg.connect_ind.plci
suffix:semicolon
id|actcapi_connect_resp
c_func
(paren
id|card
comma
id|ctmp
comma
l_int|0x11
)paren
suffix:semicolon
multiline_comment|/* All Card-Cannels busy */
)brace
r_else
(brace
id|card-&gt;bch
(braket
id|chan
)braket
dot
id|fsm_state
op_assign
id|ACT2000_STATE_ICALL
suffix:semicolon
id|cmd.driver
op_assign
id|card-&gt;myid
suffix:semicolon
id|cmd.command
op_assign
id|ISDN_STAT_ICALL
suffix:semicolon
id|cmd.arg
op_assign
id|chan
suffix:semicolon
id|cmd.parm.setup.si1
op_assign
id|msg-&gt;msg.connect_ind.si1
suffix:semicolon
id|cmd.parm.setup.si2
op_assign
id|msg-&gt;msg.connect_ind.si2
suffix:semicolon
r_if
c_cond
(paren
id|card-&gt;ptype
op_eq
id|ISDN_PTYPE_EURO
)paren
id|strcpy
c_func
(paren
id|cmd.parm.setup.eazmsn
comma
id|act2000_find_eaz
c_func
(paren
id|card
comma
id|msg-&gt;msg.connect_ind.eaz
)paren
)paren
suffix:semicolon
r_else
(brace
id|cmd.parm.setup.eazmsn
(braket
l_int|0
)braket
op_assign
id|msg-&gt;msg.connect_ind.eaz
suffix:semicolon
id|cmd.parm.setup.eazmsn
(braket
l_int|1
)braket
op_assign
l_int|0
suffix:semicolon
)brace
id|memset
c_func
(paren
id|cmd.parm.setup.phone
comma
l_int|0
comma
r_sizeof
(paren
id|cmd.parm.setup.phone
)paren
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|cmd.parm.setup.phone
comma
id|msg-&gt;msg.connect_ind.addr.num
comma
id|msg-&gt;msg.connect_ind.addr.len
op_minus
l_int|1
)paren
suffix:semicolon
id|cmd.parm.setup.plan
op_assign
id|msg-&gt;msg.connect_ind.addr.tnp
suffix:semicolon
id|cmd.parm.setup.screen
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|card-&gt;interface
dot
id|statcallb
c_func
(paren
op_amp
id|cmd
)paren
op_eq
l_int|2
)paren
id|actcapi_connect_resp
c_func
(paren
id|card
comma
op_amp
id|card-&gt;bch
(braket
id|chan
)braket
comma
l_int|0x15
)paren
suffix:semicolon
multiline_comment|/* Reject Call */
)brace
r_break
suffix:semicolon
r_case
l_int|0x0302
suffix:colon
multiline_comment|/* CONNECT_ACTIVE_IND */
id|chan
op_assign
id|find_plci
c_func
(paren
id|card
comma
id|msg-&gt;msg.connect_active_ind.plci
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chan
op_ge
l_int|0
)paren
r_switch
c_cond
(paren
id|card-&gt;bch
(braket
id|chan
)braket
dot
id|fsm_state
)paren
(brace
r_case
id|ACT2000_STATE_IWAIT
suffix:colon
id|actcapi_connect_active_resp
c_func
(paren
id|card
comma
op_amp
id|card-&gt;bch
(braket
id|chan
)braket
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ACT2000_STATE_OWAIT
suffix:colon
id|actcapi_connect_active_resp
c_func
(paren
id|card
comma
op_amp
id|card-&gt;bch
(braket
id|chan
)braket
)paren
suffix:semicolon
id|actcapi_select_b2_protocol_req
c_func
(paren
id|card
comma
op_amp
id|card-&gt;bch
(braket
id|chan
)braket
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
l_int|0x8202
suffix:colon
multiline_comment|/* CONNECT_B3_IND */
id|chan
op_assign
id|find_plci
c_func
(paren
id|card
comma
id|msg-&gt;msg.connect_b3_ind.plci
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|chan
op_ge
l_int|0
)paren
op_logical_and
(paren
id|card-&gt;bch
(braket
id|chan
)braket
dot
id|fsm_state
op_eq
id|ACT2000_STATE_IBWAIT
)paren
)paren
(brace
id|card-&gt;bch
(braket
id|chan
)braket
dot
id|ncci
op_assign
id|msg-&gt;msg.connect_b3_ind.ncci
suffix:semicolon
id|actcapi_connect_b3_resp
c_func
(paren
id|card
comma
op_amp
id|card-&gt;bch
(braket
id|chan
)braket
comma
l_int|0
)paren
suffix:semicolon
)brace
r_else
(brace
id|ctmp
op_assign
(paren
id|act2000_chan
op_star
)paren
id|tmp
suffix:semicolon
id|ctmp-&gt;ncci
op_assign
id|msg-&gt;msg.connect_b3_ind.ncci
suffix:semicolon
id|actcapi_connect_b3_resp
c_func
(paren
id|card
comma
id|ctmp
comma
l_int|0x11
)paren
suffix:semicolon
multiline_comment|/* All Card-Cannels busy */
)brace
r_break
suffix:semicolon
r_case
l_int|0x8302
suffix:colon
multiline_comment|/* CONNECT_B3_ACTIVE_IND */
id|chan
op_assign
id|find_ncci
c_func
(paren
id|card
comma
id|msg-&gt;msg.connect_b3_active_ind.ncci
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|chan
op_ge
l_int|0
)paren
op_logical_and
(paren
id|card-&gt;bch
(braket
id|chan
)braket
dot
id|fsm_state
op_eq
id|ACT2000_STATE_BWAIT
)paren
)paren
(brace
id|actcapi_connect_b3_active_resp
c_func
(paren
id|card
comma
op_amp
id|card-&gt;bch
(braket
id|chan
)braket
)paren
suffix:semicolon
id|cmd.driver
op_assign
id|card-&gt;myid
suffix:semicolon
id|cmd.command
op_assign
id|ISDN_STAT_BCONN
suffix:semicolon
id|cmd.arg
op_assign
id|chan
suffix:semicolon
id|card-&gt;interface
dot
id|statcallb
c_func
(paren
op_amp
id|cmd
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
l_int|0x8402
suffix:colon
multiline_comment|/* DISCONNECT_B3_IND */
id|chan
op_assign
id|find_ncci
c_func
(paren
id|card
comma
id|msg-&gt;msg.disconnect_b3_ind.ncci
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chan
op_ge
l_int|0
)paren
(brace
id|ctmp
op_assign
op_amp
id|card-&gt;bch
(braket
id|chan
)braket
suffix:semicolon
id|actcapi_disconnect_b3_resp
c_func
(paren
id|card
comma
id|ctmp
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|ctmp-&gt;fsm_state
)paren
(brace
r_case
id|ACT2000_STATE_ACTIVE
suffix:colon
id|ctmp-&gt;fsm_state
op_assign
id|ACT2000_STATE_DHWAIT2
suffix:semicolon
id|cmd.driver
op_assign
id|card-&gt;myid
suffix:semicolon
id|cmd.command
op_assign
id|ISDN_STAT_BHUP
suffix:semicolon
id|cmd.arg
op_assign
id|chan
suffix:semicolon
id|card-&gt;interface
dot
id|statcallb
c_func
(paren
op_amp
id|cmd
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ACT2000_STATE_BHWAIT2
suffix:colon
id|actcapi_disconnect_req
c_func
(paren
id|card
comma
id|ctmp
)paren
suffix:semicolon
id|ctmp-&gt;fsm_state
op_assign
id|ACT2000_STATE_DHWAIT
suffix:semicolon
id|cmd.driver
op_assign
id|card-&gt;myid
suffix:semicolon
id|cmd.command
op_assign
id|ISDN_STAT_BHUP
suffix:semicolon
id|cmd.arg
op_assign
id|chan
suffix:semicolon
id|card-&gt;interface
dot
id|statcallb
c_func
(paren
op_amp
id|cmd
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
r_break
suffix:semicolon
r_case
l_int|0x0402
suffix:colon
multiline_comment|/* DISCONNECT_IND */
id|chan
op_assign
id|find_plci
c_func
(paren
id|card
comma
id|msg-&gt;msg.disconnect_ind.plci
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chan
op_ge
l_int|0
)paren
(brace
id|ctmp
op_assign
op_amp
id|card-&gt;bch
(braket
id|chan
)braket
suffix:semicolon
id|actcapi_disconnect_resp
c_func
(paren
id|card
comma
id|ctmp
)paren
suffix:semicolon
id|ctmp-&gt;fsm_state
op_assign
id|ACT2000_STATE_NULL
suffix:semicolon
id|cmd.driver
op_assign
id|card-&gt;myid
suffix:semicolon
id|cmd.command
op_assign
id|ISDN_STAT_DHUP
suffix:semicolon
id|cmd.arg
op_assign
id|chan
suffix:semicolon
id|card-&gt;interface
dot
id|statcallb
c_func
(paren
op_amp
id|cmd
)paren
suffix:semicolon
)brace
r_else
(brace
id|ctmp
op_assign
(paren
id|act2000_chan
op_star
)paren
id|tmp
suffix:semicolon
id|ctmp-&gt;plci
op_assign
id|msg-&gt;msg.disconnect_ind.plci
suffix:semicolon
id|actcapi_disconnect_resp
c_func
(paren
id|card
comma
id|ctmp
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
l_int|0x4001
suffix:colon
multiline_comment|/* SELECT_B2_PROTOCOL_CONF */
id|chan
op_assign
id|find_plci
c_func
(paren
id|card
comma
id|msg-&gt;msg.select_b2_protocol_conf.plci
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chan
op_ge
l_int|0
)paren
r_switch
c_cond
(paren
id|card-&gt;bch
(braket
id|chan
)braket
dot
id|fsm_state
)paren
(brace
r_case
id|ACT2000_STATE_ICALL
suffix:colon
r_case
id|ACT2000_STATE_OWAIT
suffix:colon
id|ctmp
op_assign
op_amp
id|card-&gt;bch
(braket
id|chan
)braket
suffix:semicolon
r_if
c_cond
(paren
id|msg-&gt;msg.select_b2_protocol_conf.info
op_eq
l_int|0
)paren
id|actcapi_select_b3_protocol_req
c_func
(paren
id|card
comma
id|ctmp
)paren
suffix:semicolon
r_else
(brace
id|ctmp-&gt;fsm_state
op_assign
id|ACT2000_STATE_NULL
suffix:semicolon
id|cmd.driver
op_assign
id|card-&gt;myid
suffix:semicolon
id|cmd.command
op_assign
id|ISDN_STAT_DHUP
suffix:semicolon
id|cmd.arg
op_assign
id|chan
suffix:semicolon
id|card-&gt;interface
dot
id|statcallb
c_func
(paren
op_amp
id|cmd
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
l_int|0x8001
suffix:colon
multiline_comment|/* SELECT_B3_PROTOCOL_CONF */
id|chan
op_assign
id|find_plci
c_func
(paren
id|card
comma
id|msg-&gt;msg.select_b3_protocol_conf.plci
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chan
op_ge
l_int|0
)paren
r_switch
c_cond
(paren
id|card-&gt;bch
(braket
id|chan
)braket
dot
id|fsm_state
)paren
(brace
r_case
id|ACT2000_STATE_ICALL
suffix:colon
r_case
id|ACT2000_STATE_OWAIT
suffix:colon
id|ctmp
op_assign
op_amp
id|card-&gt;bch
(braket
id|chan
)braket
suffix:semicolon
r_if
c_cond
(paren
id|msg-&gt;msg.select_b3_protocol_conf.info
op_eq
l_int|0
)paren
id|actcapi_listen_b3_req
c_func
(paren
id|card
comma
id|ctmp
)paren
suffix:semicolon
r_else
(brace
id|ctmp-&gt;fsm_state
op_assign
id|ACT2000_STATE_NULL
suffix:semicolon
id|cmd.driver
op_assign
id|card-&gt;myid
suffix:semicolon
id|cmd.command
op_assign
id|ISDN_STAT_DHUP
suffix:semicolon
id|cmd.arg
op_assign
id|chan
suffix:semicolon
id|card-&gt;interface
dot
id|statcallb
c_func
(paren
op_amp
id|cmd
)paren
suffix:semicolon
)brace
)brace
r_break
suffix:semicolon
r_case
l_int|0x8101
suffix:colon
multiline_comment|/* LISTEN_B3_CONF */
id|chan
op_assign
id|find_plci
c_func
(paren
id|card
comma
id|msg-&gt;msg.listen_b3_conf.plci
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chan
op_ge
l_int|0
)paren
r_switch
c_cond
(paren
id|card-&gt;bch
(braket
id|chan
)braket
dot
id|fsm_state
)paren
(brace
r_case
id|ACT2000_STATE_ICALL
suffix:colon
id|ctmp
op_assign
op_amp
id|card-&gt;bch
(braket
id|chan
)braket
suffix:semicolon
r_if
c_cond
(paren
id|msg-&gt;msg.listen_b3_conf.info
op_eq
l_int|0
)paren
id|actcapi_connect_resp
c_func
(paren
id|card
comma
id|ctmp
comma
l_int|0
)paren
suffix:semicolon
r_else
(brace
id|ctmp-&gt;fsm_state
op_assign
id|ACT2000_STATE_NULL
suffix:semicolon
id|cmd.driver
op_assign
id|card-&gt;myid
suffix:semicolon
id|cmd.command
op_assign
id|ISDN_STAT_DHUP
suffix:semicolon
id|cmd.arg
op_assign
id|chan
suffix:semicolon
id|card-&gt;interface
dot
id|statcallb
c_func
(paren
op_amp
id|cmd
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|ACT2000_STATE_OWAIT
suffix:colon
id|ctmp
op_assign
op_amp
id|card-&gt;bch
(braket
id|chan
)braket
suffix:semicolon
r_if
c_cond
(paren
id|msg-&gt;msg.listen_b3_conf.info
op_eq
l_int|0
)paren
(brace
id|actcapi_connect_b3_req
c_func
(paren
id|card
comma
id|ctmp
)paren
suffix:semicolon
id|ctmp-&gt;fsm_state
op_assign
id|ACT2000_STATE_OBWAIT
suffix:semicolon
id|cmd.driver
op_assign
id|card-&gt;myid
suffix:semicolon
id|cmd.command
op_assign
id|ISDN_STAT_DCONN
suffix:semicolon
id|cmd.arg
op_assign
id|chan
suffix:semicolon
id|card-&gt;interface
dot
id|statcallb
c_func
(paren
op_amp
id|cmd
)paren
suffix:semicolon
)brace
r_else
(brace
id|ctmp-&gt;fsm_state
op_assign
id|ACT2000_STATE_NULL
suffix:semicolon
id|cmd.driver
op_assign
id|card-&gt;myid
suffix:semicolon
id|cmd.command
op_assign
id|ISDN_STAT_DHUP
suffix:semicolon
id|cmd.arg
op_assign
id|chan
suffix:semicolon
id|card-&gt;interface
dot
id|statcallb
c_func
(paren
op_amp
id|cmd
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
l_int|0x8201
suffix:colon
multiline_comment|/* CONNECT_B3_CONF */
id|chan
op_assign
id|find_plci
c_func
(paren
id|card
comma
id|msg-&gt;msg.connect_b3_conf.plci
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|chan
op_ge
l_int|0
)paren
op_logical_and
(paren
id|card-&gt;bch
(braket
id|chan
)braket
dot
id|fsm_state
op_eq
id|ACT2000_STATE_OBWAIT
)paren
)paren
(brace
id|ctmp
op_assign
op_amp
id|card-&gt;bch
(braket
id|chan
)braket
suffix:semicolon
r_if
c_cond
(paren
id|msg-&gt;msg.connect_b3_conf.info
)paren
(brace
id|ctmp-&gt;fsm_state
op_assign
id|ACT2000_STATE_NULL
suffix:semicolon
id|cmd.driver
op_assign
id|card-&gt;myid
suffix:semicolon
id|cmd.command
op_assign
id|ISDN_STAT_DHUP
suffix:semicolon
id|cmd.arg
op_assign
id|chan
suffix:semicolon
id|card-&gt;interface
dot
id|statcallb
c_func
(paren
op_amp
id|cmd
)paren
suffix:semicolon
)brace
r_else
(brace
id|ctmp-&gt;ncci
op_assign
id|msg-&gt;msg.connect_b3_conf.ncci
suffix:semicolon
id|ctmp-&gt;fsm_state
op_assign
id|ACT2000_STATE_BWAIT
suffix:semicolon
)brace
)brace
r_break
suffix:semicolon
r_case
l_int|0x8401
suffix:colon
multiline_comment|/* DISCONNECT_B3_CONF */
id|chan
op_assign
id|find_ncci
c_func
(paren
id|card
comma
id|msg-&gt;msg.disconnect_b3_conf.ncci
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|chan
op_ge
l_int|0
)paren
op_logical_and
(paren
id|card-&gt;bch
(braket
id|chan
)braket
dot
id|fsm_state
op_eq
id|ACT2000_STATE_BHWAIT
)paren
)paren
id|card-&gt;bch
(braket
id|chan
)braket
dot
id|fsm_state
op_assign
id|ACT2000_STATE_BHWAIT2
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x0702
suffix:colon
multiline_comment|/* INFO_IND */
id|chan
op_assign
id|find_plci
c_func
(paren
id|card
comma
id|msg-&gt;msg.info_ind.plci
)paren
suffix:semicolon
r_if
c_cond
(paren
id|chan
op_ge
l_int|0
)paren
multiline_comment|/* TODO: Eval Charging info / cause */
id|actcapi_info_resp
c_func
(paren
id|card
comma
op_amp
id|card-&gt;bch
(braket
id|chan
)braket
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0x0401
suffix:colon
multiline_comment|/* LISTEN_CONF */
r_case
l_int|0x0501
suffix:colon
multiline_comment|/* LISTEN_CONF */
r_case
l_int|0xff01
suffix:colon
multiline_comment|/* MANUFACTURER_CONF */
r_break
suffix:semicolon
r_case
l_int|0xff02
suffix:colon
multiline_comment|/* MANUFACTURER_IND */
r_if
c_cond
(paren
id|msg-&gt;msg.manuf_msg
op_eq
l_int|3
)paren
(brace
id|memset
c_func
(paren
id|tmp
comma
l_int|0
comma
r_sizeof
(paren
id|tmp
)paren
)paren
suffix:semicolon
id|strncpy
c_func
(paren
id|tmp
comma
op_amp
id|msg-&gt;msg.manufacturer_ind_err.errstring
comma
id|msg-&gt;hdr.len
op_minus
l_int|16
)paren
suffix:semicolon
r_if
c_cond
(paren
id|msg-&gt;msg.manufacturer_ind_err.errcode
)paren
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;act2000: %s&bslash;n&quot;
comma
id|tmp
)paren
suffix:semicolon
r_else
(brace
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;act2000: %s&bslash;n&quot;
comma
id|tmp
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|tmp
comma
l_string|&quot;INFO: Trace buffer con&quot;
comma
l_int|22
)paren
)paren
op_logical_or
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|tmp
comma
l_string|&quot;INFO: Compile Date/Tim&quot;
comma
l_int|22
)paren
)paren
)paren
(brace
id|card-&gt;flags
op_or_assign
id|ACT2000_FLAGS_RUNNING
suffix:semicolon
id|cmd.command
op_assign
id|ISDN_STAT_RUN
suffix:semicolon
id|cmd.driver
op_assign
id|card-&gt;myid
suffix:semicolon
id|cmd.arg
op_assign
l_int|0
suffix:semicolon
id|actcapi_manufacturer_req_net
c_func
(paren
id|card
)paren
suffix:semicolon
id|actcapi_manufacturer_req_msn
c_func
(paren
id|card
)paren
suffix:semicolon
id|actcapi_listen_req
c_func
(paren
id|card
)paren
suffix:semicolon
id|card-&gt;interface
dot
id|statcallb
c_func
(paren
op_amp
id|cmd
)paren
suffix:semicolon
)brace
)brace
)brace
r_break
suffix:semicolon
r_default
suffix:colon
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;act2000: UNHANDLED Message %04x&bslash;n&quot;
comma
id|ccmd
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|dev_kfree_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
)brace
)brace
macro_line|#ifdef DEBUG_MSG
r_static
r_void
DECL|function|actcapi_debug_caddr
id|actcapi_debug_caddr
c_func
(paren
id|actcapi_addr
op_star
id|addr
)paren
(brace
r_char
id|tmp
(braket
l_int|30
)braket
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; Alen  = %d&bslash;n&quot;
comma
id|addr-&gt;len
)paren
suffix:semicolon
r_if
c_cond
(paren
id|addr-&gt;len
OG
l_int|0
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; Atnp  = 0x%02x&bslash;n&quot;
comma
id|addr-&gt;tnp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|addr-&gt;len
OG
l_int|1
)paren
(brace
id|memset
c_func
(paren
id|tmp
comma
l_int|0
comma
l_int|30
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|tmp
comma
id|addr-&gt;num
comma
id|addr-&gt;len
op_minus
l_int|1
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; Anum  = &squot;%s&squot;&bslash;n&quot;
comma
id|tmp
)paren
suffix:semicolon
)brace
)brace
r_static
r_void
DECL|function|actcapi_debug_ncpi
id|actcapi_debug_ncpi
c_func
(paren
id|actcapi_ncpi
op_star
id|ncpi
)paren
(brace
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; ncpi.len = %d&bslash;n&quot;
comma
id|ncpi-&gt;len
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ncpi-&gt;len
op_ge
l_int|2
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; ncpi.lic = 0x%04x&bslash;n&quot;
comma
id|ncpi-&gt;lic
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ncpi-&gt;len
op_ge
l_int|4
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; ncpi.hic = 0x%04x&bslash;n&quot;
comma
id|ncpi-&gt;hic
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ncpi-&gt;len
op_ge
l_int|6
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; ncpi.ltc = 0x%04x&bslash;n&quot;
comma
id|ncpi-&gt;ltc
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ncpi-&gt;len
op_ge
l_int|8
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; ncpi.htc = 0x%04x&bslash;n&quot;
comma
id|ncpi-&gt;htc
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ncpi-&gt;len
op_ge
l_int|10
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; ncpi.loc = 0x%04x&bslash;n&quot;
comma
id|ncpi-&gt;loc
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ncpi-&gt;len
op_ge
l_int|12
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; ncpi.hoc = 0x%04x&bslash;n&quot;
comma
id|ncpi-&gt;hoc
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ncpi-&gt;len
op_ge
l_int|13
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; ncpi.mod = %d&bslash;n&quot;
comma
id|ncpi-&gt;modulo
)paren
suffix:semicolon
)brace
r_static
r_void
DECL|function|actcapi_debug_dlpd
id|actcapi_debug_dlpd
c_func
(paren
id|actcapi_dlpd
op_star
id|dlpd
)paren
(brace
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; dlpd.len = %d&bslash;n&quot;
comma
id|dlpd-&gt;len
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dlpd-&gt;len
op_ge
l_int|2
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; dlpd.dlen   = 0x%04x&bslash;n&quot;
comma
id|dlpd-&gt;dlen
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dlpd-&gt;len
op_ge
l_int|3
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; dlpd.laa    = 0x%02x&bslash;n&quot;
comma
id|dlpd-&gt;laa
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dlpd-&gt;len
op_ge
l_int|4
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; dlpd.lab    = 0x%02x&bslash;n&quot;
comma
id|dlpd-&gt;lab
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dlpd-&gt;len
op_ge
l_int|5
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; dlpd.modulo = %d&bslash;n&quot;
comma
id|dlpd-&gt;modulo
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dlpd-&gt;len
op_ge
l_int|6
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; dlpd.win    = %d&bslash;n&quot;
comma
id|dlpd-&gt;win
)paren
suffix:semicolon
)brace
macro_line|#ifdef DEBUG_DUMP_SKB
DECL|function|dump_skb
r_static
r_void
id|dump_skb
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
r_char
id|tmp
(braket
l_int|80
)braket
suffix:semicolon
r_char
op_star
id|p
op_assign
id|skb-&gt;data
suffix:semicolon
r_char
op_star
id|t
op_assign
id|tmp
suffix:semicolon
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|skb-&gt;len
suffix:semicolon
id|i
op_increment
)paren
(brace
id|t
op_add_assign
id|sprintf
c_func
(paren
id|t
comma
l_string|&quot;%02x &quot;
comma
op_star
id|p
op_increment
op_amp
l_int|0xff
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|i
op_amp
l_int|0x0f
)paren
op_eq
l_int|8
)paren
(brace
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;dump: %s&bslash;n&quot;
comma
id|tmp
)paren
suffix:semicolon
id|t
op_assign
id|tmp
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|i
op_amp
l_int|0x07
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;dump: %s&bslash;n&quot;
comma
id|tmp
)paren
suffix:semicolon
)brace
macro_line|#endif
r_void
DECL|function|actcapi_debug_msg
id|actcapi_debug_msg
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_int
id|direction
)paren
(brace
id|actcapi_msg
op_star
id|msg
op_assign
(paren
id|actcapi_msg
op_star
)paren
id|skb-&gt;data
suffix:semicolon
r_char
op_star
id|descr
suffix:semicolon
r_int
id|i
suffix:semicolon
r_char
id|tmp
(braket
l_int|170
)braket
suffix:semicolon
macro_line|#ifndef DEBUG_DATA_MSG
r_if
c_cond
(paren
id|msg-&gt;hdr.cmd.cmd
op_eq
l_int|0x86
)paren
r_return
suffix:semicolon
macro_line|#endif
id|descr
op_assign
l_string|&quot;INVALID&quot;
suffix:semicolon
macro_line|#ifdef DEBUG_DUMP_SKB
id|dump_skb
c_func
(paren
id|skb
)paren
suffix:semicolon
macro_line|#endif
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|num_valid_msg
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
(paren
id|msg-&gt;hdr.cmd.cmd
op_eq
id|valid_msg
(braket
id|i
)braket
dot
id|cmd.cmd
)paren
op_logical_and
(paren
id|msg-&gt;hdr.cmd.subcmd
op_eq
id|valid_msg
(braket
id|i
)braket
dot
id|cmd.subcmd
)paren
)paren
(brace
id|descr
op_assign
id|valid_msg
(braket
id|i
)braket
dot
id|description
suffix:semicolon
r_break
suffix:semicolon
)brace
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;%s %s msg&bslash;n&quot;
comma
id|direction
ques
c_cond
l_string|&quot;Outgoing&quot;
suffix:colon
l_string|&quot;Incoming&quot;
comma
id|descr
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; ApplID = %d&bslash;n&quot;
comma
id|msg-&gt;hdr.applicationID
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; Len    = %d&bslash;n&quot;
comma
id|msg-&gt;hdr.len
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; MsgNum = 0x%04x&bslash;n&quot;
comma
id|msg-&gt;hdr.msgnum
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; Cmd    = 0x%02x&bslash;n&quot;
comma
id|msg-&gt;hdr.cmd.cmd
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; SubCmd = 0x%02x&bslash;n&quot;
comma
id|msg-&gt;hdr.cmd.subcmd
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|i
)paren
(brace
r_case
l_int|0
suffix:colon
multiline_comment|/* DATA B3 IND */
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; BLOCK = 0x%02x&bslash;n&quot;
comma
id|msg-&gt;msg.data_b3_ind.blocknr
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
multiline_comment|/* CONNECT CONF */
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; PLCI = 0x%04x&bslash;n&quot;
comma
id|msg-&gt;msg.connect_conf.plci
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; Info = 0x%04x&bslash;n&quot;
comma
id|msg-&gt;msg.connect_conf.info
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|3
suffix:colon
multiline_comment|/* CONNECT IND */
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; PLCI = 0x%04x&bslash;n&quot;
comma
id|msg-&gt;msg.connect_ind.plci
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; Contr = %d&bslash;n&quot;
comma
id|msg-&gt;msg.connect_ind.controller
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; SI1   = %d&bslash;n&quot;
comma
id|msg-&gt;msg.connect_ind.si1
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; SI2   = %d&bslash;n&quot;
comma
id|msg-&gt;msg.connect_ind.si2
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; EAZ   = &squot;%c&squot;&bslash;n&quot;
comma
id|msg-&gt;msg.connect_ind.eaz
)paren
suffix:semicolon
id|actcapi_debug_caddr
c_func
(paren
op_amp
id|msg-&gt;msg.connect_ind.addr
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|5
suffix:colon
multiline_comment|/* CONNECT ACTIVE IND */
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; PLCI = 0x%04x&bslash;n&quot;
comma
id|msg-&gt;msg.connect_active_ind.plci
)paren
suffix:semicolon
id|actcapi_debug_caddr
c_func
(paren
op_amp
id|msg-&gt;msg.connect_active_ind.addr
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|8
suffix:colon
multiline_comment|/* LISTEN CONF */
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; Contr = %d&bslash;n&quot;
comma
id|msg-&gt;msg.listen_conf.controller
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; Info = 0x%04x&bslash;n&quot;
comma
id|msg-&gt;msg.listen_conf.info
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|11
suffix:colon
multiline_comment|/* INFO IND */
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; PLCI = 0x%04x&bslash;n&quot;
comma
id|msg-&gt;msg.info_ind.plci
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; Imsk = 0x%04x&bslash;n&quot;
comma
id|msg-&gt;msg.info_ind.nr.mask
)paren
suffix:semicolon
r_if
c_cond
(paren
id|msg-&gt;hdr.len
OG
l_int|12
)paren
(brace
r_int
id|l
op_assign
id|msg-&gt;hdr.len
op_minus
l_int|12
suffix:semicolon
r_int
id|j
suffix:semicolon
r_char
op_star
id|p
op_assign
id|tmp
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
id|l
suffix:semicolon
id|j
op_increment
)paren
id|p
op_add_assign
id|sprintf
c_func
(paren
id|p
comma
l_string|&quot;%02x &quot;
comma
id|msg-&gt;msg.info_ind.el.display
(braket
id|j
)braket
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; D = &squot;%s&squot;&bslash;n&quot;
comma
id|tmp
)paren
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
l_int|14
suffix:colon
multiline_comment|/* SELECT B2 PROTOCOL CONF */
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; PLCI = 0x%04x&bslash;n&quot;
comma
id|msg-&gt;msg.select_b2_protocol_conf.plci
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; Info = 0x%04x&bslash;n&quot;
comma
id|msg-&gt;msg.select_b2_protocol_conf.info
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|15
suffix:colon
multiline_comment|/* SELECT B3 PROTOCOL CONF */
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; PLCI = 0x%04x&bslash;n&quot;
comma
id|msg-&gt;msg.select_b3_protocol_conf.plci
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; Info = 0x%04x&bslash;n&quot;
comma
id|msg-&gt;msg.select_b3_protocol_conf.info
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|16
suffix:colon
multiline_comment|/* LISTEN B3 CONF */
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; PLCI = 0x%04x&bslash;n&quot;
comma
id|msg-&gt;msg.listen_b3_conf.plci
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; Info = 0x%04x&bslash;n&quot;
comma
id|msg-&gt;msg.listen_b3_conf.info
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|18
suffix:colon
multiline_comment|/* CONNECT B3 IND */
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; NCCI = 0x%04x&bslash;n&quot;
comma
id|msg-&gt;msg.connect_b3_ind.ncci
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; PLCI = 0x%04x&bslash;n&quot;
comma
id|msg-&gt;msg.connect_b3_ind.plci
)paren
suffix:semicolon
id|actcapi_debug_ncpi
c_func
(paren
op_amp
id|msg-&gt;msg.connect_b3_ind.ncpi
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|19
suffix:colon
multiline_comment|/* CONNECT B3 ACTIVE IND */
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; NCCI = 0x%04x&bslash;n&quot;
comma
id|msg-&gt;msg.connect_b3_active_ind.ncci
)paren
suffix:semicolon
id|actcapi_debug_ncpi
c_func
(paren
op_amp
id|msg-&gt;msg.connect_b3_active_ind.ncpi
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|26
suffix:colon
multiline_comment|/* MANUFACTURER IND */
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; Mmsg = 0x%02x&bslash;n&quot;
comma
id|msg-&gt;msg.manufacturer_ind_err.manuf_msg
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|msg-&gt;msg.manufacturer_ind_err.manuf_msg
)paren
(brace
r_case
l_int|3
suffix:colon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; Contr = %d&bslash;n&quot;
comma
id|msg-&gt;msg.manufacturer_ind_err.controller
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; Code = 0x%08x&bslash;n&quot;
comma
id|msg-&gt;msg.manufacturer_ind_err.errcode
)paren
suffix:semicolon
id|memset
c_func
(paren
id|tmp
comma
l_int|0
comma
r_sizeof
(paren
id|tmp
)paren
)paren
suffix:semicolon
id|strncpy
c_func
(paren
id|tmp
comma
op_amp
id|msg-&gt;msg.manufacturer_ind_err.errstring
comma
id|msg-&gt;hdr.len
op_minus
l_int|16
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; Emsg = &squot;%s&squot;&bslash;n&quot;
comma
id|tmp
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
l_int|30
suffix:colon
multiline_comment|/* LISTEN REQ */
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; Imsk = 0x%08x&bslash;n&quot;
comma
id|msg-&gt;msg.listen_req.infomask
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; Emsk = 0x%04x&bslash;n&quot;
comma
id|msg-&gt;msg.listen_req.eazmask
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; Smsk = 0x%04x&bslash;n&quot;
comma
id|msg-&gt;msg.listen_req.simask
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|35
suffix:colon
multiline_comment|/* SELECT_B2_PROTOCOL_REQ */
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; PLCI  = 0x%04x&bslash;n&quot;
comma
id|msg-&gt;msg.select_b2_protocol_req.plci
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; prot  = 0x%02x&bslash;n&quot;
comma
id|msg-&gt;msg.select_b2_protocol_req.protocol
)paren
suffix:semicolon
r_if
c_cond
(paren
id|msg-&gt;hdr.len
op_ge
l_int|11
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;No dlpd&bslash;n&quot;
)paren
suffix:semicolon
r_else
id|actcapi_debug_dlpd
c_func
(paren
op_amp
id|msg-&gt;msg.select_b2_protocol_req.dlpd
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|44
suffix:colon
multiline_comment|/* CONNECT RESP */
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; PLCI  = 0x%04x&bslash;n&quot;
comma
id|msg-&gt;msg.connect_resp.plci
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; CAUSE = 0x%02x&bslash;n&quot;
comma
id|msg-&gt;msg.connect_resp.rejectcause
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|45
suffix:colon
multiline_comment|/* CONNECT ACTIVE RESP */
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot; PLCI  = 0x%04x&bslash;n&quot;
comma
id|msg-&gt;msg.connect_active_resp.plci
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
macro_line|#endif
eof
