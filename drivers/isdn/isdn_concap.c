multiline_comment|/* $Id: isdn_concap.c,v 1.2 1998/01/31 22:49:21 keil Exp $&n; &n; * Stuff to support the concap_proto by isdn4linux. isdn4linux - specific&n; * stuff goes here. Stuff that depends only on the concap protocol goes to&n; * another -- protocol specific -- source file.&n; *&n; * $Log: isdn_concap.c,v $&n; * Revision 1.2  1998/01/31 22:49:21  keil&n; * correct comments&n; *&n; * Revision 1.1  1998/01/31 22:27:57  keil&n; * New files from Henner Eisen for X.25 support&n; *&n; */
macro_line|#include &lt;linux/isdn.h&gt;
macro_line|#include &quot;isdn_x25iface.h&quot;
macro_line|#include &quot;isdn_net.h&quot;
macro_line|#include &lt;linux/concap.h&gt;
macro_line|#include &quot;isdn_concap.h&quot;
multiline_comment|/* The declaration of this (or a plublic variant thereof) should really go&n;   in linux/isdn.h. But we really need it here (and isdn_ppp, like us, also&n;   refers to that private function currently owned by isdn_net.c) */
r_extern
r_int
id|isdn_net_force_dial_lp
c_func
(paren
id|isdn_net_local
op_star
)paren
suffix:semicolon
multiline_comment|/* The following set of device service operations are for encapsulation&n;   protocols that require for reliable datalink sematics. That means:&n;&n;   - before any data is to be submitted the connection must explicitly&n;     be set up.&n;   - after the successful set up of the connection is signalled the&n;     connection is considered to be reliably up.&n;&n;   Auto-dialing ist not compatible with this requirements. Thus, auto-dialing &n;   is completely bypassed.&n;&n;   It might be possible to implement a (non standardized) datalink protocol&n;   that provides a reliable data link service while using some auto dialing&n;   mechanism. Such a protocol would need an auxiliary channel (i.e. user-user-&n;   signaling on the D-channel) while the B-channel is down.&n;   */
DECL|function|isdn_concap_dl_data_req
r_int
id|isdn_concap_dl_data_req
c_func
(paren
r_struct
id|concap_proto
op_star
id|concap
comma
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
r_int
id|tmp
suffix:semicolon
r_struct
id|device
op_star
id|ndev
op_assign
id|concap
op_member_access_from_pointer
id|net_dev
suffix:semicolon
id|isdn_net_local
op_star
id|lp
op_assign
(paren
id|isdn_net_local
op_star
)paren
id|ndev-&gt;priv
suffix:semicolon
id|IX25DEBUG
c_func
(paren
l_string|&quot;isdn_concap_dl_data_req: %s &bslash;n&quot;
comma
id|concap-&gt;net_dev-&gt;name
)paren
suffix:semicolon
id|lp-&gt;huptimer
op_assign
l_int|0
suffix:semicolon
id|tmp
op_assign
id|isdn_net_send_skb
c_func
(paren
id|ndev
comma
id|lp
comma
id|skb
)paren
suffix:semicolon
id|IX25DEBUG
c_func
(paren
l_string|&quot;isdn_concap_dl_data_req: %s : isdn_net_send_skb returned %d&bslash;n&quot;
comma
id|concap
op_member_access_from_pointer
id|net_dev
op_member_access_from_pointer
id|name
comma
id|tmp
)paren
suffix:semicolon
r_return
id|tmp
suffix:semicolon
)brace
DECL|function|isdn_concap_dl_connect_req
r_int
id|isdn_concap_dl_connect_req
c_func
(paren
r_struct
id|concap_proto
op_star
id|concap
)paren
(brace
r_struct
id|device
op_star
id|ndev
op_assign
id|concap
op_member_access_from_pointer
id|net_dev
suffix:semicolon
id|isdn_net_local
op_star
id|lp
op_assign
(paren
id|isdn_net_local
op_star
)paren
id|ndev-&gt;priv
suffix:semicolon
r_int
id|ret
suffix:semicolon
id|IX25DEBUG
c_func
(paren
l_string|&quot;isdn_concap_dl_connect_req: %s &bslash;n&quot;
comma
id|ndev
op_member_access_from_pointer
id|name
)paren
suffix:semicolon
multiline_comment|/* dial ... */
id|ret
op_assign
id|isdn_net_force_dial_lp
c_func
(paren
id|lp
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ret
)paren
id|IX25DEBUG
c_func
(paren
l_string|&quot;dialing failed&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|isdn_concap_dl_disconn_req
r_int
id|isdn_concap_dl_disconn_req
c_func
(paren
r_struct
id|concap_proto
op_star
id|concap
)paren
(brace
id|IX25DEBUG
c_func
(paren
l_string|&quot;isdn_concap_dl_disconn_req: %s &bslash;n&quot;
comma
id|concap
op_member_access_from_pointer
id|net_dev
op_member_access_from_pointer
id|name
)paren
suffix:semicolon
id|isdn_net_hangup
c_func
(paren
id|concap
op_member_access_from_pointer
id|net_dev
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|isdn_concap_reliable_dl_dops
r_struct
id|concap_device_ops
id|isdn_concap_reliable_dl_dops
op_assign
(brace
op_amp
id|isdn_concap_dl_data_req
comma
op_amp
id|isdn_concap_dl_connect_req
comma
op_amp
id|isdn_concap_dl_disconn_req
)brace
suffix:semicolon
DECL|variable|isdn_concap_demand_dial_dops
r_struct
id|concap_device_ops
id|isdn_concap_demand_dial_dops
op_assign
(brace
l_int|NULL
comma
multiline_comment|/* set this first entry to something like &amp;isdn_net_start_xmit,&n;&t;&t; but the entry part of the current isdn_net_start_xmit must be&n;&t;&t; separated first. */
multiline_comment|/* no connection control for demand dial semantics */
l_int|NULL
comma
l_int|NULL
comma
)brace
suffix:semicolon
multiline_comment|/* The following should better go into a dedicated source file such that&n;   this sourcefile does not need to include any protocol specific header&n;   files. For now:&n;   */
DECL|function|isdn_concap_new
r_struct
id|concap_proto
op_star
id|isdn_concap_new
c_func
(paren
r_int
id|encap
)paren
(brace
r_switch
c_cond
(paren
id|encap
)paren
(brace
r_case
id|ISDN_NET_ENCAP_X25IFACE
suffix:colon
r_return
id|isdn_x25iface_proto_new
c_func
(paren
)paren
suffix:semicolon
)brace
r_return
l_int|NULL
suffix:semicolon
)brace
eof
