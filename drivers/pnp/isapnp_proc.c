multiline_comment|/*&n; *  ISA Plug &amp; Play support&n; *  Copyright (c) by Jaroslav Kysela &lt;perex@suse.cz&gt;&n; *&n; *&n; *   This program is free software; you can redistribute it and/or modify&n; *   it under the terms of the GNU General Public License as published by&n; *   the Free Software Foundation; either version 2 of the License, or&n; *   (at your option) any later version.&n; *&n; *   This program is distributed in the hope that it will be useful,&n; *   but WITHOUT ANY WARRANTY; without even the implied warranty of&n; *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; *   GNU General Public License for more details.&n; *&n; *   You should have received a copy of the GNU General Public License&n; *   along with this program; if not, write to the Free Software&n; *   Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.&n; *&n; */
DECL|macro|__NO_VERSION__
mdefine_line|#define __NO_VERSION__
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/proc_fs.h&gt;
macro_line|#include &lt;linux/poll.h&gt;
macro_line|#include &lt;linux/vmalloc.h&gt;
macro_line|#include &lt;asm/uaccess.h&gt;
macro_line|#include &lt;linux/smp_lock.h&gt;
macro_line|#include &lt;linux/isapnp.h&gt;
DECL|struct|isapnp_info_buffer
r_struct
id|isapnp_info_buffer
(brace
DECL|member|buffer
r_char
op_star
id|buffer
suffix:semicolon
multiline_comment|/* pointer to begin of buffer */
DECL|member|curr
r_char
op_star
id|curr
suffix:semicolon
multiline_comment|/* current position in buffer */
DECL|member|size
r_int
r_int
id|size
suffix:semicolon
multiline_comment|/* current size */
DECL|member|len
r_int
r_int
id|len
suffix:semicolon
multiline_comment|/* total length of buffer */
DECL|member|stop
r_int
id|stop
suffix:semicolon
multiline_comment|/* stop flag */
DECL|member|error
r_int
id|error
suffix:semicolon
multiline_comment|/* error code */
)brace
suffix:semicolon
DECL|typedef|isapnp_info_buffer_t
r_typedef
r_struct
id|isapnp_info_buffer
id|isapnp_info_buffer_t
suffix:semicolon
DECL|variable|isapnp_proc_entry
r_static
r_struct
id|proc_dir_entry
op_star
id|isapnp_proc_entry
op_assign
l_int|NULL
suffix:semicolon
DECL|variable|isapnp_proc_bus_dir
r_static
r_struct
id|proc_dir_entry
op_star
id|isapnp_proc_bus_dir
op_assign
l_int|NULL
suffix:semicolon
DECL|variable|isapnp_proc_devices_entry
r_static
r_struct
id|proc_dir_entry
op_star
id|isapnp_proc_devices_entry
op_assign
l_int|NULL
suffix:semicolon
r_static
r_void
id|isapnp_info_read
c_func
(paren
id|isapnp_info_buffer_t
op_star
id|buffer
)paren
suffix:semicolon
r_static
r_void
id|isapnp_info_write
c_func
(paren
id|isapnp_info_buffer_t
op_star
id|buffer
)paren
suffix:semicolon
DECL|function|isapnp_printf
r_int
id|isapnp_printf
c_func
(paren
id|isapnp_info_buffer_t
op_star
id|buffer
comma
r_char
op_star
id|fmt
comma
dot
dot
dot
)paren
(brace
id|va_list
id|args
suffix:semicolon
r_int
id|res
suffix:semicolon
r_char
id|sbuffer
(braket
l_int|512
)braket
suffix:semicolon
r_if
c_cond
(paren
id|buffer-&gt;stop
op_logical_or
id|buffer-&gt;error
)paren
r_return
l_int|0
suffix:semicolon
id|va_start
c_func
(paren
id|args
comma
id|fmt
)paren
suffix:semicolon
id|res
op_assign
id|vsprintf
c_func
(paren
id|sbuffer
comma
id|fmt
comma
id|args
)paren
suffix:semicolon
id|va_end
c_func
(paren
id|args
)paren
suffix:semicolon
r_if
c_cond
(paren
id|buffer-&gt;size
op_plus
id|res
op_ge
id|buffer-&gt;len
)paren
(brace
id|buffer-&gt;stop
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|strcpy
c_func
(paren
id|buffer-&gt;curr
comma
id|sbuffer
)paren
suffix:semicolon
id|buffer-&gt;curr
op_add_assign
id|res
suffix:semicolon
id|buffer-&gt;size
op_add_assign
id|res
suffix:semicolon
r_return
id|res
suffix:semicolon
)brace
DECL|function|isapnp_devid
r_static
r_void
id|isapnp_devid
c_func
(paren
r_char
op_star
id|str
comma
r_int
r_int
id|vendor
comma
r_int
r_int
id|device
)paren
(brace
id|sprintf
c_func
(paren
id|str
comma
l_string|&quot;%c%c%c%x%x%x%x&quot;
comma
l_char|&squot;A&squot;
op_plus
(paren
(paren
id|vendor
op_rshift
l_int|2
)paren
op_amp
l_int|0x3f
)paren
op_minus
l_int|1
comma
l_char|&squot;A&squot;
op_plus
(paren
(paren
(paren
id|vendor
op_amp
l_int|3
)paren
op_lshift
l_int|3
)paren
op_or
(paren
(paren
id|vendor
op_rshift
l_int|13
)paren
op_amp
l_int|7
)paren
)paren
op_minus
l_int|1
comma
l_char|&squot;A&squot;
op_plus
(paren
(paren
id|vendor
op_rshift
l_int|8
)paren
op_amp
l_int|0x1f
)paren
op_minus
l_int|1
comma
(paren
id|device
op_rshift
l_int|4
)paren
op_amp
l_int|0x0f
comma
id|device
op_amp
l_int|0x0f
comma
(paren
id|device
op_rshift
l_int|12
)paren
op_amp
l_int|0x0f
comma
(paren
id|device
op_rshift
l_int|8
)paren
op_amp
l_int|0x0f
)paren
suffix:semicolon
)brace
DECL|function|isapnp_info_entry_lseek
r_static
id|loff_t
id|isapnp_info_entry_lseek
c_func
(paren
r_struct
id|file
op_star
id|file
comma
id|loff_t
id|offset
comma
r_int
id|orig
)paren
(brace
r_switch
c_cond
(paren
id|orig
)paren
(brace
r_case
l_int|0
suffix:colon
multiline_comment|/* SEEK_SET */
id|file-&gt;f_pos
op_assign
id|offset
suffix:semicolon
r_return
id|file-&gt;f_pos
suffix:semicolon
r_case
l_int|1
suffix:colon
multiline_comment|/* SEEK_CUR */
id|file-&gt;f_pos
op_add_assign
id|offset
suffix:semicolon
r_return
id|file-&gt;f_pos
suffix:semicolon
r_case
l_int|2
suffix:colon
multiline_comment|/* SEEK_END */
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_return
op_minus
id|ENXIO
suffix:semicolon
)brace
DECL|function|isapnp_info_entry_read
r_static
id|ssize_t
id|isapnp_info_entry_read
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_char
op_star
id|buffer
comma
r_int
id|count
comma
id|loff_t
op_star
id|offset
)paren
(brace
id|isapnp_info_buffer_t
op_star
id|buf
suffix:semicolon
r_int
id|size
op_assign
l_int|0
comma
id|size1
suffix:semicolon
r_int
id|mode
suffix:semicolon
id|mode
op_assign
id|file-&gt;f_flags
op_amp
id|O_ACCMODE
suffix:semicolon
r_if
c_cond
(paren
id|mode
op_ne
id|O_RDONLY
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|buf
op_assign
(paren
id|isapnp_info_buffer_t
op_star
)paren
id|file-&gt;private_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|buf
)paren
r_return
op_minus
id|EIO
suffix:semicolon
r_if
c_cond
(paren
id|file-&gt;f_pos
op_ge
id|buf-&gt;size
)paren
r_return
l_int|0
suffix:semicolon
id|size
op_assign
id|buf-&gt;size
OL
id|count
ques
c_cond
id|buf-&gt;size
suffix:colon
id|count
suffix:semicolon
id|size1
op_assign
id|buf-&gt;size
op_minus
id|file-&gt;f_pos
suffix:semicolon
r_if
c_cond
(paren
id|size1
OL
id|size
)paren
id|size
op_assign
id|size1
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|buffer
comma
id|buf-&gt;buffer
op_plus
id|file-&gt;f_pos
comma
id|size
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|file-&gt;f_pos
op_add_assign
id|size
suffix:semicolon
r_return
id|size
suffix:semicolon
)brace
DECL|function|isapnp_info_entry_write
r_static
id|ssize_t
id|isapnp_info_entry_write
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_const
r_char
op_star
id|buffer
comma
r_int
id|count
comma
id|loff_t
op_star
id|offset
)paren
(brace
id|isapnp_info_buffer_t
op_star
id|buf
suffix:semicolon
r_int
id|size
op_assign
l_int|0
comma
id|size1
suffix:semicolon
r_int
id|mode
suffix:semicolon
id|mode
op_assign
id|file-&gt;f_flags
op_amp
id|O_ACCMODE
suffix:semicolon
r_if
c_cond
(paren
id|mode
op_ne
id|O_WRONLY
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|buf
op_assign
(paren
id|isapnp_info_buffer_t
op_star
)paren
id|file-&gt;private_data
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|buf
)paren
r_return
op_minus
id|EIO
suffix:semicolon
r_if
c_cond
(paren
id|file-&gt;f_pos
OL
l_int|0
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|file-&gt;f_pos
op_ge
id|buf-&gt;len
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|size
op_assign
id|buf-&gt;len
OL
id|count
ques
c_cond
id|buf-&gt;len
suffix:colon
id|count
suffix:semicolon
id|size1
op_assign
id|buf-&gt;len
op_minus
id|file-&gt;f_pos
suffix:semicolon
r_if
c_cond
(paren
id|size1
OL
id|size
)paren
id|size
op_assign
id|size1
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
c_func
(paren
id|buf-&gt;buffer
op_plus
id|file-&gt;f_pos
comma
id|buffer
comma
id|size
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_if
c_cond
(paren
id|buf-&gt;size
OL
id|file-&gt;f_pos
op_plus
id|size
)paren
id|buf-&gt;size
op_assign
id|file-&gt;f_pos
op_plus
id|size
suffix:semicolon
id|file-&gt;f_pos
op_add_assign
id|size
suffix:semicolon
r_return
id|size
suffix:semicolon
)brace
DECL|function|isapnp_info_entry_open
r_static
r_int
id|isapnp_info_entry_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
id|isapnp_info_buffer_t
op_star
id|buffer
suffix:semicolon
r_int
id|mode
suffix:semicolon
id|mode
op_assign
id|file-&gt;f_flags
op_amp
id|O_ACCMODE
suffix:semicolon
r_if
c_cond
(paren
id|mode
op_ne
id|O_RDONLY
op_logical_and
id|mode
op_ne
id|O_WRONLY
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|buffer
op_assign
(paren
id|isapnp_info_buffer_t
op_star
)paren
id|isapnp_alloc
c_func
(paren
r_sizeof
(paren
id|isapnp_info_buffer_t
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|buffer
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|buffer-&gt;len
op_assign
l_int|4
op_star
id|PAGE_SIZE
suffix:semicolon
id|buffer-&gt;buffer
op_assign
id|vmalloc
c_func
(paren
id|buffer-&gt;len
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|buffer-&gt;buffer
)paren
(brace
id|kfree
c_func
(paren
id|buffer
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|lock_kernel
c_func
(paren
)paren
suffix:semicolon
id|buffer-&gt;curr
op_assign
id|buffer-&gt;buffer
suffix:semicolon
id|file-&gt;private_data
op_assign
id|buffer
suffix:semicolon
r_if
c_cond
(paren
id|mode
op_eq
id|O_RDONLY
)paren
id|isapnp_info_read
c_func
(paren
id|buffer
)paren
suffix:semicolon
id|unlock_kernel
c_func
(paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|isapnp_info_entry_release
r_static
r_int
id|isapnp_info_entry_release
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
id|isapnp_info_buffer_t
op_star
id|buffer
suffix:semicolon
r_int
id|mode
suffix:semicolon
r_if
c_cond
(paren
(paren
id|buffer
op_assign
(paren
id|isapnp_info_buffer_t
op_star
)paren
id|file-&gt;private_data
)paren
op_eq
l_int|NULL
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|mode
op_assign
id|file-&gt;f_flags
op_amp
id|O_ACCMODE
suffix:semicolon
id|lock_kernel
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mode
op_eq
id|O_WRONLY
)paren
id|isapnp_info_write
c_func
(paren
id|buffer
)paren
suffix:semicolon
id|vfree
c_func
(paren
id|buffer-&gt;buffer
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|buffer
)paren
suffix:semicolon
id|unlock_kernel
c_func
(paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|isapnp_info_entry_poll
r_static
r_int
r_int
id|isapnp_info_entry_poll
c_func
(paren
r_struct
id|file
op_star
id|file
comma
id|poll_table
op_star
id|wait
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|file-&gt;private_data
)paren
r_return
l_int|0
suffix:semicolon
r_return
id|POLLIN
op_or
id|POLLRDNORM
suffix:semicolon
)brace
DECL|variable|isapnp_info_entry_operations
r_static
r_struct
id|file_operations
id|isapnp_info_entry_operations
op_assign
(brace
id|llseek
suffix:colon
id|isapnp_info_entry_lseek
comma
id|read
suffix:colon
id|isapnp_info_entry_read
comma
id|write
suffix:colon
id|isapnp_info_entry_write
comma
id|poll
suffix:colon
id|isapnp_info_entry_poll
comma
id|open
suffix:colon
id|isapnp_info_entry_open
comma
id|release
suffix:colon
id|isapnp_info_entry_release
comma
)brace
suffix:semicolon
DECL|function|isapnp_proc_bus_lseek
r_static
id|loff_t
id|isapnp_proc_bus_lseek
c_func
(paren
r_struct
id|file
op_star
id|file
comma
id|loff_t
id|off
comma
r_int
id|whence
)paren
(brace
id|loff_t
r_new
suffix:semicolon
r_switch
c_cond
(paren
id|whence
)paren
(brace
r_case
l_int|0
suffix:colon
r_new
op_assign
id|off
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
r_new
op_assign
id|file-&gt;f_pos
op_plus
id|off
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
r_new
op_assign
l_int|256
op_plus
id|off
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_if
c_cond
(paren
r_new
template_param
l_int|256
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
(paren
id|file-&gt;f_pos
op_assign
r_new
)paren
suffix:semicolon
)brace
DECL|function|isapnp_proc_bus_read
r_static
id|ssize_t
id|isapnp_proc_bus_read
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_char
op_star
id|buf
comma
r_int
id|nbytes
comma
id|loff_t
op_star
id|ppos
)paren
(brace
r_struct
id|inode
op_star
id|ino
op_assign
id|file-&gt;f_dentry-&gt;d_inode
suffix:semicolon
r_struct
id|proc_dir_entry
op_star
id|dp
op_assign
id|ino-&gt;u.generic_ip
suffix:semicolon
r_struct
id|pci_dev
op_star
id|dev
op_assign
id|dp-&gt;data
suffix:semicolon
r_int
id|pos
op_assign
op_star
id|ppos
suffix:semicolon
r_int
id|cnt
comma
id|size
op_assign
l_int|256
suffix:semicolon
r_if
c_cond
(paren
id|pos
op_ge
id|size
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|nbytes
op_ge
id|size
)paren
id|nbytes
op_assign
id|size
suffix:semicolon
r_if
c_cond
(paren
id|pos
op_plus
id|nbytes
OG
id|size
)paren
id|nbytes
op_assign
id|size
op_minus
id|pos
suffix:semicolon
id|cnt
op_assign
id|nbytes
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|access_ok
c_func
(paren
id|VERIFY_WRITE
comma
id|buf
comma
id|cnt
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|isapnp_cfg_begin
c_func
(paren
id|dev-&gt;bus-&gt;number
comma
id|dev-&gt;devfn
)paren
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
id|pos
template_param
l_int|0
suffix:semicolon
id|pos
op_increment
comma
id|buf
op_increment
comma
id|cnt
op_decrement
)paren
(brace
r_int
r_char
id|val
suffix:semicolon
id|val
op_assign
id|isapnp_read_byte
c_func
(paren
id|pos
)paren
suffix:semicolon
id|__put_user
c_func
(paren
id|val
comma
id|buf
)paren
suffix:semicolon
)brace
id|isapnp_cfg_end
c_func
(paren
)paren
suffix:semicolon
op_star
id|ppos
op_assign
id|pos
suffix:semicolon
r_return
id|nbytes
suffix:semicolon
)brace
DECL|variable|isapnp_proc_bus_file_operations
r_static
r_struct
id|file_operations
id|isapnp_proc_bus_file_operations
op_assign
(brace
id|llseek
suffix:colon
id|isapnp_proc_bus_lseek
comma
id|read
suffix:colon
id|isapnp_proc_bus_read
comma
)brace
suffix:semicolon
DECL|function|isapnp_proc_attach_device
r_static
r_int
id|isapnp_proc_attach_device
c_func
(paren
r_struct
id|pci_dev
op_star
id|dev
)paren
(brace
r_struct
id|pci_bus
op_star
id|bus
op_assign
id|dev-&gt;bus
suffix:semicolon
r_struct
id|proc_dir_entry
op_star
id|de
comma
op_star
id|e
suffix:semicolon
r_char
id|name
(braket
l_int|16
)braket
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|de
op_assign
id|bus-&gt;procdir
)paren
)paren
(brace
id|sprintf
c_func
(paren
id|name
comma
l_string|&quot;%02x&quot;
comma
id|bus-&gt;number
)paren
suffix:semicolon
id|de
op_assign
id|bus-&gt;procdir
op_assign
id|proc_mkdir
c_func
(paren
id|name
comma
id|isapnp_proc_bus_dir
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|de
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|sprintf
c_func
(paren
id|name
comma
l_string|&quot;%02x&quot;
comma
id|dev-&gt;devfn
)paren
suffix:semicolon
id|e
op_assign
id|dev-&gt;procent
op_assign
id|create_proc_entry
c_func
(paren
id|name
comma
id|S_IFREG
op_or
id|S_IRUGO
comma
id|de
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|e
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
id|e-&gt;proc_fops
op_assign
op_amp
id|isapnp_proc_bus_file_operations
suffix:semicolon
id|e-&gt;owner
op_assign
id|THIS_MODULE
suffix:semicolon
id|e-&gt;data
op_assign
id|dev
suffix:semicolon
id|e-&gt;size
op_assign
l_int|256
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#ifdef MODULE
DECL|function|isapnp_proc_detach_device
r_static
r_int
id|__exit
id|isapnp_proc_detach_device
c_func
(paren
r_struct
id|pci_dev
op_star
id|dev
)paren
(brace
r_struct
id|pci_bus
op_star
id|bus
op_assign
id|dev-&gt;bus
suffix:semicolon
r_struct
id|proc_dir_entry
op_star
id|de
suffix:semicolon
r_char
id|name
(braket
l_int|16
)braket
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|de
op_assign
id|bus-&gt;procdir
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|sprintf
c_func
(paren
id|name
comma
l_string|&quot;%02x&quot;
comma
id|dev-&gt;devfn
)paren
suffix:semicolon
id|remove_proc_entry
c_func
(paren
id|name
comma
id|de
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|isapnp_proc_detach_bus
r_static
r_int
id|__exit
id|isapnp_proc_detach_bus
c_func
(paren
r_struct
id|pci_bus
op_star
id|bus
)paren
(brace
r_struct
id|proc_dir_entry
op_star
id|de
suffix:semicolon
r_char
id|name
(braket
l_int|16
)braket
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|de
op_assign
id|bus-&gt;procdir
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|sprintf
c_func
(paren
id|name
comma
l_string|&quot;%02x&quot;
comma
id|bus-&gt;number
)paren
suffix:semicolon
id|remove_proc_entry
c_func
(paren
id|name
comma
id|isapnp_proc_bus_dir
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif
DECL|function|isapnp_proc_read_devices
r_static
r_int
id|isapnp_proc_read_devices
c_func
(paren
r_char
op_star
id|buf
comma
r_char
op_star
op_star
id|start
comma
id|off_t
id|pos
comma
r_int
id|count
)paren
(brace
r_struct
id|pci_dev
op_star
id|dev
suffix:semicolon
id|off_t
id|at
op_assign
l_int|0
suffix:semicolon
r_int
id|len
comma
id|cnt
comma
id|i
suffix:semicolon
id|cnt
op_assign
l_int|0
suffix:semicolon
id|isapnp_for_each_dev
c_func
(paren
id|dev
)paren
(brace
r_char
id|bus_id
(braket
l_int|8
)braket
comma
id|device_id
(braket
l_int|8
)braket
suffix:semicolon
id|isapnp_devid
c_func
(paren
id|bus_id
comma
id|dev-&gt;bus-&gt;vendor
comma
id|dev-&gt;bus-&gt;device
)paren
suffix:semicolon
id|isapnp_devid
c_func
(paren
id|device_id
comma
id|dev-&gt;vendor
comma
id|dev-&gt;device
)paren
suffix:semicolon
id|len
op_assign
id|sprintf
c_func
(paren
id|buf
comma
l_string|&quot;%02x%02x&bslash;t%s%s&bslash;t&quot;
comma
id|dev-&gt;bus-&gt;number
comma
id|dev-&gt;devfn
comma
id|bus_id
comma
id|device_id
)paren
suffix:semicolon
id|isapnp_cfg_begin
c_func
(paren
id|dev-&gt;bus-&gt;number
comma
id|dev-&gt;devfn
)paren
suffix:semicolon
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buf
op_plus
id|len
comma
l_string|&quot;%02x&quot;
comma
id|isapnp_read_byte
c_func
(paren
id|ISAPNP_CFG_ACTIVATE
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|8
suffix:semicolon
id|i
op_increment
)paren
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buf
op_plus
id|len
comma
l_string|&quot;%04x&quot;
comma
id|isapnp_read_word
c_func
(paren
id|ISAPNP_CFG_PORT
op_plus
(paren
id|i
op_lshift
l_int|1
)paren
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|2
suffix:semicolon
id|i
op_increment
)paren
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buf
op_plus
id|len
comma
l_string|&quot;%04x&quot;
comma
id|isapnp_read_word
c_func
(paren
id|ISAPNP_CFG_IRQ
op_plus
(paren
id|i
op_lshift
l_int|1
)paren
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|2
suffix:semicolon
id|i
op_increment
)paren
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buf
op_plus
id|len
comma
l_string|&quot;%04x&quot;
comma
id|isapnp_read_word
c_func
(paren
id|ISAPNP_CFG_DMA
op_plus
id|i
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|4
suffix:semicolon
id|i
op_increment
)paren
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buf
op_plus
id|len
comma
l_string|&quot;%08x&quot;
comma
id|isapnp_read_dword
c_func
(paren
id|ISAPNP_CFG_MEM
op_plus
(paren
id|i
op_lshift
l_int|3
)paren
)paren
)paren
suffix:semicolon
id|isapnp_cfg_end
c_func
(paren
)paren
suffix:semicolon
id|buf
(braket
id|len
op_increment
)braket
op_assign
l_char|&squot;&bslash;n&squot;
suffix:semicolon
id|at
op_add_assign
id|len
suffix:semicolon
r_if
c_cond
(paren
id|at
op_ge
id|pos
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
op_star
id|start
)paren
(brace
op_star
id|start
op_assign
id|buf
op_plus
(paren
id|pos
op_minus
(paren
id|at
op_minus
id|len
)paren
)paren
suffix:semicolon
id|cnt
op_assign
id|at
op_minus
id|pos
suffix:semicolon
)brace
r_else
id|cnt
op_add_assign
id|len
suffix:semicolon
id|buf
op_add_assign
id|len
suffix:semicolon
)brace
)brace
r_return
(paren
id|count
OG
id|cnt
)paren
ques
c_cond
id|cnt
suffix:colon
id|count
suffix:semicolon
)brace
DECL|function|isapnp_proc_init
r_int
id|__init
id|isapnp_proc_init
c_func
(paren
r_void
)paren
(brace
r_struct
id|proc_dir_entry
op_star
id|p
suffix:semicolon
r_struct
id|pci_dev
op_star
id|dev
suffix:semicolon
id|isapnp_proc_entry
op_assign
l_int|NULL
suffix:semicolon
id|p
op_assign
id|create_proc_entry
c_func
(paren
l_string|&quot;isapnp&quot;
comma
id|S_IFREG
op_or
id|S_IRUGO
op_or
id|S_IWUSR
comma
op_amp
id|proc_root
)paren
suffix:semicolon
r_if
c_cond
(paren
id|p
)paren
(brace
id|p-&gt;proc_fops
op_assign
op_amp
id|isapnp_info_entry_operations
suffix:semicolon
id|p-&gt;owner
op_assign
id|THIS_MODULE
suffix:semicolon
)brace
id|isapnp_proc_entry
op_assign
id|p
suffix:semicolon
id|isapnp_proc_bus_dir
op_assign
id|proc_mkdir
c_func
(paren
l_string|&quot;isapnp&quot;
comma
id|proc_bus
)paren
suffix:semicolon
id|isapnp_proc_devices_entry
op_assign
id|create_proc_info_entry
c_func
(paren
l_string|&quot;devices&quot;
comma
l_int|0
comma
id|isapnp_proc_bus_dir
comma
id|isapnp_proc_read_devices
)paren
suffix:semicolon
id|isapnp_for_each_dev
c_func
(paren
id|dev
)paren
(brace
id|isapnp_proc_attach_device
c_func
(paren
id|dev
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#ifdef MODULE
DECL|function|isapnp_proc_done
r_int
id|__exit
id|isapnp_proc_done
c_func
(paren
r_void
)paren
(brace
r_struct
id|pci_dev
op_star
id|dev
suffix:semicolon
r_struct
id|pci_bus
op_star
id|card
suffix:semicolon
id|isapnp_for_each_dev
c_func
(paren
id|dev
)paren
(brace
id|isapnp_proc_detach_device
c_func
(paren
id|dev
)paren
suffix:semicolon
)brace
id|isapnp_for_each_card
c_func
(paren
id|card
)paren
(brace
id|isapnp_proc_detach_bus
c_func
(paren
id|card
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|isapnp_proc_devices_entry
)paren
id|remove_proc_entry
c_func
(paren
l_string|&quot;devices&quot;
comma
id|isapnp_proc_devices_entry
)paren
suffix:semicolon
r_if
c_cond
(paren
id|isapnp_proc_bus_dir
)paren
id|remove_proc_entry
c_func
(paren
l_string|&quot;isapnp&quot;
comma
id|proc_bus
)paren
suffix:semicolon
r_if
c_cond
(paren
id|isapnp_proc_entry
)paren
id|remove_proc_entry
c_func
(paren
l_string|&quot;isapnp&quot;
comma
op_amp
id|proc_root
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#endif /* MODULE */
multiline_comment|/*&n; *&n; */
DECL|function|isapnp_print_devid
r_static
r_void
id|isapnp_print_devid
c_func
(paren
id|isapnp_info_buffer_t
op_star
id|buffer
comma
r_int
r_int
id|vendor
comma
r_int
r_int
id|device
)paren
(brace
r_char
id|tmp
(braket
l_int|8
)braket
suffix:semicolon
id|isapnp_devid
c_func
(paren
id|tmp
comma
id|vendor
comma
id|device
)paren
suffix:semicolon
id|isapnp_printf
c_func
(paren
id|buffer
comma
id|tmp
)paren
suffix:semicolon
)brace
DECL|function|isapnp_print_compatible
r_static
r_void
id|isapnp_print_compatible
c_func
(paren
id|isapnp_info_buffer_t
op_star
id|buffer
comma
r_struct
id|pci_dev
op_star
id|dev
)paren
(brace
r_int
id|idx
suffix:semicolon
r_for
c_loop
(paren
id|idx
op_assign
l_int|0
suffix:semicolon
id|idx
OL
id|DEVICE_COUNT_COMPATIBLE
suffix:semicolon
id|idx
op_increment
)paren
(brace
r_if
c_cond
(paren
id|dev-&gt;vendor_compatible
(braket
id|idx
)braket
op_eq
l_int|0
)paren
r_continue
suffix:semicolon
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;    Compatible device &quot;
)paren
suffix:semicolon
id|isapnp_print_devid
c_func
(paren
id|buffer
comma
id|dev-&gt;vendor_compatible
(braket
id|idx
)braket
comma
id|dev-&gt;device_compatible
(braket
id|idx
)braket
)paren
suffix:semicolon
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
)brace
DECL|function|isapnp_print_port
r_static
r_void
id|isapnp_print_port
c_func
(paren
id|isapnp_info_buffer_t
op_star
id|buffer
comma
r_char
op_star
id|space
comma
r_struct
id|isapnp_port
op_star
id|port
)paren
(brace
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;%sPort 0x%x-0x%x, align 0x%x, size 0x%x, %i-bit address decoding&bslash;n&quot;
comma
id|space
comma
id|port-&gt;min
comma
id|port-&gt;max
comma
id|port-&gt;align
ques
c_cond
(paren
id|port-&gt;align
op_minus
l_int|1
)paren
suffix:colon
l_int|0
comma
id|port-&gt;size
comma
id|port-&gt;flags
op_amp
id|ISAPNP_PORT_FLAG_16BITADDR
ques
c_cond
l_int|16
suffix:colon
l_int|10
)paren
suffix:semicolon
)brace
DECL|function|isapnp_print_irq
r_static
r_void
id|isapnp_print_irq
c_func
(paren
id|isapnp_info_buffer_t
op_star
id|buffer
comma
r_char
op_star
id|space
comma
r_struct
id|isapnp_irq
op_star
id|irq
)paren
(brace
r_int
id|first
op_assign
l_int|1
comma
id|i
suffix:semicolon
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;%sIRQ &quot;
comma
id|space
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|16
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|irq-&gt;map
op_amp
(paren
l_int|1
op_lshift
id|i
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|first
)paren
(brace
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;,&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|first
op_assign
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|i
op_eq
l_int|2
op_logical_or
id|i
op_eq
l_int|9
)paren
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;2/9&quot;
)paren
suffix:semicolon
r_else
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;%i&quot;
comma
id|i
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|irq-&gt;map
)paren
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;&lt;none&gt;&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|irq-&gt;flags
op_amp
id|IORESOURCE_IRQ_HIGHEDGE
)paren
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot; High-Edge&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|irq-&gt;flags
op_amp
id|IORESOURCE_IRQ_LOWEDGE
)paren
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot; Low-Edge&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|irq-&gt;flags
op_amp
id|IORESOURCE_IRQ_HIGHLEVEL
)paren
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot; High-Level&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|irq-&gt;flags
op_amp
id|IORESOURCE_IRQ_LOWLEVEL
)paren
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot; Low-Level&quot;
)paren
suffix:semicolon
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
DECL|function|isapnp_print_dma
r_static
r_void
id|isapnp_print_dma
c_func
(paren
id|isapnp_info_buffer_t
op_star
id|buffer
comma
r_char
op_star
id|space
comma
r_struct
id|isapnp_dma
op_star
id|dma
)paren
(brace
r_int
id|first
op_assign
l_int|1
comma
id|i
suffix:semicolon
r_char
op_star
id|s
suffix:semicolon
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;%sDMA &quot;
comma
id|space
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|8
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|dma-&gt;map
op_amp
(paren
l_int|1
op_lshift
id|i
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|first
)paren
(brace
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;,&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|first
op_assign
l_int|0
suffix:semicolon
)brace
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;%i&quot;
comma
id|i
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|dma-&gt;map
)paren
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;&lt;none&gt;&quot;
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|dma-&gt;flags
op_amp
id|IORESOURCE_DMA_TYPE_MASK
)paren
(brace
r_case
id|IORESOURCE_DMA_8BIT
suffix:colon
id|s
op_assign
l_string|&quot;8-bit&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|IORESOURCE_DMA_8AND16BIT
suffix:colon
id|s
op_assign
l_string|&quot;8-bit&amp;16-bit&quot;
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|s
op_assign
l_string|&quot;16-bit&quot;
suffix:semicolon
)brace
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot; %s&quot;
comma
id|s
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dma-&gt;flags
op_amp
id|IORESOURCE_DMA_MASTER
)paren
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot; master&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dma-&gt;flags
op_amp
id|IORESOURCE_DMA_BYTE
)paren
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot; byte-count&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dma-&gt;flags
op_amp
id|IORESOURCE_DMA_WORD
)paren
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot; word-count&quot;
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|dma-&gt;flags
op_amp
id|IORESOURCE_DMA_SPEED_MASK
)paren
(brace
r_case
id|IORESOURCE_DMA_TYPEA
suffix:colon
id|s
op_assign
l_string|&quot;type-A&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|IORESOURCE_DMA_TYPEB
suffix:colon
id|s
op_assign
l_string|&quot;type-B&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|IORESOURCE_DMA_TYPEF
suffix:colon
id|s
op_assign
l_string|&quot;type-F&quot;
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|s
op_assign
l_string|&quot;compatible&quot;
suffix:semicolon
r_break
suffix:semicolon
)brace
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot; %s&bslash;n&quot;
comma
id|s
)paren
suffix:semicolon
)brace
DECL|function|isapnp_print_mem
r_static
r_void
id|isapnp_print_mem
c_func
(paren
id|isapnp_info_buffer_t
op_star
id|buffer
comma
r_char
op_star
id|space
comma
r_struct
id|isapnp_mem
op_star
id|mem
)paren
(brace
r_char
op_star
id|s
suffix:semicolon
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;%sMemory 0x%x-0x%x, align 0x%x, size 0x%x&quot;
comma
id|space
comma
id|mem-&gt;min
comma
id|mem-&gt;max
comma
id|mem-&gt;align
comma
id|mem-&gt;size
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mem-&gt;flags
op_amp
id|IORESOURCE_MEM_WRITEABLE
)paren
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;, writeable&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mem-&gt;flags
op_amp
id|IORESOURCE_MEM_CACHEABLE
)paren
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;, cacheable&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mem-&gt;flags
op_amp
id|IORESOURCE_MEM_RANGELENGTH
)paren
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;, range-length&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mem-&gt;flags
op_amp
id|IORESOURCE_MEM_SHADOWABLE
)paren
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;, shadowable&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mem-&gt;flags
op_amp
id|IORESOURCE_MEM_EXPANSIONROM
)paren
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;, expansion ROM&quot;
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|mem-&gt;flags
op_amp
id|IORESOURCE_MEM_TYPE_MASK
)paren
(brace
r_case
id|IORESOURCE_MEM_8BIT
suffix:colon
id|s
op_assign
l_string|&quot;8-bit&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|IORESOURCE_MEM_8AND16BIT
suffix:colon
id|s
op_assign
l_string|&quot;8-bit&amp;16-bit&quot;
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|s
op_assign
l_string|&quot;16-bit&quot;
suffix:semicolon
)brace
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;, %s&bslash;n&quot;
comma
id|s
)paren
suffix:semicolon
)brace
DECL|function|isapnp_print_mem32
r_static
r_void
id|isapnp_print_mem32
c_func
(paren
id|isapnp_info_buffer_t
op_star
id|buffer
comma
r_char
op_star
id|space
comma
r_struct
id|isapnp_mem32
op_star
id|mem32
)paren
(brace
r_int
id|first
op_assign
l_int|1
comma
id|i
suffix:semicolon
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;%s32-bit memory &quot;
comma
id|space
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|17
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|first
)paren
(brace
id|first
op_assign
l_int|0
suffix:semicolon
)brace
r_else
(brace
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;:&quot;
)paren
suffix:semicolon
)brace
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;%02x&quot;
comma
id|mem32-&gt;data
(braket
id|i
)braket
)paren
suffix:semicolon
)brace
)brace
DECL|function|isapnp_print_resources
r_static
r_void
id|isapnp_print_resources
c_func
(paren
id|isapnp_info_buffer_t
op_star
id|buffer
comma
r_char
op_star
id|space
comma
r_struct
id|isapnp_resources
op_star
id|res
)paren
(brace
r_char
op_star
id|s
suffix:semicolon
r_struct
id|isapnp_port
op_star
id|port
suffix:semicolon
r_struct
id|isapnp_irq
op_star
id|irq
suffix:semicolon
r_struct
id|isapnp_dma
op_star
id|dma
suffix:semicolon
r_struct
id|isapnp_mem
op_star
id|mem
suffix:semicolon
r_struct
id|isapnp_mem32
op_star
id|mem32
suffix:semicolon
r_switch
c_cond
(paren
id|res-&gt;priority
)paren
(brace
r_case
id|ISAPNP_RES_PRIORITY_PREFERRED
suffix:colon
id|s
op_assign
l_string|&quot;preferred&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ISAPNP_RES_PRIORITY_ACCEPTABLE
suffix:colon
id|s
op_assign
l_string|&quot;acceptable&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|ISAPNP_RES_PRIORITY_FUNCTIONAL
suffix:colon
id|s
op_assign
l_string|&quot;functional&quot;
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|s
op_assign
l_string|&quot;invalid&quot;
suffix:semicolon
)brace
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;%sPriority %s&bslash;n&quot;
comma
id|space
comma
id|s
)paren
suffix:semicolon
r_for
c_loop
(paren
id|port
op_assign
id|res-&gt;port
suffix:semicolon
id|port
suffix:semicolon
id|port
op_assign
id|port-&gt;next
)paren
id|isapnp_print_port
c_func
(paren
id|buffer
comma
id|space
comma
id|port
)paren
suffix:semicolon
r_for
c_loop
(paren
id|irq
op_assign
id|res-&gt;irq
suffix:semicolon
id|irq
suffix:semicolon
id|irq
op_assign
id|irq-&gt;next
)paren
id|isapnp_print_irq
c_func
(paren
id|buffer
comma
id|space
comma
id|irq
)paren
suffix:semicolon
r_for
c_loop
(paren
id|dma
op_assign
id|res-&gt;dma
suffix:semicolon
id|dma
suffix:semicolon
id|dma
op_assign
id|dma-&gt;next
)paren
id|isapnp_print_dma
c_func
(paren
id|buffer
comma
id|space
comma
id|dma
)paren
suffix:semicolon
r_for
c_loop
(paren
id|mem
op_assign
id|res-&gt;mem
suffix:semicolon
id|mem
suffix:semicolon
id|mem
op_assign
id|mem-&gt;next
)paren
id|isapnp_print_mem
c_func
(paren
id|buffer
comma
id|space
comma
id|mem
)paren
suffix:semicolon
r_for
c_loop
(paren
id|mem32
op_assign
id|res-&gt;mem32
suffix:semicolon
id|mem32
suffix:semicolon
id|mem32
op_assign
id|mem32-&gt;next
)paren
id|isapnp_print_mem32
c_func
(paren
id|buffer
comma
id|space
comma
id|mem32
)paren
suffix:semicolon
)brace
DECL|function|isapnp_print_configuration
r_static
r_void
id|isapnp_print_configuration
c_func
(paren
id|isapnp_info_buffer_t
op_star
id|buffer
comma
r_struct
id|pci_dev
op_star
id|dev
)paren
(brace
r_int
id|i
comma
id|tmp
comma
id|next
suffix:semicolon
r_char
op_star
id|space
op_assign
l_string|&quot;    &quot;
suffix:semicolon
id|isapnp_cfg_begin
c_func
(paren
id|dev-&gt;bus-&gt;number
comma
id|dev-&gt;devfn
)paren
suffix:semicolon
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;%sDevice is %sactive&bslash;n&quot;
comma
id|space
comma
id|isapnp_read_byte
c_func
(paren
id|ISAPNP_CFG_ACTIVATE
)paren
ques
c_cond
l_string|&quot;&quot;
suffix:colon
l_string|&quot;not &quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
id|next
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|8
suffix:semicolon
id|i
op_increment
)paren
(brace
id|tmp
op_assign
id|isapnp_read_word
c_func
(paren
id|ISAPNP_CFG_PORT
op_plus
(paren
id|i
op_lshift
l_int|1
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|tmp
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|next
)paren
(brace
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;%sActive port &quot;
comma
id|space
)paren
suffix:semicolon
id|next
op_assign
l_int|1
suffix:semicolon
)brace
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;%s0x%x&quot;
comma
id|i
OG
l_int|0
ques
c_cond
l_string|&quot;,&quot;
suffix:colon
l_string|&quot;&quot;
comma
id|tmp
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|next
)paren
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
id|next
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|2
suffix:semicolon
id|i
op_increment
)paren
(brace
id|tmp
op_assign
id|isapnp_read_word
c_func
(paren
id|ISAPNP_CFG_IRQ
op_plus
(paren
id|i
op_lshift
l_int|1
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|tmp
op_rshift
l_int|8
)paren
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|next
)paren
(brace
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;%sActive IRQ &quot;
comma
id|space
)paren
suffix:semicolon
id|next
op_assign
l_int|1
suffix:semicolon
)brace
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;%s%i&quot;
comma
id|i
OG
l_int|0
ques
c_cond
l_string|&quot;,&quot;
suffix:colon
l_string|&quot;&quot;
comma
id|tmp
op_rshift
l_int|8
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tmp
op_amp
l_int|0xff
)paren
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot; [0x%x]&quot;
comma
id|tmp
op_amp
l_int|0xff
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|next
)paren
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
id|next
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|2
suffix:semicolon
id|i
op_increment
)paren
(brace
id|tmp
op_assign
id|isapnp_read_byte
c_func
(paren
id|ISAPNP_CFG_DMA
op_plus
id|i
)paren
suffix:semicolon
r_if
c_cond
(paren
id|tmp
op_eq
l_int|4
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|next
)paren
(brace
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;%sActive DMA &quot;
comma
id|space
)paren
suffix:semicolon
id|next
op_assign
l_int|1
suffix:semicolon
)brace
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;%s%i&quot;
comma
id|i
OG
l_int|0
ques
c_cond
l_string|&quot;,&quot;
suffix:colon
l_string|&quot;&quot;
comma
id|tmp
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|next
)paren
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
id|next
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|4
suffix:semicolon
id|i
op_increment
)paren
(brace
id|tmp
op_assign
id|isapnp_read_dword
c_func
(paren
id|ISAPNP_CFG_MEM
op_plus
(paren
id|i
op_lshift
l_int|3
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|tmp
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|next
)paren
(brace
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;%sActive memory &quot;
comma
id|space
)paren
suffix:semicolon
id|next
op_assign
l_int|1
suffix:semicolon
)brace
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;%s0x%x&quot;
comma
id|i
OG
l_int|0
ques
c_cond
l_string|&quot;,&quot;
suffix:colon
l_string|&quot;&quot;
comma
id|tmp
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|next
)paren
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|isapnp_cfg_end
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|function|isapnp_print_device
r_static
r_void
id|isapnp_print_device
c_func
(paren
id|isapnp_info_buffer_t
op_star
id|buffer
comma
r_struct
id|pci_dev
op_star
id|dev
)paren
(brace
r_int
id|block
comma
id|block1
suffix:semicolon
r_char
op_star
id|space
op_assign
l_string|&quot;    &quot;
suffix:semicolon
r_struct
id|isapnp_resources
op_star
id|res
comma
op_star
id|resa
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dev
)paren
r_return
suffix:semicolon
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;  Logical device %i &squot;&quot;
comma
id|dev-&gt;devfn
)paren
suffix:semicolon
id|isapnp_print_devid
c_func
(paren
id|buffer
comma
id|dev-&gt;vendor
comma
id|dev-&gt;device
)paren
suffix:semicolon
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;:%s&squot;&quot;
comma
id|dev-&gt;name
(braket
l_int|0
)braket
ques
c_cond
id|dev-&gt;name
suffix:colon
l_string|&quot;Unknown&quot;
)paren
suffix:semicolon
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#if 0
id|isapnp_cfg_begin
c_func
(paren
id|dev-&gt;bus-&gt;number
comma
id|dev-&gt;devfn
)paren
suffix:semicolon
r_for
c_loop
(paren
id|block
op_assign
l_int|0
suffix:semicolon
id|block
OL
l_int|128
suffix:semicolon
id|block
op_increment
)paren
r_if
c_cond
(paren
(paren
id|block
op_mod
l_int|16
)paren
op_eq
l_int|15
)paren
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;%02x&bslash;n&quot;
comma
id|isapnp_read_byte
c_func
(paren
id|block
)paren
)paren
suffix:semicolon
r_else
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;%02x:&quot;
comma
id|isapnp_read_byte
c_func
(paren
id|block
)paren
)paren
suffix:semicolon
id|isapnp_cfg_end
c_func
(paren
)paren
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
id|dev-&gt;regs
)paren
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;%sSupported registers 0x%x&bslash;n&quot;
comma
id|space
comma
id|dev-&gt;regs
)paren
suffix:semicolon
id|isapnp_print_compatible
c_func
(paren
id|buffer
comma
id|dev
)paren
suffix:semicolon
id|isapnp_print_configuration
c_func
(paren
id|buffer
comma
id|dev
)paren
suffix:semicolon
r_for
c_loop
(paren
id|res
op_assign
(paren
r_struct
id|isapnp_resources
op_star
)paren
id|dev-&gt;sysdata
comma
id|block
op_assign
l_int|0
suffix:semicolon
id|res
suffix:semicolon
id|res
op_assign
id|res-&gt;next
comma
id|block
op_increment
)paren
(brace
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;%sResources %i&bslash;n&quot;
comma
id|space
comma
id|block
)paren
suffix:semicolon
id|isapnp_print_resources
c_func
(paren
id|buffer
comma
l_string|&quot;      &quot;
comma
id|res
)paren
suffix:semicolon
r_for
c_loop
(paren
id|resa
op_assign
id|res-&gt;alt
comma
id|block1
op_assign
l_int|1
suffix:semicolon
id|resa
suffix:semicolon
id|resa
op_assign
id|resa-&gt;alt
comma
id|block1
op_increment
)paren
(brace
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;%s  Alternate resources %i:%i&bslash;n&quot;
comma
id|space
comma
id|block
comma
id|block1
)paren
suffix:semicolon
id|isapnp_print_resources
c_func
(paren
id|buffer
comma
l_string|&quot;        &quot;
comma
id|resa
)paren
suffix:semicolon
)brace
)brace
)brace
multiline_comment|/*&n; *  Main read routine&n; */
DECL|function|isapnp_info_read
r_static
r_void
id|isapnp_info_read
c_func
(paren
id|isapnp_info_buffer_t
op_star
id|buffer
)paren
(brace
r_struct
id|pci_bus
op_star
id|card
suffix:semicolon
id|isapnp_for_each_card
c_func
(paren
id|card
)paren
(brace
r_struct
id|list_head
op_star
id|dev_list
suffix:semicolon
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;Card %i &squot;&quot;
comma
id|card-&gt;number
)paren
suffix:semicolon
id|isapnp_print_devid
c_func
(paren
id|buffer
comma
id|card-&gt;vendor
comma
id|card-&gt;device
)paren
suffix:semicolon
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;:%s&squot;&quot;
comma
id|card-&gt;name
(braket
l_int|0
)braket
ques
c_cond
id|card-&gt;name
suffix:colon
l_string|&quot;Unknown&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|card-&gt;pnpver
)paren
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot; PnP version %x.%x&quot;
comma
id|card-&gt;pnpver
op_rshift
l_int|4
comma
id|card-&gt;pnpver
op_amp
l_int|0x0f
)paren
suffix:semicolon
r_if
c_cond
(paren
id|card-&gt;productver
)paren
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot; Product version %x.%x&quot;
comma
id|card-&gt;productver
op_rshift
l_int|4
comma
id|card-&gt;productver
op_amp
l_int|0x0f
)paren
suffix:semicolon
id|isapnp_printf
c_func
(paren
id|buffer
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|dev_list
op_assign
id|card-&gt;devices.next
suffix:semicolon
id|dev_list
op_ne
op_amp
id|card-&gt;devices
suffix:semicolon
id|dev_list
op_assign
id|dev_list-&gt;next
)paren
id|isapnp_print_device
c_func
(paren
id|buffer
comma
id|pci_dev_b
c_func
(paren
id|dev_list
)paren
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/*&n; *&n; */
DECL|variable|isapnp_info_card
r_static
r_struct
id|pci_bus
op_star
id|isapnp_info_card
suffix:semicolon
DECL|variable|isapnp_info_device
r_static
r_struct
id|pci_dev
op_star
id|isapnp_info_device
suffix:semicolon
DECL|function|isapnp_get_str
r_static
r_char
op_star
id|isapnp_get_str
c_func
(paren
r_char
op_star
id|dest
comma
r_char
op_star
id|src
comma
r_int
id|len
)paren
(brace
r_int
id|c
suffix:semicolon
r_while
c_loop
(paren
op_star
id|src
op_eq
l_char|&squot; &squot;
op_logical_or
op_star
id|src
op_eq
l_char|&squot;&bslash;t&squot;
)paren
id|src
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_star
id|src
op_eq
l_char|&squot;&quot;&squot;
op_logical_or
op_star
id|src
op_eq
l_char|&squot;&bslash;&squot;&squot;
)paren
(brace
id|c
op_assign
op_star
id|src
op_increment
suffix:semicolon
r_while
c_loop
(paren
op_decrement
id|len
OG
l_int|0
op_logical_and
op_star
id|src
op_logical_and
op_star
id|src
op_ne
id|c
)paren
(brace
op_star
id|dest
op_increment
op_assign
op_star
id|src
op_increment
suffix:semicolon
)brace
r_if
c_cond
(paren
op_star
id|src
op_eq
id|c
)paren
id|src
op_increment
suffix:semicolon
)brace
r_else
(brace
r_while
c_loop
(paren
op_decrement
id|len
OG
l_int|0
op_logical_and
op_star
id|src
op_logical_and
op_star
id|src
op_ne
l_char|&squot; &squot;
op_logical_and
op_star
id|src
op_ne
l_char|&squot;&bslash;t&squot;
)paren
(brace
op_star
id|dest
op_increment
op_assign
op_star
id|src
op_increment
suffix:semicolon
)brace
)brace
op_star
id|dest
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
op_star
id|src
op_eq
l_char|&squot; &squot;
op_logical_or
op_star
id|src
op_eq
l_char|&squot;&bslash;t&squot;
)paren
id|src
op_increment
suffix:semicolon
r_return
id|src
suffix:semicolon
)brace
DECL|function|isapnp_get_hex
r_static
r_int
r_char
id|isapnp_get_hex
c_func
(paren
r_int
r_char
id|c
)paren
(brace
r_if
c_cond
(paren
id|c
op_ge
l_char|&squot;0&squot;
op_logical_and
id|c
op_le
l_char|&squot;9&squot;
)paren
r_return
id|c
op_minus
l_char|&squot;0&squot;
suffix:semicolon
r_if
c_cond
(paren
id|c
op_ge
l_char|&squot;a&squot;
op_logical_and
id|c
op_le
l_char|&squot;f&squot;
)paren
r_return
(paren
id|c
op_minus
l_char|&squot;a&squot;
)paren
op_plus
l_int|10
suffix:semicolon
r_if
c_cond
(paren
id|c
op_ge
l_char|&squot;A&squot;
op_logical_and
id|c
op_le
l_char|&squot;F&squot;
)paren
r_return
(paren
id|c
op_minus
l_char|&squot;A&squot;
)paren
op_plus
l_int|10
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|isapnp_parse_id
r_static
r_int
r_int
id|isapnp_parse_id
c_func
(paren
r_const
r_char
op_star
id|id
)paren
(brace
r_if
c_cond
(paren
id|strlen
c_func
(paren
id|id
)paren
op_ne
l_int|7
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;isapnp: wrong PnP ID&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_return
(paren
id|ISAPNP_VENDOR
c_func
(paren
id|id
(braket
l_int|0
)braket
comma
id|id
(braket
l_int|1
)braket
comma
id|id
(braket
l_int|2
)braket
)paren
op_lshift
l_int|16
)paren
op_or
(paren
id|isapnp_get_hex
c_func
(paren
id|id
(braket
l_int|3
)braket
)paren
op_lshift
l_int|4
)paren
op_or
(paren
id|isapnp_get_hex
c_func
(paren
id|id
(braket
l_int|4
)braket
)paren
op_lshift
l_int|0
)paren
op_or
(paren
id|isapnp_get_hex
c_func
(paren
id|id
(braket
l_int|5
)braket
)paren
op_lshift
l_int|12
)paren
op_or
(paren
id|isapnp_get_hex
c_func
(paren
id|id
(braket
l_int|6
)braket
)paren
op_lshift
l_int|8
)paren
suffix:semicolon
)brace
DECL|function|isapnp_set_card
r_static
r_int
id|isapnp_set_card
c_func
(paren
r_char
op_star
id|line
)paren
(brace
r_int
id|idx
comma
id|idx1
suffix:semicolon
r_int
r_int
id|id
suffix:semicolon
r_char
id|index
(braket
l_int|16
)braket
comma
id|value
(braket
l_int|32
)braket
suffix:semicolon
id|isapnp_info_card
op_assign
l_int|NULL
suffix:semicolon
id|line
op_assign
id|isapnp_get_str
c_func
(paren
id|index
comma
id|line
comma
r_sizeof
(paren
id|index
)paren
)paren
suffix:semicolon
id|isapnp_get_str
c_func
(paren
id|value
comma
id|line
comma
r_sizeof
(paren
id|value
)paren
)paren
suffix:semicolon
id|idx
op_assign
id|idx1
op_assign
id|simple_strtoul
c_func
(paren
id|index
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
id|id
op_assign
id|isapnp_parse_id
c_func
(paren
id|value
)paren
suffix:semicolon
id|isapnp_info_card
op_assign
id|isapnp_find_card
c_func
(paren
id|id
op_rshift
l_int|16
comma
id|id
op_amp
l_int|0xffff
comma
l_int|NULL
)paren
suffix:semicolon
r_while
c_loop
(paren
id|isapnp_info_card
op_logical_and
id|idx1
op_decrement
OG
l_int|0
)paren
id|isapnp_info_card
op_assign
id|isapnp_find_card
c_func
(paren
id|id
op_rshift
l_int|16
comma
id|id
op_amp
l_int|0xffff
comma
id|isapnp_info_card
)paren
suffix:semicolon
r_if
c_cond
(paren
id|isapnp_info_card
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;isapnp: card &squot;%s&squot; order %i not found&bslash;n&quot;
comma
id|value
comma
id|idx
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|isapnp_cfg_begin
c_func
(paren
id|isapnp_info_card-&gt;number
comma
op_minus
l_int|1
)paren
OL
l_int|0
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;isapnp: configuration start sequence for device &squot;%s&squot; failed&bslash;n&quot;
comma
id|value
)paren
suffix:semicolon
id|isapnp_info_card
op_assign
l_int|NULL
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|isapnp_select_csn
r_static
r_int
id|isapnp_select_csn
c_func
(paren
r_char
op_star
id|line
)paren
(brace
r_int
id|csn
suffix:semicolon
r_struct
id|list_head
op_star
id|list
suffix:semicolon
r_char
id|index
(braket
l_int|16
)braket
comma
id|value
(braket
l_int|32
)braket
suffix:semicolon
id|isapnp_info_device
op_assign
l_int|NULL
suffix:semicolon
id|isapnp_get_str
c_func
(paren
id|index
comma
id|line
comma
r_sizeof
(paren
id|index
)paren
)paren
suffix:semicolon
id|csn
op_assign
id|simple_strtoul
c_func
(paren
id|index
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_for
c_loop
(paren
id|list
op_assign
id|isapnp_cards.next
suffix:semicolon
id|list
op_ne
op_amp
id|isapnp_cards
suffix:semicolon
id|list
op_assign
id|list-&gt;next
)paren
(brace
id|isapnp_info_card
op_assign
id|pci_bus_b
c_func
(paren
id|list
)paren
suffix:semicolon
r_if
c_cond
(paren
id|isapnp_info_card-&gt;number
op_eq
id|csn
)paren
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|list
op_eq
op_amp
id|isapnp_cards
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;isapnp: cannot find CSN %i&bslash;n&quot;
comma
id|csn
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|isapnp_cfg_begin
c_func
(paren
id|isapnp_info_card-&gt;number
comma
op_minus
l_int|1
)paren
OL
l_int|0
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;isapnp: configuration start sequence for device &squot;%s&squot; failed&bslash;n&quot;
comma
id|value
)paren
suffix:semicolon
id|isapnp_info_card
op_assign
l_int|NULL
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|isapnp_set_device
r_static
r_int
id|isapnp_set_device
c_func
(paren
r_char
op_star
id|line
)paren
(brace
r_int
id|idx
comma
id|idx1
suffix:semicolon
r_int
r_int
id|id
suffix:semicolon
r_char
id|index
(braket
l_int|16
)braket
comma
id|value
(braket
l_int|32
)braket
suffix:semicolon
id|line
op_assign
id|isapnp_get_str
c_func
(paren
id|index
comma
id|line
comma
r_sizeof
(paren
id|index
)paren
)paren
suffix:semicolon
id|isapnp_get_str
c_func
(paren
id|value
comma
id|line
comma
r_sizeof
(paren
id|value
)paren
)paren
suffix:semicolon
id|idx
op_assign
id|idx1
op_assign
id|simple_strtoul
c_func
(paren
id|index
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
id|id
op_assign
id|isapnp_parse_id
c_func
(paren
id|value
)paren
suffix:semicolon
id|isapnp_info_device
op_assign
id|isapnp_find_dev
c_func
(paren
id|isapnp_info_card
comma
id|id
op_rshift
l_int|16
comma
id|id
op_amp
l_int|0xffff
comma
l_int|NULL
)paren
suffix:semicolon
r_while
c_loop
(paren
id|isapnp_info_device
op_logical_and
id|idx
op_decrement
OG
l_int|0
)paren
id|isapnp_info_device
op_assign
id|isapnp_find_dev
c_func
(paren
id|isapnp_info_card
comma
id|id
op_rshift
l_int|16
comma
id|id
op_amp
l_int|0xffff
comma
id|isapnp_info_device
)paren
suffix:semicolon
r_if
c_cond
(paren
id|isapnp_info_device
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;isapnp: device &squot;%s&squot; order %i not found&bslash;n&quot;
comma
id|value
comma
id|idx
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
id|isapnp_device
c_func
(paren
id|isapnp_info_device-&gt;devfn
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|isapnp_autoconfigure
r_static
r_int
id|isapnp_autoconfigure
c_func
(paren
r_void
)paren
(brace
r_if
c_cond
(paren
id|isapnp_info_device
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;isapnp: device is not set&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|isapnp_info_device-&gt;active
)paren
id|isapnp_info_device
op_member_access_from_pointer
id|deactivate
c_func
(paren
id|isapnp_info_device
)paren
suffix:semicolon
r_if
c_cond
(paren
id|isapnp_info_device
op_member_access_from_pointer
id|prepare
c_func
(paren
id|isapnp_info_device
)paren
OL
l_int|0
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;isapnp: cannot prepare device for the activation&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|isapnp_info_device
op_member_access_from_pointer
id|activate
c_func
(paren
id|isapnp_info_device
)paren
OL
l_int|0
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;isapnp: cannot activate device&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|isapnp_set_port
r_static
r_int
id|isapnp_set_port
c_func
(paren
r_char
op_star
id|line
)paren
(brace
r_int
id|idx
comma
id|port
suffix:semicolon
r_char
id|index
(braket
l_int|16
)braket
comma
id|value
(braket
l_int|32
)braket
suffix:semicolon
id|line
op_assign
id|isapnp_get_str
c_func
(paren
id|index
comma
id|line
comma
r_sizeof
(paren
id|index
)paren
)paren
suffix:semicolon
id|isapnp_get_str
c_func
(paren
id|value
comma
id|line
comma
r_sizeof
(paren
id|value
)paren
)paren
suffix:semicolon
id|idx
op_assign
id|simple_strtoul
c_func
(paren
id|index
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
id|port
op_assign
id|simple_strtoul
c_func
(paren
id|value
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|idx
template_param
l_int|7
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;isapnp: wrong port index %i&bslash;n&quot;
comma
id|idx
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|port
template_param
l_int|0xffff
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;isapnp: wrong port value 0x%x&bslash;n&quot;
comma
id|port
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
id|isapnp_write_word
c_func
(paren
id|ISAPNP_CFG_PORT
op_plus
(paren
id|idx
op_lshift
l_int|1
)paren
comma
id|port
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|isapnp_info_device-&gt;resource
(braket
id|idx
)braket
dot
id|flags
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|isapnp_info_device-&gt;resource
(braket
id|idx
)braket
dot
id|flags
op_amp
id|IORESOURCE_AUTO
)paren
(brace
id|isapnp_info_device-&gt;resource
(braket
id|idx
)braket
dot
id|start
op_assign
id|port
suffix:semicolon
id|isapnp_info_device-&gt;resource
(braket
id|idx
)braket
dot
id|end
op_add_assign
id|port
op_minus
l_int|1
suffix:semicolon
id|isapnp_info_device-&gt;resource
(braket
id|idx
)braket
dot
id|flags
op_and_assign
op_complement
id|IORESOURCE_AUTO
suffix:semicolon
)brace
r_else
(brace
id|isapnp_info_device-&gt;resource
(braket
id|idx
)braket
dot
id|end
op_sub_assign
id|isapnp_info_device-&gt;resource
(braket
id|idx
)braket
dot
id|start
suffix:semicolon
id|isapnp_info_device-&gt;resource
(braket
id|idx
)braket
dot
id|start
op_assign
id|port
suffix:semicolon
id|isapnp_info_device-&gt;resource
(braket
id|idx
)braket
dot
id|end
op_add_assign
id|port
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|isapnp_set_irqresource
r_static
r_void
id|isapnp_set_irqresource
c_func
(paren
r_struct
id|resource
op_star
id|res
comma
r_int
id|irq
)paren
(brace
id|res-&gt;start
op_assign
id|res-&gt;end
op_assign
id|irq
suffix:semicolon
id|res-&gt;flags
op_assign
id|IORESOURCE_IRQ
suffix:semicolon
)brace
DECL|function|isapnp_set_irq
r_static
r_int
id|isapnp_set_irq
c_func
(paren
r_char
op_star
id|line
)paren
(brace
r_int
id|idx
comma
id|irq
suffix:semicolon
r_char
id|index
(braket
l_int|16
)braket
comma
id|value
(braket
l_int|32
)braket
suffix:semicolon
id|line
op_assign
id|isapnp_get_str
c_func
(paren
id|index
comma
id|line
comma
r_sizeof
(paren
id|index
)paren
)paren
suffix:semicolon
id|isapnp_get_str
c_func
(paren
id|value
comma
id|line
comma
r_sizeof
(paren
id|value
)paren
)paren
suffix:semicolon
id|idx
op_assign
id|simple_strtoul
c_func
(paren
id|index
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
id|irq
op_assign
id|simple_strtoul
c_func
(paren
id|value
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|idx
template_param
l_int|1
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;isapnp: wrong IRQ index %i&bslash;n&quot;
comma
id|idx
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|irq
op_eq
l_int|2
)paren
id|irq
op_assign
l_int|9
suffix:semicolon
r_if
c_cond
(paren
id|irq
template_param
l_int|15
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;isapnp: wrong IRQ value %i&bslash;n&quot;
comma
id|irq
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
id|isapnp_write_byte
c_func
(paren
id|ISAPNP_CFG_IRQ
op_plus
(paren
id|idx
op_lshift
l_int|1
)paren
comma
id|irq
)paren
suffix:semicolon
id|isapnp_set_irqresource
c_func
(paren
id|isapnp_info_device-&gt;irq_resource
op_plus
id|idx
comma
id|irq
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|isapnp_set_dmaresource
r_static
r_void
id|isapnp_set_dmaresource
c_func
(paren
r_struct
id|resource
op_star
id|res
comma
r_int
id|dma
)paren
(brace
id|res-&gt;start
op_assign
id|res-&gt;end
op_assign
id|dma
suffix:semicolon
id|res-&gt;flags
op_assign
id|IORESOURCE_DMA
suffix:semicolon
)brace
DECL|function|isapnp_set_dma
r_static
r_int
id|isapnp_set_dma
c_func
(paren
r_char
op_star
id|line
)paren
(brace
r_int
id|idx
comma
id|dma
suffix:semicolon
r_char
id|index
(braket
l_int|16
)braket
comma
id|value
(braket
l_int|32
)braket
suffix:semicolon
id|line
op_assign
id|isapnp_get_str
c_func
(paren
id|index
comma
id|line
comma
r_sizeof
(paren
id|index
)paren
)paren
suffix:semicolon
id|isapnp_get_str
c_func
(paren
id|value
comma
id|line
comma
r_sizeof
(paren
id|value
)paren
)paren
suffix:semicolon
id|idx
op_assign
id|simple_strtoul
c_func
(paren
id|index
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
id|dma
op_assign
id|simple_strtoul
c_func
(paren
id|value
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|idx
template_param
l_int|1
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;isapnp: wrong DMA index %i&bslash;n&quot;
comma
id|idx
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|dma
template_param
l_int|7
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;isapnp: wrong DMA value %i&bslash;n&quot;
comma
id|dma
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
id|isapnp_write_byte
c_func
(paren
id|ISAPNP_CFG_DMA
op_plus
id|idx
comma
id|dma
)paren
suffix:semicolon
id|isapnp_set_dmaresource
c_func
(paren
id|isapnp_info_device-&gt;dma_resource
op_plus
id|idx
comma
id|dma
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|isapnp_set_mem
r_static
r_int
id|isapnp_set_mem
c_func
(paren
r_char
op_star
id|line
)paren
(brace
r_int
id|idx
suffix:semicolon
r_int
r_int
id|mem
suffix:semicolon
r_char
id|index
(braket
l_int|16
)braket
comma
id|value
(braket
l_int|32
)braket
suffix:semicolon
id|line
op_assign
id|isapnp_get_str
c_func
(paren
id|index
comma
id|line
comma
r_sizeof
(paren
id|index
)paren
)paren
suffix:semicolon
id|isapnp_get_str
c_func
(paren
id|value
comma
id|line
comma
r_sizeof
(paren
id|value
)paren
)paren
suffix:semicolon
id|idx
op_assign
id|simple_strtoul
c_func
(paren
id|index
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
id|mem
op_assign
id|simple_strtoul
c_func
(paren
id|value
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|idx
template_param
l_int|3
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;isapnp: wrong memory index %i&bslash;n&quot;
comma
id|idx
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
id|mem
op_rshift_assign
l_int|8
suffix:semicolon
id|isapnp_write_word
c_func
(paren
id|ISAPNP_CFG_MEM
op_plus
(paren
id|idx
op_lshift
l_int|2
)paren
comma
id|mem
op_amp
l_int|0xffff
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|isapnp_info_device-&gt;resource
(braket
id|idx
op_plus
l_int|8
)braket
dot
id|flags
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|isapnp_info_device-&gt;resource
(braket
id|idx
op_plus
l_int|8
)braket
dot
id|flags
op_amp
id|IORESOURCE_AUTO
)paren
(brace
id|isapnp_info_device-&gt;resource
(braket
id|idx
op_plus
l_int|8
)braket
dot
id|start
op_assign
id|mem
op_amp
op_complement
l_int|0x00ffff00
suffix:semicolon
id|isapnp_info_device-&gt;resource
(braket
id|idx
op_plus
l_int|8
)braket
dot
id|end
op_add_assign
(paren
id|mem
op_amp
op_complement
l_int|0x00ffff00
)paren
op_minus
l_int|1
suffix:semicolon
id|isapnp_info_device-&gt;resource
(braket
id|idx
op_plus
l_int|8
)braket
dot
id|flags
op_and_assign
op_complement
id|IORESOURCE_AUTO
suffix:semicolon
)brace
r_else
(brace
id|isapnp_info_device-&gt;resource
(braket
id|idx
op_plus
l_int|8
)braket
dot
id|end
op_sub_assign
id|isapnp_info_device-&gt;resource
(braket
id|idx
op_plus
l_int|8
)braket
dot
id|start
suffix:semicolon
id|isapnp_info_device-&gt;resource
(braket
id|idx
op_plus
l_int|8
)braket
dot
id|start
op_assign
id|mem
op_amp
op_complement
l_int|0x00ffff00
suffix:semicolon
id|isapnp_info_device-&gt;resource
(braket
id|idx
op_plus
l_int|8
)braket
dot
id|end
op_add_assign
id|mem
op_amp
op_complement
l_int|0x00ffff00
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|isapnp_poke
r_static
r_int
id|isapnp_poke
c_func
(paren
r_char
op_star
id|line
comma
r_int
id|what
)paren
(brace
r_int
id|reg
suffix:semicolon
r_int
r_int
id|val
suffix:semicolon
r_char
id|index
(braket
l_int|16
)braket
comma
id|value
(braket
l_int|32
)braket
suffix:semicolon
id|line
op_assign
id|isapnp_get_str
c_func
(paren
id|index
comma
id|line
comma
r_sizeof
(paren
id|index
)paren
)paren
suffix:semicolon
id|isapnp_get_str
c_func
(paren
id|value
comma
id|line
comma
r_sizeof
(paren
id|value
)paren
)paren
suffix:semicolon
id|reg
op_assign
id|simple_strtoul
c_func
(paren
id|index
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
id|val
op_assign
id|simple_strtoul
c_func
(paren
id|value
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|reg
template_param
l_int|127
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;isapnp: wrong register %i&bslash;n&quot;
comma
id|reg
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
r_switch
c_cond
(paren
id|what
)paren
(brace
r_case
l_int|1
suffix:colon
id|isapnp_write_word
c_func
(paren
id|reg
comma
id|val
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|2
suffix:colon
id|isapnp_write_dword
c_func
(paren
id|reg
comma
id|val
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|isapnp_write_byte
c_func
(paren
id|reg
comma
id|val
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|isapnp_decode_line
r_static
r_int
id|isapnp_decode_line
c_func
(paren
r_char
op_star
id|line
)paren
(brace
r_char
id|cmd
(braket
l_int|32
)braket
suffix:semicolon
id|line
op_assign
id|isapnp_get_str
c_func
(paren
id|cmd
comma
id|line
comma
r_sizeof
(paren
id|cmd
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|cmd
comma
l_string|&quot;card&quot;
)paren
)paren
r_return
id|isapnp_set_card
c_func
(paren
id|line
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|cmd
comma
l_string|&quot;csn&quot;
)paren
)paren
r_return
id|isapnp_select_csn
c_func
(paren
id|line
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|isapnp_info_card
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;isapnp: card is not selected&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|cmd
comma
l_string|&quot;dev&quot;
comma
l_int|3
)paren
)paren
r_return
id|isapnp_set_device
c_func
(paren
id|line
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|isapnp_info_device
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;isapnp: device is not selected&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|cmd
comma
l_string|&quot;auto&quot;
comma
l_int|4
)paren
)paren
r_return
id|isapnp_autoconfigure
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|cmd
comma
l_string|&quot;act&quot;
comma
l_int|3
)paren
)paren
(brace
id|isapnp_activate
c_func
(paren
id|isapnp_info_device-&gt;devfn
)paren
suffix:semicolon
id|isapnp_info_device-&gt;active
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|cmd
comma
l_string|&quot;deact&quot;
comma
l_int|5
)paren
)paren
(brace
id|isapnp_deactivate
c_func
(paren
id|isapnp_info_device-&gt;devfn
)paren
suffix:semicolon
id|isapnp_info_device-&gt;active
op_assign
l_int|0
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|cmd
comma
l_string|&quot;port&quot;
)paren
)paren
r_return
id|isapnp_set_port
c_func
(paren
id|line
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|cmd
comma
l_string|&quot;irq&quot;
)paren
)paren
r_return
id|isapnp_set_irq
c_func
(paren
id|line
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|cmd
comma
l_string|&quot;dma&quot;
)paren
)paren
r_return
id|isapnp_set_dma
c_func
(paren
id|line
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|cmd
comma
l_string|&quot;mem&quot;
comma
l_int|3
)paren
)paren
r_return
id|isapnp_set_mem
c_func
(paren
id|line
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|cmd
comma
l_string|&quot;poke&quot;
)paren
)paren
r_return
id|isapnp_poke
c_func
(paren
id|line
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|cmd
comma
l_string|&quot;pokew&quot;
)paren
)paren
r_return
id|isapnp_poke
c_func
(paren
id|line
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|cmd
comma
l_string|&quot;poked&quot;
)paren
)paren
r_return
id|isapnp_poke
c_func
(paren
id|line
comma
l_int|2
)paren
suffix:semicolon
id|printk
c_func
(paren
l_string|&quot;isapnp: wrong command &squot;%s&squot;&bslash;n&quot;
comma
id|cmd
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
multiline_comment|/*&n; *  Main write routine&n; */
DECL|function|isapnp_info_write
r_static
r_void
id|isapnp_info_write
c_func
(paren
id|isapnp_info_buffer_t
op_star
id|buffer
)paren
(brace
r_int
id|c
comma
id|idx
comma
id|idx1
op_assign
l_int|0
suffix:semicolon
r_char
id|line
(braket
l_int|128
)braket
suffix:semicolon
r_if
c_cond
(paren
id|buffer-&gt;size
op_le
l_int|0
)paren
r_return
suffix:semicolon
id|isapnp_info_card
op_assign
l_int|NULL
suffix:semicolon
id|isapnp_info_device
op_assign
l_int|NULL
suffix:semicolon
r_for
c_loop
(paren
id|idx
op_assign
l_int|0
suffix:semicolon
id|idx
OL
id|buffer-&gt;size
suffix:semicolon
id|idx
op_increment
)paren
(brace
id|c
op_assign
id|buffer-&gt;buffer
(braket
id|idx
)braket
suffix:semicolon
r_if
c_cond
(paren
id|c
op_eq
l_char|&squot;&bslash;n&squot;
)paren
(brace
id|line
(braket
id|idx1
)braket
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
r_if
c_cond
(paren
id|line
(braket
l_int|0
)braket
op_ne
l_char|&squot;#&squot;
)paren
(brace
r_if
c_cond
(paren
id|isapnp_decode_line
c_func
(paren
id|line
)paren
)paren
r_goto
id|__end
suffix:semicolon
)brace
id|idx1
op_assign
l_int|0
suffix:semicolon
r_continue
suffix:semicolon
)brace
r_if
c_cond
(paren
id|idx1
op_ge
r_sizeof
(paren
id|line
)paren
op_minus
l_int|1
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;isapnp: line too long, aborting&bslash;n&quot;
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|line
(braket
id|idx1
op_increment
)braket
op_assign
id|c
suffix:semicolon
)brace
id|__end
suffix:colon
r_if
c_cond
(paren
id|isapnp_info_card
)paren
id|isapnp_cfg_end
c_func
(paren
)paren
suffix:semicolon
)brace
eof
