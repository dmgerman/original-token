multiline_comment|/*&n; *  linux/drivers/ide/q40ide.c -- Q40 I/O port IDE Driver&n; *&n; *     (c) Richard Zidlicky&n; *&n; *  This file is subject to the terms and conditions of the GNU General Public&n; *  License.  See the file COPYING in the main directory of this archive for&n; *  more details.&n; *&n; *&n; */
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/mm.h&gt;
macro_line|#include &lt;linux/interrupt.h&gt;
macro_line|#include &lt;linux/blkdev.h&gt;
macro_line|#include &lt;linux/hdreg.h&gt;
macro_line|#include &lt;linux/ide.h&gt;
multiline_comment|/*&n;     *  Bases of the IDE interfaces&n;     */
DECL|macro|Q40IDE_NUM_HWIFS
mdefine_line|#define Q40IDE_NUM_HWIFS&t;2
DECL|macro|PCIDE_BASE1
mdefine_line|#define PCIDE_BASE1&t;0x1f0
DECL|macro|PCIDE_BASE2
mdefine_line|#define PCIDE_BASE2&t;0x170
DECL|macro|PCIDE_BASE3
mdefine_line|#define PCIDE_BASE3&t;0x1e8
DECL|macro|PCIDE_BASE4
mdefine_line|#define PCIDE_BASE4&t;0x168
DECL|macro|PCIDE_BASE5
mdefine_line|#define PCIDE_BASE5&t;0x1e0
DECL|macro|PCIDE_BASE6
mdefine_line|#define PCIDE_BASE6&t;0x160
DECL|variable|pcide_bases
r_static
r_const
id|q40ide_ioreg_t
id|pcide_bases
(braket
id|Q40IDE_NUM_HWIFS
)braket
op_assign
(brace
id|PCIDE_BASE1
comma
id|PCIDE_BASE2
comma
multiline_comment|/* PCIDE_BASE3, PCIDE_BASE4  , PCIDE_BASE5,&n;    PCIDE_BASE6 */
)brace
suffix:semicolon
multiline_comment|/*&n;     *  Offsets from one of the above bases&n;     */
DECL|macro|HD_DATA
macro_line|#undef HD_DATA
DECL|macro|HD_DATA
mdefine_line|#define HD_DATA  0x1f0
DECL|macro|PCIDE_REG
mdefine_line|#define PCIDE_REG(x)&t;((q40ide_ioreg_t)(HD_##x-PCIDE_BASE1))
DECL|variable|pcide_offsets
r_static
r_const
r_int
id|pcide_offsets
(braket
id|IDE_NR_PORTS
)braket
op_assign
(brace
id|PCIDE_REG
c_func
(paren
id|DATA
)paren
comma
id|PCIDE_REG
c_func
(paren
id|ERROR
)paren
comma
id|PCIDE_REG
c_func
(paren
id|NSECTOR
)paren
comma
id|PCIDE_REG
c_func
(paren
id|SECTOR
)paren
comma
id|PCIDE_REG
c_func
(paren
id|LCYL
)paren
comma
id|PCIDE_REG
c_func
(paren
id|HCYL
)paren
comma
id|PCIDE_REG
c_func
(paren
id|CURRENT
)paren
comma
id|PCIDE_REG
c_func
(paren
id|STATUS
)paren
comma
id|PCIDE_REG
c_func
(paren
id|CMD
)paren
)brace
suffix:semicolon
DECL|function|q40ide_default_irq
r_static
r_int
id|q40ide_default_irq
c_func
(paren
id|q40ide_ioreg_t
id|base
)paren
(brace
r_switch
c_cond
(paren
id|base
)paren
(brace
r_case
l_int|0x1f0
suffix:colon
r_return
l_int|14
suffix:semicolon
r_case
l_int|0x170
suffix:colon
r_return
l_int|15
suffix:semicolon
r_case
l_int|0x1e8
suffix:colon
r_return
l_int|11
suffix:semicolon
r_default
suffix:colon
r_return
l_int|0
suffix:semicolon
)brace
)brace
multiline_comment|/*&n;     *  Probe for Q40 IDE interfaces&n;     */
DECL|function|q40ide_init
r_void
id|q40ide_init
c_func
(paren
r_void
)paren
(brace
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|MACH_IS_Q40
)paren
r_return
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|Q40IDE_NUM_HWIFS
suffix:semicolon
id|i
op_increment
)paren
(brace
id|hw_regs_t
id|hw
suffix:semicolon
id|ide_setup_ports
c_func
(paren
op_amp
id|hw
comma
(paren
id|ide_ioreg_t
)paren
id|pcide_bases
(braket
id|i
)braket
comma
(paren
r_int
op_star
)paren
id|pcide_offsets
comma
id|pcide_bases
(braket
id|i
)braket
op_plus
l_int|0x206
comma
l_int|0
comma
l_int|NULL
comma
id|q40ide_default_irq
c_func
(paren
id|pcide_bases
(braket
id|i
)braket
)paren
)paren
suffix:semicolon
id|ide_register_hw
c_func
(paren
op_amp
id|hw
comma
l_int|NULL
)paren
suffix:semicolon
)brace
)brace
eof
