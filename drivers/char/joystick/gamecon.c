multiline_comment|/*&n; * $Id: gamecon.c,v 1.5 2000/06/25 09:56:58 vojtech Exp $&n; *&n; *  Copyright (c) 1999-2000 Vojtech Pavlik&n; *&n; *  Based on the work of:&n; *  &t;Andree Borrmann&t;&t;John Dahlstrom&n; *  &t;David Kuder&n; *&n; *  Sponsored by SuSE&n; */
multiline_comment|/*&n; * NES, SNES, N64, Multi1, Multi2, PSX gamepad driver for Linux&n; */
multiline_comment|/*&n; * This program is free software; you can redistribute it and/or modify&n; * it under the terms of the GNU General Public License as published by&n; * the Free Software Foundation; either version 2 of the License, or &n; * (at your option) any later version.&n; * &n; * This program is distributed in the hope that it will be useful,&n; * but WITHOUT ANY WARRANTY; without even the implied warranty of&n; * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&n; * GNU General Public License for more details.&n; * &n; * You should have received a copy of the GNU General Public License&n; * along with this program; if not, write to the Free Software&n; * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA&n; *&n; * Should you need to contact me, the author, you can do so either by&n; * e-mail - mail your message to &lt;vojtech@suse.cz&gt;, or by paper mail:&n; * Vojtech Pavlik, Ucitelska 1576, Prague 8, 182 00 Czech Republic&n; */
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/parport.h&gt;
macro_line|#include &lt;linux/input.h&gt;
id|MODULE_AUTHOR
c_func
(paren
l_string|&quot;Vojtech Pavlik &lt;vojtech@suse.cz&gt;&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|gc
comma
l_string|&quot;2-6i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|gc_2
comma
l_string|&quot;2-6i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|gc_3
comma
l_string|&quot;2-6i&quot;
)paren
suffix:semicolon
DECL|macro|GC_SNES
mdefine_line|#define GC_SNES&t;&t;1
DECL|macro|GC_NES
mdefine_line|#define GC_NES&t;&t;2
DECL|macro|GC_NES4
mdefine_line|#define GC_NES4&t;&t;3
DECL|macro|GC_MULTI
mdefine_line|#define GC_MULTI&t;4
DECL|macro|GC_MULTI2
mdefine_line|#define GC_MULTI2&t;5
DECL|macro|GC_N64
mdefine_line|#define GC_N64&t;&t;6&t;
DECL|macro|GC_PSX
mdefine_line|#define GC_PSX&t;&t;7
DECL|macro|GC_MAX
mdefine_line|#define GC_MAX&t;&t;7
DECL|macro|GC_REFRESH_TIME
mdefine_line|#define GC_REFRESH_TIME&t;HZ/100
DECL|struct|gc
r_struct
id|gc
(brace
DECL|member|pd
r_struct
id|pardevice
op_star
id|pd
suffix:semicolon
DECL|member|dev
r_struct
id|input_dev
id|dev
(braket
l_int|5
)braket
suffix:semicolon
DECL|member|timer
r_struct
id|timer_list
id|timer
suffix:semicolon
DECL|member|pads
r_int
r_char
id|pads
(braket
id|GC_PSX
op_plus
l_int|1
)braket
suffix:semicolon
DECL|member|used
r_int
id|used
suffix:semicolon
)brace
suffix:semicolon
DECL|variable|gc_base
r_static
r_struct
id|gc
op_star
id|gc_base
(braket
l_int|3
)braket
suffix:semicolon
DECL|variable|__initdata
r_static
r_int
id|gc
(braket
)braket
id|__initdata
op_assign
(brace
op_minus
l_int|1
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
suffix:semicolon
DECL|variable|__initdata
r_static
r_int
id|gc_2
(braket
)braket
id|__initdata
op_assign
(brace
op_minus
l_int|1
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
suffix:semicolon
DECL|variable|__initdata
r_static
r_int
id|gc_3
(braket
)braket
id|__initdata
op_assign
(brace
op_minus
l_int|1
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
suffix:semicolon
DECL|variable|gc_status_bit
r_static
r_int
id|gc_status_bit
(braket
)braket
op_assign
(brace
l_int|0x40
comma
l_int|0x80
comma
l_int|0x20
comma
l_int|0x10
comma
l_int|0x08
)brace
suffix:semicolon
DECL|variable|gc_names
r_static
r_char
op_star
id|gc_names
(braket
)braket
op_assign
(brace
l_int|NULL
comma
l_string|&quot;SNES pad&quot;
comma
l_string|&quot;NES pad&quot;
comma
l_string|&quot;NES FourPort&quot;
comma
l_string|&quot;Multisystem joystick&quot;
comma
l_string|&quot;Multisystem 2-button joystick&quot;
comma
l_string|&quot;N64 controller&quot;
comma
l_string|&quot;PSX pad&quot;
comma
l_string|&quot;PSX NegCon&quot;
comma
l_string|&quot;PSX Analog contoller&quot;
)brace
suffix:semicolon
multiline_comment|/*&n; * N64 support.&n; */
DECL|variable|gc_n64_bytes
r_static
r_int
r_char
id|gc_n64_bytes
(braket
)braket
op_assign
(brace
l_int|0
comma
l_int|1
comma
l_int|13
comma
l_int|15
comma
l_int|14
comma
l_int|12
comma
l_int|10
comma
l_int|11
comma
l_int|2
comma
l_int|3
)brace
suffix:semicolon
DECL|variable|gc_n64_btn
r_static
r_int
id|gc_n64_btn
(braket
)braket
op_assign
(brace
id|BTN_A
comma
id|BTN_B
comma
id|BTN_C
comma
id|BTN_X
comma
id|BTN_Y
comma
id|BTN_Z
comma
id|BTN_TL
comma
id|BTN_TR
comma
id|BTN_TRIGGER
comma
id|BTN_START
)brace
suffix:semicolon
DECL|macro|GC_N64_LENGTH
mdefine_line|#define GC_N64_LENGTH&t;&t;32&t;&t;/* N64 bit length, not including stop bit */
DECL|macro|GC_N64_REQUEST_LENGTH
mdefine_line|#define GC_N64_REQUEST_LENGTH&t;37&t;&t;/* transmit request sequence is 9 bits long */
DECL|macro|GC_N64_DELAY
mdefine_line|#define GC_N64_DELAY&t;&t;133&t;&t;/* delay between transmit request, and response ready (us) */
DECL|macro|GC_N64_REQUEST
mdefine_line|#define GC_N64_REQUEST&t;&t;0x1dd1111111ULL /* the request data command (encoded for 000000011) */
DECL|macro|GC_N64_DWS
mdefine_line|#define GC_N64_DWS&t;&t;3&t;&t;/* delay between write segments (required for sound playback because of ISA DMA) */
multiline_comment|/* GC_N64_DWS &gt; 24 is known to fail */
DECL|macro|GC_N64_POWER_W
mdefine_line|#define GC_N64_POWER_W&t;&t;0xe2&t;&t;/* power during write (transmit request) */
DECL|macro|GC_N64_POWER_R
mdefine_line|#define GC_N64_POWER_R&t;&t;0xfd&t;&t;/* power during read */
DECL|macro|GC_N64_OUT
mdefine_line|#define GC_N64_OUT&t;&t;0x1d&t;&t;/* output bits to the 4 pads */
multiline_comment|/* Reading the main axes of any N64 pad is known to fail if the corresponding bit */
multiline_comment|/* in GC_N64_OUT is pulled low on the output port (by any routine) for more */
multiline_comment|/* than 123 us */
DECL|macro|GC_N64_CLOCK
mdefine_line|#define GC_N64_CLOCK&t;&t;0x02&t;&t;/* clock bits for read */
multiline_comment|/* &n; * gc_n64_read_packet() reads an N64 packet. &n; * Each pad uses one bit per byte. So all pads connected to this port are read in parallel.&n; */
DECL|function|gc_n64_read_packet
r_static
r_void
id|gc_n64_read_packet
c_func
(paren
r_struct
id|gc
op_star
id|gc
comma
r_int
r_char
op_star
id|data
)paren
(brace
r_int
id|i
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
multiline_comment|/*&n; * Request the pad to transmit data&n; */
id|__save_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
id|__cli
c_func
(paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|GC_N64_REQUEST_LENGTH
suffix:semicolon
id|i
op_increment
)paren
(brace
id|parport_write_data
c_func
(paren
id|gc-&gt;pd-&gt;port
comma
id|GC_N64_POWER_W
op_or
(paren
(paren
id|GC_N64_REQUEST
op_rshift
id|i
)paren
op_amp
l_int|1
ques
c_cond
id|GC_N64_OUT
suffix:colon
l_int|0
)paren
)paren
suffix:semicolon
id|udelay
c_func
(paren
id|GC_N64_DWS
)paren
suffix:semicolon
)brace
id|__restore_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
multiline_comment|/*&n; * Wait for the pad response to be loaded into the 33-bit register of the adapter&n; */
id|udelay
c_func
(paren
id|GC_N64_DELAY
)paren
suffix:semicolon
multiline_comment|/*&n; * Grab data (ignoring the last bit, which is a stop bit)&n; */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|GC_N64_LENGTH
suffix:semicolon
id|i
op_increment
)paren
(brace
id|parport_write_data
c_func
(paren
id|gc-&gt;pd-&gt;port
comma
id|GC_N64_POWER_R
)paren
suffix:semicolon
id|data
(braket
id|i
)braket
op_assign
id|parport_read_status
c_func
(paren
id|gc-&gt;pd-&gt;port
)paren
suffix:semicolon
id|parport_write_data
c_func
(paren
id|gc-&gt;pd-&gt;port
comma
id|GC_N64_POWER_R
op_or
id|GC_N64_CLOCK
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * We must wait 200 ms here for the controller to reinitialize before the next read request.&n; * No worries as long as gc_read is polled less frequently than this.&n; */
)brace
multiline_comment|/*&n; * NES/SNES support.&n; */
DECL|macro|GC_NES_DELAY
mdefine_line|#define GC_NES_DELAY&t;6&t;/* Delay between bits - 6us */
DECL|macro|GC_NES_LENGTH
mdefine_line|#define GC_NES_LENGTH&t;8&t;/* The NES pads use 8 bits of data */
DECL|macro|GC_SNES_LENGTH
mdefine_line|#define GC_SNES_LENGTH&t;12&t;/* The SNES true length is 16, but the last 4 bits are unused */
DECL|macro|GC_NES_POWER
mdefine_line|#define GC_NES_POWER&t;0xfc
DECL|macro|GC_NES_CLOCK
mdefine_line|#define GC_NES_CLOCK&t;0x01
DECL|macro|GC_NES_LATCH
mdefine_line|#define GC_NES_LATCH&t;0x02
DECL|variable|gc_nes_bytes
r_static
r_int
r_char
id|gc_nes_bytes
(braket
)braket
op_assign
(brace
l_int|0
comma
l_int|1
comma
l_int|2
comma
l_int|3
)brace
suffix:semicolon
DECL|variable|gc_snes_bytes
r_static
r_int
r_char
id|gc_snes_bytes
(braket
)braket
op_assign
(brace
l_int|8
comma
l_int|0
comma
l_int|2
comma
l_int|3
comma
l_int|9
comma
l_int|1
comma
l_int|10
comma
l_int|11
)brace
suffix:semicolon
DECL|variable|gc_snes_btn
r_static
r_int
id|gc_snes_btn
(braket
)braket
op_assign
(brace
id|BTN_A
comma
id|BTN_B
comma
id|BTN_SELECT
comma
id|BTN_START
comma
id|BTN_X
comma
id|BTN_Y
comma
id|BTN_TL
comma
id|BTN_TR
)brace
suffix:semicolon
multiline_comment|/*&n; * gc_nes_read_packet() reads a NES/SNES packet.&n; * Each pad uses one bit per byte. So all pads connected to&n; * this port are read in parallel.&n; */
DECL|function|gc_nes_read_packet
r_static
r_void
id|gc_nes_read_packet
c_func
(paren
r_struct
id|gc
op_star
id|gc
comma
r_int
id|length
comma
r_int
r_char
op_star
id|data
)paren
(brace
r_int
id|i
suffix:semicolon
id|parport_write_data
c_func
(paren
id|gc-&gt;pd-&gt;port
comma
id|GC_NES_POWER
op_or
id|GC_NES_CLOCK
op_or
id|GC_NES_LATCH
)paren
suffix:semicolon
id|udelay
c_func
(paren
id|GC_NES_DELAY
op_star
l_int|2
)paren
suffix:semicolon
id|parport_write_data
c_func
(paren
id|gc-&gt;pd-&gt;port
comma
id|GC_NES_POWER
op_or
id|GC_NES_CLOCK
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|length
suffix:semicolon
id|i
op_increment
)paren
(brace
id|udelay
c_func
(paren
id|GC_NES_DELAY
)paren
suffix:semicolon
id|parport_write_data
c_func
(paren
id|gc-&gt;pd-&gt;port
comma
id|GC_NES_POWER
)paren
suffix:semicolon
id|data
(braket
id|i
)braket
op_assign
id|parport_read_status
c_func
(paren
id|gc-&gt;pd-&gt;port
)paren
op_xor
l_int|0x7f
suffix:semicolon
id|udelay
c_func
(paren
id|GC_NES_DELAY
)paren
suffix:semicolon
id|parport_write_data
c_func
(paren
id|gc-&gt;pd-&gt;port
comma
id|GC_NES_POWER
op_or
id|GC_NES_CLOCK
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/*&n; * Multisystem joystick support&n; */
DECL|macro|GC_MULTI_LENGTH
mdefine_line|#define GC_MULTI_LENGTH&t;&t;5&t;/* Multi system joystick packet length is 5 */
DECL|macro|GC_MULTI2_LENGTH
mdefine_line|#define GC_MULTI2_LENGTH&t;6&t;/* One more bit for one more button */
multiline_comment|/*&n; * gc_multi_read_packet() reads a Multisystem joystick packet.&n; */
DECL|function|gc_multi_read_packet
r_static
r_void
id|gc_multi_read_packet
c_func
(paren
r_struct
id|gc
op_star
id|gc
comma
r_int
id|length
comma
r_int
r_char
op_star
id|data
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|length
suffix:semicolon
id|i
op_increment
)paren
(brace
id|parport_write_data
c_func
(paren
id|gc-&gt;pd-&gt;port
comma
op_complement
(paren
l_int|1
op_lshift
id|i
)paren
)paren
suffix:semicolon
id|data
(braket
id|i
)braket
op_assign
id|parport_read_status
c_func
(paren
id|gc-&gt;pd-&gt;port
)paren
op_xor
l_int|0x7f
suffix:semicolon
)brace
)brace
multiline_comment|/*&n; * PSX support&n; */
DECL|macro|GC_PSX_DELAY
mdefine_line|#define GC_PSX_DELAY&t;10
DECL|macro|GC_PSX_LENGTH
mdefine_line|#define GC_PSX_LENGTH&t;8&t;/* talk to the controller in bytes */
DECL|macro|GC_PSX_MOUSE
mdefine_line|#define GC_PSX_MOUSE&t;0x12&t;/* PSX Mouse */
DECL|macro|GC_PSX_NEGCON
mdefine_line|#define GC_PSX_NEGCON&t;0x23&t;/* NegCon pad */
DECL|macro|GC_PSX_NORMAL
mdefine_line|#define GC_PSX_NORMAL&t;0x41&t;/* Standard Digital controller */
DECL|macro|GC_PSX_ANALOGR
mdefine_line|#define GC_PSX_ANALOGR&t;0x73&t;/* Analog controller in Red mode */
DECL|macro|GC_PSX_ANALOGG
mdefine_line|#define GC_PSX_ANALOGG&t;0x53&t;/* Analog controller in Green mode */
DECL|macro|GC_PSX_CLOCK
mdefine_line|#define GC_PSX_CLOCK&t;0x04&t;/* Pin 3 */
DECL|macro|GC_PSX_COMMAND
mdefine_line|#define GC_PSX_COMMAND&t;0x01&t;/* Pin 1 */
DECL|macro|GC_PSX_POWER
mdefine_line|#define GC_PSX_POWER&t;0xf8&t;/* Pins 5-9 */
DECL|macro|GC_PSX_SELECT
mdefine_line|#define GC_PSX_SELECT&t;0x02&t;/* Pin 2 */
DECL|macro|GC_PSX_NOPOWER
mdefine_line|#define GC_PSX_NOPOWER  0x04
DECL|variable|gc_psx_abs
r_static
r_int
id|gc_psx_abs
(braket
)braket
op_assign
(brace
id|ABS_X
comma
id|ABS_Y
comma
id|ABS_RX
comma
id|ABS_RY
comma
id|ABS_HAT0X
comma
id|ABS_HAT0Y
)brace
suffix:semicolon
DECL|variable|gc_psx_btn
r_static
r_int
id|gc_psx_btn
(braket
)braket
op_assign
(brace
id|BTN_TL
comma
id|BTN_TR
comma
id|BTN_TL2
comma
id|BTN_TR2
comma
id|BTN_A
comma
id|BTN_B
comma
id|BTN_X
comma
id|BTN_Y
comma
id|BTN_START
comma
id|BTN_SELECT
comma
id|BTN_THUMB
comma
id|BTN_THUMB2
)brace
suffix:semicolon
multiline_comment|/*&n; * gc_psx_command() writes 8bit command and reads 8bit data from&n; * the psx pad.&n; */
DECL|function|gc_psx_command
r_static
r_int
id|gc_psx_command
c_func
(paren
r_struct
id|gc
op_star
id|gc
comma
r_int
id|b
)paren
(brace
r_int
id|i
comma
id|cmd
comma
id|ret
op_assign
l_int|0
suffix:semicolon
id|cmd
op_assign
(paren
id|b
op_amp
l_int|1
)paren
ques
c_cond
id|GC_PSX_COMMAND
suffix:colon
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|8
suffix:semicolon
id|i
op_increment
)paren
(brace
id|parport_write_data
c_func
(paren
id|gc-&gt;pd-&gt;port
comma
id|cmd
op_or
id|GC_PSX_POWER
)paren
suffix:semicolon
id|udelay
c_func
(paren
id|GC_PSX_DELAY
)paren
suffix:semicolon
id|ret
op_or_assign
(paren
(paren
id|parport_read_status
c_func
(paren
id|gc-&gt;pd-&gt;port
)paren
op_xor
l_int|0x80
)paren
op_amp
id|gc-&gt;pads
(braket
id|GC_PSX
)braket
)paren
ques
c_cond
(paren
l_int|1
op_lshift
id|i
)paren
suffix:colon
l_int|0
suffix:semicolon
id|cmd
op_assign
(paren
id|b
op_amp
l_int|1
)paren
ques
c_cond
id|GC_PSX_COMMAND
suffix:colon
l_int|0
suffix:semicolon
id|parport_write_data
c_func
(paren
id|gc-&gt;pd-&gt;port
comma
id|cmd
op_or
id|GC_PSX_CLOCK
op_or
id|GC_PSX_POWER
)paren
suffix:semicolon
id|udelay
c_func
(paren
id|GC_PSX_DELAY
)paren
suffix:semicolon
id|b
op_rshift_assign
l_int|1
suffix:semicolon
)brace
r_return
id|ret
suffix:semicolon
)brace
multiline_comment|/*&n; * gc_psx_read_packet() reads a whole psx packet and returns&n; * device identifier code.&n; */
DECL|function|gc_psx_read_packet
r_static
r_int
id|gc_psx_read_packet
c_func
(paren
r_struct
id|gc
op_star
id|gc
comma
r_int
id|length
comma
r_int
r_char
op_star
id|data
)paren
(brace
r_int
id|i
comma
id|ret
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
id|__save_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
id|__cli
c_func
(paren
)paren
suffix:semicolon
id|parport_write_data
c_func
(paren
id|gc-&gt;pd-&gt;port
comma
id|GC_PSX_POWER
)paren
suffix:semicolon
id|parport_write_data
c_func
(paren
id|gc-&gt;pd-&gt;port
comma
id|GC_PSX_CLOCK
op_or
id|GC_PSX_SELECT
op_or
id|GC_PSX_POWER
)paren
suffix:semicolon
multiline_comment|/* Select pad */
id|udelay
c_func
(paren
id|GC_PSX_DELAY
op_star
l_int|2
)paren
suffix:semicolon
id|gc_psx_command
c_func
(paren
id|gc
comma
l_int|0x01
)paren
suffix:semicolon
multiline_comment|/* Access pad */
id|ret
op_assign
id|gc_psx_command
c_func
(paren
id|gc
comma
l_int|0x42
)paren
suffix:semicolon
multiline_comment|/* Get device id */
r_if
c_cond
(paren
id|gc_psx_command
c_func
(paren
id|gc
comma
l_int|0
)paren
op_eq
l_char|&squot;Z&squot;
)paren
multiline_comment|/* okay? */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|length
suffix:semicolon
id|i
op_increment
)paren
id|data
(braket
id|i
)braket
op_assign
id|gc_psx_command
c_func
(paren
id|gc
comma
l_int|0
)paren
suffix:semicolon
r_else
id|ret
op_assign
op_minus
l_int|1
suffix:semicolon
id|parport_write_data
c_func
(paren
id|gc-&gt;pd-&gt;port
comma
id|GC_PSX_SELECT
op_or
id|GC_PSX_CLOCK
op_or
id|GC_PSX_POWER
)paren
suffix:semicolon
id|__restore_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
multiline_comment|/*&n; * gc_timer() reads and analyzes console pads data.&n; */
DECL|macro|GC_MAX_LENGTH
mdefine_line|#define GC_MAX_LENGTH GC_N64_LENGTH
DECL|function|gc_timer
r_static
r_void
id|gc_timer
c_func
(paren
r_int
r_int
r_private
)paren
(brace
r_struct
id|gc
op_star
id|gc
op_assign
(paren
r_void
op_star
)paren
r_private
suffix:semicolon
r_struct
id|input_dev
op_star
id|dev
op_assign
id|gc-&gt;dev
suffix:semicolon
r_int
r_char
id|data
(braket
id|GC_MAX_LENGTH
)braket
suffix:semicolon
r_int
id|i
comma
id|j
comma
id|s
suffix:semicolon
multiline_comment|/*&n; * N64 pads - must be read first, any read confuses them for 200 us&n; */
r_if
c_cond
(paren
id|gc-&gt;pads
(braket
id|GC_N64
)braket
)paren
(brace
id|gc_n64_read_packet
c_func
(paren
id|gc
comma
id|data
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|5
suffix:semicolon
id|i
op_increment
)paren
(brace
id|s
op_assign
id|gc_status_bit
(braket
id|i
)braket
suffix:semicolon
r_if
c_cond
(paren
id|s
op_amp
id|gc-&gt;pads
(braket
id|GC_N64
)braket
op_amp
op_complement
(paren
id|data
(braket
l_int|8
)braket
op_or
id|data
(braket
l_int|9
)braket
)paren
)paren
(brace
r_int
r_char
id|axes
(braket
l_int|2
)braket
suffix:semicolon
id|axes
(braket
l_int|0
)braket
op_assign
id|axes
(braket
l_int|1
)braket
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
l_int|8
suffix:semicolon
id|j
op_increment
)paren
(brace
r_if
c_cond
(paren
id|data
(braket
l_int|23
op_minus
id|j
)braket
op_amp
id|s
)paren
id|axes
(braket
l_int|0
)braket
op_or_assign
l_int|1
op_lshift
id|j
suffix:semicolon
r_if
c_cond
(paren
id|data
(braket
l_int|31
op_minus
id|j
)braket
op_amp
id|s
)paren
id|axes
(braket
l_int|1
)braket
op_or_assign
l_int|1
op_lshift
id|j
suffix:semicolon
)brace
id|input_report_abs
c_func
(paren
id|dev
op_plus
id|i
comma
id|ABS_X
comma
id|axes
(braket
l_int|0
)braket
)paren
suffix:semicolon
id|input_report_abs
c_func
(paren
id|dev
op_plus
id|i
comma
id|ABS_Y
comma
op_minus
id|axes
(braket
l_int|1
)braket
)paren
suffix:semicolon
id|input_report_abs
c_func
(paren
id|dev
op_plus
id|i
comma
id|ABS_HAT0X
comma
op_logical_neg
op_logical_neg
(paren
id|s
op_amp
id|data
(braket
l_int|7
)braket
)paren
op_minus
op_logical_neg
op_logical_neg
(paren
id|s
op_amp
id|data
(braket
l_int|6
)braket
)paren
)paren
suffix:semicolon
id|input_report_abs
c_func
(paren
id|dev
op_plus
id|i
comma
id|ABS_HAT0Y
comma
op_logical_neg
op_logical_neg
(paren
id|s
op_amp
id|data
(braket
l_int|5
)braket
)paren
op_minus
op_logical_neg
op_logical_neg
(paren
id|s
op_amp
id|data
(braket
l_int|4
)braket
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
l_int|10
suffix:semicolon
id|j
op_increment
)paren
id|input_report_key
c_func
(paren
id|dev
op_plus
id|i
comma
id|gc_n64_btn
(braket
id|j
)braket
comma
id|s
op_amp
id|data
(braket
id|gc_n64_bytes
(braket
id|j
)braket
)braket
)paren
suffix:semicolon
)brace
)brace
)brace
multiline_comment|/*&n; * NES and SNES pads&n; */
r_if
c_cond
(paren
id|gc-&gt;pads
(braket
id|GC_NES
)braket
op_logical_or
id|gc-&gt;pads
(braket
id|GC_SNES
)braket
)paren
(brace
id|gc_nes_read_packet
c_func
(paren
id|gc
comma
id|gc-&gt;pads
(braket
id|GC_SNES
)braket
ques
c_cond
id|GC_SNES_LENGTH
suffix:colon
id|GC_NES_LENGTH
comma
id|data
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|5
suffix:semicolon
id|i
op_increment
)paren
(brace
id|s
op_assign
id|gc_status_bit
(braket
id|i
)braket
suffix:semicolon
r_if
c_cond
(paren
id|s
op_amp
(paren
id|gc-&gt;pads
(braket
id|GC_NES
)braket
op_or
id|gc-&gt;pads
(braket
id|GC_SNES
)braket
)paren
)paren
(brace
id|input_report_abs
c_func
(paren
id|dev
op_plus
id|i
comma
id|ABS_X
comma
op_logical_neg
op_logical_neg
(paren
id|s
op_amp
id|data
(braket
l_int|7
)braket
)paren
op_minus
op_logical_neg
op_logical_neg
(paren
id|s
op_amp
id|data
(braket
l_int|6
)braket
)paren
)paren
suffix:semicolon
id|input_report_abs
c_func
(paren
id|dev
op_plus
id|i
comma
id|ABS_Y
comma
op_logical_neg
op_logical_neg
(paren
id|s
op_amp
id|data
(braket
l_int|5
)braket
)paren
op_minus
op_logical_neg
op_logical_neg
(paren
id|s
op_amp
id|data
(braket
l_int|4
)braket
)paren
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|s
op_amp
id|gc-&gt;pads
(braket
id|GC_NES
)braket
)paren
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
l_int|4
suffix:semicolon
id|j
op_increment
)paren
id|input_report_key
c_func
(paren
id|dev
op_plus
id|i
comma
id|gc_snes_btn
(braket
id|j
)braket
comma
id|s
op_amp
id|data
(braket
id|gc_nes_bytes
(braket
id|j
)braket
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|s
op_amp
id|gc-&gt;pads
(braket
id|GC_SNES
)braket
)paren
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
l_int|8
suffix:semicolon
id|j
op_increment
)paren
id|input_report_key
c_func
(paren
id|dev
op_plus
id|i
comma
id|gc_snes_btn
(braket
id|j
)braket
comma
id|s
op_amp
id|data
(braket
id|gc_snes_bytes
(braket
id|j
)braket
)braket
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/*&n; * Multi and Multi2 joysticks&n; */
r_if
c_cond
(paren
id|gc-&gt;pads
(braket
id|GC_MULTI
)braket
op_logical_or
id|gc-&gt;pads
(braket
id|GC_MULTI2
)braket
)paren
(brace
id|gc_multi_read_packet
c_func
(paren
id|gc
comma
id|gc-&gt;pads
(braket
id|GC_MULTI2
)braket
ques
c_cond
id|GC_MULTI2_LENGTH
suffix:colon
id|GC_MULTI_LENGTH
comma
id|data
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|5
suffix:semicolon
id|i
op_increment
)paren
(brace
id|s
op_assign
id|gc_status_bit
(braket
id|i
)braket
suffix:semicolon
r_if
c_cond
(paren
id|s
op_amp
(paren
id|gc-&gt;pads
(braket
id|GC_MULTI
)braket
op_or
id|gc-&gt;pads
(braket
id|GC_MULTI2
)braket
)paren
)paren
(brace
id|input_report_abs
c_func
(paren
id|dev
op_plus
id|i
comma
id|ABS_X
comma
op_logical_neg
op_logical_neg
(paren
id|s
op_amp
id|data
(braket
l_int|3
)braket
)paren
op_minus
op_logical_neg
op_logical_neg
(paren
id|s
op_amp
id|data
(braket
l_int|2
)braket
)paren
)paren
suffix:semicolon
id|input_report_abs
c_func
(paren
id|dev
op_plus
id|i
comma
id|ABS_Y
comma
op_logical_neg
op_logical_neg
(paren
id|s
op_amp
id|data
(braket
l_int|1
)braket
)paren
op_minus
op_logical_neg
op_logical_neg
(paren
id|s
op_amp
id|data
(braket
l_int|0
)braket
)paren
)paren
suffix:semicolon
id|input_report_key
c_func
(paren
id|dev
op_plus
id|i
comma
id|BTN_TRIGGER
comma
id|s
op_amp
id|data
(braket
l_int|4
)braket
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|s
op_amp
id|gc-&gt;pads
(braket
id|GC_MULTI2
)braket
)paren
id|input_report_key
c_func
(paren
id|dev
op_plus
id|i
comma
id|BTN_THUMB
comma
id|s
op_amp
id|data
(braket
l_int|5
)braket
)paren
suffix:semicolon
)brace
)brace
multiline_comment|/*&n; * PSX controllers&n; */
r_if
c_cond
(paren
id|gc-&gt;pads
(braket
id|GC_PSX
)braket
)paren
(brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|5
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|gc-&gt;pads
(braket
id|GC_PSX
)braket
op_amp
id|gc_status_bit
(braket
id|i
)braket
)paren
r_break
suffix:semicolon
r_switch
c_cond
(paren
id|gc_psx_read_packet
c_func
(paren
id|gc
comma
l_int|6
comma
id|data
)paren
)paren
(brace
r_case
id|GC_PSX_ANALOGG
suffix:colon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
l_int|4
suffix:semicolon
id|j
op_increment
)paren
id|input_report_abs
c_func
(paren
id|dev
op_plus
id|i
comma
id|gc_psx_abs
(braket
id|j
)braket
comma
id|data
(braket
id|j
op_plus
l_int|2
)braket
)paren
suffix:semicolon
id|input_report_abs
c_func
(paren
id|dev
op_plus
id|i
comma
id|ABS_HAT0X
comma
op_logical_neg
op_logical_neg
(paren
id|data
(braket
l_int|0
)braket
op_amp
l_int|0x20
)paren
op_minus
op_logical_neg
op_logical_neg
(paren
id|data
(braket
l_int|0
)braket
op_amp
l_int|0x80
)paren
)paren
suffix:semicolon
id|input_report_abs
c_func
(paren
id|dev
op_plus
id|i
comma
id|ABS_HAT0Y
comma
op_logical_neg
op_logical_neg
(paren
id|data
(braket
l_int|0
)braket
op_amp
l_int|0x40
)paren
op_minus
op_logical_neg
op_logical_neg
(paren
id|data
(braket
l_int|0
)braket
op_amp
l_int|0x10
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
l_int|8
suffix:semicolon
id|j
op_increment
)paren
id|input_report_key
c_func
(paren
id|dev
op_plus
id|i
comma
id|gc_psx_btn
(braket
id|j
)braket
comma
op_complement
id|data
(braket
l_int|1
)braket
op_amp
(paren
l_int|1
op_lshift
id|i
)paren
)paren
suffix:semicolon
id|input_report_key
c_func
(paren
id|dev
op_plus
id|i
comma
id|BTN_START
comma
op_complement
id|data
(braket
l_int|0
)braket
op_amp
l_int|0x08
)paren
suffix:semicolon
id|input_report_key
c_func
(paren
id|dev
op_plus
id|i
comma
id|BTN_SELECT
comma
op_complement
id|data
(braket
l_int|0
)braket
op_amp
l_int|0x01
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|GC_PSX_ANALOGR
suffix:colon
id|input_report_key
c_func
(paren
id|dev
op_plus
id|i
comma
id|BTN_THUMB
comma
op_complement
id|data
(braket
l_int|0
)braket
op_amp
l_int|0x04
)paren
suffix:semicolon
id|input_report_key
c_func
(paren
id|dev
op_plus
id|i
comma
id|BTN_THUMB2
comma
op_complement
id|data
(braket
l_int|0
)braket
op_amp
l_int|0x02
)paren
suffix:semicolon
r_case
id|GC_PSX_NORMAL
suffix:colon
r_case
id|GC_PSX_NEGCON
suffix:colon
id|input_report_abs
c_func
(paren
id|dev
op_plus
id|i
comma
id|ABS_X
comma
l_int|128
op_plus
op_logical_neg
op_logical_neg
(paren
id|data
(braket
l_int|0
)braket
op_amp
l_int|0x20
)paren
op_star
l_int|127
op_minus
op_logical_neg
op_logical_neg
(paren
id|data
(braket
l_int|0
)braket
op_amp
l_int|0x80
)paren
op_star
l_int|128
)paren
suffix:semicolon
id|input_report_abs
c_func
(paren
id|dev
op_plus
id|i
comma
id|ABS_Y
comma
l_int|128
op_plus
op_logical_neg
op_logical_neg
(paren
id|data
(braket
l_int|0
)braket
op_amp
l_int|0x40
)paren
op_star
l_int|127
op_minus
op_logical_neg
op_logical_neg
(paren
id|data
(braket
l_int|0
)braket
op_amp
l_int|0x10
)paren
op_star
l_int|128
)paren
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
l_int|8
suffix:semicolon
id|j
op_increment
)paren
id|input_report_key
c_func
(paren
id|dev
op_plus
id|i
comma
id|gc_psx_btn
(braket
id|j
)braket
comma
op_complement
id|data
(braket
l_int|1
)braket
op_amp
(paren
l_int|1
op_lshift
id|i
)paren
)paren
suffix:semicolon
id|input_report_key
c_func
(paren
id|dev
op_plus
id|i
comma
id|BTN_START
comma
op_complement
id|data
(braket
l_int|0
)braket
op_amp
l_int|0x08
)paren
suffix:semicolon
id|input_report_key
c_func
(paren
id|dev
op_plus
id|i
comma
id|BTN_SELECT
comma
op_complement
id|data
(braket
l_int|0
)braket
op_amp
l_int|0x01
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
id|mod_timer
c_func
(paren
op_amp
id|gc-&gt;timer
comma
id|jiffies
op_plus
id|GC_REFRESH_TIME
)paren
suffix:semicolon
)brace
DECL|function|gc_open
r_static
r_int
id|gc_open
c_func
(paren
r_struct
id|input_dev
op_star
id|dev
)paren
(brace
r_struct
id|gc
op_star
id|gc
op_assign
id|dev
op_member_access_from_pointer
r_private
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|gc-&gt;used
op_increment
)paren
(brace
id|parport_claim
c_func
(paren
id|gc-&gt;pd
)paren
suffix:semicolon
id|parport_write_control
c_func
(paren
id|gc-&gt;pd-&gt;port
comma
l_int|0x04
)paren
suffix:semicolon
id|mod_timer
c_func
(paren
op_amp
id|gc-&gt;timer
comma
id|jiffies
op_plus
id|GC_REFRESH_TIME
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|gc_close
r_static
r_void
id|gc_close
c_func
(paren
r_struct
id|input_dev
op_star
id|dev
)paren
(brace
r_struct
id|gc
op_star
id|gc
op_assign
id|dev
op_member_access_from_pointer
r_private
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
op_decrement
id|gc-&gt;used
)paren
(brace
id|del_timer
c_func
(paren
op_amp
id|gc-&gt;timer
)paren
suffix:semicolon
id|parport_write_control
c_func
(paren
id|gc-&gt;pd-&gt;port
comma
l_int|0x00
)paren
suffix:semicolon
id|parport_release
c_func
(paren
id|gc-&gt;pd
)paren
suffix:semicolon
)brace
)brace
DECL|function|gc_probe
r_static
r_struct
id|gc
id|__init
op_star
id|gc_probe
c_func
(paren
r_int
op_star
id|config
)paren
(brace
r_struct
id|gc
op_star
id|gc
suffix:semicolon
r_struct
id|parport
op_star
id|pp
suffix:semicolon
r_int
id|i
comma
id|j
comma
id|psx
comma
id|pbtn
suffix:semicolon
r_int
r_char
id|data
(braket
l_int|2
)braket
suffix:semicolon
r_if
c_cond
(paren
id|config
(braket
l_int|0
)braket
OL
l_int|0
)paren
r_return
l_int|NULL
suffix:semicolon
r_for
c_loop
(paren
id|pp
op_assign
id|parport_enumerate
c_func
(paren
)paren
suffix:semicolon
id|pp
op_logical_and
(paren
id|config
(braket
l_int|0
)braket
OG
l_int|0
)paren
suffix:semicolon
id|pp
op_assign
id|pp-&gt;next
)paren
id|config
(braket
l_int|0
)braket
op_decrement
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|pp
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;gamecon.c: no such parport&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|gc
op_assign
id|kmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|gc
)paren
comma
id|GFP_KERNEL
)paren
)paren
)paren
r_return
l_int|NULL
suffix:semicolon
id|memset
c_func
(paren
id|gc
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|gc
)paren
)paren
suffix:semicolon
id|gc-&gt;pd
op_assign
id|parport_register_device
c_func
(paren
id|pp
comma
l_string|&quot;gamecon&quot;
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|NULL
comma
id|PARPORT_DEV_EXCL
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|gc-&gt;pd
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;gamecon.c: parport busy already - lp.o loaded?&bslash;n&quot;
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|gc
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
id|parport_claim
c_func
(paren
id|gc-&gt;pd
)paren
suffix:semicolon
id|init_timer
c_func
(paren
op_amp
id|gc-&gt;timer
)paren
suffix:semicolon
id|gc-&gt;timer.data
op_assign
(paren
r_int
)paren
id|gc
suffix:semicolon
id|gc-&gt;timer.function
op_assign
id|gc_timer
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|5
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|config
(braket
id|i
op_plus
l_int|1
)braket
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|config
(braket
id|i
op_plus
l_int|1
)braket
template_param
id|GC_MAX
)paren
(brace
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;gamecon.c: Pad type %d unknown&bslash;n&quot;
comma
id|config
(braket
id|i
op_plus
l_int|1
)braket
)paren
suffix:semicolon
r_continue
suffix:semicolon
)brace
id|gc-&gt;dev
(braket
id|i
)braket
dot
r_private
op_assign
id|gc
suffix:semicolon
id|gc-&gt;dev
(braket
id|i
)braket
dot
id|open
op_assign
id|gc_open
suffix:semicolon
id|gc-&gt;dev
(braket
id|i
)braket
dot
id|close
op_assign
id|gc_close
suffix:semicolon
id|gc-&gt;dev
(braket
id|i
)braket
dot
id|evbit
(braket
l_int|0
)braket
op_assign
id|BIT
c_func
(paren
id|EV_KEY
)paren
op_or
id|BIT
c_func
(paren
id|EV_ABS
)paren
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
l_int|2
suffix:semicolon
id|j
op_increment
)paren
(brace
id|set_bit
c_func
(paren
id|ABS_X
op_plus
id|j
comma
id|gc-&gt;dev
(braket
id|i
)braket
dot
id|absbit
)paren
suffix:semicolon
id|gc-&gt;dev
(braket
id|i
)braket
dot
id|absmin
(braket
id|ABS_X
op_plus
id|j
)braket
op_assign
op_minus
l_int|1
suffix:semicolon
id|gc-&gt;dev
(braket
id|i
)braket
dot
id|absmax
(braket
id|ABS_X
op_plus
id|j
)braket
op_assign
l_int|1
suffix:semicolon
)brace
id|gc-&gt;pads
(braket
l_int|0
)braket
op_or_assign
id|gc_status_bit
(braket
id|i
)braket
suffix:semicolon
id|gc-&gt;pads
(braket
id|config
(braket
id|i
op_plus
l_int|1
)braket
)braket
op_or_assign
id|gc_status_bit
(braket
id|i
)braket
suffix:semicolon
r_switch
c_cond
(paren
id|config
(braket
id|i
op_plus
l_int|1
)braket
)paren
(brace
r_case
id|GC_N64
suffix:colon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
l_int|10
suffix:semicolon
id|j
op_increment
)paren
id|set_bit
c_func
(paren
id|gc_n64_btn
(braket
id|j
)braket
comma
id|gc-&gt;dev
(braket
id|i
)braket
dot
id|keybit
)paren
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
l_int|2
suffix:semicolon
id|j
op_increment
)paren
(brace
id|set_bit
c_func
(paren
id|ABS_X
op_plus
id|j
comma
id|gc-&gt;dev
(braket
id|i
)braket
dot
id|absbit
)paren
suffix:semicolon
id|gc-&gt;dev
(braket
id|i
)braket
dot
id|absmin
(braket
id|ABS_X
op_plus
id|j
)braket
op_assign
op_minus
l_int|127
suffix:semicolon
id|gc-&gt;dev
(braket
id|i
)braket
dot
id|absmax
(braket
id|ABS_X
op_plus
id|j
)braket
op_assign
l_int|126
suffix:semicolon
id|gc-&gt;dev
(braket
id|i
)braket
dot
id|absflat
(braket
id|ABS_X
op_plus
id|j
)braket
op_assign
l_int|2
suffix:semicolon
id|set_bit
c_func
(paren
id|ABS_HAT0X
op_plus
id|j
comma
id|gc-&gt;dev
(braket
id|i
)braket
dot
id|absbit
)paren
suffix:semicolon
id|gc-&gt;dev
(braket
id|i
)braket
dot
id|absmin
(braket
id|ABS_HAT0X
op_plus
id|j
)braket
op_assign
op_minus
l_int|1
suffix:semicolon
id|gc-&gt;dev
(braket
id|i
)braket
dot
id|absmax
(braket
id|ABS_HAT0X
op_plus
id|j
)braket
op_assign
l_int|1
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
id|GC_SNES
suffix:colon
r_for
c_loop
(paren
id|j
op_assign
l_int|4
suffix:semicolon
id|j
OL
l_int|8
suffix:semicolon
id|j
op_increment
)paren
id|set_bit
c_func
(paren
id|gc_snes_btn
(braket
id|j
)braket
comma
id|gc-&gt;dev
(braket
id|i
)braket
dot
id|keybit
)paren
suffix:semicolon
r_case
id|GC_NES
suffix:colon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
l_int|4
suffix:semicolon
id|j
op_increment
)paren
id|set_bit
c_func
(paren
id|gc_snes_btn
(braket
id|j
)braket
comma
id|gc-&gt;dev
(braket
id|i
)braket
dot
id|keybit
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|GC_MULTI2
suffix:colon
id|set_bit
c_func
(paren
id|BTN_THUMB
comma
id|gc-&gt;dev
(braket
id|i
)braket
dot
id|keybit
)paren
suffix:semicolon
r_case
id|GC_MULTI
suffix:colon
id|set_bit
c_func
(paren
id|BTN_TRIGGER
comma
id|gc-&gt;dev
(braket
id|i
)braket
dot
id|keybit
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|GC_PSX
suffix:colon
id|psx
op_assign
id|gc_psx_read_packet
c_func
(paren
id|gc
comma
l_int|2
comma
id|data
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|psx
)paren
(brace
r_case
id|GC_PSX_NEGCON
suffix:colon
id|config
(braket
id|i
op_plus
l_int|1
)braket
op_add_assign
l_int|1
suffix:semicolon
r_case
id|GC_PSX_NORMAL
suffix:colon
id|pbtn
op_assign
l_int|10
suffix:semicolon
r_break
suffix:semicolon
r_case
id|GC_PSX_ANALOGG
suffix:colon
r_case
id|GC_PSX_ANALOGR
suffix:colon
id|config
(braket
id|i
op_plus
l_int|1
)braket
op_add_assign
l_int|2
suffix:semicolon
id|pbtn
op_assign
l_int|12
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
l_int|6
suffix:semicolon
id|j
op_increment
)paren
(brace
id|psx
op_assign
id|gc_psx_abs
(braket
id|j
)braket
suffix:semicolon
id|set_bit
c_func
(paren
id|psx
comma
id|gc-&gt;dev
(braket
id|i
)braket
dot
id|absbit
)paren
suffix:semicolon
id|gc-&gt;dev
(braket
id|i
)braket
dot
id|absmin
(braket
id|psx
)braket
op_assign
l_int|4
suffix:semicolon
id|gc-&gt;dev
(braket
id|i
)braket
dot
id|absmax
(braket
id|psx
)braket
op_assign
l_int|252
suffix:semicolon
id|gc-&gt;dev
(braket
id|i
)braket
dot
id|absflat
(braket
id|psx
)braket
op_assign
l_int|2
suffix:semicolon
)brace
r_break
suffix:semicolon
r_case
op_minus
l_int|1
suffix:colon
id|gc-&gt;pads
(braket
id|GC_PSX
)braket
op_and_assign
op_complement
id|gc_status_bit
(braket
id|i
)braket
suffix:semicolon
id|pbtn
op_assign
l_int|0
suffix:semicolon
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;gamecon.c: No PSX controller found.&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|gc-&gt;pads
(braket
id|GC_PSX
)braket
op_and_assign
op_complement
id|gc_status_bit
(braket
id|i
)braket
suffix:semicolon
id|pbtn
op_assign
l_int|0
suffix:semicolon
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;gamecon.c: Unsupported PSX controller %#x,&quot;
l_string|&quot; please report to &lt;vojtech@suse.cz&gt;.&bslash;n&quot;
comma
id|psx
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
id|pbtn
suffix:semicolon
id|j
op_increment
)paren
id|set_bit
c_func
(paren
id|gc_psx_btn
(braket
id|j
)braket
comma
id|gc-&gt;dev
(braket
id|i
)braket
dot
id|keybit
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|gc-&gt;dev
(braket
id|i
)braket
dot
id|name
op_assign
id|gc_names
(braket
id|config
(braket
id|i
op_plus
l_int|1
)braket
)braket
suffix:semicolon
id|gc-&gt;dev
(braket
id|i
)braket
dot
id|idbus
op_assign
id|BUS_PARPORT
suffix:semicolon
id|gc-&gt;dev
(braket
id|i
)braket
dot
id|idvendor
op_assign
l_int|0x0001
suffix:semicolon
id|gc-&gt;dev
(braket
id|i
)braket
dot
id|idproduct
op_assign
id|config
(braket
id|i
op_plus
l_int|1
)braket
suffix:semicolon
id|gc-&gt;dev
(braket
id|i
)braket
dot
id|idversion
op_assign
l_int|0x0100
suffix:semicolon
)brace
id|parport_release
c_func
(paren
id|gc-&gt;pd
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|gc-&gt;pads
(braket
l_int|0
)braket
)paren
(brace
id|parport_unregister_device
c_func
(paren
id|gc-&gt;pd
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|gc
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|5
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|gc-&gt;pads
(braket
l_int|0
)braket
op_amp
id|gc_status_bit
(braket
id|i
)braket
)paren
(brace
id|input_register_device
c_func
(paren
id|gc-&gt;dev
op_plus
id|i
)paren
suffix:semicolon
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;input%d: %s on %s&bslash;n&quot;
comma
id|gc-&gt;dev
(braket
id|i
)braket
dot
id|number
comma
id|gc-&gt;dev
(braket
id|i
)braket
dot
id|name
comma
id|gc-&gt;pd-&gt;port-&gt;name
)paren
suffix:semicolon
)brace
r_return
id|gc
suffix:semicolon
)brace
macro_line|#ifndef MODULE
DECL|function|gc_setup
r_int
id|__init
id|gc_setup
c_func
(paren
r_char
op_star
id|str
)paren
(brace
r_int
id|i
comma
id|ints
(braket
l_int|7
)braket
suffix:semicolon
id|get_options
c_func
(paren
id|str
comma
id|ARRAY_SIZE
c_func
(paren
id|ints
)paren
comma
id|ints
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
id|ints
(braket
l_int|0
)braket
op_logical_and
id|i
OL
l_int|6
suffix:semicolon
id|i
op_increment
)paren
id|gc
(braket
id|i
)braket
op_assign
id|ints
(braket
id|i
op_plus
l_int|1
)braket
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|gc_setup_2
r_int
id|__init
id|gc_setup_2
c_func
(paren
r_char
op_star
id|str
)paren
(brace
r_int
id|i
comma
id|ints
(braket
l_int|7
)braket
suffix:semicolon
id|get_options
c_func
(paren
id|str
comma
id|ARRAY_SIZE
c_func
(paren
id|ints
)paren
comma
id|ints
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
id|ints
(braket
l_int|0
)braket
op_logical_and
id|i
OL
l_int|6
suffix:semicolon
id|i
op_increment
)paren
id|gc_2
(braket
id|i
)braket
op_assign
id|ints
(braket
id|i
op_plus
l_int|1
)braket
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|gc_setup_3
r_int
id|__init
id|gc_setup_3
c_func
(paren
r_char
op_star
id|str
)paren
(brace
r_int
id|i
comma
id|ints
(braket
l_int|7
)braket
suffix:semicolon
id|get_options
c_func
(paren
id|str
comma
id|ARRAY_SIZE
c_func
(paren
id|ints
)paren
comma
id|ints
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
id|ints
(braket
l_int|0
)braket
op_logical_and
id|i
OL
l_int|6
suffix:semicolon
id|i
op_increment
)paren
id|gc_3
(braket
id|i
)braket
op_assign
id|ints
(braket
id|i
op_plus
l_int|1
)braket
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
id|__setup
c_func
(paren
l_string|&quot;gc=&quot;
comma
id|gc_setup
)paren
suffix:semicolon
id|__setup
c_func
(paren
l_string|&quot;gc_2=&quot;
comma
id|gc_setup_2
)paren
suffix:semicolon
id|__setup
c_func
(paren
l_string|&quot;gc_3=&quot;
comma
id|gc_setup_3
)paren
suffix:semicolon
macro_line|#endif
DECL|function|gc_init
r_int
id|__init
id|gc_init
c_func
(paren
r_void
)paren
(brace
id|gc_base
(braket
l_int|0
)braket
op_assign
id|gc_probe
c_func
(paren
id|gc
)paren
suffix:semicolon
id|gc_base
(braket
l_int|1
)braket
op_assign
id|gc_probe
c_func
(paren
id|gc_2
)paren
suffix:semicolon
id|gc_base
(braket
l_int|2
)braket
op_assign
id|gc_probe
c_func
(paren
id|gc_3
)paren
suffix:semicolon
r_if
c_cond
(paren
id|gc_base
(braket
l_int|0
)braket
op_logical_or
id|gc_base
(braket
l_int|1
)braket
op_logical_or
id|gc_base
(braket
l_int|2
)braket
)paren
r_return
l_int|0
suffix:semicolon
r_return
op_minus
id|ENODEV
suffix:semicolon
)brace
DECL|function|gc_exit
r_void
id|__exit
id|gc_exit
c_func
(paren
r_void
)paren
(brace
r_int
id|i
comma
id|j
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|3
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|gc_base
(braket
id|i
)braket
)paren
(brace
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
l_int|5
suffix:semicolon
id|j
op_increment
)paren
r_if
c_cond
(paren
id|gc_base
(braket
id|i
)braket
op_member_access_from_pointer
id|pads
(braket
l_int|0
)braket
op_amp
id|gc_status_bit
(braket
id|j
)braket
)paren
id|input_unregister_device
c_func
(paren
id|gc_base
(braket
id|i
)braket
op_member_access_from_pointer
id|dev
op_plus
id|j
)paren
suffix:semicolon
id|parport_unregister_device
c_func
(paren
id|gc_base
(braket
id|i
)braket
op_member_access_from_pointer
id|pd
)paren
suffix:semicolon
)brace
)brace
DECL|variable|gc_init
id|module_init
c_func
(paren
id|gc_init
)paren
suffix:semicolon
DECL|variable|gc_exit
id|module_exit
c_func
(paren
id|gc_exit
)paren
suffix:semicolon
eof
