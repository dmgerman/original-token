macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/interrupt.h&gt;
macro_line|#include &lt;linux/errno.h&gt;
macro_line|#include &lt;linux/keyboard.h&gt;
macro_line|#include &lt;linux/delay.h&gt;
macro_line|#include &lt;linux/timer.h&gt;
macro_line|#include &lt;linux/kd.h&gt;
macro_line|#include &lt;linux/random.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/poll.h&gt;
macro_line|#include &lt;linux/miscdevice.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;asm/setup.h&gt;
macro_line|#include &lt;asm/irq.h&gt;
macro_line|#include &lt;asm/apollohw.h&gt;
macro_line|#include &lt;asm/uaccess.h&gt;
macro_line|#include &quot;busmouse.h&quot;
multiline_comment|/* extern void handle_scancode(unsigned char,int ); */
DECL|macro|DNKEY_CAPS
mdefine_line|#define DNKEY_CAPS 0x7e
DECL|macro|BREAK_FLAG
mdefine_line|#define BREAK_FLAG 0x80
DECL|macro|DNKEY_REPEAT_DELAY
mdefine_line|#define DNKEY_REPEAT_DELAY 50
DECL|macro|DNKEY_CTRL
mdefine_line|#define DNKEY_CTRL 0x43
DECL|macro|DNKEY_LSHIFT
mdefine_line|#define DNKEY_LSHIFT 0x5e
DECL|macro|DNKEY_RSHIFT
mdefine_line|#define DNKEY_RSHIFT 0x6a
DECL|macro|DNKEY_REPT
mdefine_line|#define DNKEY_REPT 0x5d
DECL|macro|DNKEY_REPEAT
mdefine_line|#define DNKEY_REPEAT 0x7f
DECL|macro|DNKEY_LALT
mdefine_line|#define DNKEY_LALT 0x75
DECL|macro|DNKEY_RALT
mdefine_line|#define DNKEY_RALT 0x77
DECL|macro|APOLLO_KEYB_CMD_ENTRIES
mdefine_line|#define APOLLO_KEYB_CMD_ENTRIES 16
DECL|macro|APOLLO_KBD_MODE_KEYB
mdefine_line|#define APOLLO_KBD_MODE_KEYB   0x01
DECL|macro|APOLLO_KBD_MODE_MOUSE
mdefine_line|#define APOLLO_KBD_MODE_MOUSE   0x02
DECL|macro|APOLLO_KBD_MODE_CHANGE
mdefine_line|#define APOLLO_KBD_MODE_CHANGE 0xff
DECL|variable|keyb_cmds
r_static
id|u_char
id|keyb_cmds
(braket
id|APOLLO_KEYB_CMD_ENTRIES
)braket
suffix:semicolon
DECL|variable|keyb_cmd_read
DECL|variable|keyb_cmd_write
r_static
r_int
id|keyb_cmd_read
op_assign
l_int|0
comma
id|keyb_cmd_write
op_assign
l_int|0
suffix:semicolon
DECL|variable|keyb_cmd_transmit
r_static
r_int
id|keyb_cmd_transmit
op_assign
l_int|0
suffix:semicolon
DECL|variable|msedev
r_static
r_int
id|msedev
suffix:semicolon
DECL|variable|kbd_mode
r_static
r_int
r_int
id|kbd_mode
op_assign
id|APOLLO_KBD_MODE_KEYB
suffix:semicolon
macro_line|#if 0
r_static
r_void
id|debug_keyb_timer_handler
c_func
(paren
r_int
r_int
id|ignored
)paren
suffix:semicolon
r_static
id|u_char
id|debug_buf1
(braket
l_int|4096
)braket
comma
id|debug_buf2
(braket
l_int|4096
)braket
comma
op_star
id|debug_buf
op_assign
op_amp
id|debug_buf1
(braket
l_int|0
)braket
suffix:semicolon
r_static
id|u_char
op_star
id|shadow_buf
op_assign
op_amp
id|debug_buf2
(braket
l_int|0
)braket
suffix:semicolon
r_static
r_int
id|debug_buf_count
op_assign
l_int|0
suffix:semicolon
r_static
r_int
id|debug_buf_overrun
op_assign
l_int|0
comma
id|debug_timer_running
op_assign
l_int|0
suffix:semicolon
r_static
r_int
r_int
id|debug_buffer_updated
op_assign
l_int|0
suffix:semicolon
r_static
r_struct
id|timer_list
id|debug_keyb_timer
op_assign
(brace
id|function
suffix:colon
id|debug_keyb_timer_handler
)brace
suffix:semicolon
macro_line|#endif
DECL|variable|__initdata
r_static
id|u_short
id|dnplain_map
(braket
id|NR_KEYS
)braket
id|__initdata
op_assign
(brace
multiline_comment|/*         ins     del     del     F1      F2      F3      F4  &n;           mark    line    char                                 */
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
multiline_comment|/* F5      F6      F7      F8      F9      F0      Again   Read */
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
multiline_comment|/* Edit    Exit    Hold    Copy    Paste   Grow            ESC  */
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf01b
comma
multiline_comment|/* 1       2       3       4       5       6       7       8    */
l_int|0xf031
comma
l_int|0xf032
comma
l_int|0xf033
comma
l_int|0xf034
comma
l_int|0xf035
comma
l_int|0xf036
comma
l_int|0xf037
comma
l_int|0xf038
comma
multiline_comment|/* 9       0       -       =       `       Back            |&lt;--&n;                                           Space                */
l_int|0xf039
comma
l_int|0xf030
comma
l_int|0xf02d
comma
l_int|0xf03d
comma
l_int|0xf060
comma
l_int|0xf07f
comma
l_int|0xf200
comma
l_int|0xf200
comma
multiline_comment|/* Shell   --&gt;|                    Tab     q       w       e&n;   Cmd                                                          */
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf009
comma
l_int|0xfb71
comma
l_int|0xfb77
comma
l_int|0xfb65
comma
multiline_comment|/* r       t       y       u       i       o       p       [    */
l_int|0xfb72
comma
l_int|0xfb74
comma
l_int|0xfb79
comma
l_int|0xfb75
comma
l_int|0xfb69
comma
l_int|0xfb6f
comma
l_int|0xfb70
comma
l_int|0xf05b
comma
multiline_comment|/* ]               Del             7       8       9       +    */
l_int|0xf05d
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf307
comma
l_int|0xf308
comma
l_int|0xf300
comma
l_int|0xf30a
comma
multiline_comment|/* [&lt;--]   Up      [--&gt;]   Ctrl                    a       s    */
l_int|0xf200
comma
l_int|0xf600
comma
l_int|0xf200
comma
l_int|0xf702
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xfb61
comma
l_int|0xfb73
comma
multiline_comment|/* d       f       g       h       j       k       l       ;    */
l_int|0xfb64
comma
l_int|0xfb66
comma
l_int|0xfb67
comma
l_int|0xfb68
comma
l_int|0xfb6a
comma
l_int|0xfb6b
comma
l_int|0xfb6c
comma
l_int|0xf03b
comma
multiline_comment|/* &squot;               Return  &bslash;               4       5       6    */
l_int|0xf027
comma
l_int|0xf200
comma
l_int|0xf201
comma
l_int|0xf05c
comma
l_int|0xf200
comma
l_int|0xf304
comma
l_int|0xf305
comma
l_int|0xf306
comma
multiline_comment|/* -       &lt;--     Next    --&gt;             Rept    Shift        &n;                   Window                                       */
l_int|0xf30b
comma
l_int|0xf601
comma
l_int|0xf200
comma
l_int|0xf602
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf700
comma
l_int|0xf200
comma
multiline_comment|/* z       x       c       v       b       n       m       ,    */
l_int|0xfb7a
comma
l_int|0xfb78
comma
l_int|0xfb63
comma
l_int|0xfb76
comma
l_int|0xfb62
comma
l_int|0xfb6e
comma
l_int|0xfb6d
comma
l_int|0xf02c
comma
multiline_comment|/* .       /       Shift           Pop             1       2    */
l_int|0xf02e
comma
l_int|0xf02f
comma
l_int|0xf700
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf301
comma
l_int|0xf302
comma
multiline_comment|/* 3               PgUp    Down    PgDn    Alt     Space   Alt  */
l_int|0xf303
comma
l_int|0xf200
comma
l_int|0xf118
comma
l_int|0xf603
comma
l_int|0xf119
comma
l_int|0xf703
comma
l_int|0xf020
comma
l_int|0xf701
comma
multiline_comment|/*         0               .       Enter                        */
l_int|0xf200
comma
l_int|0xf300
comma
l_int|0xf200
comma
l_int|0xf310
comma
l_int|0xf30e
comma
l_int|0xf200
comma
l_int|0xf700
comma
l_int|0xf200
comma
)brace
suffix:semicolon
DECL|variable|__initdata
r_static
id|u_short
id|dnshift_map
(braket
id|NR_KEYS
)braket
id|__initdata
op_assign
(brace
multiline_comment|/*         ins     del     del     F1      F2      F3      F4&n;           mark    line    char                                 */
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
multiline_comment|/* F5      F6      F7      F8      F9      F0      Again   Read */
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
multiline_comment|/* Save    Abort   Help    Cut     Undo    Grow            ESC  */
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf01b
comma
multiline_comment|/* !       @       #       $       %       ^       &amp;       *    */
l_int|0xf021
comma
l_int|0xf040
comma
l_int|0xf023
comma
l_int|0xf024
comma
l_int|0xf025
comma
l_int|0xf05e
comma
l_int|0xf026
comma
l_int|0xf02a
comma
multiline_comment|/* (       )       _       +       ~       Back            |&lt;--&n;                                           Space                */
l_int|0xf028
comma
l_int|0xf029
comma
l_int|0xf05f
comma
l_int|0xf02b
comma
l_int|0xf07e
comma
l_int|0xf07f
comma
l_int|0xf200
comma
l_int|0xf200
comma
multiline_comment|/* Shell   --&gt;|                    Tab     Q       W       E&n;   Cmd                                                          */
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf009
comma
l_int|0xfb51
comma
l_int|0xfb57
comma
l_int|0xfb45
comma
multiline_comment|/* R       T       Y       U       I       O       P       {    */
l_int|0xfb52
comma
l_int|0xfb54
comma
l_int|0xfb59
comma
l_int|0xfb55
comma
l_int|0xfb49
comma
l_int|0xfb4f
comma
l_int|0xfb50
comma
l_int|0xf07b
comma
multiline_comment|/* }               Del             7       8       9       +    */
l_int|0xf07d
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf307
comma
l_int|0xf308
comma
l_int|0xf300
comma
l_int|0xf30a
comma
multiline_comment|/* [&lt;--]   Up      [--&gt;]   Ctrl                    A       S    */
l_int|0xf200
comma
l_int|0xf600
comma
l_int|0xf200
comma
l_int|0xf702
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xfb41
comma
l_int|0xfb53
comma
multiline_comment|/* D       F       G       H       J       K       L       :    */
l_int|0xfb44
comma
l_int|0xfb46
comma
l_int|0xfb47
comma
l_int|0xfb48
comma
l_int|0xfb4a
comma
l_int|0xfb4b
comma
l_int|0xfb4c
comma
l_int|0xf03a
comma
multiline_comment|/* &quot;               Return  |               4       5       6    */
l_int|0xf022
comma
l_int|0xf200
comma
l_int|0xf201
comma
l_int|0xf07c
comma
l_int|0xf200
comma
l_int|0xf304
comma
l_int|0xf305
comma
l_int|0xf306
comma
multiline_comment|/* -       &lt;--     Next    --&gt;             Rept    Shift        &n;                   Window                                       */
l_int|0xf30b
comma
l_int|0xf601
comma
l_int|0xf200
comma
l_int|0xf602
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf700
comma
l_int|0xf200
comma
multiline_comment|/* Z       X       C       V       B       N       M       &lt;    */
l_int|0xfb5a
comma
l_int|0xfb58
comma
l_int|0xfb43
comma
l_int|0xfb56
comma
l_int|0xfb42
comma
l_int|0xfb4e
comma
l_int|0xfb4d
comma
l_int|0xf03c
comma
multiline_comment|/* &gt;       ?       Shift           Pop             1       2    */
l_int|0xf03e
comma
l_int|0xf03f
comma
l_int|0xf700
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf301
comma
l_int|0xf302
comma
multiline_comment|/* 3               PgUp    Down    PgDn    Alt     Space   Alt  */
l_int|0xf303
comma
l_int|0xf200
comma
l_int|0xf118
comma
l_int|0xf603
comma
l_int|0xf119
comma
l_int|0xf703
comma
l_int|0xf020
comma
l_int|0xf701
comma
multiline_comment|/*         0               .       Enter                        */
l_int|0xf200
comma
l_int|0xf300
comma
l_int|0xf200
comma
l_int|0xf310
comma
l_int|0xf30e
comma
l_int|0xf200
comma
l_int|0xf708
comma
l_int|0xf200
comma
)brace
suffix:semicolon
DECL|variable|__initdata
r_static
id|u_short
id|dnctrl_map
(braket
id|NR_KEYS
)braket
id|__initdata
op_assign
(brace
multiline_comment|/*         ins     del     del     F1      F2      F3      F4&n;           mark    line    char                                 */
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
multiline_comment|/* F5      F6      F7      F8      F9      F0      Again   Read */
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
multiline_comment|/* Save    Abort   Help    Cut     Undo    Grow            ESC  */
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf01b
comma
multiline_comment|/* !       @       #       $       %       ^       &amp;       *    */
l_int|0xf200
comma
l_int|0xf000
comma
l_int|0xf01b
comma
l_int|0xf01c
comma
l_int|0xf01d
comma
l_int|0xf01e
comma
l_int|0xf01f
comma
l_int|0xf07f
comma
multiline_comment|/* (       )       _       +       ~       Back            |&lt;--&n;                                           Space                */
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf01f
comma
l_int|0xf200
comma
l_int|0xf01c
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
multiline_comment|/* Shell   --&gt;|                    Tab     Q       W       E&n;   Cmd                                                          */
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf009
comma
l_int|0xf011
comma
l_int|0xf017
comma
l_int|0xf005
comma
multiline_comment|/* R       T       Y       U       I       O       P       {    */
l_int|0xf012
comma
l_int|0xf014
comma
l_int|0xf019
comma
l_int|0xf015
comma
l_int|0xf009
comma
l_int|0xf00f
comma
l_int|0xf010
comma
l_int|0xf01b
comma
multiline_comment|/* }               Del             7       8       9       +    */
l_int|0xf01d
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf307
comma
l_int|0xf308
comma
l_int|0xf300
comma
l_int|0xf30a
comma
multiline_comment|/* [&lt;--]   Up      [--&gt;]   Ctrl                    A       S    */
l_int|0xf200
comma
l_int|0xf600
comma
l_int|0xf200
comma
l_int|0xf702
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xfb01
comma
l_int|0xfb53
comma
multiline_comment|/* D       F       G       H       J       K       L       :    */
l_int|0xf004
comma
l_int|0xf006
comma
l_int|0xf007
comma
l_int|0xf008
comma
l_int|0xf00a
comma
l_int|0xf00b
comma
l_int|0xf00c
comma
l_int|0xf200
comma
multiline_comment|/* &quot;               Return  |               4       5       6    */
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf201
comma
l_int|0xf01c
comma
l_int|0xf200
comma
l_int|0xf304
comma
l_int|0xf305
comma
l_int|0xf306
comma
multiline_comment|/* -       &lt;--     Next    --&gt;             Rept    Shift        &n;                   Window                                       */
l_int|0xf30b
comma
l_int|0xf601
comma
l_int|0xf200
comma
l_int|0xf602
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf704
comma
l_int|0xf200
comma
multiline_comment|/* Z       X       C       V       B       N       M       &lt;    */
l_int|0xf01a
comma
l_int|0xf018
comma
l_int|0xf003
comma
l_int|0xf016
comma
l_int|0xf002
comma
l_int|0xf00e
comma
l_int|0xf01d
comma
l_int|0xf03c
comma
multiline_comment|/* &gt;       ?       Shift           Pop             1       2    */
l_int|0xf03e
comma
l_int|0xf03f
comma
l_int|0xf705
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf301
comma
l_int|0xf302
comma
multiline_comment|/* 3               PgUp    Down    PgDn    Alt     Space   Alt  */
l_int|0xf303
comma
l_int|0xf200
comma
l_int|0xf118
comma
l_int|0xf603
comma
l_int|0xf119
comma
l_int|0xf703
comma
l_int|0xf020
comma
l_int|0xf701
comma
multiline_comment|/*         0               .       Enter                        */
l_int|0xf200
comma
l_int|0xf300
comma
l_int|0xf200
comma
l_int|0xf310
comma
l_int|0xf30e
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
)brace
suffix:semicolon
DECL|variable|__initdata
r_static
id|u_short
id|dnalt_map
(braket
id|NR_KEYS
)braket
id|__initdata
op_assign
(brace
multiline_comment|/*         ins     del     del     F1      F2      F3      F4  &n;           mark    line    char                                 */
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf500
comma
l_int|0xf501
comma
l_int|0xf502
comma
l_int|0xf503
comma
multiline_comment|/* F5      F6      F7      F8      F9      F0      Again   Read */
l_int|0xf504
comma
l_int|0xf505
comma
l_int|0xf506
comma
l_int|0xf507
comma
l_int|0xf508
comma
l_int|0xf509
comma
l_int|0xf200
comma
l_int|0xf200
comma
multiline_comment|/* Edit    Exit    Hold    Copy    Paste   Grow            ESC  */
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf01b
comma
multiline_comment|/* 1       2       3       4       5       6       7       8    */
l_int|0xf831
comma
l_int|0xf832
comma
l_int|0xf833
comma
l_int|0xf834
comma
l_int|0xf835
comma
l_int|0xf836
comma
l_int|0xf837
comma
l_int|0xf838
comma
multiline_comment|/* 9       0       -       =       `       Back            |&lt;--&n;                                           Space                */
l_int|0xf839
comma
l_int|0xf830
comma
l_int|0xf82d
comma
l_int|0xf83d
comma
l_int|0xf860
comma
l_int|0xf87f
comma
l_int|0xf200
comma
l_int|0xf200
comma
multiline_comment|/* Shell   --&gt;|                    Tab     q       w       e&n;   Cmd                                                          */
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf809
comma
l_int|0xf871
comma
l_int|0xf877
comma
l_int|0xf865
comma
multiline_comment|/* r       t       y       u       i       o       p       [    */
l_int|0xf872
comma
l_int|0xf874
comma
l_int|0xf879
comma
l_int|0xf875
comma
l_int|0xf869
comma
l_int|0xf86f
comma
l_int|0xf870
comma
l_int|0xf85b
comma
multiline_comment|/* ]               Del             7       8       9       +    */
l_int|0xf05d
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf307
comma
l_int|0xf308
comma
l_int|0xf300
comma
l_int|0xf30a
comma
multiline_comment|/* [&lt;--]   Up      [--&gt;]   Ctrl                    a       s    */
l_int|0xf200
comma
l_int|0xf600
comma
l_int|0xf200
comma
l_int|0xf702
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf861
comma
l_int|0xf873
comma
multiline_comment|/* d       f       g       h       j       k       l       ;    */
l_int|0xf864
comma
l_int|0xf866
comma
l_int|0xf867
comma
l_int|0xf868
comma
l_int|0xf86a
comma
l_int|0xf86b
comma
l_int|0xf86c
comma
l_int|0xf03b
comma
multiline_comment|/* &squot;               Return  &bslash;               4       5       6    */
l_int|0xf027
comma
l_int|0xf200
comma
l_int|0xf201
comma
l_int|0xf05c
comma
l_int|0xf200
comma
l_int|0xf304
comma
l_int|0xf305
comma
l_int|0xf306
comma
multiline_comment|/* -       &lt;--     Next    --&gt;             Rept    Shift        &n;                   Window                                       */
l_int|0xf30b
comma
l_int|0xf601
comma
l_int|0xf200
comma
l_int|0xf602
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf704
comma
l_int|0xf200
comma
multiline_comment|/* z       x       c       v       b       n       m       ,    */
l_int|0xf87a
comma
l_int|0xf878
comma
l_int|0xf863
comma
l_int|0xf876
comma
l_int|0xf862
comma
l_int|0xf86e
comma
l_int|0xf86d
comma
l_int|0xf82c
comma
multiline_comment|/* .       /       Shift           Pop             1       2    */
l_int|0xf82e
comma
l_int|0xf82f
comma
l_int|0xf705
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf301
comma
l_int|0xf302
comma
multiline_comment|/* 3               PgUp    Down    PgDn    Alt     Space   Alt  */
l_int|0xf303
comma
l_int|0xf200
comma
l_int|0xf118
comma
l_int|0xf603
comma
l_int|0xf119
comma
l_int|0xf703
comma
l_int|0xf820
comma
l_int|0xf701
comma
multiline_comment|/*         0               .       Enter                        */
l_int|0xf200
comma
l_int|0xf300
comma
l_int|0xf200
comma
l_int|0xf310
comma
l_int|0xf30e
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
)brace
suffix:semicolon
DECL|variable|__initdata
r_static
id|u_short
id|dnaltgr_map
(braket
id|NR_KEYS
)braket
id|__initdata
op_assign
(brace
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
)brace
suffix:semicolon
DECL|variable|__initdata
r_static
id|u_short
id|dnshift_ctrl_map
(braket
id|NR_KEYS
)braket
id|__initdata
op_assign
(brace
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
)brace
suffix:semicolon
DECL|variable|__initdata
r_static
id|u_short
id|dnctrl_alt_map
(braket
id|NR_KEYS
)braket
id|__initdata
op_assign
(brace
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
comma
l_int|0xf200
)brace
suffix:semicolon
macro_line|#if 0
r_static
r_void
id|debug_keyb_timer_handler
c_func
(paren
r_int
r_int
id|ignored
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
id|u_char
op_star
id|swap
suffix:semicolon
r_int
id|length
comma
id|i
suffix:semicolon
r_if
c_cond
(paren
id|time_after
c_func
(paren
id|jiffies
comma
id|debug_buffer_updated
op_plus
l_int|100
)paren
)paren
(brace
id|save_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
id|cli
c_func
(paren
)paren
suffix:semicolon
id|length
op_assign
id|debug_buf_count
suffix:semicolon
id|swap
op_assign
id|debug_buf
suffix:semicolon
id|debug_buf
op_assign
id|shadow_buf
suffix:semicolon
id|shadow_buf
op_assign
id|swap
suffix:semicolon
id|debug_buf_count
op_assign
l_int|0
suffix:semicolon
id|debug_timer_running
op_assign
l_int|0
suffix:semicolon
id|restore_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|1
suffix:semicolon
id|length
suffix:semicolon
id|length
op_decrement
comma
id|i
op_increment
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;%02x%c&quot;
comma
op_star
(paren
id|swap
op_increment
)paren
comma
(paren
id|i
op_mod
l_int|25
)paren
ques
c_cond
l_char|&squot; &squot;
suffix:colon
l_char|&squot;&bslash;n&squot;
)paren
suffix:semicolon
)brace
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_else
(brace
id|debug_keyb_timer.expires
op_assign
id|jiffies
op_plus
l_int|10
suffix:semicolon
id|add_timer
c_func
(paren
op_amp
id|debug_keyb_timer
)paren
suffix:semicolon
)brace
)brace
macro_line|#endif
DECL|function|dn_keyb_process_key_event
r_static
r_void
id|dn_keyb_process_key_event
c_func
(paren
r_int
r_char
id|scancode
)paren
(brace
r_static
r_int
r_char
id|lastscancode
suffix:semicolon
r_int
r_char
id|prev_scancode
op_assign
id|lastscancode
suffix:semicolon
r_static
r_int
r_int
id|lastkeypress
suffix:semicolon
id|lastscancode
op_assign
id|scancode
suffix:semicolon
multiline_comment|/*  printk(&quot;scan: %02x, lastscan: %02X, prev_scancode: %02X&bslash;n&quot;,scancode,lastscancode,prev_scancode); */
r_if
c_cond
(paren
id|prev_scancode
op_eq
id|APOLLO_KBD_MODE_CHANGE
)paren
(brace
id|kbd_mode
op_assign
id|scancode
suffix:semicolon
multiline_comment|/*&t;&t;printk(&quot;modechange: %d&bslash;n&quot;,scancode); */
)brace
r_else
r_if
c_cond
(paren
(paren
id|scancode
op_amp
(paren
op_complement
id|BREAK_FLAG
)paren
)paren
op_eq
id|DNKEY_CAPS
)paren
(brace
multiline_comment|/* printk(&quot;handle_scancode: %02x&bslash;n&quot;,DNKEY_CAPS); */
id|handle_scancode
c_func
(paren
id|DNKEY_CAPS
comma
l_int|1
)paren
suffix:semicolon
multiline_comment|/*    printk(&quot;handle_scancode: %02x&bslash;n&quot;,BREAK_FLAG | DNKEY_CAPS); */
id|handle_scancode
c_func
(paren
id|DNKEY_CAPS
comma
l_int|0
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
(paren
id|scancode
op_eq
id|DNKEY_REPEAT
)paren
op_logical_and
(paren
id|prev_scancode
OL
l_int|0x7e
)paren
op_logical_and
op_logical_neg
(paren
id|prev_scancode
op_eq
id|DNKEY_CTRL
op_logical_or
id|prev_scancode
op_eq
id|DNKEY_LSHIFT
op_logical_or
id|prev_scancode
op_eq
id|DNKEY_RSHIFT
op_logical_or
id|prev_scancode
op_eq
id|DNKEY_REPT
op_logical_or
id|prev_scancode
op_eq
id|DNKEY_LALT
op_logical_or
id|prev_scancode
op_eq
id|DNKEY_RALT
)paren
)paren
(brace
r_if
c_cond
(paren
id|time_after
c_func
(paren
id|jiffies
comma
id|lastkeypress
op_plus
id|DNKEY_REPEAT_DELAY
)paren
)paren
(brace
multiline_comment|/*    &t;printk(&quot;handle_scancode: %02x&bslash;n&quot;,prev_scancode); */
id|handle_scancode
c_func
(paren
id|prev_scancode
comma
l_int|1
)paren
suffix:semicolon
)brace
id|lastscancode
op_assign
id|prev_scancode
suffix:semicolon
)brace
r_else
(brace
multiline_comment|/*    &t;printk(&quot;handle_scancode: %02x&bslash;n&quot;,scancode);  */
id|handle_scancode
c_func
(paren
id|scancode
op_amp
op_complement
id|BREAK_FLAG
comma
op_logical_neg
(paren
id|scancode
op_amp
id|BREAK_FLAG
)paren
)paren
suffix:semicolon
id|lastkeypress
op_assign
id|jiffies
suffix:semicolon
)brace
)brace
DECL|function|dn_keyb_process_mouse_event
r_static
r_void
id|dn_keyb_process_mouse_event
c_func
(paren
r_int
r_char
id|mouse_data
)paren
(brace
r_static
r_int
id|mouse_byte_count
op_assign
l_int|0
suffix:semicolon
r_static
id|u_char
id|mouse_packet
(braket
l_int|3
)braket
suffix:semicolon
r_int
id|mouse_buttons
suffix:semicolon
id|mouse_packet
(braket
id|mouse_byte_count
op_increment
)braket
op_assign
id|mouse_data
suffix:semicolon
r_if
c_cond
(paren
id|mouse_byte_count
op_eq
l_int|3
)paren
(brace
r_if
c_cond
(paren
id|mouse_packet
(braket
l_int|0
)braket
op_eq
id|APOLLO_KBD_MODE_CHANGE
)paren
(brace
id|kbd_mode
op_assign
id|mouse_packet
(braket
l_int|1
)braket
suffix:semicolon
id|mouse_byte_count
op_assign
l_int|0
suffix:semicolon
multiline_comment|/*&t;&t;&t;printk(&quot;modechange: %d&bslash;n&quot;,mouse_packet[1]); */
r_if
c_cond
(paren
id|kbd_mode
op_eq
id|APOLLO_KBD_MODE_KEYB
)paren
(brace
id|dn_keyb_process_key_event
c_func
(paren
id|mouse_packet
(braket
l_int|2
)braket
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
(paren
id|mouse_packet
(braket
l_int|0
)braket
op_amp
l_int|0x8f
)paren
op_eq
l_int|0x80
)paren
(brace
r_if
c_cond
(paren
id|mouse_update_allowed
)paren
(brace
id|mouse_ready
op_assign
l_int|1
suffix:semicolon
id|mouse_buttons
op_assign
(paren
id|mouse_packet
(braket
l_int|0
)braket
op_rshift
l_int|4
)paren
op_amp
l_int|0x7
suffix:semicolon
id|mouse_dx
op_add_assign
id|mouse_packet
(braket
l_int|1
)braket
op_eq
l_int|0xff
ques
c_cond
l_int|0
suffix:colon
(paren
r_int
r_char
)paren
id|mouse_packet
(braket
l_int|1
)braket
suffix:semicolon
id|mouse_dy
op_add_assign
id|mouse_packet
(braket
l_int|2
)braket
op_eq
l_int|0xff
ques
c_cond
l_int|0
suffix:colon
(paren
r_int
r_char
)paren
id|mouse_packet
(braket
l_int|2
)braket
suffix:semicolon
id|wake_up_interruptible
c_func
(paren
op_amp
id|mouse_wait
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mouse_dx
OL
op_minus
l_int|2048
)paren
id|mouse_dx
op_assign
op_minus
l_int|2048
suffix:semicolon
r_else
r_if
c_cond
(paren
id|mouse_dx
OG
l_int|2048
)paren
id|mouse_dx
op_assign
l_int|2048
suffix:semicolon
r_if
c_cond
(paren
id|mouse_dy
OL
op_minus
l_int|2048
)paren
id|mouse_dy
op_assign
op_minus
l_int|2048
suffix:semicolon
r_else
r_if
c_cond
(paren
id|mouse_dy
OG
l_int|2048
)paren
id|mouse_dy
op_assign
l_int|2048
suffix:semicolon
id|kill_fasync
c_func
(paren
op_amp
id|mouse_fasyncptr
comma
id|SIGIO
comma
id|POLL_IN
)paren
suffix:semicolon
)brace
id|mouse_byte_count
op_assign
l_int|0
suffix:semicolon
multiline_comment|/*&t;&t;&t;printk(&quot;mouse: %d, %d, %x&bslash;n&quot;,mouse_x,mouse_y,buttons); */
)brace
)brace
)brace
DECL|function|dn_keyb_int
r_static
r_void
id|dn_keyb_int
c_func
(paren
r_int
id|irq
comma
r_void
op_star
id|dummy
comma
r_struct
id|pt_regs
op_star
id|fp
)paren
(brace
r_int
r_char
id|data
suffix:semicolon
r_int
r_int
id|flags
suffix:semicolon
r_int
id|scn2681_ints
suffix:semicolon
r_do
(brace
id|scn2681_ints
op_assign
id|sio01.isr_imr
op_amp
l_int|3
suffix:semicolon
r_if
c_cond
(paren
id|scn2681_ints
op_amp
l_int|2
)paren
(brace
id|data
op_assign
id|sio01.rhra_thra
suffix:semicolon
macro_line|#if 0
r_if
c_cond
(paren
id|debug_buf_count
OL
l_int|4096
)paren
(brace
id|debug_buf
(braket
id|debug_buf_count
op_increment
)braket
op_assign
id|data
suffix:semicolon
id|debug_buffer_updated
op_assign
id|jiffies
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|debug_timer_running
)paren
(brace
id|debug_keyb_timer.expires
op_assign
id|jiffies
op_plus
l_int|10
suffix:semicolon
id|add_timer
c_func
(paren
op_amp
id|debug_keyb_timer
)paren
suffix:semicolon
id|debug_timer_running
op_assign
l_int|1
suffix:semicolon
)brace
)brace
r_else
id|debug_buf_overrun
op_assign
l_int|1
suffix:semicolon
macro_line|#endif
r_if
c_cond
(paren
id|sio01.sra_csra
op_amp
l_int|0x10
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;whaa overrun !&bslash;n&quot;
)paren
suffix:semicolon
r_continue
suffix:semicolon
)brace
r_if
c_cond
(paren
id|kbd_mode
op_eq
id|APOLLO_KBD_MODE_KEYB
)paren
(brace
id|dn_keyb_process_key_event
c_func
(paren
id|data
)paren
suffix:semicolon
)brace
r_else
id|dn_keyb_process_mouse_event
c_func
(paren
id|data
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|scn2681_ints
op_amp
l_int|1
)paren
(brace
id|save_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
id|cli
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|keyb_cmd_write
op_ne
id|keyb_cmd_read
)paren
(brace
id|sio01.rhra_thra
op_assign
id|keyb_cmds
(braket
id|keyb_cmd_read
op_increment
)braket
suffix:semicolon
r_if
c_cond
(paren
id|keyb_cmd_read
op_eq
id|APOLLO_KEYB_CMD_ENTRIES
)paren
(brace
id|keyb_cmd_read
op_assign
l_int|0
suffix:semicolon
)brace
id|keyb_cmd_transmit
op_assign
l_int|1
suffix:semicolon
)brace
r_else
(brace
id|keyb_cmd_transmit
op_assign
l_int|0
suffix:semicolon
id|sio01.BRGtest_cra
op_assign
l_int|9
suffix:semicolon
)brace
id|restore_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
)brace
)brace
r_while
c_loop
(paren
id|scn2681_ints
)paren
(brace
suffix:semicolon
)brace
)brace
DECL|function|write_keyb_cmd
r_void
id|write_keyb_cmd
c_func
(paren
id|u_short
id|length
comma
id|u_char
op_star
id|cmd
)paren
(brace
r_int
r_int
id|flags
suffix:semicolon
r_if
c_cond
(paren
(paren
id|keyb_cmd_write
op_eq
id|keyb_cmd_read
)paren
op_logical_and
id|keyb_cmd_transmit
)paren
(brace
r_return
suffix:semicolon
)brace
id|save_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
id|cli
c_func
(paren
)paren
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
id|length
suffix:semicolon
id|length
op_decrement
)paren
(brace
id|keyb_cmds
(braket
id|keyb_cmd_write
op_increment
)braket
op_assign
op_star
(paren
id|cmd
op_increment
)paren
suffix:semicolon
r_if
c_cond
(paren
id|keyb_cmd_write
op_eq
id|keyb_cmd_read
)paren
(brace
r_return
suffix:semicolon
)brace
r_if
c_cond
(paren
id|keyb_cmd_write
op_eq
id|APOLLO_KEYB_CMD_ENTRIES
)paren
(brace
id|keyb_cmd_write
op_assign
l_int|0
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
op_logical_neg
id|keyb_cmd_transmit
)paren
(brace
id|sio01.BRGtest_cra
op_assign
l_int|5
suffix:semicolon
)brace
id|restore_flags
c_func
(paren
id|flags
)paren
suffix:semicolon
)brace
DECL|variable|apollo_mouse
r_static
r_struct
id|busmouse
id|apollo_mouse
op_assign
(brace
id|APOLLO_MOUSE_MINOR
comma
l_string|&quot;apollomouse&quot;
comma
id|THIS_MODULE
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|7
)brace
suffix:semicolon
DECL|function|dn_keyb_init
r_int
id|__init
(def_block
id|dn_keyb_init
c_func
(paren
r_void
)paren
(brace
multiline_comment|/*  printk(&quot;dn_keyb_init&bslash;n&quot;); */
id|memcpy
c_func
(paren
id|key_maps
(braket
l_int|0
)braket
comma
id|dnplain_map
comma
r_sizeof
(paren
id|plain_map
)paren
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|key_maps
(braket
l_int|1
)braket
comma
id|dnshift_map
comma
r_sizeof
(paren
id|plain_map
)paren
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|key_maps
(braket
l_int|2
)braket
comma
id|dnaltgr_map
comma
r_sizeof
(paren
id|plain_map
)paren
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|key_maps
(braket
l_int|4
)braket
comma
id|dnctrl_map
comma
r_sizeof
(paren
id|plain_map
)paren
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|key_maps
(braket
l_int|5
)braket
comma
id|dnshift_ctrl_map
comma
r_sizeof
(paren
id|plain_map
)paren
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|key_maps
(braket
l_int|8
)braket
comma
id|dnalt_map
comma
r_sizeof
(paren
id|plain_map
)paren
)paren
suffix:semicolon
id|memcpy
c_func
(paren
id|key_maps
(braket
l_int|12
)braket
comma
id|dnctrl_alt_map
comma
r_sizeof
(paren
id|plain_map
)paren
)paren
suffix:semicolon
id|msedev
op_assign
id|register_busmouse
c_func
(paren
op_amp
id|apollo_mouse
)paren
suffix:semicolon
r_if
c_cond
(paren
id|msedev
OL
l_int|0
)paren
id|printk
c_func
(paren
id|KERN_WARNING
l_string|&quot;Unable to install Apollo mouse driver.&bslash;n&quot;
)paren
suffix:semicolon
r_else
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;Apollo mouse installed.&bslash;n&quot;
)paren
suffix:semicolon
multiline_comment|/* program UpDownMode */
r_while
c_loop
(paren
op_logical_neg
(paren
id|sio01.sra_csra
op_amp
l_int|0x4
)paren
)paren
(brace
suffix:semicolon
)brace
id|sio01.rhra_thra
op_assign
l_int|0xff
suffix:semicolon
r_while
c_loop
(paren
op_logical_neg
(paren
id|sio01.sra_csra
op_amp
l_int|0x4
)paren
)paren
(brace
suffix:semicolon
)brace
id|sio01.rhra_thra
op_assign
l_int|0x1
suffix:semicolon
id|request_irq
c_func
(paren
l_int|1
comma
id|dn_keyb_int
comma
l_int|0
comma
l_int|NULL
comma
l_int|NULL
)paren
suffix:semicolon
multiline_comment|/* enable receive int on DUART */
id|sio01.isr_imr
op_assign
l_int|3
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
)def_block
DECL|function|dn_dummy_kbdrate
r_int
id|dn_dummy_kbdrate
c_func
(paren
r_struct
id|kbd_repeat
op_star
id|k
)paren
(brace
id|printk
c_func
(paren
l_string|&quot;dn_dummy_kbdrate&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
eof
