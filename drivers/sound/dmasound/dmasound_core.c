multiline_comment|/*&n; *  linux/drivers/sound/dmasound/dmasound_core.c&n; *&n; *&n; *  OSS/Free compatible Atari TT/Falcon and Amiga DMA sound driver for&n; *  Linux/m68k&n; *  Extended to support Power Macintosh for Linux/ppc by Paul Mackerras&n; *&n; *  (c) 1995 by Michael Schlueter &amp; Michael Marte&n; *&n; *  Michael Schlueter (michael@duck.syd.de) did the basic structure of the VFS&n; *  interface and the u-law to signed byte conversion.&n; *&n; *  Michael Marte (marte@informatik.uni-muenchen.de) did the sound queue,&n; *  /dev/mixer, /dev/sndstat and complemented the VFS interface. He would like&n; *  to thank:&n; *    - Michael Schlueter for initial ideas and documentation on the MFP and&n; *&t;the DMA sound hardware.&n; *    - Therapy? for their CD &squot;Troublegum&squot; which really made me rock.&n; *&n; *  /dev/sndstat is based on code by Hannu Savolainen, the author of the&n; *  VoxWare family of drivers.&n; *&n; *  This file is subject to the terms and conditions of the GNU General Public&n; *  License.  See the file COPYING in the main directory of this archive&n; *  for more details.&n; *&n; *  History:&n; *&n; *&t;1995/8/25&t;First release&n; *&n; *&t;1995/9/02&t;Roman Hodek:&n; *&t;&t;&t;  - Fixed atari_stram_alloc() call, the timer&n; *&t;&t;&t;    programming and several race conditions&n; *&t;1995/9/14&t;Roman Hodek:&n; *&t;&t;&t;  - After some discussion with Michael Schlueter,&n; *&t;&t;&t;    revised the interrupt disabling&n; *&t;&t;&t;  - Slightly speeded up U8-&gt;S8 translation by using&n; *&t;&t;&t;    long operations where possible&n; *&t;&t;&t;  - Added 4:3 interpolation for /dev/audio&n; *&n; *&t;1995/9/20&t;Torsten Scherer:&n; *&t;&t;&t;  - Fixed a bug in sq_write and changed /dev/audio&n; *&t;&t;&t;    converting to play at 12517Hz instead of 6258Hz.&n; *&n; *&t;1995/9/23&t;Torsten Scherer:&n; *&t;&t;&t;  - Changed sq_interrupt() and sq_play() to pre-program&n; *&t;&t;&t;    the DMA for another frame while there&squot;s still one&n; *&t;&t;&t;    running. This allows the IRQ response to be&n; *&t;&t;&t;    arbitrarily delayed and playing will still continue.&n; *&n; *&t;1995/10/14&t;Guenther Kelleter, Torsten Scherer:&n; *&t;&t;&t;  - Better support for Falcon audio (the Falcon doesn&squot;t&n; *&t;&t;&t;    raise an IRQ at the end of a frame, but at the&n; *&t;&t;&t;    beginning instead!). uses &squot;if (codec_dma)&squot; in lots&n; *&t;&t;&t;    of places to simply switch between Falcon and TT&n; *&t;&t;&t;    code.&n; *&n; *&t;1995/11/06&t;Torsten Scherer:&n; *&t;&t;&t;  - Started introducing a hardware abstraction scheme&n; *&t;&t;&t;    (may perhaps also serve for Amigas?)&n; *&t;&t;&t;  - Can now play samples at almost all frequencies by&n; *&t;&t;&t;    means of a more generalized expand routine&n; *&t;&t;&t;  - Takes a good deal of care to cut data only at&n; *&t;&t;&t;    sample sizes&n; *&t;&t;&t;  - Buffer size is now a kernel runtime option&n; *&t;&t;&t;  - Implemented fsync() &amp; several minor improvements&n; *&t;&t;&t;Guenther Kelleter:&n; *&t;&t;&t;  - Useful hints and bug fixes&n; *&t;&t;&t;  - Cross-checked it for Falcons&n; *&n; *&t;1996/3/9&t;Geert Uytterhoeven:&n; *&t;&t;&t;  - Support added for Amiga, A-law, 16-bit little&n; *&t;&t;&t;    endian.&n; *&t;&t;&t;  - Unification to drivers/sound/dmasound.c.&n; *&n; *&t;1996/4/6&t;Martin Mitchell:&n; *&t;&t;&t;  - Updated to 1.3 kernel.&n; *&n; *&t;1996/6/13       Topi Kanerva:&n; *&t;&t;&t;  - Fixed things that were broken (mainly the amiga&n; *&t;&t;&t;    14-bit routines)&n; *&t;&t;&t;  - /dev/sndstat shows now the real hardware frequency&n; *&t;&t;&t;  - The lowpass filter is disabled by default now&n; *&n; *&t;1996/9/25&t;Geert Uytterhoeven:&n; *&t;&t;&t;  - Modularization&n; *&n; *&t;1998/6/10&t;Andreas Schwab:&n; *&t;&t;&t;  - Converted to use sound_core&n; *&n; *&t;1999/12/28&t;Richard Zidlicky:&n; *&t;&t;&t;  - Added support for Q40&n; *&n; *&t;2000/2/27&t;Geert Uytterhoeven:&n; *&t;&t;&t;  - Clean up and split the code into 4 parts:&n; *&t;&t;&t;      o dmasound_core: machine-independent code&n; *&t;&t;&t;      o dmasound_atari: Atari TT and Falcon support&n; *&t;&t;&t;      o dmasound_awacs: Apple PowerMac support&n; *&t;&t;&t;      o dmasound_paula: Amiga support&n; *&n; *&t;2000/3/25&t;Geert Uytterhoeven:&n; *&t;&t;&t;  - Integration of dmasound_q40&n; *&t;&t;&t;  - Small clean ups&n; */
macro_line|#include &lt;linux/module.h&gt;
macro_line|#include &lt;linux/malloc.h&gt;
macro_line|#include &lt;linux/sound.h&gt;
macro_line|#include &lt;linux/init.h&gt;
macro_line|#include &lt;linux/soundcard.h&gt;
macro_line|#include &lt;linux/smp_lock.h&gt;
macro_line|#include &lt;asm/uaccess.h&gt;
macro_line|#include &quot;dmasound.h&quot;
multiline_comment|/*&n;     *  Declarations&n;     */
DECL|variable|dmasound_catchRadius
r_int
id|dmasound_catchRadius
op_assign
l_int|0
suffix:semicolon
DECL|variable|numWriteBufs
r_static
r_int
r_int
id|numWriteBufs
op_assign
l_int|4
suffix:semicolon
DECL|variable|writeBufSize
r_static
r_int
r_int
id|writeBufSize
op_assign
l_int|32
suffix:semicolon
multiline_comment|/* in KB! */
macro_line|#ifdef HAS_RECORD
DECL|variable|numReadBufs
r_static
r_int
r_int
id|numReadBufs
op_assign
l_int|4
suffix:semicolon
DECL|variable|readBufSize
r_static
r_int
r_int
id|readBufSize
op_assign
l_int|32
suffix:semicolon
multiline_comment|/* in KB! */
macro_line|#endif
id|MODULE_PARM
c_func
(paren
id|dmasound_catchRadius
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|numWriteBufs
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|writeBufSize
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|numReadBufs
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
id|MODULE_PARM
c_func
(paren
id|readBufSize
comma
l_string|&quot;i&quot;
)paren
suffix:semicolon
macro_line|#ifdef MODULE
DECL|variable|sq_unit
r_static
r_int
id|sq_unit
op_assign
op_minus
l_int|1
suffix:semicolon
DECL|variable|mixer_unit
r_static
r_int
id|mixer_unit
op_assign
op_minus
l_int|1
suffix:semicolon
DECL|variable|state_unit
r_static
r_int
id|state_unit
op_assign
op_minus
l_int|1
suffix:semicolon
DECL|variable|irq_installed
r_static
r_int
id|irq_installed
op_assign
l_int|0
suffix:semicolon
macro_line|#endif /* MODULE */
multiline_comment|/*&n;     *  Conversion tables&n;     */
macro_line|#ifdef HAS_8BIT_TABLES
multiline_comment|/* 8 bit mu-law */
DECL|variable|dmasound_ulaw2dma8
r_char
id|dmasound_ulaw2dma8
(braket
)braket
op_assign
(brace
op_minus
l_int|126
comma
op_minus
l_int|122
comma
op_minus
l_int|118
comma
op_minus
l_int|114
comma
op_minus
l_int|110
comma
op_minus
l_int|106
comma
op_minus
l_int|102
comma
op_minus
l_int|98
comma
op_minus
l_int|94
comma
op_minus
l_int|90
comma
op_minus
l_int|86
comma
op_minus
l_int|82
comma
op_minus
l_int|78
comma
op_minus
l_int|74
comma
op_minus
l_int|70
comma
op_minus
l_int|66
comma
op_minus
l_int|63
comma
op_minus
l_int|61
comma
op_minus
l_int|59
comma
op_minus
l_int|57
comma
op_minus
l_int|55
comma
op_minus
l_int|53
comma
op_minus
l_int|51
comma
op_minus
l_int|49
comma
op_minus
l_int|47
comma
op_minus
l_int|45
comma
op_minus
l_int|43
comma
op_minus
l_int|41
comma
op_minus
l_int|39
comma
op_minus
l_int|37
comma
op_minus
l_int|35
comma
op_minus
l_int|33
comma
op_minus
l_int|31
comma
op_minus
l_int|30
comma
op_minus
l_int|29
comma
op_minus
l_int|28
comma
op_minus
l_int|27
comma
op_minus
l_int|26
comma
op_minus
l_int|25
comma
op_minus
l_int|24
comma
op_minus
l_int|23
comma
op_minus
l_int|22
comma
op_minus
l_int|21
comma
op_minus
l_int|20
comma
op_minus
l_int|19
comma
op_minus
l_int|18
comma
op_minus
l_int|17
comma
op_minus
l_int|16
comma
op_minus
l_int|16
comma
op_minus
l_int|15
comma
op_minus
l_int|15
comma
op_minus
l_int|14
comma
op_minus
l_int|14
comma
op_minus
l_int|13
comma
op_minus
l_int|13
comma
op_minus
l_int|12
comma
op_minus
l_int|12
comma
op_minus
l_int|11
comma
op_minus
l_int|11
comma
op_minus
l_int|10
comma
op_minus
l_int|10
comma
op_minus
l_int|9
comma
op_minus
l_int|9
comma
op_minus
l_int|8
comma
op_minus
l_int|8
comma
op_minus
l_int|8
comma
op_minus
l_int|7
comma
op_minus
l_int|7
comma
op_minus
l_int|7
comma
op_minus
l_int|7
comma
op_minus
l_int|6
comma
op_minus
l_int|6
comma
op_minus
l_int|6
comma
op_minus
l_int|6
comma
op_minus
l_int|5
comma
op_minus
l_int|5
comma
op_minus
l_int|5
comma
op_minus
l_int|5
comma
op_minus
l_int|4
comma
op_minus
l_int|4
comma
op_minus
l_int|4
comma
op_minus
l_int|4
comma
op_minus
l_int|4
comma
op_minus
l_int|4
comma
op_minus
l_int|3
comma
op_minus
l_int|3
comma
op_minus
l_int|3
comma
op_minus
l_int|3
comma
op_minus
l_int|3
comma
op_minus
l_int|3
comma
op_minus
l_int|3
comma
op_minus
l_int|3
comma
op_minus
l_int|2
comma
op_minus
l_int|2
comma
op_minus
l_int|2
comma
op_minus
l_int|2
comma
op_minus
l_int|2
comma
op_minus
l_int|2
comma
op_minus
l_int|2
comma
op_minus
l_int|2
comma
op_minus
l_int|2
comma
op_minus
l_int|2
comma
op_minus
l_int|2
comma
op_minus
l_int|2
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
l_int|0
comma
l_int|125
comma
l_int|121
comma
l_int|117
comma
l_int|113
comma
l_int|109
comma
l_int|105
comma
l_int|101
comma
l_int|97
comma
l_int|93
comma
l_int|89
comma
l_int|85
comma
l_int|81
comma
l_int|77
comma
l_int|73
comma
l_int|69
comma
l_int|65
comma
l_int|62
comma
l_int|60
comma
l_int|58
comma
l_int|56
comma
l_int|54
comma
l_int|52
comma
l_int|50
comma
l_int|48
comma
l_int|46
comma
l_int|44
comma
l_int|42
comma
l_int|40
comma
l_int|38
comma
l_int|36
comma
l_int|34
comma
l_int|32
comma
l_int|30
comma
l_int|29
comma
l_int|28
comma
l_int|27
comma
l_int|26
comma
l_int|25
comma
l_int|24
comma
l_int|23
comma
l_int|22
comma
l_int|21
comma
l_int|20
comma
l_int|19
comma
l_int|18
comma
l_int|17
comma
l_int|16
comma
l_int|15
comma
l_int|15
comma
l_int|14
comma
l_int|14
comma
l_int|13
comma
l_int|13
comma
l_int|12
comma
l_int|12
comma
l_int|11
comma
l_int|11
comma
l_int|10
comma
l_int|10
comma
l_int|9
comma
l_int|9
comma
l_int|8
comma
l_int|8
comma
l_int|7
comma
l_int|7
comma
l_int|7
comma
l_int|6
comma
l_int|6
comma
l_int|6
comma
l_int|6
comma
l_int|5
comma
l_int|5
comma
l_int|5
comma
l_int|5
comma
l_int|4
comma
l_int|4
comma
l_int|4
comma
l_int|4
comma
l_int|3
comma
l_int|3
comma
l_int|3
comma
l_int|3
comma
l_int|3
comma
l_int|3
comma
l_int|2
comma
l_int|2
comma
l_int|2
comma
l_int|2
comma
l_int|2
comma
l_int|2
comma
l_int|2
comma
l_int|2
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
)brace
suffix:semicolon
multiline_comment|/* 8 bit A-law */
DECL|variable|dmasound_alaw2dma8
r_char
id|dmasound_alaw2dma8
(braket
)braket
op_assign
(brace
op_minus
l_int|22
comma
op_minus
l_int|21
comma
op_minus
l_int|24
comma
op_minus
l_int|23
comma
op_minus
l_int|18
comma
op_minus
l_int|17
comma
op_minus
l_int|20
comma
op_minus
l_int|19
comma
op_minus
l_int|30
comma
op_minus
l_int|29
comma
op_minus
l_int|32
comma
op_minus
l_int|31
comma
op_minus
l_int|26
comma
op_minus
l_int|25
comma
op_minus
l_int|28
comma
op_minus
l_int|27
comma
op_minus
l_int|11
comma
op_minus
l_int|11
comma
op_minus
l_int|12
comma
op_minus
l_int|12
comma
op_minus
l_int|9
comma
op_minus
l_int|9
comma
op_minus
l_int|10
comma
op_minus
l_int|10
comma
op_minus
l_int|15
comma
op_minus
l_int|15
comma
op_minus
l_int|16
comma
op_minus
l_int|16
comma
op_minus
l_int|13
comma
op_minus
l_int|13
comma
op_minus
l_int|14
comma
op_minus
l_int|14
comma
op_minus
l_int|86
comma
op_minus
l_int|82
comma
op_minus
l_int|94
comma
op_minus
l_int|90
comma
op_minus
l_int|70
comma
op_minus
l_int|66
comma
op_minus
l_int|78
comma
op_minus
l_int|74
comma
op_minus
l_int|118
comma
op_minus
l_int|114
comma
op_minus
l_int|126
comma
op_minus
l_int|122
comma
op_minus
l_int|102
comma
op_minus
l_int|98
comma
op_minus
l_int|110
comma
op_minus
l_int|106
comma
op_minus
l_int|43
comma
op_minus
l_int|41
comma
op_minus
l_int|47
comma
op_minus
l_int|45
comma
op_minus
l_int|35
comma
op_minus
l_int|33
comma
op_minus
l_int|39
comma
op_minus
l_int|37
comma
op_minus
l_int|59
comma
op_minus
l_int|57
comma
op_minus
l_int|63
comma
op_minus
l_int|61
comma
op_minus
l_int|51
comma
op_minus
l_int|49
comma
op_minus
l_int|55
comma
op_minus
l_int|53
comma
op_minus
l_int|2
comma
op_minus
l_int|2
comma
op_minus
l_int|2
comma
op_minus
l_int|2
comma
op_minus
l_int|2
comma
op_minus
l_int|2
comma
op_minus
l_int|2
comma
op_minus
l_int|2
comma
op_minus
l_int|2
comma
op_minus
l_int|2
comma
op_minus
l_int|2
comma
op_minus
l_int|2
comma
op_minus
l_int|2
comma
op_minus
l_int|2
comma
op_minus
l_int|2
comma
op_minus
l_int|2
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|1
comma
op_minus
l_int|6
comma
op_minus
l_int|6
comma
op_minus
l_int|6
comma
op_minus
l_int|6
comma
op_minus
l_int|5
comma
op_minus
l_int|5
comma
op_minus
l_int|5
comma
op_minus
l_int|5
comma
op_minus
l_int|8
comma
op_minus
l_int|8
comma
op_minus
l_int|8
comma
op_minus
l_int|8
comma
op_minus
l_int|7
comma
op_minus
l_int|7
comma
op_minus
l_int|7
comma
op_minus
l_int|7
comma
op_minus
l_int|3
comma
op_minus
l_int|3
comma
op_minus
l_int|3
comma
op_minus
l_int|3
comma
op_minus
l_int|3
comma
op_minus
l_int|3
comma
op_minus
l_int|3
comma
op_minus
l_int|3
comma
op_minus
l_int|4
comma
op_minus
l_int|4
comma
op_minus
l_int|4
comma
op_minus
l_int|4
comma
op_minus
l_int|4
comma
op_minus
l_int|4
comma
op_minus
l_int|4
comma
op_minus
l_int|4
comma
l_int|21
comma
l_int|20
comma
l_int|23
comma
l_int|22
comma
l_int|17
comma
l_int|16
comma
l_int|19
comma
l_int|18
comma
l_int|29
comma
l_int|28
comma
l_int|31
comma
l_int|30
comma
l_int|25
comma
l_int|24
comma
l_int|27
comma
l_int|26
comma
l_int|10
comma
l_int|10
comma
l_int|11
comma
l_int|11
comma
l_int|8
comma
l_int|8
comma
l_int|9
comma
l_int|9
comma
l_int|14
comma
l_int|14
comma
l_int|15
comma
l_int|15
comma
l_int|12
comma
l_int|12
comma
l_int|13
comma
l_int|13
comma
l_int|86
comma
l_int|82
comma
l_int|94
comma
l_int|90
comma
l_int|70
comma
l_int|66
comma
l_int|78
comma
l_int|74
comma
l_int|118
comma
l_int|114
comma
l_int|126
comma
l_int|122
comma
l_int|102
comma
l_int|98
comma
l_int|110
comma
l_int|106
comma
l_int|43
comma
l_int|41
comma
l_int|47
comma
l_int|45
comma
l_int|35
comma
l_int|33
comma
l_int|39
comma
l_int|37
comma
l_int|59
comma
l_int|57
comma
l_int|63
comma
l_int|61
comma
l_int|51
comma
l_int|49
comma
l_int|55
comma
l_int|53
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|5
comma
l_int|5
comma
l_int|5
comma
l_int|5
comma
l_int|4
comma
l_int|4
comma
l_int|4
comma
l_int|4
comma
l_int|7
comma
l_int|7
comma
l_int|7
comma
l_int|7
comma
l_int|6
comma
l_int|6
comma
l_int|6
comma
l_int|6
comma
l_int|2
comma
l_int|2
comma
l_int|2
comma
l_int|2
comma
l_int|2
comma
l_int|2
comma
l_int|2
comma
l_int|2
comma
l_int|3
comma
l_int|3
comma
l_int|3
comma
l_int|3
comma
l_int|3
comma
l_int|3
comma
l_int|3
comma
l_int|3
)brace
suffix:semicolon
macro_line|#endif /* HAS_8BIT_TABLES */
macro_line|#ifdef HAS_16BIT_TABLES
multiline_comment|/* 16 bit mu-law */
DECL|variable|dmasound_ulaw2dma16
r_int
id|dmasound_ulaw2dma16
(braket
)braket
op_assign
(brace
op_minus
l_int|32124
comma
op_minus
l_int|31100
comma
op_minus
l_int|30076
comma
op_minus
l_int|29052
comma
op_minus
l_int|28028
comma
op_minus
l_int|27004
comma
op_minus
l_int|25980
comma
op_minus
l_int|24956
comma
op_minus
l_int|23932
comma
op_minus
l_int|22908
comma
op_minus
l_int|21884
comma
op_minus
l_int|20860
comma
op_minus
l_int|19836
comma
op_minus
l_int|18812
comma
op_minus
l_int|17788
comma
op_minus
l_int|16764
comma
op_minus
l_int|15996
comma
op_minus
l_int|15484
comma
op_minus
l_int|14972
comma
op_minus
l_int|14460
comma
op_minus
l_int|13948
comma
op_minus
l_int|13436
comma
op_minus
l_int|12924
comma
op_minus
l_int|12412
comma
op_minus
l_int|11900
comma
op_minus
l_int|11388
comma
op_minus
l_int|10876
comma
op_minus
l_int|10364
comma
op_minus
l_int|9852
comma
op_minus
l_int|9340
comma
op_minus
l_int|8828
comma
op_minus
l_int|8316
comma
op_minus
l_int|7932
comma
op_minus
l_int|7676
comma
op_minus
l_int|7420
comma
op_minus
l_int|7164
comma
op_minus
l_int|6908
comma
op_minus
l_int|6652
comma
op_minus
l_int|6396
comma
op_minus
l_int|6140
comma
op_minus
l_int|5884
comma
op_minus
l_int|5628
comma
op_minus
l_int|5372
comma
op_minus
l_int|5116
comma
op_minus
l_int|4860
comma
op_minus
l_int|4604
comma
op_minus
l_int|4348
comma
op_minus
l_int|4092
comma
op_minus
l_int|3900
comma
op_minus
l_int|3772
comma
op_minus
l_int|3644
comma
op_minus
l_int|3516
comma
op_minus
l_int|3388
comma
op_minus
l_int|3260
comma
op_minus
l_int|3132
comma
op_minus
l_int|3004
comma
op_minus
l_int|2876
comma
op_minus
l_int|2748
comma
op_minus
l_int|2620
comma
op_minus
l_int|2492
comma
op_minus
l_int|2364
comma
op_minus
l_int|2236
comma
op_minus
l_int|2108
comma
op_minus
l_int|1980
comma
op_minus
l_int|1884
comma
op_minus
l_int|1820
comma
op_minus
l_int|1756
comma
op_minus
l_int|1692
comma
op_minus
l_int|1628
comma
op_minus
l_int|1564
comma
op_minus
l_int|1500
comma
op_minus
l_int|1436
comma
op_minus
l_int|1372
comma
op_minus
l_int|1308
comma
op_minus
l_int|1244
comma
op_minus
l_int|1180
comma
op_minus
l_int|1116
comma
op_minus
l_int|1052
comma
op_minus
l_int|988
comma
op_minus
l_int|924
comma
op_minus
l_int|876
comma
op_minus
l_int|844
comma
op_minus
l_int|812
comma
op_minus
l_int|780
comma
op_minus
l_int|748
comma
op_minus
l_int|716
comma
op_minus
l_int|684
comma
op_minus
l_int|652
comma
op_minus
l_int|620
comma
op_minus
l_int|588
comma
op_minus
l_int|556
comma
op_minus
l_int|524
comma
op_minus
l_int|492
comma
op_minus
l_int|460
comma
op_minus
l_int|428
comma
op_minus
l_int|396
comma
op_minus
l_int|372
comma
op_minus
l_int|356
comma
op_minus
l_int|340
comma
op_minus
l_int|324
comma
op_minus
l_int|308
comma
op_minus
l_int|292
comma
op_minus
l_int|276
comma
op_minus
l_int|260
comma
op_minus
l_int|244
comma
op_minus
l_int|228
comma
op_minus
l_int|212
comma
op_minus
l_int|196
comma
op_minus
l_int|180
comma
op_minus
l_int|164
comma
op_minus
l_int|148
comma
op_minus
l_int|132
comma
op_minus
l_int|120
comma
op_minus
l_int|112
comma
op_minus
l_int|104
comma
op_minus
l_int|96
comma
op_minus
l_int|88
comma
op_minus
l_int|80
comma
op_minus
l_int|72
comma
op_minus
l_int|64
comma
op_minus
l_int|56
comma
op_minus
l_int|48
comma
op_minus
l_int|40
comma
op_minus
l_int|32
comma
op_minus
l_int|24
comma
op_minus
l_int|16
comma
op_minus
l_int|8
comma
l_int|0
comma
l_int|32124
comma
l_int|31100
comma
l_int|30076
comma
l_int|29052
comma
l_int|28028
comma
l_int|27004
comma
l_int|25980
comma
l_int|24956
comma
l_int|23932
comma
l_int|22908
comma
l_int|21884
comma
l_int|20860
comma
l_int|19836
comma
l_int|18812
comma
l_int|17788
comma
l_int|16764
comma
l_int|15996
comma
l_int|15484
comma
l_int|14972
comma
l_int|14460
comma
l_int|13948
comma
l_int|13436
comma
l_int|12924
comma
l_int|12412
comma
l_int|11900
comma
l_int|11388
comma
l_int|10876
comma
l_int|10364
comma
l_int|9852
comma
l_int|9340
comma
l_int|8828
comma
l_int|8316
comma
l_int|7932
comma
l_int|7676
comma
l_int|7420
comma
l_int|7164
comma
l_int|6908
comma
l_int|6652
comma
l_int|6396
comma
l_int|6140
comma
l_int|5884
comma
l_int|5628
comma
l_int|5372
comma
l_int|5116
comma
l_int|4860
comma
l_int|4604
comma
l_int|4348
comma
l_int|4092
comma
l_int|3900
comma
l_int|3772
comma
l_int|3644
comma
l_int|3516
comma
l_int|3388
comma
l_int|3260
comma
l_int|3132
comma
l_int|3004
comma
l_int|2876
comma
l_int|2748
comma
l_int|2620
comma
l_int|2492
comma
l_int|2364
comma
l_int|2236
comma
l_int|2108
comma
l_int|1980
comma
l_int|1884
comma
l_int|1820
comma
l_int|1756
comma
l_int|1692
comma
l_int|1628
comma
l_int|1564
comma
l_int|1500
comma
l_int|1436
comma
l_int|1372
comma
l_int|1308
comma
l_int|1244
comma
l_int|1180
comma
l_int|1116
comma
l_int|1052
comma
l_int|988
comma
l_int|924
comma
l_int|876
comma
l_int|844
comma
l_int|812
comma
l_int|780
comma
l_int|748
comma
l_int|716
comma
l_int|684
comma
l_int|652
comma
l_int|620
comma
l_int|588
comma
l_int|556
comma
l_int|524
comma
l_int|492
comma
l_int|460
comma
l_int|428
comma
l_int|396
comma
l_int|372
comma
l_int|356
comma
l_int|340
comma
l_int|324
comma
l_int|308
comma
l_int|292
comma
l_int|276
comma
l_int|260
comma
l_int|244
comma
l_int|228
comma
l_int|212
comma
l_int|196
comma
l_int|180
comma
l_int|164
comma
l_int|148
comma
l_int|132
comma
l_int|120
comma
l_int|112
comma
l_int|104
comma
l_int|96
comma
l_int|88
comma
l_int|80
comma
l_int|72
comma
l_int|64
comma
l_int|56
comma
l_int|48
comma
l_int|40
comma
l_int|32
comma
l_int|24
comma
l_int|16
comma
l_int|8
comma
l_int|0
comma
)brace
suffix:semicolon
multiline_comment|/* 16 bit A-law */
DECL|variable|dmasound_alaw2dma16
r_int
id|dmasound_alaw2dma16
(braket
)braket
op_assign
(brace
op_minus
l_int|5504
comma
op_minus
l_int|5248
comma
op_minus
l_int|6016
comma
op_minus
l_int|5760
comma
op_minus
l_int|4480
comma
op_minus
l_int|4224
comma
op_minus
l_int|4992
comma
op_minus
l_int|4736
comma
op_minus
l_int|7552
comma
op_minus
l_int|7296
comma
op_minus
l_int|8064
comma
op_minus
l_int|7808
comma
op_minus
l_int|6528
comma
op_minus
l_int|6272
comma
op_minus
l_int|7040
comma
op_minus
l_int|6784
comma
op_minus
l_int|2752
comma
op_minus
l_int|2624
comma
op_minus
l_int|3008
comma
op_minus
l_int|2880
comma
op_minus
l_int|2240
comma
op_minus
l_int|2112
comma
op_minus
l_int|2496
comma
op_minus
l_int|2368
comma
op_minus
l_int|3776
comma
op_minus
l_int|3648
comma
op_minus
l_int|4032
comma
op_minus
l_int|3904
comma
op_minus
l_int|3264
comma
op_minus
l_int|3136
comma
op_minus
l_int|3520
comma
op_minus
l_int|3392
comma
op_minus
l_int|22016
comma
op_minus
l_int|20992
comma
op_minus
l_int|24064
comma
op_minus
l_int|23040
comma
op_minus
l_int|17920
comma
op_minus
l_int|16896
comma
op_minus
l_int|19968
comma
op_minus
l_int|18944
comma
op_minus
l_int|30208
comma
op_minus
l_int|29184
comma
op_minus
l_int|32256
comma
op_minus
l_int|31232
comma
op_minus
l_int|26112
comma
op_minus
l_int|25088
comma
op_minus
l_int|28160
comma
op_minus
l_int|27136
comma
op_minus
l_int|11008
comma
op_minus
l_int|10496
comma
op_minus
l_int|12032
comma
op_minus
l_int|11520
comma
op_minus
l_int|8960
comma
op_minus
l_int|8448
comma
op_minus
l_int|9984
comma
op_minus
l_int|9472
comma
op_minus
l_int|15104
comma
op_minus
l_int|14592
comma
op_minus
l_int|16128
comma
op_minus
l_int|15616
comma
op_minus
l_int|13056
comma
op_minus
l_int|12544
comma
op_minus
l_int|14080
comma
op_minus
l_int|13568
comma
op_minus
l_int|344
comma
op_minus
l_int|328
comma
op_minus
l_int|376
comma
op_minus
l_int|360
comma
op_minus
l_int|280
comma
op_minus
l_int|264
comma
op_minus
l_int|312
comma
op_minus
l_int|296
comma
op_minus
l_int|472
comma
op_minus
l_int|456
comma
op_minus
l_int|504
comma
op_minus
l_int|488
comma
op_minus
l_int|408
comma
op_minus
l_int|392
comma
op_minus
l_int|440
comma
op_minus
l_int|424
comma
op_minus
l_int|88
comma
op_minus
l_int|72
comma
op_minus
l_int|120
comma
op_minus
l_int|104
comma
op_minus
l_int|24
comma
op_minus
l_int|8
comma
op_minus
l_int|56
comma
op_minus
l_int|40
comma
op_minus
l_int|216
comma
op_minus
l_int|200
comma
op_minus
l_int|248
comma
op_minus
l_int|232
comma
op_minus
l_int|152
comma
op_minus
l_int|136
comma
op_minus
l_int|184
comma
op_minus
l_int|168
comma
op_minus
l_int|1376
comma
op_minus
l_int|1312
comma
op_minus
l_int|1504
comma
op_minus
l_int|1440
comma
op_minus
l_int|1120
comma
op_minus
l_int|1056
comma
op_minus
l_int|1248
comma
op_minus
l_int|1184
comma
op_minus
l_int|1888
comma
op_minus
l_int|1824
comma
op_minus
l_int|2016
comma
op_minus
l_int|1952
comma
op_minus
l_int|1632
comma
op_minus
l_int|1568
comma
op_minus
l_int|1760
comma
op_minus
l_int|1696
comma
op_minus
l_int|688
comma
op_minus
l_int|656
comma
op_minus
l_int|752
comma
op_minus
l_int|720
comma
op_minus
l_int|560
comma
op_minus
l_int|528
comma
op_minus
l_int|624
comma
op_minus
l_int|592
comma
op_minus
l_int|944
comma
op_minus
l_int|912
comma
op_minus
l_int|1008
comma
op_minus
l_int|976
comma
op_minus
l_int|816
comma
op_minus
l_int|784
comma
op_minus
l_int|880
comma
op_minus
l_int|848
comma
l_int|5504
comma
l_int|5248
comma
l_int|6016
comma
l_int|5760
comma
l_int|4480
comma
l_int|4224
comma
l_int|4992
comma
l_int|4736
comma
l_int|7552
comma
l_int|7296
comma
l_int|8064
comma
l_int|7808
comma
l_int|6528
comma
l_int|6272
comma
l_int|7040
comma
l_int|6784
comma
l_int|2752
comma
l_int|2624
comma
l_int|3008
comma
l_int|2880
comma
l_int|2240
comma
l_int|2112
comma
l_int|2496
comma
l_int|2368
comma
l_int|3776
comma
l_int|3648
comma
l_int|4032
comma
l_int|3904
comma
l_int|3264
comma
l_int|3136
comma
l_int|3520
comma
l_int|3392
comma
l_int|22016
comma
l_int|20992
comma
l_int|24064
comma
l_int|23040
comma
l_int|17920
comma
l_int|16896
comma
l_int|19968
comma
l_int|18944
comma
l_int|30208
comma
l_int|29184
comma
l_int|32256
comma
l_int|31232
comma
l_int|26112
comma
l_int|25088
comma
l_int|28160
comma
l_int|27136
comma
l_int|11008
comma
l_int|10496
comma
l_int|12032
comma
l_int|11520
comma
l_int|8960
comma
l_int|8448
comma
l_int|9984
comma
l_int|9472
comma
l_int|15104
comma
l_int|14592
comma
l_int|16128
comma
l_int|15616
comma
l_int|13056
comma
l_int|12544
comma
l_int|14080
comma
l_int|13568
comma
l_int|344
comma
l_int|328
comma
l_int|376
comma
l_int|360
comma
l_int|280
comma
l_int|264
comma
l_int|312
comma
l_int|296
comma
l_int|472
comma
l_int|456
comma
l_int|504
comma
l_int|488
comma
l_int|408
comma
l_int|392
comma
l_int|440
comma
l_int|424
comma
l_int|88
comma
l_int|72
comma
l_int|120
comma
l_int|104
comma
l_int|24
comma
l_int|8
comma
l_int|56
comma
l_int|40
comma
l_int|216
comma
l_int|200
comma
l_int|248
comma
l_int|232
comma
l_int|152
comma
l_int|136
comma
l_int|184
comma
l_int|168
comma
l_int|1376
comma
l_int|1312
comma
l_int|1504
comma
l_int|1440
comma
l_int|1120
comma
l_int|1056
comma
l_int|1248
comma
l_int|1184
comma
l_int|1888
comma
l_int|1824
comma
l_int|2016
comma
l_int|1952
comma
l_int|1632
comma
l_int|1568
comma
l_int|1760
comma
l_int|1696
comma
l_int|688
comma
l_int|656
comma
l_int|752
comma
l_int|720
comma
l_int|560
comma
l_int|528
comma
l_int|624
comma
l_int|592
comma
l_int|944
comma
l_int|912
comma
l_int|1008
comma
l_int|976
comma
l_int|816
comma
l_int|784
comma
l_int|880
comma
l_int|848
comma
)brace
suffix:semicolon
macro_line|#endif /* HAS_16BIT_TABLES */
macro_line|#ifdef HAS_14BIT_TABLES
multiline_comment|/*&n;     *  Unused for now. Where are the MSB parts anyway??&n;     */
multiline_comment|/* 14 bit mu-law (LSB) */
DECL|variable|dmasound_ulaw2dma14l
r_char
id|dmasound_ulaw2dma14l
(braket
)braket
op_assign
(brace
l_int|33
comma
l_int|33
comma
l_int|33
comma
l_int|33
comma
l_int|33
comma
l_int|33
comma
l_int|33
comma
l_int|33
comma
l_int|33
comma
l_int|33
comma
l_int|33
comma
l_int|33
comma
l_int|33
comma
l_int|33
comma
l_int|33
comma
l_int|33
comma
l_int|33
comma
l_int|33
comma
l_int|33
comma
l_int|33
comma
l_int|33
comma
l_int|33
comma
l_int|33
comma
l_int|33
comma
l_int|33
comma
l_int|33
comma
l_int|33
comma
l_int|33
comma
l_int|33
comma
l_int|33
comma
l_int|33
comma
l_int|33
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|1
comma
l_int|49
comma
l_int|17
comma
l_int|49
comma
l_int|17
comma
l_int|49
comma
l_int|17
comma
l_int|49
comma
l_int|17
comma
l_int|49
comma
l_int|17
comma
l_int|49
comma
l_int|17
comma
l_int|49
comma
l_int|17
comma
l_int|49
comma
l_int|17
comma
l_int|41
comma
l_int|57
comma
l_int|9
comma
l_int|25
comma
l_int|41
comma
l_int|57
comma
l_int|9
comma
l_int|25
comma
l_int|41
comma
l_int|57
comma
l_int|9
comma
l_int|25
comma
l_int|41
comma
l_int|57
comma
l_int|9
comma
l_int|25
comma
l_int|37
comma
l_int|45
comma
l_int|53
comma
l_int|61
comma
l_int|5
comma
l_int|13
comma
l_int|21
comma
l_int|29
comma
l_int|37
comma
l_int|45
comma
l_int|53
comma
l_int|61
comma
l_int|5
comma
l_int|13
comma
l_int|21
comma
l_int|29
comma
l_int|35
comma
l_int|39
comma
l_int|43
comma
l_int|47
comma
l_int|51
comma
l_int|55
comma
l_int|59
comma
l_int|63
comma
l_int|3
comma
l_int|7
comma
l_int|11
comma
l_int|15
comma
l_int|19
comma
l_int|23
comma
l_int|27
comma
l_int|31
comma
l_int|34
comma
l_int|36
comma
l_int|38
comma
l_int|40
comma
l_int|42
comma
l_int|44
comma
l_int|46
comma
l_int|48
comma
l_int|50
comma
l_int|52
comma
l_int|54
comma
l_int|56
comma
l_int|58
comma
l_int|60
comma
l_int|62
comma
l_int|0
comma
l_int|31
comma
l_int|31
comma
l_int|31
comma
l_int|31
comma
l_int|31
comma
l_int|31
comma
l_int|31
comma
l_int|31
comma
l_int|31
comma
l_int|31
comma
l_int|31
comma
l_int|31
comma
l_int|31
comma
l_int|31
comma
l_int|31
comma
l_int|31
comma
l_int|31
comma
l_int|31
comma
l_int|31
comma
l_int|31
comma
l_int|31
comma
l_int|31
comma
l_int|31
comma
l_int|31
comma
l_int|31
comma
l_int|31
comma
l_int|31
comma
l_int|31
comma
l_int|31
comma
l_int|31
comma
l_int|31
comma
l_int|31
comma
l_int|63
comma
l_int|63
comma
l_int|63
comma
l_int|63
comma
l_int|63
comma
l_int|63
comma
l_int|63
comma
l_int|63
comma
l_int|63
comma
l_int|63
comma
l_int|63
comma
l_int|63
comma
l_int|63
comma
l_int|63
comma
l_int|63
comma
l_int|63
comma
l_int|15
comma
l_int|47
comma
l_int|15
comma
l_int|47
comma
l_int|15
comma
l_int|47
comma
l_int|15
comma
l_int|47
comma
l_int|15
comma
l_int|47
comma
l_int|15
comma
l_int|47
comma
l_int|15
comma
l_int|47
comma
l_int|15
comma
l_int|47
comma
l_int|23
comma
l_int|7
comma
l_int|55
comma
l_int|39
comma
l_int|23
comma
l_int|7
comma
l_int|55
comma
l_int|39
comma
l_int|23
comma
l_int|7
comma
l_int|55
comma
l_int|39
comma
l_int|23
comma
l_int|7
comma
l_int|55
comma
l_int|39
comma
l_int|27
comma
l_int|19
comma
l_int|11
comma
l_int|3
comma
l_int|59
comma
l_int|51
comma
l_int|43
comma
l_int|35
comma
l_int|27
comma
l_int|19
comma
l_int|11
comma
l_int|3
comma
l_int|59
comma
l_int|51
comma
l_int|43
comma
l_int|35
comma
l_int|29
comma
l_int|25
comma
l_int|21
comma
l_int|17
comma
l_int|13
comma
l_int|9
comma
l_int|5
comma
l_int|1
comma
l_int|61
comma
l_int|57
comma
l_int|53
comma
l_int|49
comma
l_int|45
comma
l_int|41
comma
l_int|37
comma
l_int|33
comma
l_int|30
comma
l_int|28
comma
l_int|26
comma
l_int|24
comma
l_int|22
comma
l_int|20
comma
l_int|18
comma
l_int|16
comma
l_int|14
comma
l_int|12
comma
l_int|10
comma
l_int|8
comma
l_int|6
comma
l_int|4
comma
l_int|2
comma
l_int|0
)brace
suffix:semicolon
multiline_comment|/* 14 bit A-law (LSB) */
DECL|variable|dmasound_alaw2dma14l
r_char
id|dmasound_alaw2dma14l
(braket
)braket
op_assign
(brace
l_int|32
comma
l_int|32
comma
l_int|32
comma
l_int|32
comma
l_int|32
comma
l_int|32
comma
l_int|32
comma
l_int|32
comma
l_int|32
comma
l_int|32
comma
l_int|32
comma
l_int|32
comma
l_int|32
comma
l_int|32
comma
l_int|32
comma
l_int|32
comma
l_int|16
comma
l_int|48
comma
l_int|16
comma
l_int|48
comma
l_int|16
comma
l_int|48
comma
l_int|16
comma
l_int|48
comma
l_int|16
comma
l_int|48
comma
l_int|16
comma
l_int|48
comma
l_int|16
comma
l_int|48
comma
l_int|16
comma
l_int|48
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|42
comma
l_int|46
comma
l_int|34
comma
l_int|38
comma
l_int|58
comma
l_int|62
comma
l_int|50
comma
l_int|54
comma
l_int|10
comma
l_int|14
comma
l_int|2
comma
l_int|6
comma
l_int|26
comma
l_int|30
comma
l_int|18
comma
l_int|22
comma
l_int|42
comma
l_int|46
comma
l_int|34
comma
l_int|38
comma
l_int|58
comma
l_int|62
comma
l_int|50
comma
l_int|54
comma
l_int|10
comma
l_int|14
comma
l_int|2
comma
l_int|6
comma
l_int|26
comma
l_int|30
comma
l_int|18
comma
l_int|22
comma
l_int|40
comma
l_int|56
comma
l_int|8
comma
l_int|24
comma
l_int|40
comma
l_int|56
comma
l_int|8
comma
l_int|24
comma
l_int|40
comma
l_int|56
comma
l_int|8
comma
l_int|24
comma
l_int|40
comma
l_int|56
comma
l_int|8
comma
l_int|24
comma
l_int|20
comma
l_int|28
comma
l_int|4
comma
l_int|12
comma
l_int|52
comma
l_int|60
comma
l_int|36
comma
l_int|44
comma
l_int|20
comma
l_int|28
comma
l_int|4
comma
l_int|12
comma
l_int|52
comma
l_int|60
comma
l_int|36
comma
l_int|44
comma
l_int|32
comma
l_int|32
comma
l_int|32
comma
l_int|32
comma
l_int|32
comma
l_int|32
comma
l_int|32
comma
l_int|32
comma
l_int|32
comma
l_int|32
comma
l_int|32
comma
l_int|32
comma
l_int|32
comma
l_int|32
comma
l_int|32
comma
l_int|32
comma
l_int|48
comma
l_int|16
comma
l_int|48
comma
l_int|16
comma
l_int|48
comma
l_int|16
comma
l_int|48
comma
l_int|16
comma
l_int|48
comma
l_int|16
comma
l_int|48
comma
l_int|16
comma
l_int|48
comma
l_int|16
comma
l_int|48
comma
l_int|16
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|0
comma
l_int|22
comma
l_int|18
comma
l_int|30
comma
l_int|26
comma
l_int|6
comma
l_int|2
comma
l_int|14
comma
l_int|10
comma
l_int|54
comma
l_int|50
comma
l_int|62
comma
l_int|58
comma
l_int|38
comma
l_int|34
comma
l_int|46
comma
l_int|42
comma
l_int|22
comma
l_int|18
comma
l_int|30
comma
l_int|26
comma
l_int|6
comma
l_int|2
comma
l_int|14
comma
l_int|10
comma
l_int|54
comma
l_int|50
comma
l_int|62
comma
l_int|58
comma
l_int|38
comma
l_int|34
comma
l_int|46
comma
l_int|42
comma
l_int|24
comma
l_int|8
comma
l_int|56
comma
l_int|40
comma
l_int|24
comma
l_int|8
comma
l_int|56
comma
l_int|40
comma
l_int|24
comma
l_int|8
comma
l_int|56
comma
l_int|40
comma
l_int|24
comma
l_int|8
comma
l_int|56
comma
l_int|40
comma
l_int|44
comma
l_int|36
comma
l_int|60
comma
l_int|52
comma
l_int|12
comma
l_int|4
comma
l_int|28
comma
l_int|20
comma
l_int|44
comma
l_int|36
comma
l_int|60
comma
l_int|52
comma
l_int|12
comma
l_int|4
comma
l_int|28
comma
l_int|20
)brace
suffix:semicolon
macro_line|#endif /* HAS_14BIT_TABLES */
multiline_comment|/*&n;     *  Common stuff&n;     */
DECL|function|sound_lseek
r_static
r_int
r_int
id|sound_lseek
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_int
r_int
id|offset
comma
r_int
id|orig
)paren
(brace
r_return
op_minus
id|ESPIPE
suffix:semicolon
)brace
multiline_comment|/*&n;     *  Mid level stuff&n;     */
DECL|variable|dmasound
r_struct
id|sound_settings
id|dmasound
suffix:semicolon
DECL|function|sound_silence
r_static
r_inline
r_void
id|sound_silence
c_func
(paren
r_void
)paren
(brace
multiline_comment|/* update hardware settings one more */
id|dmasound.mach
dot
id|init
c_func
(paren
)paren
suffix:semicolon
id|dmasound.mach
dot
id|silence
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|function|sound_init
r_static
r_inline
r_void
id|sound_init
c_func
(paren
r_void
)paren
(brace
id|dmasound.mach
dot
id|init
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|function|sound_set_format
r_static
r_inline
r_int
id|sound_set_format
c_func
(paren
r_int
id|format
)paren
(brace
r_return
id|dmasound.mach
dot
id|setFormat
c_func
(paren
id|format
)paren
suffix:semicolon
)brace
DECL|function|sound_set_speed
r_static
r_int
id|sound_set_speed
c_func
(paren
r_int
id|speed
)paren
(brace
r_if
c_cond
(paren
id|speed
OL
l_int|0
)paren
r_return
id|dmasound.soft.speed
suffix:semicolon
id|dmasound.soft.speed
op_assign
id|speed
suffix:semicolon
id|dmasound.mach
dot
id|init
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dmasound.minDev
op_eq
id|SND_DEV_DSP
)paren
id|dmasound.dsp.speed
op_assign
id|dmasound.soft.speed
suffix:semicolon
r_return
id|dmasound.soft.speed
suffix:semicolon
)brace
DECL|function|sound_set_stereo
r_static
r_int
id|sound_set_stereo
c_func
(paren
r_int
id|stereo
)paren
(brace
r_if
c_cond
(paren
id|stereo
OL
l_int|0
)paren
r_return
id|dmasound.soft.stereo
suffix:semicolon
id|stereo
op_assign
op_logical_neg
op_logical_neg
id|stereo
suffix:semicolon
multiline_comment|/* should be 0 or 1 now */
id|dmasound.soft.stereo
op_assign
id|stereo
suffix:semicolon
r_if
c_cond
(paren
id|dmasound.minDev
op_eq
id|SND_DEV_DSP
)paren
id|dmasound.dsp.stereo
op_assign
id|stereo
suffix:semicolon
id|dmasound.mach
dot
id|init
c_func
(paren
)paren
suffix:semicolon
r_return
id|stereo
suffix:semicolon
)brace
DECL|function|sound_copy_translate
r_static
id|ssize_t
id|sound_copy_translate
c_func
(paren
id|TRANS
op_star
id|trans
comma
r_const
id|u_char
op_star
id|userPtr
comma
r_int
id|userCount
comma
id|u_char
id|frame
(braket
)braket
comma
id|ssize_t
op_star
id|frameUsed
comma
id|ssize_t
id|frameLeft
)paren
(brace
id|ssize_t
(paren
op_star
id|ct_func
)paren
(paren
r_const
id|u_char
op_star
comma
r_int
comma
id|u_char
op_star
comma
id|ssize_t
op_star
comma
id|ssize_t
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|dmasound.soft.format
)paren
(brace
r_case
id|AFMT_MU_LAW
suffix:colon
id|ct_func
op_assign
id|trans-&gt;ct_ulaw
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AFMT_A_LAW
suffix:colon
id|ct_func
op_assign
id|trans-&gt;ct_alaw
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AFMT_S8
suffix:colon
id|ct_func
op_assign
id|trans-&gt;ct_s8
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AFMT_U8
suffix:colon
id|ct_func
op_assign
id|trans-&gt;ct_u8
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AFMT_S16_BE
suffix:colon
id|ct_func
op_assign
id|trans-&gt;ct_s16be
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AFMT_U16_BE
suffix:colon
id|ct_func
op_assign
id|trans-&gt;ct_u16be
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AFMT_S16_LE
suffix:colon
id|ct_func
op_assign
id|trans-&gt;ct_s16le
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AFMT_U16_LE
suffix:colon
id|ct_func
op_assign
id|trans-&gt;ct_u16le
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
l_int|0
suffix:semicolon
)brace
r_return
id|ct_func
c_func
(paren
id|userPtr
comma
id|userCount
comma
id|frame
comma
id|frameUsed
comma
id|frameLeft
)paren
suffix:semicolon
)brace
multiline_comment|/*&n;     *  /dev/mixer abstraction&n;     */
r_static
r_struct
(brace
DECL|member|busy
r_int
id|busy
suffix:semicolon
DECL|member|modify_counter
r_int
id|modify_counter
suffix:semicolon
DECL|variable|mixer
)brace
id|mixer
suffix:semicolon
DECL|function|mixer_open
r_static
r_int
id|mixer_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
id|dmasound.mach
dot
id|open
c_func
(paren
)paren
suffix:semicolon
id|mixer.busy
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|mixer_release
r_static
r_int
id|mixer_release
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
id|lock_kernel
c_func
(paren
)paren
suffix:semicolon
id|mixer.busy
op_assign
l_int|0
suffix:semicolon
id|dmasound.mach
dot
id|release
c_func
(paren
)paren
suffix:semicolon
id|unlock_kernel
c_func
(paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|mixer_ioctl
r_static
r_int
id|mixer_ioctl
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
comma
id|u_int
id|cmd
comma
id|u_long
id|arg
)paren
(brace
r_if
c_cond
(paren
id|_SIOC_DIR
c_func
(paren
id|cmd
)paren
op_amp
id|_SIOC_WRITE
)paren
id|mixer.modify_counter
op_increment
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|OSS_GETVERSION
suffix:colon
r_return
id|IOCTL_OUT
c_func
(paren
id|arg
comma
id|SOUND_VERSION
)paren
suffix:semicolon
r_case
id|SOUND_MIXER_INFO
suffix:colon
(brace
id|mixer_info
id|info
suffix:semicolon
id|strncpy
c_func
(paren
id|info.id
comma
id|dmasound.mach.name2
comma
r_sizeof
(paren
id|info.id
)paren
)paren
suffix:semicolon
id|strncpy
c_func
(paren
id|info.name
comma
id|dmasound.mach.name2
comma
r_sizeof
(paren
id|info.name
)paren
)paren
suffix:semicolon
id|info.name
(braket
r_sizeof
(paren
id|info.name
)paren
op_minus
l_int|1
)braket
op_assign
l_int|0
suffix:semicolon
id|info.modify_counter
op_assign
id|mixer.modify_counter
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
(paren
r_int
op_star
)paren
id|arg
comma
op_amp
id|info
comma
r_sizeof
(paren
id|info
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|dmasound.mach.mixer_ioctl
)paren
r_return
id|dmasound.mach
dot
id|mixer_ioctl
c_func
(paren
id|cmd
comma
id|arg
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
DECL|variable|mixer_fops
r_static
r_struct
id|file_operations
id|mixer_fops
op_assign
(brace
id|owner
suffix:colon
id|THIS_MODULE
comma
id|llseek
suffix:colon
id|sound_lseek
comma
id|ioctl
suffix:colon
id|mixer_ioctl
comma
id|open
suffix:colon
id|mixer_open
comma
id|release
suffix:colon
id|mixer_release
comma
)brace
suffix:semicolon
DECL|function|mixer_init
r_static
r_void
id|__init
id|mixer_init
c_func
(paren
r_void
)paren
(brace
macro_line|#ifndef MODULE
r_int
id|mixer_unit
suffix:semicolon
macro_line|#endif
id|mixer_unit
op_assign
id|register_sound_mixer
c_func
(paren
op_amp
id|mixer_fops
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mixer_unit
OL
l_int|0
)paren
r_return
suffix:semicolon
id|mixer.busy
op_assign
l_int|0
suffix:semicolon
id|dmasound.treble
op_assign
l_int|0
suffix:semicolon
id|dmasound.bass
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|dmasound.mach.mixer_init
)paren
id|dmasound.mach
dot
id|mixer_init
c_func
(paren
)paren
suffix:semicolon
)brace
multiline_comment|/*&n;     *  Sound queue stuff, the heart of the driver&n;     */
DECL|variable|dmasound_write_sq
r_struct
id|sound_queue
id|dmasound_write_sq
suffix:semicolon
macro_line|#ifdef HAS_RECORD
DECL|variable|dmasound_read_sq
r_struct
id|sound_queue
id|dmasound_read_sq
suffix:semicolon
macro_line|#endif
DECL|function|sq_allocate_buffers
r_static
r_int
id|sq_allocate_buffers
c_func
(paren
r_struct
id|sound_queue
op_star
id|sq
comma
r_int
id|num
comma
r_int
id|size
)paren
(brace
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
id|sq-&gt;buffers
)paren
r_return
l_int|0
suffix:semicolon
id|sq-&gt;numBufs
op_assign
id|num
suffix:semicolon
id|sq-&gt;bufSize
op_assign
id|size
suffix:semicolon
id|sq-&gt;buffers
op_assign
id|kmalloc
(paren
id|num
op_star
r_sizeof
(paren
r_char
op_star
)paren
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|sq-&gt;buffers
)paren
r_return
op_minus
id|ENOMEM
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|num
suffix:semicolon
id|i
op_increment
)paren
(brace
id|sq-&gt;buffers
(braket
id|i
)braket
op_assign
id|dmasound.mach
dot
id|dma_alloc
c_func
(paren
id|size
comma
id|GFP_KERNEL
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|sq-&gt;buffers
(braket
id|i
)braket
)paren
(brace
r_while
c_loop
(paren
id|i
op_decrement
)paren
id|dmasound.mach
dot
id|dma_free
c_func
(paren
id|sq-&gt;buffers
(braket
id|i
)braket
comma
id|size
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|sq-&gt;buffers
)paren
suffix:semicolon
id|sq-&gt;buffers
op_assign
l_int|0
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|sq_release_buffers
r_static
r_void
id|sq_release_buffers
c_func
(paren
r_struct
id|sound_queue
op_star
id|sq
)paren
(brace
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
id|sq-&gt;buffers
)paren
(brace
r_if
c_cond
(paren
id|sq
op_ne
op_amp
id|write_sq
op_logical_and
id|dmasound.mach.abort_read
)paren
id|dmasound.mach
dot
id|abort_read
c_func
(paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|sq-&gt;numBufs
suffix:semicolon
id|i
op_increment
)paren
id|dmasound.mach
dot
id|dma_free
c_func
(paren
id|sq-&gt;buffers
(braket
id|i
)braket
comma
id|sq-&gt;bufSize
)paren
suffix:semicolon
id|kfree
c_func
(paren
id|sq-&gt;buffers
)paren
suffix:semicolon
id|sq-&gt;buffers
op_assign
l_int|NULL
suffix:semicolon
)brace
)brace
DECL|function|sq_setup
r_static
r_void
id|sq_setup
c_func
(paren
r_struct
id|sound_queue
op_star
id|sq
comma
r_int
id|max_count
comma
r_int
id|max_active
comma
r_int
id|block_size
)paren
(brace
r_void
(paren
op_star
id|setup_func
)paren
(paren
r_void
)paren
suffix:semicolon
id|sq-&gt;max_count
op_assign
id|max_count
suffix:semicolon
id|sq-&gt;max_active
op_assign
id|max_active
suffix:semicolon
id|sq-&gt;block_size
op_assign
id|block_size
suffix:semicolon
id|sq-&gt;front
op_assign
id|sq-&gt;count
op_assign
id|sq-&gt;rear_size
op_assign
l_int|0
suffix:semicolon
id|sq-&gt;syncing
op_assign
l_int|0
suffix:semicolon
id|sq-&gt;active
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|sq
op_eq
op_amp
id|write_sq
)paren
(brace
id|sq-&gt;rear
op_assign
op_minus
l_int|1
suffix:semicolon
id|setup_func
op_assign
id|dmasound.mach.write_sq_setup
suffix:semicolon
)brace
r_else
(brace
id|sq-&gt;rear
op_assign
l_int|0
suffix:semicolon
id|setup_func
op_assign
id|dmasound.mach.read_sq_setup
suffix:semicolon
)brace
r_if
c_cond
(paren
id|setup_func
)paren
id|setup_func
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|function|sq_play
r_static
r_inline
r_void
id|sq_play
c_func
(paren
r_void
)paren
(brace
id|dmasound.mach
dot
id|play
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|function|sq_write
r_static
id|ssize_t
id|sq_write
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_const
r_char
op_star
id|src
comma
r_int
id|uLeft
comma
id|loff_t
op_star
id|ppos
)paren
(brace
id|ssize_t
id|uWritten
op_assign
l_int|0
suffix:semicolon
id|u_char
op_star
id|dest
suffix:semicolon
id|ssize_t
id|uUsed
comma
id|bUsed
comma
id|bLeft
suffix:semicolon
multiline_comment|/* ++TeSche: Is something like this necessary?&n;&t; * Hey, that&squot;s an honest question! Or does any other part of the&n;&t; * filesystem already checks this situation? I really don&squot;t know.&n;&t; */
r_if
c_cond
(paren
id|uLeft
op_eq
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
multiline_comment|/* The interrupt doesn&squot;t start to play the last, incomplete frame.&n;&t; * Thus we can append to it without disabling the interrupts! (Note&n;&t; * also that write_sq.rear isn&squot;t affected by the interrupt.)&n;&t; */
r_if
c_cond
(paren
id|write_sq.count
OG
l_int|0
op_logical_and
(paren
id|bLeft
op_assign
id|write_sq.block_size
op_minus
id|write_sq.rear_size
)paren
OG
l_int|0
)paren
(brace
id|dest
op_assign
id|write_sq.buffers
(braket
id|write_sq.rear
)braket
suffix:semicolon
id|bUsed
op_assign
id|write_sq.rear_size
suffix:semicolon
id|uUsed
op_assign
id|sound_copy_translate
c_func
(paren
id|dmasound.trans_write
comma
id|src
comma
id|uLeft
comma
id|dest
comma
op_amp
id|bUsed
comma
id|bLeft
)paren
suffix:semicolon
r_if
c_cond
(paren
id|uUsed
op_le
l_int|0
)paren
r_return
id|uUsed
suffix:semicolon
id|src
op_add_assign
id|uUsed
suffix:semicolon
id|uWritten
op_add_assign
id|uUsed
suffix:semicolon
id|uLeft
op_sub_assign
id|uUsed
suffix:semicolon
id|write_sq.rear_size
op_assign
id|bUsed
suffix:semicolon
)brace
r_do
(brace
r_while
c_loop
(paren
id|write_sq.count
op_eq
id|write_sq.max_active
)paren
(brace
id|sq_play
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|write_sq.open_mode
op_amp
id|O_NONBLOCK
)paren
r_return
id|uWritten
OG
l_int|0
ques
c_cond
id|uWritten
suffix:colon
op_minus
id|EAGAIN
suffix:semicolon
id|SLEEP
c_func
(paren
id|write_sq.action_queue
)paren
suffix:semicolon
r_if
c_cond
(paren
id|signal_pending
c_func
(paren
id|current
)paren
)paren
r_return
id|uWritten
OG
l_int|0
ques
c_cond
id|uWritten
suffix:colon
op_minus
id|EINTR
suffix:semicolon
)brace
multiline_comment|/* Here, we can avoid disabling the interrupt by first&n;&t;&t; * copying and translating the data, and then updating&n;&t;&t; * the write_sq variables. Until this is done, the interrupt&n;&t;&t; * won&squot;t see the new frame and we can work on it&n;&t;&t; * undisturbed.&n;&t;&t; */
id|dest
op_assign
id|write_sq.buffers
(braket
(paren
id|write_sq.rear
op_plus
l_int|1
)paren
op_mod
id|write_sq.max_count
)braket
suffix:semicolon
id|bUsed
op_assign
l_int|0
suffix:semicolon
id|bLeft
op_assign
id|write_sq.block_size
suffix:semicolon
id|uUsed
op_assign
id|sound_copy_translate
c_func
(paren
id|dmasound.trans_write
comma
id|src
comma
id|uLeft
comma
id|dest
comma
op_amp
id|bUsed
comma
id|bLeft
)paren
suffix:semicolon
r_if
c_cond
(paren
id|uUsed
op_le
l_int|0
)paren
r_break
suffix:semicolon
id|src
op_add_assign
id|uUsed
suffix:semicolon
id|uWritten
op_add_assign
id|uUsed
suffix:semicolon
id|uLeft
op_sub_assign
id|uUsed
suffix:semicolon
r_if
c_cond
(paren
id|bUsed
)paren
(brace
id|write_sq.rear
op_assign
(paren
id|write_sq.rear
op_plus
l_int|1
)paren
op_mod
id|write_sq.max_count
suffix:semicolon
id|write_sq.rear_size
op_assign
id|bUsed
suffix:semicolon
id|write_sq.count
op_increment
suffix:semicolon
)brace
)brace
r_while
c_loop
(paren
id|bUsed
)paren
suffix:semicolon
multiline_comment|/* uUsed may have been 0 */
id|sq_play
c_func
(paren
)paren
suffix:semicolon
r_return
id|uUsed
OL
l_int|0
ques
c_cond
id|uUsed
suffix:colon
id|uWritten
suffix:semicolon
)brace
macro_line|#ifdef HAS_RECORD
multiline_comment|/*&n;     *  Here is how the values are used for reading.&n;     *  The value &squot;active&squot; simply indicates the DMA is running.  This is done&n;     *  so the driver semantics are DMA starts when the first read is posted.&n;     *  The value &squot;front&squot; indicates the buffer we should next send to the user.&n;     *  The value &squot;rear&squot; indicates the buffer the DMA is currently filling.&n;     *  When &squot;front&squot; == &squot;rear&squot; the buffer &quot;ring&quot; is empty (we always have an&n;     *  empty available).  The &squot;rear_size&squot; is used to track partial offsets&n;     *  into the current buffer.  Right now, I just keep the DMA running.  If&n;     *  the reader can&squot;t keep up, the interrupt tosses the oldest buffer.  We&n;     *  could also shut down the DMA in this case.&n;     */
DECL|function|sq_read
r_static
id|ssize_t
id|sq_read
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_char
op_star
id|dst
comma
r_int
id|uLeft
comma
id|loff_t
op_star
id|ppos
)paren
(brace
id|ssize_t
id|uRead
comma
id|bLeft
comma
id|bUsed
comma
id|uUsed
suffix:semicolon
r_if
c_cond
(paren
id|uLeft
op_eq
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|read_sq.active
op_logical_and
id|dmasound.mach.record
)paren
id|dmasound.mach
dot
id|record
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* Kick off the record process. */
id|uRead
op_assign
l_int|0
suffix:semicolon
multiline_comment|/* Move what the user requests, depending upon other options.&n;&t;*/
r_while
c_loop
(paren
id|uLeft
OG
l_int|0
)paren
(brace
multiline_comment|/* When front == rear, the DMA is not done yet.&n;&t;&t;*/
r_while
c_loop
(paren
id|read_sq.front
op_eq
id|read_sq.rear
)paren
(brace
r_if
c_cond
(paren
id|read_sq.open_mode
op_amp
id|O_NONBLOCK
)paren
(brace
r_return
id|uRead
OG
l_int|0
ques
c_cond
id|uRead
suffix:colon
op_minus
id|EAGAIN
suffix:semicolon
)brace
id|SLEEP
c_func
(paren
id|read_sq.action_queue
)paren
suffix:semicolon
r_if
c_cond
(paren
id|signal_pending
c_func
(paren
id|current
)paren
)paren
r_return
id|uRead
OG
l_int|0
ques
c_cond
id|uRead
suffix:colon
op_minus
id|EINTR
suffix:semicolon
)brace
multiline_comment|/* The amount we move is either what is left in the&n;&t;&t; * current buffer or what the user wants.&n;&t;&t; */
id|bLeft
op_assign
id|read_sq.block_size
op_minus
id|read_sq.rear_size
suffix:semicolon
id|bUsed
op_assign
id|read_sq.rear_size
suffix:semicolon
id|uUsed
op_assign
id|sound_copy_translate
c_func
(paren
id|dmasound.trans_read
comma
id|dst
comma
id|uLeft
comma
id|read_sq.buffers
(braket
id|read_sq.front
)braket
comma
op_amp
id|bUsed
comma
id|bLeft
)paren
suffix:semicolon
r_if
c_cond
(paren
id|uUsed
op_le
l_int|0
)paren
r_return
id|uUsed
suffix:semicolon
id|dst
op_add_assign
id|uUsed
suffix:semicolon
id|uRead
op_add_assign
id|uUsed
suffix:semicolon
id|uLeft
op_sub_assign
id|uUsed
suffix:semicolon
id|read_sq.rear_size
op_add_assign
id|bUsed
suffix:semicolon
r_if
c_cond
(paren
id|read_sq.rear_size
op_ge
id|read_sq.block_size
)paren
(brace
id|read_sq.rear_size
op_assign
l_int|0
suffix:semicolon
id|read_sq.front
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|read_sq.front
op_ge
id|read_sq.max_active
)paren
id|read_sq.front
op_assign
l_int|0
suffix:semicolon
)brace
)brace
r_return
id|uRead
suffix:semicolon
)brace
macro_line|#endif /* HAS_RECORD */
DECL|function|sq_init_waitqueue
r_static
r_inline
r_void
id|sq_init_waitqueue
c_func
(paren
r_struct
id|sound_queue
op_star
id|sq
)paren
(brace
id|init_waitqueue_head
c_func
(paren
op_amp
id|sq-&gt;action_queue
)paren
suffix:semicolon
id|init_waitqueue_head
c_func
(paren
op_amp
id|sq-&gt;open_queue
)paren
suffix:semicolon
id|init_waitqueue_head
c_func
(paren
op_amp
id|sq-&gt;sync_queue
)paren
suffix:semicolon
id|sq-&gt;busy
op_assign
l_int|0
suffix:semicolon
)brace
DECL|function|sq_wake_up
r_static
r_inline
r_void
id|sq_wake_up
c_func
(paren
r_struct
id|sound_queue
op_star
id|sq
comma
r_struct
id|file
op_star
id|file
comma
id|mode_t
id|mode
)paren
(brace
r_if
c_cond
(paren
id|file-&gt;f_mode
op_amp
id|mode
)paren
(brace
id|sq-&gt;busy
op_assign
l_int|0
suffix:semicolon
id|WAKE_UP
c_func
(paren
id|sq-&gt;open_queue
)paren
suffix:semicolon
)brace
)brace
DECL|function|sq_open2
r_static
r_int
id|sq_open2
c_func
(paren
r_struct
id|sound_queue
op_star
id|sq
comma
r_struct
id|file
op_star
id|file
comma
id|mode_t
id|mode
comma
r_int
id|numbufs
comma
r_int
id|bufsize
)paren
(brace
r_int
id|rc
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|file-&gt;f_mode
op_amp
id|mode
)paren
(brace
r_if
c_cond
(paren
id|sq-&gt;busy
)paren
(brace
id|rc
op_assign
op_minus
id|EBUSY
suffix:semicolon
r_if
c_cond
(paren
id|file-&gt;f_flags
op_amp
id|O_NONBLOCK
)paren
r_return
id|rc
suffix:semicolon
id|rc
op_assign
op_minus
id|EINTR
suffix:semicolon
r_while
c_loop
(paren
id|sq-&gt;busy
)paren
(brace
id|SLEEP
c_func
(paren
id|sq-&gt;open_queue
)paren
suffix:semicolon
r_if
c_cond
(paren
id|signal_pending
c_func
(paren
id|current
)paren
)paren
r_return
id|rc
suffix:semicolon
)brace
id|rc
op_assign
l_int|0
suffix:semicolon
)brace
id|sq-&gt;busy
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* Let&squot;s play spot-the-race-condition */
r_if
c_cond
(paren
id|sq_allocate_buffers
c_func
(paren
id|sq
comma
id|numbufs
comma
id|bufsize
)paren
)paren
(brace
id|sq_wake_up
c_func
(paren
id|sq
comma
id|file
comma
id|mode
)paren
suffix:semicolon
r_return
id|rc
suffix:semicolon
)brace
id|sq_setup
c_func
(paren
id|sq
comma
id|numbufs
comma
id|numbufs
comma
id|bufsize
)paren
suffix:semicolon
id|sq-&gt;open_mode
op_assign
id|file-&gt;f_mode
suffix:semicolon
)brace
r_return
id|rc
suffix:semicolon
)brace
DECL|macro|write_sq_init_waitqueue
mdefine_line|#define write_sq_init_waitqueue()&t;sq_init_waitqueue(&amp;write_sq)
DECL|macro|write_sq_wake_up
mdefine_line|#define write_sq_wake_up(file)&t;&t;sq_wake_up(&amp;write_sq, file, FMODE_WRITE)
DECL|macro|write_sq_release_buffers
mdefine_line|#define write_sq_release_buffers()&t;sq_release_buffers(&amp;write_sq)
DECL|macro|write_sq_open
mdefine_line|#define write_sq_open(file)&t;&bslash;&n;&t;sq_open2(&amp;write_sq, file, FMODE_WRITE, numWriteBufs, writeBufSize &lt;&lt; 10)
macro_line|#ifdef HAS_RECORD
DECL|macro|read_sq_init_waitqueue
mdefine_line|#define read_sq_init_waitqueue()&t;sq_init_waitqueue(&amp;read_sq)
DECL|macro|read_sq_wake_up
mdefine_line|#define read_sq_wake_up(file)&t;&t;sq_wake_up(&amp;read_sq, file, FMODE_READ)
DECL|macro|read_sq_release_buffers
mdefine_line|#define read_sq_release_buffers()&t;sq_release_buffers(&amp;read_sq)
DECL|macro|read_sq_open
mdefine_line|#define read_sq_open(file)&t;&bslash;&n;&t;sq_open2(&amp;read_sq, file, FMODE_READ, numReadBufs, readBufSize &lt;&lt; 10)
macro_line|#else /* !HAS_RECORD */
DECL|macro|read_sq_init_waitqueue
mdefine_line|#define read_sq_init_waitqueue()&t;do {} while (0)
DECL|macro|read_sq_wake_up
mdefine_line|#define read_sq_wake_up(file)&t;&t;do {} while (0)
DECL|macro|read_sq_release_buffers
mdefine_line|#define read_sq_release_buffers()&t;do {} while (0)
DECL|macro|read_sq_open
mdefine_line|#define read_sq_open(file)&t;&t;(0)
macro_line|#endif /* !HAS_RECORD */
DECL|function|sq_open
r_static
r_int
id|sq_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_int
id|rc
suffix:semicolon
id|dmasound.mach
dot
id|open
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|rc
op_assign
id|write_sq_open
c_func
(paren
id|file
)paren
)paren
op_logical_or
(paren
id|rc
op_assign
id|read_sq_open
c_func
(paren
id|file
)paren
)paren
)paren
(brace
id|dmasound.mach
dot
id|release
c_func
(paren
)paren
suffix:semicolon
r_return
id|rc
suffix:semicolon
)brace
r_if
c_cond
(paren
id|dmasound.mach.sq_open
)paren
id|dmasound.mach
dot
id|sq_open
c_func
(paren
)paren
suffix:semicolon
id|dmasound.minDev
op_assign
id|MINOR
c_func
(paren
id|inode-&gt;i_rdev
)paren
op_amp
l_int|0x0f
suffix:semicolon
id|dmasound.soft
op_assign
id|dmasound.dsp
suffix:semicolon
id|dmasound.hard
op_assign
id|dmasound.dsp
suffix:semicolon
id|sound_init
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|MINOR
c_func
(paren
id|inode-&gt;i_rdev
)paren
op_amp
l_int|0x0f
)paren
op_eq
id|SND_DEV_AUDIO
)paren
(brace
id|sound_set_speed
c_func
(paren
l_int|8000
)paren
suffix:semicolon
id|sound_set_stereo
c_func
(paren
l_int|0
)paren
suffix:semicolon
id|sound_set_format
c_func
(paren
id|AFMT_MU_LAW
)paren
suffix:semicolon
)brace
macro_line|#if 0
r_if
c_cond
(paren
id|file-&gt;f_mode
op_eq
id|FMODE_READ
op_logical_and
id|dmasound.mach.record
)paren
(brace
multiline_comment|/* Start dma&squot;ing straight away */
id|dmasound.mach
dot
id|record
c_func
(paren
)paren
suffix:semicolon
)brace
macro_line|#endif
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|sq_reset
r_static
r_void
id|sq_reset
c_func
(paren
r_void
)paren
(brace
id|sound_silence
c_func
(paren
)paren
suffix:semicolon
id|write_sq.active
op_assign
l_int|0
suffix:semicolon
id|write_sq.count
op_assign
l_int|0
suffix:semicolon
id|write_sq.front
op_assign
(paren
id|write_sq.rear
op_plus
l_int|1
)paren
op_mod
id|write_sq.max_count
suffix:semicolon
)brace
DECL|function|sq_fsync
r_static
r_int
id|sq_fsync
c_func
(paren
r_struct
id|file
op_star
id|filp
comma
r_struct
id|dentry
op_star
id|dentry
)paren
(brace
r_int
id|rc
op_assign
l_int|0
suffix:semicolon
id|write_sq.syncing
op_assign
l_int|1
suffix:semicolon
id|sq_play
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* there may be an incomplete frame waiting */
r_while
c_loop
(paren
id|write_sq.active
)paren
(brace
id|SLEEP
c_func
(paren
id|write_sq.sync_queue
)paren
suffix:semicolon
r_if
c_cond
(paren
id|signal_pending
c_func
(paren
id|current
)paren
)paren
(brace
multiline_comment|/* While waiting for audio output to drain, an&n;&t;&t;&t; * interrupt occurred.  Stop audio output immediately&n;&t;&t;&t; * and clear the queue. */
id|sq_reset
c_func
(paren
)paren
suffix:semicolon
id|rc
op_assign
op_minus
id|EINTR
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
id|write_sq.syncing
op_assign
l_int|0
suffix:semicolon
r_return
id|rc
suffix:semicolon
)brace
DECL|function|sq_release
r_static
r_int
id|sq_release
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_int
id|rc
op_assign
l_int|0
suffix:semicolon
id|lock_kernel
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|write_sq.busy
)paren
id|rc
op_assign
id|sq_fsync
c_func
(paren
id|file
comma
id|file-&gt;f_dentry
)paren
suffix:semicolon
id|dmasound.soft
op_assign
id|dmasound.dsp
suffix:semicolon
id|dmasound.hard
op_assign
id|dmasound.dsp
suffix:semicolon
id|sound_silence
c_func
(paren
)paren
suffix:semicolon
id|write_sq_release_buffers
c_func
(paren
)paren
suffix:semicolon
id|read_sq_release_buffers
c_func
(paren
)paren
suffix:semicolon
id|dmasound.mach
dot
id|release
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* There is probably a DOS atack here. They change the mode flag. */
multiline_comment|/* XXX add check here */
id|read_sq_wake_up
c_func
(paren
id|file
)paren
suffix:semicolon
id|write_sq_wake_up
c_func
(paren
id|file
)paren
suffix:semicolon
multiline_comment|/* Wake up a process waiting for the queue being released.&n;&t; * Note: There may be several processes waiting for a call&n;&t; * to open() returning. */
id|unlock_kernel
c_func
(paren
)paren
suffix:semicolon
r_return
id|rc
suffix:semicolon
)brace
DECL|function|sq_ioctl
r_static
r_int
id|sq_ioctl
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
comma
id|u_int
id|cmd
comma
id|u_long
id|arg
)paren
(brace
r_int
id|val
suffix:semicolon
id|u_long
id|fmt
suffix:semicolon
r_int
id|data
suffix:semicolon
r_int
id|size
comma
id|nbufs
suffix:semicolon
id|audio_buf_info
id|info
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|SNDCTL_DSP_RESET
suffix:colon
id|sq_reset
c_func
(paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|SNDCTL_DSP_POST
suffix:colon
r_case
id|SNDCTL_DSP_SYNC
suffix:colon
r_return
id|sq_fsync
c_func
(paren
id|file
comma
id|file-&gt;f_dentry
)paren
suffix:semicolon
multiline_comment|/* ++TeSche: before changing any of these it&squot;s&n;&t;&t; * probably wise to wait until sound playing has&n;&t;&t; * settled down. */
r_case
id|SNDCTL_DSP_SPEED
suffix:colon
id|sq_fsync
c_func
(paren
id|file
comma
id|file-&gt;f_dentry
)paren
suffix:semicolon
id|IOCTL_IN
c_func
(paren
id|arg
comma
id|data
)paren
suffix:semicolon
r_return
id|IOCTL_OUT
c_func
(paren
id|arg
comma
id|sound_set_speed
c_func
(paren
id|data
)paren
)paren
suffix:semicolon
r_case
id|SNDCTL_DSP_STEREO
suffix:colon
id|sq_fsync
c_func
(paren
id|file
comma
id|file-&gt;f_dentry
)paren
suffix:semicolon
id|IOCTL_IN
c_func
(paren
id|arg
comma
id|data
)paren
suffix:semicolon
r_return
id|IOCTL_OUT
c_func
(paren
id|arg
comma
id|sound_set_stereo
c_func
(paren
id|data
)paren
)paren
suffix:semicolon
r_case
id|SOUND_PCM_WRITE_CHANNELS
suffix:colon
id|sq_fsync
c_func
(paren
id|file
comma
id|file-&gt;f_dentry
)paren
suffix:semicolon
id|IOCTL_IN
c_func
(paren
id|arg
comma
id|data
)paren
suffix:semicolon
r_return
id|IOCTL_OUT
c_func
(paren
id|arg
comma
id|sound_set_stereo
c_func
(paren
id|data
op_minus
l_int|1
)paren
op_plus
l_int|1
)paren
suffix:semicolon
r_case
id|SNDCTL_DSP_SETFMT
suffix:colon
id|sq_fsync
c_func
(paren
id|file
comma
id|file-&gt;f_dentry
)paren
suffix:semicolon
id|IOCTL_IN
c_func
(paren
id|arg
comma
id|data
)paren
suffix:semicolon
r_return
id|IOCTL_OUT
c_func
(paren
id|arg
comma
id|sound_set_format
c_func
(paren
id|data
)paren
)paren
suffix:semicolon
r_case
id|SNDCTL_DSP_GETFMTS
suffix:colon
id|fmt
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|dmasound.trans_write
)paren
(brace
r_if
c_cond
(paren
id|dmasound.trans_write-&gt;ct_ulaw
)paren
id|fmt
op_or_assign
id|AFMT_MU_LAW
suffix:semicolon
r_if
c_cond
(paren
id|dmasound.trans_write-&gt;ct_alaw
)paren
id|fmt
op_or_assign
id|AFMT_A_LAW
suffix:semicolon
r_if
c_cond
(paren
id|dmasound.trans_write-&gt;ct_s8
)paren
id|fmt
op_or_assign
id|AFMT_S8
suffix:semicolon
r_if
c_cond
(paren
id|dmasound.trans_write-&gt;ct_u8
)paren
id|fmt
op_or_assign
id|AFMT_U8
suffix:semicolon
r_if
c_cond
(paren
id|dmasound.trans_write-&gt;ct_s16be
)paren
id|fmt
op_or_assign
id|AFMT_S16_BE
suffix:semicolon
r_if
c_cond
(paren
id|dmasound.trans_write-&gt;ct_u16be
)paren
id|fmt
op_or_assign
id|AFMT_U16_BE
suffix:semicolon
r_if
c_cond
(paren
id|dmasound.trans_write-&gt;ct_s16le
)paren
id|fmt
op_or_assign
id|AFMT_S16_LE
suffix:semicolon
r_if
c_cond
(paren
id|dmasound.trans_write-&gt;ct_u16le
)paren
id|fmt
op_or_assign
id|AFMT_U16_LE
suffix:semicolon
)brace
r_return
id|IOCTL_OUT
c_func
(paren
id|arg
comma
id|fmt
)paren
suffix:semicolon
r_case
id|SNDCTL_DSP_GETBLKSIZE
suffix:colon
id|size
op_assign
id|write_sq.block_size
op_star
id|dmasound.soft.size
op_star
(paren
id|dmasound.soft.stereo
op_plus
l_int|1
)paren
op_div
(paren
id|dmasound.hard.size
op_star
(paren
id|dmasound.hard.stereo
op_plus
l_int|1
)paren
)paren
suffix:semicolon
r_return
id|IOCTL_OUT
c_func
(paren
id|arg
comma
id|size
)paren
suffix:semicolon
r_case
id|SNDCTL_DSP_SUBDIVIDE
suffix:colon
r_break
suffix:semicolon
r_case
id|SNDCTL_DSP_SETFRAGMENT
suffix:colon
r_if
c_cond
(paren
id|write_sq.count
op_logical_or
id|write_sq.active
op_logical_or
id|write_sq.syncing
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|IOCTL_IN
c_func
(paren
id|arg
comma
id|size
)paren
suffix:semicolon
id|nbufs
op_assign
id|size
op_rshift
l_int|16
suffix:semicolon
r_if
c_cond
(paren
id|nbufs
template_param
id|write_sq.numBufs
)paren
id|nbufs
op_assign
id|write_sq.numBufs
suffix:semicolon
id|size
op_and_assign
l_int|0xffff
suffix:semicolon
r_if
c_cond
(paren
id|size
op_ge
l_int|8
op_logical_and
id|size
op_le
l_int|29
)paren
(brace
id|size
op_assign
l_int|1
op_lshift
id|size
suffix:semicolon
id|size
op_mul_assign
id|dmasound.hard.size
op_star
(paren
id|dmasound.hard.stereo
op_plus
l_int|1
)paren
suffix:semicolon
id|size
op_div_assign
id|dmasound.soft.size
op_star
(paren
id|dmasound.soft.stereo
op_plus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|size
OG
id|write_sq.bufSize
)paren
id|size
op_assign
id|write_sq.bufSize
suffix:semicolon
)brace
r_else
id|size
op_assign
id|write_sq.bufSize
suffix:semicolon
id|sq_setup
c_func
(paren
op_amp
id|write_sq
comma
id|write_sq.numBufs
comma
id|nbufs
comma
id|size
)paren
suffix:semicolon
r_return
id|IOCTL_OUT
c_func
(paren
id|arg
comma
id|write_sq.bufSize
op_or
id|write_sq.numBufs
op_lshift
l_int|16
)paren
suffix:semicolon
r_case
id|SNDCTL_DSP_GETOSPACE
suffix:colon
id|info.fragments
op_assign
id|write_sq.max_active
op_minus
id|write_sq.count
suffix:semicolon
id|info.fragstotal
op_assign
id|write_sq.max_active
suffix:semicolon
id|info.fragsize
op_assign
id|write_sq.block_size
suffix:semicolon
id|info.bytes
op_assign
id|info.fragments
op_star
id|info.fragsize
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
(paren
r_void
op_star
)paren
id|arg
comma
op_amp
id|info
comma
r_sizeof
(paren
id|info
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|SNDCTL_DSP_GETCAPS
suffix:colon
id|val
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* Revision level of this ioctl() */
r_return
id|IOCTL_OUT
c_func
(paren
id|arg
comma
id|val
)paren
suffix:semicolon
r_default
suffix:colon
r_return
id|mixer_ioctl
c_func
(paren
id|inode
comma
id|file
comma
id|cmd
comma
id|arg
)paren
suffix:semicolon
)brace
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
DECL|variable|sq_fops
r_static
r_struct
id|file_operations
id|sq_fops
op_assign
(brace
id|owner
suffix:colon
id|THIS_MODULE
comma
id|llseek
suffix:colon
id|sound_lseek
comma
id|write
suffix:colon
id|sq_write
comma
id|ioctl
suffix:colon
id|sq_ioctl
comma
id|open
suffix:colon
id|sq_open
comma
id|release
suffix:colon
id|sq_release
comma
macro_line|#ifdef HAS_RECORD
id|read
suffix:colon
id|sq_read
comma
macro_line|#endif
)brace
suffix:semicolon
DECL|function|sq_init
r_static
r_void
id|__init
id|sq_init
c_func
(paren
r_void
)paren
(brace
macro_line|#ifndef MODULE
r_int
id|sq_unit
suffix:semicolon
macro_line|#endif
id|sq_unit
op_assign
id|register_sound_dsp
c_func
(paren
op_amp
id|sq_fops
comma
op_minus
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|sq_unit
OL
l_int|0
)paren
r_return
suffix:semicolon
id|write_sq_init_waitqueue
c_func
(paren
)paren
suffix:semicolon
id|read_sq_init_waitqueue
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* whatever you like as startup mode for /dev/dsp,&n;&t; * (/dev/audio hasn&squot;t got a startup mode). note that&n;&t; * once changed a new open() will *not* restore these!&n;&t; */
id|dmasound.dsp.format
op_assign
id|AFMT_U8
suffix:semicolon
id|dmasound.dsp.stereo
op_assign
l_int|0
suffix:semicolon
id|dmasound.dsp.size
op_assign
l_int|8
suffix:semicolon
multiline_comment|/* set minimum rate possible without expanding */
id|dmasound.dsp.speed
op_assign
id|dmasound.mach.min_dsp_speed
suffix:semicolon
multiline_comment|/* before the first open to /dev/dsp this wouldn&squot;t be set */
id|dmasound.soft
op_assign
id|dmasound.dsp
suffix:semicolon
id|dmasound.hard
op_assign
id|dmasound.dsp
suffix:semicolon
id|sound_silence
c_func
(paren
)paren
suffix:semicolon
)brace
multiline_comment|/*&n;     *  /dev/sndstat&n;     */
r_static
r_struct
(brace
DECL|member|busy
r_int
id|busy
suffix:semicolon
DECL|member|buf
r_char
id|buf
(braket
l_int|512
)braket
suffix:semicolon
multiline_comment|/* state.buf should not overflow! */
DECL|member|len
DECL|member|ptr
r_int
id|len
comma
id|ptr
suffix:semicolon
DECL|variable|state
)brace
id|state
suffix:semicolon
DECL|function|state_open
r_static
r_int
id|state_open
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
r_char
op_star
id|buffer
op_assign
id|state.buf
suffix:semicolon
r_int
id|len
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|state.busy
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
id|dmasound.mach
dot
id|open
c_func
(paren
)paren
suffix:semicolon
id|state.ptr
op_assign
l_int|0
suffix:semicolon
id|state.busy
op_assign
l_int|1
suffix:semicolon
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot;%sDMA sound driver:&bslash;n&quot;
comma
id|dmasound.mach.name
)paren
suffix:semicolon
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot;&bslash;tsound.format = 0x%x&quot;
comma
id|dmasound.soft.format
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|dmasound.soft.format
)paren
(brace
r_case
id|AFMT_MU_LAW
suffix:colon
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot; (mu-law)&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AFMT_A_LAW
suffix:colon
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot; (A-law)&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AFMT_U8
suffix:colon
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot; (unsigned 8 bit)&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AFMT_S8
suffix:colon
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot; (signed 8 bit)&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AFMT_S16_BE
suffix:colon
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot; (signed 16 bit big)&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AFMT_U16_BE
suffix:colon
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot; (unsigned 16 bit big)&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AFMT_S16_LE
suffix:colon
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot; (signed 16 bit little)&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|AFMT_U16_LE
suffix:colon
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot; (unsigned 16 bit little)&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot;&bslash;tsound.speed = %dHz (phys. %dHz)&bslash;n&quot;
comma
id|dmasound.soft.speed
comma
id|dmasound.hard.speed
)paren
suffix:semicolon
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot;&bslash;tsound.stereo = 0x%x (%s)&bslash;n&quot;
comma
id|dmasound.soft.stereo
comma
id|dmasound.soft.stereo
ques
c_cond
l_string|&quot;stereo&quot;
suffix:colon
l_string|&quot;mono&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dmasound.mach.state_info
)paren
id|len
op_add_assign
id|dmasound.mach
dot
id|state_info
c_func
(paren
id|buffer
)paren
suffix:semicolon
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot;&bslash;tsq.block_size = %d sq.max_count = %d&quot;
l_string|&quot; sq.max_active = %d&bslash;n&quot;
comma
id|write_sq.block_size
comma
id|write_sq.max_count
comma
id|write_sq.max_active
)paren
suffix:semicolon
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot;&bslash;tsq.count = %d sq.rear_size = %d&bslash;n&quot;
comma
id|write_sq.count
comma
id|write_sq.rear_size
)paren
suffix:semicolon
id|len
op_add_assign
id|sprintf
c_func
(paren
id|buffer
op_plus
id|len
comma
l_string|&quot;&bslash;tsq.active = %d sq.syncing = %d&bslash;n&quot;
comma
id|write_sq.active
comma
id|write_sq.syncing
)paren
suffix:semicolon
id|state.len
op_assign
id|len
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|state_release
r_static
r_int
id|state_release
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|file
op_star
id|file
)paren
(brace
id|lock_kernel
c_func
(paren
)paren
suffix:semicolon
id|state.busy
op_assign
l_int|0
suffix:semicolon
id|dmasound.mach
dot
id|release
c_func
(paren
)paren
suffix:semicolon
id|unlock_kernel
c_func
(paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|state_read
r_static
id|ssize_t
id|state_read
c_func
(paren
r_struct
id|file
op_star
id|file
comma
r_char
op_star
id|buf
comma
r_int
id|count
comma
id|loff_t
op_star
id|ppos
)paren
(brace
r_int
id|n
op_assign
id|state.len
op_minus
id|state.ptr
suffix:semicolon
r_if
c_cond
(paren
id|n
OG
id|count
)paren
id|n
op_assign
id|count
suffix:semicolon
r_if
c_cond
(paren
id|n
op_le
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|copy_to_user
c_func
(paren
id|buf
comma
op_amp
id|state.buf
(braket
id|state.ptr
)braket
comma
id|n
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
id|state.ptr
op_add_assign
id|n
suffix:semicolon
r_return
id|n
suffix:semicolon
)brace
DECL|variable|state_fops
r_static
r_struct
id|file_operations
id|state_fops
op_assign
(brace
id|owner
suffix:colon
id|THIS_MODULE
comma
id|llseek
suffix:colon
id|sound_lseek
comma
id|read
suffix:colon
id|state_read
comma
id|open
suffix:colon
id|state_open
comma
id|release
suffix:colon
id|state_release
comma
)brace
suffix:semicolon
DECL|function|state_init
r_static
r_void
id|__init
id|state_init
c_func
(paren
r_void
)paren
(brace
macro_line|#ifndef MODULE
r_int
id|state_unit
suffix:semicolon
macro_line|#endif
id|state_unit
op_assign
id|register_sound_special
c_func
(paren
op_amp
id|state_fops
comma
id|SND_DEV_STATUS
)paren
suffix:semicolon
r_if
c_cond
(paren
id|state_unit
OL
l_int|0
)paren
r_return
suffix:semicolon
id|state.busy
op_assign
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n;     *  Config &amp; Setup&n;     *&n;     *  This function is called by _one_ chipset-specific driver&n;     */
DECL|function|dmasound_init
r_int
id|__init
id|dmasound_init
c_func
(paren
r_void
)paren
(brace
macro_line|#ifdef MODULE
r_if
c_cond
(paren
id|irq_installed
)paren
r_return
op_minus
id|EBUSY
suffix:semicolon
macro_line|#endif
multiline_comment|/* Set up sound queue, /dev/audio and /dev/dsp. */
multiline_comment|/* Set default settings. */
id|sq_init
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* Set up /dev/sndstat. */
id|state_init
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* Set up /dev/mixer. */
id|mixer_init
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|dmasound.mach
dot
id|irqinit
c_func
(paren
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;DMA sound driver: Interrupt initialization failed&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|ENODEV
suffix:semicolon
)brace
macro_line|#ifdef MODULE
id|irq_installed
op_assign
l_int|1
suffix:semicolon
macro_line|#endif
id|printk
c_func
(paren
id|KERN_INFO
l_string|&quot;DMA sound driver installed, using %d buffers of %dk.&bslash;n&quot;
comma
id|numWriteBufs
comma
id|writeBufSize
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
macro_line|#ifdef MODULE
DECL|function|dmasound_deinit
r_void
id|dmasound_deinit
c_func
(paren
r_void
)paren
(brace
r_if
c_cond
(paren
id|irq_installed
)paren
(brace
id|sound_silence
c_func
(paren
)paren
suffix:semicolon
id|dmasound.mach
dot
id|irqcleanup
c_func
(paren
)paren
suffix:semicolon
)brace
id|write_sq_release_buffers
c_func
(paren
)paren
suffix:semicolon
id|read_sq_release_buffers
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mixer_unit
op_ge
l_int|0
)paren
id|unregister_sound_mixer
c_func
(paren
id|mixer_unit
)paren
suffix:semicolon
r_if
c_cond
(paren
id|state_unit
op_ge
l_int|0
)paren
id|unregister_sound_special
c_func
(paren
id|state_unit
)paren
suffix:semicolon
r_if
c_cond
(paren
id|sq_unit
op_ge
l_int|0
)paren
id|unregister_sound_dsp
c_func
(paren
id|sq_unit
)paren
suffix:semicolon
)brace
macro_line|#else /* !MODULE */
DECL|function|dmasound_setup
r_static
r_int
id|__init
id|dmasound_setup
c_func
(paren
r_char
op_star
id|str
)paren
(brace
r_int
id|ints
(braket
l_int|6
)braket
suffix:semicolon
id|str
op_assign
id|get_options
c_func
(paren
id|str
comma
id|ARRAY_SIZE
c_func
(paren
id|ints
)paren
comma
id|ints
)paren
suffix:semicolon
multiline_comment|/* check the bootstrap parameter for &quot;dmasound=&quot; */
r_switch
c_cond
(paren
id|ints
(braket
l_int|0
)braket
)paren
(brace
r_case
l_int|3
suffix:colon
r_if
c_cond
(paren
(paren
id|ints
(braket
l_int|3
)braket
OL
l_int|0
)paren
op_logical_or
(paren
id|ints
(braket
l_int|3
)braket
OG
id|MAX_CATCH_RADIUS
)paren
)paren
id|printk
c_func
(paren
l_string|&quot;dmasound_setup: illegal catch radius, using default = %d&bslash;n&quot;
comma
id|catchRadius
)paren
suffix:semicolon
r_else
id|catchRadius
op_assign
id|ints
(braket
l_int|3
)braket
suffix:semicolon
multiline_comment|/* fall through */
r_case
l_int|2
suffix:colon
r_if
c_cond
(paren
id|ints
(braket
l_int|1
)braket
OL
id|MIN_BUFFERS
)paren
id|printk
c_func
(paren
l_string|&quot;dmasound_setup: illegal number of buffers, using default = %d&bslash;n&quot;
comma
id|numWriteBufs
)paren
suffix:semicolon
r_else
id|numWriteBufs
op_assign
id|ints
(braket
l_int|1
)braket
suffix:semicolon
r_if
c_cond
(paren
id|ints
(braket
l_int|2
)braket
template_param
id|MAX_BUFSIZE
)paren
id|printk
c_func
(paren
l_string|&quot;dmasound_setup: illegal buffer size, using default = %dK&bslash;n&quot;
comma
id|writeBufSize
)paren
suffix:semicolon
r_else
id|writeBufSize
op_assign
id|ints
(braket
l_int|2
)braket
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|0
suffix:colon
r_break
suffix:semicolon
r_default
suffix:colon
id|printk
c_func
(paren
l_string|&quot;dmasound_setup: illegal number of arguments&bslash;n&quot;
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_return
l_int|1
suffix:semicolon
)brace
id|__setup
c_func
(paren
l_string|&quot;dmasound=&quot;
comma
id|dmasound_setup
)paren
suffix:semicolon
macro_line|#endif /* !MODULE */
multiline_comment|/*&n;     *  Visible symbols for modules&n;     */
DECL|variable|dmasound
id|EXPORT_SYMBOL
c_func
(paren
id|dmasound
)paren
suffix:semicolon
DECL|variable|dmasound_init
id|EXPORT_SYMBOL
c_func
(paren
id|dmasound_init
)paren
suffix:semicolon
macro_line|#ifdef MODULE
DECL|variable|dmasound_deinit
id|EXPORT_SYMBOL
c_func
(paren
id|dmasound_deinit
)paren
suffix:semicolon
macro_line|#endif
DECL|variable|dmasound_write_sq
id|EXPORT_SYMBOL
c_func
(paren
id|dmasound_write_sq
)paren
suffix:semicolon
macro_line|#ifdef HAS_RECORD
DECL|variable|dmasound_read_sq
id|EXPORT_SYMBOL
c_func
(paren
id|dmasound_read_sq
)paren
suffix:semicolon
macro_line|#endif
DECL|variable|dmasound_catchRadius
id|EXPORT_SYMBOL
c_func
(paren
id|dmasound_catchRadius
)paren
suffix:semicolon
macro_line|#ifdef HAS_8BIT_TABLES
DECL|variable|dmasound_ulaw2dma8
id|EXPORT_SYMBOL
c_func
(paren
id|dmasound_ulaw2dma8
)paren
suffix:semicolon
DECL|variable|dmasound_alaw2dma8
id|EXPORT_SYMBOL
c_func
(paren
id|dmasound_alaw2dma8
)paren
suffix:semicolon
macro_line|#endif
macro_line|#ifdef HAS_16BIT_TABLES
DECL|variable|dmasound_ulaw2dma16
id|EXPORT_SYMBOL
c_func
(paren
id|dmasound_ulaw2dma16
)paren
suffix:semicolon
DECL|variable|dmasound_alaw2dma16
id|EXPORT_SYMBOL
c_func
(paren
id|dmasound_alaw2dma16
)paren
suffix:semicolon
macro_line|#endif
macro_line|#ifdef HAS_14BIT_TABLES
DECL|variable|dmasound_ulaw2dma14l
id|EXPORT_SYMBOL
c_func
(paren
id|dmasound_ulaw2dma14l
)paren
suffix:semicolon
DECL|variable|dmasound_ulaw2dma14h
id|EXPORT_SYMBOL
c_func
(paren
id|dmasound_ulaw2dma14h
)paren
suffix:semicolon
DECL|variable|dmasound_alaw2dma14l
id|EXPORT_SYMBOL
c_func
(paren
id|dmasound_alaw2dma14l
)paren
suffix:semicolon
DECL|variable|dmasound_alaw2dma14h
id|EXPORT_SYMBOL
c_func
(paren
id|dmasound_alaw2dma14h
)paren
suffix:semicolon
macro_line|#endif
eof
