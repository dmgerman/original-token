multiline_comment|/*&n; * sound/configure.c&t;- Configuration program for the Linux Sound Driver&n; * &n; * Copyright by Hannu Savolainen 1993&n; * &n; * Redistribution and use in source and binary forms, with or without&n; * modification, are permitted provided that the following conditions are&n; * met: 1. Redistributions of source code must retain the above copyright&n; * notice, this list of conditions and the following disclaimer. 2.&n; * Redistributions in binary form must reproduce the above copyright notice,&n; * this list of conditions and the following disclaimer in the documentation&n; * and/or other materials provided with the distribution.&n; * &n; * THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS&squot;&squot; AND ANY&n; * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED&n; * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE&n; * DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE FOR&n; * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL&n; * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR&n; * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER&n; * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT&n; * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY&n; * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF&n; * SUCH DAMAGE.&n; * &n; */
macro_line|#include &lt;stdio.h&gt;
DECL|macro|B
mdefine_line|#define B(x)&t;(1 &lt;&lt; (x))
multiline_comment|/*&n; * Option numbers&n; */
DECL|macro|OPT_PAS
mdefine_line|#define OPT_PAS&t;&t;0
DECL|macro|OPT_SB
mdefine_line|#define OPT_SB&t;&t;1
DECL|macro|OPT_ADLIB
mdefine_line|#define OPT_ADLIB&t;2
DECL|macro|OPT_LAST_MUTUAL
mdefine_line|#define OPT_LAST_MUTUAL&t;2
DECL|macro|OPT_GUS
mdefine_line|#define OPT_GUS&t;&t;3
DECL|macro|OPT_MPU401
mdefine_line|#define OPT_MPU401&t;4
DECL|macro|OPT_HIGHLEVEL
mdefine_line|#define OPT_HIGHLEVEL   5
DECL|macro|OPT_SBPRO
mdefine_line|#define OPT_SBPRO&t;5
DECL|macro|OPT_SB16
mdefine_line|#define OPT_SB16&t;6
DECL|macro|OPT_AUDIO
mdefine_line|#define OPT_AUDIO&t;7
DECL|macro|OPT_MIDI_AUTO
mdefine_line|#define OPT_MIDI_AUTO&t;8
DECL|macro|OPT_MIDI
mdefine_line|#define OPT_MIDI&t;9
DECL|macro|OPT_YM3812_AUTO
mdefine_line|#define OPT_YM3812_AUTO&t;10&t;/* Select this automaticly if user selects&n;&t;&t;&t;&t; * MIDI or AdLib driver */
DECL|macro|OPT_YM3812
mdefine_line|#define OPT_YM3812&t;11&t;/* Select this if the previous one was not&n;&t;&t;&t;&t; * selected */
DECL|macro|OPT_SEQUENCER
mdefine_line|#define OPT_SEQUENCER&t;12
DECL|macro|OPT_CHIP_MIDI
mdefine_line|#define OPT_CHIP_MIDI   13&t;/* New support added at UW - Milwauklee UW -&n;&t;&t;&t;&t; * Milwauklee */
DECL|macro|OPT_LAST
mdefine_line|#define OPT_LAST&t;12
DECL|macro|ANY_DEVS
mdefine_line|#define ANY_DEVS (B(OPT_AUDIO)|B(OPT_MIDI)|B(OPT_SEQUENCER)|B(OPT_GUS)|B(OPT_MPU401))
r_typedef
r_struct
(brace
DECL|member|conditions
r_int
r_int
id|conditions
suffix:semicolon
DECL|member|exclusive_options
r_int
r_int
id|exclusive_options
suffix:semicolon
DECL|member|macro
r_char
id|macro
(braket
l_int|20
)braket
suffix:semicolon
DECL|member|verify
r_int
id|verify
suffix:semicolon
DECL|member|alias
r_int
id|alias
suffix:semicolon
DECL|member|default_answ
r_int
id|default_answ
suffix:semicolon
)brace
DECL|typedef|hw_entry
id|hw_entry
suffix:semicolon
multiline_comment|/*&n; * The rule table for the driver options. The first field defines a set of&n; * options which must be selected before this entry can be selected. The&n; * second field is a set of options which are not allowed with this one. If&n; * the fourth field is zero, the option is selected without asking&n; * confirmation from the user.&n; * &n; * With this version of the rule table it is possible to select just one type of&n; * hardware.&n; * &n; * NOTE!&t;Keep the following table and the questions array in sync with the&n; * option numbering!&n; */
DECL|variable|hw_table
id|hw_entry
id|hw_table
(braket
)braket
op_assign
(brace
multiline_comment|/* 0 */
(brace
l_int|0
comma
l_int|0
comma
l_string|&quot;PAS&quot;
comma
l_int|1
comma
l_int|0
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|0
comma
l_string|&quot;SB&quot;
comma
l_int|1
comma
l_int|0
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
id|B
(paren
id|OPT_PAS
)paren
op_or
id|B
(paren
id|OPT_SB
)paren
comma
l_string|&quot;ADLIB&quot;
comma
l_int|1
comma
l_int|0
comma
l_int|0
)brace
comma
multiline_comment|/* 3 */
(brace
l_int|0
comma
l_int|0
comma
l_string|&quot;GUS&quot;
comma
l_int|1
comma
l_int|0
comma
l_int|0
)brace
comma
(brace
l_int|0
comma
l_int|0
comma
l_string|&quot;MPU401&quot;
comma
l_int|1
comma
l_int|0
comma
l_int|0
)brace
comma
(brace
id|B
(paren
id|OPT_SB
)paren
comma
id|B
(paren
id|OPT_PAS
)paren
comma
l_string|&quot;SBPRO&quot;
comma
l_int|1
comma
l_int|0
comma
l_int|1
)brace
comma
(brace
id|B
(paren
id|OPT_SB
)paren
op_or
id|B
(paren
id|OPT_SBPRO
)paren
comma
id|B
(paren
id|OPT_PAS
)paren
comma
l_string|&quot;SB16&quot;
comma
l_int|1
comma
l_int|0
comma
l_int|1
)brace
comma
(brace
id|B
(paren
id|OPT_SB
)paren
op_or
id|B
(paren
id|OPT_PAS
)paren
op_or
id|B
(paren
id|OPT_GUS
)paren
comma
l_int|0
comma
l_string|&quot;AUDIO&quot;
comma
l_int|1
comma
l_int|0
comma
l_int|1
)brace
comma
(brace
id|B
(paren
id|OPT_MPU401
)paren
comma
l_int|0
comma
l_string|&quot;MIDI_AUTO&quot;
comma
l_int|0
comma
id|OPT_MIDI
comma
l_int|0
)brace
comma
(brace
id|B
(paren
id|OPT_SB
)paren
op_or
id|B
(paren
id|OPT_PAS
)paren
op_or
id|B
(paren
id|OPT_MPU401
)paren
op_or
id|B
(paren
id|OPT_GUS
)paren
comma
l_int|0
comma
l_string|&quot;MIDI&quot;
comma
l_int|1
comma
l_int|0
comma
l_int|1
)brace
comma
(brace
id|B
(paren
id|OPT_ADLIB
)paren
comma
l_int|0
comma
l_string|&quot;YM3812_AUTO&quot;
comma
l_int|0
comma
id|OPT_YM3812
comma
l_int|0
)brace
comma
(brace
id|B
(paren
id|OPT_SB
)paren
op_or
id|B
(paren
id|OPT_PAS
)paren
op_or
id|B
(paren
id|OPT_ADLIB
)paren
comma
id|B
(paren
id|OPT_YM3812_AUTO
)paren
comma
l_string|&quot;YM3812&quot;
comma
l_int|1
comma
l_int|0
comma
l_int|1
)brace
comma
multiline_comment|/* 10 */
(brace
id|B
(paren
id|OPT_MIDI
)paren
op_or
id|B
(paren
id|OPT_YM3812
)paren
op_or
id|B
(paren
id|OPT_YM3812_AUTO
)paren
op_or
id|B
(paren
id|OPT_GUS
)paren
comma
l_int|0
comma
l_string|&quot;SEQUENCER&quot;
comma
l_int|0
comma
l_int|0
comma
l_int|1
)brace
comma
(brace
l_int|0
comma
l_int|0
comma
l_string|&quot;CHIP_MIDI&quot;
comma
l_int|1
comma
l_int|0
comma
l_int|0
)brace
)brace
suffix:semicolon
DECL|variable|questions
r_char
op_star
id|questions
(braket
)braket
op_assign
(brace
l_string|&quot;ProAudioSpectrum 16 support&quot;
comma
l_string|&quot;SoundBlaster support&quot;
comma
l_string|&quot;AdLib support&quot;
comma
l_string|&quot;Gravis Ultrasound support&quot;
comma
l_string|&quot;MPU-401 support (NOT for SB16)&quot;
comma
l_string|&quot;SoundBlaster Pro support&quot;
comma
l_string|&quot;SoundBlaster 16 support&quot;
comma
l_string|&quot;digitized voice support&quot;
comma
l_string|&quot;This should not be asked&quot;
comma
l_string|&quot;MIDI interface support&quot;
comma
l_string|&quot;This should not be asked&quot;
comma
l_string|&quot;FM synthesizer (YM3812/OPL-3) support&quot;
comma
l_string|&quot;/dev/sequencer support&quot;
comma
l_string|&quot;MIDI on CHIP support&quot;
)brace
suffix:semicolon
DECL|variable|selected_options
r_int
r_int
id|selected_options
op_assign
l_int|0
suffix:semicolon
DECL|variable|sb_dma
r_int
id|sb_dma
op_assign
l_int|0
suffix:semicolon
r_int
DECL|function|can_select_option
id|can_select_option
(paren
r_int
id|nr
)paren
(brace
r_switch
c_cond
(paren
id|nr
)paren
(brace
r_case
l_int|0
suffix:colon
id|fprintf
(paren
id|stderr
comma
l_string|&quot;The SoundBlaster, AdLib and ProAudioSpectrum&bslash;n&quot;
l_string|&quot;cards cannot be installed at the same time&bslash;n&quot;
)paren
suffix:semicolon
id|fprintf
(paren
id|stderr
comma
l_string|&quot;&bslash;nSelect at most one of them:&bslash;n&quot;
)paren
suffix:semicolon
id|fprintf
(paren
id|stderr
comma
l_string|&quot;&t;- ProAudioSpectrum 16&bslash;n&quot;
)paren
suffix:semicolon
id|fprintf
(paren
id|stderr
comma
l_string|&quot;&t;- SoundBlaster / SB Pro&bslash;n&quot;
)paren
suffix:semicolon
id|fprintf
(paren
id|stderr
comma
l_string|&quot;          (Could be selected with PAS16 also&bslash;n&quot;
l_string|&quot;&t;  since there is a SB emulation on it)&bslash;n&quot;
)paren
suffix:semicolon
id|fprintf
(paren
id|stderr
comma
l_string|&quot;&t;- AdLib&bslash;n&quot;
)paren
suffix:semicolon
id|fprintf
(paren
id|stderr
comma
l_string|&quot;&bslash;nDon&squot;t enable SoundBlaster if you have GUS at 0x220!&bslash;n&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|OPT_LAST_MUTUAL
op_plus
l_int|1
suffix:colon
id|fprintf
(paren
id|stderr
comma
l_string|&quot;&bslash;nThe following cards should work with any other cards.&bslash;n&quot;
l_string|&quot;CAUTION! Don&squot;t enable MPU-401 if you don&squot;t have it.&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|OPT_HIGHLEVEL
suffix:colon
id|fprintf
(paren
id|stderr
comma
l_string|&quot;&bslash;nSelect one or more of the following options&bslash;n&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_if
c_cond
(paren
id|hw_table
(braket
id|nr
)braket
dot
id|conditions
)paren
r_if
c_cond
(paren
op_logical_neg
(paren
id|hw_table
(braket
id|nr
)braket
dot
id|conditions
op_amp
id|selected_options
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|hw_table
(braket
id|nr
)braket
dot
id|exclusive_options
)paren
r_if
c_cond
(paren
id|hw_table
(braket
id|nr
)braket
dot
id|exclusive_options
op_amp
id|selected_options
)paren
r_return
l_int|0
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
r_int
DECL|function|think_positively
id|think_positively
(paren
r_int
id|def_answ
)paren
(brace
r_char
id|answ
(braket
l_int|512
)braket
suffix:semicolon
r_int
id|len
suffix:semicolon
r_if
c_cond
(paren
(paren
id|len
op_assign
id|read
(paren
l_int|0
comma
op_amp
id|answ
comma
r_sizeof
(paren
id|answ
)paren
)paren
)paren
OL
l_int|1
)paren
(brace
id|fprintf
(paren
id|stderr
comma
l_string|&quot;&bslash;n&bslash;nERROR! Cannot read stdin&bslash;n&quot;
)paren
suffix:semicolon
id|perror
(paren
l_string|&quot;stdin&quot;
)paren
suffix:semicolon
id|printf
(paren
l_string|&quot;#undef CONFIGURE_SOUNDCARD&bslash;n&quot;
)paren
suffix:semicolon
id|printf
(paren
l_string|&quot;#undef KERNEL_SOUNDCARD&bslash;n&quot;
)paren
suffix:semicolon
m_exit
(paren
op_minus
l_int|1
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|len
OL
l_int|2
)paren
multiline_comment|/* There is an additional LF at the end */
r_return
id|def_answ
suffix:semicolon
id|answ
(braket
id|len
op_minus
l_int|1
)braket
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strcmp
(paren
id|answ
comma
l_string|&quot;y&quot;
)paren
op_logical_or
op_logical_neg
id|strcmp
(paren
id|answ
comma
l_string|&quot;Y&quot;
)paren
)paren
r_return
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_int
DECL|function|ask_value
id|ask_value
(paren
r_char
op_star
id|format
comma
r_int
id|default_answer
)paren
(brace
r_char
id|answ
(braket
l_int|512
)braket
suffix:semicolon
r_int
id|len
comma
id|num
suffix:semicolon
id|play_it_again_Sam
suffix:colon
r_if
c_cond
(paren
(paren
id|len
op_assign
id|read
(paren
l_int|0
comma
op_amp
id|answ
comma
r_sizeof
(paren
id|answ
)paren
)paren
)paren
OL
l_int|1
)paren
(brace
id|fprintf
(paren
id|stderr
comma
l_string|&quot;&bslash;n&bslash;nERROR! Cannot read stdin&bslash;n&quot;
)paren
suffix:semicolon
id|perror
(paren
l_string|&quot;stdin&quot;
)paren
suffix:semicolon
id|printf
(paren
l_string|&quot;#undef CONFIGURE_SOUNDCARD&bslash;n&quot;
)paren
suffix:semicolon
id|printf
(paren
l_string|&quot;#undef KERNEL_SOUNDCARD&bslash;n&quot;
)paren
suffix:semicolon
m_exit
(paren
op_minus
l_int|1
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|len
OL
l_int|2
)paren
multiline_comment|/* There is an additional LF at the end */
r_return
id|default_answer
suffix:semicolon
id|answ
(braket
id|len
op_minus
l_int|1
)braket
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|sscanf
(paren
id|answ
comma
id|format
comma
op_amp
id|num
)paren
op_ne
l_int|1
)paren
(brace
id|fprintf
(paren
id|stderr
comma
l_string|&quot;Illegal format. Try again: &quot;
)paren
suffix:semicolon
r_goto
id|play_it_again_Sam
suffix:semicolon
)brace
r_return
id|num
suffix:semicolon
)brace
r_int
DECL|function|main
id|main
(paren
r_int
id|argc
comma
r_char
op_star
id|argv
(braket
)braket
)paren
(brace
r_int
id|i
comma
id|num
comma
id|def_size
comma
id|full_driver
op_assign
l_int|1
suffix:semicolon
r_char
id|answ
(braket
l_int|10
)braket
suffix:semicolon
id|printf
(paren
l_string|&quot;/*&bslash;tGenerated by configure. Don&squot;t edit!!!!&bslash;t*/&bslash;n&bslash;n&quot;
)paren
suffix:semicolon
id|fprintf
(paren
id|stderr
comma
l_string|&quot;&bslash;nConfiguring the sound support&bslash;n&bslash;n&quot;
)paren
suffix:semicolon
id|fprintf
(paren
id|stderr
comma
l_string|&quot;Do you want to include full version of the sound driver (n/y) ? &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|think_positively
(paren
l_int|0
)paren
)paren
(brace
id|selected_options
op_assign
l_int|0xffffffff
op_amp
op_complement
id|B
(paren
id|OPT_MPU401
)paren
suffix:semicolon
id|fprintf
(paren
id|stderr
comma
l_string|&quot;Note! MPU-401 driver was not enabled&bslash;n&quot;
)paren
suffix:semicolon
id|full_driver
op_assign
l_int|1
suffix:semicolon
)brace
r_else
(brace
id|fprintf
(paren
id|stderr
comma
l_string|&quot;Do you want to DISABLE the Sound Driver (n/y) ?&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|think_positively
(paren
l_int|0
)paren
)paren
(brace
id|printf
(paren
l_string|&quot;#undef CONFIGURE_SOUNDCARD&bslash;n&quot;
)paren
suffix:semicolon
id|printf
(paren
l_string|&quot;#undef KERNEL_SOUNDCARD&bslash;n&quot;
)paren
suffix:semicolon
m_exit
(paren
l_int|0
)paren
suffix:semicolon
)brace
multiline_comment|/* Partial driver */
id|full_driver
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
id|OPT_LAST
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|can_select_option
(paren
id|i
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
(paren
id|selected_options
op_amp
id|B
(paren
id|i
)paren
)paren
)paren
multiline_comment|/* Not selected yet */
r_if
c_cond
(paren
op_logical_neg
id|hw_table
(braket
id|i
)braket
dot
id|verify
)paren
(brace
r_if
c_cond
(paren
id|hw_table
(braket
id|i
)braket
dot
id|alias
)paren
id|selected_options
op_or_assign
id|B
(paren
id|hw_table
(braket
id|i
)braket
dot
id|alias
)paren
suffix:semicolon
r_else
id|selected_options
op_or_assign
id|B
(paren
id|i
)paren
suffix:semicolon
)brace
r_else
(brace
r_int
id|def_answ
op_assign
id|hw_table
(braket
id|i
)braket
dot
id|default_answ
suffix:semicolon
id|fprintf
(paren
id|stderr
comma
id|def_answ
ques
c_cond
l_string|&quot;  %s (y/n) ? &quot;
suffix:colon
l_string|&quot;  %s (n/y) ? &quot;
comma
id|questions
(braket
id|i
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
id|think_positively
(paren
id|def_answ
)paren
)paren
r_if
c_cond
(paren
id|hw_table
(braket
id|i
)braket
dot
id|alias
)paren
id|selected_options
op_or_assign
id|B
(paren
id|hw_table
(braket
id|i
)braket
dot
id|alias
)paren
suffix:semicolon
r_else
id|selected_options
op_or_assign
id|B
(paren
id|i
)paren
suffix:semicolon
)brace
)brace
)brace
r_if
c_cond
(paren
id|selected_options
op_amp
id|B
c_func
(paren
id|OPT_SB16
)paren
)paren
id|selected_options
op_or_assign
id|B
c_func
(paren
id|OPT_SBPRO
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|selected_options
op_amp
id|ANY_DEVS
)paren
)paren
(brace
id|printf
(paren
l_string|&quot;#undef CONFIGURE_SOUNDCARD&bslash;n&quot;
)paren
suffix:semicolon
id|printf
(paren
l_string|&quot;#undef KERNEL_SOUNDCARD&bslash;n&quot;
)paren
suffix:semicolon
id|fprintf
(paren
id|stderr
comma
l_string|&quot;&bslash;n*** This combination is useless. Sound driver disabled!!! ***&bslash;n&bslash;n&quot;
)paren
suffix:semicolon
m_exit
(paren
l_int|0
)paren
suffix:semicolon
)brace
r_else
id|printf
(paren
l_string|&quot;#define KERNEL_SOUNDCARD&bslash;n&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
op_le
id|OPT_LAST
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
op_logical_neg
id|hw_table
(braket
id|i
)braket
dot
id|alias
)paren
r_if
c_cond
(paren
id|selected_options
op_amp
id|B
(paren
id|i
)paren
)paren
id|printf
(paren
l_string|&quot;#undef  EXCLUDE_%s&bslash;n&quot;
comma
id|hw_table
(braket
id|i
)braket
dot
id|macro
)paren
suffix:semicolon
r_else
id|printf
(paren
l_string|&quot;#define EXCLUDE_%s&bslash;n&quot;
comma
id|hw_table
(braket
id|i
)braket
dot
id|macro
)paren
suffix:semicolon
id|printf
(paren
l_string|&quot;#define EXCLUDE_PRO_MIDI&bslash;n&quot;
)paren
suffix:semicolon
id|printf
(paren
l_string|&quot;#define EXCLUDE_CHIP_MIDI&bslash;n&quot;
)paren
suffix:semicolon
multiline_comment|/*&n;   * IRQ and DMA settings&n;   */
id|printf
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#if defined(linux)
r_if
c_cond
(paren
id|selected_options
op_amp
id|B
(paren
id|OPT_SB
)paren
op_logical_and
id|selected_options
op_amp
(paren
id|B
(paren
id|OPT_AUDIO
)paren
op_or
id|B
(paren
id|OPT_MIDI
)paren
)paren
)paren
(brace
id|fprintf
(paren
id|stderr
comma
l_string|&quot;&bslash;nIRQ number for SoundBlaster?&bslash;n&quot;
l_string|&quot;The IRQ adress is defined by the jumpers on your card and&bslash;n&quot;
l_string|&quot;7 is the factory default. Valid values are 9, 5, 7 and 10.&bslash;n&quot;
l_string|&quot;Enter the value: &quot;
)paren
suffix:semicolon
id|num
op_assign
id|ask_value
(paren
l_string|&quot;%d&quot;
comma
l_int|7
)paren
suffix:semicolon
r_if
c_cond
(paren
id|num
op_ne
l_int|9
op_logical_and
id|num
op_ne
l_int|5
op_logical_and
id|num
op_ne
l_int|7
op_logical_and
id|num
op_ne
l_int|10
)paren
(brace
id|fprintf
(paren
id|stderr
comma
l_string|&quot;*** Illegal input! ***&bslash;n&quot;
)paren
suffix:semicolon
id|num
op_assign
l_int|7
suffix:semicolon
)brace
id|fprintf
(paren
id|stderr
comma
l_string|&quot;SoundBlaster IRQ set to %d&bslash;n&quot;
comma
id|num
)paren
suffix:semicolon
id|printf
(paren
l_string|&quot;#define SBC_IRQ %d&bslash;n&quot;
comma
id|num
)paren
suffix:semicolon
r_if
c_cond
(paren
id|selected_options
op_amp
id|B
(paren
id|OPT_SBPRO
)paren
)paren
(brace
id|fprintf
(paren
id|stderr
comma
l_string|&quot;&bslash;nDMA channel for SoundBlaster?&bslash;n&quot;
l_string|&quot;For SB 1.0, 1.5 and 2.0 this MUST be 1&bslash;n&quot;
l_string|&quot;SB Pro supports DMA channels 0, 1 and 3 (jumper)&bslash;n&quot;
l_string|&quot;For SB16 give the 8 bit DMA# here&bslash;n&quot;
l_string|&quot;The default value is 1&bslash;n&quot;
l_string|&quot;Enter the value: &quot;
)paren
suffix:semicolon
id|num
op_assign
id|ask_value
(paren
l_string|&quot;%d&quot;
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|num
template_param
l_int|3
)paren
(brace
id|fprintf
(paren
id|stderr
comma
l_string|&quot;*** Illegal input! ***&bslash;n&quot;
)paren
suffix:semicolon
id|num
op_assign
l_int|1
suffix:semicolon
)brace
id|fprintf
(paren
id|stderr
comma
l_string|&quot;SoundBlaster DMA set to %d&bslash;n&quot;
comma
id|num
)paren
suffix:semicolon
id|printf
(paren
l_string|&quot;#define SBC_DMA %d&bslash;n&quot;
comma
id|num
)paren
suffix:semicolon
id|sb_dma
op_assign
id|num
suffix:semicolon
)brace
r_if
c_cond
(paren
id|selected_options
op_amp
id|B
(paren
id|OPT_SB16
)paren
)paren
(brace
id|fprintf
(paren
id|stderr
comma
l_string|&quot;&bslash;n16 bit DMA channel for SoundBlaster 16?&bslash;n&quot;
l_string|&quot;Possible values are 5, 6 or 7&bslash;n&quot;
l_string|&quot;The default value is 6&bslash;n&quot;
l_string|&quot;Enter the value: &quot;
)paren
suffix:semicolon
id|num
op_assign
id|ask_value
(paren
l_string|&quot;%d&quot;
comma
l_int|6
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|num
template_param
l_int|7
)paren
op_logical_and
(paren
id|num
op_ne
id|sb_dma
)paren
)paren
(brace
id|fprintf
(paren
id|stderr
comma
l_string|&quot;*** Illegal input! ***&bslash;n&quot;
)paren
suffix:semicolon
id|num
op_assign
l_int|6
suffix:semicolon
)brace
id|fprintf
(paren
id|stderr
comma
l_string|&quot;SoundBlaster DMA set to %d&bslash;n&quot;
comma
id|num
)paren
suffix:semicolon
id|printf
(paren
l_string|&quot;#define SB16_DMA %d&bslash;n&quot;
comma
id|num
)paren
suffix:semicolon
id|fprintf
(paren
id|stderr
comma
l_string|&quot;&bslash;nI/O base for SB16 Midi?&bslash;n&quot;
l_string|&quot;Possible values are 300 and 330&bslash;n&quot;
l_string|&quot;The factory default is 330&bslash;n&quot;
l_string|&quot;Enter the SB16 Midi I/O base: &quot;
)paren
suffix:semicolon
id|num
op_assign
id|ask_value
(paren
l_string|&quot;%x&quot;
comma
l_int|0x330
)paren
suffix:semicolon
id|fprintf
(paren
id|stderr
comma
l_string|&quot;SB16 Midi I/O base set to %03x&bslash;n&quot;
comma
id|num
)paren
suffix:semicolon
id|printf
(paren
l_string|&quot;#define SB16MIDI_BASE 0x%03x&bslash;n&quot;
comma
id|num
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|selected_options
op_amp
id|B
(paren
id|OPT_PAS
)paren
)paren
(brace
r_if
c_cond
(paren
id|selected_options
op_amp
(paren
id|B
(paren
id|OPT_AUDIO
)paren
op_or
id|B
(paren
id|OPT_MIDI
)paren
)paren
)paren
(brace
id|fprintf
(paren
id|stderr
comma
l_string|&quot;&bslash;nIRQ number for ProAudioSpectrum?&bslash;n&quot;
l_string|&quot;The recommended value is the IRQ used under DOS.&bslash;n&quot;
l_string|&quot;Please refer to the ProAudioSpectrum User&squot;s Guide.&bslash;n&quot;
l_string|&quot;The default value is 10.&bslash;n&quot;
l_string|&quot;Enter the value: &quot;
)paren
suffix:semicolon
id|num
op_assign
id|ask_value
(paren
l_string|&quot;%d&quot;
comma
l_int|10
)paren
suffix:semicolon
r_if
c_cond
(paren
id|num
op_eq
l_int|6
op_logical_or
id|num
template_param
l_int|15
op_logical_or
id|num
op_eq
l_int|2
)paren
multiline_comment|/* Illegal */
(brace
id|fprintf
(paren
id|stderr
comma
l_string|&quot;*** Illegal input! ***&bslash;n&quot;
)paren
suffix:semicolon
id|num
op_assign
l_int|10
suffix:semicolon
)brace
id|fprintf
(paren
id|stderr
comma
l_string|&quot;ProAudioSpectrum IRQ set to %d&bslash;n&quot;
comma
id|num
)paren
suffix:semicolon
id|printf
(paren
l_string|&quot;#define PAS_IRQ %d&bslash;n&quot;
comma
id|num
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|selected_options
op_amp
id|B
(paren
id|OPT_AUDIO
)paren
)paren
(brace
id|fprintf
(paren
id|stderr
comma
l_string|&quot;&bslash;nDMA number for ProAudioSpectrum?&bslash;n&quot;
l_string|&quot;The recommended value is the DMA channel under DOS.&bslash;n&quot;
l_string|&quot;Please refer to the ProAudioSpectrum User&squot;s Guide.&bslash;n&quot;
l_string|&quot;The default value is 3&bslash;n&quot;
l_string|&quot;Enter the value: &quot;
)paren
suffix:semicolon
id|num
op_assign
id|ask_value
(paren
l_string|&quot;%d&quot;
comma
l_int|3
)paren
suffix:semicolon
r_if
c_cond
(paren
id|num
op_eq
l_int|4
op_logical_or
id|num
template_param
l_int|7
)paren
(brace
id|fprintf
(paren
id|stderr
comma
l_string|&quot;*** Illegal input! ***&bslash;n&quot;
)paren
suffix:semicolon
id|num
op_assign
l_int|3
suffix:semicolon
)brace
id|fprintf
(paren
id|stderr
comma
l_string|&quot;&bslash;nProAudioSpectrum DMA set to %d&bslash;n&quot;
comma
id|num
)paren
suffix:semicolon
id|printf
(paren
l_string|&quot;#define PAS_DMA %d&bslash;n&quot;
comma
id|num
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|selected_options
op_amp
id|B
(paren
id|OPT_GUS
)paren
)paren
(brace
id|fprintf
(paren
id|stderr
comma
l_string|&quot;&bslash;nI/O base for Gravis Ultrasound?&bslash;n&quot;
l_string|&quot;Valid choises are 210, 220, 230, 240, 250 or 260&bslash;n&quot;
l_string|&quot;The factory default is 220&bslash;n&quot;
l_string|&quot;Enter the GUS I/O base: &quot;
)paren
suffix:semicolon
id|num
op_assign
id|ask_value
(paren
l_string|&quot;%x&quot;
comma
l_int|0x220
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|num
OG
l_int|0x260
)paren
op_logical_or
(paren
(paren
id|num
op_amp
l_int|0xf0f
)paren
op_ne
l_int|0x200
)paren
op_logical_or
(paren
(paren
id|num
op_amp
l_int|0x0f0
)paren
OG
l_int|0x060
)paren
)paren
(brace
id|fprintf
(paren
id|stderr
comma
l_string|&quot;*** Illegal input! ***&bslash;n&quot;
)paren
suffix:semicolon
id|num
op_assign
l_int|0x220
suffix:semicolon
)brace
r_if
c_cond
(paren
(paren
id|selected_options
op_amp
id|B
(paren
id|OPT_SB
)paren
)paren
op_logical_and
(paren
id|num
op_eq
l_int|0x220
)paren
)paren
(brace
id|fprintf
(paren
id|stderr
comma
l_string|&quot;FATAL ERROR!!!!!!!!!!!!!!&bslash;n&quot;
l_string|&quot;&bslash;t0x220 cannot be used if SoundBlaster is enabled.&bslash;n&quot;
l_string|&quot;&bslash;tRun the config again.&bslash;n&quot;
)paren
suffix:semicolon
id|printf
(paren
l_string|&quot;#undef CONFIGURE_SOUNDCARD&bslash;n&quot;
)paren
suffix:semicolon
id|printf
(paren
l_string|&quot;#undef KERNEL_SOUNDCARD&bslash;n&quot;
)paren
suffix:semicolon
m_exit
(paren
op_minus
l_int|1
)paren
suffix:semicolon
)brace
id|fprintf
(paren
id|stderr
comma
l_string|&quot;GUS I/O base set to %03x&bslash;n&quot;
comma
id|num
)paren
suffix:semicolon
id|printf
(paren
l_string|&quot;#define GUS_BASE 0x%03x&bslash;n&quot;
comma
id|num
)paren
suffix:semicolon
id|fprintf
(paren
id|stderr
comma
l_string|&quot;&bslash;nIRQ number for Gravis UltraSound?&bslash;n&quot;
l_string|&quot;The recommended value is the IRQ used under DOS.&bslash;n&quot;
l_string|&quot;Please refer to the Gravis Ultrasound User&squot;s Guide.&bslash;n&quot;
l_string|&quot;The default value is 15.&bslash;n&quot;
l_string|&quot;Enter the value: &quot;
)paren
suffix:semicolon
id|num
op_assign
id|ask_value
(paren
l_string|&quot;%d&quot;
comma
l_int|15
)paren
suffix:semicolon
r_if
c_cond
(paren
id|num
op_eq
l_int|6
op_logical_or
id|num
template_param
l_int|15
op_logical_or
id|num
op_eq
l_int|2
)paren
multiline_comment|/* Invalid */
(brace
id|fprintf
(paren
id|stderr
comma
l_string|&quot;*** Illegal input! ***&bslash;n&quot;
)paren
suffix:semicolon
id|num
op_assign
l_int|15
suffix:semicolon
)brace
id|fprintf
(paren
id|stderr
comma
l_string|&quot;Gravis UltraSound IRQ set to %d&bslash;n&quot;
comma
id|num
)paren
suffix:semicolon
id|printf
(paren
l_string|&quot;#define GUS_IRQ %d&bslash;n&quot;
comma
id|num
)paren
suffix:semicolon
id|fprintf
(paren
id|stderr
comma
l_string|&quot;&bslash;nDMA number for Gravis UltraSound?&bslash;n&quot;
l_string|&quot;The recommended value is the DMA channel under DOS.&bslash;n&quot;
l_string|&quot;Please refer to the Gravis Ultrasound User&squot;s Guide.&bslash;n&quot;
l_string|&quot;The default value is 6&bslash;n&quot;
l_string|&quot;Enter the value: &quot;
)paren
suffix:semicolon
id|num
op_assign
id|ask_value
(paren
l_string|&quot;%d&quot;
comma
l_int|6
)paren
suffix:semicolon
r_if
c_cond
(paren
id|num
op_eq
l_int|4
op_logical_or
id|num
template_param
l_int|7
)paren
(brace
id|fprintf
(paren
id|stderr
comma
l_string|&quot;*** Illegal input! ***&bslash;n&quot;
)paren
suffix:semicolon
id|num
op_assign
l_int|6
suffix:semicolon
)brace
id|fprintf
(paren
id|stderr
comma
l_string|&quot;&bslash;nGravis UltraSound DMA set to %d&bslash;n&quot;
comma
id|num
)paren
suffix:semicolon
id|printf
(paren
l_string|&quot;#define GUS_DMA %d&bslash;n&quot;
comma
id|num
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|selected_options
op_amp
id|B
(paren
id|OPT_MPU401
)paren
)paren
(brace
id|fprintf
(paren
id|stderr
comma
l_string|&quot;&bslash;nI/O base for MPU-401?&bslash;n&quot;
l_string|&quot;The factory default is 330&bslash;n&quot;
l_string|&quot;Enter the MPU-401 I/O base: &quot;
)paren
suffix:semicolon
id|num
op_assign
id|ask_value
(paren
l_string|&quot;%x&quot;
comma
l_int|0x330
)paren
suffix:semicolon
id|fprintf
(paren
id|stderr
comma
l_string|&quot;MPU-401 I/O base set to %03x&bslash;n&quot;
comma
id|num
)paren
suffix:semicolon
id|printf
(paren
l_string|&quot;#define MPU_BASE 0x%03x&bslash;n&quot;
comma
id|num
)paren
suffix:semicolon
id|fprintf
(paren
id|stderr
comma
l_string|&quot;&bslash;nIRQ number for MPU-401?&bslash;n&quot;
l_string|&quot;Valid numbers are: 3, 4, 5, 7 and 9(=2).&bslash;n&quot;
l_string|&quot;The default value is 5.&bslash;n&quot;
l_string|&quot;Enter the value: &quot;
)paren
suffix:semicolon
id|num
op_assign
id|ask_value
(paren
l_string|&quot;%d&quot;
comma
l_int|5
)paren
suffix:semicolon
r_if
c_cond
(paren
id|num
op_eq
l_int|6
op_logical_or
id|num
template_param
l_int|15
)paren
multiline_comment|/* Used for floppy */
(brace
id|fprintf
(paren
id|stderr
comma
l_string|&quot;*** Illegal input! ***&bslash;n&quot;
)paren
suffix:semicolon
id|num
op_assign
l_int|5
suffix:semicolon
)brace
id|fprintf
(paren
id|stderr
comma
l_string|&quot;MPU-401 IRQ set to %d&bslash;n&quot;
comma
id|num
)paren
suffix:semicolon
id|printf
(paren
l_string|&quot;#define MPU_IRQ %d&bslash;n&quot;
comma
id|num
)paren
suffix:semicolon
)brace
macro_line|#endif
r_if
c_cond
(paren
id|selected_options
op_amp
id|B
(paren
id|OPT_AUDIO
)paren
)paren
(brace
id|def_size
op_assign
l_int|16384
suffix:semicolon
r_if
c_cond
(paren
id|selected_options
op_amp
(paren
id|B
(paren
id|OPT_SBPRO
)paren
op_or
id|B
(paren
id|OPT_PAS
)paren
op_or
id|B
c_func
(paren
id|OPT_SB16
)paren
)paren
)paren
id|def_size
op_assign
l_int|32768
suffix:semicolon
macro_line|#ifndef __386BSD__
r_if
c_cond
(paren
(paren
(paren
id|selected_options
op_amp
id|B
(paren
id|OPT_PAS
)paren
)paren
op_logical_or
(paren
id|selected_options
op_amp
id|B
(paren
id|OPT_SB16
)paren
)paren
)paren
op_logical_and
op_logical_neg
id|full_driver
)paren
id|def_size
op_assign
l_int|65536
suffix:semicolon
multiline_comment|/* PAS16 or SB16 */
macro_line|#endif
id|fprintf
(paren
id|stderr
comma
l_string|&quot;&bslash;nSelect the DMA buffer size (4096, 16384, 32768 or 65536 bytes)&bslash;n&quot;
l_string|&quot;%d is recommended value for this configuration.&bslash;n&quot;
l_string|&quot;Enter the value: &quot;
comma
id|def_size
)paren
suffix:semicolon
id|num
op_assign
id|ask_value
(paren
l_string|&quot;%d&quot;
comma
id|def_size
)paren
suffix:semicolon
r_if
c_cond
(paren
id|num
op_ne
l_int|4096
op_logical_and
id|num
op_ne
l_int|16384
op_logical_and
id|num
op_ne
l_int|32768
op_logical_and
id|num
op_ne
l_int|65536
)paren
(brace
id|fprintf
(paren
id|stderr
comma
l_string|&quot;*** Illegal input! ***&bslash;n&quot;
)paren
suffix:semicolon
id|num
op_assign
id|def_size
suffix:semicolon
)brace
id|fprintf
(paren
id|stderr
comma
l_string|&quot;The DMA buffer size set to %d&bslash;n&quot;
comma
id|num
)paren
suffix:semicolon
id|printf
(paren
l_string|&quot;#define DSP_BUFFSIZE %d&bslash;n&quot;
comma
id|num
)paren
suffix:semicolon
)brace
id|printf
(paren
l_string|&quot;#define SELECTED_SOUND_OPTIONS&bslash;t0x%08x&bslash;n&quot;
comma
id|selected_options
)paren
suffix:semicolon
id|fprintf
(paren
id|stderr
comma
l_string|&quot;The sound driver is now configured.&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#if defined(SCO) || defined(ISC) || defined(SYSV)
id|fprintf
c_func
(paren
id|stderr
comma
l_string|&quot;Rember to update the System file&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#endif
m_exit
(paren
l_int|0
)paren
suffix:semicolon
)brace
eof
