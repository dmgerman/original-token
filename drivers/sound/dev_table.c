multiline_comment|/*&n; * sound/dev_table.c&n; *&n; * Device call tables.&n; */
multiline_comment|/*&n; * Copyright (C) by Hannu Savolainen 1993-1997&n; *&n; * OSS/Free for Linux is distributed under the GNU GENERAL PUBLIC LICENSE (GPL)&n; * Version 2 (June 1991). See the &quot;COPYING&quot; file distributed with this software&n; * for more info.&n; */
macro_line|#include &lt;linux/config.h&gt;
DECL|macro|_DEV_TABLE_C_
mdefine_line|#define _DEV_TABLE_C_
macro_line|#include &quot;sound_config.h&quot;
DECL|variable|softoss_dev
r_int
id|softoss_dev
op_assign
l_int|0
suffix:semicolon
DECL|variable|sound_started
r_int
id|sound_started
op_assign
l_int|0
suffix:semicolon
r_int
id|sndtable_get_cardcount
c_func
(paren
r_void
)paren
suffix:semicolon
DECL|function|snd_find_driver
r_int
id|snd_find_driver
c_func
(paren
r_int
id|type
)paren
(brace
r_int
id|i
comma
id|n
op_assign
id|num_sound_drivers
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|n
suffix:semicolon
id|i
op_increment
)paren
r_if
c_cond
(paren
id|sound_drivers
(braket
id|i
)braket
dot
id|card_type
op_eq
id|type
)paren
r_return
id|i
suffix:semicolon
r_return
op_minus
l_int|1
suffix:semicolon
)brace
DECL|function|start_services
r_static
r_void
id|start_services
c_func
(paren
r_void
)paren
(brace
macro_line|#ifdef FIXME
r_int
id|soundcards_installed
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|soundcards_installed
op_assign
id|sndtable_get_cardcount
c_func
(paren
)paren
)paren
)paren
r_return
suffix:semicolon
multiline_comment|/* No cards detected */
macro_line|#endif
macro_line|#ifdef CONFIG_AUDIO
r_if
c_cond
(paren
id|num_audiodevs
)paren
multiline_comment|/* Audio devices present */
(brace
r_int
id|dev
suffix:semicolon
r_for
c_loop
(paren
id|dev
op_assign
l_int|0
suffix:semicolon
id|dev
OL
id|num_audiodevs
suffix:semicolon
id|dev
op_increment
)paren
(brace
)brace
id|audio_init_devices
c_func
(paren
)paren
suffix:semicolon
)brace
macro_line|#endif
r_return
suffix:semicolon
)brace
r_static
r_void
DECL|function|start_cards
id|start_cards
c_func
(paren
r_void
)paren
(brace
r_int
id|i
comma
id|n
op_assign
id|num_sound_cards
suffix:semicolon
r_int
id|drv
suffix:semicolon
id|sound_started
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|trace_init
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;Sound initialization started&bslash;n&quot;
)paren
suffix:semicolon
macro_line|#ifdef CONFIG_LOWLEVEL_SOUND
(brace
r_extern
r_void
id|sound_preinit_lowlevel_drivers
c_func
(paren
r_void
)paren
suffix:semicolon
id|sound_preinit_lowlevel_drivers
c_func
(paren
)paren
suffix:semicolon
)brace
macro_line|#endif
multiline_comment|/*&n; * Check the number of cards actually defined in the table&n; */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|n
op_logical_and
id|snd_installed_cards
(braket
id|i
)braket
dot
id|card_type
suffix:semicolon
id|i
op_increment
)paren
id|num_sound_cards
op_assign
id|i
op_plus
l_int|1
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|n
op_logical_and
id|snd_installed_cards
(braket
id|i
)braket
dot
id|card_type
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|snd_installed_cards
(braket
id|i
)braket
dot
id|enabled
)paren
(brace
id|snd_installed_cards
(braket
id|i
)braket
dot
id|for_driver_use
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
(paren
id|drv
op_assign
id|snd_find_driver
c_func
(paren
id|snd_installed_cards
(braket
id|i
)braket
dot
id|card_type
)paren
)paren
op_eq
op_minus
l_int|1
)paren
(brace
id|snd_installed_cards
(braket
id|i
)braket
dot
id|enabled
op_assign
l_int|0
suffix:semicolon
multiline_comment|/*&n;&t;&t;&t;&t;&t;&t;&t;&t;&t; * Mark as not detected&n;&t;&t;&t;&t;&t;&t;&t;&t;&t; */
r_continue
suffix:semicolon
)brace
id|snd_installed_cards
(braket
id|i
)braket
dot
id|config.card_subtype
op_assign
id|sound_drivers
(braket
id|drv
)braket
dot
id|card_subtype
suffix:semicolon
r_if
c_cond
(paren
id|sound_drivers
(braket
id|drv
)braket
dot
id|probe
c_func
(paren
op_amp
id|snd_installed_cards
(braket
id|i
)braket
dot
id|config
)paren
)paren
id|sound_drivers
(braket
id|drv
)braket
dot
id|attach
c_func
(paren
op_amp
id|snd_installed_cards
(braket
id|i
)braket
dot
id|config
)paren
suffix:semicolon
r_else
id|snd_installed_cards
(braket
id|i
)braket
dot
id|enabled
op_assign
l_int|0
suffix:semicolon
multiline_comment|/*&n;&t;&t;&t;&t;&t;&t;&t;&t;&t; * Mark as not detected&n;&t;&t;&t;&t;&t;&t;&t;&t;&t; */
)brace
)brace
macro_line|#ifdef CONFIG_LOWLEVEL_SOUND
(brace
r_extern
r_void
id|sound_init_lowlevel_drivers
c_func
(paren
r_void
)paren
suffix:semicolon
id|sound_init_lowlevel_drivers
c_func
(paren
)paren
suffix:semicolon
)brace
macro_line|#endif
r_if
c_cond
(paren
id|trace_init
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;Sound initialization complete&bslash;n&quot;
)paren
suffix:semicolon
)brace
DECL|function|sndtable_init
r_void
id|sndtable_init
c_func
(paren
r_void
)paren
(brace
id|start_cards
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|function|sound_unload_drivers
r_void
id|sound_unload_drivers
c_func
(paren
r_void
)paren
(brace
r_int
id|i
comma
id|n
op_assign
id|num_sound_cards
suffix:semicolon
r_int
id|drv
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|sound_started
)paren
r_return
suffix:semicolon
r_if
c_cond
(paren
id|trace_init
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;Sound unload started&bslash;n&quot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|n
op_logical_and
id|snd_installed_cards
(braket
id|i
)braket
dot
id|card_type
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|snd_installed_cards
(braket
id|i
)braket
dot
id|enabled
)paren
(brace
r_if
c_cond
(paren
(paren
id|drv
op_assign
id|snd_find_driver
c_func
(paren
id|snd_installed_cards
(braket
id|i
)braket
dot
id|card_type
)paren
)paren
op_ne
op_minus
l_int|1
)paren
(brace
r_if
c_cond
(paren
id|sound_drivers
(braket
id|drv
)braket
dot
id|unload
)paren
(brace
id|sound_drivers
(braket
id|drv
)braket
dot
id|unload
c_func
(paren
op_amp
id|snd_installed_cards
(braket
id|i
)braket
dot
id|config
)paren
suffix:semicolon
id|snd_installed_cards
(braket
id|i
)braket
dot
id|enabled
op_assign
l_int|0
suffix:semicolon
)brace
)brace
)brace
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|num_audiodevs
suffix:semicolon
id|i
op_increment
)paren
id|DMAbuf_deinit
c_func
(paren
id|i
)paren
suffix:semicolon
r_if
c_cond
(paren
id|trace_init
)paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;Sound unload complete&bslash;n&quot;
)paren
suffix:semicolon
)brace
DECL|function|sound_unload_driver
r_void
id|sound_unload_driver
c_func
(paren
r_int
id|type
)paren
(brace
r_int
id|i
comma
id|drv
op_assign
op_minus
l_int|1
comma
id|n
op_assign
id|num_sound_cards
suffix:semicolon
id|DEB
c_func
(paren
id|printk
c_func
(paren
l_string|&quot;unload driver %d: &quot;
comma
id|type
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|n
op_logical_and
id|snd_installed_cards
(braket
id|i
)braket
dot
id|card_type
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|snd_installed_cards
(braket
id|i
)braket
dot
id|card_type
op_eq
id|type
)paren
(brace
r_if
c_cond
(paren
id|snd_installed_cards
(braket
id|i
)braket
dot
id|enabled
)paren
(brace
r_if
c_cond
(paren
(paren
id|drv
op_assign
id|snd_find_driver
c_func
(paren
id|type
)paren
)paren
op_ne
op_minus
l_int|1
)paren
(brace
id|DEB
c_func
(paren
id|printk
c_func
(paren
l_string|&quot; card %d&quot;
comma
id|i
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|sound_drivers
(braket
id|drv
)braket
dot
id|unload
)paren
(brace
id|sound_drivers
(braket
id|drv
)braket
dot
id|unload
c_func
(paren
op_amp
id|snd_installed_cards
(braket
id|i
)braket
dot
id|config
)paren
suffix:semicolon
id|snd_installed_cards
(braket
id|i
)braket
dot
id|enabled
op_assign
l_int|0
suffix:semicolon
)brace
)brace
)brace
)brace
)brace
id|DEB
c_func
(paren
id|printk
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
)paren
suffix:semicolon
)brace
DECL|function|sndtable_probe
r_int
id|sndtable_probe
c_func
(paren
r_int
id|unit
comma
r_struct
id|address_info
op_star
id|hw_config
)paren
(brace
r_int
id|sel
op_assign
op_minus
l_int|1
suffix:semicolon
id|DEB
c_func
(paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;sndtable_probe(%d)&bslash;n&quot;
comma
id|unit
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|unit
)paren
r_return
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|sel
op_eq
op_minus
l_int|1
op_logical_and
id|num_sound_cards
OL
id|max_sound_cards
)paren
(brace
r_int
id|i
suffix:semicolon
id|i
op_assign
id|sel
op_assign
(paren
id|num_sound_cards
op_increment
)paren
suffix:semicolon
id|snd_installed_cards
(braket
id|sel
)braket
dot
id|card_type
op_assign
id|unit
suffix:semicolon
id|snd_installed_cards
(braket
id|sel
)braket
dot
id|enabled
op_assign
l_int|1
suffix:semicolon
)brace
r_if
c_cond
(paren
id|sel
op_ne
op_minus
l_int|1
)paren
(brace
r_int
id|drv
suffix:semicolon
id|snd_installed_cards
(braket
id|sel
)braket
dot
id|for_driver_use
op_assign
l_int|NULL
suffix:semicolon
id|snd_installed_cards
(braket
id|sel
)braket
dot
id|config.io_base
op_assign
id|hw_config-&gt;io_base
suffix:semicolon
id|snd_installed_cards
(braket
id|sel
)braket
dot
id|config.irq
op_assign
id|hw_config-&gt;irq
suffix:semicolon
id|snd_installed_cards
(braket
id|sel
)braket
dot
id|config.dma
op_assign
id|hw_config-&gt;dma
suffix:semicolon
id|snd_installed_cards
(braket
id|sel
)braket
dot
id|config.dma2
op_assign
id|hw_config-&gt;dma2
suffix:semicolon
id|snd_installed_cards
(braket
id|sel
)braket
dot
id|config.name
op_assign
id|hw_config-&gt;name
suffix:semicolon
id|snd_installed_cards
(braket
id|sel
)braket
dot
id|config.always_detect
op_assign
id|hw_config-&gt;always_detect
suffix:semicolon
id|snd_installed_cards
(braket
id|sel
)braket
dot
id|config.driver_use_1
op_assign
id|hw_config-&gt;driver_use_1
suffix:semicolon
id|snd_installed_cards
(braket
id|sel
)braket
dot
id|config.driver_use_2
op_assign
id|hw_config-&gt;driver_use_2
suffix:semicolon
id|snd_installed_cards
(braket
id|sel
)braket
dot
id|config.card_subtype
op_assign
id|hw_config-&gt;card_subtype
suffix:semicolon
r_if
c_cond
(paren
(paren
id|drv
op_assign
id|snd_find_driver
c_func
(paren
id|snd_installed_cards
(braket
id|sel
)braket
dot
id|card_type
)paren
)paren
op_eq
op_minus
l_int|1
)paren
(brace
id|snd_installed_cards
(braket
id|sel
)braket
dot
id|enabled
op_assign
l_int|0
suffix:semicolon
id|DEB
c_func
(paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;Failed to find driver&bslash;n&quot;
)paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|DEB
c_func
(paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;Driver name &squot;%s&squot;&bslash;n&quot;
comma
id|sound_drivers
(braket
id|drv
)braket
dot
id|name
)paren
)paren
suffix:semicolon
id|hw_config-&gt;card_subtype
op_assign
id|snd_installed_cards
(braket
id|sel
)braket
dot
id|config.card_subtype
op_assign
id|sound_drivers
(braket
id|drv
)braket
dot
id|card_subtype
suffix:semicolon
r_if
c_cond
(paren
id|sound_drivers
(braket
id|drv
)braket
dot
id|probe
c_func
(paren
id|hw_config
)paren
)paren
(brace
id|DEB
c_func
(paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;Hardware probed OK&bslash;n&quot;
)paren
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
id|DEB
c_func
(paren
id|printk
c_func
(paren
l_string|&quot;Failed to find hardware&bslash;n&quot;
)paren
)paren
suffix:semicolon
id|snd_installed_cards
(braket
id|sel
)braket
dot
id|enabled
op_assign
l_int|0
suffix:semicolon
multiline_comment|/*&n;&t;&t;&t;&t;&t;&t;&t;&t; * Mark as not detected&n;&t;&t;&t;&t;&t;&t;&t;&t; */
r_return
l_int|0
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|sndtable_init_card
r_int
id|sndtable_init_card
c_func
(paren
r_int
id|unit
comma
r_struct
id|address_info
op_star
id|hw_config
)paren
(brace
r_int
id|i
comma
id|n
op_assign
id|num_sound_cards
suffix:semicolon
id|DEB
c_func
(paren
id|printk
c_func
(paren
l_string|&quot;sndtable_init_card(%d) entered&bslash;n&quot;
comma
id|unit
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|unit
)paren
(brace
id|sndtable_init
c_func
(paren
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|n
op_logical_and
id|snd_installed_cards
(braket
id|i
)braket
dot
id|card_type
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|snd_installed_cards
(braket
id|i
)braket
dot
id|card_type
op_eq
id|unit
)paren
(brace
r_int
id|drv
suffix:semicolon
id|snd_installed_cards
(braket
id|i
)braket
dot
id|config.io_base
op_assign
id|hw_config-&gt;io_base
suffix:semicolon
id|snd_installed_cards
(braket
id|i
)braket
dot
id|config.irq
op_assign
id|hw_config-&gt;irq
suffix:semicolon
id|snd_installed_cards
(braket
id|i
)braket
dot
id|config.dma
op_assign
id|hw_config-&gt;dma
suffix:semicolon
id|snd_installed_cards
(braket
id|i
)braket
dot
id|config.dma2
op_assign
id|hw_config-&gt;dma2
suffix:semicolon
id|snd_installed_cards
(braket
id|i
)braket
dot
id|config.name
op_assign
id|hw_config-&gt;name
suffix:semicolon
id|snd_installed_cards
(braket
id|i
)braket
dot
id|config.always_detect
op_assign
id|hw_config-&gt;always_detect
suffix:semicolon
id|snd_installed_cards
(braket
id|i
)braket
dot
id|config.driver_use_1
op_assign
id|hw_config-&gt;driver_use_1
suffix:semicolon
id|snd_installed_cards
(braket
id|i
)braket
dot
id|config.driver_use_2
op_assign
id|hw_config-&gt;driver_use_2
suffix:semicolon
id|snd_installed_cards
(braket
id|i
)braket
dot
id|config.card_subtype
op_assign
id|hw_config-&gt;card_subtype
suffix:semicolon
r_if
c_cond
(paren
(paren
id|drv
op_assign
id|snd_find_driver
c_func
(paren
id|snd_installed_cards
(braket
id|i
)braket
dot
id|card_type
)paren
)paren
op_eq
op_minus
l_int|1
)paren
id|snd_installed_cards
(braket
id|i
)braket
dot
id|enabled
op_assign
l_int|0
suffix:semicolon
multiline_comment|/*&n;&t;&t;&t;&t;&t;&t;&t;&t;&t; * Mark as not detected&n;&t;&t;&t;&t;&t;&t;&t;&t;&t; */
r_else
(brace
id|DEB
c_func
(paren
id|printk
c_func
(paren
id|KERN_DEBUG
l_string|&quot;Located card - calling attach routine&bslash;n&quot;
)paren
)paren
suffix:semicolon
id|sound_drivers
(braket
id|drv
)braket
dot
id|attach
c_func
(paren
id|hw_config
)paren
suffix:semicolon
id|DEB
c_func
(paren
id|printk
c_func
(paren
l_string|&quot;attach routine finished&bslash;n&quot;
)paren
)paren
suffix:semicolon
)brace
id|start_services
c_func
(paren
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
)brace
id|DEB
c_func
(paren
id|printk
c_func
(paren
l_string|&quot;sndtable_init_card: No card defined with type=%d, num cards: %d&bslash;n&quot;
comma
id|unit
comma
id|num_sound_cards
)paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|sndtable_get_cardcount
r_int
id|sndtable_get_cardcount
c_func
(paren
r_void
)paren
(brace
r_return
id|num_audiodevs
op_plus
id|num_mixers
op_plus
id|num_synths
op_plus
id|num_midis
suffix:semicolon
)brace
DECL|function|sndtable_identify_card
r_int
id|sndtable_identify_card
c_func
(paren
r_char
op_star
id|name
)paren
(brace
r_int
id|i
comma
id|n
op_assign
id|num_sound_drivers
suffix:semicolon
r_if
c_cond
(paren
id|name
op_eq
l_int|NULL
)paren
r_return
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|n
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|sound_drivers
(braket
id|i
)braket
dot
id|driver_id
op_ne
l_int|NULL
)paren
(brace
r_char
op_star
id|id
op_assign
id|sound_drivers
(braket
id|i
)braket
dot
id|driver_id
suffix:semicolon
r_int
id|j
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
l_int|80
op_logical_and
id|name
(braket
id|j
)braket
op_eq
id|id
(braket
id|j
)braket
suffix:semicolon
id|j
op_increment
)paren
r_if
c_cond
(paren
id|id
(braket
id|j
)braket
op_eq
l_int|0
op_logical_and
id|name
(braket
id|j
)braket
op_eq
l_int|0
)paren
multiline_comment|/* Match */
r_return
id|sound_drivers
(braket
id|i
)braket
dot
id|card_type
suffix:semicolon
)brace
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|sound_setup
r_void
id|sound_setup
c_func
(paren
r_char
op_star
id|str
comma
r_int
op_star
id|ints
)paren
(brace
r_int
id|i
comma
id|n
op_assign
id|num_sound_cards
suffix:semicolon
multiline_comment|/*&n;&t; *&t;First disable all drivers&n;&t; */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|n
op_logical_and
id|snd_installed_cards
(braket
id|i
)braket
dot
id|card_type
suffix:semicolon
id|i
op_increment
)paren
id|snd_installed_cards
(braket
id|i
)braket
dot
id|enabled
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|ints
(braket
l_int|0
)braket
op_eq
l_int|0
op_logical_or
id|ints
(braket
l_int|1
)braket
op_eq
l_int|0
)paren
r_return
suffix:semicolon
multiline_comment|/*&n;&t; *&t;Then enable them one by time&n;&t; */
r_for
c_loop
(paren
id|i
op_assign
l_int|1
suffix:semicolon
id|i
op_le
id|ints
(braket
l_int|0
)braket
suffix:semicolon
id|i
op_increment
)paren
(brace
r_int
id|card_type
comma
id|ioaddr
comma
id|irq
comma
id|dma
comma
id|dma2
comma
id|ptr
comma
id|j
suffix:semicolon
r_int
r_int
id|val
suffix:semicolon
id|val
op_assign
(paren
r_int
r_int
)paren
id|ints
(braket
id|i
)braket
suffix:semicolon
id|card_type
op_assign
(paren
id|val
op_amp
l_int|0x0ff00000
)paren
op_rshift
l_int|20
suffix:semicolon
r_if
c_cond
(paren
id|card_type
OG
l_int|127
)paren
(brace
multiline_comment|/*&n;&t;&t;&t; * Add any future extensions here&n;&t;&t;&t; */
r_return
suffix:semicolon
)brace
id|ioaddr
op_assign
(paren
id|val
op_amp
l_int|0x000fff00
)paren
op_rshift
l_int|8
suffix:semicolon
id|irq
op_assign
(paren
id|val
op_amp
l_int|0x000000f0
)paren
op_rshift
l_int|4
suffix:semicolon
id|dma
op_assign
(paren
id|val
op_amp
l_int|0x0000000f
)paren
suffix:semicolon
id|dma2
op_assign
(paren
id|val
op_amp
l_int|0xf0000000
)paren
op_rshift
l_int|28
suffix:semicolon
id|ptr
op_assign
op_minus
l_int|1
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
id|n
op_logical_and
id|ptr
op_eq
op_minus
l_int|1
suffix:semicolon
id|j
op_increment
)paren
(brace
r_if
c_cond
(paren
id|snd_installed_cards
(braket
id|j
)braket
dot
id|card_type
op_eq
id|card_type
op_logical_and
op_logical_neg
id|snd_installed_cards
(braket
id|j
)braket
dot
id|enabled
)paren
multiline_comment|/*&n;&t;&t;&t;&t;&t;&t;&t;&t; * Not already found&n;&t;&t;&t;&t;&t;&t;&t;&t; */
id|ptr
op_assign
id|j
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ptr
op_eq
op_minus
l_int|1
)paren
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;Sound: Invalid setup parameter 0x%08x&bslash;n&quot;
comma
id|val
)paren
suffix:semicolon
r_else
(brace
id|snd_installed_cards
(braket
id|ptr
)braket
dot
id|enabled
op_assign
l_int|1
suffix:semicolon
id|snd_installed_cards
(braket
id|ptr
)braket
dot
id|config.io_base
op_assign
id|ioaddr
suffix:semicolon
id|snd_installed_cards
(braket
id|ptr
)braket
dot
id|config.irq
op_assign
id|irq
suffix:semicolon
id|snd_installed_cards
(braket
id|ptr
)braket
dot
id|config.dma
op_assign
id|dma
suffix:semicolon
id|snd_installed_cards
(braket
id|ptr
)braket
dot
id|config.dma2
op_assign
id|dma2
suffix:semicolon
id|snd_installed_cards
(braket
id|ptr
)braket
dot
id|config.name
op_assign
l_int|NULL
suffix:semicolon
id|snd_installed_cards
(braket
id|ptr
)braket
dot
id|config.always_detect
op_assign
l_int|0
suffix:semicolon
id|snd_installed_cards
(braket
id|ptr
)braket
dot
id|config.driver_use_1
op_assign
l_int|0
suffix:semicolon
id|snd_installed_cards
(braket
id|ptr
)braket
dot
id|config.driver_use_2
op_assign
l_int|0
suffix:semicolon
id|snd_installed_cards
(braket
id|ptr
)braket
dot
id|config.card_subtype
op_assign
l_int|0
suffix:semicolon
)brace
)brace
)brace
DECL|function|sound_getconf
r_struct
id|address_info
op_star
id|sound_getconf
c_func
(paren
r_int
id|card_type
)paren
(brace
r_int
id|j
comma
id|ptr
suffix:semicolon
r_int
id|n
op_assign
id|num_sound_cards
suffix:semicolon
id|ptr
op_assign
op_minus
l_int|1
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|j
OL
id|n
op_logical_and
id|ptr
op_eq
op_minus
l_int|1
op_logical_and
id|snd_installed_cards
(braket
id|j
)braket
dot
id|card_type
suffix:semicolon
id|j
op_increment
)paren
(brace
r_if
c_cond
(paren
id|snd_installed_cards
(braket
id|j
)braket
dot
id|card_type
op_eq
id|card_type
)paren
id|ptr
op_assign
id|j
suffix:semicolon
)brace
r_if
c_cond
(paren
id|ptr
op_eq
op_minus
l_int|1
)paren
r_return
(paren
r_struct
id|address_info
op_star
)paren
l_int|NULL
suffix:semicolon
r_return
op_amp
id|snd_installed_cards
(braket
id|ptr
)braket
dot
id|config
suffix:semicolon
)brace
DECL|function|sound_install_audiodrv
r_int
id|sound_install_audiodrv
c_func
(paren
r_int
id|vers
comma
r_char
op_star
id|name
comma
r_struct
id|audio_driver
op_star
id|driver
comma
r_int
id|driver_size
comma
r_int
id|flags
comma
r_int
r_int
id|format_mask
comma
r_void
op_star
id|devc
comma
r_int
id|dma1
comma
r_int
id|dma2
)paren
(brace
macro_line|#ifdef CONFIG_AUDIO
r_struct
id|audio_driver
op_star
id|d
suffix:semicolon
r_struct
id|audio_operations
op_star
id|op
suffix:semicolon
r_int
id|l
comma
id|num
suffix:semicolon
r_if
c_cond
(paren
id|vers
op_ne
id|AUDIO_DRIVER_VERSION
op_logical_or
id|driver_size
OG
r_sizeof
(paren
r_struct
id|audio_driver
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;Sound: Incompatible audio driver for %s&bslash;n&quot;
comma
id|name
)paren
suffix:semicolon
r_return
op_minus
(paren
id|EINVAL
)paren
suffix:semicolon
)brace
id|num
op_assign
id|sound_alloc_audiodev
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|num
op_eq
op_minus
l_int|1
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;sound: Too many audio drivers&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
(paren
id|EBUSY
)paren
suffix:semicolon
)brace
id|d
op_assign
(paren
r_struct
id|audio_driver
op_star
)paren
(paren
id|sound_mem_blocks
(braket
id|sound_nblocks
)braket
op_assign
id|vmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|audio_driver
)paren
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|sound_nblocks
OL
l_int|1024
)paren
id|sound_nblocks
op_increment
suffix:semicolon
id|op
op_assign
(paren
r_struct
id|audio_operations
op_star
)paren
(paren
id|sound_mem_blocks
(braket
id|sound_nblocks
)braket
op_assign
id|vmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|audio_operations
)paren
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|sound_nblocks
OL
l_int|1024
)paren
id|sound_nblocks
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|d
op_eq
l_int|NULL
op_logical_or
id|op
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;Sound: Can&squot;t allocate driver for (%s)&bslash;n&quot;
comma
id|name
)paren
suffix:semicolon
id|sound_unload_audiodev
c_func
(paren
id|num
)paren
suffix:semicolon
r_return
op_minus
(paren
id|ENOMEM
)paren
suffix:semicolon
)brace
id|memset
c_func
(paren
(paren
r_char
op_star
)paren
id|op
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|audio_operations
)paren
)paren
suffix:semicolon
id|init_waitqueue
c_func
(paren
op_amp
id|op-&gt;in_sleeper
)paren
suffix:semicolon
id|init_waitqueue
c_func
(paren
op_amp
id|op-&gt;out_sleeper
)paren
suffix:semicolon
r_if
c_cond
(paren
id|driver_size
OL
r_sizeof
(paren
r_struct
id|audio_driver
)paren
)paren
id|memset
c_func
(paren
(paren
r_char
op_star
)paren
id|d
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|audio_driver
)paren
)paren
suffix:semicolon
id|memcpy
c_func
(paren
(paren
r_char
op_star
)paren
id|d
comma
(paren
r_char
op_star
)paren
id|driver
comma
id|driver_size
)paren
suffix:semicolon
id|op-&gt;d
op_assign
id|d
suffix:semicolon
id|l
op_assign
id|strlen
c_func
(paren
id|name
)paren
op_plus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|l
OG
r_sizeof
(paren
id|op-&gt;name
)paren
)paren
id|l
op_assign
r_sizeof
(paren
id|op-&gt;name
)paren
suffix:semicolon
id|strncpy
c_func
(paren
id|op-&gt;name
comma
id|name
comma
id|l
)paren
suffix:semicolon
id|op-&gt;name
(braket
id|l
op_minus
l_int|1
)braket
op_assign
l_int|0
suffix:semicolon
id|op-&gt;flags
op_assign
id|flags
suffix:semicolon
id|op-&gt;format_mask
op_assign
id|format_mask
suffix:semicolon
id|op-&gt;devc
op_assign
id|devc
suffix:semicolon
multiline_comment|/*&n;&t; *    Hardcoded defaults&n;&t; */
id|audio_devs
(braket
id|num
)braket
op_assign
id|op
suffix:semicolon
id|DMAbuf_init
c_func
(paren
id|num
comma
id|dma1
comma
id|dma2
)paren
suffix:semicolon
id|audio_init_devices
c_func
(paren
)paren
suffix:semicolon
r_return
id|num
suffix:semicolon
macro_line|#else
r_return
op_minus
id|EINVAL
suffix:semicolon
macro_line|#endif
)brace
DECL|function|sound_install_mixer
r_int
id|sound_install_mixer
c_func
(paren
r_int
id|vers
comma
r_char
op_star
id|name
comma
r_struct
id|mixer_operations
op_star
id|driver
comma
r_int
id|driver_size
comma
r_void
op_star
id|devc
)paren
(brace
r_struct
id|mixer_operations
op_star
id|op
suffix:semicolon
r_int
id|l
suffix:semicolon
r_int
id|n
op_assign
id|sound_alloc_mixerdev
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|n
op_eq
op_minus
l_int|1
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;Sound: Too many mixer drivers&bslash;n&quot;
)paren
suffix:semicolon
r_return
op_minus
id|EBUSY
suffix:semicolon
)brace
r_if
c_cond
(paren
id|vers
op_ne
id|MIXER_DRIVER_VERSION
op_logical_or
id|driver_size
OG
r_sizeof
(paren
r_struct
id|mixer_operations
)paren
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;Sound: Incompatible mixer driver for %s&bslash;n&quot;
comma
id|name
)paren
suffix:semicolon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
multiline_comment|/* FIXME: This leaks a mixer_operations struct every time its called&n;&t;   until you unload sound! */
id|op
op_assign
(paren
r_struct
id|mixer_operations
op_star
)paren
(paren
id|sound_mem_blocks
(braket
id|sound_nblocks
)braket
op_assign
id|vmalloc
c_func
(paren
r_sizeof
(paren
r_struct
id|mixer_operations
)paren
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|sound_nblocks
OL
l_int|1024
)paren
id|sound_nblocks
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|op
op_eq
l_int|NULL
)paren
(brace
id|printk
c_func
(paren
id|KERN_ERR
l_string|&quot;Sound: Can&squot;t allocate mixer driver for (%s)&bslash;n&quot;
comma
id|name
)paren
suffix:semicolon
r_return
op_minus
id|ENOMEM
suffix:semicolon
)brace
id|memset
c_func
(paren
(paren
r_char
op_star
)paren
id|op
comma
l_int|0
comma
r_sizeof
(paren
r_struct
id|mixer_operations
)paren
)paren
suffix:semicolon
id|memcpy
c_func
(paren
(paren
r_char
op_star
)paren
id|op
comma
(paren
r_char
op_star
)paren
id|driver
comma
id|driver_size
)paren
suffix:semicolon
id|l
op_assign
id|strlen
c_func
(paren
id|name
)paren
op_plus
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|l
OG
r_sizeof
(paren
id|op-&gt;name
)paren
)paren
id|l
op_assign
r_sizeof
(paren
id|op-&gt;name
)paren
suffix:semicolon
id|strncpy
c_func
(paren
id|op-&gt;name
comma
id|name
comma
id|l
)paren
suffix:semicolon
id|op-&gt;name
(braket
id|l
op_minus
l_int|1
)braket
op_assign
l_int|0
suffix:semicolon
id|op-&gt;devc
op_assign
id|devc
suffix:semicolon
id|mixer_devs
(braket
id|n
)braket
op_assign
id|op
suffix:semicolon
r_return
id|n
suffix:semicolon
)brace
DECL|function|sound_unload_audiodev
r_void
id|sound_unload_audiodev
c_func
(paren
r_int
id|dev
)paren
(brace
r_if
c_cond
(paren
id|dev
op_ne
op_minus
l_int|1
)paren
(brace
id|audio_devs
(braket
id|dev
)braket
op_assign
l_int|NULL
suffix:semicolon
id|unregister_sound_dsp
c_func
(paren
(paren
id|dev
op_lshift
l_int|4
)paren
op_plus
l_int|3
)paren
suffix:semicolon
)brace
)brace
DECL|function|sound_alloc_audiodev
r_int
id|sound_alloc_audiodev
c_func
(paren
r_void
)paren
(brace
r_int
id|i
op_assign
id|register_sound_dsp
c_func
(paren
op_amp
id|oss_sound_fops
)paren
suffix:semicolon
r_if
c_cond
(paren
id|i
op_eq
op_minus
l_int|1
)paren
(brace
r_return
id|i
suffix:semicolon
)brace
id|i
op_rshift_assign
l_int|4
suffix:semicolon
r_if
c_cond
(paren
id|i
op_ge
id|num_audiodevs
)paren
(brace
id|num_audiodevs
op_assign
id|i
op_plus
l_int|1
suffix:semicolon
)brace
r_return
id|i
suffix:semicolon
)brace
DECL|function|sound_alloc_mididev
r_int
id|sound_alloc_mididev
c_func
(paren
r_void
)paren
(brace
macro_line|#ifdef CONFIG_MIDI
r_int
id|i
op_assign
id|register_sound_midi
c_func
(paren
op_amp
id|oss_sound_fops
)paren
suffix:semicolon
r_if
c_cond
(paren
id|i
op_eq
op_minus
l_int|1
)paren
(brace
r_return
id|i
suffix:semicolon
)brace
id|i
op_rshift_assign
l_int|4
suffix:semicolon
r_if
c_cond
(paren
id|i
op_ge
id|num_midis
)paren
(brace
id|num_midis
op_assign
id|i
op_plus
l_int|1
suffix:semicolon
)brace
r_return
id|i
suffix:semicolon
macro_line|#else
r_return
(paren
op_minus
l_int|1
)paren
suffix:semicolon
macro_line|#endif
)brace
DECL|function|sound_alloc_synthdev
r_int
id|sound_alloc_synthdev
c_func
(paren
r_void
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|MAX_SYNTH_DEV
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|synth_devs
(braket
id|i
)braket
op_eq
l_int|NULL
)paren
(brace
r_if
c_cond
(paren
id|i
op_ge
id|num_synths
)paren
id|num_synths
op_increment
suffix:semicolon
r_return
id|i
suffix:semicolon
)brace
)brace
r_return
op_minus
l_int|1
suffix:semicolon
)brace
DECL|function|sound_alloc_mixerdev
r_int
id|sound_alloc_mixerdev
c_func
(paren
r_void
)paren
(brace
r_int
id|i
op_assign
id|register_sound_mixer
c_func
(paren
op_amp
id|oss_sound_fops
)paren
suffix:semicolon
r_if
c_cond
(paren
id|i
op_eq
op_minus
l_int|1
)paren
(brace
r_return
op_minus
l_int|1
suffix:semicolon
)brace
id|i
op_rshift_assign
l_int|4
suffix:semicolon
r_if
c_cond
(paren
id|i
op_ge
id|num_mixers
)paren
(brace
id|num_mixers
op_assign
id|i
op_plus
l_int|1
suffix:semicolon
)brace
r_return
id|i
suffix:semicolon
)brace
DECL|function|sound_alloc_timerdev
r_int
id|sound_alloc_timerdev
c_func
(paren
r_void
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|MAX_TIMER_DEV
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
id|sound_timer_devs
(braket
id|i
)braket
op_eq
l_int|NULL
)paren
(brace
r_if
c_cond
(paren
id|i
op_ge
id|num_sound_timers
)paren
id|num_sound_timers
op_increment
suffix:semicolon
r_return
id|i
suffix:semicolon
)brace
)brace
r_return
op_minus
l_int|1
suffix:semicolon
)brace
DECL|function|sound_unload_mixerdev
r_void
id|sound_unload_mixerdev
c_func
(paren
r_int
id|dev
)paren
(brace
r_if
c_cond
(paren
id|dev
op_ne
op_minus
l_int|1
)paren
(brace
id|mixer_devs
(braket
id|dev
)braket
op_assign
l_int|NULL
suffix:semicolon
id|unregister_sound_mixer
c_func
(paren
id|dev
op_lshift
l_int|4
)paren
suffix:semicolon
)brace
)brace
DECL|function|sound_unload_mididev
r_void
id|sound_unload_mididev
c_func
(paren
r_int
id|dev
)paren
(brace
macro_line|#ifdef CONFIG_MIDI
r_if
c_cond
(paren
id|dev
op_ne
op_minus
l_int|1
)paren
(brace
id|midi_devs
(braket
id|dev
)braket
op_assign
l_int|NULL
suffix:semicolon
id|unregister_sound_midi
c_func
(paren
(paren
id|dev
op_lshift
l_int|4
)paren
op_plus
l_int|2
)paren
suffix:semicolon
)brace
macro_line|#endif
)brace
DECL|function|sound_unload_synthdev
r_void
id|sound_unload_synthdev
c_func
(paren
r_int
id|dev
)paren
(brace
r_if
c_cond
(paren
id|dev
op_ne
op_minus
l_int|1
)paren
id|synth_devs
(braket
id|dev
)braket
op_assign
l_int|NULL
suffix:semicolon
)brace
DECL|function|sound_unload_timerdev
r_void
id|sound_unload_timerdev
c_func
(paren
r_int
id|dev
)paren
(brace
r_if
c_cond
(paren
id|dev
op_ne
op_minus
l_int|1
)paren
id|sound_timer_devs
(braket
id|dev
)braket
op_assign
l_int|NULL
suffix:semicolon
)brace
eof
