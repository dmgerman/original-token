multiline_comment|/*&n; * drivers/sound/vidc_mixer.c&n; *&n; * Mixer routines for VIDC&n; *&n; * Copyright (C) 1997 Russell King &lt;rmk@arm.uk.linux.org&gt;&n; */
macro_line|#include &quot;sound_config.h&quot;
macro_line|#include &quot;vidc.h&quot;
DECL|variable|vidc_volume
r_int
id|vidc_volume
suffix:semicolon
DECL|function|vidc_get_volume
r_static
r_int
id|vidc_get_volume
c_func
(paren
r_void
)paren
(brace
r_return
id|vidc_volume
suffix:semicolon
)brace
DECL|function|vidc_set_volume
r_static
r_int
id|vidc_set_volume
c_func
(paren
r_int
id|newvol
)paren
(brace
id|vidc_volume
op_assign
id|newvol
suffix:semicolon
multiline_comment|/*  printk (&quot;vidc_set_volume: %X&bslash;n&quot;, newvol); */
r_return
id|newvol
suffix:semicolon
)brace
DECL|function|vidc_default_mixer_ioctl
r_static
r_int
id|vidc_default_mixer_ioctl
c_func
(paren
r_int
id|dev
comma
r_int
r_int
id|cmd
comma
id|caddr_t
id|arg
)paren
(brace
r_int
id|ret
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|SOUND_MIXER_READ_VOLUME
suffix:colon
id|ret
op_assign
id|vidc_get_volume
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SOUND_MIXER_WRITE_VOLUME
suffix:colon
r_if
c_cond
(paren
id|get_user
c_func
(paren
id|ret
comma
(paren
r_int
op_star
)paren
id|arg
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|ret
op_assign
id|vidc_set_volume
c_func
(paren
id|ret
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SOUND_MIXER_READ_BASS
suffix:colon
r_case
id|SOUND_MIXER_WRITE_BASS
suffix:colon
r_case
id|SOUND_MIXER_READ_TREBLE
suffix:colon
r_case
id|SOUND_MIXER_WRITE_TREBLE
suffix:colon
id|ret
op_assign
l_int|50
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SOUND_MIXER_READ_SYNTH
suffix:colon
singleline_comment|//&t;&t;&t;ret = vidc_synth_get_volume();
id|ret
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SOUND_MIXER_WRITE_SYNTH
suffix:colon
r_if
c_cond
(paren
id|get_user
c_func
(paren
id|ret
comma
(paren
r_int
op_star
)paren
id|arg
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
singleline_comment|//&t;&t;&t;ret = vidc_synth_set_volume(ret);
id|ret
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SOUND_MIXER_READ_PCM
suffix:colon
id|ret
op_assign
id|vidc_audio_get_volume
c_func
(paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SOUND_MIXER_WRITE_PCM
suffix:colon
r_if
c_cond
(paren
id|get_user
c_func
(paren
id|ret
comma
(paren
r_int
op_star
)paren
id|arg
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|ret
op_assign
id|vidc_audio_set_volume
c_func
(paren
id|ret
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SOUND_MIXER_READ_SPEAKER
suffix:colon
id|ret
op_assign
l_int|100
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SOUND_MIXER_WRITE_SPEAKER
suffix:colon
id|ret
op_assign
l_int|100
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SOUND_MIXER_READ_LINE
suffix:colon
r_case
id|SOUND_MIXER_WRITE_LINE
suffix:colon
r_case
id|SOUND_MIXER_READ_MIC
suffix:colon
r_case
id|SOUND_MIXER_WRITE_MIC
suffix:colon
id|ret
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SOUND_MIXER_READ_CD
suffix:colon
r_case
id|SOUND_MIXER_WRITE_CD
suffix:colon
id|ret
op_assign
l_int|100
op_or
(paren
l_int|100
op_lshift
l_int|8
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SOUND_MIXER_READ_IMIX
suffix:colon
r_case
id|SOUND_MIXER_WRITE_IMIX
suffix:colon
r_case
id|SOUND_MIXER_READ_ALTPCM
suffix:colon
r_case
id|SOUND_MIXER_WRITE_ALTPCM
suffix:colon
r_case
id|SOUND_MIXER_READ_LINE1
suffix:colon
r_case
id|SOUND_MIXER_WRITE_LINE1
suffix:colon
r_case
id|SOUND_MIXER_READ_LINE2
suffix:colon
r_case
id|SOUND_MIXER_WRITE_LINE2
suffix:colon
r_case
id|SOUND_MIXER_READ_LINE3
suffix:colon
r_case
id|SOUND_MIXER_WRITE_LINE3
suffix:colon
id|ret
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SOUND_MIXER_READ_RECSRC
suffix:colon
id|ret
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SOUND_MIXER_WRITE_RECSRC
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SOUND_MIXER_READ_DEVMASK
suffix:colon
id|ret
op_assign
id|SOUND_MASK_VOLUME
op_or
id|SOUND_MASK_PCM
op_or
id|SOUND_MASK_SYNTH
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SOUND_MIXER_READ_RECMASK
suffix:colon
id|ret
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SOUND_MIXER_READ_STEREODEVS
suffix:colon
id|ret
op_assign
id|SOUND_MASK_VOLUME
op_or
id|SOUND_MASK_PCM
op_or
id|SOUND_MASK_SYNTH
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SOUND_MIXER_READ_CAPS
suffix:colon
id|ret
op_assign
l_int|0
suffix:semicolon
r_break
suffix:semicolon
r_case
id|SOUND_MIXER_READ_MUTE
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
r_break
suffix:semicolon
)brace
r_return
id|put_user
c_func
(paren
id|ret
comma
(paren
r_int
op_star
)paren
id|arg
)paren
suffix:semicolon
)brace
DECL|variable|vidc_mixer_operations
r_static
r_struct
id|mixer_operations
id|vidc_mixer_operations
op_assign
(brace
l_string|&quot;VIDC&quot;
comma
l_string|&quot;VIDCsound&quot;
comma
id|vidc_default_mixer_ioctl
multiline_comment|/* ioctl                */
)brace
suffix:semicolon
DECL|function|vidc_mixer_init
r_void
id|vidc_mixer_init
c_func
(paren
r_struct
id|address_info
op_star
id|hw_config
)paren
(brace
r_int
id|vidc_mixer
op_assign
id|sound_alloc_mixerdev
c_func
(paren
)paren
suffix:semicolon
id|vidc_volume
op_assign
l_int|100
op_or
(paren
l_int|100
op_lshift
l_int|8
)paren
suffix:semicolon
r_if
c_cond
(paren
id|num_mixers
OL
id|MAX_MIXER_DEV
)paren
id|mixer_devs
(braket
id|vidc_mixer
)braket
op_assign
op_amp
id|vidc_mixer_operations
suffix:semicolon
)brace
eof
