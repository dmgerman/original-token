multiline_comment|/*&n; *  linux/kernel/chr_drv/tty_ioctl.c&n; *&n; *  (C) 1991  Linus Torvalds&n; */
macro_line|#include &lt;errno.h&gt;
macro_line|#include &lt;termios.h&gt;
macro_line|#include &lt;linux/sched.h&gt;
macro_line|#include &lt;linux/kernel.h&gt;
macro_line|#include &lt;linux/tty.h&gt;
macro_line|#include &lt;asm/io.h&gt;
macro_line|#include &lt;asm/segment.h&gt;
macro_line|#include &lt;asm/system.h&gt;
r_extern
r_int
id|session_of_pgrp
c_func
(paren
r_int
id|pgrp
)paren
suffix:semicolon
r_extern
r_int
id|do_screendump
c_func
(paren
r_int
id|arg
)paren
suffix:semicolon
r_extern
r_int
id|kill_pg
c_func
(paren
r_int
id|pgrp
comma
r_int
id|sig
comma
r_int
id|priv
)paren
suffix:semicolon
r_extern
r_int
id|tty_signal
c_func
(paren
r_int
id|sig
comma
r_struct
id|tty_struct
op_star
id|tty
)paren
suffix:semicolon
DECL|variable|quotient
r_static
r_int
r_int
id|quotient
(braket
)braket
op_assign
(brace
l_int|0
comma
l_int|2304
comma
l_int|1536
comma
l_int|1047
comma
l_int|857
comma
l_int|768
comma
l_int|576
comma
l_int|384
comma
l_int|192
comma
l_int|96
comma
l_int|64
comma
l_int|48
comma
l_int|24
comma
l_int|12
comma
l_int|6
comma
l_int|3
)brace
suffix:semicolon
DECL|function|change_speed
r_static
r_void
id|change_speed
c_func
(paren
r_struct
id|tty_struct
op_star
id|tty
)paren
(brace
r_int
r_int
id|port
comma
id|quot
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|port
op_assign
id|tty-&gt;read_q-&gt;data
)paren
)paren
r_return
suffix:semicolon
id|quot
op_assign
id|quotient
(braket
id|tty-&gt;termios.c_cflag
op_amp
id|CBAUD
)braket
suffix:semicolon
id|cli
c_func
(paren
)paren
suffix:semicolon
id|outb_p
c_func
(paren
l_int|0x80
comma
id|port
op_plus
l_int|3
)paren
suffix:semicolon
multiline_comment|/* set DLAB */
id|outb_p
c_func
(paren
id|quot
op_amp
l_int|0xff
comma
id|port
)paren
suffix:semicolon
multiline_comment|/* LS of divisor */
id|outb_p
c_func
(paren
id|quot
op_rshift
l_int|8
comma
id|port
op_plus
l_int|1
)paren
suffix:semicolon
multiline_comment|/* MS of divisor */
id|outb
c_func
(paren
l_int|0x03
comma
id|port
op_plus
l_int|3
)paren
suffix:semicolon
multiline_comment|/* reset DLAB */
id|sti
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|function|flush
r_static
r_void
id|flush
c_func
(paren
r_struct
id|tty_queue
op_star
id|queue
)paren
(brace
r_if
c_cond
(paren
id|queue
)paren
(brace
id|cli
c_func
(paren
)paren
suffix:semicolon
id|queue-&gt;head
op_assign
id|queue-&gt;tail
suffix:semicolon
id|sti
c_func
(paren
)paren
suffix:semicolon
id|wake_up
c_func
(paren
op_amp
id|queue-&gt;proc_list
)paren
suffix:semicolon
)brace
)brace
DECL|function|wait_until_sent
r_static
r_void
id|wait_until_sent
c_func
(paren
r_struct
id|tty_struct
op_star
id|tty
)paren
(brace
id|cli
c_func
(paren
)paren
suffix:semicolon
r_while
c_loop
(paren
op_logical_neg
(paren
id|current-&gt;signal
op_amp
op_complement
id|current-&gt;blocked
)paren
op_logical_and
op_logical_neg
id|EMPTY
c_func
(paren
id|tty-&gt;write_q
)paren
)paren
(brace
id|current-&gt;counter
op_assign
l_int|0
suffix:semicolon
id|interruptible_sleep_on
c_func
(paren
op_amp
id|tty-&gt;write_q-&gt;proc_list
)paren
suffix:semicolon
)brace
id|sti
c_func
(paren
)paren
suffix:semicolon
)brace
DECL|function|send_break
r_static
r_void
id|send_break
c_func
(paren
r_struct
id|tty_struct
op_star
id|tty
)paren
(brace
multiline_comment|/* do nothing - not implemented */
)brace
DECL|function|do_get_ps_info
r_static
r_int
id|do_get_ps_info
c_func
(paren
r_int
id|arg
)paren
(brace
r_struct
id|tstruct
(brace
r_int
id|flag
suffix:semicolon
r_int
id|present
(braket
id|NR_TASKS
)braket
suffix:semicolon
r_struct
id|task_struct
id|tasks
(braket
id|NR_TASKS
)braket
suffix:semicolon
)brace
suffix:semicolon
r_struct
id|tstruct
op_star
id|ts
op_assign
(paren
r_struct
id|tstruct
op_star
)paren
id|arg
suffix:semicolon
r_struct
id|task_struct
op_star
op_star
id|p
suffix:semicolon
r_char
op_star
id|c
comma
op_star
id|d
suffix:semicolon
r_int
id|i
comma
id|n
op_assign
l_int|0
suffix:semicolon
id|verify_area
c_func
(paren
(paren
r_void
op_star
)paren
id|arg
comma
r_sizeof
(paren
r_struct
id|tstruct
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|p
op_assign
op_amp
id|FIRST_TASK
suffix:semicolon
id|p
op_le
op_amp
id|LAST_TASK
suffix:semicolon
id|p
op_increment
comma
id|n
op_increment
)paren
r_if
c_cond
(paren
op_star
id|p
)paren
(brace
id|c
op_assign
(paren
r_char
op_star
)paren
(paren
op_star
id|p
)paren
suffix:semicolon
id|d
op_assign
(paren
r_char
op_star
)paren
(paren
id|ts-&gt;tasks
op_plus
id|n
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
r_sizeof
(paren
r_struct
id|task_struct
)paren
suffix:semicolon
id|i
op_increment
)paren
id|put_fs_byte
c_func
(paren
op_star
id|c
op_increment
comma
id|d
op_increment
)paren
suffix:semicolon
id|put_fs_long
c_func
(paren
l_int|1
comma
(paren
r_int
r_int
op_star
)paren
(paren
id|ts-&gt;present
op_plus
id|n
)paren
)paren
suffix:semicolon
)brace
r_else
id|put_fs_long
c_func
(paren
l_int|0
comma
(paren
r_int
r_int
op_star
)paren
(paren
id|ts-&gt;present
op_plus
id|n
)paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|get_termios
r_static
r_int
id|get_termios
c_func
(paren
r_struct
id|tty_struct
op_star
id|tty
comma
r_struct
id|termios
op_star
id|termios
)paren
(brace
r_int
id|i
suffix:semicolon
id|verify_area
c_func
(paren
id|termios
comma
r_sizeof
(paren
op_star
id|termios
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
(paren
r_sizeof
(paren
op_star
id|termios
)paren
)paren
suffix:semicolon
id|i
op_increment
)paren
id|put_fs_byte
c_func
(paren
(paren
(paren
r_char
op_star
)paren
op_amp
id|tty-&gt;termios
)paren
(braket
id|i
)braket
comma
id|i
op_plus
(paren
r_char
op_star
)paren
id|termios
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|set_termios
r_static
r_int
id|set_termios
c_func
(paren
r_struct
id|tty_struct
op_star
id|tty
comma
r_struct
id|termios
op_star
id|termios
comma
r_int
id|channel
)paren
(brace
r_int
id|i
comma
id|retsig
suffix:semicolon
multiline_comment|/* If we try to set the state of terminal and we&squot;re not in the&n;&t;   foreground, send a SIGTTOU.  If the signal is blocked or&n;&t;   ignored, go ahead and perform the operation.  POSIX 7.2) */
r_if
c_cond
(paren
(paren
id|current-&gt;tty
op_eq
id|channel
)paren
op_logical_and
(paren
id|tty-&gt;pgrp
op_ne
id|current-&gt;pgrp
)paren
)paren
(brace
id|retsig
op_assign
id|tty_signal
c_func
(paren
id|SIGTTOU
comma
id|tty
)paren
suffix:semicolon
r_if
c_cond
(paren
id|retsig
op_eq
op_minus
id|ERESTARTSYS
op_logical_or
id|retsig
op_eq
op_minus
id|EINTR
)paren
r_return
id|retsig
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
(paren
r_sizeof
(paren
op_star
id|termios
)paren
)paren
suffix:semicolon
id|i
op_increment
)paren
(paren
(paren
r_char
op_star
)paren
op_amp
id|tty-&gt;termios
)paren
(braket
id|i
)braket
op_assign
id|get_fs_byte
c_func
(paren
id|i
op_plus
(paren
r_char
op_star
)paren
id|termios
)paren
suffix:semicolon
id|change_speed
c_func
(paren
id|tty
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|get_termio
r_static
r_int
id|get_termio
c_func
(paren
r_struct
id|tty_struct
op_star
id|tty
comma
r_struct
id|termio
op_star
id|termio
)paren
(brace
r_int
id|i
suffix:semicolon
r_struct
id|termio
id|tmp_termio
suffix:semicolon
id|verify_area
c_func
(paren
id|termio
comma
r_sizeof
(paren
op_star
id|termio
)paren
)paren
suffix:semicolon
id|tmp_termio.c_iflag
op_assign
id|tty-&gt;termios.c_iflag
suffix:semicolon
id|tmp_termio.c_oflag
op_assign
id|tty-&gt;termios.c_oflag
suffix:semicolon
id|tmp_termio.c_cflag
op_assign
id|tty-&gt;termios.c_cflag
suffix:semicolon
id|tmp_termio.c_lflag
op_assign
id|tty-&gt;termios.c_lflag
suffix:semicolon
id|tmp_termio.c_line
op_assign
id|tty-&gt;termios.c_line
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|NCC
suffix:semicolon
id|i
op_increment
)paren
(brace
id|tmp_termio.c_cc
(braket
id|i
)braket
op_assign
id|tty-&gt;termios.c_cc
(braket
id|i
)braket
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
(paren
r_sizeof
(paren
op_star
id|termio
)paren
)paren
suffix:semicolon
id|i
op_increment
)paren
id|put_fs_byte
c_func
(paren
(paren
(paren
r_char
op_star
)paren
op_amp
id|tmp_termio
)paren
(braket
id|i
)braket
comma
id|i
op_plus
(paren
r_char
op_star
)paren
id|termio
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n; * This only works as the 386 is low-byte-first&n; */
DECL|function|set_termio
r_static
r_int
id|set_termio
c_func
(paren
r_struct
id|tty_struct
op_star
id|tty
comma
r_struct
id|termio
op_star
id|termio
comma
r_int
id|channel
)paren
(brace
r_int
id|i
comma
id|retsig
suffix:semicolon
r_struct
id|termio
id|tmp_termio
suffix:semicolon
r_if
c_cond
(paren
(paren
id|current-&gt;tty
op_eq
id|channel
)paren
op_logical_and
(paren
id|tty-&gt;pgrp
op_ne
id|current-&gt;pgrp
)paren
)paren
(brace
id|retsig
op_assign
id|tty_signal
c_func
(paren
id|SIGTTOU
comma
id|tty
)paren
suffix:semicolon
r_if
c_cond
(paren
id|retsig
op_eq
op_minus
id|ERESTARTSYS
op_logical_or
id|retsig
op_eq
op_minus
id|EINTR
)paren
r_return
id|retsig
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
(paren
r_sizeof
(paren
op_star
id|termio
)paren
)paren
suffix:semicolon
id|i
op_increment
)paren
(paren
(paren
r_char
op_star
)paren
op_amp
id|tmp_termio
)paren
(braket
id|i
)braket
op_assign
id|get_fs_byte
c_func
(paren
id|i
op_plus
(paren
r_char
op_star
)paren
id|termio
)paren
suffix:semicolon
op_star
(paren
r_int
r_int
op_star
)paren
op_amp
id|tty-&gt;termios.c_iflag
op_assign
id|tmp_termio.c_iflag
suffix:semicolon
op_star
(paren
r_int
r_int
op_star
)paren
op_amp
id|tty-&gt;termios.c_oflag
op_assign
id|tmp_termio.c_oflag
suffix:semicolon
op_star
(paren
r_int
r_int
op_star
)paren
op_amp
id|tty-&gt;termios.c_cflag
op_assign
id|tmp_termio.c_cflag
suffix:semicolon
op_star
(paren
r_int
r_int
op_star
)paren
op_amp
id|tty-&gt;termios.c_lflag
op_assign
id|tmp_termio.c_lflag
suffix:semicolon
id|tty-&gt;termios.c_line
op_assign
id|tmp_termio.c_line
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|NCC
suffix:semicolon
id|i
op_increment
)paren
(brace
id|tty-&gt;termios.c_cc
(braket
id|i
)braket
op_assign
id|tmp_termio.c_cc
(braket
id|i
)braket
suffix:semicolon
)brace
id|change_speed
c_func
(paren
id|tty
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|set_window_size
r_static
r_int
id|set_window_size
c_func
(paren
r_struct
id|tty_struct
op_star
id|tty
comma
r_struct
id|winsize
op_star
id|ws
)paren
(brace
r_int
id|i
comma
id|changed
suffix:semicolon
r_char
id|c
comma
op_star
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ws
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|tmp
op_assign
(paren
r_char
op_star
)paren
op_amp
id|tty-&gt;winsize
suffix:semicolon
id|changed
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
r_sizeof
(paren
op_star
id|ws
)paren
suffix:semicolon
id|i
op_increment
comma
id|tmp
op_increment
)paren
(brace
id|c
op_assign
id|get_fs_byte
c_func
(paren
id|i
op_plus
(paren
r_char
op_star
)paren
id|ws
)paren
suffix:semicolon
r_if
c_cond
(paren
id|c
op_eq
op_star
id|tmp
)paren
r_continue
suffix:semicolon
id|changed
op_assign
l_int|1
suffix:semicolon
op_star
id|tmp
op_assign
id|c
suffix:semicolon
)brace
r_if
c_cond
(paren
id|changed
)paren
id|kill_pg
c_func
(paren
id|tty-&gt;pgrp
comma
id|SIGWINCH
comma
l_int|1
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|get_window_size
r_static
r_int
id|get_window_size
c_func
(paren
r_struct
id|tty_struct
op_star
id|tty
comma
r_struct
id|winsize
op_star
id|ws
)paren
(brace
r_int
id|i
suffix:semicolon
r_char
op_star
id|tmp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ws
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
id|verify_area
c_func
(paren
id|ws
comma
r_sizeof
(paren
op_star
id|ws
)paren
)paren
suffix:semicolon
id|tmp
op_assign
(paren
r_char
op_star
)paren
id|ws
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
r_sizeof
(paren
r_struct
id|winsize
)paren
suffix:semicolon
id|i
op_increment
comma
id|tmp
op_increment
)paren
id|put_fs_byte
c_func
(paren
(paren
(paren
r_char
op_star
)paren
op_amp
id|tty-&gt;winsize
)paren
(braket
id|i
)braket
comma
id|tmp
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|tty_ioctl
r_int
id|tty_ioctl
c_func
(paren
r_int
id|dev
comma
r_int
id|cmd
comma
r_int
id|arg
)paren
(brace
r_struct
id|tty_struct
op_star
id|tty
suffix:semicolon
r_struct
id|tty_struct
op_star
id|other_tty
suffix:semicolon
r_int
id|pgrp
suffix:semicolon
r_if
c_cond
(paren
id|MAJOR
c_func
(paren
id|dev
)paren
op_eq
l_int|5
)paren
(brace
id|dev
op_assign
id|current-&gt;tty
suffix:semicolon
r_if
c_cond
(paren
id|dev
OL
l_int|0
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_else
id|dev
op_assign
id|MINOR
c_func
(paren
id|dev
)paren
suffix:semicolon
id|tty
op_assign
id|tty_table
op_plus
(paren
id|dev
ques
c_cond
(paren
(paren
id|dev
OL
l_int|64
)paren
ques
c_cond
id|dev
op_minus
l_int|1
suffix:colon
id|dev
)paren
suffix:colon
id|fg_console
)paren
suffix:semicolon
r_if
c_cond
(paren
id|IS_A_PTY
c_func
(paren
id|dev
)paren
)paren
id|other_tty
op_assign
id|tty_table
op_plus
id|PTY_OTHER
c_func
(paren
id|dev
)paren
suffix:semicolon
r_else
id|other_tty
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
(paren
id|tty-&gt;write_q
op_logical_and
id|tty-&gt;read_q
op_logical_and
id|tty-&gt;secondary
op_logical_and
id|tty-&gt;write
)paren
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_switch
c_cond
(paren
id|cmd
)paren
(brace
r_case
id|TCGETS
suffix:colon
r_return
id|get_termios
c_func
(paren
id|tty
comma
(paren
r_struct
id|termios
op_star
)paren
id|arg
)paren
suffix:semicolon
r_case
id|TCSETSF
suffix:colon
id|flush
c_func
(paren
id|tty-&gt;read_q
)paren
suffix:semicolon
id|flush
c_func
(paren
id|tty-&gt;secondary
)paren
suffix:semicolon
r_if
c_cond
(paren
id|other_tty
)paren
id|flush
c_func
(paren
id|other_tty-&gt;write_q
)paren
suffix:semicolon
multiline_comment|/* fallthrough */
r_case
id|TCSETSW
suffix:colon
id|wait_until_sent
c_func
(paren
id|tty
)paren
suffix:semicolon
multiline_comment|/* fallthrough */
r_case
id|TCSETS
suffix:colon
r_return
id|set_termios
c_func
(paren
id|tty
comma
(paren
r_struct
id|termios
op_star
)paren
id|arg
comma
id|dev
)paren
suffix:semicolon
r_case
id|TCGETA
suffix:colon
r_return
id|get_termio
c_func
(paren
id|tty
comma
(paren
r_struct
id|termio
op_star
)paren
id|arg
)paren
suffix:semicolon
r_case
id|TCSETAF
suffix:colon
id|flush
c_func
(paren
id|tty-&gt;read_q
)paren
suffix:semicolon
id|flush
c_func
(paren
id|tty-&gt;secondary
)paren
suffix:semicolon
r_if
c_cond
(paren
id|other_tty
)paren
id|flush
c_func
(paren
id|other_tty-&gt;write_q
)paren
suffix:semicolon
multiline_comment|/* fallthrough */
r_case
id|TCSETAW
suffix:colon
id|wait_until_sent
c_func
(paren
id|tty
)paren
suffix:semicolon
multiline_comment|/* fallthrough */
r_case
id|TCSETA
suffix:colon
r_return
id|set_termio
c_func
(paren
id|tty
comma
(paren
r_struct
id|termio
op_star
)paren
id|arg
comma
id|dev
)paren
suffix:semicolon
r_case
id|TCSBRK
suffix:colon
r_if
c_cond
(paren
op_logical_neg
id|arg
)paren
(brace
id|wait_until_sent
c_func
(paren
id|tty
)paren
suffix:semicolon
id|send_break
c_func
(paren
id|tty
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
r_case
id|TCXONC
suffix:colon
r_switch
c_cond
(paren
id|arg
)paren
(brace
r_case
id|TCOOFF
suffix:colon
id|tty-&gt;stopped
op_assign
l_int|1
suffix:semicolon
id|TTY_WRITE_FLUSH
c_func
(paren
id|tty
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|TCOON
suffix:colon
id|tty-&gt;stopped
op_assign
l_int|0
suffix:semicolon
id|TTY_WRITE_FLUSH
c_func
(paren
id|tty
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|TCIOFF
suffix:colon
r_if
c_cond
(paren
id|STOP_CHAR
c_func
(paren
id|tty
)paren
)paren
id|PUTCH
c_func
(paren
id|STOP_CHAR
c_func
(paren
id|tty
)paren
comma
id|tty-&gt;write_q
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|TCION
suffix:colon
r_if
c_cond
(paren
id|START_CHAR
c_func
(paren
id|tty
)paren
)paren
id|PUTCH
c_func
(paren
id|START_CHAR
c_func
(paren
id|tty
)paren
comma
id|tty-&gt;write_q
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_return
op_minus
id|EINVAL
suffix:semicolon
multiline_comment|/* not implemented */
r_case
id|TCFLSH
suffix:colon
r_if
c_cond
(paren
id|arg
op_eq
l_int|0
)paren
(brace
id|flush
c_func
(paren
id|tty-&gt;read_q
)paren
suffix:semicolon
id|flush
c_func
(paren
id|tty-&gt;secondary
)paren
suffix:semicolon
r_if
c_cond
(paren
id|other_tty
)paren
id|flush
c_func
(paren
id|other_tty-&gt;write_q
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|arg
op_eq
l_int|1
)paren
id|flush
c_func
(paren
id|tty-&gt;write_q
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|arg
op_eq
l_int|2
)paren
(brace
id|flush
c_func
(paren
id|tty-&gt;read_q
)paren
suffix:semicolon
id|flush
c_func
(paren
id|tty-&gt;secondary
)paren
suffix:semicolon
id|flush
c_func
(paren
id|tty-&gt;write_q
)paren
suffix:semicolon
r_if
c_cond
(paren
id|other_tty
)paren
id|flush
c_func
(paren
id|other_tty-&gt;write_q
)paren
suffix:semicolon
)brace
r_else
r_return
op_minus
id|EINVAL
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|TIOCEXCL
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
multiline_comment|/* not implemented */
r_case
id|TIOCNXCL
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
multiline_comment|/* not implemented */
r_case
id|TIOCSCTTY
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
multiline_comment|/* set controlling term NI */
r_case
id|TIOCGPGRP
suffix:colon
id|verify_area
c_func
(paren
(paren
r_void
op_star
)paren
id|arg
comma
l_int|4
)paren
suffix:semicolon
id|put_fs_long
c_func
(paren
id|tty-&gt;pgrp
comma
(paren
r_int
r_int
op_star
)paren
id|arg
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|TIOCSPGRP
suffix:colon
r_if
c_cond
(paren
(paren
id|current-&gt;tty
OL
l_int|0
)paren
op_logical_or
(paren
id|current-&gt;tty
op_ne
id|dev
)paren
op_logical_or
(paren
id|tty-&gt;session
op_ne
id|current-&gt;session
)paren
)paren
r_return
op_minus
id|ENOTTY
suffix:semicolon
id|pgrp
op_assign
id|get_fs_long
c_func
(paren
(paren
r_int
r_int
op_star
)paren
id|arg
)paren
suffix:semicolon
r_if
c_cond
(paren
id|pgrp
OL
l_int|0
)paren
r_return
op_minus
id|EINVAL
suffix:semicolon
r_if
c_cond
(paren
id|session_of_pgrp
c_func
(paren
id|pgrp
)paren
op_ne
id|current-&gt;session
)paren
r_return
op_minus
id|EPERM
suffix:semicolon
id|tty-&gt;pgrp
op_assign
id|pgrp
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|TIOCOUTQ
suffix:colon
id|verify_area
c_func
(paren
(paren
r_void
op_star
)paren
id|arg
comma
l_int|4
)paren
suffix:semicolon
id|put_fs_long
c_func
(paren
id|CHARS
c_func
(paren
id|tty-&gt;write_q
)paren
comma
(paren
r_int
r_int
op_star
)paren
id|arg
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|TIOCINQ
suffix:colon
id|verify_area
c_func
(paren
(paren
r_void
op_star
)paren
id|arg
comma
l_int|4
)paren
suffix:semicolon
id|put_fs_long
c_func
(paren
id|CHARS
c_func
(paren
id|tty-&gt;secondary
)paren
comma
(paren
r_int
r_int
op_star
)paren
id|arg
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
r_case
id|TIOCSTI
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
multiline_comment|/* not implemented */
r_case
id|TIOCGWINSZ
suffix:colon
r_return
id|get_window_size
c_func
(paren
id|tty
comma
(paren
r_struct
id|winsize
op_star
)paren
id|arg
)paren
suffix:semicolon
r_case
id|TIOCSWINSZ
suffix:colon
r_if
c_cond
(paren
id|other_tty
)paren
id|set_window_size
c_func
(paren
id|other_tty
comma
(paren
r_struct
id|winsize
op_star
)paren
id|arg
)paren
suffix:semicolon
r_return
id|set_window_size
c_func
(paren
id|tty
comma
(paren
r_struct
id|winsize
op_star
)paren
id|arg
)paren
suffix:semicolon
r_case
id|TIOCMGET
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
multiline_comment|/* not implemented */
r_case
id|TIOCMBIS
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
multiline_comment|/* not implemented */
r_case
id|TIOCMBIC
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
multiline_comment|/* not implemented */
r_case
id|TIOCMSET
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
multiline_comment|/* not implemented */
r_case
id|TIOCGSOFTCAR
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
multiline_comment|/* not implemented */
r_case
id|TIOCSSOFTCAR
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
multiline_comment|/* not implemented */
r_case
id|TIOCLINUX
suffix:colon
r_switch
c_cond
(paren
id|get_fs_byte
c_func
(paren
(paren
r_char
op_star
)paren
id|arg
)paren
)paren
(brace
r_case
l_int|0
suffix:colon
r_return
id|do_screendump
c_func
(paren
id|arg
)paren
suffix:semicolon
r_case
l_int|1
suffix:colon
r_return
id|do_get_ps_info
c_func
(paren
id|arg
)paren
suffix:semicolon
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
r_default
suffix:colon
r_return
op_minus
id|EINVAL
suffix:semicolon
)brace
)brace
eof
