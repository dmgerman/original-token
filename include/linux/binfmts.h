macro_line|#ifndef _LINUX_BINFMTS_H
DECL|macro|_LINUX_BINFMTS_H
mdefine_line|#define _LINUX_BINFMTS_H
macro_line|#include &lt;linux/ptrace.h&gt;
macro_line|#include &lt;linux/capability.h&gt;
multiline_comment|/*&n; * MAX_ARG_PAGES defines the number of pages allocated for arguments&n; * and envelope for the new program. 32 should suffice, this gives&n; * a maximum env+arg of 128kB w/4KB pages!&n; */
DECL|macro|MAX_ARG_PAGES
mdefine_line|#define MAX_ARG_PAGES 32
multiline_comment|/* sizeof(linux_binprm-&gt;buf) */
DECL|macro|BINPRM_BUF_SIZE
mdefine_line|#define BINPRM_BUF_SIZE 128
macro_line|#ifdef __KERNEL__
multiline_comment|/*&n; * This structure is used to hold the arguments that are used when loading binaries.&n; */
DECL|struct|linux_binprm
r_struct
id|linux_binprm
(brace
DECL|member|buf
r_char
id|buf
(braket
id|BINPRM_BUF_SIZE
)braket
suffix:semicolon
DECL|member|page
r_struct
id|page
op_star
id|page
(braket
id|MAX_ARG_PAGES
)braket
suffix:semicolon
DECL|member|p
r_int
r_int
id|p
suffix:semicolon
multiline_comment|/* current top of mem */
DECL|member|sh_bang
r_int
id|sh_bang
suffix:semicolon
DECL|member|file
r_struct
id|file
op_star
id|file
suffix:semicolon
DECL|member|e_uid
DECL|member|e_gid
r_int
id|e_uid
comma
id|e_gid
suffix:semicolon
DECL|member|cap_inheritable
DECL|member|cap_permitted
DECL|member|cap_effective
id|kernel_cap_t
id|cap_inheritable
comma
id|cap_permitted
comma
id|cap_effective
suffix:semicolon
DECL|member|argc
DECL|member|envc
r_int
id|argc
comma
id|envc
suffix:semicolon
DECL|member|filename
r_char
op_star
id|filename
suffix:semicolon
multiline_comment|/* Name of binary */
DECL|member|loader
DECL|member|exec
r_int
r_int
id|loader
comma
id|exec
suffix:semicolon
)brace
suffix:semicolon
multiline_comment|/*&n; * This structure defines the functions that are used to load the binary formats that&n; * linux accepts.&n; */
DECL|struct|linux_binfmt
r_struct
id|linux_binfmt
(brace
DECL|member|next
r_struct
id|linux_binfmt
op_star
id|next
suffix:semicolon
DECL|member|module
r_struct
id|module
op_star
id|module
suffix:semicolon
DECL|member|load_binary
r_int
(paren
op_star
id|load_binary
)paren
(paren
r_struct
id|linux_binprm
op_star
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
suffix:semicolon
DECL|member|load_shlib
r_int
(paren
op_star
id|load_shlib
)paren
(paren
r_struct
id|file
op_star
)paren
suffix:semicolon
DECL|member|core_dump
r_int
(paren
op_star
id|core_dump
)paren
(paren
r_int
id|signr
comma
r_struct
id|pt_regs
op_star
id|regs
comma
r_struct
id|file
op_star
id|file
)paren
suffix:semicolon
DECL|member|min_coredump
r_int
r_int
id|min_coredump
suffix:semicolon
multiline_comment|/* minimal dump size */
)brace
suffix:semicolon
r_extern
r_int
id|register_binfmt
c_func
(paren
r_struct
id|linux_binfmt
op_star
)paren
suffix:semicolon
r_extern
r_int
id|unregister_binfmt
c_func
(paren
r_struct
id|linux_binfmt
op_star
)paren
suffix:semicolon
r_extern
r_int
id|prepare_binprm
c_func
(paren
r_struct
id|linux_binprm
op_star
)paren
suffix:semicolon
r_extern
r_void
id|remove_arg_zero
c_func
(paren
r_struct
id|linux_binprm
op_star
)paren
suffix:semicolon
r_extern
r_int
id|search_binary_handler
c_func
(paren
r_struct
id|linux_binprm
op_star
comma
r_struct
id|pt_regs
op_star
)paren
suffix:semicolon
r_extern
r_int
id|flush_old_exec
c_func
(paren
r_struct
id|linux_binprm
op_star
id|bprm
)paren
suffix:semicolon
r_extern
r_int
id|setup_arg_pages
c_func
(paren
r_struct
id|linux_binprm
op_star
id|bprm
)paren
suffix:semicolon
r_extern
r_int
id|copy_strings
c_func
(paren
r_int
id|argc
comma
r_char
op_star
op_star
id|argv
comma
r_struct
id|linux_binprm
op_star
id|bprm
)paren
suffix:semicolon
r_extern
r_int
id|copy_strings_kernel
c_func
(paren
r_int
id|argc
comma
r_char
op_star
op_star
id|argv
comma
r_struct
id|linux_binprm
op_star
id|bprm
)paren
suffix:semicolon
r_extern
r_void
id|compute_creds
c_func
(paren
r_struct
id|linux_binprm
op_star
id|binprm
)paren
suffix:semicolon
r_extern
r_int
id|do_coredump
c_func
(paren
r_int
id|signr
comma
r_struct
id|pt_regs
op_star
id|regs
)paren
suffix:semicolon
r_extern
r_void
id|set_binfmt
c_func
(paren
r_struct
id|linux_binfmt
op_star
r_new
)paren
suffix:semicolon
macro_line|#if 0
multiline_comment|/* this went away now */
mdefine_line|#define change_ldt(a,b) setup_arg_pages(a,b)
macro_line|#endif
macro_line|#endif /* __KERNEL__ */
macro_line|#endif /* _LINUX_BINFMTS_H */
eof
