macro_line|#ifndef _RAID1_H
DECL|macro|_RAID1_H
mdefine_line|#define _RAID1_H
macro_line|#include &lt;linux/raid/md.h&gt;
DECL|struct|mirror_info
r_struct
id|mirror_info
(brace
DECL|member|number
r_int
id|number
suffix:semicolon
DECL|member|raid_disk
r_int
id|raid_disk
suffix:semicolon
DECL|member|dev
id|kdev_t
id|dev
suffix:semicolon
DECL|member|sect_limit
r_int
id|sect_limit
suffix:semicolon
DECL|member|head_position
r_int
id|head_position
suffix:semicolon
multiline_comment|/*&n;&t; * State bits:&n;&t; */
DECL|member|operational
r_int
id|operational
suffix:semicolon
DECL|member|write_only
r_int
id|write_only
suffix:semicolon
DECL|member|spare
r_int
id|spare
suffix:semicolon
DECL|member|used_slot
r_int
id|used_slot
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|raid1_private_data
r_struct
id|raid1_private_data
(brace
DECL|member|mddev
id|mddev_t
op_star
id|mddev
suffix:semicolon
DECL|member|mirrors
r_struct
id|mirror_info
id|mirrors
(braket
id|MD_SB_DISKS
)braket
suffix:semicolon
DECL|member|nr_disks
r_int
id|nr_disks
suffix:semicolon
DECL|member|raid_disks
r_int
id|raid_disks
suffix:semicolon
DECL|member|working_disks
r_int
id|working_disks
suffix:semicolon
DECL|member|last_used
r_int
id|last_used
suffix:semicolon
DECL|member|next_sect
r_int
r_int
id|next_sect
suffix:semicolon
DECL|member|sect_count
r_int
id|sect_count
suffix:semicolon
DECL|member|thread
DECL|member|resync_thread
id|mdk_thread_t
op_star
id|thread
comma
op_star
id|resync_thread
suffix:semicolon
DECL|member|resync_mirrors
r_int
id|resync_mirrors
suffix:semicolon
DECL|member|spare
r_struct
id|mirror_info
op_star
id|spare
suffix:semicolon
DECL|member|device_lock
id|md_spinlock_t
id|device_lock
suffix:semicolon
multiline_comment|/* buffer pool */
multiline_comment|/* buffer_heads that we have pre-allocated have b_pprev -&gt; &amp;freebh&n;&t; * and are linked into a stack using b_next&n;&t; * raid1_bh that are pre-allocated have R1BH_PreAlloc set.&n;&t; * All these variable are protected by device_lock&n;&t; */
DECL|member|freebh
r_struct
id|buffer_head
op_star
id|freebh
suffix:semicolon
DECL|member|freebh_cnt
r_int
id|freebh_cnt
suffix:semicolon
multiline_comment|/* how many are on the list */
DECL|member|freer1
r_struct
id|raid1_bh
op_star
id|freer1
suffix:semicolon
DECL|member|freebuf
r_struct
id|raid1_bh
op_star
id|freebuf
suffix:semicolon
multiline_comment|/* each bh_req has a page allocated */
DECL|member|wait_buffer
id|md_wait_queue_head_t
id|wait_buffer
suffix:semicolon
multiline_comment|/* for use when syncing mirrors: */
DECL|member|start_active
DECL|member|start_ready
r_int
r_int
id|start_active
comma
id|start_ready
comma
DECL|member|start_pending
DECL|member|start_future
id|start_pending
comma
id|start_future
suffix:semicolon
DECL|member|cnt_done
DECL|member|cnt_active
DECL|member|cnt_ready
r_int
id|cnt_done
comma
id|cnt_active
comma
id|cnt_ready
comma
DECL|member|cnt_pending
DECL|member|cnt_future
id|cnt_pending
comma
id|cnt_future
suffix:semicolon
DECL|member|phase
r_int
id|phase
suffix:semicolon
DECL|member|window
r_int
id|window
suffix:semicolon
DECL|member|wait_done
id|md_wait_queue_head_t
id|wait_done
suffix:semicolon
DECL|member|wait_ready
id|md_wait_queue_head_t
id|wait_ready
suffix:semicolon
DECL|member|segment_lock
id|md_spinlock_t
id|segment_lock
suffix:semicolon
)brace
suffix:semicolon
DECL|typedef|raid1_conf_t
r_typedef
r_struct
id|raid1_private_data
id|raid1_conf_t
suffix:semicolon
multiline_comment|/*&n; * this is the only point in the RAID code where we violate&n; * C type safety. mddev-&gt;private is an &squot;opaque&squot; pointer.&n; */
DECL|macro|mddev_to_conf
mdefine_line|#define mddev_to_conf(mddev) ((raid1_conf_t *) mddev-&gt;private)
multiline_comment|/*&n; * this is our &squot;private&squot; &squot;collective&squot; RAID1 buffer head.&n; * it contains information about what kind of IO operations were started&n; * for this RAID1 operation, and about their status:&n; */
DECL|struct|raid1_bh
r_struct
id|raid1_bh
(brace
DECL|member|remaining
id|atomic_t
id|remaining
suffix:semicolon
multiline_comment|/* &squot;have we finished&squot; count,&n;&t;&t;&t;&t;&t;    * used from IRQ handlers&n;&t;&t;&t;&t;&t;    */
DECL|member|cmd
r_int
id|cmd
suffix:semicolon
DECL|member|state
r_int
r_int
id|state
suffix:semicolon
DECL|member|mddev
id|mddev_t
op_star
id|mddev
suffix:semicolon
DECL|member|master_bh
r_struct
id|buffer_head
op_star
id|master_bh
suffix:semicolon
DECL|member|mirror_bh_list
r_struct
id|buffer_head
op_star
id|mirror_bh_list
suffix:semicolon
DECL|member|bh_req
r_struct
id|buffer_head
id|bh_req
suffix:semicolon
DECL|member|next_r1
r_struct
id|raid1_bh
op_star
id|next_r1
suffix:semicolon
multiline_comment|/* next for retry or in free list */
)brace
suffix:semicolon
multiline_comment|/* bits for raid1_bh.state */
DECL|macro|R1BH_Uptodate
mdefine_line|#define&t;R1BH_Uptodate&t;1
DECL|macro|R1BH_SyncPhase
mdefine_line|#define&t;R1BH_SyncPhase&t;2
DECL|macro|R1BH_PreAlloc
mdefine_line|#define&t;R1BH_PreAlloc&t;3&t;/* this was pre-allocated, add to free list */
macro_line|#endif
eof
