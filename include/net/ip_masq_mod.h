multiline_comment|/*&n; *&t;IP Masquerading Modules Support&n; *&n; * Version:&t;@(#)ip_masq_mod.h  0.01      97/10/30&n; *&n; * Author:&t;Juan Jose Ciarlante, &lt;jjciarla@raiz.uncu.edu.ar&gt;&n; *&n; */
macro_line|#ifdef __KERNEL__
macro_line|#include &lt;linux/types.h&gt;
macro_line|#include &lt;linux/ip_fw.h&gt;
macro_line|#include &lt;linux/proc_fs.h&gt;
macro_line|#include &lt;net/ip_masq.h&gt;
r_enum
(brace
DECL|enumerator|IP_MASQ_MOD_NOP
id|IP_MASQ_MOD_NOP
comma
DECL|enumerator|IP_MASQ_MOD_ACCEPT
id|IP_MASQ_MOD_ACCEPT
comma
DECL|enumerator|IP_MASQ_MOD_REJECT
id|IP_MASQ_MOD_REJECT
)brace
suffix:semicolon
DECL|struct|ip_masq_mod
r_struct
id|ip_masq_mod
(brace
DECL|member|next
r_struct
id|ip_masq_mod
op_star
id|next
suffix:semicolon
multiline_comment|/* next mod for addrs. lookups */
DECL|member|next_reg
r_struct
id|ip_masq_mod
op_star
id|next_reg
suffix:semicolon
multiline_comment|/* next mod for configuration ctls */
DECL|member|mmod_name
r_char
op_star
id|mmod_name
suffix:semicolon
DECL|member|refcnt
id|atomic_t
id|refcnt
suffix:semicolon
DECL|member|mmod_nent
id|atomic_t
id|mmod_nent
suffix:semicolon
multiline_comment|/* number of entries */
DECL|member|mmod_proc_ent
r_struct
id|proc_dir_entry
op_star
id|mmod_proc_ent
suffix:semicolon
DECL|member|mmod_ctl
r_int
(paren
op_star
id|mmod_ctl
)paren
(paren
r_int
id|optname
comma
r_struct
id|ip_fw_masqctl
op_star
comma
r_int
id|optlen
)paren
suffix:semicolon
DECL|member|mmod_init
r_int
(paren
op_star
id|mmod_init
)paren
(paren
r_void
)paren
suffix:semicolon
DECL|member|mmod_done
r_int
(paren
op_star
id|mmod_done
)paren
(paren
r_void
)paren
suffix:semicolon
DECL|member|mmod_in_rule
r_int
(paren
op_star
id|mmod_in_rule
)paren
(paren
r_struct
id|iphdr
op_star
comma
id|__u16
op_star
)paren
suffix:semicolon
DECL|member|mmod_in_update
r_int
(paren
op_star
id|mmod_in_update
)paren
(paren
r_struct
id|iphdr
op_star
comma
r_struct
id|ip_masq
op_star
)paren
suffix:semicolon
DECL|member|mmod_in_create
r_struct
id|ip_masq
op_star
(paren
op_star
id|mmod_in_create
)paren
(paren
r_struct
id|iphdr
op_star
comma
id|__u16
op_star
comma
id|__u32
)paren
suffix:semicolon
DECL|member|mmod_out_rule
r_int
(paren
op_star
id|mmod_out_rule
)paren
(paren
r_struct
id|iphdr
op_star
comma
id|__u16
op_star
)paren
suffix:semicolon
DECL|member|mmod_out_update
r_int
(paren
op_star
id|mmod_out_update
)paren
(paren
r_struct
id|iphdr
op_star
comma
id|__u16
op_star
comma
r_struct
id|ip_masq
op_star
)paren
suffix:semicolon
DECL|member|mmod_out_create
r_struct
id|ip_masq
op_star
(paren
op_star
id|mmod_out_create
)paren
(paren
r_struct
id|iphdr
op_star
comma
id|__u16
op_star
comma
id|__u32
)paren
suffix:semicolon
)brace
suffix:semicolon
multiline_comment|/*&n; *&t;Service routines (called from ip_masq.c)&n; */
r_int
id|ip_masq_mod_out_rule
c_func
(paren
r_struct
id|iphdr
op_star
id|iph
comma
id|__u16
op_star
id|portp
)paren
suffix:semicolon
r_int
id|ip_masq_mod_out_update
c_func
(paren
r_struct
id|iphdr
op_star
id|iph
comma
id|__u16
op_star
id|portp
comma
r_struct
id|ip_masq
op_star
id|ms
)paren
suffix:semicolon
r_struct
id|ip_masq
op_star
id|ip_masq_mod_out_create
c_func
(paren
r_struct
id|iphdr
op_star
id|iph
comma
id|__u16
op_star
id|portp
comma
id|__u32
id|maddr
)paren
suffix:semicolon
r_int
id|ip_masq_mod_in_rule
c_func
(paren
r_struct
id|iphdr
op_star
id|iph
comma
id|__u16
op_star
id|portp
)paren
suffix:semicolon
r_int
id|ip_masq_mod_in_update
c_func
(paren
r_struct
id|iphdr
op_star
id|iph
comma
id|__u16
op_star
id|portp
comma
r_struct
id|ip_masq
op_star
id|ms
)paren
suffix:semicolon
r_struct
id|ip_masq
op_star
id|ip_masq_mod_in_create
c_func
(paren
r_struct
id|iphdr
op_star
id|iph
comma
id|__u16
op_star
id|portp
comma
id|__u32
id|maddr
)paren
suffix:semicolon
r_extern
r_int
id|ip_masq_mod_ctl
c_func
(paren
r_int
id|optname
comma
r_struct
id|ip_fw_masqctl
op_star
comma
r_int
id|len
)paren
suffix:semicolon
multiline_comment|/*&n; * &t;ip_masq_mod registration functions &n; */
r_extern
r_int
id|register_ip_masq_mod
c_func
(paren
r_struct
id|ip_masq_mod
op_star
id|mmod
)paren
suffix:semicolon
r_extern
r_int
id|unregister_ip_masq_mod
c_func
(paren
r_struct
id|ip_masq_mod
op_star
id|mmod
)paren
suffix:semicolon
r_extern
r_int
id|ip_masq_mod_lkp_unlink
c_func
(paren
r_struct
id|ip_masq_mod
op_star
id|mmod
)paren
suffix:semicolon
r_extern
r_int
id|ip_masq_mod_lkp_link
c_func
(paren
r_struct
id|ip_masq_mod
op_star
id|mmod
)paren
suffix:semicolon
multiline_comment|/*&n; *&t;Utility ...&n; */
DECL|function|ip_masq_mod_dec_nent
r_static
id|__inline__
r_void
id|ip_masq_mod_dec_nent
c_func
(paren
r_struct
id|ip_masq_mod
op_star
id|mmod
)paren
(brace
r_if
c_cond
(paren
id|atomic_dec_and_test
c_func
(paren
op_amp
id|mmod-&gt;mmod_nent
)paren
)paren
(brace
id|ip_masq_mod_lkp_unlink
c_func
(paren
id|mmod
)paren
suffix:semicolon
)brace
)brace
DECL|function|ip_masq_mod_inc_nent
r_static
id|__inline__
r_void
id|ip_masq_mod_inc_nent
c_func
(paren
r_struct
id|ip_masq_mod
op_star
id|mmod
)paren
(brace
id|atomic_inc
c_func
(paren
op_amp
id|mmod-&gt;mmod_nent
)paren
suffix:semicolon
r_if
c_cond
(paren
id|atomic_read
c_func
(paren
op_amp
id|mmod-&gt;mmod_nent
)paren
op_eq
l_int|1
)paren
id|ip_masq_mod_lkp_link
c_func
(paren
id|mmod
)paren
suffix:semicolon
)brace
macro_line|#endif /* __KERNEL__ */
eof
