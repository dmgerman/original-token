multiline_comment|/*&n; *&n; *&t;Flow based forwarding rules (usage: firewalling, etc)&n; *&n; */
macro_line|#ifndef _NET_FLOW_H
DECL|macro|_NET_FLOW_H
mdefine_line|#define _NET_FLOW_H
DECL|struct|flowi
r_struct
id|flowi
(brace
DECL|member|proto
r_int
id|proto
suffix:semicolon
multiline_comment|/*&t;{TCP, UDP, ICMP}&t;*/
r_union
(brace
r_struct
(brace
DECL|member|daddr
id|__u32
id|daddr
suffix:semicolon
DECL|member|saddr
id|__u32
id|saddr
suffix:semicolon
DECL|member|ip4_u
)brace
id|ip4_u
suffix:semicolon
r_struct
(brace
DECL|member|daddr
r_struct
id|in6_addr
op_star
id|daddr
suffix:semicolon
DECL|member|saddr
r_struct
id|in6_addr
op_star
id|saddr
suffix:semicolon
DECL|member|flowlabel
id|__u32
id|flowlabel
suffix:semicolon
DECL|member|ip6_u
)brace
id|ip6_u
suffix:semicolon
DECL|member|nl_u
)brace
id|nl_u
suffix:semicolon
DECL|macro|fl6_dst
mdefine_line|#define fl6_dst&t;&t;nl_u.ip6_u.daddr
DECL|macro|fl6_src
mdefine_line|#define fl6_src&t;&t;nl_u.ip6_u.saddr
DECL|macro|fl6_flowlabel
mdefine_line|#define fl6_flowlabel&t;nl_u.ip6_u.flowlabel
DECL|macro|fl4_dst
mdefine_line|#define fl4_dst&t;&t;nl_u.ip4_u.daddr
DECL|macro|fl4_src
mdefine_line|#define fl4_src&t;&t;nl_u.ip4_u.saddr
DECL|member|oif
r_int
id|oif
suffix:semicolon
r_union
(brace
r_struct
(brace
DECL|member|sport
id|__u16
id|sport
suffix:semicolon
DECL|member|dport
id|__u16
id|dport
suffix:semicolon
DECL|member|ports
)brace
id|ports
suffix:semicolon
r_struct
(brace
DECL|member|type
id|__u8
id|type
suffix:semicolon
DECL|member|code
id|__u8
id|code
suffix:semicolon
DECL|member|icmpt
)brace
id|icmpt
suffix:semicolon
DECL|member|data
r_int
r_int
id|data
suffix:semicolon
DECL|member|uli_u
)brace
id|uli_u
suffix:semicolon
)brace
suffix:semicolon
DECL|macro|FLOWR_NODECISION
mdefine_line|#define FLOWR_NODECISION&t;0&t;/* rule not appliable to flow&t;*/
DECL|macro|FLOWR_SELECT
mdefine_line|#define FLOWR_SELECT&t;&t;1&t;/* flow must follow this rule&t;*/
DECL|macro|FLOWR_CLEAR
mdefine_line|#define FLOWR_CLEAR&t;&t;2&t;/* priority level clears flow&t;*/
DECL|macro|FLOWR_ERROR
mdefine_line|#define FLOWR_ERROR&t;&t;3
DECL|struct|fl_acc_args
r_struct
id|fl_acc_args
(brace
DECL|member|type
r_int
id|type
suffix:semicolon
DECL|macro|FL_ARG_FORWARD
mdefine_line|#define FL_ARG_FORWARD&t;1
DECL|macro|FL_ARG_ORIGIN
mdefine_line|#define FL_ARG_ORIGIN&t;2
r_union
(brace
DECL|member|skb
r_struct
id|sk_buff
op_star
id|skb
suffix:semicolon
r_struct
(brace
DECL|member|sk
r_struct
id|sock
op_star
id|sk
suffix:semicolon
DECL|member|flow
r_struct
id|flowi
op_star
id|flow
suffix:semicolon
DECL|member|fl_o
)brace
id|fl_o
suffix:semicolon
DECL|member|fl_u
)brace
id|fl_u
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|pkt_filter
r_struct
id|pkt_filter
(brace
DECL|member|refcnt
id|atomic_t
id|refcnt
suffix:semicolon
DECL|member|offset
r_int
r_int
id|offset
suffix:semicolon
DECL|member|value
id|__u32
id|value
suffix:semicolon
DECL|member|mask
id|__u32
id|mask
suffix:semicolon
DECL|member|next
r_struct
id|pkt_filter
op_star
id|next
suffix:semicolon
)brace
suffix:semicolon
DECL|macro|FLR_INPUT
mdefine_line|#define FLR_INPUT&t;&t;1
DECL|macro|FLR_OUTPUT
mdefine_line|#define FLR_OUTPUT&t;&t;2
DECL|struct|flow_filter
r_struct
id|flow_filter
(brace
DECL|member|type
r_int
id|type
suffix:semicolon
r_union
(brace
DECL|member|filter
r_struct
id|pkt_filter
op_star
id|filter
suffix:semicolon
DECL|member|sk
r_struct
id|sock
op_star
id|sk
suffix:semicolon
DECL|member|u
)brace
id|u
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|flow_rule
r_struct
id|flow_rule
(brace
DECL|member|ops
r_struct
id|flow_rule_ops
op_star
id|ops
suffix:semicolon
DECL|member|private
r_int
r_char
r_private
(braket
l_int|0
)braket
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|flow_rule_ops
r_struct
id|flow_rule_ops
(brace
DECL|member|accept
r_int
(paren
op_star
id|accept
)paren
(paren
r_struct
id|rt6_info
op_star
id|rt
comma
r_struct
id|rt6_info
op_star
id|rule
comma
r_struct
id|fl_acc_args
op_star
id|args
comma
r_struct
id|rt6_info
op_star
op_star
id|nrt
)paren
suffix:semicolon
)brace
suffix:semicolon
macro_line|#endif
eof
