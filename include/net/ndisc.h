macro_line|#ifndef _NDISC_H
DECL|macro|_NDISC_H
mdefine_line|#define _NDISC_H
multiline_comment|/*&n; *&t;ICMP codes for neighbour discovery messages&n; */
DECL|macro|NDISC_ROUTER_SOLICITATION
mdefine_line|#define NDISC_ROUTER_SOLICITATION&t;133
DECL|macro|NDISC_ROUTER_ADVERTISEMENT
mdefine_line|#define NDISC_ROUTER_ADVERTISEMENT&t;134
DECL|macro|NDISC_NEIGHBOUR_SOLICITATION
mdefine_line|#define NDISC_NEIGHBOUR_SOLICITATION&t;135
DECL|macro|NDISC_NEIGHBOUR_ADVERTISEMENT
mdefine_line|#define NDISC_NEIGHBOUR_ADVERTISEMENT&t;136
DECL|macro|NDISC_REDIRECT
mdefine_line|#define NDISC_REDIRECT&t;&t;&t;137
multiline_comment|/*&n; *&t;ndisc options&n; */
DECL|macro|ND_OPT_SOURCE_LL_ADDR
mdefine_line|#define ND_OPT_SOURCE_LL_ADDR&t;&t;1
DECL|macro|ND_OPT_TARGET_LL_ADDR
mdefine_line|#define ND_OPT_TARGET_LL_ADDR&t;&t;2
DECL|macro|ND_OPT_PREFIX_INFO
mdefine_line|#define ND_OPT_PREFIX_INFO&t;&t;3
DECL|macro|ND_OPT_REDIRECT_HDR
mdefine_line|#define ND_OPT_REDIRECT_HDR&t;&t;4
DECL|macro|ND_OPT_MTU
mdefine_line|#define ND_OPT_MTU&t;&t;&t;5
DECL|macro|MAX_RTR_SOLICITATION_DELAY
mdefine_line|#define MAX_RTR_SOLICITATION_DELAY&t;HZ
DECL|macro|ND_REACHABLE_TIME
mdefine_line|#define ND_REACHABLE_TIME&t;&t;(30*HZ)
DECL|macro|ND_RETRANS_TIMER
mdefine_line|#define ND_RETRANS_TIMER&t;&t;HZ
DECL|macro|ND_MIN_RANDOM_FACTOR
mdefine_line|#define ND_MIN_RANDOM_FACTOR&t;&t;(1/2)
DECL|macro|ND_MAX_RANDOM_FACTOR
mdefine_line|#define ND_MAX_RANDOM_FACTOR&t;&t;(3/2)
macro_line|#ifdef __KERNEL__
macro_line|#include &lt;linux/skbuff.h&gt;
macro_line|#include &lt;linux/netdevice.h&gt;
macro_line|#include &lt;linux/icmpv6.h&gt;
macro_line|#include &lt;net/neighbour.h&gt;
macro_line|#include &lt;asm/atomic.h&gt;
r_extern
r_struct
id|neigh_table
id|nd_tbl
suffix:semicolon
DECL|struct|nd_msg
r_struct
id|nd_msg
(brace
DECL|member|icmph
r_struct
id|icmp6hdr
id|icmph
suffix:semicolon
DECL|member|target
r_struct
id|in6_addr
id|target
suffix:semicolon
r_struct
(brace
DECL|member|opt_type
id|__u8
id|opt_type
suffix:semicolon
DECL|member|opt_len
id|__u8
id|opt_len
suffix:semicolon
DECL|member|link_addr
id|__u8
id|link_addr
(braket
id|MAX_ADDR_LEN
)braket
suffix:semicolon
DECL|member|opt
)brace
id|opt
suffix:semicolon
)brace
suffix:semicolon
DECL|struct|ra_msg
r_struct
id|ra_msg
(brace
DECL|member|icmph
r_struct
id|icmp6hdr
id|icmph
suffix:semicolon
DECL|member|reachable_time
id|__u32
id|reachable_time
suffix:semicolon
DECL|member|retrans_timer
id|__u32
id|retrans_timer
suffix:semicolon
)brace
suffix:semicolon
r_extern
r_int
id|ndisc_init
c_func
(paren
r_struct
id|net_proto_family
op_star
id|ops
)paren
suffix:semicolon
r_extern
r_void
id|ndisc_cleanup
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|ndisc_rcv
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_int
r_int
id|len
)paren
suffix:semicolon
r_extern
r_void
id|ndisc_send_ns
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|neighbour
op_star
id|neigh
comma
r_struct
id|in6_addr
op_star
id|solicit
comma
r_struct
id|in6_addr
op_star
id|daddr
comma
r_struct
id|in6_addr
op_star
id|saddr
)paren
suffix:semicolon
r_extern
r_void
id|ndisc_send_rs
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|in6_addr
op_star
id|saddr
comma
r_struct
id|in6_addr
op_star
id|daddr
)paren
suffix:semicolon
r_extern
r_void
id|ndisc_forwarding_on
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_void
id|ndisc_forwarding_off
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_void
id|ndisc_send_redirect
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|neighbour
op_star
id|neigh
comma
r_struct
id|in6_addr
op_star
id|target
)paren
suffix:semicolon
r_extern
r_int
id|ndisc_mc_map
c_func
(paren
r_struct
id|in6_addr
op_star
id|addr
comma
r_char
op_star
id|buf
comma
r_struct
id|net_device
op_star
id|dev
comma
r_int
id|dir
)paren
suffix:semicolon
r_struct
id|rt6_info
op_star
id|dflt_rt_lookup
c_func
(paren
r_void
)paren
suffix:semicolon
multiline_comment|/*&n; *&t;IGMP&n; */
r_extern
r_int
id|igmp6_init
c_func
(paren
r_struct
id|net_proto_family
op_star
id|ops
)paren
suffix:semicolon
r_extern
r_void
id|igmp6_cleanup
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|igmp6_event_query
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|icmp6hdr
op_star
id|hdr
comma
r_int
id|len
)paren
suffix:semicolon
r_extern
r_int
id|igmp6_event_report
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
comma
r_struct
id|icmp6hdr
op_star
id|hdr
comma
r_int
id|len
)paren
suffix:semicolon
r_extern
r_void
id|igmp6_cleanup
c_func
(paren
r_void
)paren
suffix:semicolon
DECL|function|ndisc_get_neigh
r_static
r_inline
r_struct
id|neighbour
op_star
id|ndisc_get_neigh
c_func
(paren
r_struct
id|net_device
op_star
id|dev
comma
r_struct
id|in6_addr
op_star
id|addr
)paren
(brace
r_if
c_cond
(paren
id|dev
)paren
r_return
id|__neigh_lookup
c_func
(paren
op_amp
id|nd_tbl
comma
id|addr
comma
id|dev
comma
l_int|1
)paren
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
macro_line|#endif /* __KERNEL__ */
macro_line|#endif
eof
