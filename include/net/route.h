multiline_comment|/*&n; * INET&t;&t;An implementation of the TCP/IP protocol suite for the LINUX&n; *&t;&t;operating system.  INET  is implemented using the  BSD Socket&n; *&t;&t;interface as the means of communication with the user level.&n; *&n; *&t;&t;Definitions for the IP router.&n; *&n; * Version:&t;@(#)route.h&t;1.0.4&t;05/27/93&n; *&n; * Authors:&t;Ross Biro, &lt;bir7@leland.Stanford.Edu&gt;&n; *&t;&t;Fred N. van Kempen, &lt;waltje@uWalt.NL.Mugnet.ORG&gt;&n; * Fixes:&n; *&t;&t;Alan Cox&t;:&t;Reformatted. Added ip_rt_local()&n; *&t;&t;Alan Cox&t;:&t;Support for TCP parameters.&n; *&t;&t;Alexey Kuznetsov:&t;Major changes for new routing code.&n; *&n; *&t;&t;This program is free software; you can redistribute it and/or&n; *&t;&t;modify it under the terms of the GNU General Public License&n; *&t;&t;as published by the Free Software Foundation; either version&n; *&t;&t;2 of the License, or (at your option) any later version.&n; */
macro_line|#ifndef _ROUTE_H
DECL|macro|_ROUTE_H
mdefine_line|#define _ROUTE_H
macro_line|#include &lt;net/ip_fib.h&gt;
macro_line|#include &lt;net/dst.h&gt;
DECL|macro|RT_HASH_DIVISOR
mdefine_line|#define RT_HASH_DIVISOR&t;    &t;256
DECL|macro|RT_CACHE_MAX_SIZE
mdefine_line|#define RT_CACHE_MAX_SIZE    &t;256
multiline_comment|/*&n; * Maximal time to live for unused entry.&n; */
DECL|macro|RT_CACHE_TIMEOUT
mdefine_line|#define RT_CACHE_TIMEOUT&t;&t;(HZ*300)
multiline_comment|/*&n; * Cache invalidations can be delayed by:&n; */
DECL|macro|RT_FLUSH_DELAY
mdefine_line|#define RT_FLUSH_DELAY (2*HZ)
DECL|macro|RT_REDIRECT_NUMBER
mdefine_line|#define RT_REDIRECT_NUMBER&t;&t;9
DECL|macro|RT_REDIRECT_LOAD
mdefine_line|#define RT_REDIRECT_LOAD&t;&t;(HZ/50)&t;/* 20 msec */
DECL|macro|RT_REDIRECT_SILENCE
mdefine_line|#define RT_REDIRECT_SILENCE&t;&t;(RT_REDIRECT_LOAD&lt;&lt;(RT_REDIRECT_NUMBER+1))
multiline_comment|/* 20sec */
DECL|macro|RT_ERROR_LOAD
mdefine_line|#define RT_ERROR_LOAD&t;&t;&t;(1*HZ)
multiline_comment|/*&n; * Prevents LRU trashing, entries considered equivalent,&n; * if the difference between last use times is less then this number.&n; */
DECL|macro|RT_CACHE_BUBBLE_THRESHOLD
mdefine_line|#define RT_CACHE_BUBBLE_THRESHOLD&t;(5*HZ)
macro_line|#include &lt;linux/route.h&gt;
DECL|struct|rtable
r_struct
id|rtable
(brace
r_union
(brace
DECL|member|dst
r_struct
id|dst_entry
id|dst
suffix:semicolon
DECL|member|rt_next
r_struct
id|rtable
op_star
id|rt_next
suffix:semicolon
DECL|member|u
)brace
id|u
suffix:semicolon
DECL|member|rt_flags
r_int
id|rt_flags
suffix:semicolon
DECL|member|rt_dst
id|u32
id|rt_dst
suffix:semicolon
multiline_comment|/* Path destination&t;*/
DECL|member|rt_src
id|u32
id|rt_src
suffix:semicolon
multiline_comment|/* Path source&t;&t;*/
DECL|member|rt_src_dev
r_struct
id|device
op_star
id|rt_src_dev
suffix:semicolon
multiline_comment|/* Path source device&t;*/
multiline_comment|/* Info on neighbour */
DECL|member|rt_gateway
id|u32
id|rt_gateway
suffix:semicolon
multiline_comment|/* Cache lookup keys */
r_struct
(brace
DECL|member|dst
id|u32
id|dst
suffix:semicolon
DECL|member|src
id|u32
id|src
suffix:semicolon
DECL|member|src_dev
r_struct
id|device
op_star
id|src_dev
suffix:semicolon
DECL|member|dst_dev
r_struct
id|device
op_star
id|dst_dev
suffix:semicolon
DECL|member|tos
id|u8
id|tos
suffix:semicolon
DECL|member|key
)brace
id|key
suffix:semicolon
multiline_comment|/* Miscellaneous cached information */
DECL|member|rt_spec_dst
id|u32
id|rt_spec_dst
suffix:semicolon
multiline_comment|/* RFC1122 specific destination */
DECL|member|rt_src_map
id|u32
id|rt_src_map
suffix:semicolon
DECL|member|rt_dst_map
id|u32
id|rt_dst_map
suffix:semicolon
multiline_comment|/* ICMP statistics */
DECL|member|last_error
r_int
r_int
id|last_error
suffix:semicolon
DECL|member|errors
r_int
r_int
id|errors
suffix:semicolon
)brace
suffix:semicolon
DECL|macro|RTF_IFBRD
mdefine_line|#define RTF_IFBRD&t;(RTF_UP|RTF_MAGIC|RTF_LOCAL|RTF_BROADCAST)
DECL|macro|RTF_IFLOCAL
mdefine_line|#define RTF_IFLOCAL&t;(RTF_UP|RTF_MAGIC|RTF_LOCAL|RTF_INTERFACE)
DECL|macro|RTF_IFPREFIX
mdefine_line|#define RTF_IFPREFIX&t;(RTF_UP|RTF_MAGIC|RTF_INTERFACE)
multiline_comment|/*&n; *&t;Flags not visible at user level.&n; */
DECL|macro|RTF_INTERNAL
mdefine_line|#define RTF_INTERNAL&t;0xFFFF8000&t;/* to get RTF_MAGIC as well... */
multiline_comment|/*&n; *&t;Flags saved in FIB.&n; */
DECL|macro|RTF_FIB
mdefine_line|#define RTF_FIB&t;&t;(RTF_UP|RTF_GATEWAY|RTF_REJECT|RTF_THROW|RTF_STATIC|&bslash;&n;&t;&t;&t; RTF_XRESOLVE|RTF_NOPMTUDISC|RTF_NOFORWARD|RTF_INTERNAL)
r_extern
r_void
id|ip_rt_init
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_void
id|ip_rt_redirect
c_func
(paren
id|u32
id|old_gw
comma
id|u32
id|dst
comma
id|u32
id|new_gw
comma
id|u32
id|src
comma
id|u8
id|tos
comma
r_struct
id|device
op_star
id|dev
)paren
suffix:semicolon
r_extern
r_void
id|ip_rt_check_expire
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_void
id|ip_rt_advice
c_func
(paren
r_struct
id|rtable
op_star
op_star
id|rp
comma
r_int
id|advice
)paren
suffix:semicolon
r_extern
r_void
id|rt_cache_flush
c_func
(paren
r_int
id|how
)paren
suffix:semicolon
r_extern
r_int
id|ip_route_output
c_func
(paren
r_struct
id|rtable
op_star
op_star
comma
id|u32
id|dst
comma
id|u32
id|src
comma
id|u8
id|tos
comma
r_struct
id|device
op_star
id|devout
)paren
suffix:semicolon
r_extern
r_int
id|ip_route_output_dev
c_func
(paren
r_struct
id|rtable
op_star
op_star
comma
id|u32
id|dst
comma
id|u32
id|src
comma
id|u8
id|tos
comma
r_int
)paren
suffix:semicolon
r_extern
r_int
id|ip_route_input
c_func
(paren
r_struct
id|sk_buff
op_star
comma
id|u32
id|dst
comma
id|u32
id|src
comma
id|u8
id|tos
comma
r_struct
id|device
op_star
id|devin
)paren
suffix:semicolon
r_extern
r_int
r_int
id|ip_rt_frag_needed
c_func
(paren
r_struct
id|iphdr
op_star
id|iph
comma
r_int
r_int
id|new_mtu
)paren
suffix:semicolon
r_extern
r_void
id|ip_rt_send_redirect
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
)paren
suffix:semicolon
DECL|function|ip_rt_put
r_static
id|__inline__
r_void
id|ip_rt_put
c_func
(paren
r_struct
id|rtable
op_star
id|rt
)paren
(brace
r_if
c_cond
(paren
id|rt
)paren
id|dst_release
c_func
(paren
op_amp
id|rt-&gt;u.dst
)paren
suffix:semicolon
)brace
DECL|function|rt_tos2priority
r_static
id|__inline__
r_char
id|rt_tos2priority
c_func
(paren
id|u8
id|tos
)paren
(brace
r_if
c_cond
(paren
id|tos
op_amp
id|IPTOS_LOWDELAY
)paren
r_return
id|SOPRI_INTERACTIVE
suffix:semicolon
r_if
c_cond
(paren
id|tos
op_amp
(paren
id|IPTOS_THROUGHPUT
op_or
id|IPTOS_MINCOST
)paren
)paren
r_return
id|SOPRI_BACKGROUND
suffix:semicolon
r_return
id|SOPRI_NORMAL
suffix:semicolon
)brace
DECL|function|ip_route_connect
r_static
id|__inline__
r_int
id|ip_route_connect
c_func
(paren
r_struct
id|rtable
op_star
op_star
id|rp
comma
id|u32
id|dst
comma
id|u32
id|src
comma
id|u32
id|tos
)paren
(brace
r_int
id|err
suffix:semicolon
id|err
op_assign
id|ip_route_output
c_func
(paren
id|rp
comma
id|dst
comma
id|src
comma
id|tos
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
op_logical_or
(paren
id|dst
op_logical_and
id|src
)paren
)paren
r_return
id|err
suffix:semicolon
id|dst
op_assign
(paren
op_star
id|rp
)paren
op_member_access_from_pointer
id|rt_dst
suffix:semicolon
id|src
op_assign
(paren
op_star
id|rp
)paren
op_member_access_from_pointer
id|rt_src
suffix:semicolon
id|ip_rt_put
c_func
(paren
op_star
id|rp
)paren
suffix:semicolon
op_star
id|rp
op_assign
l_int|NULL
suffix:semicolon
r_return
id|ip_route_output
c_func
(paren
id|rp
comma
id|dst
comma
id|src
comma
id|tos
comma
l_int|NULL
)paren
suffix:semicolon
)brace
DECL|function|ip_ll_header
r_static
id|__inline__
r_void
id|ip_ll_header
c_func
(paren
r_struct
id|sk_buff
op_star
id|skb
)paren
(brace
r_struct
id|rtable
op_star
id|rt
op_assign
(paren
r_struct
id|rtable
op_star
)paren
id|skb-&gt;dst
suffix:semicolon
r_struct
id|device
op_star
id|dev
op_assign
id|rt-&gt;u.dst.dev
suffix:semicolon
r_struct
id|hh_cache
op_star
id|hh
op_assign
id|rt-&gt;u.dst.hh
suffix:semicolon
r_int
id|hh_len
op_assign
id|dev-&gt;hard_header_len
suffix:semicolon
id|skb-&gt;dev
op_assign
id|dev
suffix:semicolon
id|skb-&gt;arp
op_assign
l_int|1
suffix:semicolon
id|skb-&gt;protocol
op_assign
id|htons
c_func
(paren
id|ETH_P_IP
)paren
suffix:semicolon
r_if
c_cond
(paren
id|hh
)paren
(brace
id|memcpy
c_func
(paren
id|skb_push
c_func
(paren
id|skb
comma
id|hh_len
)paren
comma
id|hh-&gt;hh_data
comma
id|hh_len
)paren
suffix:semicolon
id|skb-&gt;arp
op_assign
id|hh-&gt;hh_uptodate
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|dev-&gt;hard_header
op_logical_and
id|dev
op_member_access_from_pointer
id|hard_header
c_func
(paren
id|skb
comma
id|dev
comma
id|ETH_P_IP
comma
l_int|NULL
comma
l_int|NULL
comma
l_int|0
)paren
OL
l_int|0
)paren
id|skb-&gt;arp
op_assign
l_int|0
suffix:semicolon
id|skb-&gt;mac.raw
op_assign
id|skb-&gt;data
suffix:semicolon
)brace
macro_line|#endif&t;/* _ROUTE_H */
eof
