multiline_comment|/*&n; * linux/include/asm-arm/arch-rpc/mmap.h&n; *&n; * Copyright (C) 1996 Russell King&n; */
DECL|macro|HAVE_MAP_VID_MEM
mdefine_line|#define HAVE_MAP_VID_MEM
DECL|macro|SAFE_ADDR
mdefine_line|#define SAFE_ADDR 0x00000000&t;/* ROM */
DECL|function|map_screen_mem
r_int
r_int
id|map_screen_mem
c_func
(paren
r_int
r_int
id|log_start
comma
r_int
r_int
id|kmem
comma
r_int
id|update
)paren
(brace
r_static
r_int
id|updated
op_assign
l_int|0
suffix:semicolon
r_int
r_int
id|address
suffix:semicolon
id|pgd_t
op_star
id|pgd
suffix:semicolon
r_if
c_cond
(paren
id|updated
)paren
r_return
l_int|0
suffix:semicolon
id|updated
op_assign
id|update
suffix:semicolon
id|address
op_assign
id|SCREEN_START
op_or
id|PMD_TYPE_SECT
op_or
id|PMD_DOMAIN
c_func
(paren
id|DOMAIN_KERNEL
)paren
op_or
id|PMD_SECT_AP_WRITE
suffix:semicolon
id|pgd
op_assign
id|swapper_pg_dir
op_plus
(paren
id|SCREEN2_BASE
op_rshift
id|PGDIR_SHIFT
)paren
suffix:semicolon
id|pgd_val
c_func
(paren
id|pgd
(braket
l_int|0
)braket
)paren
op_assign
id|address
suffix:semicolon
id|pgd_val
c_func
(paren
id|pgd
(braket
l_int|1
)braket
)paren
op_assign
id|address
op_plus
(paren
l_int|1
op_lshift
id|PGDIR_SHIFT
)paren
suffix:semicolon
r_if
c_cond
(paren
id|update
)paren
(brace
r_int
r_int
id|pgtable
op_assign
id|PAGE_ALIGN
c_func
(paren
id|kmem
)paren
comma
op_star
id|p
suffix:semicolon
r_int
id|i
suffix:semicolon
id|memzero
(paren
(paren
r_void
op_star
)paren
id|pgtable
comma
l_int|4096
)paren
suffix:semicolon
id|pgd_val
c_func
(paren
id|pgd
(braket
op_minus
l_int|2
)braket
)paren
op_assign
id|virt_to_phys
c_func
(paren
id|pgtable
)paren
op_or
id|PMD_TYPE_TABLE
op_or
id|PMD_DOMAIN
c_func
(paren
id|DOMAIN_KERNEL
)paren
suffix:semicolon
id|pgd_val
c_func
(paren
id|pgd
(braket
op_minus
l_int|1
)braket
)paren
op_assign
id|virt_to_phys
c_func
(paren
id|pgtable
op_plus
id|PTRS_PER_PTE
op_star
l_int|4
)paren
op_or
id|PMD_TYPE_TABLE
op_or
id|PMD_DOMAIN
c_func
(paren
id|DOMAIN_KERNEL
)paren
suffix:semicolon
id|p
op_assign
(paren
r_int
r_int
op_star
)paren
id|pgtable
suffix:semicolon
id|i
op_assign
id|PTRS_PER_PTE
op_star
l_int|2
op_minus
(paren
(paren
id|SCREEN1_END
op_minus
id|log_start
)paren
op_rshift
id|PAGE_SHIFT
)paren
suffix:semicolon
id|address
op_assign
id|SCREEN_START
op_or
id|PTE_TYPE_SMALL
op_or
id|PTE_AP_WRITE
suffix:semicolon
r_while
c_loop
(paren
id|i
OL
id|PTRS_PER_PTE
op_star
l_int|2
)paren
(brace
id|p
(braket
id|i
op_increment
)braket
op_assign
id|address
suffix:semicolon
id|address
op_add_assign
id|PAGE_SIZE
suffix:semicolon
)brace
id|flush_page_to_ram
c_func
(paren
id|pgtable
)paren
suffix:semicolon
id|kmem
op_assign
id|pgtable
op_plus
id|PAGE_SIZE
suffix:semicolon
)brace
r_return
id|kmem
suffix:semicolon
)brace
eof
