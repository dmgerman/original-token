macro_line|#ifndef __PPC_SYSTEM_H
DECL|macro|__PPC_SYSTEM_H
mdefine_line|#define __PPC_SYSTEM_H
macro_line|#if 0
mdefine_line|#define mb() &bslash;&n;__asm__ __volatile__(&quot;mb&quot;: : :&quot;memory&quot;)
macro_line|#endif
DECL|macro|mb
mdefine_line|#define mb()  __asm__ __volatile__ (&quot;&quot;   : : :&quot;memory&quot;)
r_extern
r_void
id|__save_flags
c_func
(paren
r_int
op_star
id|flags
)paren
suffix:semicolon
r_extern
r_void
id|__restore_flags
c_func
(paren
r_int
id|flags
)paren
suffix:semicolon
r_extern
r_void
id|sti
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_void
id|cli
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_int
id|_disable_interrupts
c_func
(paren
r_void
)paren
suffix:semicolon
r_extern
r_void
id|_enable_interrupts
c_func
(paren
r_int
)paren
suffix:semicolon
multiline_comment|/*extern void memcpy(void *, void *, int);*/
r_extern
r_void
id|bzero
c_func
(paren
r_void
op_star
comma
r_int
)paren
suffix:semicolon
r_struct
id|task_struct
suffix:semicolon
r_extern
r_void
id|switch_to
c_func
(paren
r_struct
id|task_struct
op_star
id|prev
comma
r_struct
id|task_struct
op_star
id|next
)paren
suffix:semicolon
DECL|macro|save_flags
mdefine_line|#define save_flags(flags) __save_flags(&amp;(flags))
DECL|macro|restore_flags
mdefine_line|#define restore_flags(flags) __restore_flags(flags)
DECL|macro|xchg
mdefine_line|#define xchg(ptr,x) ((__typeof__(*(ptr)))__xchg((unsigned long)(x),(ptr),sizeof(*(ptr))))
multiline_comment|/* this guy lives in arch/ppc/kernel */
r_extern
r_inline
r_int
r_int
op_star
id|xchg_u32
c_func
(paren
r_void
op_star
id|m
comma
r_int
r_int
id|val
)paren
suffix:semicolon
multiline_comment|/*&n; *  these guys don&squot;t exist.&n; *  someone should create them.&n; *              -- Cort&n; */
r_extern
r_void
op_star
id|xchg_u64
c_func
(paren
r_void
op_star
id|ptr
comma
r_int
r_int
id|val
)paren
suffix:semicolon
r_extern
r_int
id|xchg_u8
c_func
(paren
r_char
op_star
id|m
comma
r_char
id|val
)paren
suffix:semicolon
multiline_comment|/*&n; * This function doesn&squot;t exist, so you&squot;ll get a linker error&n; * if something tries to do an invalid xchg().&n; *&n; * This only works if the compiler isn&squot;t horribly bad at optimizing.&n; * gcc-2.5.8 reportedly can&squot;t handle this, but as that doesn&squot;t work&n; * too well on the alpha anyway..&n; */
r_extern
r_void
id|__xchg_called_with_bad_pointer
c_func
(paren
r_void
)paren
suffix:semicolon
DECL|function|__xchg
r_static
r_inline
r_int
r_int
id|__xchg
c_func
(paren
r_int
r_int
id|x
comma
r_void
op_star
id|ptr
comma
r_int
id|size
)paren
(brace
r_switch
c_cond
(paren
id|size
)paren
(brace
r_case
l_int|4
suffix:colon
r_return
(paren
r_int
r_int
)paren
id|xchg_u32
c_func
(paren
id|ptr
comma
id|x
)paren
suffix:semicolon
r_case
l_int|8
suffix:colon
r_return
(paren
r_int
r_int
)paren
id|xchg_u64
c_func
(paren
id|ptr
comma
id|x
)paren
suffix:semicolon
)brace
id|__xchg_called_with_bad_pointer
c_func
(paren
)paren
suffix:semicolon
r_return
id|x
suffix:semicolon
)brace
DECL|function|tas
r_extern
r_inline
r_int
id|tas
c_func
(paren
r_char
op_star
id|m
)paren
(brace
r_return
id|xchg_u8
c_func
(paren
id|m
comma
l_int|1
)paren
suffix:semicolon
)brace
DECL|function|xchg_ptr
r_extern
r_inline
r_void
op_star
id|xchg_ptr
c_func
(paren
r_void
op_star
id|m
comma
r_void
op_star
id|val
)paren
(brace
r_return
(paren
r_void
op_star
)paren
id|xchg_u32
c_func
(paren
id|m
comma
(paren
r_int
r_int
)paren
id|val
)paren
suffix:semicolon
)brace
macro_line|#endif
eof
