macro_line|#ifndef __ASM_IO_APIC_H
DECL|macro|__ASM_IO_APIC_H
mdefine_line|#define __ASM_IO_APIC_H
macro_line|#include &lt;linux/config.h&gt;
macro_line|#include &lt;asm/types.h&gt;
multiline_comment|/*&n; * Intel IO-APIC support for SMP and UP systems.&n; *&n; * Copyright (C) 1997, 1998, 1999, 2000 Ingo Molnar&n; */
macro_line|#ifdef CONFIG_X86_IO_APIC
DECL|macro|IO_APIC_BASE
mdefine_line|#define IO_APIC_BASE(idx) &bslash;&n;&t;&t;((volatile int *)__fix_to_virt(FIX_IO_APIC_BASE_0 + idx))
multiline_comment|/*&n; * The structure of the IO-APIC:&n; */
DECL|struct|IO_APIC_reg_00
r_struct
id|IO_APIC_reg_00
(brace
DECL|member|__reserved_2
id|__u32
id|__reserved_2
suffix:colon
l_int|24
comma
DECL|member|ID
id|ID
suffix:colon
l_int|4
comma
DECL|member|__reserved_1
id|__reserved_1
suffix:colon
l_int|4
suffix:semicolon
)brace
id|__attribute__
(paren
(paren
id|packed
)paren
)paren
suffix:semicolon
DECL|struct|IO_APIC_reg_01
r_struct
id|IO_APIC_reg_01
(brace
DECL|member|version
id|__u32
id|version
suffix:colon
l_int|8
comma
DECL|member|__reserved_2
id|__reserved_2
suffix:colon
l_int|8
comma
DECL|member|entries
id|entries
suffix:colon
l_int|8
comma
DECL|member|__reserved_1
id|__reserved_1
suffix:colon
l_int|8
suffix:semicolon
)brace
id|__attribute__
(paren
(paren
id|packed
)paren
)paren
suffix:semicolon
DECL|struct|IO_APIC_reg_02
r_struct
id|IO_APIC_reg_02
(brace
DECL|member|__reserved_2
id|__u32
id|__reserved_2
suffix:colon
l_int|24
comma
DECL|member|arbitration
id|arbitration
suffix:colon
l_int|4
comma
DECL|member|__reserved_1
id|__reserved_1
suffix:colon
l_int|4
suffix:semicolon
)brace
id|__attribute__
(paren
(paren
id|packed
)paren
)paren
suffix:semicolon
multiline_comment|/*&n; * # of IO-APICs and # of IRQ routing registers&n; */
r_extern
r_int
id|nr_ioapics
suffix:semicolon
r_extern
r_int
id|nr_ioapic_registers
(braket
id|MAX_IO_APICS
)braket
suffix:semicolon
DECL|enum|ioapic_irq_destination_types
r_enum
id|ioapic_irq_destination_types
(brace
DECL|enumerator|dest_Fixed
id|dest_Fixed
op_assign
l_int|0
comma
DECL|enumerator|dest_LowestPrio
id|dest_LowestPrio
op_assign
l_int|1
comma
DECL|enumerator|dest_SMI
id|dest_SMI
op_assign
l_int|2
comma
DECL|enumerator|dest__reserved_1
id|dest__reserved_1
op_assign
l_int|3
comma
DECL|enumerator|dest_NMI
id|dest_NMI
op_assign
l_int|4
comma
DECL|enumerator|dest_INIT
id|dest_INIT
op_assign
l_int|5
comma
DECL|enumerator|dest__reserved_2
id|dest__reserved_2
op_assign
l_int|6
comma
DECL|enumerator|dest_ExtINT
id|dest_ExtINT
op_assign
l_int|7
)brace
suffix:semicolon
DECL|struct|IO_APIC_route_entry
r_struct
id|IO_APIC_route_entry
(brace
DECL|member|vector
id|__u32
id|vector
suffix:colon
l_int|8
comma
DECL|member|delivery_mode
id|delivery_mode
suffix:colon
l_int|3
comma
multiline_comment|/* 000: FIXED&n;&t;&t;&t;&t;&t; * 001: lowest prio&n;&t;&t;&t;&t;&t; * 111: ExtINT&n;&t;&t;&t;&t;&t; */
DECL|member|dest_mode
id|dest_mode
suffix:colon
l_int|1
comma
multiline_comment|/* 0: physical, 1: logical */
DECL|member|delivery_status
id|delivery_status
suffix:colon
l_int|1
comma
DECL|member|polarity
id|polarity
suffix:colon
l_int|1
comma
DECL|member|irr
id|irr
suffix:colon
l_int|1
comma
DECL|member|trigger
id|trigger
suffix:colon
l_int|1
comma
multiline_comment|/* 0: edge, 1: level */
DECL|member|mask
id|mask
suffix:colon
l_int|1
comma
multiline_comment|/* 0: enabled, 1: disabled */
DECL|member|__reserved_2
id|__reserved_2
suffix:colon
l_int|15
suffix:semicolon
r_union
(brace
r_struct
(brace
id|__u32
DECL|member|__reserved_1
id|__reserved_1
suffix:colon
l_int|24
comma
DECL|member|physical_dest
id|physical_dest
suffix:colon
l_int|4
comma
DECL|member|__reserved_2
id|__reserved_2
suffix:colon
l_int|4
suffix:semicolon
DECL|member|physical
)brace
id|physical
suffix:semicolon
r_struct
(brace
id|__u32
DECL|member|__reserved_1
id|__reserved_1
suffix:colon
l_int|24
comma
DECL|member|logical_dest
id|logical_dest
suffix:colon
l_int|8
suffix:semicolon
DECL|member|logical
)brace
id|logical
suffix:semicolon
DECL|member|dest
)brace
id|dest
suffix:semicolon
)brace
id|__attribute__
(paren
(paren
id|packed
)paren
)paren
suffix:semicolon
multiline_comment|/*&n; * MP-BIOS irq configuration table structures:&n; */
multiline_comment|/* I/O APIC entries */
r_extern
r_struct
id|mpc_config_ioapic
id|mp_ioapics
(braket
id|MAX_IO_APICS
)braket
suffix:semicolon
multiline_comment|/* # of MP IRQ source entries */
r_extern
r_int
id|mp_irq_entries
suffix:semicolon
multiline_comment|/* MP IRQ source entries */
r_extern
r_struct
id|mpc_config_intsrc
id|mp_irqs
(braket
id|MAX_IRQ_SOURCES
)braket
suffix:semicolon
multiline_comment|/* non-0 if default (table-less) MP configuration */
r_extern
r_int
id|mpc_default_type
suffix:semicolon
DECL|function|io_apic_read
r_static
r_inline
r_int
r_int
id|io_apic_read
c_func
(paren
r_int
r_int
id|apic
comma
r_int
r_int
id|reg
)paren
(brace
op_star
id|IO_APIC_BASE
c_func
(paren
id|apic
)paren
op_assign
id|reg
suffix:semicolon
r_return
op_star
(paren
id|IO_APIC_BASE
c_func
(paren
id|apic
)paren
op_plus
l_int|4
)paren
suffix:semicolon
)brace
DECL|function|io_apic_write
r_static
r_inline
r_void
id|io_apic_write
c_func
(paren
r_int
r_int
id|apic
comma
r_int
r_int
id|reg
comma
r_int
r_int
id|value
)paren
(brace
op_star
id|IO_APIC_BASE
c_func
(paren
id|apic
)paren
op_assign
id|reg
suffix:semicolon
op_star
(paren
id|IO_APIC_BASE
c_func
(paren
id|apic
)paren
op_plus
l_int|4
)paren
op_assign
id|value
suffix:semicolon
)brace
multiline_comment|/*&n; * Re-write a value: to be used for read-modify-write&n; * cycles where the read already set up the index register.&n; */
DECL|function|io_apic_modify
r_static
r_inline
r_void
id|io_apic_modify
c_func
(paren
r_int
r_int
id|apic
comma
r_int
r_int
id|value
)paren
(brace
op_star
(paren
id|IO_APIC_BASE
c_func
(paren
id|apic
)paren
op_plus
l_int|4
)paren
op_assign
id|value
suffix:semicolon
)brace
multiline_comment|/*&n; * Synchronize the IO-APIC and the CPU by doing&n; * a dummy read from the IO-APIC&n; */
DECL|function|io_apic_sync
r_static
r_inline
r_void
id|io_apic_sync
c_func
(paren
r_int
r_int
id|apic
)paren
(brace
(paren
r_void
)paren
op_star
(paren
id|IO_APIC_BASE
c_func
(paren
id|apic
)paren
op_plus
l_int|4
)paren
suffix:semicolon
)brace
r_extern
r_int
id|nmi_watchdog
suffix:semicolon
multiline_comment|/* 1 if &quot;noapic&quot; boot option passed */
r_extern
r_int
id|skip_ioapic_setup
suffix:semicolon
r_extern
r_void
id|IO_APIC_init_uniprocessor
(paren
r_void
)paren
suffix:semicolon
multiline_comment|/*&n; * If we use the IO-APIC for IRQ routing, disable automatic&n; * assignment of PCI IRQ&squot;s.&n; */
DECL|macro|io_apic_assign_pci_irqs
mdefine_line|#define io_apic_assign_pci_irqs (mp_irq_entries &amp;&amp; !skip_ioapic_setup)
macro_line|#else  /* !CONFIG_X86_IO_APIC */
DECL|macro|io_apic_assign_pci_irqs
mdefine_line|#define io_apic_assign_pci_irqs 0
macro_line|#endif
macro_line|#endif
eof
