multiline_comment|/* $Id: xstat.h,v 1.1 1998/02/06 12:52:18 jj Exp $&n; * xstat.h: sys_xstat/xmknod architecture dependent stuff.&n; *&n; * Copyright (C) 1998  Jakub Jelinek  (jj@sunsite.mff.cuni.cz)&n; */
DECL|function|cp_xstat32
r_extern
id|__inline__
r_int
id|cp_xstat32
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|stat64_32
op_star
id|s
comma
r_int
r_int
id|blocks
comma
r_int
id|blksize
)paren
(brace
r_struct
id|stat64_32
id|tmp
suffix:semicolon
id|memset
(paren
op_amp
id|tmp
comma
l_int|0
comma
r_sizeof
(paren
id|tmp
)paren
)paren
suffix:semicolon
id|tmp.st_dev
op_assign
(paren
(paren
(paren
id|__u64
)paren
id|MAJOR
c_func
(paren
id|inode-&gt;i_dev
)paren
)paren
op_lshift
l_int|32
)paren
op_or
id|MINOR
c_func
(paren
id|inode-&gt;i_dev
)paren
suffix:semicolon
id|tmp.st_ino
op_assign
id|inode-&gt;i_ino
suffix:semicolon
id|tmp.st_mode
op_assign
id|inode-&gt;i_mode
suffix:semicolon
id|tmp.st_nlink
op_assign
id|inode-&gt;i_nlink
suffix:semicolon
id|tmp.st_uid
op_assign
id|inode-&gt;i_uid
suffix:semicolon
id|tmp.st_gid
op_assign
id|inode-&gt;i_gid
suffix:semicolon
id|tmp.st_rdev
op_assign
(paren
(paren
(paren
id|__u64
)paren
id|MAJOR
c_func
(paren
id|inode-&gt;i_rdev
)paren
)paren
op_lshift
l_int|32
)paren
op_or
id|MINOR
c_func
(paren
id|inode-&gt;i_rdev
)paren
suffix:semicolon
id|tmp.st_size
op_assign
id|inode-&gt;i_size
suffix:semicolon
id|tmp.st_blocks
op_assign
id|blocks
suffix:semicolon
id|tmp.st_atime
op_assign
id|inode-&gt;i_atime
suffix:semicolon
id|tmp.st_mtime
op_assign
id|inode-&gt;i_mtime
suffix:semicolon
id|tmp.st_ctime
op_assign
id|inode-&gt;i_ctime
suffix:semicolon
id|tmp.st_blksize
op_assign
id|blksize
suffix:semicolon
r_return
id|copy_to_user
c_func
(paren
id|s
comma
op_amp
id|tmp
comma
r_sizeof
(paren
id|tmp
)paren
)paren
suffix:semicolon
)brace
DECL|function|cp_xstat
r_extern
id|__inline__
r_int
id|cp_xstat
c_func
(paren
r_struct
id|inode
op_star
id|inode
comma
r_struct
id|stat64
op_star
id|s
comma
r_int
r_int
id|blocks
comma
r_int
id|blksize
)paren
(brace
r_struct
id|stat64
id|tmp
suffix:semicolon
r_if
c_cond
(paren
id|current-&gt;tss.flags
op_amp
id|SPARC_FLAG_32BIT
)paren
r_return
id|cp_xstat32
c_func
(paren
id|inode
comma
(paren
r_struct
id|stat64_32
op_star
)paren
id|s
comma
id|blocks
comma
id|blksize
)paren
suffix:semicolon
id|memset
(paren
op_amp
id|tmp
comma
l_int|0
comma
r_sizeof
(paren
id|tmp
)paren
)paren
suffix:semicolon
id|tmp.st_dev
op_assign
(paren
(paren
(paren
id|__u64
)paren
id|MAJOR
c_func
(paren
id|inode-&gt;i_dev
)paren
)paren
op_lshift
l_int|32
)paren
op_or
id|MINOR
c_func
(paren
id|inode-&gt;i_dev
)paren
suffix:semicolon
id|tmp.st_ino
op_assign
id|inode-&gt;i_ino
suffix:semicolon
id|tmp.st_mode
op_assign
id|inode-&gt;i_mode
suffix:semicolon
id|tmp.st_nlink
op_assign
id|inode-&gt;i_nlink
suffix:semicolon
id|tmp.st_uid
op_assign
id|inode-&gt;i_uid
suffix:semicolon
id|tmp.st_gid
op_assign
id|inode-&gt;i_gid
suffix:semicolon
id|tmp.st_rdev
op_assign
(paren
(paren
(paren
id|__u64
)paren
id|MAJOR
c_func
(paren
id|inode-&gt;i_rdev
)paren
)paren
op_lshift
l_int|32
)paren
op_or
id|MINOR
c_func
(paren
id|inode-&gt;i_rdev
)paren
suffix:semicolon
id|tmp.st_size
op_assign
id|inode-&gt;i_size
suffix:semicolon
id|tmp.st_atim.tv_sec
op_assign
id|inode-&gt;i_atime
suffix:semicolon
id|tmp.st_mtim.tv_sec
op_assign
id|inode-&gt;i_mtime
suffix:semicolon
id|tmp.st_ctim.tv_sec
op_assign
id|inode-&gt;i_ctime
suffix:semicolon
id|tmp.st_blksize
op_assign
id|blksize
suffix:semicolon
id|tmp.st_blocks
op_assign
id|blocks
suffix:semicolon
multiline_comment|/* Should I check if all fs names are &lt; 16? All in the kernel tree are */
r_if
c_cond
(paren
id|inode-&gt;i_sb
)paren
id|strcpy
c_func
(paren
id|tmp.st_fstype
comma
id|inode-&gt;i_sb-&gt;s_type-&gt;name
)paren
suffix:semicolon
r_return
id|copy_to_user
c_func
(paren
id|s
comma
op_amp
id|tmp
comma
r_sizeof
(paren
id|tmp
)paren
)paren
suffix:semicolon
)brace
DECL|function|get_user_new_dev_t
r_extern
id|__inline__
r_int
id|get_user_new_dev_t
c_func
(paren
id|kdev_t
op_star
id|kdev
comma
id|__new_dev_t
op_star
id|udev
)paren
(brace
id|__new_dev_t
id|ndev
suffix:semicolon
r_if
c_cond
(paren
id|copy_from_user
(paren
op_amp
id|ndev
comma
id|udev
comma
r_sizeof
(paren
id|__new_dev_t
)paren
)paren
)paren
r_return
op_minus
id|EFAULT
suffix:semicolon
op_star
id|kdev
op_assign
id|MKDEV
c_func
(paren
(paren
id|ndev
op_rshift
l_int|32
)paren
comma
(paren
id|__u32
)paren
id|ndev
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
eof
